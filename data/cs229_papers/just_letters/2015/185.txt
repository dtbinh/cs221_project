clustering bach chorales 
insights into satb and bachs style
diego hernandez  hope casey allen  jian yang lum
stanford university  california  united states

 

introduction and literature review

few composers have been as influential in the western musical tradition as johann sebastian bach             whose four part chorales for soprano  alto  tenor  and bass  abbreviated satb  and listed in order
from highest to lowest  have become well known distillations of important music theoretical principles  such
principles  dealing with both the construction of individual parts and the interactions between those parts 
came to dominate western music for about     years after bachs time and continue to inform musical
understanding today 
some research in machine learning has been devoted to computerized harmonizations  i e   given a soprano
melody  generate the other three voices in bachs style   however  previous projects have encountered
obstacles in their work due to a lack of rigorous understanding of the nuances in bachs style  for instance 
allan and williams        attempted to generate chorale harmonizations in bachs style using a hidden
markov model  the results were suboptimal  although the relationships between voices in the resulting
chorales were consistent with harmonic rules seen in textbooks  the individual voices themselves sometimes
erratically jumped in pitch instead of flowing in natural  intentional contours 
it is clear that research is needed to more precisely characterize satb voices in bach chorales  the insights
from which would not only improve algorithms that seek to generate harmonizations but would be useful to
musical theorists and performers in understanding and interpreting music 
our first goal is thus to determine features  independent of relative positions  that distinguish individual satb voices in bach chorales  our second goal is to find and interpret clusterings of chorales that
may be artistically useful  e g   helpful in identifying musically similar chorales for purposes of inspiration 
comparison  etc  
we have   inputs  corresponding to the different goals  inputs for the first goal are the features from the
voice parts of these chorales  looking at        satb parts in total  we used k means clustering  with k  
   in an attempt to yield clusters that divide the voices into their natural satb taxonomies  revealing the
defining characteristics of each melody  and softmax   multinomial regression for voice prediction  where the
output is one of the possible satb values 
the inputs to our second goal are features we extracted from the scores of     of bachs chorales  we
used the elbow method to determine that k     for k means clustering on this input  and outputted distinct
clusters for the chorales which reveal insights into bachs style  and we used em in an attempt to reveal
traits of bachs style as well 
we believe our task has never been attempted in the literature  the closest task we could find to ours is in
     in which quinn and mavromatis clustered every chord transition in a combined corpus of chorales of two
categories  chorales by bach and modal chorales from about a century before bach  they then compared each
chorale categorys coverage of each cluster as a means of identifying distinguishing harmonic characteristics
of each category  although this research provides a window into the overall harmonic landscape of bachs
chorales  it says nothing about the characteristics of satb voices 

 

fi 

dataset and features

our dataset contains     bach chorales and        satb voice parts  all accessed from http   kern 
humdrum org cgi bin ksdata l musedata bach chorales file chor    krn f musedata where    is the
number of the chorale  the dataset is encoded in the humdrum   kern data format  humdrum was developed
by ccarh  center for computer assisted research in the humanities  at ccrma  within stanford  

 a  sample of a bach chorale opening  s is the top
line  a the second highest  t the third  b the lowest 

 b  the same score  translated into   kern

as seen above  musical information  pitches  metronome markings  measures  metadata  etc  is encoded to
represent a full musical score  we used a toolkit developed by mit called music   to separate the chorales
into parts and extract their features  we categorized relevant features into   buckets  for some buckets with
multiple features  we used pca and extracted the principal component  which for all cases explained at least
    of variation   while for others we added or subtracted the feature values  normalization was performed
on all variables to have mean   and variance    to aid k means clustering by assigning equal importance to
each predictor variable 

 

methods

the two goals we tried to achieve required two different approaches each  determining the difference
between individual voices is fundamentally a classification problem  while attempting to observe similarities
behind chorales that do not have an observable grouping is an unsupervised problem  to that extent  we
employed a mixture of parametric and nonparametric methods for differentiating satb voices  namely 
softmax multinomial logistic regression  and k means clustering  and multiple unsupervised methods  kmeans and em  for clustering chorales 
the softmax  or multinomial regression model  posits k  in this case     one corresponding to one voice
type  different outcomes voice types  with total probability summing to one  with a constraint on the last
variable   maximization of the log likelihood of the model 
m
x
i  

ln

k
y
l  

t

e l

t

pk

j  

   y i   l 

x i 

e j x

 i 

was done using a single hidden layer neural network  in which a  hidden  layer of variables is estimated
using a vector of weights w with  w    nk  n being number of features  k       the neural net then
used backpropagation of errors to the inputs with gradient descent to update the parameters returned  the
softmax model was chosen as it did not require breaking down into binary classification problems 
k means clustering iteratively seeksp
to find the cluster centroids that minimize the aggregate residual sum
m
of squares of all points in that cluster  i     x i   c  i        by first reassigning both the assignments of each
points to the nearest centroid  then moving that centroid to the mean of all points with that same assignment 
k means was used as an exploratory data analysis mechanism  as well as understanding properties of each
group by exploring properties behind its centroids 
 

fithe em algorithm  used when a latent random variable is suspected  in this case  the different styles
bach may have used   performs maximum likelihood estimation in a two step mechanism  it first constructs
a lower bound on the likelihood via jensens inequality  by equating the new distribution of the latent
variables to be the posterior distribution of the latent variables given the observed variables and the current
parameters   e step   then optimizes it  by maximizing the lower bound of the likelihood with respect to the
parameters   m step   it was another option over the k means algorithm  in that it allowed us to observe
potential distribution properties of the latent variables  besides looking at centroids  all data analysis was
done in r  with packages nnet and mclust for softmax and em respectively 

 
   

results and discussion
individual voice clustering classification

for clustering  besides attempting to lower the misclassification rate  we hoped to identify variables of
interest that strongly influence the classification of voice lines into their voice types  as the goal was to study
the properties of different melodic lines 
the k means approach  k      corresponding to satb voices  yielded a misclassification rate of       
with most errors misidentifying the sat voices  only    involving both type i or ii errors involving the
bass line   this implies that the bass line is most distinct  followed by the soprano line 
table    k means cluster results versus actual voice type

s
a
t
b

one
   
  
  
 

two
  
  
  
 

three
  
  
   
 

four
 
 
 
   

 a  cluster results  plotted against first two principal
components 

the softmax approach had a    fold cross validation error of        with the dataset  the p values were
calculated for each estimator using the test statistic of z   e i     only the p values that were statistically
var i  

significant  i e  p value less than       for the null hypothesis that i      were considered for analysis 
as an entire predictor  only averagemelodicinterval and rangeindivvoices were statistically significant for all three voice types  one of the four categories  the bass  was arbitrarily used as the baseline  hence
only three predictors were needed   for both predictors  the bass had the highest average melodic interval
and the largest range of individual voices  agreeing with music theoretical approaches of wide movements in
the bass line  amongst other variables that were statistically significant  the alto and tenor both showed
increased percentages of repeated notes  the soprano generally had faster melodic tempi and a lot more

 

fidiatonic movement  as opposed to chromatic movement   for all data  duration of melodic intervals was not
a useful predictor 

   

chorale clustering  unsupervised learning

in picking the appropriate k to use for the initial k means exploration  we elected to use the elbow method
 b   a visual inspection method that attempts to find the maximum number of k for which the improvements
by adding one more are minimal  in this case  looking at the smallest angle for each point  when plotted
against residual sum of squares  with respect to centroids    while there was no clear cut change in gradient 
an observable bend at k     was noted  and as such k was initialized to be   

 b  elbow method plot  rss against k 
we pick the point with sharpest change
of gradient  here   

 c  cluster visualization  plotted on
first two principal components 

the initial round of clustering  c  produced an equal sized grouping of clusters  observing the cluster
centroids  the key findings were that the four groups had properties corresponding to 
   arpeggiated  repeated notes
   small range
   big melodic interval  few repeated notes
   long melodic arcs  highly consonant  big range
the em algorithm  which proceeded by a gaussian mixture modelling   by contrast  returned a cluster
number of    based off the calculation of the bayes information criterion  bic     ln l  k ln n   the lowest
bic for all models returned a model that had an ellipsoidal distribution  had equal volume and orientation 
and had   clusters 

 d  classification boundary    cluster model 

 e  biplot of variables    cluster model 

however  the em algorithm has one cluster with only    of data points       while the other cluster had
    of the data points  furthermore  a classification decision boundary  on a two dimensional feature space
 

ficomprising the first two principal components of the data   d  reveal a circular inner  coupled with an outer
and scattered cluster 
similarly  a biplot of all variables  e  do not reveal two distinct cluster groups  while a density model of
both latent variables  cluster groups   f  show that both means overlap within a high density region  hence
making it hard to separate the clusters into linearly separable groups 

 f  density plots    cluster model 

 g  classification boundary    cluster model 

another round of em was conducted  this time with k      in conformance to the elbow result   the
results were not as clear as that of k means  featuring a substantial proportion of outliers  g   the findings
of the em demonstrate that perhaps more variables might be required to make a more conclusive stance on
cluster assignments  and that perhaps bach did not actually have multiple styles used  furthermore  the
em algorithms failure to detect any substantial clear cut clustering may have to do with the assumption
required that the model was gaussian  some of the variables  e g  dissonance  was more likely than not
drawn from either a bernoulli model or some non gaussian distribution 

 

conclusions and future work

our first goal  investigating the differences in musical lines through structural elements  proved useful
in constructing a typology of voice type  the conclusions  mostly through softmax   which include bass
lines having widest jumps and largest range and soprano lines having faster melodic tempi etc  conform to
theoretical part writing rules 
however  our second objective   to observe clustering within different bach chorales   proved mixed  a
potential failing of the em algorithm  as pointed out  could have been the gaussian assumption  while the
k means centroid analysis could see further research done on it  not only to verify that such groupings exist 
but to see how it may have correlated with his other works across time  his cantatas  large scale masses  
it follows that future work would include investigating our second objective even further  we could gather
data for other composers and run em other algorithms to clarify the potential failing of our em algorithm
and see if style differences manifest  we would also perform further contextual analysis by extracting features
for date of composition  only available for some pieces   this would enable us to investigate not only if
a composers style changed over time  but also how their composition style corresponds to the liturgical
calendar  which was a major influence for much of western musical tradition  overall  the insights gleaned
from more research in this area would shape musicians understanding of these pieces and the subtleties that
accompany them 

 

fireferences
    allan  moray  and christopher ki williams  harmonising chorales by probabilistic inference  advances in neural information processing systems                  
    morris  robert d  new directions in the theory and analysis of musical contour  music theory spectrum                      
    quinn  ian  and panayotis mavromatis  voice leading prototypes and harmonic function in two
chorale corpora  mcm       
    temperley  david  probabilistic models of melodic interval  music perception  an interdisciplinary
journal                    
    witten  ian h   leonard c  manzara  and darrell conklin  comparing human and computational
models of music prediction  computer music journal               

 

fi