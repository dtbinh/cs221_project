classification of behavioral decision using
pre decision neural activity

blue sheffer
symbolic systems program
stanford univeristy
bsheffer stanford

bora erden
symbolic systems program
stanford univeristy
berden stanford

 

introduction

our project aims to use classification techniques to study decision making processes in macaque
monkeys  we are working with the newsome lab in the stanford school of medicine  whose research agenda is to understand the neuronal processes that mediate visually guided behavior  to this
end  they conduct parallel behavioral and physiological experiments in animals that are trained to
perform selected perceptual decision tasks  see experimental design   by recording the activity of
cortical neurons during performance of such tasks  initial insights are gained into the relationship of
neuronal activity to the animal behavioral responses  our combination of behavioral  electrophysiological and computational techniques provides a realistic basis for neurophysiological investigation
of cognitive functions such as perception  memory and motor planning  for our project  we use neural data from nuclei implicated in perceptual decision making to predict the decision of an animal
during a behavioral experiment 

 

related work

this project builds upon existing knowledge of the information encoded by the primary motor cortex
 m   and dorsal premotor cortex  pmd   dr  newsome  along with other neuroscientists focusing
on decision making  have established that areas that are responsible for planning and executing a
motor task during a perceptual decision making task show decision signals prior to the decision     
what is meant by these signals is that some neurons in those areas will increase their firing rates over
time selectively for one decision  further  recent work in the field has used classification techniques
on electrophyshiological data to predict behavior        

 
   

experiment and dataset
experimental design

we worked with data collected from a series of experiments with macaque monkeys and a random
visual stimulus  there are two versions of the task  one where the monkey reports his decision with
his arm  and one where he does this with his eyes  but this is of little importance to the classification
problem  this stimulus consists of some small dots moving in a specified direction  signal dots 
interspersed with others moving randomly  noise dots   by changing the ratio of signal to noise
dots we can change the strength of the motion signal they carry  perceptually  as the ratio of signal
to noise dots  coherence  decreases  it becomes harder to tell in which direction the signal dots
are moving  the time course of a trial is the following  the monkey starts a trial by putting his
hand eyes on a predetermined fixation point  the trial then starts and the two choice targets where
the monkey will eventually move his hand eyes appear on screen  then the stimulus comes on for  
second  finally  when the monkey sees the go cue  he reports the net motion of the dots by moving
 

fi b  epochs for decision reporting by arm
movement and eye saccades
 a  random dot stimulus

figure    visual discrimination task

his hand eyes to the corresponding target  the monkeys decision is the outcome we are trying to
predict 
   

data

while this happens  we record from two    channel multielectrode arrays in pmd and m  from
neurons that are known to plan and control arm movement  using this data  we classify the neural
activity to predict which way the monkey will respond  this is reasonable task  using the decision
signals mentioned in related work 
the data goes through a few stages of processing before it enters the classification algorithms  the
electrodes record purely electrical signals  so the data at that point is just time series of voltages for
each trial and each electrode 
then  knowing the typical electrical waveform of a neuron firing or spike  we mark as a spike a
certain threshold crossing 
finally  we spike sort our data  spike sorting is the process by which the electrical signal from one
electrode is clustered into multiple proto neurons or units  since the electrode is not directly inside
a neuron  but rather somewhere around it  there can be up to   neurons around it contributing to its
associated voltage  therefore  to extract the firing rate of a single neuron  we have disentangle the
spikes and cluster them into units  to do this  we used ica and pca on the features of each spike
and used k means clustering  we used plexon  a commonly used software for multielectrode spike
sorting to do these last two steps  threshold crossing  and spike sorting   one important point that
we will come back to later is that this spike sorting is optional  we can use unsorted data  which
looks identical to sorted data  except that each electrode is not divided into units 
the final form of our data is thus a matrix of trials x time step x units  where each element is the
number of spikes in that time step for that unit during that trial 

 

methods

to classify our data  we used two algorithms  logistic regression  lr  and support vector machines
 svm  
   

logistic regression

logistic regression is a popular and widely used model for classification  given a feature vector
x i   rn and corresponding labels y  i    logistic regression finds   rn    with the extra entry
as the intercept term  such that the hypothesis h  x    p  y     x     for logistic regression 
 
the hypothesis is the logistic or sigmoid function  h  x    g t x      exp 
t x    fitting  is

p
m
 
 i 
 i 
achieved by minimizing the cost function j      m i   y log h  x         y  i    log   

h  x i       we used both logistic regression and logistic regression with    regularization  where
we add the penalty term       to j    regularization is used to incentivize the minimization
to choose small values for the entries of   thereby preventing overfitting  we used matlabs
glmfit  lassoglm and glmval functions for our implementation 
 

fi   

support vector machines

support vector machines is a powerful classification algorithm that constructs a separating hyperplane between the two classes  the hyperplane is chosen as to maximize the geometric margin 
w t  i 
b
with respect to w and b where    min y  i      w  
x     w  
   intuitively  this makes the dei       m

cision boundary with the greatest distance between the boundary and the data points  by a lengthy
derivation which we omit here  we can show by lagrange duality that this optimization is equivalent
to
maximize


subject to

w     

m
x

i 

i  

m
  x  i   j 
y y i j hx i    x j  i
  i j  

i     i              m 
m
x
i y  i     
i  

the equivalence of the optimization problems is dependent on the karush kuhn tucker  kkt 
conditions  if we reformulate our svm optimization problem to include    regularization with
penalty weight  or box constraint  c for the case of non separable data  we simply modify our
first constraint such that    i  c  i              m   for our model  we use    regularization in
the early experimental epoch where the neural data cannot possibly be indicative of the monkeys
decision  and hence the data is far from linearly separable   we used matlabs svmtrain to
train our svm  and svmclassify to classify test data 

 

experiments and results

the classification problem we tackled is highly symmetrical  by that we mean that it is a binary
classification task  where both outcomes are nearly equally likely  the percentage of trials where the
monkey chose left is         this entails that confusion matrices  accuracy vs  precision etc  can
be expressed without loss of information with the prediction accuracy  thus  prediction accuracy
will remain our main metric  accuracy is calculated with   fold cross validation 
the more quantitative metric that we will use to distinguish between classifier is the prediction
accuracy at the end of the dots stimulus  since this is the point in the trial where most of the sensory
information from the visual stimulus has made it to m  and pmd where the electrodes are recording
from  and thus classifiers can differ the most 
   

logistic regression

for each session  our two multielectrode arrays each yield a matrix of trials  time step  units 
where the value of each element is the firing rate during that trial at that time step for that unit  we
first tried to classify the monkeys choice using only one multielectrode  e g  pmd data  at a time 
using lr  we yield a striking     accuracy at the end of the dots on epoch  figure    
we then explored concatenating the pmd and m  data matrices in the units dimension to exploit
the most predictive features of both nuclei  but as soon as we ran lr on the combined data set  we
realized we had an overfitting problem  figure     our prediction accuracy at the end of dots using
just pmd was at        whereas with both it was only at       

 

fifigure    prediction accuracy using lr with
only the pmd multielectrode

figure    prediction accuracy using unregularized
lr with both pmd and m 

our next step was therefore to use    regularization  at this point we experimented with different 
values  penalty term  to find a satisfactory one  figure     we settled at a  value of        since it
had the highest prediction         accuracy during dots 

figure    comparison of accuracy with multiple lambda values
   

support vector machines

our initial pass using lr seemed to be doing well with almost     accuracy at the end of dots 
but we hypothesized that using svm  possibly with non linear kernels  would allow us to extract
many more features from our data  we first searched the parameter space for the box constraint  as
discussed in     and the kkt conditions violation level  the proportion of points allowed to break
the inequalities   figures       
it seemed like these values did not affect the prediction accuracy significantly  we then tried different
kernels  linear  quadratic  polynomial  gaussian radial basis  and multlayer perceptron  surprisingly 
the linear kernel performed best  we tested for overfitting but this was not the case  see discussion
and conclusion  

 

fifigure    comparison of accuracy with
multiple box constraint values

figure    comparison of accuracy with multiple
kkt violation values

figure    svm trained on sorted data

figure    svm trained on unsorted data

finally  we come back to the sorted unsorted difference  our last figure the difference between using
sorted and unsorted data  with a prediction accuracy of        unsorted accuracy is just a few points
shy of sorted accuracy with        figure   and     this leads us to believe that using unsorted data
is satisfactory for closed loop experiments  see conclusion  

 

discussion and conclusion

our analyses have shown that svm performs both better and faster  up to  x  than lr  additionally
a linear kernel achieves highest accuracy  though this will undoubtedly be our next focus of analysis 
our efforts leave us in a good position to continue this scientific question  the next step is to train
a classifier on one days data  and then apply it online while the monkey is performing the task 
and to use the prediction to modify the experimental conditions  e g  interrupt the trial when the
prediction reaches threshold certainty  and ask the monkey to report his decision at that moment  
to do this  we would not be able to sort the data clearly  and the computation would need to be done
in a reasonable time scale  both of which we have shown to be possible 
acknowledgments
we thank our faculty mentor  dr  william newsome  our research supervisor  diogo peixoto  and
all of the members of the newsome lab 
 

fireferences
    shadlen  michael and william t  newsome  neural basis of a perceptual decision in the parietal cortex
 area lip  of the rhesus monkey  journal of neurophysiology                         
    kiani  roozbeh  christopher j  cueva  john b  reppas  and william t  newsome  dynamics of neural
population responses in prefrontal cortex indicate changes of mind on single trials  current biology      
                 
    kim  jn and michael shadlen  neural correlates of a decision in the dorsolateral prefrontal cortex of the
macaque  nat neuroscience                    

 

fi