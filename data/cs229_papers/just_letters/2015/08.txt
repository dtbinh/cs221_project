thyroid dysfunction  prediction and diagnostics
albert y  lui   alexandra m  pappas
december         
i  introduction

ii  data preprocessing

the thyroid gland is responsible for regulating human metabolism by controlling the production of
thyroid hormones  these compounds are known to
have widespread effects on the human body  and their
misregulation often leads to significant symptoms 
patients usually present with heart problems  rapid
weight loss gain  fatigue  and anxiety     diagnostically  thyroid dysfunction is grouped into two categories  hyperthyroidism and hypothyroidism 

the focus of this project was to predict thyroid dysfunction in healthy and undiagnosed patients  of
the    outcome categories in the data     did not
meet this criterion and were removed  the set of
     eligible patients  of the original       were then
grouped into three categories based on the remaining   outcomes  euthyroid  normal   hyperthyroid  
and hypothyroid  
there were many observations with missing
data  which occurred mostly among measurements
of biomarker concentrations  we decided against imputation as it assumes that the data is missing at
random  for our data set  this is unlikely  doctors
are more likely to order for lab tests when patients exhibit symptoms consistent with thyroid dysfunction 
thus  missing data may be an indicator of patient
health  and imputation would mask this effect  instead  we opted to use methods that could appropriately deal with missing data  or we otherwise removed
troublesome observations for methods that could not 

the american thyroid association  ata  reports that more than   in    americans develop thyroid disease during their lifetime  currently  an estimated    million individuals in the us suffer from
some form of thyroid disease  and up to     are unaware of their condition     although hyperthyroidism
and hypothyroidism are rarely life threatening  because of their widespread but subtle symptoms  these
conditions can often significantly lower the patients
quality of life 
the main focus of this project was to use various
learning methods to model the presence of hyperthyroidism or hypothyroidism in previously undiagnosed
patients who were otherwise healthy  our approach
was exploratory  to compare different models and
elucidate any structure within the data  ultimately 
we hope that these results could help develop more
sensitive guidelines in thyroid disease diagnostics 

prior to removing observations in an effort to
deal with missing data  the tbgm and tbg variables were dropped  as      of the      patients
had no data here  afterward  only complete cases
were kept  leaving      observations        were removed  and    predictors  a summary of the final
data sets after preprocessing is shown in table   
 concurrent illnesses  undergoing thyroid hormone replacement therapy  and undergoing anti thyroid treatments
 including hyperthyroid  t toxic hyperthyroid  toxic goi 
ter  and secondary toxic hyperthyroid 
 including hypothyroid  primary hypothyroid  compensated hypothyroid  and secondary hypothyroid 

the data used for this project was obtained
from the garavan institute  an australian research
facility  all relevant patient information was collected between      and      and subsequently deidentified     more details can be found in table   
 

fi  of observations

  of features

  of outcome observations

data set

training
   

hold out
   

total

bin 

cont 

total

eu
   

hypo
   

hyper
   

raw


  


  

    

  

 

  

    
      

   
     

   
     

full

    
      

    
      

    

  

 

  

    
      

   
     

   
     

reduced

    
      

    
      

    

  

 

  

    
      

   
     

   
     

table    summary of data set characteristics  sizes  types of features  and outcome distributions  

through    fold cross validation  the features were
not scaled in the procedure for knn  testing these
the full and reduced data sets were split into two fitted models on the reduced hold out set gave generpartitions  the training set for model construction  alization errors of         and          respectively
and the hold out set for model evaluation  where  figure    bottom right  
relevant  forward stepwise feature selection and pathe learning curves for both models were then
rameter tuning were performed on the training set via plotted  figure    top row   these revealed that the
   fold cross validation  in both data sets  approxi  knn model was overfitting the training data and sufmately     of patients were diagnosed with thyroid fered from high variance  the multinomial logistic
dysfunction  a trivial predictor  i e   one that clas  model  on the other hand  did not have this issue 
sifies all patients as euthyroid  would give     mis  we speculate that the poor performance of knn is
classification error  as such  this was our starting consistent with the curse of dimensionality  since our
baseline for improvement  details can be found in feature space has    dimensions but only about     
table   
points 
iii  methods

in an effort to mitigate the effects of overfitting in knn  we reduced the feature space using
iv  logistic regression  
forward stepwise feature selection with    fold crossk nearest neighbors classification
validation error  the shrunken knn s  model contains    features and gave a generalization error of
given the multi class classification problem at hand           figure    bottom right   the learning curve
we began our analysis with multinomial logistic re  also indicates far lower variance in the fitted model
gression  which determines a linear boundary in the along with a lower misclassification rate 
feature space  to assess the linearity of class boundnote that the linearity of the class boundaries
aries  we also decided to use k nearest neighbors
are
inversely
related to the magnitude of k in knn 
 knn  classification  which can be adjusted to form
thus 
with
the
optimal value of k     for our reduced
highly non linear boundaries  as neither can cope
data
set 
we
speculate
that the boundaries separatwith missing values without imputation  both were
ing
euthyroid 
hyperthyroid 
and hypothyroid obsertrained on the reduced training set 
vations may be highly non linear 
multinomial logistic regression was directly fit thyroxine  qthyroxine  antithyroid  sick  lithium  goiter 
ted and evaluated  as no parameters required tuning 
the optimal value of k     for knn was determined tumor  hypopituitary  tsh  and t  
 

fimodel

param 

feat 

gen  error

logistic



  

       

knn

k  

  

       

k  

  

       

svm

c     
       

  

       

svm s 

c     
       

  

       

knn

 s 

figure    top row  bottom left  learning curves of misclassification error over training set size  generalization error
 solid  and training error  dashed  curves are also shown  full model curves are in blue  and smaller model curves
 with forward stepwise feature selection  are in red  bottom right  model summaries  the  s  superscript designates
forward stepwise feature selection 

versus           despite this  the svm still outperforms the multinomial logistic model  knn  and
knn s   

v  support vector machines
to further explore the boundary non linearities  we
opted to use support vector machines  svm  with radial kernels   unlike multinomial logistic regression
and knn classification  svms are inherently binary
classifiers  to extend this into the multi class setting 
we used the one versus one classification strategy    

again  we addressed this problem of high variance by reducing the feature space through forward stepwise feature selection  the shrunken model
svm s  contains    features with a generalization
error of          while this is not a significant imfeatures  
as with before  the parameters c and  were provement over the full model  with all   
 s 
the
learning
curve
indicates
that
svm
does not
selected through    fold cross validation  which gave
overfit
nor
does
it
suffer
from
high
variance 
the optimal values of c      and          the
learning curves for this model  figure    bottom left 
the two shrunken models knn s  and svm s 
red  reveals severe overfitting  with training error both selected for    features from the original set
   times lower than the generalization error        
 k u  v 

 thyroxine  qthyroxine  pregnant  surgery  i     goiter  tumor  tsh  tt   and fti 

  exp ku  vk   

 

fiof     these selections were not identical  though
five made it into both models  thyroxine  qthyroxine 
goiter  tumor  and tsh 

vi  classification trees  
bootstrap aggregation
the appeal of using decision trees  cart  for this
project is three fold   i  it lends itself very well to
easy interpretation   ii  it inherently performs feature
selection  and  iii  it has simple methods of dealing
with missing data     in order to compare cart to
the previous methods  we fitted two models  one over
the reduced set and another over the full set of data 
the decision trees were grown and subsequently
pruned using the optimal cost complexity parameter
  this value was determined using    fold crossvalidation error  and to further ease model interpretability  we opted to follow the one standard error
heuristic to generate a simpler tree     the values were
       for the reduced data set and          for the
full data set  for missing values  a surrogate splitting
strategy was used 
the cart model fitted on the reduced training set out performs all previously discussed models 
this fact was particularly surprising in the context of
the trees simplicity  figure    left   with only two
splits  on tsh and fti   this model achieves a generalization error of          this is in contrast with the
next best model svm s    at         misclassification
rate with ten features 

figure    decision trees  cart  trained on the reduced and full sets of data  respectively  both trees
were pruned using the cost complexity parameter determined using the one standard error heuristic on   fold cross validation errors 

on the other hand  the cart model trained on
the full data set gives even higher performance  with a
generalization error of          this  however  is not
surprising for two reasons  firstly  there are many
more observations in the full training set       versus
       secondly  as we had mentioned previously 
ble learning allows lower bias by using more flexible
the missing values may contain information regarding
fits  while tempering high variance by averaging the
patient health 
predictions over multiple base learners  using an enin an effort to further lower the error rate at the semble of n        decision trees  no pruning   we
cost of low interpretability  we bootstrap aggregated achieved generalization errors of         over the re bagged  the decision trees  this paradigm of ensem  duced set and        over the full set of data 
 

fivii  conclusions

from our analysis  it appears that thyroid dysfunction can be predicted to good accuracy using tsh 
fti  and tt  in a simple decision tree  cart   in
the context of human physiology  these results are
not surprising  specifically  fti and tt  are measurements of thyroid hormone concentration  so one
would expect hyperthyroid patients to have elevated
levels  the inverse would also be true of hypothyroid
patients     tsh concentration is inversely related to
that of thyroid hormones  thus  higher tsh would
be indicative of lower thyroid hormone levels    

data set

model

gen  error

reduced

logistic
knn s 
svm s 
cart
cart b 

       
       
       
       
       

full

cart
cart b 

       
       

table    generalization errors for the various methods
used and over the two data sets  the superscripts  s 
and  b  respectively designate forward stepwise feature
selection and bagging 

in the practice of medicine  thyroid disease diagnosis suffers from high inconsistency  especially with
respect to tsh assays  some have argued that national standardization of techniques may be helpful
in improving patient care     despite this  our results
suggests that a level of less than   ui ml may be a
good global cut off  regardless of assay  

to determine the validity of the above assertion  however  to do so  it would be preferable to collect a better set of data  specifically   i  more recent data  as
this set was from the mid     s   ii  more complete
data  to see if other classification methods can perform better than decision trees  and  iii  a larger set
of data from a larger variety of sources 

one possible avenue of future research would be
viii  references

 free

thyroxine index
t   thyroxine 
 thyroid stimulating hormone
 total

    thyroid diseases  medlineplus  u s national library of
medicine  u s  national library of medicine     nov       
web     dec       
    american
thyroid
association 
general
information press room 
 n d   
retrieved december   
     
from http   www thyroid org media main abouthypothyroidism 
    free t     the test  american association for clinical
chemistry     oct        web     dec       
    faix  james d   md  and linda m  thienpont  phd 
thyroid stimulating hormone    aacc org  american
association for clinical chemistry    may       web    
dec       
    tsh    the test  american association for clinical chemistry     oct        web     dec       
    james  gareth  daniela witten  trevor hastie  and robert
tibshirani  an introduction to statistical learning  with
applications in r  new york  springer science business
media        electronic 
    lichman  m          uci machine learning repository
 http   archive ics uci edu ml   irvine  ca  university of
california  school of information and computer science 

figure    variable importance of the bagged decision
trees  cart   only the ten highest are shown  as all
others had values less than        and were omitted
for clarity 

    hastie  trevor  robert tibshirani  and j  h  friedman  the
elements of statistical learning  data mining  inference 
and prediction   nd ed  new york  springer        print 

 

fi