farmx  leaf based disease identification in farms
cs     project report
fall     
kushal chawda

chanchal hazra

 kchawda chanchal  stanford edu

  

introduction

cally photographed the diseased leaves with a black background  they got accuracy ranging from    to      for
selected diseases 
in our view  using a camera independent color space
and using texture only features seemed to be good
choices to approach the problem  also  like others we decided to manually collect the data set  however we used
public domain images from the internet  we also decided
to compare the two methods for background separation
 k means vs gaussian mixtures   unlike others  we limited the number of texture features to just contrast  correlation  energy and homogeneity 

the delay and inaccuracy of identification plant diseases
is causing significant reduction in both quality and quantity of agricultural products  for example  it is estimated
that total losses are amounting to approximately     of
the produce      since the current practice of detection
and identification of plant diseases is mostly based on visual observation by the experts      automatic detection
of plant and related diseases based on a leaf image would
be very helpful for the farming world and it will speed
up deployment of remedy quickly to reduce or eliminate
damage from the disease 
the input to our implementation is a picture of a diseased leaf along with the healthy and diseased portions 
the output is the name of the disease that is affecting the leaf  in this project we evaluate several machine
learning techniques to  i  identify the diseased area  we
used k means and gaussian mixture  and  ii  identify
the disease  we used linear svm  quadratic svm  kmeans and lda  by classifying among four classes of
diseases 
  

  

the dataset

since the dataset for diseased leaf images were not publicly available  we used a subset of images having creative commons licence from the flickr website of dr 
scott nelson      we manually downloaded images for
four categories of diseases 





related work

we have seen a few publications where researchers are
attempting to automate methods to detect the plant diseases based on images             
in      used texture ccm features and a mahalanobis
distance based classifier to achieve     accuracy  they
also used a neural network with lower accuracy numbers 
they physically photographed images themselves using
a black background 
the leafsnap system for leaf classification      used
gaussian mixtures for initial segmentation and used tophat transformation on top of the segmented image to remove the stem  they generated curvature features using
histogram of curvature over sale and classified images
using k means they used the hsv color space
alrahamneh et al      used k means for initial segmentation and used ostus method for thresholding and
masking healthy images  they used mainly texture features and got a high level of accuracy        hsi color
space was used here 
in      barbados et al  used intensity histograms from
each of different color spaces  hsv  l a b  and cmyk 
and used modified pairwise voting system to gauge the
likelihoods of a particular disease being present in that
leaf  only intensity information was used  they physi 

bacterial blight    images 
rust    images 
corynespora leaf spot    images 
mildew     images 

blight

leaf spot

mildew

rust
fig     sample images from our data set

  

high level framework

the high level framework is outlined as follows 
 background removal  we wanted to extract features from only the diseased portion of the leaf 
 

fiis more resilient to changes in lighting conditions     
we chose the  hue  saturation  value  hsv color spaces
since the hue value remains same for varying lighting
conditions  we used rgb hsv function in matlab to do
this conversion  fig    shows the various channels of a
diseased leaf  comparing rgb channels with hsv channels  in this figure it can be seen that the s and v are
dominant for the diseased part and were thus used for
segmentation 

fig     image processing pipeline

  

hence this step removes the healthy portion of the
leaf 
 feature extraction  we chose only texture features
 contrast  correlation  energy and homogenity  
since we found our dataset contained diseases of
varying texture and wanted to extract only the texture features 
 classification and error analysis  we consider four
models  linear svm  quadratic svm  lda and kmeans  for classification and generate confusion matrices and performance metrics 
  

background removal

a 

choosing the color space

k means vs mixture of gaussians

we wanted to compare k means vs  mixture of gaussians
for segmentation and also wanted to arrive at optimal
value of the number of segments k   we found good visual results with k   for k means and   gaussians for
gaussian mixture  the reasoning behind selecting four
was that the leaf would be segmented by  i  healthy areas      diseased areas     leaf stem     camera reflection
or water  
for each of the identified segments  we created four images which masked the pixels that did not belong to the
identified segment  all three components set to zero  
the advantage of doing this was that the segmented
portions could be viewed in the rgb space for visual
inspection  without conversion   also since the segmentation did not use the hue channel for k means or em  it
can now be potentially used by converting back from the
identified cluster segments in the rgb space  results of
this process is shown in figure    here we can see that
in case of em with four gaussians  the diseased part includes small part of the stem and surrounding healthy
areas  while in case of k means separation is more distinct  however  in case of k means the area of the diseased part is lower due to the hard separation  this was
actually preferred  because our feature is texture based
and we dont want to include healthy portions of the leaf
with the diseased part 

since our dataset had images with varying lighting conditions  we wanted to choose a color space that is more resilient to this      we chose the  hue  saturation  value 
hsv color spaces since the hue value remains same for
varying lighting conditions  we also found a convenient
function in matlab rgb hsv  to convert rgb to hsv 
which made it a good choice to start with  fig    shows
a comparison between rgb and hsv channels of the
input image 

  

choosing the diseased segment

in order to select the segment containing the diseased image  we average the hue portion of the non zeroed pixels
across each segmented image and select the image that
is farthest away from the hue value of green         in
matlab   while this method works on most images  this
might not work for leaves where the healthy color is not
green  in such cases we manually correct set diseased image to correct segment  since the number of such images
were limited  we were easily able to do this  this was also
an important step since we did not want to incorrectly
use healthy images to training disease classifiers 
fig     rgb vs hsv color spaces
b 

  

features

a 

feature extraction

we used gray level co occurrence matrix  glcm 
based features on each hsv channel of the segmented
image containing diseased areas  a glcm matrix shows
how often a pixel with the intensity  gray level  value i

image segmentation

since our dataset contained images having varying lightning conditions  we wanted to choose a color space that
 

fiand value channels each respectively  we wanted to select the subset of these    features  f  f    that minimize the cross validation error  we tried multiple models
and found the quadratic svm gave us best results  as
seen from fig     we chose features  f  f  f  f   f   
since this gave us the best results and also because it
completely eliminated the hue channel from feature selection  eliminating the hue channel is desirable since it
makes our features more resilient to varying color conditions 

fig     segmentation using em vs k means    parts 
occurs in a specific spatial relationship to a pixel with
the value j  features were thus defined as follows 
 contrast  measures local variations in the graylevel co occurrence matrix 
 
x
 
 i  j  p i  j  

fig     top ten feature combination using forward search

i j

features   and   seemed to be dominant in being able
to visually cluster the subset of our selected feature set 
as seen in fig     we are able to visually cluster the data
after making a scatter plot of f   vs f 

 correlation  measures joint probability occurrence 
 
x  i  i  j  j p i  j 
i j

i j

 energy provides the sum of squared elements in
the glcm 
 
x
 
p i  j 
i j

 homogeneity  measures closeness of the distribution of elements in the glcm to the glcm diagonal 
 
x p i  j 
     i  j 
i j
we extracted these four features from each of hue 
saturation and value channel  resulting in    featurs in
total  we wanted to first start with these features to see
how the results were before deciding to modify them 
we used matlabs graycomatrix and graycoprops functions to extract the features from the selected hsv segmented image channels 
b 

fig     scatter plot of f  vs f   contrast in s channel
vs contrast in the v channel
  

models

we used svm  linear and quadratic   k means and
lda to train and compare classification performance 

feature selection

given these   features contrast  correlation  energy
and homogeneity in order  from the hue  saturation

svm  an svm classifies data that has exactly two
classes by finding the best hyperplane that separates all
 

fipoints of one class from the other class  the best margin
hyperplane that maximizes the margin between the two
classes is given by the following optimization problem 
m

x
 
min w b   w      c
i
 
i  
s t  y  i   wt x i    h      i   i           m
i     i           m
for svm  we used an l  soft margin classifier with
c   
in order to achieve multi class classification  we use
the one vs one approach which constructs one classifier per pair of classes  during prediction  the class which
received the most votes is selected  in the event of a tie
the class with the highest aggregate classification confidence is selected  this method thus builds n  n      
classifiers  where n is the number of classes 
we compared results across two kernel functions 

fig     overview of results comparing background segmentation methods  em and k means  along with the
performance for various learning algorithms
 with all    features   all the models were trained
and compared with the optimized feature selection
 f  f  f  f   f    
fig    shows us the overall accuracy numbers  we see
accuracy of       on quadratic svm with k   background removal  this makes sense for a texture based
feature set because we need the hard separation  confusion matrices are shown in fig   and     we see in case of
the linear svm the maximum miss classification seems
to be between blight and leaf spot  which also makes
sense because they are visually similar as seen in fig   
we see that lda does not perform as well as other
models  in case of gaussian mixture based segmentation  we see that the texture based classification seems
sensitive to noise in the texture based features  we
were able to visually confirm  as seen in fig    that
diseased portion of the images segmented using gm included healthy areas as well 

 linear kernel  the linear kernel has the form 
k xi   xi    

p
x

xij x ij

j  

 quadratic kernel  is a polynomial kernel and has
a much more flexible decision boundary 
k xi   xi         

p
x

xij x ij   

j  

we also wanted to use discriminative models 
 lda  we used mixtures of gaussians with a diagonal covariance matrix to model the parameters of
a gaussian for each class  the prediction tries to
minimize the classification cost given by 
x
y   argminy     k
kp  k x c y k 

  

for the best performing model  quadratic svm with kmeans background separation with k     chosen with
optimized feature set  we see our accuracy is        the
precision  recall and f  scores for each classifier are
shown in fig    are within     to      
since we have fairly high accuracy  our next step would
be to focus on recommendations to treat the disease  in
order to do this better  we would have to identify the
species and build a dataset having recommendations 
as seen from the em case  our model is sensitive to
inaccuracies in background removal  we would thus focus
on making it robust to be able better select the diseased
cluster and ensuring the diseased cluster does not have
healthy areas  given more time  we could train a classifier to just recognize diseased segments of the image to
make the background separation more robust 

k  

where  y is the predicted classification  k is the
number of classes  p  k x  is the posterior probability of class k for observation x and c y k 
 k means we use k means as a classification and
also as a segmentation algorithm  for segmentation 
the points are labelled belonging to k   clusters 
and for classification the point is classified based on
the closest cluster centroid 
  

conclusion future work

results

we used several classification models with   fold cross
validation to compare learning algorithms 
we used matlab to compare results across  k means 
linear discriminative analysis  linear svm and
quadratic svm  the optimized feature selection gave
us a    improvement over the previous set of results
 

fifig      confusion matrix with gaussian mixture b g
separation for     leaf spot       blight       mildew 
and     rust 

fig     confusion matrix with k means b g separation
for     leaf spot       blight       mildew  and     rust 

          
   sastry  k  subramanya  a  zitter  thomas  management of virus and viroid diseases of crops in the tropics springer        
   neeraj kumar and peter n  belhumeur and arijit
biswas and david w  jacobs and w  john kress and
ida lopez and joo v  b  soares leafsnap  a computer
vision system for automatic plant species identification  http   leafsnap com dataset         
   https   www flickr com photos scotnelson  
   hsv color space 
https   en wikipedia org wiki hsl and hsv 
   forcyth  ponce  computer vision  a modern approach
isbn                  
   h  al hiary  s  bani ahmad  m  reyalat  m  braik
and z  alrahamneh fast and accurate detection and
classification of plant diseases international journal
of computer applications             volume    no   
march     
   shi yun   wang xianfeng   zhang shanwen   zhang
chuanlei pnn based crop disease recognition with leaf
image features and meteorological data int j agric biol
eng  aug     
   jayme garcia arnal barbedo   cludia vieira godoy
automatic classification of soybean diseases based on
digital images of leaf symptoms  sbi agro  oct
     
    pydipati  r   t  f  burks  and w  s  lee  statistical
and neural network classifiers for citrus disease detection
using machine vision  transactions american
society of agricultural engineers     
             

fig     performance results with k means b g separation for     leaf spot       blight       mildew  and    
rust 
references
   martinez espinoza alfredo  et al  georgia plant
disease loss estimates uga extension ap

 

fi