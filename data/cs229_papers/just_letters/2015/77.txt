cs      machine learning
classifying modality of pain from calcium imaging florescence data
amelia christensen
motivation  when you are bitten by a mosquito  you know that the bump itches  when
you burn your hand on a match  you know that the match was hot  this ability to discriminate
sensory modalities is present  despite the fact that these stimuli activate overlapping sets of peripheral receptors  and travel to your brain generally along the same paths  utilizing overlapping
sets of neurons      how  or where  this distinction emerges  remains unclear in the neuroscience
literature 
to overcome this limitation  we designed a machine learning approach  whereby we built a classifier
to determine  purely from neural data  what modality of stimulus we present to an animal  the
logic is that if the brain region from whence we record neural data is actively involved in task of
detecting the different stimuli modalities  are decoder will be able to easily distinguish between
them  this approach is similar to one often taken in both visual and decision making literature     
collection of neural data  to accomplish this goal  we undertook to record the activity of
neurons in primary somatosensory cortex  of mice   a region that is heavily implicated through
human fmri work  to be important for distinguishing different tactile stimuli      we utilized
transgenic mice that were expressing gcamp f  a transgene that fluoresces whenever the given
neuron it is expressed in fires an action potential      thus  by implanting a glass coverslip over
the cortex of a mouse  we can use two photon fluorescence microscopy to observe that activity
in a large population of neurons at a time  in our experiments  we simultaneously recorded    
neurons at a   hz frame rate  over around a mm  of cortex  see figure    data were processed
using a standard pipeline  pre existent in our laboratory   whereby the images recorded from the
microscope are first registered frame by frame to each other  and then individual cell bodies are
segmented in a quasi manual way  and finally fluorescent time series for each individual neuron are
extracted 

b 

a 

c 

calcium imaging data

registration

window implantation

d 

f 

e 

example image

calcium transients

segmentation

figure    collection of neural data  a   implanted window and head fixation device  d  example
image of neural activity  b e  schematic of image processing pipeline 

 

fiexperimental paradigm  we prepared seven distinct types of stimuli to present to the mouse 
these stimuli types included cold  ice and acetone   hot  a heating pad   mechanical  a clip to put
mechanical pressure on the mouses paw  and sticky tape   vibrational stimuli  a small vibrating
motor   and finally  nothing  we alternated placing these different stimuli on the contralateral hind
paw to the side of somatosensory cortex from which we were recording  neural responses to each
stimulus were recorded for one minute  and then the mouse was given a five minute break  after
which we switched stimuli and recorded again  all told  we recorded five different trials for each
of the seven stimuli  for a total of    minutes of neural recording  all recordings were performed
under light isofluorane anesthesia  which  to the best of our ability  was kept constant throughout
the recording  all data were recorded on one day  from a single mouse 

pca

determining features  given a set of time series extracted from a given group of neurons 
labelled by the trial from which they came  it is not immediately obvious what features should
be defined as  our overarching goal was to predict which stimulus was presented on a given trial 
so our first thought was to use a slice of time from each trial as a training example  where the
features are individual neurons at that slice of time  unfortunately  our results with that approach
were quite poor  see figure     and with all of the classifiers we tried  the classifier mislabelled
almost everything as acetone  and in pca acetone was the only cluster that emerged  while this
is potentially interesting from a neuroscience perspective  its not particularly helpful for the goals
of this project  next  we thought to try a paradigm where each neuron is a training example  and
its label is what trial type the observations of that neuron came from  in this case  the features
time points  this approach was much more successful  and was the paradigm we used for the rest
of the project 

confusion matrix

figure    feature extraction  left  confusion matrix between different stimuli modalities  using
lda as a classifier  results were similar with multinomial regression  naive bayes  random forests 
etc  right  data projected on first two principal components 
supervised learning of stimulus category  we trained four different classifiers on this data
set  all of which achieved above chance performance  specifically  we tested random forests  lda 
multinomial regression  and naive bayes  we used a        train test split  we found that on
this data set  multinomial regression performed best  with lda coming in second  and then naive
bayes  and then random forests  see figure     these results make some sense  because lda and
multinomial regression are very similar mathematically  in fact it can be shown that multinomial
regression is simply a restriction of lda where the covariance matrix of the data is assumed to
be diagonal   the naive bayes assumption is particularly bad for this type of dataset  so its
unsurprising that its performance was lower than that of other algorithms  it is likely that random
 

fiforest  a very complex hypothesis class to utilize on so little data  was overfitting 

  accuracy

  
  
  
  
  
  
 

mnr

lda

n  bayes

rf

confusion matrix

figure    classifier comparison  top  performance of different classifiers on validation set 
bottom  confusion matrix of results using multinomial regression as a classifier 
although these results are much better than chance        in the literature it is common
for such classifiers trained on neural data to discriminate other types of stimuli  typically reach
performance in the high     range  even using very vanilla machine learning algorithms      it is
likely that this difference stems from the fact that in our animals  the mice were not attempting
to discriminate between the different stimuli  the animals were simply passively observing  so its
likely there would be less choice related information present in cortex  in future studies we would
need to collect more data  or design an awake discrimination task  in order to increase performance 
although it may be possible to engineer combinations of features in order to increase this performance a little bit  such manipulations are really uncommon in the neuroscience literature  and
reduce interpretability of the results 
clustering of stimulus category  next we wanted to see whether  when we projected the
data onto an orthogonal basis which preserved a as much variance as possible  using pca   there
were any discernible clusters of the different stimuli modality  pca is very commonly used in
neuroscience to segregate different categories of neural responses to stimuli      when we used the
data in the same way as above  we didnt see any clustering  at least in the  d projection of the
data   however when we average each neurons firing over all of the trials  leaving only one time
series for each neuron in each trial type  suddenly we were able to see clusters  we have included
lda below for comparison 
neural trajectories in state space  next  we wished to use an analysis called gpfa     
sometimes used in neuroscience  to determine whether the trajectories of each trial through neural
 

fitrial averaged data

pc  

pc  

single trial data
pc 

ld  

ld  

pca

pc  

ld  

lda

ld  

figure    unsupervised clustering of data  left column  single trial data  right column  trial
averaged data  here each point is a single neuron 
state space was illuminating  consider that neural state space is space where each axis is a firing
rate of a given neuron  then  each time point in a trial can be thought of as a point in state space 
but this space is very high dimensional  and activity of neurons is sparse in this high dimensional
space  gpfa plots neural trajectories through a dimensionality reduced  using factor analysis 
state space  with some constraints of smoothness imposed  when we performed this analysis on our
data  we noticed that trials in which the stimuli were the most salient  the firing rate of that neuron
seemed to cover the most ground in state space  however  there were no other immediately obvious
aspects of the trajectories where were particularly interesting  as they didnt display particularly
stereotyped behavior  similarly to the classification section  i think if we collected more data  in
a more careful manor  possibly in an active perception task  this would possibly be a more fruitful
analysis 

ice
clip

nothing
clip

ice
clip
nothing
sticky tape
vibration
acetone

figure    neural trajectories in state space  leftmost  clip and ice  two salient stimuli 
similarly show a high amount of variation  in the middle  clip is compared to nothing  where the
nothing trajectory stays in a compact ball 

 

ficonclusion  we demonstrated that we were able to train a classifier from the neural firing
from somatosensory cortex of a mouse  to determine what stimuli we presented to his paw  these
results were far better than chance for all of the classifiers we tried  however even for the best
classifier  the results were still less than we would expect if the brain region was actively involved
in perceiving the difference between the stimuli  we also experimented with different methods for
visualizing the data  including pca  which was only helpful when we trial averaged the data  and
gpfa  which was perhaps more useful for generating abstract art in this context  than insight into
our dataset 
acknowledgements  first and foremost i should acknowledge my labmate saurabh vyas 
who wrote the initial image processing necessary for this project  i should also thank my advisor
scott delp  and the stanford microscopy core  for the usage of their microscope 
citations 
   j  braz  et  al  transmitting pain and itch messages  a contemporary view of the spinal cord
circuits that generate gate control  neuron       
   r m  haefner et  al  inferring decoding strategies from choice probabilities in the presence of
correlated variability  nature neuroscience       
   m c  lee and i tracey  imaging pain  a potent means for investigating pain mechanisms in
patients  bja        
   t w  chen et  al  ultra sensitive fluorescent proteins for imaging neuronal activity  nature 
      
   j p  cunningham and b  yu  dimensionality reduction for large scale neural recordings  nature
neuroscience        
   b  yu  et  al  gaussian process factor analysis for low dimensional single trial analysis of neural
population activity  nips        

 

fi