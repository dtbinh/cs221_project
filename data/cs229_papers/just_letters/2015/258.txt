exploring commodity and stock volatility using topic modeling on historical news articles 
application to crude oil prices
rui jiang  forestj stanford edu   olufolake ogunbanwo  folakeo stanford edu   and mustafa al ibrahim  malibrah stanford edu 

abstract
thorough commodity or stock analysis is a time consuming process because it involves extracting and summarizing information from
large amount of data  the majority of financial studies only focuses on numerical data because it is easier to automate using statistical
methods and because they represent concrete unchanging values  however  focusing solely on numerical data ignores the context and
circumstances of events that led to those values  this study presents a semi automated workflow for studying stock and commodity
prices that incorporates numerical and text based data  the workflow uses topic modeling  latent dirichlet allocation algorithm  to
extract important topics from historical news articles  initial testing of the algorithm was done on     articles from petrowiki  topic
interpretation is made by the user incorporating general knowledge and a simple investigation of representative articles  timedependent frequency of each topic is calculated and correlated with the price  the workflow is tested on        new york times
articles mentioning oil prices between      and       as expected  oil prices are controlled by a number of inter connected factors
related to politics and financial events  ten topics were extracted  corporate finance  commodity and us currency  world economy 
us energy policy  emerging economies  middle east conflict  opec  stock market  us elections and politics  and world oapec
relations  time correlation plots show that  in the long run  some topics such as us currency and us energy policy show a consistent
correlation with oil price while others  such as opec  change with time  in addition  investigation into a larger number of randomly
sampled articles revealed some interesting correlations such as the correlation between oil price and unemployment  whether the
correlation is a causational relationship is unknown  in general  the workflow is useful in identifying important factors that affect the
price of a commodity or a stock  aiding the investigator in financial analysis 

introduction
studying the relationship between stock or commodity prices and external factors is an essential component of the investment decision
making process  knowledge of the critical external factors and how the relevance of each factor changes over time is important  for
example  a company in the united states that utilizes locally made raw materials in its manufacturing plant will not be susceptible to
political and economic changes in china  relocation of its manufacturing plant to china will however  greatly increase its
susceptibility to china  unfortunately  studying this susceptibility is a time consuming process as it requires going through a large
number of reports and financial data  this is especially true for obscure stocks as the investigator does not know in advance the
general factors affect the price 
in this study  we present a workflow for exploring factors related to stock or commodity prices and study their correlation using
machine learning techniques applied on historical newspaper articles  we use the volatility of crude oil price as a case study in this
paper because it is of great interest to consumers  companies  and governments  given the importance of the oil price to global
landscape  the observations from this study may shed some lights on hidden factors which should be considered while making
financial and political decisions related to the energy industry 

topic modeling and latent dirichlet allocation
the most commonly used method for topic modeling  or topic discovery from a large number of documents  is latent dirichlet
allocation  lda   first introduced by blei et al          simply speaking  the lda algorithm assumes that each document  as a bagof words  is a mixture of different topics  and each topic is a mixture of different words 
more formally  the smoothed lda we used assumes the generative process shown in figure  figure    there are four steps in this
generative process   a    probability of words in k topics  is drawn from dirichlet distribution with  as prior weight of words   b   
distribution of topics in each document  is drawn from dirichlet distribution with    c  z  identity of topic of each word in each
document  is drawn from the categorical distribution with probability    d  w  identity of each word in each document  is drawn from
the categorical distribution with probability   given the topic identity specified by z 
given w  the collection of documents  lda uses a variational em algorithm to estimate the latent variables   word distribution for
each topic   and   topic distribution in each document   with  and  as hyperparameters  for example  we ran lda for    topics on
    articles from petrowiki  petrowiki         the results  including interpretation of    topics  word topic relationship  and topicdocument relationship  are shown in figure    with the topics neatly interpreted  one can have a quick and high level overview of all
the content inside petrowiki 
 

fifigure    graphical model representation of lda  the boxes are plates representing replicates  the outer plate represents documents  while the
inner plate represents the repeated choice of topics and words within a document  figure is modified from blei et al         

figure    lda result on petrowiki articles   a  interpretation of the topics   b  visualize topics based on similarity   c  sample topics with word
distribution   d  sample articles with topic distribution 

workflow
figure   shows the general workflow developed for exploring factors from a set of articles and relating them to prices  to create the
dataset  a snippet of the first paragraph from articles on the news website of interest is scraped  application programming interfaces
 apis  provided by news websites can be used to automate the scraping process  to obtain a dataset that is representative of our
interest  a query term is specified to restrict the search to the newspaper articles that are related to the topic  the resulting dataset is the
main input to topic modeling  preprocessing the dataset includes removing all stop words and non word character using regular
expressions 
topic modeling is then applied using the lda algorithm in the python package  gensim  ehek and sojka         in this workflow 
users need to specify the number of topics according to the diversity of the corpus  a visualization tool  ldavis  sievert et al         
which shows the inter topic relationship and word distribution is used to enhance topic selection and interpretation  in ldavis
 sievert et al          the inter topic distance is calculated and projected using multi dimensional scaling  mds  with a jensenshannon divergence distance  the weight of each topic is captured by the size of the circle used to depict the topic in the visualization 
the bigger the circle depicting the topic  the greater the weight of the topic in the dataset 
the terms within the topics are used to interpret the topics  ldavis defines the relevance  r  of a term in a topic with a parameter
called lambda     equation      accounts for the lift which can be defined as the ratio of a terms probability within a topic  kw  to its
marginal probability across the corpus  pw  modifying lambda helps to reduce the noise in terms and increases interpretability of the
topics   can lie between   and   and is optimally found to have a value of about      sievert et al         

 
r w  k     log kw       log kw 
 pw 

   

once the topics have been interpreted  the topic distributions of all articles in each year are calculated and plotted with time  ng 
       to study the time dependence of factors related to historical prices  linear correlation coefficients between topic trends and the
price are computed using a temporal moving window  the correlation coefficients for the entire time period are also computed 
 

fifinally  using the visualization  knowledge of the major historical events  and changes in the stock or commodity price with time  the
results are analyzed to find interesting correlations between the weights of different topics and the price over time  the ability to
navigate across topics  words  articles  and time  enables thoughtful analysis of the correlations with support from individual articles 

figure    workflow for exploring commodity and stock volatility using topic modeling on historical news articles 

results on articles mentioning oil prices
we applied the workflow on a clean dataset from new york times  we used oil prices as the query term  and obtained the
headlines and the first paragraphs of        articles published between      and       studying the topics extracted  figure     we
observed that some topics are more similar to each other when they are examined using multi dimensional scaling  figure    right  
the correlations observed are reasonable  for example  the major words in topics   and   are  energy  tax  gas  bill  congress  and
 economic  world  president  russia  respectively  this might be indicative of the relationship between national and international
policies related to the oil industry in the us  after testing the algorithm with different number of topics  we observed that ten topics
are sufficient to capture the variability in the topics without over segmenting  this is both a subjective and objective decision based on
the topics extracted and the multi dimensional scaling results 

figure    left  topics extracted from the oil prices dataset examined in this study  examples of the most frequent words are given  the topics are
interpreted based on the words and examination of representative articles  right  multi dimensional scaling visualization of the first two principle
components showing the relationship between the topics  note that some topics  e g    and    are closer to each other  the colors match the colors
used in the rest of the figures 

comparing the results with historical events  we observed good correlations between topic trends and oil price  u s  energy
information administration         the comparison is done on yearly basis to ensure a sufficient number of articles for each year 
figure   shows the trend of each topic over the years as well as the historical inflation adjusted oil price  the area between the curves
represents the proportion of different topics 
the signature of major world events can be easily identified  for example  the first oil crisis             occurred when the
organization of arab petroleum countries  oapec  started an oil embargo on selling oil to the united states  which resulted in a
substantial price hike  topic modeling results show that the topic      world oapec relations  with words  countries  nations  world 
econ  arab  opec   has a relatively high proportion in that period  another example is related to the middle east in general  and iraq
specifically in topic     middle east conflict  with words like  iraq  united  saudi  states  iran    we observed a higher trend in this
 

fitopic related to the decreased oil output during the iranian revolution         the gulf war         and the iraq war         around
      we observed a huge increase in the importance of the topic     commodity and us currency  with words like dollar  future 
trade  commodity   this coincides with the clinton presidency in the united states during which the dollar was very strong  in the
same period  the oil price fell  this suggests an inverse relationship between the dollar value and the price of oil which studies have
shown to be true  finally  financial related topics dominate the signature in the last ten years including the      financial crisis 
to obtain a more quantitative result regarding the relationship between oil prices and topics  correlation plots are constructed using a
moving temporal window  figure    right  shows the result when a window of nine years is used  the relatively long time window is
used to reveal any long term correlation  results show that topics importance generally changes with time  for example  topic  
which is related to the organization of petroleum countries  opec  shows a varying correlation with time  this is because opecs
stance changes with time  currently  opec is driving the oil price down with overproduction which is visible on the plot by the
downward trending average correlation  other topics show generally constant correlation  for example  topic     commodity and us
currency  is generally negatively correlated with price  this constant correlation could reflect the fact that oil price has an inverse
correlation with the us dollar  another example is topic     us energy policies  which shows a general positive correlation reflecting
the fact that the majority of us energy policies are in favor of the oil and gas industry 
sometimes  topics extracted by lda are informative in an unexpected way  a previous lda result suggested a topic including words 
 coffee  world  markets  cents  sugar  cotton  pound   it implies an interesting fact that certain commodities are usually mentioned
along with the oil prices  individual article examinations showed several folds of relationship  coffee  sugar  cotton  along with crude
oil  are main indicators of the economy  hence the tendency of being mentioned together  oil prices will increase the cost of crops as
harvesting  processing and transporting require fuel  polyester made from petroleum derivatives is a major type of clothing material
that can replace cotton  so we expected that cotton demand increased as oil price increased  moreover  this investigation helped in
locating an issue where the dataset inappropriately included  business digest  where the oil price was mentioned as one of many
uncorrelated news entries 

figure    left  topics trends overlaid by the inflation corrected oil price and major events related to oil price  right  correlation between each topic
and oil price using an average window of   years  i e  long term correlation   topic colors and titles are defined in figure   

results from general articles
to explore more hidden factors related to the oil price  we applied the workflow to a collection of         new york times articles
randomly sampled daily from      to       in this case  given the vast variety in the data     topics are required to adequately model
the topics  some of the topics clearly interpreted from the terms distribution include sports  war  crime  and law  figure    left   a
linear correlation of the topic distribution trend in time against the oil price showed correlations of various degrees  as expected  there
was a strong positive correlation between the oil price and war related topics  e g  topic       we investigated topics which showed
strong correlations to oil price  while trying to understand the strong correlation of crime  e g  topic      with oil price  we discovered
that crime rate is closely linked to unemployment  intuitively  this is expected  the advantage in discovering this link with
unemployment rate is that there is readily available information on the employment rate  u s  bureau of labor        which can be
plotted versus oil price to confirm if there is a correlation  figure    right  

 

fifigure    left  correlation coefficient of some topics from the general data set ordered by the absolute correlation coefficient  topic      crime  and
topic      war  are pointed  right  plot of unemployment rate and oil prices versus time which shows a relatively good correlation with some time
lag 

conclusions and final remarks
topic modeling enables users to have a bird s eye view of a large volume of documents  and to examine the topics  words and
documents in dynamic ways  hence provides a ground for insightful investigations  this validates the workflow as a viable means of
quickly exploring large volumes of texts to understand the factors affecting the stock and commodity prices  in this study  topics
extracted related to oil price fit into reasonable defined groups and the trends identified agree with the major historical events  the
study also showed that the topics importance changes with time  in addition  the unexpected connection between the oil prices and
unemployment rate was uncovered  it is important to note that the correlation observed does not necessarily mean causation in any
direction  further analysis is needed  the results does  however  provide a starting direction to look for the causation 
the study can be expanded in a number of directions  hierarchal clustering and or multi dimensional scaling to group topics
sequentially and attempt to estimate the optimum number of topics automatically  the results can be used to study the topics at a
multi scale level depending on the objectives and time constraints  in addition  predicting the stock or commodity price can be
attempted by predicting the trend of the topics and using the correlation coefficient estimated 

references
blei  d  m   ng  a  y   and jordan  m         latent dirichlet allocation  journal of machine learning research  v     p          
ng  a         automated biography for a nation  website  annalyzin wordpress com            automated biography   retrieved on
           
petrowiki        website  petrowiki org  retrieved on            
ehek  r   and sojka  p         software framework for topic modeling with large corpora  in witte  r   cunningham  h   patrick 
j   beisswanger  e   buyko  e   hahn  u   verspoor  k   and coden  a  r   eds   proceedings of the lrec      workshop on new
challenges for nlp frameworks  university of malta    p 
sievert  c   and shirley  k e         ldavis  a method for visualizing and interpreting topics  proceedings of the workshop on
interactive language learning  visualization  and interfaces  p        interactive language learning  visualization  and interfaces 
p       
u s  bureau of labor        website  www bls gov   retrieved on            
u s  energy information administration        spot prices for crude oil and petroleum products  website  www eia gov  retrieved on
           

 

fi