machine learning equalization techniques for high speed
pam  fiber optic communication systems
i  lyubomirsky
cs    final project report  email  lyuboptics gmail com
abstract in this work  we apply machine learning regression and classification algorithms to the
problem of equalization and detection in high speed fiber optic communication systems 
introduction
conventional linear feed forward equalizers
 ffes  are widely used in fiber optic
communication systems to mitigate inter symbol
interference resulting from a limited bandwidth
of electro optic components  as well as fiber
chromatic dispersion      however  linear
equalization techniques  analogous to linear
regression in machine learning  provide only a
limited benefit for the low cost direct detection
receivers used in ethernet applications       
chromatic dispersion is a major transmission
impairment in these systems  dispersion acts on
the electric field while the square law direct
detection receivers detect intensity  all optical
phase information is lost during the direct
detection process  moreover  optical amplifiers
generate additive white gaussian noise  awgn 
in the optical field  but after going through
square law detection  the noise is no longer
awgn  when significant chromatic dispersion is
combined with optical noise  the electrical
waveform after photo detection can be so
distorted that a linear ffe is not sufficient to

of discovering new techniques which are more
robust to non gaussian noise statistics  and the
nonlinear distortions due to interaction of
chromatic dispersion and square law detection 
as with a linear ffe  the input features are
taken from n consecutive samples of the
received waveform  sampling rate is  x the baud
rate   with n     to     at the high speeds of
interest to fiber optic communication systems 
the
equalizer
complexity
and
memory
requirements put a major constraint on the
system design  hence  we focus on regression
and classification algorithms with an eye toward
practical implementation in dsp asics 
system model
figure   shows the system model and
simulation setup  we simulate a   ary pulse
amplitude modulation  pam   fiber optic
communication system  the symbol rate is   
gbaud for a bitrate of     gb s  this bit rate
includes native     gbe and overhead for fec 
the pam  optical modulator is driven by  
binary electrical data streams  with each pair of
bits corresponding to a pam  symbol taken

fig     system simulation block diagram  the highlighted block for equalizer and decision device is the focus of this paper 

provide an acceptable symbol error rate  in this
work  we investigate and compare several
machine learning algorithms for applications in
digital equalization and detection  with the goal

from the alphabet                 we employ
pseudo random bit patterns  prbs  with length
  
of      symbols to drive the modulator  training
and test data are generated using different

fiprbs polynomials  and different random seeds
for the noise generators  the output of the
modulator propagates through a fiber optic link 
the main optical channel impairments are due to
fiber loss and chromatic dispersion  at the
receiver  an optical amplifier boosts the signal to
compensate the loss  while also adding white
gaussian noise to the optical field  an optical
filter is used to reduce the optical noise entering
the receiver  a photo diode converts the optical
signal to an electrical current through square law
detection  the electrical signal is then sampled
by an analog to digital converter  assumed
ideal  at   samples per symbol  finally  the
samples are processed by a digital equalizer
and a decision circuit  the equalizer and
decision circuit block is the main focus of this
work  the optical system simulations are
performed using the commercial software
package optsim  with simulation in matlab for
the receiver digital signal processing 
figure   shows some simulated eye diagrams
at the receiver  an eye diagram displays all the
waveform symbols simultaneously by overlaying
in the same plot  an ideal pam  eye diagram
would show wide open eyes  as in fig    a   for
the case of no noise and no dispersion  the
pam  eyes close up after adding noise from the

pattern of transmitted symbols  as shown below 
features
figure   a   shows the block diagram for a
conventional linear equalizer based on an fir
filter structure  we can also think of the linear
equalizer as a linear predictor  or linear
regression   where the features are n input
samples  and the linear predictive model is
defined by n   parameters learned during
training by minimizing the mse  the output of
fir filter goes to a decision device  which
makes hard decisions based on minimum
euclidean distance to the nearest pam  symbol 
we generalize the linear equalizer to the
structure shown in figure   b    where the fir
filter processing is replaced with a more general
machine learning algorithm for predicting the
output symbol  the input features of the
machine learning algorithm are the same n
samples but the algorithm may be based on
either regression  followed by hard decision  or
classification giving the predicted pam 
symbols directly 
figure   shows a feature correlation heat
map of   samples for a   no dispersion and b  
with dispersion  the correlation heat map shows
that neighbouring samples are strongly
correlated due to the pulse spreading in time

fig     simulated eye diagrams for a   no noise  no dispersion  b   including optical noise but without chromatic dispersion  c  
including both optical noise and chromatic dispersion 

optical amplifier as shown in fig    b   we also
observe more noise on the higher pam  levels 
this is due to the action of square law detection
on the optical field as discussed above  when
both noise and significant chromatic dispersion
are included in the simulation  the eyes
completely close  as shown in fig    c   where
we included chromatic dispersion corresponding
to    km of standard single mode fiber 
although its hard to discern a pattern in the
noise like waveform of fig    c    a powerful
machine learning algorithms is able to detect the

caused by dispersion  hence  algorithms which
rely on a statistical independence of the
features  such as naive bayes  may not be
suitable for this problem  figure   c   and d  
show pairwise scatter diagrams for   samples
for the case of no dispersion  and with
dispersion  respectively  the points are labelled
by different colors corresponding to the received
pam  symbols  note the output pam  symbols
are time aligned with the center sample  as
revealed in fig    c   and d    without dispersion 
it should be easy to separate the classes 

fifig     block diagram of a   conventional linear equalizer  and b   generalized equalizer based on machine learning 

however  fiber dispersion tends to mix the
different colored clouds together  making the
regression and or classification problem very
challenging  a
nonlinear regression or
classification algorithm is required to separate
the classes in this case 
machine learning algorithms
all algorithms are implemented in matlab using
the statistics and machine learning toolbox 
and neural network toolbox  linear regression
is the baseline algorithm for comparison  as this
is the simplest and most popular approach in
digital
equalization 
the
strait
forward
generalization of linear regression to nonlinear
systems is polynomial regression  also called
volterra equalization in the communications
literature      for simplicity  we consider only
second order volterra equalization  where the
output of the equalizer is given by
   

            

      
   

   

 

           
       

the parameters     are learned during training
by minimizing mse  we use the matlab fitlm
function for linear and polynomial regression 
perhaps one of the most powerful algorithms for
nonlinear regression is based on neural
networks  we used the matlab feedforwardnet
function to model a neural network  a network
design based on   hidden layers  with n
neurons per layer  was found to work well by
experimentation on a separate validation data
set  the parameters of the neural network are

learned in training using the levenbergmarquardt version of the back propagation
algorithm     
classification algorithms offer a different
approach to this problem by combining the
functions of equalization and detection
together to output the predicted received
symbols directly  for classification algorithms 
we tried softmax regression using the matlab
function mnrfit  with logit link function  in
softmax regression      the output is a probability
for each pam  symbol  and decision is made in
favor of the highest probability symbol  finally 
we tried a k nearest neighbors  knn 
classification scheme     using the matlab
function fitcknn  for a given input vector x  the
knn classification algorithm estimates the
probability p m x   where m is the pam  class
label  from the k nearest neighbors to x in the
training set based on the plurality of the k
observations  k     was found to be an optimum
choice on a separate validation data set 
results and discussion
figure   shows the simulation results on the test
data set symbol error rate  ser  versus number
of features  or samples  for the case where both
noise and dispersion are included  increasing
the number of sample inputs generally improves
algorithm ser performance as the span of the
samples includes more of the pulse spreading
due to dispersion  once all the pulse spreading
is included in the span of the n samples 
increasing the number of samples further does
not provide any additional benefit and ser
saturates  knn is an exception  it achieves
optimum performance at n     samples and
then ser performance degrades rapidly due to

fifig     correlation heat maps for a   no dispersion  b   with dispersion  and pairwise scatter plots for c   no dispersion  d   with
dispersion  the received pam  symbols    classes  are labeled by color in c   and d  

the well known problem called the curse of
dimensionality  i e  the k neighboring points are
spread further apart in higher dimensions     
as expected  the simple linear equalizer gives
the worst ser performance  softmax regression
yields only a small improvement over linear
regression  for softmax regression  the logodds
for each class is linear in the features  so one
may expect similar results as in linear
regression  the small improvement of softmax
regression may come from improved robustness
to non guassian noise statistics  the scatter
diagrams in figure   d   clearly show the need
for nonlinear regression techniques  indeed  the
nonlinear
volterra
equalizer
significantly
improves the ser over linear regression and
softmax regression  we found by the process of
backward selection     that good performance
with volterra equalization can be achieved with
only the xj xi nonlinear interaction terms added
to the linear terms  this simplifies the hardware
implementation considerably  the neural
network equalizer also achieves good
performance but at the expense of higher
complexity  interestingly  the simple knn
classification algorithm with k   achieves the
best performance at small n  but not best
overall   knn may provide an interesting option

if it can be implemented efficiently in dsp
hardware using a lookup table 
conclusion and future work
machine learning regression and classification
algorithms offer a wealth of new ideas to explore
for digital equalization and detection  in this
paper  weve considered linear and polynomial
regression 
softmax
regression 
neural
networks  and knn classification  extensions of
this work may involve a more detailed study of
optimum neural network architectures  including
classification schemes  the time series nature
of the equalization problem also offers the
possibility of using feedback  for example  socalled decision feedback equalization provides
the previously decided symbol  which may be in
error  as an additional feature to the input
samples  finally  one may explore other
powerful
regression
and
classification
techniques  such as based on support vector
machines     or boosted regression trees     
any machine learning algorithm developed for
high speed digital equalization must be simple
enough to implement in a real time dsp asic 
this is a unique aspect of the equalization
problem that makes it particularly challenging
but also exciting 

fireferences
    j  g  proakis and m  salehi  digital communications 
th

mcgraw hill    edition  new york       
    c  cole  i  lyubomirsky  a  ghiasi  and v  telang
higher order modulation for client optics  ieee comm 
mag   vol      no     pp         march       
    v  curri  r  gaudino  a  napoli  and p  poggiolini
electronic

equalization

for

advanced

modulation

formats in dispersion limited systems  ieee phot  tech 
lett   vol      issue     pp             nov        
    s  benedetto and e  biglieri  nonlinear equalization of
digital satellite channels  ieee j  sel  areas commun  
vol     no     pp        jan       
    m  h  beale  m  t  hagan  h  b  demuth  neural
network toolbox users guide  the mathworks       
    andrew ng  cs    class notes  stanford university 
     
    g  james  d  witten  t  hastie  and r  tibshirani  an
introduction to statistical learning  springer  new york 
     

fig     simulated symbol error rate  ser  versus number of features  or samples  

fi