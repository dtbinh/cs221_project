characterization of jet charge at the lhc
thomas dylan rueter  krishna soni
abstract
the large hadron collider  lhc  produces a staggering amount of data   about   
petabytes annually  one of the largest difficulties in analyzing this data is the analysis of
hadronic jets of particles produced by quantum chromodynamic processes  due to the
thresholds that particles must exceed in order to have their data stored  it is not possible
to simply add the charges of every particle in a jet to calculate its charge  in this paper  we
train a support vector machine  svm  to classify jet charges for up and anti up quark jets
at a better efficiency and rejection rate than can be achieved with the traditional jet charge
calculation and cut method  through the selection of good  physically motivated features and
careful regularization  our svm does slightly outperform the traditional method  as evidenced
by a comparison of roc curves for both methods 

i  i ntroduction
the large hadron collider  lhc  is the
largest and most powerful particle accelerator
in the world  built with the goals of understanding and testing the standard model of particle physics  as well as searching for physics
beyond the standard model  having already
discovered the higgs boson in run i  the lhc
has been upgraded to a higher center of mass
energy and has begun a second round of data
collection  dubbed run ii  one of the largest
difficulties in analyzing the data produced by
the lhc is the analysis of hadronic jets
of particles produced by quantum chromodynamic  qcd  processes  being able to characterize these jets to determine their sources
is crucial to both testing the standard model
as well as understanding any new physics the
lhc might find 
this problem is made difficult by the incomplete nature of the data  only particles above
certain momentum thresholds are recorded by
the atlas detector  if every particle were
recorded  calculating the jet charge would be
a simple matter of adding the charges of all

ofthe particles in a given jet  furthermore  the
physics of jets is not well understood analytically due to both the wide variety in jet
structure  e g  the number of particles in a jet
can vary wildly  and the difficult nature of
qcd calculations  it is strongly coupled  and
including many final state particles exponentially complicates the calculation   as a result 
physicists have tried to use heuristic measures
to obtain information about jet charge  and the
goal of this paper is to apply machine learning algorithms and techniques to the problem
based on physical intuition to improve on these
measures 
ii  r elated w ork
determining the charge of these jets has
been done in the past via a summation of the
particle tracks within the jet weighted by their
transverse momentum in the detector  pt       
qj  

 

x

 ptj  

it r

qi   pti  

   

here tr represents the set of particle tracks
recorded for the jet  and  is a number which

fidefines the weighting          jets are
classified as positively or negatively charged
based on whether their calculated charge is
above or below a given threshold          the
efficacy of this method certainly hints that
perhaps momentum weighted charge averages
are a very relevant feature for jet charge classification  but there is a large overlap between the
positive and negative jet charge distributions 
as seen in figure    we believe a larger set of
features could provide better separation of the
two classes 
other recent work in jet classification has
focused on computer vision  using image analysis tools on pictures of jets constructed from
detector information      this inclusion of position information  specifically how far a given
particle is from the jets center  seems like
an important feature for charge classification 
studies have also used neural networks and
multivariate discriminant analyses for jet tagging with considerable success      support
vector machines  svms  have been applied
to similar jet classification problems and been
successful      we believe that the two class
nature of this problem lends itself particularly
to an analysis based on a svm approach  as the
svm algorithm is capable of taking in large
feature sets and finding separating hyperplanes
which may inform better feature selection in
future calculations 
iii  dataset and f eatures
our initial training set consists of a list of
     simulated up       charge  and anti up
      charge  quark jet events with at least
five particles each  which were generated by
the atlas collaboration using a particle simulation software called pythia  for every
jet in an event there is aggregate information
about the jets pt        calculated momentumweighted jet charge for  of           and     

fig     calculated jet charges for positive  up  and
negative  anti up  jets in our training data  using        

and the true value of the jet charge  negative
or positive    is the pseudorapidity of the jet 
which represents the angle of the jets center
relative to the beam axis  and  is the azimuthal
angle of the jets center in the detector  for
each jet there is a list of the information stored
for each particle within jet  containing the
particles charge  pt        and dr to jet axis 
here dr is defined by 
q
dr    particle  jet       particle  jet   
   
based on the idea that particles which carry
a larger fraction of the jet pt carry more
information about the jet charge  we defined
our initial features as the fraction of the jet
pt   the charge  and the dr values of the five
particles with the largest momenta  this raw
feature selection seemed to over fit our data 
as we had a training error of       compared
with a test error of      we believe this is due
to the svm algorithm not being scale invariant 
as the pt values of our leading particles take
on values from   gev to     gev  in order

fito normalize these values to the interval       
we considered instead the fraction of the jet
momentum zi accounted for by the ith track 
zi  

pti
ptjet

   

we also thought that perhaps another reason
for our poor performance was the incomplete
nature of the information contained within the
first five particles  the traditional jet charge
calculations sum over every particle in a jet 
which provides much more information than
just the particles with leading pt   in an attempt
to use information from the whole jet  we
defined features which involved summing over
all of the particles  we defined our features as 
x
q    
qi zi
   
it r

q    

x

qi zi

   

it r zi     

p
q    

qi  i  

it r

p

 i  

   

it r

qi  i  

p
q    

it r zi     

p

 i  

   

it r

each of these was calculated for           
          and    giving us    total features  the
 weighted averages were used in addition to
momentum weighted averages to get a measure
of particles rapidity relative to the jets rapidity  note rapidity can be approximated by the
pseudorapidity  for these light quark masses 
linked with the charge  the sums over tracks
with zi       are designed to pick out the
particles with the highest momentum  which
there is good reason to believe carry more
information about the jet charge 

iv  m ethods
given that our data was not linearly separable  we were drawn to using an rbf kernel to
parametrize a c support vector classification
function  sklearn svm svc    to perform our
classification 
a  support vector machines
support vector machines  svms  are commonly used in machine learning as binary
classifiers  we aim to calculate a maximum
margin hyperplane between classes of elements
from our training set  in this case  we chose to
use an svm to classify a sufficiently interpret
if a jets charge was negative or positive  we
may formalize our problem by constraining 

yi     
   
yi  xi  w   b       
yi    
where yi corresponds to either positive or
negative jet charge  we define the dual optimization problem 
m
m
e
d
x
  x  i   j 
maxi  
i 
y y i j x i   x j 
 
i  
i j  
   
m
p
 i 
subject to the constraint
i y
     we
i  
p
may define a solution where w   i i yi xi
which is a linear combination of our training
vectors  this is found by applying the stationarity kkt condition on our dual optimization
problem   we also define a penalty function
 where c is a penalty parameter for misclassifying a sample  and consider
x
 w     c
i
    
i

which is subject to 
yi  xi  w   b      i where i   

    

here  our goal in the c svm  is to minimize
 w    where  w  is the norm vector to the

fiseparating hyperplane  in our penalty function 
in this problem we arbitrarily set c    
since we did not have much information about
how our feature data correlated to our training
labels 
b  rbf kernel
now  it is useful to define some function
which maps elements on some higher dimensional space in order to make them linearly
separable  and thus usable for our svm   here 
we define some function  say  x   which
maps our features onto some higher dimensional space  from this  we define a kernel
function which is the composition of an inner
product of our feature mapping functions of
 x  
k xi   xj      xi  t  xj  
    
in our example we used an rbf kernel  or a
 radial basis function defined as 
k xi   xj     e xi xj  

 

    

the above equation can easily be seen as form
of gaussian distribution  here  we leverage
the properties of this distribution  which by
definition is linearly separable  to improve
the separability of our feature mapping  in
addition   is a weighting parameter which
defines the relative influence of a given training
features  for this problem  we used a    n 
where n is our number of training features 
we made this assumption as we wanted our 
to be agnostic of the relative importance of our
training features 
v  r esults and d iscussion
feature selection and regularization was the
most difficult part of this project  due to the
lack of analytic solutions to jets  when our
initial feature set of the pt   dr  and charge of
the   leading pt particles was overfitting  we

attempted to solve the problem by normalizing
the pt values as well as performing a dimensional reduction on the feature set via primary
component analysis  the svm trained on
these reduced features performed better  but
was still worse than the jet charge calculation 
we also briefly tried a boosted decision tree 
using the adaboost algorithm and weak decision tree classifiers  but the test error was
unaffected as the training error decreased  it
was only once we implemented the feature set
in section    without pca  that we achieved
good classification on the up anti up quarks  as
evidenced by the roc curve calculated on the
up anti up training set using cross validation 
since we had a fairly large amount of data we
used hold out cross validation  training on   
figure   shows roc curves for the jet
charge calculation in equation   for differing
values of   as calculated on our training set 
the roc curve traces out the positive jet
tagging efficiency  defined as the number of
positive jets above the threshold divided by the
total number of positive jets  and negative jet
rejection  defined as the number of negatively
charged jets divided by the number of false
positives  as we move the charge threshold     
a perfect jet classification scheme would
have a flat roc curve at the maximum negative rejection  our svm roc curve was
calculated by scanning through thresholds
on the svm scores  calculated using the
sklearn svm svc decision function tool  of
our test set  our svm slightly outperformed
the traditional jet charge calculation for positive tagging efficiencies above     which is
where atlas searches use these curves most
often  thus  making a useful tool for tagging jet
charge 
we also received a list of      down      charge  and anti down       charge  quark

fifig     calculated jet charge with        for the
down anti down jet data 

this causes a larger overlap of positive and
negative jets around   calculated jet charge as
seen in figure   
vi  c onclusions and f uture w ork

fig     top  roc curves for traditional jet charge
calculation on up anti up jets   values  and our svm 
tested using hold out cross validation  bottom  roc
curves for jet charge calculation for down anti down jets
  values  and our svm  trained on the full up anti up
jet data and tested on the down anti down jet data 

jet events  which we used to test our svm
after training it on the entire up anti up jet data
set  figure   shows that our svm performed
essentially the same as the best jet charge
calculation for all positive tagging efficiencies 
the down anti down data is much more difficult to classify  due to the total jet charge being
a factor of   smaller than the up anti up jets 

we successfully classified both up anti up
and down anti down jets using a svm based
analysis and good feature selection  it became
apparent to us that this classification problem
is not only highly non linear  but also cannot
be adequately solved based on sampling only
a few of the jets particles  had we received
the down anti down data earlier  it would have
been interesting to try to use a support vector
regression algorithm to accurately determine
whether a jet was up  anti up  down  or antidown based on a regression on the charge 
using the position information of the particles
in the jet to analyze the jet as an image with a
convolutional neural network would be another
interesting method of trying to classify jets as
positive or negative 

fir eferences
    josh cogan  michael kagan  emanuel strauss  and
ariel schwarztman  jet images  computer vision
inspired techniques for jet tagging  journal of high
energy physics                    
    atlas collaboration et al 
 jet charge studies with
the atlas detector using s    tev proton proton
collision data  atlas conf                
    david krohn  matthew d schwartz  tongyan lin 
and wouter j waalewijn  jet charge at the lhc 
physical review letters                       
    mostafa mjahed  identification of the quark jet
charge in e  e  w  w using neural networks and
discriminant analysis methods  nuclear instruments
and methods in physics research section a  accelerators  spectrometers  detectors and associated
equipment                      
    federico sforza  vittorio lippi  giorgio chiarelli 
and sandra leone  rejection of multi jet background
in a hadron collider environment through a svm classifier  in nuclear science symposium and medical
imaging conference  nss mic        ieee  pages
          ieee       

fi