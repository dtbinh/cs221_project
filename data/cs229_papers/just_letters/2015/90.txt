 

clustering music by genres using supervised and
unsupervised algorithms
kyuwon kim  wonjin yun  and rick kim

abstractthis report describes classification methods that
recognize the genres of music using both supervised and unsupervised learning techniques  the five genres  classical c   edm e  
hip hop h   jazz j  and rock r   were examined and classified 
as a feature selection method  discrete fourier transform  dft 
converted the raw wave signals of each song into the signal
amplitude ordered by their frequencies  based on the analysis
of the characteristics of data set  final feature set were collected
by averaging the amplitudes of corresponding two different
frequency division  xl and xm    for supervised learning  a
training set  mtrain      genre  was used to train the cart
 classification and regression tree   and the performance of the
genre prediction by cart classifier was evaluated using a test
set  mtest      genre   a recognition rate of       for three
genre classification  c  h  and r  was observed  and      
for five genre classification  c  e  h  j  and r  was obtained 
for unsupervised learning algorithm  k means clustering was
performed on an unlabeled set of data  m      genre  to cluster
the music into genres  and showed purity of       for three genre
classification  and       for five genre classification 
index termsmusic clustering  k means  cart

i  i ntroduction
most music websites have song recommender systems 
there are two commonly used mechanisms in most websites 
collaborative filtering and content based filtering  in collaborative filtering  websites gather information about their users
behavior and preferences to recommend similar items for a
user based on peer users choices  on the other hand  in
content based filtering  keywords of music such as year  genre
and musician are required to predict similar songs  while these
mechanisms are effective in recommending similar songs for
a user  both mechanisms require a large amount of external
data  collaborative filtering needs sufficient peer users data 
and content based filtering requires pre processed labels on the
music  here  we explore methods to cluster similar songs only
using their raw wave files 
a genre is a label often used to group similar types of music 
although genres of music are usually determined manually by
human  we attempt to predict genres of music without any preprocessed labels or peer choices  in this paper  we have tried to
construct models that cluster songs based on their components
of raw wave signals and test how well these models can predict
the genres determined by human  given an unknown music
file  we aim to implement automatic classification by genres
using machine learning techniques 
k kim is with the department of mechanical engineering  stanford university 
w yun is with the department of energy resource engineering  stanford
university 
r kim is with the department of biology  stanford university 

both supervised and unsupervised learning methods were
tested in our study  in the supervised learning test  we used
classification and regression tree  cart  to find a model
that can effectively classify a new piece of music using some
features from the wave signals  in the unsupervised learning
test  we used k means clustering to cluster a set of unlabeled
songs into groups of similar features  confusion matrices
and the purity of classification were used to evaluate the
performance of the clustering 
ii  r elated w orks
there have been a number of studies on predicting the
genre of music using features in the wave signals of a music
file  the temporal structure of a music piece was often used
to recognize the genre of a music  soltau et al  used the
sequence of activation in hidden units and a neural network
to classify rock  pop  techno and classical     shao et al  used
a hidden markov model with sequences of features such as
mel frequency cepstral coefficients mfccs  to cluster pop 
country  jazz and classical     
some approaches focused on the direct similarity between
the feature sets than the temporal structures  cilibrasi et
al  used a distance function between feature vectors and
generated trees by the distances to visualize the similarity
between samples of classical  rock and jazz     peng et al  used
features from the signals to perform a k means clustering  and
used some labels as constraints to perform a constraint based
clustering to group a set of songs by their artists      tsai et
al  used a hierarchial agglomerative clustering method which
sequentially merges similar pieces of music    
mfccs were commonly used in many studies  because
the mel scale represents the perceptual scale of pitches for
a persons hearing  however  some studies also introduced
new features such as linear prediction coefficients lpcs    
and renyi entropy cepstral coefficients reccs      shortterm fourier transform features were also used to capture the
timbral textures from wave signals    
iii  m ethodology
a  data and feature selection
five different genres of music were chosen as our data
classes  classical  edm  hip hop  jazz and rock     samples
from each genre were randomly streamed from youtube  each
song was sampled using a sampling rate of     khz  and stereo
wave signals were merged to mono wave signals  the whole
data set  m      genre  was used without labels to test the
unsupervised learning algorithm  for the supervised learning

fi 

 i 

 i 

 i 

  x    x    

  if s  bj
hj  s   
  otherwise
x

   

classic

 
   
 

 

 

  

  

  

  

  

 

 

  

  

  

  

  

 

 

  

  

  

  

  

 

 

  

  

  

  

  

 

 

  

  

  

  

  

edm

 
   
 

hiphop

 
   
 
 
jazz

algorithm     samples from each genre were randomly chosen
as our test set  mtest      genre   and the remaining data
were used as our training set  mtrain      genre  
to collect features from each sample  discrete fourier
transform  dft  was performed on each sample  an array of
frequencies  fj  j were defined to divide our frequency range
of interest into frequency bands of bj    fj   fj      given an
array  fj  j with length n      and a raw wave data w i    our
feature vector x i   rn is defined as the following  
z
 i 
xj
 
hj  s df t  w i   ds
   

   

   
 

classic

 
   
 

 

 

 

 

 

  

  

  

  

  

  

 

 

 

 

 

  

  

  

  

  

  

 

 

 

 

 

  

  

  

  

  

  

 

 

 

 

 

  

  

  

  

  

  

 

 

 

 

 

  

  

  

  

  

  

edm

 
   
 
 

b  supervised learning

   
 

jazz

 
   
 
 
rock

cart  a conceptually simple yet powerful method  was
used to perform a recursive partitioning  in this process  our
data set was split into two regions r  and r   first and
second music genre for our study  and the splitting process
was repeated until the stopping rule is applied  the cart
algorithm automatically decided the splitting variables j and
split points s until it found the best binary partition  a greedy
algorithm efficiently and quickly determines the best pair  j  s 
     in the greedy algorithm      the pair of half planes is
defined as in eq     the splitting variable and the split point
are solved by eq    and the the inner minimization is solved
by eq    

   
 

hiphop

each feature vector was normalized to satisfy   x i         
two different feature sets xl and xm were used for our test
as illustrated in fig     initially  we generated    frequency
bands in          hz   and the contribution of each feature
to classification of the songs was assessed by cart as shown
in section  iii b and table  i  since the lower frequency region
was found to show more impact on determining the genres in
our preliminary results  xl uses the average values of    low
frequency bands        hz  with bandwidth of    hz  and
  mid high frequency bands            hz  with bandwidth
of           hz  on the other hand  xm uses the average
values of a mel scale frequency division for          hz
    bands  

rock

 

   
 

figure    features xl  upper  and xm  lower  sampled from   genres  
classical  edm  hip hop  jazz and rock 

a balanced training data set  mtraining      genre   a builtin algorithm  rpart      was used in r software to perform
r   j  s   
cart and the optimal classification tree size was adaptively
chosen from the data by cost complexity pruning     using the



node impurity  qm  t        pmk m  described in eq    
x
x
arg min  min 
 yi  c      
 yi  c         
  x
c   c 
j s
pmk m   
i yi   k m  
   
xi r   j s 
xi r   j s 
nm





x   xj  s   r   j  s    x   xj   s
   

xi rm



c    e yi   xi  r   j  s    c    e yi   xi  r   j  s     
for our study  cart  classification tree algorithm rather
than regression tree  was applied to prioritize a number of
features among the entire feature space shown in table i 
for supervised learing  a cart classifier model was trained on

where pmk is the proportion of class k   genre for our study 
observation in node m 
the recursive binary tree is illustrated in fig    that fully
describes the feature space partition corresponding to the
partitioning of the songs in the regions rm  three or five
genres for our study  

fi 

table i
cart feature importance
feature
importance

 nd           st         th          
  

  

  

 

 
 

 
 
 

 rd pc

 

 

 

table     classification tree  cart  trained on    pre labeled songs with   
features ranged from   hz to      hz shows that    songs among    songs
were recognized by the first two features  frequency band from   to     hz  

 

 
   

 

 
   
  
 
   
     
    
   
 
 
  
 
 
 
 
 
 
  
 
 
   
 
 
 
      
 
 
 
 
  
     
 
 
 
                
 
 
 
   
  
 
   
 
 
 
 
 
 
 
   
  

 
 

 nd pc

   features  hz 

 
 
 

 st pc

figure    pca result for three genres using feature set xm   pca plot from  
genres effectively visualizes the distance between songs  in the plot  first two
principal components efficiently classifies classical     from the other genres 
and third principal components separate the hip hop    from rock     

 
        
 
          
     
                     
   
 
 
 
  
      
        
        
 
 
 
                
 
 
 
                    
 
        
          
 
 
 
 
     
    
                       
     
               
 
 
 
             
 
 
 
 
 
      
                    
    
 
  
 
 
 
 
 
            
             
   
          
   
 
 
 
 
 
 
 
 
 
 
    
      
 
 
 
  
         
 
 
 
 
 
 
 
  
 
   
 
 
 
 
 
 
 
 

figure   
cart for    upper mtrain         genres and  
 lower mtrain        genres are demonstrated using xl  

 
 

 nd pc

 

 

 

 rd pc

 

 

 

 

 
 

 st pc

c  unsupervised learning
k means clustering was performed on our data set to cluster
the samples  one sample from each genre were randomly
chosen as our initial pivots  prior to k means  pca was
performed to extract the significant components from our
feature sets  only the top    components were used to run
the clustering  fig    and fig    show the data distribution in
top   principal components  the test was performed for i  a
three genre classification  classical  hip hop  rock   and ii  a
five genre classification  the whole data set  m      genre 
was used for the classification  to evaluate the performance of
our classification  the purity and rand index ri  were used 
the purity of a clustering represents how homogeneous each
cluster is in average  and ri gives us the accuracy of the
classifier when any two random samples are chosen from the
data set and compared 

iv  r esults
a  supervised learning
cart was performed for a three genre classification test
and a five genre classification test  using feature sets xl and
xm   in a   genre classification  the classifier showed recognition rates of                 with xl and                
with xm   displaying a significantly better performance for
xm   on a   genre classification  the recognition rates declined
to                 and                 respectively  also
displaying a better performance for xm  

figure    pca result for five genres using feature set xm   pca plot from  
genres effectively visualizes the similarity and difference between songs  the
plot exhibits the genre similarity between edm     and hip hop      jazz    
and rock      and  it can be noted that the plot demonstrates the widest span
of jazz     compared to the highly localized classical     

b  unsupervised learning
the purity for a three genre classification was       with
feature set xl and       with xm   there was a significant
drop in the purity when the number of genres increased from
  to    showing       with xl and       with xm   resulting
in        decline in average  it also shows that feature set xm
was more effective for classifying the three genres  while xl
appeared to have a better performance when the number of
genres increased 
meanwhile  the ri for a three genre classification was
      with xl and       with xm   it also did not show
much decline         in average  when the number of genres
increased  resulting in       for xl and       for xm  
these values could not be directly compared with the results
from other studies since the data set and the chosen genres
were different  also  some studies     use different ways
to define the purity and ri  although we belive our results
have shown satisfying performance  there are possibilities to
improve the performance 
c  confusion between genres
both learning algorithms tried performed significantly better
with a   genre classification  in table  iii  the confusion matrix

fi 

table ii
c onfusion matrices for three genre classification
 a  feature set xl

 b  feature set xm

c 

c 

c 

c 

c 

c 

classical

  

 

  

classical

  

 

  

hip hop

 

  

  

hip hop

 

  

 

rock

 

 

  

rock

 

 

  

table ii   clustering results for a three genre classification using feature sets
xl  left  and xm  right   the purity and ri are  a               and  b 
             respectively 
table iii
c onfusion matrices for five genre classification
 a  feature set xl
c 
c 
c 
c 

c 

classical

  

 

 

 

  

edm

 

  

 

 

 

hip hop

 

  

  

 

 

jazz

 

 

 

  

  

rock

 

  

 

 

  

 b  feature set xm
c 
c 
c 
c 

figure    graph showing the proximity between songs with   nearest
neighbors  each red dot represents a song  each blue edge represents a
connection between two neighbors  abbreviations  c is classical  e is edm 
h is hip hop  j is jazz  r is rock

c 

classical

  

 

 

 

 

edm

 

  

 

 

 

hip hop

 

  

  

 

 

jazz

  

 

 

  

  

rock

 

 

 

 

  

table iii   clustering results for a five genre classification using feature sets
xl  upper  and xm  lower   the purity and ri are  a               and  b 
             respectively 

shows that edm was frequently confused with hip hop  while
jazz was often mistaken as rock  the pca result in fig    also
demonstrates how these genres are closely distributed on the
principal component space  this shows that some genres can
be closer than other genres in our feature set 
in order to examine the distance between genres  we constructed a neighbor graph based on the l  norm distances of
feature set xm in fig     for each sample  only the seven
most nearest samples were considered as neighbors  proximity
scores were calculated using the graph  which gives a higher
score if the two samples are closely related to each other  the
proximity score of two samples x i    x j  were calculated as
the following  
x
sij  
exp   x i   x k        x j   x k         
k  i j

high score implies that the two data has many common
neighbors and are likely to be classified as same genre  fig   
shows a heat map of the proximity scores  which visualize the
similarity between genres clearly  it shows a close relationship
between edm and hip hop  while classic does not show much
relationship with other genres 

figure    the heatmap of a proximity matrix between     songs of   genres
in order   classic  edm  hip hop  jazz and rock  abbreviations  c is classical 
e is edm  h is hip hop  j is jazz  r is rock

there are a number of reasons why the models can not
distinguish edm and jazz from hip hop and rock  respectively
  one key reason is because of the limited features  the
features explored in this paper may not capture the key
differences between those genres  in addition  our input data
were selected randomly from youtube  our selection might
include songs that are not representative of the designated
genres  some samples might be a mixture of different genres 
in which the classification of genres are ambiguous since some
songs can be classified as multiple genres  with a standard data
set  we would expect the performance to improve 
v  c onclusion
in this report  we have explored methods to cluster sets
of music by dft data extracted from raw wave signals  the

fi 

most challenging part was the feature selection  the dft
data were decomposed into two sets of frequency bands  xl
and xm   within the frequency range         hz  and       hz   considering the range of frequencies used by most
music instruments in songs  two different learning algorithms 
cart and k means clustering  were studied  using cart
allowed us to examine what features are most influential in
making decisions as described in section iii b  pca was
also performed on the feature sets to extract the principal
components 
for supervised learning  cart showed a recognition rate
of       for   genres and       for   genres at maximum 
results from k means clustering showed a purity of      
for   genres and       for   genres  this indicates that the
performance is better with a small number of genres than with
a large number of genres  in contrast  the ri did not drop
significantly 
the selection of features displayed differences in the performance of clustering  and proved to be an important factor
for the effective classification of genres  only features derived
from the dft of signals were used in our project  but using
other features could improve the perfomance of our classifier 
other potential features to use include the average tempo of a
music  repeated patterns in the music structure  and measures
that can capture timbral textures of different instruments 
a better selection of our data set could also improve our
performance  the songs we used were randomly streamed
by youtube  and were not verified by specialists  thus  it is
possible that some of the songs may be hybrid of different
genres  also  by using a standard set of data that is commonly
used to test music clustering  we would be able to compare
our performance with other previous methods 
r eferences
    soltau  h   schultz  t   westphal  m   waibel  a         
recognition of music types  in acoustics  speech and
signal processing        proceedings of the      ieee
international conference on  vol     pp             
ieee 
    tzanetakis  g   cook  p          musical genre classification of audio signals  in speech and audio processing 
ieee transactions on  vol      no     pp           
    cilibrasi  r   vitanyi  p   de wolf  r          algorithmic clustering of music based on string compression  in
computer music journal on  vol     no     pp         
ieee 
    shao  x   xu  c   kankanhalli  m  s          unsupervised
classification of music genre using hidden markov model 
in multimedia and expo        icme         ieee
international conference on  vol     pp             
ieee 
    peng  w   li  t   ogihara  m          music clustering
with constraints  in ismir  pp         
    tsai  w h   bao  d f          clustering music recordings
based on genres  in information science and applications
 icisa        international conference on  pp       
ieee 

    hastie  t   tibshirani  r   friedman  j  additive models 
trees  and related methods  the elements of statistical
learning  nd ed  new york  usa  springer        ch  
 sec     pp         
    breiman l   friedman j  h   olshen r  a   and stone  c  j 
        classification and regression trees  wadsworth 

fi