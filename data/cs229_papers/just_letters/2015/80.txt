prediction of clonal subtypes in breast invasive carcinoma
hunter boyce  anna shcherbina  alice yu

abstract breast cancer is a highly heterogeneous disease
that is classified into multiple clonal subtypes  despite recent
improvements in targeted treatment and clonal subtype detection methods  the complex genetics of tumor diversity remain
poorly understood  this project examines genetic substructure
in a population of breast cancer patients from the cancer
genome atlas  tcga   and identifies networks of genes that
correlate with specific clinical outcomes 

tumor metastasis and were postmenopausal  and the lack of
positive training samples in these two categories led to their
exclusion from analysis 

i  i ntroduction
breast cancer is the most commonly diagnosed cancer and
the second leading cause of death among women        the
highly heterogeneous disease has many different clonal subtypes  characterized by tumor specific sets of hormone receptors that result in different treatment responses  these receptors include her   progesterone pg   and estrogen receptors er   which all increase tumor growth speed and cause
resistance to standard chemotherapy treatment           machine learning techniques can be applied to predict treatment
response  disease severity  and survivability outcomes from
a patients genotype  and ultimately may elucidate ways to
target treatment to better fit the patient 
the cancer genome atlas  tcga  is a rich database of
genetic and electronic medical record information that can be
mined to learn associations between clinical outcomes and
patient genomes     the breast invasive carcinoma dataset in
tcga is the largest and holds records for over      cases of
breast cancer  patient clinical outcomes  such as menopause
status and survival time post diagnosis  survivability  are also
reported  however  the high dimensionality of the genomic
data  input features  combined with the sparsity of the
patient clinical and demographic data  outcomes  provides
a challenge for data scientists to extract meaningful associations between the two  supervised and unsupervised machine
learning approaches make this problem more manageable 
researchers in the past have applied regression and clustering
methods to genomic data to identify cancer driver mutations
and therapeutic targets        however  the causal agents
of differing hormone receptor levels across patients remain
poorly understood  this project applies unsupervised and
supervised techniques to identify key features associated with
distinct clonal cancer subtypes that can be used for prediction
of clinical outcomes and provide leads for future genetics
research 
ii  datasets
rna expression level data  rna seq  and clinical metadata for     breast invasive carcinoma patients were downloaded  fig      the subjects were well spread in age as well
as clonal subtype and survivability  most did not experience

fig     tcga subject clinical data  outcomes for analysis  
iii  f eature s election
a  l  regularization and greedy forward selection approaches
the human genome contains an estimated        genes 
but the dataset used in this project contains only     subjects 
suggesting that the learning problem is over constrained 
furthermore  the majority of human genes are not associated
with breast cancer  which makes identifying the set of
genes and pathways linked to the onset and outcome of
breast invasive carcinoma more challenging  consequently 
supervised feature selection was performed to determine the
genes associated with each outcome in fig    
the glmnet package in r was used to implement three approaches to feature selection     elastic net regression     
the group lasso      and forward subset selection via linear
and logistic regression  for continuous and discrete outcomes  respectively   greedy forward feature selection can
be used to rank features  genes  in order of importance
for determining an outcome of interest  however  multiple
genes within a single pathway are likely to be correlated
with certain outcomes  because the expression levels of
these genes are also correlated with each other  the forward
selection technique will randomly select one feature gene 
from the group  since adding additional genes along the same
pathway is unlikely to maximize the overall information
content  the elastic net regression approach helps to avoid
this pitfall  by using both ridge and lasso penalties to either
join strongly correlated predictors or not at all 
f  x      x             x    

   

fifor the survivability outcome  both the elastic net regression
and the group lasso minimized all features to    to avoid
this outcome  the chosen value of lambda was shifted by an
amount that prevented     features from being reduced to   
greedy forward selection was performed using the regsubsets library in the r leaps package       to reduce
the o n    runtime of the algorithm  a regression step was
performed first on each individual feature against the outcome of interest  using the bonferroni method to correct for
multiple testing  any feature that did not have a regression
p value below      was excluded from the analysis  only
the surviving features were used as input to the regsubsets
library  features were added sequentially in the order in
which testing error on the holdout set was minimized 
b  biological significance of feature sets

fig     feature selection pipeline incorporating greedy forward selection  group lasso  and elastic net regression 

however  unlike forward selection  elastic net regression may
not rank features accurately  weights for correlated features
will be split by the number of features in the group  so
that each of the features is weighted the equivalent of the
group average  similarly  the group lasso          mixed norm
regularization   can be used to include or exclude entire
groups of variables  i e  gene pathways  
minimize f  x    

n
x

  xi    

   

i

however  the pathways must be specified a priori and the
algorithm may fail to identify overlapping pathways  or
pathways where only a small subset of genes are upregulated 
consequently  the union of all the feature selected from the
three approaches were used  fig     
for each approach  selection was performed using    fold
cross validation  training on     of the data and testing
on     in each fold   elastic net regression was performed
with the alpha parameter set to      the glmnet package in
r was used to perform a parameter sweep across lambda to
identify the value that minimized the cross validated mean
error  for the group lasso  the alpha was set to    and a
parameter sweep was again performed to determine lambda 

to ensure that the feature sets produced by feature selection were biologically relevant  they were analyzed with the
metacore software       given an input gene list  metacore
identifies associated gene networks and pathways  three
breast cancer related networks from the gene ontology    
were strongly associated with the down selected feature sets
 fig      of the     genes in the apoptotic processes network 
   were present in the survivability feature set  similarly 
   out of    genes in the reproductive system development
network were present in the er feature set  and     out of
    genes in the growth factor receptor signaling network
were present in several of the feature sets  survivability  er 
her   and age of diagnosis   these networks have strong
associations with breast cancer in the literature  for example 
the majority of the features genes  within the apoptotic
processes network interact with the p   and bcl   genes
 fig   a   bcl   is an oncogene that is expressed in    
of high grade ductal breast carcinomas      similarly  the
tumor suppressor gene p   is the most commonly altered
gene in human cancer      the esr  gene at the center
of the reproductive system development network  fig   c 
is the er marker that defines the outcome of interest     
though this discovery is circular  it serves as validation
that the independent feature selection technique is choosing
sets of biologically meaningful genes for data substructure
identification  finally  the hnf   alpha and nfk beta genes
that serve as hubs of the growth factor receptor signaling
features are transcription factors that have been implicated
in a number of different cancers         
iv  methods
a  unsupervised methods
to identify genetic substructure within the data  unsupervised clustering was performed on each of the outcomes in
fig     each cluster was then correlated with clinical outcomes using chi squared analysis for categorical outcomes
and the anova test for nominal outcomes  the highestconfidence clusters were obtained for the survivability and
er outcomes  fig     
hierarchical clustering  hierarchical clustering of subjects was performed with the dynamic tree cut package

fi a  regulation of apoptotic processes  fdr    e    z     

k   provided the best data separation  fig    shows the
two k means clusters overlaid on the two most significant
components from a pca analysis of the data       the er
features separated er  and er  patients into two distinctive
clusters  similar results were seen in pg and her  receptors 
however  the survivability features only returned a small
cluster of surviving patients and a mixture of patients in the
other 
the overexpressed genes in the high survivability clusters
were associated with the cytokine mediated signaling pathway  fig   f   similarly  the er  cluster from both clustering
methods had upregulated levels of genes associated with
reproductive development  fig   c  
b  supervised methods

 b  growth factor receptor signaling  fdr      e   z      

 c 
reproductive
system
development fdr     e    
z     

fig     feature selection identifies gene ontology networks
and pathways of carcinoma relevant genes  genes that are
members of the down selected feature sets are marked by a
red circle in the upper right corner 

from the r statistical software       rather than the fixed
height branch cut of traditional hierarchical clustering  the
dynamic tree cut algorithm iteratively decomposes and
combines nested clusters  stopping when the number of clusters becomes stable  eight clusters  fig   a  were found using
the er feature set  and two distinctive groups were identified
using the survivability features  fig   d   individuals in the
blue cluster survived an average of     days longer than
those in the red cluster  as determined by anova  these
same individuals also overexpressed the scube  gene  a
known breast tumor suppressor      the correlation of this
gene with the surviving patients supports its role in the
suppression of tumor growth 
k means clustering  the patients were clustered using
k means       a silhouette analysis was performed to determine the optimal value of k  and it was determined that

a suite of supervised training models were implemented
using the python scikit learn toolkit      to predict clinical
outcomes from patient mrna expression profiles 
classification  there are multiple subtypes of breast
cancer that are classified by the modification of expression
levels of specific genes  however  these classifications can
sometimes be indeterminate  using the expression data allows for decision support where traditional means cannot
make a confident assessment  four classifiers were trained
on the data and their performance is shown in fig     the
only non linear classifier  random forest  is an ensemble
bootstrap method that builds decision trees on randomly
sampled features and averages the predictions from all trees 
the mrna expression levels appear to be a good indicator
for the estrogen receptor subtype of cancer  fig   a   with
linear classifiers averaging     accuracy  table i   similarly 
for the her  receptor subtype  linear classifiers average    
accuracy  random forest performed worse than the linear
classifiers in both cases  the same model was used to fit
the training data instead of the testing data  fig   c  and
performed with     accuracy  leading to the conclusion that
the random forest classifier is overfitting on the training data
and is not generalizable  other non linear classifiers show
this same trend  this suggests that the data is mostly linearly
separable and the use of non linear classifiers only hurts
performance  because of this assumption  the c parameter
in the svm model can be tuned low to avoid overfitting the
training data and still perform well 
regression  after diagnosis  the stage of cancer and prognosis is important for the patient to make informed decisions
about their health  this is modeled as a regression problem
to predict both the stage of cancer and the survivability of the
patient  the regression models used are svr with a linear
kernel and a sigmoid kernel  and linear regression  all of
the models tested have poor performance  table ii   tumor
stage is misdiagnosed over an entire stage and survivability
is predicted to be years off from the truth  this may be
due to the sparseness of the outcome data  the majority
of the patients have stage ii or iii  and stages i  iv are
poorly represented  additionally  this may be confounded by
differing cancer subtypes  for survivability  breast cancer has
a relatively good prognosis with     of patients surviving

fi a 
 b 

 c 

 e 

 f 

 d 

fig     unsupervised clustering of estrogen receptor and survivability feature sets  a  dynamic cut hierarchical clustering
of subjects on the er feature set  table illustrates standardized chi squared residuals for each cluster for the outcomes
   no er  and    er present   b  k means clustering of subjects on the er feature set  followed by pca analysis  c 
go process  developmental process involved in reproduction  fdr     e     z      d  hierarchical clustering of subjects
on the survivability feature set  anova results of survivability  days  against cluster membership are illustrated in the
table  e  k means clustering of subjects on the survivability feature set  f go process cytokine mediated signaling pathway
 fdr     e     z      

after   years     leaving few data points corresponding to
death events on which to train 
table i  classifier performance
classifier
linear svm
random forest
lda
logistic regression
linear svm
random forest
lda
logistic regression

precision
recall
estrogen receptor
    
    
    
    
    
    
    
    
her  receptor
    
    
    
    
    
    
    
    

accuracy

auc

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

table ii  regression performance
regressor

rmse
median absolute error
tumor stage  range       
svr linear
    
    
svr sigmoid
    
   
linear regression
    
    
survivability  range           
svr linear
      
      
svr sigmoid
       
      
linear regression
      
      

r 
    
     
    
    
    
    

c  survival analysis
a kaplan meier estimate can determine which outcomes
correspond to good and poor survival  the survival function

fi a 

 b 

 c 

fig     receiver operating characteristic  roc  curves for subtypes of breast cancer  four classifiers are shown  svm with
linear kernel  random forrest  linear discriminant analysis  and logistic regression  with a random classifier included for
reference   a  roc curve for estrogen receptor   b  roc curve for her  receptor   c  roc curve for her  receptor on the
training data 

 a 

 b 

 c 

fig     kaplan meier survival curves   a  survival for patients that present with a tumor and those that are tumor free   b 
survival for patients that are early stage  stage i  ii  iii  and late stage  stage iv  v    c  survival for er positive and
negative patients
is defined as 

y ni  di
s t   
di
t  t

   

i

where ni is the number of patients at risk of death at
time t and di is the number of patient deaths at time t 
kaplan meier estimates were obtained using the lifelines
python module       figures  a and  b validate the survival
data and show curves that are expected  early stage  tumor
free patients survive longer than late stage  patients with
tumors  however  most other outcomes are not correlated
with survival rates  fig   c  
v  conclusion
feature selection via a union of the group lasso  elastic
net regression  and greedy forward selection identified a

number of genes  networks  and biological pathways associated with survivability and receptor status  most significantly 
apoptosis  growth factor receptor  and reproductive development networks from the literature were strongly represented
in the down selected gene sets  hierarchical and k means
clustering approaches revealed substructure within the population  highlighting individual differences in survivability
and estrogen receptor status  the two techniques produced
strongly overlapping clusters  of the supervised learning
techniques used to predict cancer subtype  linear classifiers
such as lda  and linear svm produced over    percent
accuracy  while more complex clusters such as boosting and
the random forest led to overfitting on the training data 
regression analysis revealed that expression levels of mrna
are not good predictors of survival time or tumor stage 

fir eferences
    cancer statistics review              seer statistics  web    
nov        http   seer cancer gov csr            
    breast cancer   statistics  cancer net     jun        online   available  breast cancer facts    the national breast cancer foundation 
www nationalbreastcancer org web     oct       
    puglisi et al  current challenges in her  positive breast cancer 
crit rev oncol hematol       oct     pii  s                     doi          j critrevonc             
    stellato c  porreca i  cuomo d  tarallo r  nassa g  ambrosino c 
the busy life of unliganded estrogen receptors  proteomics      
oct     doi          pmic           
    matsumoto et al  biological markers of invasive breast cancer  jpn
j clin oncol       oct     pii  hyv    
    the cancer genome atlas   data portal  web     oct 
     https   tcga data nci nih gov tcga  
    cruz j  wishart d  applications of machine learning in cancer
prediction and prognosis  cancer inform                 published
online      february    
    bastani m et al  a machine learned classifier that uses gene
expression data to accurately predict estrogen receptor status  plos
one               e       published online      december    doi 
        journal pone         
    friedman j  hastie t  tibshirani r  regularization paths for generalized linear models via coordinate descent  journal of statistical
software                    http   www jstatsoft org v   i    
     zou  hui  zou hui  and hastie trevor  regularization and variable
selection via the elastic net  journal of the royal statistical society 
series b  statistical methodology                      print 
     yuan m  lin y  model selection and estimation in regression with
grouped variables  j  r  statist  soc  b            part    pp        
     leaps
r
package 
https   cran r
project org web packages leaps leaps pdf 
     http   thomsonreuters com en products services pharma lifesciences pharmaceutical research metacore html 
     ashburner et al  gene ontology  tool for the unification of biology
       nat genet             online at nature genetics 

     logarajah s  hunter p  kraman m  steele d  lakhani s  bobrow
l  venkitaraman a  wagner s  bcl   is expressed in breast cancer
and prevents mammary epithelial differentiation  oncogene       
              doi         sj onc         
     vogelstein
b 
sur
s 
p   
the
most
frequently
altered
gene
in
human
cancers 
cell
communication http   www nature com scitable topicpage p  the most frequently altered gene in          
     yamamoto ibusuki  mutsuko et al  c orf   esr  breast cancer
susceptibility locus  influence on progression and survival in
breast cancer patients  european journal of human genetics  ejhg
                     print 
     belanger a  tojcic j  harvey m  guillemette c  regulation of
ugt a  and hnf  transcription factor gene expression by dna
methylation in colon cancer cells  bmc molecular biology       
      doi                        
     biswas dk  shi q  baily s  strickland i  ghosh s  pardee ab  iglehart jd  nf kappa b activation in human breast cancer specimens
and its role in cell proliferation and apoptosis  proc natl acad sci
u s a       jul                     epub      jun    
     langfelder  p   b  zhang  and s  horvath  defining clusters from a
hierarchical cluster tree  the dynamic tree cut package for r 
bioinformatics                      print 
     lin yc  lee yc  li lh  cheng cj  yang rb  tumor suppressor
scube  inhibits breast cancer cell migration and invasion through
the reversal of epithelial mesenchymal transition j cell sci      
jan       pt            doi          jcs         epub      nov
  
     hartigan  j  a  and wong  m  a          a k means clustering
algorithm  applied statistics            
     pison  g   struyf  a  and rousseeuw  p j         displaying a
clustering with clusplot  computational statistics and data
analysis             
     scikit learn  machine learning in python  pedregosa et al   jmlr
    pp                  
     davidson pilon  c   lifelines          github repository 
https   github com camdavidsonpilon lifelines 

fi