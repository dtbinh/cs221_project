cs     project report
george liu
ta  albert haque
computer aided detection of endolymphatic hydrops to aid the diagnosis of menieres disease
   introduction
chronic dizziness afflicts over     of elderly in the united states  yet remains difficult to manage
because of the dearth of sensitive and specific diagnostic tests to differentiate its many potential causes
         treatment typically involves multiple workups and consultations but often no conclusive
diagnosis is reached  menieres disease is associated with chronic dizziness  tinnitus  and pressure in the
ears due to endolymphatic hydrops  fluid swelling in the scala media compartment inside the cochlea     
although detection of endolymphatic hydrops is the gold standard for diagnosing menieres disease  this
test currently can only be made during postmortem histopathologic examination      there is no standard
method currently to non invasively detect endolymphatic hydrops in a live patient to reach a conclusive
diagnosis of menieres disease 
optical coherence tomography is a new frontier for in vivo detection of cochlear abnormalities  optical
coherence tomography  oct  is routinely applied in non invasive retina examinations  and has
demonstrated potential for producing high resolution images non invasively of cochlea in mice      as
optical coherence tomography is translated to medical applications for imaging inside the cochlea of
humans  machine learning has the potential to aid the classification of oct images of cochlea as
demonstrating endolymphatic hydrops for diagnosing menieres disease  using oct images of cochlea
from healthy mice and mice exposed to large blast sounds to induce endolymphatic hydrops      we
trained and tested machine learning algorithms to detect endolymphatic hydrops  this is feasible because
endolymphatic hydrops is obvious visually in oct images  figure     the input to our algorithm is an
image and its manually measured scala media volume  we then use logistic regression  navebayes  and svm to output a predicted classification of endolymphatic hydrops due to blast
exposure 
section    related work
previously  machine learning has been applied to attempt to help make diagnoses based on oct images
in eyes  skin  and coronary arteries         in skin  researchers have applied the svm algorithm to
classify skin cancers other than melanoma  actinic keratosis lesions and basal cell carcinomas  using   
manually measured features of skin from oct images such as the thickness and number of skin layers
     researchers have also applied svm to classify stents as covered or not covered using manually
annotated oct images with the goal of assessing delay in arterial healing due to drug eluting stent
implantation      most work on medical oct image machine learning has focused on machine learning
predictions from eye oct images using manually measured features of the eye  such as the thickness of
the optic nerve and retina thickness  to try to detect early signs of glaucoma          these studies use
logistic regression and svm as well as generative learning algorithms to try to classify oct images of
eyes with glaucoma  although all of these attempts have demonstrated at least partial improvement to
detecting signs of disease  they all are still not fully automated  requiring non trivial manual feature
extraction from oct images  feature selection  and significant amounts of image segmentation  e g  to
detect the retinal area of interest   moreover none of the techniques have demonstrated sufficient
sensitivity and specificity to be routinely applied in clinical decision making so far  no work has been
reported on oct image analysis of cochlea  since cochlear oct imaging is rather new     

 

fifigure    oct images of scala media obtained by cochlear endoscopy in live mice before  left  and
after  right  exposure to blast noise  the dilated scala media in the blast exposed mouse  right 
suggests the presence of endolymphatic hydrops  the scala media is outlined in red in the normal
mouse image  left  to orient the reader  red asterisks  right  mark three user selected points on
reissners membrane for calculating its curvature 
section    dataset and features
data was obtained from oct imaging of cochlea in    distinct mice  five mice were treated with
exposure to blast sound in a custom built noise chamber to induce endolymphatic hydrops      and
compared with five control of the same age and background  oct images were taken in mice one  two 
and three hours after exposure  a total of    oct images was used for training and cross validation 
images of cochlea were obtained as z stacks of cross sections of the cochlea  the volume of scala media 
curvature of reissners membrane bounding the scala media  and time of image acquisition were used as
the three features for images  volumes of the scala media  figure    were manually measured in each zstack file using amira visualization software prior to this work  these volume measurements were
measured along the first      mm of the basilar membrane 
the curvature of reissners membrane  second feature  was calculated as part of the machine learning
training software in matlab  each input training image z stacked was displayed at the middle image of
the stack  this layer was chosen because it empirically was determined to capture the scala media crosssection in all images  three points on reissners membrane were specified by the user manually  and
from those three coordinates the curvature of reissners membrane was calculated using the known
mathematical solution for the radius of a circle passing through three points        figure    
   methods
the machine learning algorithms were coded in matlab  the three features and known feature labels
   exposed to blast    control  were used to train and test the following models  logistic regression 
nave bayes  and support vector machines  svm  of linear  quadratic  and cubic kernels 

 

fifor logistic regression  i used newtons method as coded in homework   with maximum iteration of   
for calculating theta  this iteration limit was found to be best empirically while working with the training
data  newtons method for estimating the parameters  uses the formula
          h    
where    is the log likelihood of   h is its hessian with respect to   and the likelihood of  is
calculated using the probability interpretation that p y       x      h x   where h x  is the logistic
function of the linear combination of parameters  and feature vector x       x     x     x   and y is
the output variable    blast    control   by iterating eq       newtons method provides a way to do
gradient ascent in getting  to converge to the value that maximizes     the number of iterations used
was     iterations less than    such as    and    also produced fairly good testing results  values above
    however  produced matrix singularity errors in calculating the hessian and its inverse 
for the support vector machines  svms   built in matlab functions were used to solve the dual
optimization problem for maximizing the geometric margin of the support vector decision boundary  the
dual optimization is given by

where the svm training function uses sequential minimal optimization to simultaneously update pairs of
alpha values to solve the optimization problem and determine the best decision boundary  intuitively  the
svm training algorithm solves for the decision boundary that maximizes the distance between the
boundary and its closest points  since these closest points therefore determine the decision boundary
 regardless of the position of all farther points   these points are known as the support vectors for the
svm decision boundary  training an svm is easy as long as it involves calculations only of the inner
product of the feature vectors  the svm can be expanded to include linear  quadratic  and cubic feature
mappings  or any other feature mapping  so long as the transformation merely changes the inner product
of the feature vectors to an easy to calculate inner product of the feature mappings  known as the kernel
of the transformation 
nave bayes presupposes that each discretized feature obeys a multinomial bernoulli probability
distribution and that the features are conditionally independent of each other  i used matlabs nave
bayes function to train and test this model 
   experiments results discussion
the settings used for the support vector machine training were the default matlab settings  since
newtons method was used instead of gradient ascent  a value of alpha  rate of ascent  for maximizing the
log likelihood was not needed or specified  the iteration cap was    for newtons method 
because the data set was small     unique mice  five per class     unique observations   training was
performed using leave one out cross validation  loocv   the percent of data that when left out during
training of the model resulted in that datums misclassification was used to test the learning algorithms 
in the future  the training and testing data sets should be kept separate during training and crossvalidation  although all models yielded zero training error but some cross validation error  overfitting
was likely not the issue because of the simplicity of the models used  but further work could test this 

 

fifigure    trained models and loocv confusion matrices and roc curves for two learning algorithms 
logistic regression

svm  linear kernel 

a

d

b

e

c

f

 

filogistic regression was performed on the training set using all the data  m    training examples  n  
features  first to determine a training error  using all data for training the model  the data is separable so
no misclassifications are made  the model and its error free classification of the training data is shown in
figure  a  during leave one out cross validation  logistic regression yielded   false positive and   falsenegative  figure  b   these errors were made for feature measurements at   hour of post treatment where
the data is less well separated  data not shown   the receiver operating characteristic  roc  curve is
shown in figure  c  the curve was generated by calculating the specificity and sensitivity of the trained
model above on the training data  with the cutoff logistic score adjusted at one hundred linearly spaced
values of h x  between   and    there is a tiny crease in the top left corner that is virtually negligible  it
is surprising  and perhaps an error  that the area under the curve  auc  is virtually one  more data is
probably needed to create sizable and distinct training  cross validation  and testing sets to flush out the
roc curve deflection for logistic regression 
linear svm produced the training model  loocv confusion matrix  and roc curve shown in figures
 d f  similarly to logistic regression  cross validation errors were made for feature measurements at  
hour of post treatment where the data is less well separated  data not shown   nave bayes with laplace
smoothing yielded the same confusion matrix as the linear svm algorithm  figure  e   the loocv
accuracies for logistic regression  svm  linear  quadratic  and cubic kernels   and nave bayes are
summarized in table    the differences in sensitivity and specificity among the algorithms are small 
the big takeaway from this initial exploration of machine learning classification of endolymphatic
hydrops in mice oct images is the better understanding of the problem at hand  clearly  from the data
plots  figures  a  d   the features of cochlea in blast and control mice are well separated after at least  
hours of exposure  before   hours  the blast mice are too early in the development of endolymphatic
hydrops from acoustic trauma to be as easily distinguished from the control mice  therefore  in future
work when more data is gathered  it will be essential to answer two questions      will data continue to be
so well separated for acquisitions two hours or later after treatment      can we separate the   hour post
exposure measurements better somehow  these results in mice provide insights into how these machine
learning algorithms will translate to detecting mild and severe endolymphatic hydrops in human patients 
table    summary of learning models and their leave one out cross validation accuracies 
model
leave one out cross validation accuracy  k    
logistic regression  h     cutoff 
     
nave bayes
   
svm  linear kernel 
   
svm  quadratic kernel 
     
svm  cubic kernel 
     
   conclusion future work
machine learning algorithms were able to accurately classify severe manifestations of endolymphatic
hydrops  however it suffered when trying to separate milder hydrops at the one hour mark  data not
shown   more data needs to be collected to confirm these results for a larger sample of endolymphatic
hydrops from the population in blast mice and  if possible  in human patients with related hearing loss 
   acknowledgments
data and volume measurements were provided courtesy of jinkyung kim  mentorship for this project was
provided by john s  oghalai 

 

fi   references bibliography
    sloane pd  coeytaux rr  beck rs  dallara j  dizziness  state of the science  ann intern med 
                   pmid          doi                          part                  
    centers for disease control and prevention  deaths  final data for       nvsr volume    
number    http   www cdc gov nchs data nvsr nvsr   nvsr      pdf
    post r and dickerson l  dizziness  a diagnostic approach  american family physician 
     aug                   http   www aafp org afp           p    html
    gates ga  menieres disease review       j am acad audiol                
http   www audiology org sites default files journal jaaa          pdf
    committee on hearing and equilibrium  mnire s disease  criteria for diagnosis and evaluation
of therapy for reporting  otolaryngol head neck surg                
    lee hy  raphael pd  park j  ellerbee ak  applegate be  oghalai js        noninvasive in vivo
imaging reveals differences between tectorial membrane and basilar membrane traveling waves in the
mouse cochlea  proc natl acad sci u s a                doi          pnas            
pmid         
    cho s i il  gao ss  xia a  wang r  salles ft  raphael pd  abaya h  wachtel j  baek j  jacobs
d  rasband mn  oghalai js  mechanisms of hearing loss after blast injury to the ear  plos one
 internet              ed       jan  cited      aug          e       available from 
http   www ncbi nlm nih gov pubmed          pmid          
    jrgensen  thomas martini  et al   machinelearning classification of nonmelanoma skin cancers
from image features obtained by optical coherence tomography   skin research and technology     
                
    lu  hong   machine learning based analysis of coronary stent images in intravascular optical
coherence tomography pullbacks    electronic thesis or dissertation  case western reserve
university        ohiolink electronic theses and dissertations center     dec      
     xu j  ishikawa h  wollstein g  bilonick ra  folio ls  nadler z  et al         threedimensional spectral domain optical coherence tomography data analysis for glaucoma
detection  plos one       e       doi         journal pone        
     kafieh r  rabbani h  kermani s  a review of algorithms for segmentation of optical
coherence tomography from retina  journal of medical signals and sensors                  
     burgansky eliash  zvia et al  optical coherence tomography machine learning classifiers for
glaucoma detection  a preliminary study investigative ophthalmology   visual science      
                  pmc  web    dec       
     http   www intmath com applications differentiation   radius curvature php

 

ficode libraries 




matlab classification learner application
o performed svm with quadratic and cubic kernels with leave one out cross validation
o obtained roc curve for svm linear kernel
o confirmed results of self implemented code for svm linear kernel
matlab statistics and machine learning toolbox
o train and predict linear kernel svm and nave bayes models
o display confusion matrices for logistic regression  svm  and nave bayes

 

fi