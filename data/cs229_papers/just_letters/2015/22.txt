predicting wine varietals from professional reviews
by ron tidhar  eli ben joseph  kate willison
  th december     
cs       machine learning  final project   stanford university
abstract
this paper outlines the construction of a wine varietal classification engine  through
use of topic analysis  word stemming and filtering  a nave bayes classification algorithm
performed with a surprising degree of accuracy  this research  therefore  represents exciting
first steps in applying machine learning techniques to an area not well studied in traditional
research 

 

introduction

but would also allow one to relate similar wines to
one another 

while many of us enjoy a good glass of wine  it can
be difficult at times to put a finger on what exactly
draws us to any particular bottle  given the qualitative breadth and scope of hundreds of different wine
varietals    ranging from the full bodied petit sirah 
to the light and sweet chenin blanc   its no wonder
that sommeliers and laypeople alike have striven to
share their experiences through developing a common
vocabulary around the qualities and aromas they find
in each glass  
although this vocabulary may be difficult to navigate for the uninitiated  among professional wine
reviews  one often finds distinct and recurring descriptors for each varietal  as such  in the following study  we aim to use data from a large sample
of professional reviews in combination with various
machine learning techniques to build a classification
model for a number of common wine varietals  this
would not only enable categorization based on provided wine tasting terms  which has applications for
recommender models and blind tasting  education  

 

data

data were scraped from http   www klwines com 
using a beautifulsoup   based python script between
           and             for each of    wine styles
categorized by the site  data for at most      unique
examples was collected  including varietal  professional and nonprofessional reviews  name  country 
region  appellation  alcohol content and persistent
web address  while at most five reviews were collected for each wine  a large portion of the dataset
had no associated reviews   these were removed from
the final dataset  in total  therefore         reviews
were collected for use in the analysis 

 

modeling

in order to measure a baseline performance  a simple
multi class one against all classification model was
built  this model was implemented across all    wine
  varietal refers to the type of grape primarily used in makvarietals using vowpal wabbit    words were toking a wine  so that a wine labeled as chardonnay must be
made from at least     chardonnay grapes  this is in con  enized and grouped across reviews for a given wine 
trast to classification systems used widely in europe  whereby and analyzed as a simple bag of words  training
blends are labeled by region rather than the grape variety  e g      of the data in a single pass with a logistic loss
bordeaux will commonly be a blend of merlot  cabernet franc
function  the resulting model correctly classified    
and cabernet sauvignon 
  for examples of common wine descriptive words used by
of the wines in the test set   far better than the apreviewers  see well known critic robert parkers wine glossary proximate prior of              
  https   www erobertparker com info glossary asp
  blind tasting is the practice of tasting a wine without
knowing any information about its origin  varietal or production  with the goal of guessing each from the qualities of the
wine itself 

  richardson 
l  
beautiful
soup 
crummy 
http   www crummy com software beautifulsoup       
  langford  j   vowpal wabbit  microsoft research 
https   github com johnlangford vowpal wabbit wiki

 

fifigure    table showing a sample of the    top wine related
words  as classified by the unsupervised lda algorithm 

figure    top    wine varietals by number of collected reviews 

given that the basic premise of the study was
validated by this simple analysis  further model refinement and strengthening was sought  as a first
step  a list of wine review specific stop words was
created  the words listed were ones that indicated
the varietal directly or indirectly  such as chardonnay or chateau   or else represented information
that wouldnt be available to a blind taster  e g 
hectare   and so were removed them from the data
set 
in order to counter the high variance demonstrated
in the initial learning curves  model simplification
was implemented  through both class and feature
set  i e   input words  reduction  this was accomplished by building a    category topic model using
latent dirichlet allocation  lda   in mallet  a java based package for statistical natural language
processing   re estimating dirichlet parameters every
   iterations  following this  calculations were made
for the cumulative probabilities of each word across
all wine related categories  as defined by the model
output  by stemming both the resulting word list 
as well as the words contained in the training data
 so that  for example  spice  spicey and spiciness
would map to the same feature   it was possible to
then filter the training features  in addition  in the
final model  only varietals for which there were at
least     reviews were included  a total of    predicted categories 
with such data treatment techniques  a simple
nave bayes classification algorithm was run on the

figure    learning curves for                  and     
feature word based models 

data  cross validation was used to assess the optimal number of word features  selected from the lda
topic analysis  to be used in the model 

 

results

learning curves 

given that the initial model exhibited high variance 
one clear strategy for improvement was to reduce the
feature set  to test this  cross validation was used
to find the most suitable number of word features 
the ranked list shown in figure   was used to filter four nave bayes bag of words models fit using
ten fold cross validation      holdout   one each for
the top                 and      words  using a set
of learning curves resulting from this analysis  algo  blei  david m   ng  andrew y   jordan  michael i  january        lafferty  john  ed  latent dirichlet allocation  rithm success rates were compared  as can be seen
journal of machine learning research         pp           in figure    using       of the top descriptive words
doi         jmlr                
to train and test the model yielded the best results 
  mccallum  andrew kachites 
mallet  a machine
learning for language toolkit  http   mallet cs umass edu  discussion of this somewhat surprising result follows
     
later 
 

fifigure   demonstrates an example of this with a subset of topics from the lda analysis 

 

applications

there are various applications of the wine classifier
model outside the realm of academia  the most
straightforward application is a simple wine recommender  given a set of descriptors that represent ones
general tastes  in terms of flavors  textures  and aromas   the model can recommend wines that best fit
that profile in a rank ordered list  see figure   for an
example of this in action  
this would allow someone to consider and gain exposure to wines which they may not otherwise have
been acquainted  for many who are interested but
new to the world of wine  understanding the nuances
in tastes and aromas can seem like a daunting task
that presents a barrier to enjoying wine to its fullest 
another application of the model is as a tool for
blind tasting  the wine classifier could serve as a
decision guide  as the user inputs more descriptors 
the model would update the likely matches and use
the coefficients to provide some motivation for why
a particular varietal is likely  though the model is
not a perfect predictor  this would nevertheless be a
valuable educational tool 
lastly  as many of the reviews analyzed also contained recommended food pairings  the wine classifier model could be modified to recommend winefood pairings  during data preprocessing for our
main model  these food mentions were filtered out 
as the associated words were relatively uncommon
 and therefore did not make the       word cut   by
modifying the feature inputs to include food related
words  it would be possible to build a model that
would recommend top food pairings for a given varietal  this could be useful for anyone looking to pair
a wine with a nice meal or vice versa  including both
restaurants and home chefs 

figure    test set confusion matrix  rows represent true
varietal value  while columns correspond to the predicted category for each example  cell values represent the total count
of examples that correspond to each true predicted value 

model quality 
the confusion matrix is useful to further assess the
performance of the most accurate model  in so doing 
it can be observed which varietals are most accurately
classified  i e  have a higher proportion of their row
sum in the cell along the matrix diagonal   as well as
which varietals they are most often misclassified as
 cells that lie outside of the matrix diagonal  
the confusion matrix shows us that those wines
that are misclassified are more often than not assigned to a varietal that is descriptively similar  for
example  in the test set  riesling is classified correctly
    of the time          but misclassified as sauvignon blanc in     of examples  this is fairly understandable  as both are pale green gold wines  mostly
unoaked  and often not very high alcohol  with  depending where they are grown  green fruit flavors
and high acidity    given this perspective  the    
accuracy that the model achieves on the test set is all
the more impressive 

varietal proximity 

another insight afforded by the lda topic analysis
involves varietals characteristic proximity to one another  because the algorithm is unsupervised  topics
conclusions
and
future
are each generally mapped to reviews of wines from  
more than one varietal  intuitively  a topic composed
work
primarily of two varietals indicates that those varietals are likely similar in the dimensions indicated by with a final classification accuracy of      it is clear
the highly weighted words associated with that topic  that there is still room for improvement  the learn  gregutt  paul 
white wine basics wine enthusi  ing curve for the       word feature model indicates
ast        http   www winemag com            white wine  a large separation between the training and testing
basics 
error rates  given a desired performance on the or  laube 
james 
molesworth 
james 
vader of         the curve implies that the model still
rietal
characteristics
wine
spectator
      
http   www winespectator com webfeature show id varietal  exhibits a high degree of overfitting  i e   variance  
characteristics     
to rectify this problem  two strategies may help 
 

fifigure    a sample output predicting what a user may enjoy
based on their input 

first  increasing the size of the training data set
will help reduce variance  and will serve to increase
model robustness  this is a relatively straightforward
improvement  and can be done by finding other review sites for which scraping is permissible 
secondly  reducing the size of the feature set  i e  
training on less words  is also likely to improve the
model  though this was tried  and rebuffed  with the
cross validation analysis  there are still some further
optimisations to be considered 
many descriptive words used in wine tasting require qualifiers or modifiers in order to be most meaningful  for example  while acidity may be picked
up as a feature  it is most descriptive with a modifier  the difference between a high acidity and low
acidity wine is significant  this is most likely the
cause of the counter intuitive cross validation analysis  as a result  a selected bigram analysis may serve
to reduce the feature set  by allowing for a smaller
set of more descriptive features 
ultimately  this paper presents promising first
steps towards building a robust wine varietal classification engine  by implementing the suggested further improvements  many of the useful applications
can easily be realised 

figure    subset of topics demonstrating result of lda
analysis  an interactive version of this figure can be found at
http   web stanford edu kawi wine model category vis html

 

fi 

bibliography

blei  david m   ng  andrew y   jordan  michael i
 january        lafferty  john  ed  latent
dirichlet allocation  journal of machine learning
research         pp          
doi         jmlr                
gregutt  paul  white wine basics wine
enthusiast       
http   www winemag com            white winebasics 
langford  j   vowpal wabbit  microsoft research 
https   github com johnlangford vowpal wabbit wiki
laube  james  molesworth  james  varietal
characteristics wine spectator       
http   www winespectator com webfeature show id varietalcharacteristics     
mccallum  andrew kachites  mallet  a
machine learning for language toolkit 
http   mallet cs umass edu       
parker  r   a glossary of wine terms 
erobertparker com 
https   www erobertparker com info glossary asp
richardson  l   beautiful soup  crummy 
http   www crummy com software beautifulsoup  
    

 

fi