optimization of optical structures using markov decision processes
tyler hughes and yu  jerry  shi

abstract
we present an algorithm for optimizing optical
structures based on markov decision processes 
our method is successfully demonstrated on a
one dimensional stack of dielectric slabs  where
we wish to choose a combination of slab thicknesses and refractive indices to approximate a
target reflection spectrum  we show that this
algorithm is less susceptible to being caught in
local minimum and has favorable computational
scaling as the number of layers is increased 

figure    schematic showing the physical system under
investigation  light of wavelength    is incident on a
series of slabs with thicknesses di and refractive indeces
ni   a fraction of optical power r   is reflected 
we wish to feed our algorithm a target spectrum and have
it return the optimal structure parameters for a number of
layers  a schematic of our problem is given in figure   

   introduction
a major challenge in optical and electrical engineering
is designing a structure with tailored optical properties 
tweaking physical parameters to optimize an optical device is often time consuming  unsystematic  and requires
large amounts of expertise  while systematic optimization
methods for optics and photonics exist          methods that
employ machine learning concepts are not found in the literature 
we propose a method of optimization of optical devices
that is based on a markov decision process      mdp  
which is commonly used for problems in control  this
method uses reinforcement learning to construct a policy
for perturbing structure parameters to minimize spectral error  the algorithm will be discussed in more detail in section   
we consider a physical system comprising of a onedimensional stack of dielectric slabs as shown in figure   
when light of a certain wavelength    is incident on the
stack  some fraction r   will be reflected and some fraction t   will be transmitted  depending on the properties
of the layers in a highly non linear way  we wish to design
a structure that will have a spectrum  r   that is as close to
some target spectrum as possible  a structure with k layers has  k independent parameters  namely the thickness
di and refractive index ni of each layer 
proceedings of the    nd international conference on machine
learning  lille  france        jmlr  w cp volume     copyright      by the author s  

figure    general schematic of the problem description 
a target spectrum is proposed  which is fed through our
mdp optimization algorithm  which returns a structure
that has a spectrum that approximates the target 

one application of this project is in designing antireflective coatings for solar cells  which aim to minimize
the amount of light that gets reflected      additionally 
there has been recent work on developing layered structures that reflect light in the visible spectrum and transmit
in a specific window of the earths atmospheric absorption
spectrum  these devices reflect sunlight and radiate their
heat into space to maintain temperatures below ambient 
for use in passive refrigeration      furthermore  our result
can easily be generalized to other physical systems that can
be parametrized by a limited number of quantities  so there
are many potential applications beyond the dielectric slab
stack 
we will start by explaining the method we use to calculate
spectra from a set of structure parameters in section    then
we will discuss our mdp algorithm for optimizing these
structures in section    finally  we will present our results
and a discussion on the usefulness and applications of our
approach in section   

fics     final project

   transfer matrix method
the transfer matrix method  tmm  is a well known optical
computation technique that computes the propagation of
light inside a layered medium using      matrices  when
light is incident from one medium to another  the transfer
matrix is written as
tn  n    n     

 
 n 



n    n 
n   n 



n   n 
 
n    n 

   

where n  and n  are the incident and transmitted materials
refractive indices  respectively  on the other hand  when
light at wavelength  propagates for a distance x in a material with refractive index nr   the matrix is written as


rx
 
 
exp i  n

 
tx  nr   x     
rx
 
exp i  n
  

   

when we have a known geometry  the total transfer matrix  ttot    for the propagation of light at each wavelength
can be computed with successive multiplications of transfer
matrices 

where r s  is the reward at state s           is the discount rate  a is the action taken at state s  and psa  s    is the
transition probability from state s to s  under action a  to
set up the mdp problem in the context of designing an optical structure  we need a set of discretized states s  action
space a  reward r s   and value v  s  
the states of mdp can be characterized by all set of possible spectra within the wavelengths of interest  in discretizing such an infinite dimensional state space  we sample the
reflection spectrum at w wavelengths and discretize the reflectivity at each wavelength into q regions  fig      with
such disretization  we obtain qw states  for instance  the
partition in fig    has a total of          states  and the
reflection spectrum shown in red is at state s       we
further define the reward of each state such that it penalizes
spectra that deviate from the target spectrum 
r s      rtarget  rstruc    ni     di          

   

given a structure whose spectrum is at state s  the action is
taken as a perturbation of one of the structure parameters 
specifically  we vary one of the layer refractive indices by
     or one of the layer lengths by    nm  hence  there
are  k possible actions 

ttot      tn  nout   nk  tx  nk   dk    
      tn  nk   nk   tx  nk    dk     
      tn  n    n   tx  n    d     

   

      tn  n    ni n  
in our simulations  we have assumed that the geometry is
surrounded by air  so nin   nout     
the overall reflection from this structure can be obtained
simply by looking at two of the matrix elements of ttot    
fi
fi
fi  t     fi 
fi tot
   fi
   
r     fi
fi
fi  ttot       fi
to calculate a spectrum  which we will discretize and define as our state in the next section  we simply sample w
points in wavelengths               w   

   markov decision process
to implement the markov decision process  mdp  algorithm  we consider a klayer structure with  k independent structure parameters    ni     di     the essence of
mdp is to update bellmans equation at state s until v  s 
converges 
v  s    r s     max
aa

x
s  s

psa  s   v  s    

   

figure    discretization of a spectrum into states  the red
curve is the continuous reflection spectrum  and the red
dots are the sampled reflection values 
we outline the iterative mdp algorithm in fig     first 
we start with a random structure whose spectrum is at state
s  then we consider taking all  k actions and compute
each of their rewards at the resulting states  we define the
policy  s  as the optimum action a taken at state s such
that psa  s   v  s    is maximized  upon transitioning from
state s to s  under action a  we keep track of the transition
rate between s and s  with action a as well as the reward at
state s  such that we can continuously update psa  s    and
r s   for each starting structure  we exit an iteration of
learning when the structure parameters deviate from realistic material parameters or when the state transition happens
indefinitely between two states 

fics     final project

minimum in the error plot of figure    the plot on the right
hand side shows the spectrum of the optimized structure is
in good agreement with the target spectrum  notice that the
trajectory traverses a local maximum before converging at
the global minimum  this feature suggests that the mdp
optimization is less likely to settle in local minima than a
method such as gradient descent  which uses a local search
to move through parameter space 

figure    schematics of the mdp process 
we denote learning convergence as the case when for every
state updated with eqn       every v  s  converges with exactly   iteration  after converging    times  we terminate
the learning process  from which we obtain the optimal policy    s  at state s  in the next section  we demonstrate that
by using    s   we can start from a random state and find
the optimum structure whose reflection spectrum matches
the target spectrum 

   results and discussion
as proof of concept and illustration of our algorithm  we
consider a system with a single slab  k      with thickness
d  and refractive index n    we specify a target spectrum
over five wavelengths  w      and with a resolution in
reflection of      q        using tmm  we can calculate
the mean squared error between our structures spectrum
and the target spectrum for each combination of n  and d   
which is plotted in figure    we limit search space in n 
and d  to the ranges        and         respectively  the
purpose of our algorithm is to find a combination of n  and
d  that minimizes the error corresponding to the error plot
in figure   

figure    left  trajectory  green  of a structure through
parameter space during a run of our mdp algorithm 
right  the final structure  blue  and target  red  spectra 
over the course of      trials  our algorithm converges to
the global minimum for       of the initial random parameters  which is quite high considering the small basin
of attraction of the global minimum 
when the number of layers is increased beyond k      our
algorithm has trouble converging as evidenced by figure   
an increase in one layer adds four more possible actions
to the model  two       perturbations for two  nk  dk  
parameters   which greatly increases the amount of time
until convergence 

figure    log error  between the spectrum of the
optimized spectrum and the target spectrum as a function
of number of trials for different layer thicknesses  k  

figure    top left  schematic of the one layer stack
system being analyzed  bottom left  target spectrum 
right  brute force calculation of the error between
calculated spectrum and target spectrum as a function of
structure parameters 
after running a total of     training runs with a  of      
our mdp algorithm converges  we plot the progression of
a randomly generated structure as it converges to the global

we believe that this physical system may be not well suited
for an application of the mdp algorithm due to the large
action and state space  however  by a simple counting
argument  we can show that our algorithm scales with k
much better than brute force calculation  the size of the
action states is proportional to k  which means the number
of calculations needed to populate a model psa  s    is also
proportional to k  conversely  a brute force optimization
method  calculation of fitness for all combinations of parameters  depends on the desired resolution r and k as
r k  
although our mdp optimization algorithm may not be optimal for designing the reflection spectrum of a multilayer

fics     final project

stack  we show it does have success for limited layers  our
method was able to locate a global minimum in a small
basin of attraction for a reasonable percentage of trials 
furthermore  in principle  the method could be generalized
to other problems perhaps with better success if the number
of states and actions is smaller 
since the application of machine learning in optical design
is an unexplored territory  this work is a first step in this direction  we anticipate there will be applications in this area
that could benefit immensely from this method of analysis 
but it will take some future experimentation to find systems
that can take full advantage of our algorithm and other tools
in machine learning at large 

references
    lu  jesse  and jelena vuckovic  inverse design of
nanophotonic structures using complementary convex optimization  optics express                       
    veronis  georgios  robert w  dutton  and shanhui
fan  method for sensitivity analysis of photonic
crystal devices  optics letters                        
    ng  a  cs   a lecture notes   stanford university 
    wright  daniel n   erik s  marstein  and awe holt 
double layer anti reflective coatings for silicon solar cells  photovoltaic specialists conference       
conference record of the thirty first ieee  ieee 
     
    raman  aaswath p   et al  passive radiative cooling
below ambient air temperature under direct sunlight 
nature                          

fi