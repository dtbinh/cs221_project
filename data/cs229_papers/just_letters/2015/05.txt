finding the optimal fantasy football team
paul steenkiste
pws stanford edu
december         
i  introduction
fantasy football  just like the game of football itself  as grown from a benign neighborhood pastime into
an immensely profitable corporate industry  over the past decade  the number of individuals who play in
a fantasy football league has grown by      to a total of      million people   through their purchase
of website memberships  league entrance fees  and draft cheat sheets  fantasy football has become a
    billion dollar market  to put this into perspective  the average valuation of an nfl team is a mere
      billion  while the team with the highest net worth is the dallas cowboys  at just    billion   
however  outside the television pundits and online soothsayers  there has been relatively little formal
work done on how to predict the fantasy value of a given player  for this project  i used various machine
learning tools to try to do just that  i focused on the largest growing sector of the industry  daily fantasy
leagues  where participants pay an entry fee and are given a certain amount of fantasy dollars with
which to purchase a team  with one player for every position  each players price is determined based on
how well the league projects him to perform that week 
because of the lack of rigorous examination of the expected payout of any given player  there are sure to
be mispriced players whose hidden value can be exploited by a fantasy competitor  i aim with this
project to help the fantasy sports industry move closer to an equilibrium that would be predicted by the
efficient market hypothesis  where asset prices fully reflect all available information 
i used three models  linear regression  random forests  and multivariate adaptive regression splines 
for each model  i used as input every players statistics in the previous weeks of the season  as well as
the team he was playing in each week  i then predicted how each player would do against his specific
opponent in each of the relevant fantasy categories  passing yards  rushing touchdowns  etc   in the
coming week 
ii  related work
as previously stated  very few people have attempted to use machine learning to predict fantasy football
outcomes  or  if they have  they are using their findings to take advantage of the information
asymmetries in this infant market   in fact  i was only able to find a single research paper on the topic 
roman lutz of the university of massachusetts amherst used support vector regression to try to
predict the fantasy scores of nfl quarterbacks  with some promising results   seeing that svms were
already attempted  i decided to build a basic linear regression model to see how it performs  and then run
diagnostics on its performance to see where it would be most fruitful to go next 
iii  dataset and features
i gathered the weekly player statistics for each of the first    weeks of this nfl season from nfl com  
considering that there are    teams playing almost every week  each team having around nine players
making offensive statistical contributions on any given sunday  this came out to around       data
points 
for every week from nfl week   through nfl week     i trained each model using the data from all
the previous weeks  and tested each model on the current week  i decided to start training after three
weeks of data had been logged because a players statistics from just one or two games would probably
not be enough to predict his future performance  the x values for each data point were the player and
opposing team for the given contest  and the y values were the resulting fantasy statistics for that player 

fito represent each player in vector form  i simply constructed a binary dimension for each player 
because there were     total players in the data set  this means that i created     dimensions  for any
given data point of a specific player in a specific game  each of these added dimensions contained a  
except for the one corresponding to that player  i did the same process to represent the opposing team
the player was going against in that game  because there are    teams in the nfl  i added another   
dimensions  each of which contained a   except for the one corresponding to the correct opposing
team  in total  therefore  each x value was a vector of     binary values  only two of which were    
the fantasy leagues i was evaluating used nine
statistical categories to give each player a fantasy
score  see table     for each data point  the
players statistical performance in each category
represented the y value 
when discussing the error of my models in this
paper  i will be referring to the sum of normalized
squared error as given by following equation 

           

    
 

 

table    fantasy scoring system
statistical category
passing yards
passing touchdowns
interceptions
rushing yards
rushing touchdowns
fumbles
receptions
receiving yards
receiving touchdowns

fantasy points
    
 
  
   
 
  
   
   
 

normalizing the squared error by the estimate of the populations standard deviation is necessitated by
the differing units of the statistical categories  if my model is able to predict a running backs rush yards
to within ten yards  that should be considered a resounding success  however  if my model predicts that
he will get ten more touchdowns than he eventually does  that would be a grave error indeed  i owe the
idea to normalize this way to daniel oneel and reed johnsons      cs    paper  
iv  methods
model    linear regression
to begin my examination of fantasy football predictions  i decided to run a basic linear model  using
matlabs fitlm function  training and testing this model for every week  i generated learning curves
for each statistical category  see figures   and   for examples  
each of the learning curves had the same general shape  the model would steadily improve until roughly
midseason  and then the slope of the test error would flatten out  with a significant gap between the
training and test errors  this implied that the model suffered from a variance problem more than a bias
problem 

a common remedy to high variance is simply to collect more data points  however  since i had collected
every possible point from the current nfl season  my options were limited  i could have collected data

fifrom previous years to try to use a players performances from earlier in his career as predictors 
however  considering the constantly shifting landscape of personnel and scheme in the nfl  as well as
the fact that some of the top performers in the league are rookies who do not have previous seasons to
analyze  this strategy seemed unlikely to bear fruit 
model    random forests
random forests  rfs  are a regression method that builds many regression trees  with no pruning  from
the inputted data  and then outputs the mean prediction of all of the individual trees  in order to bifurcate
the trees  rfs form an estimation of what variables are important to the regression  and thus they work
well with data sets with large feature sets  like my own    further  one of the reasons rfs were
developed was to correct for decision trees proclivity to overfit the data  thus  it seemed a perfect tool to
combat the variance of my linear model  
to implement rfs  i used rs randomforest package  as will be seen  rfs did turn out to be an
effective tool in predicting scores  especially towards the beginning of the season when other models
were still suffering from very high test error 
model    multivariate adaptive regression splines
multivariate adaptive regression splines  mars  is a nonparametric regression method that makes no
immediate assumptions about the relationship between the data  using spline functions  piecewisepolynomials that allow there to be kink points in the regression lines   mars automatically models
nonlinearities and interactions between the variables   as i was unsure whether there were any such
hidden relationships in my dataset  mars proved immensely useful  further  because it partitions the
input space into multiple regions  it is also particularly suitable for data with large feature sets  again 
like my own   
to implement mars  i used rs earth package  because mars allows arbitrarily many degrees of
interaction between the variables  i needed to determine up to what degree the model would be effective 
mars  as a nonparametric model with a lot of flexibility  tends to overfit the data if the degree is too
high  resulting in artificially low training error but inflated test error  the earth package in r  however 
uses a pruning technique to limit the allowed complexity of the model  therefore  if the degree is set too
high  the package simply ignores the higher interaction terms  in our case  the model minimized test error
at degree    and so for all subsequent degrees the errors were precisely the same  see figure    

model   i  weighted mars
finally  it occurred to me that the model might be improved if recent weeks were weighted more heavily
than performances from earlier in the year  conceivably  a player could have a trajectory through the
season  perhaps he is an aging player whose physical abilities are declining  or a rookie who is learning
the ropes and getting steadily better 

fiusing the conventional gaussian weighting formula with
various bandwidths  i ran mars and found that the test errors
steadily increased as the bandwidth got smaller  with the lowest
error being that of the original unweighted model  see figure    
therefore  more recent games have no more predictive power
than earlier games  and the model was needlessly throwing away
information by using different weights 
v  results
figures   and   show how well the models performed relative to each other in two statistical categories 
in most categories  the mars models consistently performed the best in terms of normalized test error 

there were a few categories that were inherently more difficult to predict across all models  most
notably fumbles and interceptions  see figure     this makes some intuitive sense  while statistics such
as total yards are accumulated over the course of an entire game  and thus not as susceptible to random
chance   a games solitary interception can be caused by the slightest slip of the finger by the
quarterback  and the one fumble in a running backs season occurs because the defenders helmet hit the
ball in just the right location  thus  turnovers are immensely difficult  if not impossible  to predict 

to see how my models performed relative to real life sports columnists and commentators  i ran the
quarterback data through all three models and predicted who the top seven fantasy options would be for
week     i then compared my rankings to those of two professional prognosticators  see table          

fias one can see  my rankings did very well compared to those of the analysts  all three models correctly
chose four or five of the players who did actually end up ranked in the top seven  highlighted in green
above   with relatively few gross over appreciations  defined as players who actually ranked twentieth
or worse  highlighted in red above   in contrast  both professional analysts grossly overvalued two
players  derek carr    th  and philip rivers    th   these missteps are especially embarrassing
considering that there were only    quarterbacks in the model 
one of the principal reason my models outperformed the experts is that the latter base their decisions
largely on the reputation of quarterbacks  notice that both tom brady and aaron rodgers were highly
ranked by the two experts  brady and rodgers are two of the most renowned and prominent players in
the league  they have had a lot of success in years past  and  indeed in some weeks this year   and so
many simply assume they will always play well going forward  however  while neither of them
performed horribly  they both only ended up in the middle of the pack  my model  instead of relying on
name recognition  took all the available information  who they were playing  how they did against
specific defenses in the past  and correctly ranked them outside the top seven 
there are some things even my rankings could not predict  however  notice that jay cutler  who
eventually earned mediocre statistics that week  is ranked in the top seven by all my models  cutler had
been having a very strong season up to that point  but since that week he has been playing relatively
poorly  there was no indication in the previous statistics that this would happen  so my model could not
have known  football is a human game  after all  and some things simply cannot be predicted 
vi  conclusion
my models can already be used by fantasy competitors to purchase a team that will be successful with
high probability  one must simply look up the team matchups for the week  input the binary data into
the models  and receive back fantasy score projections  from there  it is a relatively simply linear
optimization problem to discover the best team you can buy with your fantasy budget constraint 
max 
   

      
                 

           
all of the above can be represented in matrix form  and inputted into any linear optimization software 
going forward  however  my models can definitely be improved  there are many more input variables
that can be tested for predictive power  for instance  how experienced is the player  if he is a rookie  he
is probably not going to be able to have the immediate statistical success that a battle hardened veteran
might  is the player recovering from a recent injury  this season  a very good quarterback named tony
romo was injured and could not play for a few weeks  when he returned  many expected him to return to
his winning ways  romo played very poorly at first  however  taking some time to get back into form 
perhaps if injuries had been incorporated into my models  this could have been predicted  further  a
players injuries can have implications for his teammates as well  this season another great quarterback 
ben roethlisberger of the steelers  also had to take a few weeks off because of an injury  during this
time  one of the best wide receivers in the nfl  antonio brown  also on the steelers  had some relatively
poor statistical sundays because he was forced to play catch with an inferior backup quarterback  if my
model had somehow incorporated teammates injuries  perhaps this  too  could have been predicted 
overall  however  i am happy with the performance of my models to this point  as they have already
bested the predictions of people who get paid to predict football statistics for a living  perhaps my dream
of an efficient fantasy football market  where fantasy values fully reflect all available information and
player futures are traded on the margin  is not too far off 

fireferences
   affleck  john   what s behind fantasy football s surprising popularity   fortune     sept       
http   fortune com            fantasy football growth  
   ozanian  mike   the most valuable teams in the nfl   forbes  forbes magazine     sept       
http   www forbes com sites mikeozanian            the most valuable teams in the nfl  
   lutz  roman   fantasy football prediction   arxiv preprint arxiv                   
   http   www nfl com stats weeklyleaders
   oneel  daniel and reed johnson  nfl defensive performance analysis  fall      cs    project 
http   cs    stanford edu proj     daniel   oneel    reed   johnson    defensive   unit
   performance   analysis pdf 
    random forests   berkeley statistics department 
https   www stat berkeley edu  breiman randomforests cc home htm overview 
   breiman  leo   random forests   machine learning       october             
   statsoft   multivariate adaptive regression splines  marsplines    multivariate adaptive
regression splines  marsplines   dell software  https   www statsoft com textbook multivariateadaptive regression splines 
   friedman  jerome h   multivariate adaptive regression splines   the annals of statistics     
             
    loechner  tyler   fantasy football week    preview and predictions   bleacher report     nov 
      http   bleacherreport com articles         fantasy football week    preview andpredictions page   
    borgognoni  kyle   fantasy football  qb  primer week      fantasypros     nov       
http   www fantasypros com         fantasy football qb  primer week     

fi