whale detection   identification from aerial photography
aditya mahajan  adrien perkins
 mahajan   adrienp  stanford edu
department of aeronautics   astronautics  stanford university  california 

 

 poor lighting from reflections on the water or
lack of contrast between the whale and the water

introduction

the north atlantic right whale is a critically endangered species of baleen whale  with an estimated fewer than     individuals living in our
oceans         in the interests of science and conservation  it is necessary to track and monitor these
animals  currently  only a few experienced researchers are able to identify and tag individual
whales through the use of custom software and this
process is extremely time consuming         this
project focuses on detecting and identifying whales
from aerial imagery using techniques from machine
learning and image processing 

 varying orientations of the whales from breaching to diving as well as feeding and spouting
 occlusions due to sea foam and distortion from
the water

an additional drawback of the dataset was the
skewness of the labeled data in terms of images per
unique whale  figure   highlights the uneven nature of the training data  it can be seen that more
than half of the whales had fewer than    images
each  whereas one specific whale appeared in   
different images  this was expected to pose a chala large dataset  comprised of about        aerial lenge during the identification process 
images  has been made available by kaggle for this
task  approximately       of these images are la      related work
beled as training data and the remainder make up
previous work in animal tracking underwater relies
the test set 
on many different types of vision based sensing like
the problem was split into the following two parts  multi channel imagery and infrared cameras        
the dataset used in this work consisted only of im   detecting a whale in the image and deterages in the visual range  so it was inferred that demining which pixels are whale and which are
tecting the whale under the water was similar to
ocean  two machine learning algorithms  one
detecting elements in an image under a shadow 
supervised and one unsupervised  were emthis process is handled very well in the hsv color
ployed for this task 
space along with k means clustering        
   identifying the individual whale  designated
feature matching using the scale invariant feaby id number  in a given image using baseline
ture transform  sift  has successfully been used
scale invariant feature transform  sift  feafor ecological research on marine fauna like manta
ture matching techniques and supervised marays     and leatherback turtles      given that
chine learning 
many of the whales have visually distinct markings
on their backs  tails  and noses  sift feature match    dataset
ing has been considered as a key step in the whale
the dataset provided for training consists of       identification process 
images of     unique whales  the images have
varying resolutions  between     megapixels    technical approach
while many of these images are of excellent quality
and capture the whale clearly  others pose several the whale detection and identification problem has
challenges from a computer vision point of view  been divided into two sub problems  the tasks of
determining which pixels in an image belong to
these are illustrated in figure   and include 
 

fifigure    many images from the dataset suffer from poor lighting  occlusions and distortions  above
are a few examples that pose a challenge for whale detection 
jones      algorithm  originally developed for face
detection  and outputs a set of bounding boxes
which cover the roi of a alleged whale 
      k means clustering
kmc was executed for each image  with each
pixel represented in   dimensional hsv  huesaturation value  space  hsv space was chosen
over rgb space due to its robustness to different
lighting conditions that may be present throughout an image  the difference can be visually seen
in figure   and the corresponding kmc results are
figure    the frequency of the number of training shown in the same figure 
images per whale 
during kmc  the pixels were placed into one of four
clusters  roughly mapping to ocean  whale  refleca whale is addressed in section      and the task tions and foam   the cluster with the largest numof determining the unique identification number of ber of pixels was assumed to be a binary ocean
the detected whale is addressed in section     
mask and the remaining pixels were inferred as
whale  due to the possibility of small  discon    whale detection
nected regions  reflection and foam  being classified as whale  the following steps were taken to entwo means of detecting a whale in an image were
sure one contiguous whale object 
considered  the cascade object detector  cod   a
supervised learning tool in matlab  and k means  the ocean mask was dilated and eroded to close
clustering  kmc   an unsupervised approach for
small holes
partitioning data into sub spaces based on the char the ocean mask was inverted to obtain a whale
acteristics of each data point 
mask
      cascade object detector
 the largest contiguous blob in the whale mask
was retained
the cod is a built in training image labeling app
for matlab  using this app      images were man the whale was slightly eroded to mitigate feaually annotated with regions of interest  rois 
ture extraction from surrounding foam
corresponding to positive and negative instances of
a whale sighting  expressing each annotation as a to expedite convergence of kmc  the cluster cenhistogram of gradients  hog        the hog is troids were initialized as a random sample of the
a common descriptor used in computer vision and pixels in the image  intuitively  this increased the
works by counting gradient orientations in a local possibility of a centroid being initialized near its
neighborhood of pixels  the cod uses the viola  converged location 
 

fiinformation had to be condensed for efficient computation 
principal component analysis  pca  was used to
reduce the dimensionality of the data to more manageable    dimensional vectors       note that the
objective of pca was to reduce data dimensionality
with minimal information loss and improve feature
matching speed  pca was not used to reduce overfitting 
each image  n  was represented by a set of mn features  this meant that the images themselves could
be discarded  and instead be represented by a feature matrix  fn  r  mn  

figure    a whale difficult to see  top left 
becomes obvious in hsv  top right   kmc
performs poorly in rgb space  lower left  
compared to hsv space  lower right  

to ensure that the reduced sift data performed
like the full dimensional sift data  descriptor
matching was done on a subset of the images with
    whale identification
both the     dimensional and    dimensional data 
the resulting matches for the   data sizes were very
having manually looked at many of the whale imsimilar  indicating that any information lost during
ages provided  it was noticed that most whales had
pca was negligible 
distinct features on the nose and back and we felt
sift features may be able to capture that infor        basic feature matching  baseline 
mation  furthermore  sift is invariant to rotation
the baseline method involves simple sift deand scale  dispelling the need to rotate scale the
scriptor matching  two descriptors are declared
whales  therefore  the first step to identification is
matched if the euclidean distance between them
the successful extraction of good sift features for
is a threshold factor closer than any other descripeach of the whale images 
tors  two sets of descriptors  one per image  can
we then looked at two different ways of whale be compared to identify those shared across both
identification  testing these methods using k fold images 
cross validation with   folds  given that a portion
all of the training images in   of the   folds were
of the whales only have a single training image  the
combined to create a set of features to define each
cross validation was modified to guarantee at least
of the     different whales  e g  for a given
one training image per whale 
whale  k  its feature set  sk    fi   fj   where sk 
      feature extraction   dimensionality re  r  x mi  mj   if images i and j contain whale k  each
duction
image in the test fold was compared to each of
the     different sets of features to get a matching
feature descriptors were extracted from the pixel
vector m  r    which contained the number of
regions  determined in the section above  using
unique matching features between the test image
sift       sift is a common feature extraction
and the feature sets  to account for the different
method and is invariant to changes in lighting and
number of whale images that made up each of the
orientation  furthermore  the descriptors rely on
feature sets  m was normalized by the number of
local pixel information  making them robust to mifeatures in the given feature set  finally  the test
nor occlusions 
image was tagged to the whale that had the highthe result of sift is a descriptor for each feature est match value in m  
 there can be thousands of features on a whale 
      support vector machine  svm 
in     dimensional space  the sheer size of the
dataset         images   combined with the high the supervised learning identification method used
dimensionality of the feature space  meant that this was an svm using the libsvm library for matlab
 

fi      the features used in the svm were each of
the different    dimensional sift features themselves and the label for each sift feature was the
id of the whale that feature came from  this resulted in an svm with     different classes 

whales that had the most images in the training set 
this was due to the fact that the kmc detection
method was not perfect and would include some
water or foam from the training images  these features would successfully  albeit incorrectly  match
to watery parts of many of the test images 

much like the baseline    of the folds would be used
to train the svm and one used for testing  to classify a specific test image  each of the images   dimensional sift features were labeled with the
svm and the final identification of the image was
that of the most commonly occurring label 

 

to minimize water and foam matches  feature sets
derived from multiple images of the same whale
were pruned  to prune the feature set  only the
features within a threshold distance of each other
 within     of the best match  were retained  and
any odd features were discarded  while the pruning did help reduce the number of features for most
of the whales  aiding computation time  there was
still difficulty with some water features  as that
water was common between the images  despite
this  when running sift matching  the test images
no longer matched to the same whales as before 
the test images now had a preference to match to
whales that had training sets comprised of only a
single image 

results

this section summarizes the results of the whale
detection  section      and identification  section
     algorithms  training and testing was done
with k fold cross validation with   folds 

    whale detection
the detection results obtained from cod and kmc
are compared in figure    in the upper sample 
it can be seen that kmc  right  is able to detect
more of the whale than the cod  whereas in the
lower sample  kmc avoids selecting ocean pixels
due to the blob versus bounding box nature of
the rois  in an attempt to assess the performance
of kmc and the cod      random sample results
were examined manually  in this assessment  the
kmc performed better than the cod almost    
of the time  for these reasons  kmc was used to
obtain the results in section     

this new problem most likely occurred from the
dilution of good matches with bad features in the
feature sets  for a whale with only a single image  most of the false matches arise from water or
foam  while comparing a test image with the correct whale feature set  comprised of multiple images   the good matches on the whale were diluted
by the number of bad features there were in the
set  looking at a percentage match  the percentage was reduced due to these bad features  we are
still looking into properly tuning the detection and
feature extraction steps to produce the best feature
sets for this method 

    whale identification
the performance of the whale detection and extraction of features was crucial to the performance
of the whale identification  unfortunately  while
a lot of improvements were made to the detection and feature extraction steps  we were unable
to get either of the identification methods to work
successfully  however  in this section we describe
some of the challenges faced and improvements
that were made throughout this process 

      svm
training the svm was incredibly expensive  computationally  and hence time consuming  taking
over    hours with only a quarter of the training
set  with just that quarter of the data  the svm
failed to correctly classify any of the training images  due to the lengthy computation time and
minimal success on the baseline method  we focused our efforts on getting better features to better
define each of the whales and testing with the baseline method  it was believed that feature extraction
was a priority over implementing the svm  as the
svm was based on the same features 

      sift feature matching  baseline 
the use of sift feature matching for whale identification posed several different challenges  when
using the initial features to do the matching  almost all of the test images matched to the few
 

fifigure    original image  left   and features  red  detected in whale areas as identified by cod
 center   and kmc  right  

 

conclusions

 

future work

other classification methods  such as convolutional
neural networks  robust whale identification rewhale detection was successfully performed on quires impeccable detection performance and even
aerial imagery with k means clustering on images further processing of the images  such as aligning
in the hsv space  this resulted in superior whale all the whales to be in the same direction 
detection in comparison to the cascade object detector  using sift features for identification proved
to be extremely challenging and depended strongly
on the ability to extract good  reliable features from
each image  while many iterations and improvements were made on the sift features  like dimensionality reduction using principal component analysis   robust whale identification was unsuccessful
using either baseline sift feature matching or an
svm with sift features as the svm features 

the whale detection method used in this paper performed very well  however  there is room for improvement  in order to better extract the whale
itself from the image  methods of background removal can be implemented to possibly remove frequency content that corresponds to regular ocean
wave patterns  it is understood that the kmc algorithm is prone to problems with local minima
 see figure    which can be managed by running
kmc several times or attempting to initialize kmc
with learned centroid values for whale  ocean  reflections and foam 

figure    kmc on an image  top  can lead to
correct  middle  or incorrect  bottom  whale
detection 

for whale identification  the authors would like to
suggest many improvements  especially with trying
 

fireferences

in      ieee computer society conference
on computer vision and pattern recognition
 cvpr     volume    pages         ieee 
     

    kaggle inc  right whale recognition       

    noaa fisheries  north atlantic right whales
 eubalaena glacialis        
     paul viola and michael jones  rapid object
detection using a boosted cascade of simple
    new england aquarium  digits  digital imfeatures  in proceedings of the      ieee
age gathering and information tracking syscomputer society conference on computer vitem       
sion and pattern recognition  cvpr       volume    pages i   i     ieee comput 
    yuliya podobna  jon schoonmaker  cynthia
soc       
boucher  and daniel oakley  optical detection of marine mammals  in weilin  will       david g  lowe  distinctive image features
hou  editor  spie defense  security and sensfrom scale invariant keypoints  international
ing  volume       pages      j     j   
journal of computer vision                 
       
     
    henry stark  considerations in designing a      aly a  farag and shireen elhabian  a tutorial
marine mammalship collision avoidance syson principal component analysis       
tem based on aerial imagery by an unmanned airborne vehicle  optical engineer       chih chung chang and chih jen lin  libsvm 
a library for support vector machines  acm
ing                   
transactions on intelligent systems and tech    s  vitabile  g  pollaccia  g  pilato  and e  sornology                 
bello  road signs recognition using a dynamic pixel aggregation technique in the hsv
color space  in proceedings   th international
conference on image analysis and processing 
pages         ieee comput  soc       
    rita cucchiara  costantino crana  massimo
piccardi  andrea prati  and stefano sirotti 
improving shadow suppression in moving
object detection with hsv color information 
in itsc            ieee intelligent transportation systems  proceedings  cat 
no   th       pages         ieee       
    christopher town  andrea marshall  and nutthaporn sethasathien  manta matcher  automated photographic identification of manta
rays using keypoint features  ecology and evolution                        
    p m  dezeeuw 
e j  pauwels 
e b 
ranguelova  d m  buonantony  and s a 
eckert  computer assisted photo identification of dermochelys coriacea  in international
conference on pattern recognition  icpr  
     
     navneet dalal and bill triggs  histograms
of oriented gradients for human detection 
 

fi