finding poverty in satellite images
neal jean
stanford university
department of electrical engineering
nealjean stanford edu
abstract
the lack of reliable poverty data in developing
countries poses a major challenge for making
informed policy decisions and allocating resources
effectively in those areas of the world  unfortunately 
it can be prohibitively expensive to frequently
conduct comprehensive surveys that track measures of
economic progress  a cheap and scalable method of
producing poverty maps would greatly facilitate
economic progress in these developing countries  in
this paper  we present a method for predicting
socioeconomic indicators directly from satellite
images  we take the output of a convolutional neural
network  cnn   a       element feature vector  and
use these image features along with known survey
data from certain parts of uganda and tanzania to
perform linear regression on continuous wealth
measures  we then use our models to predict
consumption based wealth measures and asset based
wealth measures for both uganda and tanzania  we
find that our machine learning based predictions
approach survey accuracy at a fraction of the cost 

keywords
remote sensing  poverty mapping  computer vision 
convolutional neural networks  cross validation

rachel luo
stanford university
department of electrical engineering
rsluo stanford edu
this project builds on work done by the ermon
group in the computer science department at
stanford  previously  xie et al      trained a
convolutional neural network  cnn  to predict
nighttime light intensities from daytime satellite
imagery  this cnn output a       dimensional
feature vector 
however  due to the scarcity of poverty data  we
cannot train the cnn directly on poverty  instead  we
take a transfer learning approach with the assumption
that the features useful for predicting nighttime light
intensities are also useful for predicting poverty
levels  and use linear regression to predict poverty
measures from satellite images with the feature vector
output by the cnn  thus  our inputs are daytime
satellite images and our outputs are continuous wealth
measure predictions  figure   below displays the
pipeline for our project 

daytime satellite imagery

x 

x 

x 

xn

convolutional neural network

   introduction
the rise of big data in recent years has
precipitated an explosion of new applications  from
robotics to computer vision  from advertising to
movie recommendation algorithms  big data and
machine learning are now almost ubiquitous 
however  one area that could benefit from further
attention is the allocation of resources for third world
countries  one challenge that has been impeding
progress in the area of developmental economics is
the difficulty of obtaining reliable data in these areas
of the world  we hope to improve this state of affairs
by accurately predicting poverty levels through the
proxies of consumption based wealth measures and
asset based wealth measures without the use of
expensive surveys 

x 

low dimensional feature representation

y 

y 

y 

y 

yn

continuous wealth measures
fig    project pipeline  focus of our project in dotted box 

fi   related work
the field of computational social science or
computational sustainability is a relatively young one 
so opportunities for new applications of machine
learning abound  early work on identifying poverty
using remote sensing was presented in      by data
scientists from datakind working in conjunction with
the ngo givedirectly  their goal was to identify the
poorest villages in western kenya in order to deliver
direct cash transfers to the very poor  in their
approach  they used template matching to find roofs
in satellite images  then hand designed conventional
computer vision features such as color histograms that
would allow them to classify roofs as either metal or
thatched         they then used the ratio of metal roofs
in each village as a proxy for the amount of poverty
present 
a more recent approach to poverty prediction was
published in science just a few weeks ago 
blumenstock et al  used mobile phone call record data
from a large mobile provider in rwanda to predict
asset based wealth measures nationwide      in
addition to using survey data  they conducted a smallscale phone survey to collect personalized wealth data
specific to their call record dataset  for their poverty
measure  they used a wealth index based on the first
principal component of the data collected on survey
respondent asset ownership  a method summarized by
filmer and pritchett in     
this project is a continuation of work in prof 
stefano ermons group in the stanford ai lab  as
described earlier  xie et al      trained a cnn to
predict nighttime light intensities from daytime
satellite imagery  and then used the learned filters to
predict poverty  however  they worked exclusively on
the problem of predicting binary poverty labels
 classifying each location as either in poverty or
poverty free   while we attempt to predict
continuous measures of socioeconomic status in this
project  in going from a binary classification problem
to a continuous wealth regression problem  we hope
to provide more useful and fine grained poverty data
for the world bank and other entities on the ground in
africa 

   dataset and features
we use satellite images from google earth    
covering all of uganda and tanzania to predict
poverty in both countries  our uganda set includes
    household clusters  where each cluster contains
around    households surveyed  since up to   km of
jitter is added to each reported cluster location to

preserve the anonymity of the survey respondents  we
tile each location with     images of   km  each to
cover a    km by    km area  our tanzania set
includes     locations  where each location is
subdivided as in the uganda set  all images are    
pixels      pixelsat google maps zoom level    
this corresponds to a resolution of approximately  
meters per pixel  some examples of our satellite
images are shown in the first row of figure   
our project uses two separately obtained
continuous
wealth
measures 
consumption
expenditure based and asset based  for consumptionbased wealth measures  we procure training and test
examples from the living standards measurement
study  lsms   the lsms is administered by the
world bank and collects consumption expenditure
data at the household level      these consumption
expenditures represent the amount a household spends
in a given period of time  and are generally considered
a better measure of living standards than traditional
metrics such as income 
for asset based wealth measures  we employ
training and test examples from the demographic and
health surveys  dhs   an independent organization
that collects health and household asset data in
developing countries      the survey includes
questions such as whether the household owns a
refrigerator  whether it owns a car  and whether it has
access to electricity  and these asset based questions
are then used to create a continuous wealth index that
we try to predict  the wealth index is calculated by
creating a matrix from the answers to the survey
questions  taking the first principal component of this
matrix  and using a linear combination of its elements
    

   methods
we use linear regression to predict these wealth
measures in uganda and tanzania  for both the
consumption expenditures and the asset based wealth
measures  we try ordinary least squares  ols 
regression  lasso  l   regression  and ridge  l  
regression 
ols regression seeks to minimize the distance
between the predicted wealth values and the true
wealth values  we use x i  to denote the input variables
 the image features in this case   and y i  to denote the
output variables  the continuous wealth measures  
let h represent our hypothesis  and i represent the
unknown parameters mapping from x to y  also  let m
be the number of training examples and n be the

finumber of features        here   then         and
ols chooses  to minimize the cost function
 
 
   
            
 
   

l  regression is similar to ols  but it includes a
regularization term to prevent overfitting the training
set  thus  it chooses  and c to minimize
 
 
 
 
   
   
   
    
 
 
   

   

this method forces many of the i parameters to zero 
effectively finding a sparse feature representation 
l  regression is also similar to l  regression  but
it uses a different regularization term  the cost
function that it minimizes is
 
 
 
 
   
   
   
    
   
 
   

   

and this regularization encourages the i parameters to
be very small 
to train our model and evaluate its performance 
we use a    fold nested cross validation scheme for
the l  and l  regression methods  in the outer loop
of this procedure  we divide our training data into   
equally sized  disjoint sets  we then take   of these
sets  combine them  and again subdivide this
combined set into    equally sized  disjoint subsets 
in the inner loop of the procedure  we train our data
on the subsets using standard    fold cross validation
and select a model  we then go back to the outer loop
and test it on the   th  previously unseen  set to get an
estimated generalization error  we repeat this process
   times  leaving out each set once  and average the
estimated generalization error from each run 
the prediction metrics we use are the average r 
values over the    folds  with r  calculated as
 
 

      
     
 
 

      
where sse is the sum of squared prediction errors and
tss is the total sum of squares  a measure of how
much the data varies around its mean  the higher the
r   the better the model predicts the continuous wealth
measure 

    predicting consumption
in predicting consumption expenditures  we
obtain the results shown in table   below for the
tanzania data and similar results for the uganda data 
by comparing the satellite test r  columns  we can see
that ridge regression performs the best of the three 
approaching survey test accuracy  the choice of
regularization
hyperparameter
is
extremely
importantsince we are using high dimensional
feature vectors and training on relatively small
datasets  we must avoid overfitting 
we then use the uganda model to predict
consumption expenditures in tanzania and plot the
average test r  for both countries vs  the average
uganda training r  to obtain figure    this graph
shows where the model begins overfitting for the
uganda data  around r           as well as the optimal
training r  for generalization to tanzania  around r   
      based on these results  we believe that computer
vision based methods for poverty prediction should
generalize well across national borders as long as the
visual features of both countries are similar  uganda
and tanzania are neighboring countries in subsaharan africa  with comparable geographies and
socioeconomic conditions  
ols

lasso  l  

ridge  l  

features

survey

satellite

survey

satellite

survey

satellite

training r 

     

     

     

     

     

     

test r 

     

      

     

     

     

     

table    linear regression models predicting consumption
expenditures in tanzania 

   results and discussion
we run ols  l   and l  regression on the
uganda and tanzania data separately to train models
for each country  and we also use the uganda model
to predict wealth measures in tanzania to see how
well that model generalizes 

fig     average test r  vs  average uganda training r  
optimal uganda training r  for both uganda and tanzania
models shown in orange 

fi    urban rural divide in predicting
consumption

 a 

we then examine whether our models
performance shows significant discrepancies between
urban and rural areas  our first approach is to perform
ridge regression for all of the combined data  and then
to look at the urban and rural households separately 
with this approach  we obtain the results shown in the
combined row of table   and in figure    this
figure and table come from the uganda data set  but
both countries yield similar results  clearly  our
model does a better job discriminating between
households in rural areas than in urban areas  in fact 
in the urban household group  we would attain better
results simply by predicting the mean urban
expenditure rather than using our model 
urban
r 

rural

 b 

overall

training

test

training

test

training

test

combined

     

      

     

     

     

     

separate

     

     

     

     

 

 

table    combined vs  separate urban and rural regression
models 

fig      a  uganda urban points with best fit line 
 b  uganda rural points with best fit line 

    predicting assets

fig     uganda combined model with all data points  urban
points are shown in red and rural points are shown in blue 
the urban and rural lines look very dissimilar 

our second approach involves pre processing the
data to separate out the urban and rural points  and
then applying ridge regression to these two sets
separately to build two distinct models  we obtain the
results shown in figure   and in the separate row of
table    again from the uganda data set   this
approach significantly improves the r  values of both
the urban and rural sets 

finally  we run ols  l   and l  regression on
the asset based wealth measures  with the results
shown in table   for uganda   tanzania looks
reasonably similar   figure   plots our predicted
wealth index against the true wealth index  the goal is
to obtain a linear relationship between the two with a
slope of    such that our predicted values map to the
true values  looking at the plot  we do in fact find a
linear trend with r           this improves upon the
results published in science in      which found a
trend with r         using mobile phone record data 
our hypothesis is that asset based wealth measures
are easier to predict using satellite images than
consumption based measuresassets can actually be
seen in some cases  while consumption cannot 

fiols
r 
our model

lasso  l  

ridge  l  

training

test

training

test

training

test

     

     

     

     

     

     

table    linear regression models predicting asset based
wealth in uganda

international conference on knowledge discovery
and data mining             doi 
                        
    varshney  k  r   chen  g  h   abelson  b   et al 
      targeting villages for rural development
using satellite image analysis  mary ann liebert 
inc        march               doi 
        big           
    blumenstock  j   cadmuro  g   and on  r       
predicting poverty and wealth from mobile phone
metadata  science             nov                   doi          science aac     
    filmer  d  and pritchett  l  h        estimating
wealth effects without expenditure data  or tears 
an application to educational enrollments in states
of india  demography         feb                 
doi          dem           

fig     our predicted wealth index values vs  the true
wealth index values in uganda 

   conclusion
our predictions for consumption expenditures
approach survey accuracy  while our predictions for
asset based wealth measures improve upon recent
state of the art results  additionally  our poverty
estimation techniques based on remote sensing and
machine learning can be applied on a global scale at a
fraction of the cost of traditional survey based
methods  cheaply and accurately predicting poverty
in developing countries can help governments and
non profits better allocate their resources and create
effective policies  in the future  we hope to extend this
work by applying these techniques to other countries
and creating poverty maps with greater geographic
coverage  in addition  we hypothesize that poverty
dynamics include predictable temporal and spatial
relationships  we hope to obtain satellite images from
different points in time and then create a probabilistic
graphical model that can take into account poverty
relationships between points that are neighbors in
both time and space 

   references
    xie  m   jean  n   and ermon  s        transfer
learning from deep features for remote sensing and
poverty mapping  corr  http   arxiv org abs 
           
    abelson  b   varshney  k  r   and sun  j       
targeting direct cash transfers to the extremely
poor  proceedings of the   th acm sigkdd

    google static maps api  tanzania  uganda 
november      
    world bank        living standards measurement
study  various   datasets  
    icf international        demographic and health
surveys  various   datasets  

fi