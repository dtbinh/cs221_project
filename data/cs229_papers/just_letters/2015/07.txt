cs    
final report

data driven discovery and design of superionic
lithium conductors for high performance lithium
ion batteries
aditi krishnapriyan    austin sendek 
abstract
we present a data driven model for predicting the lithium ionic conductivity of a solid crystal from atomistic structure  we employ ordinary least squares  ols  and locally weighted least squares  lwls  regression  coupled
with manual dimension reduction and leave one out cross validation  loocv   to identify linear hypotheses
that can predict ionic conductivity within roughly two orders of magnitude on the siemens per centimeter scale 
with a loocv error of        where  is the training set ionic conductivity standard deviation  the ols model
approaches but does not break the conventional performance threshold of     employed by the quantitative
structure property relationship  qspr  community  the lwls model has a loocv error of      and thus
breaks this threshold  we then screen       candidate lithium conductors with the ols hypothesis to search for
promising new lithium conductors  and employ the more accurate lwls hypothesis for screened materials lying
deep inside the region in data space defined by the training set 
  stanford

university  stanford  california

contents
introduction

 

 

related work

 

 

dataset and features

 

 

methods

 

    ordinary least squares linear regression              
    locally weighted least squares linear regression  
    exhaustive model search with loocv                
 

results

 

    ordinary least squares regression                        
    locally weighted least squares regression            
    screening                                                          
 

conclusions and future work

 

acknowledgments

 

references

 

introduction
many of the major technological developments of the young
twenty first century are increasingly reliant on the ability to
locally store energy  between the grid scale penetration of
renewable power systems  worldwide proliferation of mobile
devices  and revolutions in hybrid and fully electric vehicles 
the future requires power on demand  however  progress in
many of these diverse areas has been tempered by the same
technological bottleneck  poor battery performance 

lithium ion batteries  libs  are one of the most promising
energy storage technologies for a wide array of applications 
including mobile devices and transportation  however  libs
are dogged by safety concerns  boeing lost millions of dollars
after it was forced to ground their entire fleet of    s after an
lib pack caught fire  and news of a smoldering battery fire in
a crashed tesla model s caused tesla motors stock to drop
by     the root cause of these safety problems is the liquid
electrolyte  which in most commercialized libs is a volatile
and flammable organic solvent  thus  solid state lithium ion
batteries hold promise as safer  longer lasting alternatives to
conventional liquid electrolyte batteries  the bottleneck for
this technology is simply the dearth of quality solid electrolyte
materials  solid electrolytes with higher ionic conductivities
must be discovered before solid state libs are competitive
with liquid electrolyte libs    
over the past four decades  much effort has been given to
searching for solid electrolyte materials that exhibit high ionic
conductivity  these materials are known as superionics  
ionic conductivity is notoriously hard to intuit from crystal
structure  and so identifying promising materials is largely a
game of guess and check  however  checking guesses with
experimental methods or electronic structure simulations can
take days or weeks  because of this  progress in the search for
new superionics has been slow  and high conductivity materials are often discovered serendipitously  these is reason to be
optimistic for progress  considering the tens of thousands of
known  untested  lithium containing materials  but exploring
this space through guess and check experimentation is not
tractable  instead  we employ ols and lwls regression

fidata driven discovery and design of superionic lithium conductors for high performance lithium ion batteries 
   

techniques to build ionic conductivity predictors  thus facilitating time efficient screening of these tens of thousands of
materials and identification of the most promising candidates 
importantly  our features are based only on the atomistic structure  i e  atom positions only  not electronic structure  of the
crystal  so they can be calculated almost instantaneously 

   related work
using conventional theoretical methods for calculating ionic
conductivity  the atomistic structure of a crystal is used to
calculate the electronic structure  using e g  density functional theory       and then the electronic structure is used
to calculate ionic conductivity  however  calculating the electronic structure is time consuming  oftentimes more timeconsuming than actually synthesizing the material and measuring its ionic conductivity experimentally   and so knowing direct correlations between atomistic structure and ionic
conductivity would be valuable  this connection between
atomistic structure and ionic conductivity has been explored
in recent years  though to our knowledge we present the first
application of machine learning to the problem 
reviews of superionics by hull     and avdeev  et al    
mention several crystal characteristics that may be correlated
to ionic conductivity  including the bonding character of the
mobile ion  in our case  lithium   mobile ion concentration 
and the polarizability of the bottleneck atoms blocking the
passage of the mobile ion from one equilibrium site to another 
however  hull admits  a number of plausible factors are
likely to be influential  including the crystal structure    however  the relative importance of any one of these factors in promoting superionic behavior is difficult to assess  owing to the
relatively small number of known superionic phases and the
inherent interrelationship between the individual factors    
our goal is to use machine learning techniques to identify
these important factors and tease out the interrelationships 
much work has been done by adams and colleagues in the
last fifteen years to develop a method for quickly calculating
ionic conductivity from atomistic structure using the bondvalence  bv  method     the bv method outputs a scalar
measure of the amount of empty space in the crystal  which
represents the free space for mobile ions to migrate through 
this method has been cross checked against experimental
data and it has been noted that the cube root of this measure is
linearly correlated with the base    log of ionic conductivity 
however  this measure was only validated among glassy crystals of very similar stoichiometry  and so it remains to be seen
whether it can accurately predict ionic conductivity across a
set of diverse crystals  in the language of machine learning 
this technique is simply a one feature linear predictor  and
thus it stands to reason that it is likely less accurate than a
technique which incorporates several features 
additionally  further hope for a connection between atomistic structure and ionic conductivity has been inspired by
recent work out of the ceder group     without using any
learning techniques  a correlation between the arrangement

of the anions in the sublattice and ionic conductivity was
identified  the closer the arrangement of anions in the lattice
represents a bcc lattice  the larger conductivity tends to be 
although this gives weight to the argument that atomistic
structure can be directly tied to ionic conductivity  it does not
address the fact that many fast ion conductors do not have this
arrangement  nor was this trend discovered in a systematic 
transferrable way  it is likely only one favorable arrangement
of many  and machine learning represents an exciting way to
discover a more generalized relationship from which this and
other favorable arrangements may be found 

   dataset and features
the data for the training set is composed of atomistic structures and ionic conductivity values for a range of materials 
these ionic conductivity values are measured experimentally
and reported in the scientific literature in units of siemens
per centimeter  s cm  the corresponding structure files for
the given conductivity measurements were downloaded from
the inorganic crystal structure database  icsd      however 
ionic conductivity data for crystalline materials is somewhat
hard to come by and as a result  our data set consists of only
   materials  several of the training structures and their corresponding conductivities are listed in table    the range of
conductivities spans over    orders of magnitude  from     
to          s cm   so we take the base    log of the values 
after taking the log  the mean ionic conductivity is          
and the standard deviation is          before running any
regressions  we mean center the data and normalize by the
standard deviation  given the small size of the training set 
we do not set aside a separate test set  see the methods section
for more on how we prevent overfitting  
table    select training set structures and ionic conductivities

 s cm 
formula
li    la    tio 
li   ge ps    
li   znge  o  
li  ca nh  
li  ge  o  
li  nh
li  s
li    si    s    o 

ionic conductivity
        
        
        
        
        
        
       
        

reference
    
    
    
    
    
    
    
    

from the training set of crystal structures  we extract   
features based on simple crystallographic and chemical relationships  including many of those elaborated by hull and
others        this feature extraction is done automatically for
each structure with a matlab script  several of the    feature values for the fast lithium conductor lithium triphosphide
 li  p  are given in table    all feature values are meancentered and normalized by their standard deviation to ensure
equal weighting in the regression  the feature extraction takes

fidata driven discovery and design of superionic lithium conductors for high performance lithium ion batteries 
   

roughly ten seconds of wall time per structure 
the structure files for the high throughput screening were
taken from the materials project  mp  database  a publicly
accessible database of materials     we download the entire
database of nearly        materials with permission through
the api  and then filter this down to       non metallic lithiumcontaining materials 

m

j       w i    t x i   y i      
i  


 x i   x  
 i 
where w   exp 
   

in this case  the weight terms wi depend on the particular
query point x  more weight is given to the training examples
near the query point  thus   is a function of the query point x 
and the hypothesis is non parametric  to find    we minimize
table    some atomistic features for lithium triphosphite
 
average atomic volume
     a the cost function accordingly  with the weighted term 
m
average li bond ionicity
    
   argmin j      argmin  w i    t x i   y i    
average li coordination
    
i  
li concentration
     a 
the bandwidth parameter  defines what is local to the
average smallest li li distance
    a
particular query point and controls the degree of smoothing
lattice packing fraction
    
over the training set  in practice   must be optimized numeri normalized  distribution of empty space
    
cally 
ratio of li bond ionicity to sublattice ionicity
    
average li coordination to sublattice coordination     
    exhaustive model search with loocv
due to the small size of the training set  m       and the
high number of extracted features  n        we take special
   methods
care not to overfit the data  thus  our task is to reduce the
dimensionality of the training set and evaluate the predictive
to identify a model with high predictive capability  we employ
error through cross validation as a function of the reduced
both ols and lwls regression with an exhaustive search
set of features  however  rather than performing parameter
over all possible models  in the following sections we describe
regularization or a forward or reverse propagation  which
the regression algorithms in detail  followed by a description
we
performed and found only marginal success with   we
of our model search algorithm 
find the best performing model by actually performing crossvalidation on every one of the                   possible
    ordinary least squares linear regression
for a given feature set  xi   i                 n   where x       models  a process that is enabled by the small training set 
for each model  we compute the training set error and the
multiple ols linear regression provides a parametric linear
loocv
error using both ols and lwls techniques  we
hypothesis of the following form 
then
select
the ols model that gives the lowest loocv error
n
t
of
all
ols
models  as well as the lwls model that gives the
y    i xi    x
i  
lowest loocv error of all lwls models  we use both of
these models in the subsequent screening step  we note that
where  is the vector of coefficients and x is the design
the reduced set of features is not necessarily the same for the
matrix  in order to find the coefficients i   we minimize the
ols and lwls models 
following cost function with respect to   
we use loocv over k fold cross validation because of
m
t
 i 
 i 
 
the
small training set  we do not want to remove too much
   argmin j     argmin    x  y  
i  
data from the training set at one time  for the same reason  we
do not partition our data into a training and test set  instead 
given the small size of our data set  m        we are able
we
use the root mean squared loocv error as a proxy for
to quickly find these coefficients exactly using matlabs
the
test set error 
mvregress function  which evaluates the ols normal equation 
    x t x   x t y
    locally weighted least squares linear regression
the application of ols regression assumes the dependence
between the features and conductivity is linear  we have
no reason to suspect that this dependence is linear a priori 
because of this  we also build a model using locally weighted
linear regression  for lwls linear regression  while the
hypothesis has the same form as ols linear regression  the
cost function to minimize has the following form 

   results
    ordinary least squares regression
in evaluating the mean squared training set and loocv error
over all models using ols  we identify a six feature model
with a mean squared loocv error of      and a training set
error of        this loocv error corresponds to a predictive
error of     orders of magnitude in s cm  which  although
fairly high  is still useful for identifying the best conductors on
the     orders of magnitude scale on which they live  in order
to see the effect of under and overfitting  we plot in figure  

fidata driven discovery and design of superionic lithium conductors for high performance lithium ion batteries 
   

figure    blue curve  mean squared loocv

error for the lowest loocv x feature model as a
function of x  red curve  mean squared training
set error for the lowest loocv x feature model 

figure    observed vs  predicted log
 conductivity  for the training set materials using
ols regression on the optimal six feature subset 
identified through loocv 

figure    blue curve  mean squared loocv

error for the lowest loocv x feature lwls
model as a function of x  red curve 
corresponding training set error 

figure    observed vs  predicted log
 conductivity  for the training set materials with
the optimal lwls model 

the mean squared loocv error for the lowest loocv xfeature model as a function of x  we see that  generally  the
loocv error is higher for small x  high bias   minimized
at intermediate x  and high again at large x  high variance  
there is a minimum representing the optimal model at x     
figure   shows the plotting of the observed vs  predicted log
 conductivity  for the training set materials 
    locally weighted least squares regression
before a model can be chosen with lwls  the bandwidth
parameter  must be optimized  to do this  we run the exhaustive model search for a range of values of  and select the
 value which gives the lowest loocv error  however  we
must take into account that we are searching over models of
varying dimensionality  and the euclidean distance between
points separated by a given distance in all dimensions scale
with the square
root of the number of dimensions  thus we
choose     d  where d is the number of features  we
perform the model search for varying values of  running
from      to     we find that the most useful values lie in the
range of     to   with an optimum at      these trends are
plotted in figure   

figure    we plot the loocv of the lowest loocv

x feature model for    x      we see the model is
optimized  loocv error is minimized  at        

fidata driven discovery and design of superionic lithium conductors for high performance lithium ion batteries 
   

thus  the exhaustive
model search technique with the op
timized        d  we find the optimal model has seven features  a training error of      and a mean squared loocv
error of        this level of error corresponds to a predictive
error of     orders of magnitude in s cm  making the lwls
model more accurate than the linear model  the model selection and model performance data for this model is plotted in
figures   and   in the same style as the aforementioned ols
metrics 
    screening
after developing our ols and lwls hypothesis functions 
we use them to predict conductivity to over       candidate materials from the materials project database     this
database contains the atomistic structures and dft computed
electronic structure for over        materials  we download
the entire database with permission through the api and then
filter out all materials except those that contain lithium and
are not metallic  i e  those with a band gap greater than zero  
for each of the remaining       materials  we extract the necessary features and evaluate the ols hypothesis function  we
choose to evaluate all structures with the ols function first
because it extrapolates better outside the training set region 
the locally weighted function requires training data nearby
to give meaningful predictions  however  we do evaluate the
locally weighted hypothesis for those data points which have
normalized feature values between    and   for all features 
the predictions of the most promising materials are listed
in table    these predictions are calcluated with the ols
model and lwls corrections are given if the point is within
the training set region in space  all features must be within
one standard deviation of the mean   due to the potentially
high impact nature of this research and the likelihood of future
publication  we have withheld the actual chemical formulas
and simply replaced them by integer material indeces 
table    promising ionic conductivity predictions from the

materials project structures from the ols model and the
lwls model  if applicable  chemical formulas not
displayed  
material index

ols

 
 
 
 
 
 
 
 

        
        
        
        
        
        
        
        

lwls
n a
        
n a
        
        
n a
n a
        

advancement of solid state lithium ion batteries  we develop
a structure property model for ionic conductivity using ordinary least squares and locally weighted least squares regression  which are capable of predicting ionic conductivity
within approximately two orders of magnitude on the s cm
scale  we use these hypotheses to then rapidly screen over
      candidate lithium containing materials to search for new 
undiscovered superionics and find many promising candidates
for future investigation 
future theoretical work may focus on finding more robust
atomistic descriptors which can predict ionic conductivity
with higher accuracy  or on applying new algorithms like support vector regression  a larger training set would be helpful 
and so developing a method for automated data scraping of
ionic conductivity values and structures from the literature
would likely improve the model accuracy and robustness of
the analysis manyfold 
additionally  an in depth study of the features and their
coefficients that survive the model reduction is likely to be
scientifically informative  from these features  we may be
able to build new intuition on which classes of materials are
unlikely to ever be highly conductive and which show great
promise  this may enable many new systematic studies of
various structure types such as that performed by wang et
al    

acknowledgments
the authors of this research paper would like to thank professor evan reed  who helped conceive the ideas and guide the
project  prof  reed also provided many valuable resources
including texts on property prediction in molecules and materials  we would also like to thank professor yi cui  who
provided the motivation for the application to solid state batteries and provided valuable feedback on technologically feasible
requirements  we thank our collaborators in the reed group 
qian yang and karel alexander duerloo  who helped guide
the application of machine learning and facilitated the downloading of the materials project database  respectively  all
data analysis  figure generation  and writing was done by the
authors a s  and a k  we acknowledge funding from the stanford university office of technology licensing through the
stanford graduate fellowship program for supporting a s s
work  as well as support for a k  through the department
of energys computational science graduate fellowship  finally  we encourage the reader to look for a forthcoming paper
in a peer reviewed journal  where we will provide the sensitive information omitted here  the full training set  feature set 
and most promising screened materials 

references
   conclusions and future work
the development of new approaches for identifying superionic lithium conductors is of critical importance for the

   

icsd
basic
search
and
retrieve
at
 https   icsd fizkarlsruhe de search basic xhtml jsessionid
 bcc    d e   e   c  fbec c   cf  

fidata driven discovery and design of superionic lithium conductors for high performance lithium ion batteries 
   
   

jain  a  et al  commentary  the materials project  a
materials genome approach to accelerating materials innovation  apl mater                   

   

hull  s  superionics  crystal structures and conduction
processes  rep  prog  phys                  

   

avdeev  m   nalbandyan  v  b  and shukaev  i  l  in
solid state electrochemistry i  ed  kharton  v  v           wiley vch verlag gmbh and co  kgaa         at
 http   onlinelibrary wiley com doi                   
    ch  summary 

   

p  hohenberg and w  kohn  phys  rev       b           

   

hull  s  and berastegui  p  crystal structures and ionic
conductivities of ternary derivatives of the silver and copper monohalidesii  ordered phases within the  agx x mx   x and  cux x  mx   x  m k  rb and cs  x cl 
br and i  systems  j  solid state chem               
       

   

adams  s  and swenson  j  determining ionic conductivity from structural models of fast ionic conductors 
phys  rev  lett                       

   

j  swenson and st  adams  structure conductivity relations in ion conducting glasses  ionics      pp      
       

   

wang  y  et al  design principles for solid state lithium
superionic conductors  nature materials              
       

    

kamaya  n  et al  a lithium superionic conductor  nat 
mater                     

    

jimenez  r   rivera  a   varez  a  and sanz  j  li mobility
in li    xnaxla   tio  perovskites     x        influence of structural and compositional parameters  solid
state ion                        

    

bruce  p  g  and west  a  r  the ac conductivity of
polycrystalline lisicon  li     x zn    x geo   and
a model for intergranular constriction resistances  j 
electrochem  soc                      

    

li  w   wu  g   xiong  z   feng  y  p  and chen  p 
li  ionic conductivities and diffusion mechanisms in
li based imides and lithium amide  phys  chem  chem 
phys                       

    

liebert  b  e  and huggins  r  a  ionic conductivity of
li geo   li geo  and li ge o    mater  res  bull 
                   

    

lin  z   liu  z   dudney  n  j  and liang  c  lithium
superionic sulfide cathode for all solid lithium sulfur
batteries  acs nano                     

    

shannon  r  d   taylor  b  e   english  a  d  and berzins 
t  new li solid electrolytes  electrochimica acta    
               

fi