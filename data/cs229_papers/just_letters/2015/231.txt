short term price prediction in financial markets
kam chinta  kamchinta gmail com 

dharan althuru  dharan althuru gmail com 

will yearick  yearickw gmail com 

   introduction
asset price fluctuations have ramifications for every individual across the globe  the wealth of investors in traditional assets  such as
stocks and bonds  will vary and lead to changes in personal consumption and savings  even individuals in the most impoverished
countries have their lives impacted indirectly through commodity prices such as energy and food  foreign exchange rates will
dictate purchasing power and the export   import mix of nations  the factors effecting macroeconomic trends can be attributed to a
myriad of sources  fundamental  technical  and psychological factors will all contribute to underlying price patterns and
movements  oftentimes  the cause of a certain price trajectory is unknowable and random  clearly  professional investors  traders 
and portfolio managers have their livelihood tied to price prediction  retail investors necessarily base life altering decisions such as
college and retirement based off the whims of the stock market  our objective is to apply machine learning techniques to predict
short and medium term price fluctuations for financial assets  two members of our team work directly in financial services  one as a
professional trader   and all members have a keen interest in developing a better guide to understanding markets  thus  we
attempt to predict the price of the s p     stock index over multiple horizons using twenty two technical indicators and price data
from three additional assets  we experiment with ordinary least squares regression  smo support vector regression with
polynomial  rbf kernels  the objective is two fold      to properly predict the direction of the price for       and    day horizons
 classification problem      given a correct classification  to evaluate the delta spread of our price prediction vs the actual price
subject to a given confidence band  regression problem   in order to evaluate our performance  we benchmark the algorithm vs 
both a random walk and the hit ratios attained in prior research publications  concretely  a hit ratio above     and a delta spread
within     of the predicted price fluctuation will be viewed as a success 

   related work
long term price predictions in terms of directional accuracy on a korean stock price index using svms  kim et al      cao  lijuan et
al    performed financial forecasting to show that svm outperform back propagation algorithms  in this work  we predicted longterm price prediction to start with on s p index using smo svm  platt  john et al    as a benchmark and results are in line with this
work  the primary goal of this project is short term price prediction by considering data from other assets  methods have been
explored to show technical indicators improve stock predictions  tsai et al   agrawal et al     in this work  we consider technical
indicators across assets for short term directional and price predictions 

   dataset and features
we obtained ten years of daily close data  source  bloomberg  spanning from october           october           the data pull
yielded        potential training examples after pre processing  null and erroneous data points were eliminated and technical
indicators which were populated for less than     of the data were removed as well  the assets considered were s p     stock
index  spx   eurjpy foreign exchange  euro to japanese currency conversion   copper future  hg    and the ten year united states
government bond future  tya   the s p     index is a barometer for global stock markets and one of the most liquid assets in the
world  eurjpy fx tends to track global risk sentiment and oftentimes tracks the broader appetite for carry trades  copper was
chosen to represent the commodity complex and provide both an uncorrelated  technically dominated asset as well as a tracker for
emerging market demand  ten year government bond futures represent the most liquid fixed income instrument across markets
and a general flight to quality  safe haven asset 
for each of the four assets  spx  eurjpy  hg   tya   we acquired daily data for twenty two technical indicators such as moving
average  momentum  hurst  etc  we also generated additional features from the raw price data including realized volatilities 
exponentially weighted moving averages  and various other trend and change variables  the feature vector contains data from all
four assets such as previous close price  volume  and technical indicators from previous day as well as the other generated features 

   methodology
we use regression techniques to predict the price and then measure the accuracy based on the directional change  essentially a
classification problem  considering previous day price as b  actual price as a and predicted price based on regression model as p 
following equation is used to classify a prediction 

fi                                           

   

while the above equation identifies the predicted directional accuracy  pda   the predicted price accuracy  ppa  is given below
 with          this is shown in the equation below for m predictions 



  

                                              


        
   



     
   

            
   
     

   

ppa is zero when there are no correct predictions        we measure the ppe for different delta spreads 
   models
we perform the predictions by performing these regression approaches   i  ordinary least squares  iii  support vector regression 
we compare the results with kim et al          and by implementing supervised univariate random walk algorithm 
    supervised univariate random walk
as the name suggests  this model is only based on the target variable  given a training set of data  a gaussian distributed is defined
with the mean and variance of the training data  for every price point  a random variable is drawn from the gaussian distribution
and it is added to the price point to make the prediction  if the horizon is k  then there are k random draws from the defined
gaussian distribution to calculate the future prediction  this is the base model to test efficiency of the other algorithms employed 
    ordinary least squares  ols  regression
to provide best short term investment guidance to the potential investor the short term market price must be predicted as
accurately as possible  since the target variable to be predicted is a positive real value  regression is an obvious tool  in the
regression technique  a parameter vector is fitted to linear   polynomial features such that the predicted value is a linear
combination of those features  a parameter vector is fitted to optimize the objective function of minimizing the square of the errors 

    support vector regression  svr  
financial data is essentially a time series data and support vector regression has been employed for stock market forecasting
 agrawal et al          hence  we perform the predictions using svr on the stock market dataset  support vector regression tries to
find the maximum margin hyperplane in the higher dimensional feature space  optimal margin is obtained by solving the following
convex optimization problem 

i above is the slack variable when the dataset is not linearly separable  we use sequential minimimal optimization  smo 
algorithm  platt  john et al        and s k shevade et al         using polynomial and radial basis function  rbf  kernels 

   experiments
experiments are performed on a dataset having      days of daily closing price  volume and technical indicator data for the four
assets  we performed the experiments for  i  long term price prediction to predict for next one  two years using linear regression

fiand svr to compare with kim et al    ii  short term price prediction to predict for multiple horizons i e   for next      and    days and
measure ppa     on the correct predictions  even though the focus of this project is short term price prediction  we performed longterm price prediction to start with to compare with kim et al   as a baseline 

figure   chart showing the closing price variation in the data
the chart above shows the closing price trend for s p     index  it is very apparent that the trend is not linear  however a portion of
the curve may be fitted to a piece wise linear regression  with this intuition  a regression model is fitted to the first degree of each
one of the features  the results for the horizon periods of      and    are in the order of        and    percent respectively on a
directional basis  however  the predicted price proximity in the being within the     spread is only       and    percent of the
results that are directionally correct  this suggests that there is a lot of room for improvement 
with more evidence for the intuition of non linearity being established with the results of the linear regression  features of higher
order are generated  quadratic and cubic features are programmatically generated and a feature selection criteria is established
based on f score and p value  feature selection technique from scikit learn is leveraged  

     short term price prediction 
this is the primary focus of this project  here we performed experiments with fixed window  rolling window considering features
from other assets as well as technical indicators 

      fixed window 
price prediction is performed for multiple horizons i e   for next      and    days  for fixed window we considered the first     of
training set and predicted results for next      and    days  predicted directional accuracy for next h days for this run  say r  is given
by 


       
  

         


   

we repeated the experiments with first      then first     and so on till     i e   for    runs  accuracy for h day horizon for n runs
is given by 


           
  

    


               

results
parameter c for svm
c  
c   
pda horizon
 
 
  
 
 
  
spx
                                   
spx eurjpy hg 
                                   
spx eurjpy hg  tya
                                   
table  fixed window predicted directional accuracy  pda  for smo svr with c   and c   

   

fiparameter c for svm
c  
c   
ppa       horizon
 
 
  
 
 
  
spx
    
                
    
    
spx eurjpy hg 
                      
           
spx eurjpy hg  tya
    
                             
table   fixed window predicted price accuracy  ppa  at     spread for smo svr with c   and c  
we performed experiments using ols regression  smo support vector regression considering various combinations of features   i 
s p     asset features alone  ii  features from other assets  the tables above show the results for svr using polynomial kernel for
c   and c    
for fixed window  we can see that adding features from additional assets has mixed performance considering data from all the
assets  spx eurjpy hg  tya  resulted in better performance compared to spx feature data alone both in terms of pda and ppa 

the following table shows the results for polynomial regression  quadratic features  along with a feature selection
mechanism  top    features based on f score  in place  the accuracy measures are based on      
horizon

 
avg  pda

 
avg  ppa

avg  pda

  
avg  ppa

avg  pda

spx
     
     
     
    
     
spx eurjpy hg  tya
     
     
     
     
     
spx eurjpy hg  tya
  technical indicators
     
    
     
    
     
table   fixed window predicted directional accuracy  pda  and predicted price accuracy  ppa 

avg  ppa
    
     
    

       rolling window 
for rolling window  instead of considering the first     of training data we consider recent x  of the data to see if the predictions
are time sensitive  for example  if x    then we considered training set as         in chronological order and predicted for next   
  and    day horizons  then  we repeat the experiments considering          then         and so on till         for a total of
   runs  prediction accuracies are similar to the methodology explained in section       

results 
assets horizon
x         year   
spx eurjpy hg  tya    
     
 all four assets 
   
     
   
     
spx eurjpy hg  tya    
     
  spx technical
   
     
indicators
   
     
table   rolling window predicted directional accuracy using svr
ppa       horizon

x         year 

 

 
     
     
     
     
     
     

  
     
     
     
     
     
     

 

  

spx eurjpy hg  tya    
     
     
 all four assets 
   
     
     
   
     
     
spx eurjpy hg  tya    
  
     
  spx technical
   
  
     
indicators
   
  
     
table   rolling window predicted price accuracy at     spread using svr

     
     
     
     
     
     

fithis shows that considering around recent        years  of training data results in better performance both in terms of directional
accuracy and price predictions  rolling window outperforms the fixed window approach in terms of prediction accuracy 
this indicates the data is time sensitive and depends on recent data for short term predictions  we performed ablative
analysis on different technical indicators and selected the indicators that yielded good performance  we observed exponential
moving average  bollinger bandwidth  bbw   relative strength index  rsi  has positive impact on both directional accuracy and price
predictions  hurst component and roc increased ppa  momentum  average directional index  adx  when applied on top of these
decreased the accuracy and ppa  for horizon    best results are obtained considering data from four assets and technical indicators
i e          accuracy and     ppa considering delta spread of    
for polynomial regression  the rolling window approach is slightly modified to consider the last    of the data to be used to fit the
model  based on experiments  this yielded a superior prediction power suggesting the time sensitivity of the features  if a larger
training set is considered  it is making the model noisy and hence the fit is suboptimal  while this provides a better fit it is a nonparametric approach as it requires to constantly pull the last    of the data to predict next price point  following are the results
observed 

horizon

 

 

  

avg  pda
     

avg  ppa
     

avg  pda
     

avg  ppa
     

avg  pda
     

avg  ppa
     

     

     

     

     

     

     

spx eurjpy hg  tya
     
     
     
     
     
table   rolling window predicted directional accuracy  pda  and predicted price accuracy  ppa 

     

spx
spx eurjpy hg  tya

   conclusion and future work
developing a successful asset price prediction algorithm is no small feat  ultimately  as simple as it may sound  an asset s price will
increase when there are more buyers than sellers and vice versa  machine learning techniques  however  can play a useful role in
trying to distill the vast number of impactful factors into a cohesive generative algorithm  we experimented with several models 
data sets  feature vectors  and time horizons to determine an optimal approach to short term price prediction from both a
classification and regression standpoint  our results indicate that short term price prediction with smo support vector regression
performs better than linear oriented models  all models seem to perform better with a shorter training window  to a certain point  
perhaps due to efficient markets and the expedient nature of information transmission  psychological biases and momentum
factors could also be a contributing factor for the outperformance of localized vs long term models  initially  we believed the
information from additional asset classes would likely boost performance of our primary technical indicator set  however  the
introduction of additional asset classes had mixed results depending on the model and time horizon  this is likely due to shifting
correlations  regime switches  and overall signal   noise deterioration 
going forward  we have several additional avenues which we would like to explore  towards the end of the project  we
experimented with some non linear models based off polynomial generated feature set with some encouraging results  the ability
to generate additional features from the data set could provide countless future paths  we also worked on an asymmetric cost
function which penalizes incorrect price direction more than accurate price direction prediction  absolute error squared vs absolute
error   optimizing this asymmetric cost function proved quite difficult  however  we believe the general concept could be quite
interesting with more resources  lastly  we chose four distinct assets in order to limit the scope of our project  going forward  we
could attempt to add more assets to our data set and then perform ablative analysis on the impact 

   bibliography
   kim  kyoung jae   financial time series forecasting using support vector machines   neurocomputing                     
   agrawal  j  g   v  s  chourasia  and a  k  mittra   state of the art in stock prediction techniques   international journal of
advanced research in electrical  electronics and instrumentation engineering                       
   cao  lijuan  and francis eh tay   financial forecasting using support vector machines   neural computing   applications     
                
   s k  shevade  s s  keerthi  c  bhattacharyya  k r k  murthy  improvements to the smo algorithm for svm regression  in  ieee
transactions on neural networks       
   tsai  c  f   and s  p  wang   stock price forecasting by hybrid machine learning techniques   proceedings of the international
multiconference of engineers and computer scientists  vol     no            
   platt  john   fast training of support vector machines using sequential minimal optimization   advances in kernel methods
support vector learning          

fi