what makes a good muffin 
ivan ivanov
cs    final project
introduction
today most cooking projects start off by consulting the internet for recipes  a quick search for
chocolate chip muffins returns a multitude of different recipes  and typically  we would look though
the top rated ones and try to decide which one looks best  we would go down the ingredients list 
make a few substitutions  depending on whats left in the fridge  and maybe scale down the recipe  since
we dont have a whole dinner party to feed but is it really ok to substitute sour cream for yogurt 
what if id like to use soy milk instead of whole milk  and how do you split three eggs in half 
this project developed a learning algorithm which can predict the success of a muffin recipe based on
the quantity of each ingredient used  the algorithm was trained on data from muffin recipes collected
from www allrecipes com  the input to the algorithm is a list of ingredients with their corresponding
amount and the output of the algorithm is a numerical score measuring recipe success  in order to make
a recommendation for a good muffin recipe  this algorithm can be used to optimize ingredient quantities
by maximizing the scoring function 
related work
predicting the success of an object  recipe  book  song  etc   based on its constituents  ingredients 
words  or sound frequency  can be a difficult problem and various approaches to it are found in the
literature  cortez et al  recently reported on predicting wine preferences based on the chemical
characteristics of the wine      in the analysis  the authors used multiple regression  neural network
methods and support vector machines  svm  as learning models and concluded that svm was the most
reliable predictor for that data set  in another study  teng et al  found that recipe ratings can be predicted
based on features derived from combinations of ingredient networks and nutrition information      they
also point to the fact that user reviews can be a good resource of information on possible ingredient
substitutions  or the appropriate range of quantity of some ingredients  a similar network analysis of
recipe ingredients was performed by ahn et al      in this study  the authors find that western cuisines
often use ingredients that share a flavor profile  while east asian cuisines do not  information on user
preferences can be valuable and has been exploited in various product recommendation algorithms      
dataset and features
data on     muffin recipes was collected from http   allrecipes com recipes     bread quickbread muffins   this is an example of the extracted features 
   name  chocolate chip muffins
   review count    
   url  http   allrecipes com recipe             made it count    
   recipe id      
   servings    
   rating          

fiinformation on each ingredient was processed in order to derive the following features 
   name  flour
   ingredient id      
   amount   

   unit  cup
   modifiers  all purpose

a total of     unique ingredients were present in the collected set of recipes  ingredient names were
stemmed using the porter stemming algorithm     in order to remove suffixes  e g  egg and eggs 
and facilitate downstream processing  based on this data  the amount per serving in ounces was
calculated for each ingredient  furthermore  similar ingredients were grouped in categories  for
example  all purpose flour and whole wheat flour  which have distinct ingredient ids  were
grouped under flour  this reduced the number of unique ingredients to      in order to prevent
overfitting of the learning model  only ingredients which appear in more than    recipes were
considered  thus the final size of the design matrix for this project is         
methods
the output variable of the learning algorithm is a recipe success score  calculated by multiplying the
average user rating by the confidence metric      which depends on the total number of user
reviews for the given recipe 
        
         exp     
where          thus the score of recipes with less than       reviews is decreased exponentially 
in order to predict the recipe success score based on the amount of ingredients used  linear regression 
logistic regression  and support vector machine classification were employed  least squares linear
regression derives the model parameters by minimizing the square error between the data and the model
prediction 
       


 
 
                    
 
  

an analytical solution of this problem exists in the form of the normal equations 
       
the goodness of fit of the regression models was judges using the error metric 
 

                                   


 



logistic regression derives the model parameters by maximizing the log likelihood of the data 
           exp     

fi

          log                      log            
  

no analytical solution to this optimization problem exists  and the model parameters are obtained using
algorithms such as gradient ascent or newtons method 
svm classification is achieved by find the optimal margin classifier 
             

      

      
  



 
 
min          
    
  

                                   
              
the optimization is typically accomplished by solving the lagrange dual problem  this algorithm also
allows for mapping the data into higher dimensional space using kernels  in this project  the gaussian
 

kernel was used         exp           
success of the classification algorithms was judged by the percent correctly classified examples  all
learning algorithms were implemented using the scikit learn library in python      models were trained
on randomly chosen     of the data and tested on the remaining     of the data 
results and discussion
as an initial attempt at predicting muffin recipes  only a subset of all recipes was considered  a search
for banana muffins returned    recipes  which contain    features  as defined above  classification was
performed on two classes  good
recipes and bad recipes  good recipes
are defined as recipes with score greater
than   
logistic regression predicted the
outcome of banana muffins with
moderate success  the model achieved
greater than     accurate classification 
as determined by hold out cross
validation  figure    
the logistic function  however  is not figure    example data on prediction of the success of banana
convex  and this will pose a difficulty in muffin recipes using logistic regression  the model achieves
greater than     accuracy 
the second stage of the project  which
aims to optimize the ingredients of a recipe by maximizing the scoring function  in order to facilitate the
optimization problem  a scoring function of lower complexity was considered 

fileast squares linear regression was used on this data set  score predictions were thresholded to the
interval of         this model provided a reasonable measure of the success of banana muffin recipes
 figure    

figure    prediction of the success of banana muffins using least squares linear regression  left  example data and
model prediction points  right  learning curve for this model

based on this model  it was determined that the top three ingredients which contribute most to the
success of a banana muffin are butter  bananas  and sugar  the bottom three ingredients  which
negatively scale with recipe success  are vanilla  salt  and cinnamon 
the linear regression model  however  did not performed well when trained on the entire data set  the
model suffered from problems of high bias and high variance  figure    left   this is partly explained in
a plot of the principal components of the data  figure    right   which does not show a clear trend 
constraining the l  norm of the parameters  lasso regression  did not improve the model further 

recipe score
figure    predicting the success of all muffin recipes using linear regression  left  the learning curve for this model
suggests that it suffers from high bias and high variance problems  right  pca analysis of the data does not show a
clear dependence of the recipe score on the first two principal components 

the success of any muffin recipe was also not well predicted by binary svm classification with a
gaussian kernel  table     the parameters  and  of the model were optimized using hold out cross
validation  the model  however  displayed a tendency of classifying bad recipes as good  i e  it has
low specificity  the model has accuracy of       which is only slightly higher than the null error rate 

fiequal to       svm classification of the data into six categories    star through   star recipes  also
performed poorly 
table    confusion table of binary svm classification on full data set
n      
actual 

bad
good

predicted 
bad
  
 

good
  
  

we speculate that the difficulty in predicting the success of muffins recipes may result from the way
user ratings are assigned  users may be biased towards providing a rating which conforms more to the
average rating of the recipe  rather than expressing their objective opinion on it  this is corroborated by
the fact that the average rating of recipes in the data set is relatively high at     stars  furthermore  users
often exhibit flocking behavior and would tend to try recipes that already have high rating and a large
number of reviews  in this way  there may be good recipes in the data set  which have not received a lot
of user reviews  and thus get a low score in this algorithm  this problem may be addressed by expanding
the data set  lastly  it is likely that the success of a muffin recipe is not only determined by the quantity
of the used ingredients  but may also be affected by other factors not considered in this project 
conclusions and future work
this project developed a learning algorithm which predicts the success of a muffin recipe based on the
quantity of ingredients used in the recipe  it was found that the model performs well on a subclass of the
data set  e g  banana muffins  chocolate chip muffins  etc    but does not generalize well to predictions
on the entire data set 
successful optimization of this algorithm will allow it to be used to identify universal relationships  such
as ratio of dry ingredients to wet ingredients which results in moist muffins  or amount of leavening
agents to flour which makes the muffins raise nicely  and also suggest the optimal recipe for a specific
subclass  e g  best blueberry muffins  best cranberry muffins  etc    the algorithm will also be able to
suggest scaling relationships  e g  to make    muffins  should i use   or   eggs  when the correct scaling
calls for     eggs   should i maybe use   eggs and increase the amount of butter a little   and adjust the
recipe based on desired substitutions  e g  should i decrease the amount of sugar  if i want to use vanilla
soy milk instead of    milk   
this project focused on making predictions for muffin recipes  but the software developed here can be
easily extended to making recommendations for other dishes  and in general  finding the optimal
combination of a set of features  with appropriate scaling  and the ability to include optional features  if
desired 

fireferences
   

   
   
   
   
   
   
   

p  cortez  a  cerdeira  f  almeida  t  matos  and j  reis   modeling wine preferences by data
mining from physicochemical properties   decision support systems  vol      pp               
     
c  y  teng  y  r  lin  and l  a  adamic   recipe recommendation using ingredient networks  
pp          
y  y  ahn  s  e  ahnert  j  p  bagrow  and a  l  barabsi   flavor network and the principles of
food pairing   scientific reports  vol     p             online      
j  freyne  s  berkovsky  and g  smith   rating bias and preference acquisition   acm
transactions on interactive intelligent systems  tiis   vol     p           
a  van den oord  s  dieleman  and b  schrauwen   deep content based music
recommendation   pp            
t  zhou  j  ren  m  medo  and y  c  zhang   bipartite network projection and personal
recommendation   physical review e  vol      p                      
m  f  porter   an algorithm for suffix strippingnull   program  vol      pp                     
     
f  pedregosa  g  varoquaux  a  gramfort  v  michel  b  thirion  o  grisel  et al    scikit learn 
machine learning in python   the journal of machine learning research  vol      pp                 

fi