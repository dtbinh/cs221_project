to what extent are color percepts and motor
choice represented in dorsal premotor cortex 
kiah hardcastle    and megan wang 


neurosciences program  stanford university

final project for cs      machine learning  june     

every day we convert sensory information into action through the
process of decision making  here  we investigate the neural correlates of decision making behavior in the dorsal premotor cortex
 pmd   in particular  we use machine learning techniques to ask
whether stimulus color or reach direction are represented in the pmd
of a macaque performing a checkerboard discrimination task  interestingly  we find that while stimulus color is not represented  motor
choice is robustly represented         ms prior to movement onset  to explore whether information regarding movement onset is
distributed across the population  implying that a decoder might
need information from many neurons to accurately decode motor
choice  we use forward feature selection to determine the minimum
number of neurons needed to accurately decode motor choice  by
comparing the minimal population required at different times prior
to movement onset  we investigate whether the neural representation changes during the trial  we find evidence that the neural
representation of motor choice evolves over the course of the trial 
understanding when these variables are represented in pmd  and
how they correlate to animal behavior  will help us gain valuable insight to the underlying mechanisms of sensory decision making and
motor output 
dorsal premotor cortex

 

neural decoding

 

motor choice

abbreviations  pmd  dorsal premotor cortex  svm  support vector machine  nb 
naive bayes

a

major goal in systems neuroscience is to understand how
the combined activity of various brain regions underly
the cognitive processes that result in behavior  to accomplish
this  we need to know what types of information are represented in the involved brain regions  and how they give rise
to behavior  one common process with observable behavioral
output that we engage in on a daily basis is the sensorimotor process  in this process  we receive information from the
external world as sensory input  perform some computation
on that sensory input  and convert it into a motor output 
here  we look at a sensorimotor decision making process  and
ask whether  when  and how information about an upcoming
decision is represented in pmd 
previous electrophysiology and lesion literature have
shown that pmd plays a crucial role in visually guided movements      early studies revealed that pmd densely projects to
the primary motor cortex  m    which then sends projections
to the spinal cord      suggesting that pmd is a preparatory
region while m  controls the final motor output      however  recent work has extended the canonical role of pmd and
has implicated pmd in the decision making process itself     
given that many movements are integrated with cognitive
contexts  and that pmd receives sensory and cognitive input
from parietal and prefrontal cortices  this may be somewhat
unsurprising  however  the extent to which the deliberation
about the decision  or the perceptual information needed to
make the decision  is present in pmd is currently unknown 
as previous studies actually conflated decision output  motor choice  with the perceptual information needed to make
the decision  in our case  stimulus color   here  we employ a
novel task design that temporally dissociates the perceptual
decision making process from the motor choice process  imhttp   cs    stanford edu 

portantly  this allows us to identify the degree to which pmd
participates in forming the motor choice output and stimulus color perception  further  we can use the data collected
from this task to analyze two other open questions regarding
motor choice information in pmd  how is motor choice information distributed across the population  and how stable are
the neural representations of motor choice during the task 
to investigate these questions  we first demonstrate that
simple averaging of neural activity fails to reveal motor choice
information in pmd  this necessitates the use of more complicated machine learning techniques  in this work  we employed
three distinct classifiers   kernelized svm  logistic regression 
and naive bayes  with either unprocessed or pca processed
inputs   to decode perceptual information  color  or motor
choice  left or right  form neural activity  we investigate how
early a decoder can accurately decode the upcoming motor
choice or color percept  while it is expected that motor choice
can be accurately decoded from pmd signals prior to movement onset      it is an open question as to whether color
percept is encoded in pmd  in particular  it is possible that
color percept is represented elsewhere and pmd only reads
out the motor signal  however  it is also possible that pmd 
already implicated in decision making processes  stores information relevant to a future motor action  lastly  we investigated the robustness and stability of the neural representation
of motor choice over time  in particular  we asked how many
neurons were needed to accurately decode the motor choice 
whether the most informative neurons changed over time  and
overall to what degree the neural representation changes with
time  critically  this could point to different computations
performed in pmd during the task 

methods
task design  one male rhesus macaque  monkey t  performed a checkerboard discrimination task  figure  a  

fig     a  schematic of the checkerboard discrimination task
design  b  location of pmd on a macaque brain      units
were recorded from this region 

the animal sat in a chair in front of a computer monitor  in each task trial  a static  centered red green checkerstanford

cs    

spring     

  

fiboard is shown for     ms  checkerboard epoch   one color is
over represented on the checkerboard  and the degree of overrepresentation  coherence  varies randomly from trial to trial 
following the checkerboard epoch  a blank screen is shown
for         ms  blank epoch   this screen is then followed
by the presentation of two targets  target epoch   one target is on the left and one is on the right  and the color of
the target  red or green  is randomly assigned  the animal
must choose the target associated with the over represented
color in the checkerboard  the animal receives a juice reward upon correct target selection  and can make the action
as soon as the targets appear  reaction times  rts  are defined as the time from target presentation to movement onset 
the over represented color  the degree of over representation
 coherence   and the color of the targets are all randomly selected trial to trial 
data collection and pre processing  monkey t was trained on
the task design described above  hand position was tracked
optically with a reflective bead attached to the monkeys hand 
and eye position was monitored optically  information about
the stimulus was saved for each trial  and neural data were
recorded from pmd  see figure  b  while he performed the
task  neural units were recorded from either a single electrode or from a linear array of electrodes  and we saved any
unit that was responsive during any part of the trial  units
were manually sorted online  and the spike times for each unit
were saved and smoothed with a boxcar filter to yield a firing
rate over time 
in our analyses  we want to correlate behavior to neural
activity  and we know that the reaction times  behavior  vary
greatly across stimulus difficulty  thus  it is possible that
the neural activity underlying the fastest and slowest reaction
times may be different  to address this  we divided reaction
times into   bins  fast and slow  and analyzed their neural
activity separately  we included units that had sufficient correct trial counts      left and     right reach trials to the correct target  for each reaction time bin  resulting in     units
total  although units were sometimes recorded during different sessions  the highly stereotyped animal behavior and trial
structure allowed us to combine data across sessions  note
that by combining units this way  they will not be dependent 
as is the case when neurons are simultaneously recorded 

results
visualizing neural activity during movement  to connect neural activity to task behavior  we first wanted to visualize the
neural activity during the task to gain an intuition for how
neural activity was evolving during behavior  here  we focus
on neural activity that occurs during the course of the motor
choice  reaching to the left or right target   as previous work
has shown that motor choice information is contained in pmd
     however  visualizing neural activity during reaching can
be somewhat difficult 
to illustrate this  figure  a shows example firing rates
for a left reach trial and a right reach trial  in both cases  the
data is aligned to movement onset  i e  the beginning of the
reach for the correct target   from simply looking at these
trajectories  it is not obvious that one trial is a left reach and
the other is a right reach 
to circumvent this problem and analyze population level
activity during movement  neuroscientists oftentimes plot
trial averaged smoothed firing rates  this tactic is often extended to population activity by averaging across units  figure  b   however  this method fails to distinguish left and
 

http   cs    stanford edu 

right reaches  as the averaged firing rates for both slow and
fast reaction times are essentially overlaid  thus  the common tactic of simple averaging is not enough to determine the
degree to which these units represent task information 
in order to reveal any potential differences in the
population level neural activity during movement without
plotting the firing rates for all neurons  we employ a slightly
more complex data analysis procedure and decompose neural
activity using principal components analysis  pca   specifically  given a matrix x    xslow r xf ast r xslow l xf ast l   
where xslow r is an n xt matrix of the average neural firing
rates across     slow rt  right reach trials for n neurons over
t time points  and xf ast r   xslow l   xf ast l defined similarly  
we find the set of vectors u  or principal components  that
maximize ut  xx t  u  by projecting the data onto the first  
principal components  we see that the population level neural
activity for left reaches diverges from the neural activity for
right reaches  demonstrating that motor choice is indeed encoded in this data  note that this divergence occurs similarly
for both slow and fast rts  indicating that the neural activity
evolves in the same way  but at different timescales  for fast
versus slow rts 

fig     a firing rates from    example units during a left and
right reach  data is aligned to movement onset  blue line   b 
average firing rate across all neurons during the reach  t    
refers to movement onset   dotted lines refer to right reaches 
c  pca performed on the neural activity  black circles correspond to      ms prior to movement onset  while the blue
circles correspond to movement onset 

decoding movement choice and color percept from neural activity  now that it is clear that the population level responses vary with motor choice  we first wanted to investigate
whether we could decode motor choice from neural activity and if so   how far in advance of the movement onset classification accuracy was above chance  to explore this  we first
divided the time within the trial into    time points spanning from      ms prior to movement onset to     ms after
movement onset  then  for each rt and each time point in
the trial  we create a     trial x     neuron matrix with an
associated     element vector indicating left right reaches for
each trial  we then used this data to train and test three
separate decoders  two discriminative  logistic regression and
kernelized svm using a radial basis function  and one generative   naive bayes  nb   for svm  we used parameters that
matched what we used in problem set    as this parameter set
seemed to do well for our data  in all cases  we performed
   fold cross validation  where we trained on     of the data 
tested on the remaining      and repeated this procedure for
all    sets of testing data  we used three decoders for several
reasons       to gather a deeper intuition on which classifiers
perform best on this particular dataset      to compare our
results with other published results  and     to draw robust
conclusions about our dataset 
hardcastle  wang

fifor all decoders  we were able to decode the choice long before the movement had actually started  figure     in the case
of slow rts  we were able to decode motor choice at least    
ms before movement onset  for fast rts  we could decode motor choice         ms before movement onset  this is consistent with trial averaged data that shows that longer rt trials
have greater sustained activity before movement  and thus
should have more information about choice before movement 
whereas shorter rt trials have less sustained activity before
movement      importantly  as rt reflects the animals own
internal deliberation process  this difference indicates that the
internal deliberation process is reflected in pmd dynamics 

fig     a  accuracy of three classifiers that aim to classify
the motor choice from neural activity prior to  during  and after movement onset  b  accuracy of three classifiers that aim
to classify the overrepresented color from neural activity prior
to  during  and after stimulus presentation  bold lines are the
mean  shaded area represents the standard error across the   
folds 

we noted that while classifier accuracy for short rts is
comparable across the trial for all three classifiers  it appears
that nb significantly out performs logistic regression and kernelized svm for long rts  as the neurons are conditionally
independent  as they were independently recorded   it is perhaps not surprising that nb slightly outperforms logistic regression  as discussed in class  if the assumptions underlying
generative models are true  they can outperform the discriminative models   however  we were slightly surprised that svm
performed so poorly compared to nb  upon further investigation  we found that the svm training accuracy was     
for all time points  indicating that this model is over fitting
prior to movement onset  we hypothesize then that the svm
is learning unimportant features of the data  it also has    
parameters  while the other models have      that give rise
to lower testing accuracy 
given that pmd encodes the output of the decision making process  motor choice   does it also encode the variables
that lead to the decision output  to answer this question  we
turned to the checkerboard epoch to search for color related
signals  while it is possible that color related signals are also
present during the target presentation  we wanted to specifically investigate whether percepts that influence the decisionhardcastle  wang

making process are encoded in pmd  for our initial analysis  we only considered trials during which highest coherence
stimuli were presented  we reason that if a color signal is
present in this brain area  it should be most robust when a
strong stimulus is presented  we aligned the data to stimulus onset  and divided the time within the trial into    time
points spanning from      ms prior to stimulus onset to    
ms after stimulus onset  we then used our three classifiers to
decode dominant checkerboard color  interestingly  we found
that the decoders could not classify red or green checkerboard
trials above chance  suggesting that this color related signal
is not present in pmd during stimulus presentation 
taken together  our decoding analyses suggest that while
pmd activity reflects the internal deliberation process immediately prior to movement onset  pmd activity does not reflect
the stimulus percept needed to make the decision leading to
motor output 
decoding movement choice prior to movement onset using
pca  as discussed in class  one common method of preprocessing a dataset before running a supervised learning algorithm is to apply pca to the dataset  this type of preprocessing can carry computational benefits  since the algorithms
have fewer features to train on   which can be critical for realtime decoding for brain machine interfaces  further  as applying pca can reduce over fitting  we investigated whether
preprocessing the data by applying pca could increase our
classification accuracy 
to apply pca to our dataset  we create a     trials x
    neurons matrix for each set of training data at each time
point for each rt  for each matrix of training data  we then
find the set of k orthogonal vectors u            uk   that maximize
ut  xx t  u  where x is the     x     matrix  we choose
k               to explore the dependence of classification accuracy on the number of pcs  after finding the pcs  we then
project the training data into this space through x   u t x 
where u    u        uk    we also project the testing data onto
the same principal components  where xtest   u t xtest  
prior to analyzing classification accuracy  we exploited the
low dimensionality of the projected data to visualize the evolution of neural dynamics over the trial  we projected the
matrix of training data created     ms or     ms before the
movement  during the time of movement onset  and     ms
after movement onset  onto its first two components  figure
    we color each point according to the reach direction  we
can clearly observe the divergence of neural activity based on
reach direction as the movement onset approaches  further 
we only observe the emergence of two clusters   for left and
right reach   and not four clusters   for left green  left red 
right green  right red   indicating that color information is
not strongly encoded in pmd during target selection 
we then investigated classification accuracy of the kernelized svm and logistic regression decoders when they have
pca projected inputs  we did not investigate the classification accuracy of the nb decoder  as the inputs now span a
wide range of values and no longer directly map onto the classic nb framework  we found that while decoding accuracy
did not change for the logistic regression decoder  decoding
accuracy increased for the kernelized svm decoder  figure
    decoding accuracy was similar when inputs were projected onto the first        or     pcs  we hypothesize that
pre processing the inputs with pca re formats the data in
such a way that over fitting is decreased for kernelized svm 
as the svm is kernelized with a radial basis function that
essentially computes the distance between vectors  it seems
that orthogonalizing the inputs allows the svm to learn more
relevant features for the data 
stanford

cs    

spring     

 

fiall neurons to accurately predict reach direction  finally  it
is possible that all neurons strongly encode motor choice  and
thus a decoder only needs a few neurons  which can be randomly selected  to accurately predict reach direction  to explore which of these possibilities is correct  we used forward
feature selection to determine the minimum number of units
needed to approach the classification accuracy achieved from
a classifier using all neurons  further  we investigated the
minimum number of neurons needed at     ms prior to movement onset  and the minimum number of neurons needed at
movement onset  this will allow us to simultaneously compare whether the most important neurons change over the
course of the trial 
fig     projection of neural data onto the first two components  pc  and pc   for different time points across the trial
for the first data fold  each point corresponds to a single
trial  the color of the point corresponds to the reach direction  note that the color labels switch because the sign is
non identifiable 

fig     the histograms show the decoding accuracy of logistic regression classifiers that use single neuron activity     
classifiers in total   the plots on the right show the decoding
accuracy of a decoding using   neuron    neurons    neurons 
etc  the numbers correspond to how the neurons are labeled
in the data  labeled in chronological order   the dotted line
gives the mean decoding accuracy when using full population
data 

fig     classifier accuracy for kernelized svm and logistic
regression with inputs projected onto the first        or    
principal components for a  short reaction times and b  slow
reaction times  pale colors correspond to decoders that use
pca processed inputs 

finally  because decoding accuracy with only   pcs does
just as well  or better  than decoders with un processed inputs  this result has implications for brain machine interfaces
 bmi   with bmi  hundreds of neurons are recorded simultaneously and decoding algorithms need to run as quickly as
possible  pre processing the initial inputs with pca could
potentially alleviate some computational time while also improving decoder accuracy 

forward feature selection reveals that motor choice can be
decoded with very few neurons  we next investigated how distributed  and how robustly  motor choice information is encoded across the neural population  for example  it is possible that only a few neurons strongly encode motor choice  and
thus a decoder using only these neurons can accurately predict reach direction  on the other hand  it is possible that all
neurons weakly encode motor choice and thus a decoder needs
 

http   cs    stanford edu 

figure   shows the decoding accuracy of     logistic regression classifiers that use a single neurons activity to decode
 histograms on the left   we note that the single neuron decoding accuracy is overall higher when decoding at the time
of movement onset  bottom left   in addition  we note that
there are only a few neurons in each case with very high decoding accuracy  suggesting that motor choice information is
strongly represented in a small subpopulation of pmd neurons  consistent with this observation  it is clear that only a
few neurons       are needed to achieve the same accuracy as
the whole population  in fact  decoding accuracy with only
  neurons at     ms surpasses full population decoding accuracy at     ms  indicating that the decoder that uses the
entire population exhibits overfitting  this is impressive  although not too surprising  neurons in motor cortex have been
shown to be highly heterogeneous in their responses  changing as a function of time  space  velocity  context  and other
factors  it is thus unsurprising that there would be a small 
but strong  subset of units that happens to code for the task
dimension we are interested in  and perhaps the other units
are highly selective for other task dimensions 
we then compared the ten most informative neurons
 ranked according to the forward feature selection algorithm 
when decoding     ms before movement onset and when decoding at movement onset  comparing the x axis of the right
side of figure     interestingly  we observe that the ten
most informative neurons in each case are completely nonhardcastle  wang

fioverlapping  this indicates that the neural representation is
actually changing over the course of the trial       ms prior to
movement onset  one small subpopulation of neurons predicts
future motor choice  while at the time of motor choice  a separate small subpopulation of neurons encodes the information
relating to the movement 
investigating the stability of the neural representation of motor choice during the task  the results from the previous section suggest that different populations contribute to encoding
motor choice at different times in the trial  we wondered
if the contributions from these units were stable during the
time leading up to the movement  so we investigated the testing accuracy of a decoder that was trained on neural activity
from movement onset  termed movement onset decoder  in
grey   applied to neural activity at times throughout the trial
 figure    

fig     observing how well decoders from specific times perform across other times in the trial  grey  movement onset
decoder  red  pre movement movement decoder  dark purple green  optimal decoder  from figure  a   top row  results for short rt  bottom row  results for long rt 

one hypothesis is that if neural representations are stable
and robust  then the performance of this decoder would do
just as well as the decoders we previously identified  when we
had a separate decoder for each time point  termed optimal
decoder  identical to the decoder from figure  a   we found
that the accuracy of the movement onset decoder closely
matched the accuracy of the optimal decoder around the time
of movement onset  within about     ms of movement onset  
but at time points farther from movement  the movement onset decoder performed worse than the optimal decoder 
we next investigated the testing accuracy of a decoder
trained on neural data     ms prior to movement onset
 termed pre movement decoder  in red  when it was applied
   chandrasekaran  c   piexoto  d   newome  w t     shenoy  k v  trial by trial covariation between pmd responses and action choice during a reaction time discrimination
task  society for neuroscience       
   hoshi  e          cortico basal ganglia networks subserving goal directed behavior
mediated by conditional visuo goal association  frontiers in neural circuits        
     

hardcastle  wang

to neural activity throughout the trials  similarly  it performed well around the time that the decoder determined 
but performance around other times  such as movement onset  was poorer compared to the optimal decoder  thus 
a decoder at a given time point  movement onset decoder
or pre movement decoder  does not generalize to other time
points  these findings are consistent with our results from
forward feature selection  and demonstrate that the representation of motor choice in these units changes dynamically over
time 

summary
in this project  we aimed to characterize the neural activity of
this subpopulation to gain insight into the role of dorsal premotor cortex during a decision making reaching task  what
types of information does this bran area encode  when does it
encode that information  and how stable is this encoding  we
found that at the time of movement onset and up to     ms
following movement onset  the right and left reaches were easily and well decoded with any of the three classifiers we used 
we also wanted to know how long before the hand movement
began could we decode the motor choice  we found that for
short reaction times  we could decode motor choice     ms
before movement onset  whereas for long reaction times  the
accuracy at     ms before movement onset was still above
chance        the naive bayes classifier yielded the best results on long reaction times  on the other hand  when we
looked at the stimulus epoch  we could not decode the color
of the stimulus  thus  under this perceptual decision making
task paradigm  motor choices are represented in dorsal premotor cortex but perceptual color information is not  this
study extends our basic scientific knowledge of how brain regions may integrate and represent complex variables such as
perceptual decisions and action selection 
we then took a closer look at how motor choices are encoded  given that data projected onto merely   pcs could
yield high prediction accuracy  we wondered if there might
be a small subpopulation of units that are contributing the
bulk of the prediction accuracy  our results from forward
feature selection reveal that only     units were necessary to
achieve performance that was comparable to that of the population  this  combined with the knowledge that   pcs are
enough to decode from  suggests that the intrinsic complexity
to complete this task is quite low dimensional  in our case  it is
low dimensional because there are few neurons       we also
found that the best performing subpopulations are different
for pre movement and movement onset times  indicating that
the neural representation of motor choice evolves during the
course of the task  future work involving other task contexts
and increasingly complex movements could continue to tease
apart which specific aspects of motor choice are represented
by pmd neurons 
acknowledgments  this experiment was conducted in prof  krishna
shenoys lab  and data was collected by megan wang  we thank dr  chandramouli
chandrasekaran for thoughtful discussions  and we thank prof  john duchi and the
tas for their machine learning advice 

   dum rp  strick pl          motor areas in the frontal lobe of the primate  physiol
behav            
   chouinard pa  paus t          the primary motor and premotor areas of the human
cerebral cortex  neuroscientist            
   gao p  ganguli s          on simplicity and complexity in the brave new world of
large scale neuroscience  curr opin neurobiol            

stanford

cs    

spring     

 

fi