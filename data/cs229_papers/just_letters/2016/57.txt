predicting life expectancy of acute myeloid leukemia  aml 
patients based on gene expression of cancer cells
max drach

abstract doctors must often decide whether to offer
a cancer patient a risky treatment or let the patient continue to live with cancer  trialing a variety of dimensionreduction techniques  we determine one that best clusters
cancer patients based on survival data  then we predict
the life expectancy of a cancer patient using a kaplanmeier estimator on reduced dimension data  pca was
the most effective dimension reducing algorithm based
on our data visualization metric  and was used to show
that reduced data can be used to predict the survival rate
of cancer patients 

i  introduction
a  weighing the risks of cancer treatment
acute myeloid leukemia  aml  kills over       
people in the united states each year      however 
many of these deaths are not due to the cancer itself  but
to complications that occur during treatment  cancer
treatments themselves often pose significant risks  for
example  bone marrow transplants  which are common
last resort treatment options for aml patients  have a
survival rate of less than          thus  doctors are
often faced with the difficult decision to either give a
patient a risky  painful treatment  or to let the patient
survive as long as possible without the treatment 
no two cases of aml are alike  and specifics of
a patients particular instance of cancer can indicate
how long the patient will survive  in particular  cancer cell gene expression frequencies indicate specific
characteristics within a cell  gene expression frequency
data  coupled with patient survival data  can estimate a
particular cancer patients odds of survival 
b  project goals
this project had two primary objectives  our first
objective was to determine a reliable way to reduce our
high dimensional data set while preserving meaningful
structure  genes often interact in complex ways  many
genes solely exist to regulate the frequencies of others 
to determine the diemnsion reduction algorithm that
created the best low dimension visualization of our

data  we applied a variety of both linear and nonlinear dimension reducing algorithms to find one that
best grouped patients based on chance of survival  best
maintaining the variances within the data relevant to
survival diagnosis 
our second objective was to predict a patients
chance of survival based on the patients gene frequency data  while it is difficult to appropriately divide
high dimensional data into groups based on survival
probabilities  we used our reduced dimension data that
best captured relevant cell variances to achieve high
prediction accuracy  these predictions would provide
a practical use to our dimension reduction analysis 
demonstrating a technique that could aid patients with
a wide range of diseases beyond aml 
ii  data
a  procurement
dna microarray technology is increasingly used
to produce gene expression frequency profiles of patients  these microarrays contain hundreds of short
dna segments attached to small regions upon a slide 
to determine gene frequencies from a sample  large
quantities of dna or rna from the sample cell are
tagged with fluorescent molecules  then injected onto
the slide  dna or rna sequences that match those
attached to the slide bind to these molecules  and those
that do not are washed off  when exposed to the correct
wavelength of light  the molecules bound to the slide
glow  the intensity of the hue of a particular region of
the slide indicates the relative frequency of the gene
in the original sample  figure   from     shows this
process 
b  gene frequency data structure
our gene expression frequency data came from a
collection established by researchers from the stanford
center for cancer systems biology  the data is available at precog stanford edu 
our visualization data  selected from the precog
collection  was originally procured in      by the aml

fiiii  d imension  r educing m ethods
we reduced our data with    selected features using
a variety of linear and nonlinear methods 
a  pca
pca is frequent first choice for dimension reduction 
however  it requires that data be linearly correlated 
although a linear algorithm like pca may not be
able to capture non linear relationships between data
dimensions  we apply pca as a first step 

fig    

dna microarray

cooperative group      data was collected from cancer
cells of     patients with aml and contained expression frequencies for        genes  our gene expression
data was in the form of a matrix containing positive
numbers indicating the frequency of a particular gene
 row m  column n corresponded to gene m  patient
n  we had a separate matrix containing survival data
for each patient  this matrix contained a row containing
an arbitrary number between   and     which indicated
the time that the patients status was checked  and a  
or   indicating whether the patient was dead or alive 
respectively     

c  feature selection
the types of genes in our frequency data set varied
widely  genes ranged from cell membrane protein sequences to chromosomal reading frames  because these
genes were from a random sampling  only a few genes
from this random selection were likely to actually be
responsible for decreased life expectancy of a patient 
to determine which genes were most relevant to predicting patient survival rates  we used a cox regression
model to relate change in gene frequency to the length
of time before the individual either passed away or was
verified to be alive  we then sorted the genes with the
greatest absolute z score  which specifies how strongly
the change in a particular gene correlates to a change in
patient life expectancy      we used the    genes with
the greatest absolute z score values as the dimensions
of each individual 
we also reduced the data to have   mean and
variance of   for our dimension reduction algorithms
that required normalized data 

b  lle
locally linear embedding is a clustering algorithm 
it takes into account the relationships of data in multiple dimensions  preserving relative distances between
these points in the lower dimensional space  since
multiple gene frequencies of those that we selected
may correspond with increased probability of death 
a clustering algorithm may be appropriate to ensure
that reduced data maintains the relative distances of
influential dimensions 
c  t sne
similar to lle  t sne relies on the proximity of
data points in the high dimensional space  however 
it models distances with a probability distribution that
tends to emphasize local clusters  again  because dimensions of our data could be related be related  t sne
is a reasonable choice 
d  diffusion maps
diffusion maps is an algorithm group points based
on their connectivity  the probability of moving from
one point to another during a random walk  diffusion
maps have been used for a wide variety of applications 
from speaker identification to image compression     
this algorithm has the potential to to capture structure
in the data that other algorithms cannot 
e  determining visualization quality
to determine effectiveness of our dimensionreducing algorithms  we again used cox regression to
relate each of the reduced dimensions to the survival
time of each patient  since our data gives the alive dead
status of each patient after an arbitrary time period 
and this period differs for each patient  so we cannot
simply gauge algorithm effectiveness by seeing if our
algorithm correctly classifies patients as alive or dead 
thus  we use the resulting absolute value of the
cox z value on each dimension as a confidence metric
for how well our algorithm preserved desired structure
related to patient life expectancy in our data 

fiiv  v isualization r esults

fig    
fig    

diffusion maps  z index of x axis      

pca  z index of x axis     

      since this linear algorithm performed so well 
capturing nonlinear interactions between the different
gene dimensions does not appear to be important in
order to model the genes impact on survival  however 
the way that we chose our features may also have
favored pca  we chose features that we were most
confident had an impact on the lifespans of our patients
 this may have favored data with high variance  which
is often preserved well with a linear algorithm such as
pca 
b  lle
fig    

lle  z index of x axis      

locally linear embedding performed pretty well
with an absolute z index of       but not nearly as
well as pca  since lle is a clustering algorithm 
its lower performance suggests that the proximity of
points across multiple dimensions does not correlate
that strongly with change in life expectancy 
c  t sne

fig    

t sne  z index of x axis     

the black circles represent patients verified dead
between     years and the blue triangles correspond to
patients found to be alive after   years  the vertical and
horizontal lines mark the median points of the data for
either dimension  only the horizontal dimension cox
z indexes are displayed 
a  pca
of these three methods  pca performed the best
out of all of these algorithms with a z index value of

t sne did not perform well  with a z index of
      this also suggests that relationships between data
dimensions is not that important for predicting life
expectancy  maintaining local groups from the highdimensional space does not translate to groups with
similar survival rates in a low dimensional space 
d  diffusion maps
diffusion maps acquired the high z index of      
but did not represent the data in a visually useful
way  diffusion maps was strongly affected by points
that were particularly far from the mean of the data 
spreading these few points across the graph while
clustering others too close together to provide useful
intuition  diffusion maps does appear to divide the data
appropriately  but is too sensitive to outliers to usefully
represent this kind of genetic frequency data 

fiv  g ene  p rediction m ethods
gene expression data mapped to a low dimensional
space can help us predict how long a patient will live 
from our whole data set  we can build a kaplan meier
plot to determine how long a patient with aml is
expected to live  then  by grouping data based on lowdimension location  we can provide estimates for how
long a patient will live  after training a parametric
algorithm like pca on one data set  we can use our
learned pca parameters to map a patient into a portion
of a low dimensional space correlated with a specific
specific survival curve 
a  determining accurate survival probability
the kaplan meier survival estimator creates a survival curve based on survival data in which the status of
any given individual is only known at an arbitrary time
after a certain period  the function takes the following
form     
s t   

y ni  di
ti  t

fig    

pca train data  divided by x  dimension median

ni

at any time t  the probability that any individual is
still alive is given by the the difference of the number
of alive and the number dead  ni  di   divided by the
number alive  ni    multiplied at all intervals from    t 
for our full set of training data  our kaplan meier
plot is given by figure    at    months  only     of
patients are expected to still be alive  making a bone
marrow transplant appear to be worth the potential    
risk 

b  data sets
we used the same set from the visualization portion
of this paper for our training set      our test data set
came from a study that procured data from microarrays
in santa clara  california  which was also studying
gene expression of aml patients     
c  dividing data and predicting
to predict the survival rate of a patient  we first
reduced the dimensions of our training data with pca 
we split data along the dimension corresponding to the
largest cox z index  using the median of these points
projected on the x axis  we can then create a separate
kaplan meier plot for each of these two groups of our
training data to see how well we separated the data as
in figure   
now can use using the pca parameters basd on
our training set to reduce data from our test set 
once reduced  we divide our test set along the same
dimension using the same median values from our
training set  we map the points in each of these sets to
the appropriate curve that we created using our training
data 
vi  g ene  p rediction r esults

fig    

kaplan meier  all training data

as is clear in figure    dividing the training data
across the median of the reduced dimension divides the

fiour cancer patients into very distinct groups      of the
patients in the upper group are alive after    months  a
significant increase from the     in our original graph 
figure    in the bottom group      of patients are
alive after    months  this gene expression data divides
cancer patients into groups with drastically different
survival ratings  highly useful information for doctors
deciding whether to recommend a risky treatment 
to determine the accuracy of our prediction  we
compared the high low patient divide determined by our
training pca parameters median divider to the high low
divide from when we reduced our test set with a pca
and median determined from the test data itself  the
groupings of patients were fairly consistent  with only
   of patients grouped differently in the training data
set than in the test data set 
to determine whether the two kaplan meier curves
determined by our training accurately mirrored those
of our test data set  we plotted the test groups own
kaplan meier curves produced by our training data set 
unfortunately  the curves were quite different  as can
be seen by comparing figure   with figure    this is
likely due to differences in the time and location of the
two studies from which we procured our data 

fig     pca test data mapped using own pca parameters 
divided by x  dimension median

vii  c onclusion
dimension reduction techniques can help researchers
make sense of high dimensional gene expression frequency data  pca  although a linear algorithm  is
highly effective at preserving features in genetic data
related to chance of survival  data partitioning on
reduced gene expression data  with additional research 
may accurately predict the survival rate of cancer
patients and can help doctors make difficult treatment
decisions 
viii  acknowledgments
we would like to thank andrew gentles  stanford
university  for his support and for providing the data
for this project 
r eferences
    leukemia  acute myeloid  american cancer society   
jun       
    bunim  juliana  survival rates for pediatric bone marrow
transplants one of the top in nation  university of san
francisco     jan          jun       
    metzeler  k h  et al  an    probe set gene expression signature predicts survival in cytogenetically normal acute myeloid
leukemia         us national library of medicine  pubmed 
web  jun        
    wouters  bj  et al  double cebpa mutations  but not single cebpa mutations  define a subgroup of acute myeloid
leukemia with a distinctive gene expression profile that is
uniquely associated with a favorable outcome  us national
library of medicine        pubmed  web  jun        
    outline of detection method of genes by dna microarrays 
toray  jun         
    cox  john and fischer black  valuing corporate securities 
some effects of bond indenture provisions  the journal of
finance               web  jun         
    kaplan  e l  and paul meier  nonparametric estimation from
incompelte observations  journal of the american statistical
association                 web  jun         
    gentles  andrew j  et al  the prognostic landscape of genes
and infiltrating immune cells across human cancers  nature
medicine                      web  jun        
    de la porte  j  et al  an introduction to diffusion maps 
university of stellenbosch  south africa          web  jun  
     

fi