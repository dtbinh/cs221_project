using spatio temporal data to create a shot
probability model
eli shayer  ankit goyal  younes bensouda mourri
june        

 

introduction

basketball is an invasion sport  which means that players move freely during
every second of the game  in order for us to evaluate a player  it is highly
beneficial to consider the movements of all the players on the basketball court 
a more complete understanding of a players performance can be achieved by
taking into account the spatio temporal considerations of movement and player
interactions 
with basketball a lucrative and competitive sport in the us  teams have incentives to accurately project player quality  the nba competition has become
so fierce that minor details about players could have a dramatic impact on game
results  for example  taking shots under pressure  from different angles  and at
different times of the game are very hard to accurately assess qualitatively  using statistical methods to assess these shots would help us identify the quality
of players and would provide us with the ideal situations of taking shots  to
do so  one would need to analyze every player at different points in time  and
luckily we could do so by using the spatio temporal data acquired by special
techniques recently developed 
we sought to create a probability shot model in a basketball game  we
started by getting a single nba data set which breaks down every second into   
moments in which every moment consists of the players and the balls locations 
based on this data  we created criteria such as the distance between the player
with the ball and the closest defender  the balls velocity  acceleration  maximal
height  along with many others features to determine whether a shot was taken
or not  once we knew whether a shot was taken or not  we trained our model on
    of the shots attempted in     basketball games and created a probability
shot model that we tested on the remaining     of attempted shots  to focus
on our analysis  we only considered jump shots  and excluded other shots such
as alley oops and lay ups 

 

related work

a few papers have been published on this field mainly dealing with analyzing
specific players or the team as a whole  a common technique called network
analyses turns teammates into nodes and passes into paths  or archs  thus creating a flow chart  using these flow charts one could analyze the most frequent
 

fipaths that the ball went through  based on this model one could mathematically justify why the triangle offense works and why the winning team tends
to have more entropy  topological depth  entropy  price of anarchy  and power
law distributions are assigned to each player to assess outcome classification 
other techniques used are known as intensity matrices and maps which transform the playing area into polar space and induce subdivisions in the space 
this common technique uses matrix factorization on the intensity matrices to
produce a compact low rank representation  it thus models shooting behaviors
with the insight that similar types of players shoot from similar locations and
then maps each type to an area within the court  other papers were written on
tactical group movement and how they affect the play  special techniques were
used to identify formations such as clustering coefficients and different forms of
centrality 

 

data and processing

the data were obtained from public github account that had scraped the publicly available sportvu player tracking data in basketball  this data contains
the xy coordinate of the    players    for each team  that are on the court  as
well as the xyz coordinates of the ball    times per second  we transformed
this raw data into a csv file with each row containing the location of the ball 
and the location and identities of the    players on the court 
we then worked on processing this data into our response variable  the shots
that were taken and whether they were successful  in order to identify when a
shot was taken  we relied on the physics of the balls flight through the air  we
computed the position  velocity  and acceleration of the ball  we identified shots
as moments in which the ball traveled through the air with no x acceleration
or y accerleration  and z acceleration only due to gravity  with the balls flight
ending at the rim 
to determine whether a shot was successful or not  we check whether  in the
fifth of a second immediately following the ball being in the area of the rim  the
ball passes through the area immediately below the basketball hoop  if so  we
mark the shot as a make 
through manual checking of this procedure against the actual play by play of
several games  we know that the process successfully captures a large majority
of shots  and successfully classifies a large majority of the shots  there are
nonetheless some errors  however  with about     error in each of the steps 
this is because we attempt to identify shots on the basis of a definition approach 
it would perhaps be more effective to manually label a certain number of games 
and extrapolate from these labels with a machine learning approach 
over the     games for which we had data  this approach identified       
shots  of which       were classified as successful 
next  we extracted a feature set from the data  these features are the
distance of the shooter to the hoop  the angle of the shot  whether the shooter
played for the home or away team  the distance to the nearest defender  the
length of time the shooter had the ball  and whether the shooter had dribbled
since receiving the ball 

 

fi 

technical approach

model selection  we randomly selected    percent of the shots to train logistic regression and svm  we then tested the models on the remaining    percent 
when we implemented support vector machine  we got    percent accuracy  on
the other hand  when we used logistic regression  we got    percent accuracy 
finally we used boosting and got    percent accuracy  to implement boosting  we evaluated  using resampling  the effect of model tuning parameters on
performance  we then chose the optimal model across these parameters and
then estimated the model performance  we used repeated training test splits
     with a    percent partition on the data  this algorithm predicted whether
the shot would be successful with    percent accuracy 

 

current results and analysis

after training our data on logistic regression we found that logistic regression
performed at a mediocre rate  here are the classification results 

predicted made
predicted missed

shot made
     
     

shot missed
     
     

the following table gives the coefficients and p values associated with each
of the features included in the model 
variable
distance
home
defender distance
time with ball
dribbled
angle   to   
angle    to   
angle    to   
angle    to   
angle    to   

coefficient
     
     
     
     
     
     
     
     
     
     

p value
     
     
     
     
     
     
     
     
     
     

the following figure gives the distribution of projected shot probabilities on
our test set 

 

fi   
 

   

   

count

   

   

distribution of test set shot probability

    

    

    

    

    

shot probability

the following figure indicates the relative influence of our various features
on the boosting algorithm 

 

conclusion

from the results we conclude that adaptive boosting works best with such a
data set  since knowing the location of the player  his nearest defender  angle to
 

fithe basket  along with the many other features only provides us with a slightly
better guess than random  it makes total sense why boosting might out perform
logistic regression and svm  from boostings relative influence  or weights
assigned per feature  we could see that the major components to predicting a
shot are the angle to the basket  closest distance to the defender  and the balls
distance to the basket  determining whether the player dribbled before or not
was not of much importance 

 

where to go from here

this project could be improved and extended in several ways  first  it would
be highly beneficial to apply machine learning to the identification of shots and
the classification of their success  this would require labeling a certain number
of shots  and then using those labels to identify other shots 
we could also improve our model by adding additional features  these other
features include defender angle  as well as defender distance and angle for the
second nearest defender  a new feature that we think would be valuable is the
velocity  speed and angle  of the shooter at the moment at which they take
their shot  these are features that we learned are used by second spectrum  a
sports analytics company focused on analysis of sportvu data 
another area of expansion is into other elements of the game of basketball 
such as rebounding and passing  predicting the outcome of increasingly many
elements of the game of basketball would build into a more comprehensive model
of the game  that could be used to thoroughly evaluate basketball performance 
finally  this type of analysis can be applied to more sports  the nfl has
tracking chips in players shoulder pads  many european soccer leagues have
optical player tracking  the nhl has experimented with player and puck tracking technology  the methods used in analyzing basket ball player tracking data
could also be applied to other sports to more thoroughly understand player
performance 

 

references

   tavish srivastava  analytics vidhya            business analytics r http 
  www analyticsvidhya com blog         complete guide boosting methods 
   stephen p  borgatti  centrality and network flow  social networks             
jan       issn           doi          j socnet              
url http   www sciencedirect com science article pii  s                 
   andrew borrie  gudberg k jonsson  and magnus s magnusson  temporal pattern analysis and its applicability in sport  an explanation and exemplar data  journal of sports sciences                      issn           
doi                              url http   www ncbi nlm nih gov  pubmed          

 

fi