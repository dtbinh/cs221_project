online active trajectory classification for motion based communication of
robots
haruki nishimura
hnishimura stanford edu
june        

 

introduction

designing cooperative multi robot systems has gained much attention of researchers in the robotics community  such multi robot
systems need a communication scheme to appropriately share the information among the team  while wireless electric communication is commonly used  it is not robust to adversarial jamming  one emerging alternative is motion based communication 
the idea that a message from the sender is encoded into its own trajectory and the receiver decodes the message by observing it 
some previous work        employed control theoretic approach to design a set of distinguishable and energy optimal trajectories 
however  it is also possible to think of a counter problem from the receivers perspective  given a codebook of trajectories and
the observations of the sender  how can we tune the receiver so that it can correctly distinguish the trajectories and decode the
messages 
this problem is highly non trivial especially when the receivers observation model is monocular vision without depth perception because the relative attitude between two robots cannot be directly estimated from one observation  although recent work
             has explored the emerging field of motion based communication  the use of monocular vision has yet to be addressed
to the best of authors knowledge 
thus  the present paper addresses a trajectory classification problem for motion based communication between two robots
using monocular vision only  the main controbutions of this study are two fold  first  we formulate the online classification
problem in which both of the senders message encoded in its trajectory and the receivers relative position to it are sequentially estimated as the receiver moves around the sender  we provide a recursive bayesian estimation algorithm to handle the
multimodal distribution over the joint belief state  gaussian approximation to the belief and model linearization lead to a
multi hypothesis extended kalman filter approach  similar algorithms to ours can be found in            second  we employ
an entropy minimization method to actively control the receivers camera pose so that it can optimally move to minimize the
expected uncertainty about the message over a one step horizon  this type of information theoretic control for monocular vision
is also studied in            
the rest of the paper is organized as follows  in the next section we formally state the problem and define the robot models  in
section   we derive the recursive bayesian update formula and provide the multi hypothesis extended kalman filter algorithm 
we also formulate the active control policy of the receiver in section    simulation results are presented for   class classification
in section   with a comparison of the random and the active control policies  conclusion with future direction is discussed in
section   

 

preliminaries

the sender encodes a message into its pre specified trajectory  the correnspondence between the true trajectory and the message
is known a priori as the trajectory codebook to both of the sender and the receiver  if the sender intends to send the message
z   i              n    the corresponding trajectory i is chosen from the trajectory codebook z                n   and performed 
however  the senders trajectory is not necessarily directed to the receiver while the sender is engaed in its own task  this can
bring ambiguity to the message decoding depending on the design of the trajectory codebook because the receivers monocular
vision is unable to determine the relative position between two robots from a single observation 
hence  in order to correctly classify the trajectory and decode the message  the receiver is allowed to sequentially move
around the sender and observe it repeating one particular class of the trajectories  this leads to a sequential state estimation
 the

author has worked on the same project in aa     spring      with prof  mac schwager as instructor 

 

fiharuki nishimura

cs   

and decision making problem  the bayesian network structure of this problem is depicted in figure    the receivers position
and attitude r is assumed to have the markov property   and u represents the observed trajectory and the control input to the
receiver  respectively  in what follows  we will formulate the trajectory generation process  receivers state transition model and
the observation model 

figure    bayesian network structure of the trajectory classification problem 

   

trajectory generation

in this work  we assume that the smooth trajectory of the sender can be represented by a set of m points                   m     r   
t
which are labeled by time  therefore  the complete trajectory is given by a vector         t             m   t  r m   this is
expressed in the senders reference frame that is fixed in the inertial space  the value of m depends on the duration of the
trajectory and the frame rate of the receivers vision sensor  but here we restrict all the trajectories in the codebook to have the
same duration so that the receiver cannot classify them based on it 
the sender chooses a message z and the corresponding trajectory  from the codebook  when it is executed  however  the
senders motion is subject to disturbance  we assume the resulting complete trajectory has a gaussian distribution 
p    z   i    n    i   q 
   

   

state transition model of the receiver

the receivers state r specifies its position and attitude with respect to the senders reference frame  which is expressed in the
receivers camera frame 
r     t   tt  t  r 
   
    x   y   z  t  r  gives the exponential coordinates on so     which specifies the axis of rotation around which the camera
frame is rotated with respect to the reference frame  the norm of  gives the magnitude of the rotation angle  similarly 
t    tx   ty   tz  t  r  represents the translation of the camera frame with respect to the reference frame 
the state transition is based on the current state and the control input u with gaussian noise 
rk     rk   uk   w  w  n  r     r   r 

   

note that the receiver will move only after it observes one complete trajectory performed by the sender 

   

observation model

the details of the pinhole camera model is omitted here for saving space and the reader is referred to           the pinhole camera
model projects the trajectory onto the image plane of the camera  the resulting observation         t             m t  t  r m is
given by a nonlinear projection function f        r   r m  r m that takes r and  as its arguments  the correspondence
between   i   r  and   i   r  is assumed to be known to the receiver 
analogous to      the actual observation is subject to gaussian noise 
   f  r      v  v  n       s   r m

   
page  

fiharuki nishimura

 
   

cs   

bayesian online learning for state estimation
recursive bayesian estimation formula

we are interested in estimating the joint distribution over r and z given the history of observations and control inputs  p rk     z  
  k     u  k    leveraging the bayess rule and the structure of the bayesian network  it can be decoupled and simplified as follows 
z
z
p rk     z     k     u  k   
p k     rk     k    p k     z dk  p rk     rk   uk  p rk     k   u  k    z drk
z
 p k     rk     z p rk       k   u  k   z drk    p  z     k   u  k    
   
    implies that we can separately update our belief of r conditional on z and the belief of z itself  given the state transition
model and the observation model  this allows us to derive the closed form update formula discussed in the next section 

   

multi hypothesis extended kalman filter algorithm

the problem of estimating the joint distribution over r and z given past observations and control inputs can be viewed as multihypotheses filtering  thus we will adapt the multi hypothesis extended kalman filter algorithm  which is a common parametric
filter to handle multimodal distributions with linear model approximation  in our problem  note that the observation function
takes two arguments r and   therefore  the first order taylor expansion around the current estimate e rk       k   u  k   z   i   
 i 
k   and e k     z   i    i is given by 
fi
fi
fi
fi


 i 
 i 
 i 


fi
 rk    k      
   
f  rk     i  fi
f  k     k    fifi  k    i   
f  rk     k       z   i  f  k     i    
 i 
rk  
k  

i
k  

denoting



rk   f  rk     i    i 
k  

 i 

  fk    r m  and

 i 

k   f  k     k     i

 i 

  gk    r m m   we obtain the following linearized

observation model 
 i 
 i 
 i 
 i 
f  rk     k       z   i  f  k     i     fk    rk    k       gk    k    i  

   

in order to derive the extended kalman filter update formula  we further assume that the prior belief of r conditional on z
before taking an action uk and observing k   is a gaussian distribution 
 i 

 i 

p rk     k   u  k    z   i    n  rk   k   k  

   

substituting                    and     into the update formula      we derive algorithm    we see that the categorical
distribution over z is modified in line    based on how well the hypothesis z   i can explain the actual observation 

   

beleif initialization

the convergence of the extended kalman filter algorithm is sensitive to the accuracy of the prior p r    z        fortunately 
 i 
 i 
estimating the means   and the categorical distribution parameters   can be evaluated by the maximum likelihood pa i 
rameter fitting  which is well studied in the computer vision literature  specifically    can be estimated by the direct linear
 i 
transformation algorithm and the levenberg marquardt algorithm to minimize the nonlinear least squares      f      i      
 i 
 i 
        can be also found by comparing their residuals  assuming the same initial covariance matrix   for all i              n   

 

active vision control for entropy minimization

given the current esimate of the state  our goal is to control the position and the attitude of the receiver in order to correctly
classify the trajectory and decode the message  one information theoretic approach is to select uk from the control space u so
that the expected entropy of z taken over the next obervation k   is minimized  formally  the control objective is given by 
z
ek    h z     k     u  k       k   u  k     p k       k   u  k  h z     k     u  k  dk    
   

page  

fiharuki nishimura

cs   

 i 
 i 
 i 
input   k  r    k  r     k   p  z   i     k   u  k     r i              n    uk  r    k    r m   z                n  
 i 
 i 
 i 
output  k    r    k    r     k    r i              n  
 
 

for each i              n   do
 i 
 i 
k    k   uk
 i 

 i 

 

k    k   r

 

fk   

 

 i 

fi
fi


 fi
rk   f  rk     i  fi

 i 

k  

fi

 i 

gk   

fi
 i 

fi
k   f  k     k    fi

 i 

 i 

i

 i t

 i 

 i 

 i t

 

hk    s   gk   qgk     fk   k   fk  

 

kk    k   fk   hk  


 i 
 i 
 i 
 i 
k    k     kk   k    f  k     i  

 
 
  

 i 

 i 

 i 

 i t

 i 

 i  

 i 

 i 

k     i  kk   fk    k  


 i 
 i 
 i 
k    n k     f  k     i    hk   k
end

  

  

pn  i 
c  i   k  
for each i              n   do
 i 
 i 
k    k    c
end
algorithm    multi hypothesis extended kalman filter algorithm for the trajectory classification problem 

by substituting the kalman update formulas and extracting the terms dependent on uk only  this yields the following formula 
 
 
z x
n
n
n
x
x
 i 
 i 
 i 
 i 
 i 
 i 
 i 
 i 


 log   h
  
 n  k     f  
  i    h
  log
 n  k     f  
  i    h
  dk  
    
k

i  

k  

k

k  

k  

i  

k

k  

k  

i  

the first term in      follows from the entropy of gaussian distributions  the second term is the negative entropy of a gaussian
mixture and exact solution is not available  however  huber et al       provide an approximation method based on the taylor
expansion and we will employ their first order approximation formula  the resulting control objective is presented below  note
that this function is independent of the actual observation k     thus it can be evaluated before taking the action uk  



n
n
x
x
 i 
 i 
 j 
 i 
 j 
 j 
j uk     k   u  k     
k log   hk       log 
k n  k     f  k     i    f  k     j    hk    
    
i  

j  

uk   arg min j u     k   u  k   
uu

 

    

simulation results

figure   shows the trajectory codebook with one circular trajectory and two different elliptic trajectories used in the simulation 
all the trajectories were assumed to be two dimensional  as can be seen in figure    all of the three trajectory classes fit equally
 i 
well to the observed image on the image plane of    x    pixels  with the initial covariance          i   i             the
   
   
   
prior parameters were                        and            while the true trajectory class was    as the simulation was
run  the receiver chose the control inputs according to      with u                                                               
                           the translational inputs were all set to   so that the camera axis was always pointed to the trajectories 
observed images at k     through k     are presented in figure    in this simulation  the configuration of the receiver was
converged to the perpendicular position to the senders trajectory  as shown in figure  d  the posterior parameters at k    
   
   
   
were                            resulting in the correct classification 
page  

fiharuki nishimura

cs   

trajectory codebook  z     

 

 
trajectory class  
trajectory class  
trajectory class  

   

  

   

  

   

  

 

  

v

   

y

trajectory class  
trajectory class  
trajectory class  
true image

  

    

  

    

  

    

  

    

  
   
  

    

 

   

 

 

  

  

x

  

  

   

u

 

 

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

v

 

  

v

 

  

v

v

figure    the trajectory codebook used in the sim  figure    the initial observation and the fitted traulation 
jectories 

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

   

   
 

  

  

  

  

u

 a  k    

   

  

   
 

  

  

  

  

   

u

   
 

  

  

  

  

   

 

  

  

u

 b  k    

 c  k    

  

  

   

u

 d  k    

figure    observed images at different time steps k 

 a  class  

 b  class  

 c  class  

figure    classification accuracy averaged over    simulations 

page  

fiharuki nishimura

cs   

we also compared the performance of the active control policy to the random policy based on    simulations  in each
simulation  the true position of the receiver was randomly initialized  as figure   illustrates  the active control policy always
outperformed the random policy after k      for all trajectory classes  in those simulations  we also observed that the receiver
converged to the perpendicular configuration to the trajectory when the classification was correct 

 

conclusion

in this paper we have presented an online trajectory classification algorithm for motion based communication between two robots
with monocular vision  bayesian update formulas were derived in the form of multi hypothesis extended kalman filter  we
have also derived the active control algorithm and demonstrated in simulations that the proposed framework outperforms the
random control policy 
in future research we intend to concentrate on two main aspects to extend the proposed approach  first  the use of extended
kalman filter might not be the best algorithm to implement the bayesian state estimation  we will also adapt other filtering
algorithms such as unscented kalman filter and particle filter  second  we will apply this algorithm not only to  d trajectories
but to  d trajectories in order to evaluate the general performance of our method in  d space 

references
    j  baillieul and k  ozcimder  the control theory of motion based communication  problems in teaching robots to
dance  p      sep      
    a  jones and s  andersson  a motion based communication system  in      american control conference 
      pp         

ieee  jun

    d  raghunathan and j  baillieul  motion based communication channels between mobile robots   a novel paradigm for low
bandwidth information exchange  in      ieee rsj international conference on intelligent robots and systems  ieee 
oct       pp         
      exploiting information content in relative motion  in      american control conference 
     

ieee        pp      

    d  l  alspach and h  w  sorenson  nonlinear bayesian estimation using gaussian sum approximations  ieee transactions
on automatic control  vol      no     pp               
    r  chen and j  s  liu  mixture kalman filters  journal of the royal statistical society  series b  statistical methodology  
vol      no     pp          aug      
    g  jochmann  s  kerner  s  tasse  and o  urbann  efficient multi hypotheses unscented kalman filtering for robust localization  in robot soccer world cup xv  springer verlag  jun       pp         
    j  denzler and c  brown  optimal selection of camera parameters for state estimation of static systems  an information
theoretic approach  technical report  p           
    m  zobel  j  denzler  and h  niemann  entropy based camera control for visual object tracking  in proceedings  international conference on image processing  vol     ieee        pp         
     a  seekircher  t  laue  and t  rofer  entropy based active vision for a humanoid soccer robot  in robot soccer world
cup xiv        vol       lnai  pp      
     v  lepetit and p  fua  monocular model based  d tracking of rigid objects  a survey  foundations and trends in
computer graphics and vision  vol     no     pp       jan      
     r  i  hartley and a  zisserman  multiple view geometry in computer vision   nd ed  cambridge university press  isbn 
                 
     m  f  huber  t  bailey  h  durrant whyte  and u  d  hanebeck  on entropy approximation for gaussian mixture random
vectors  in      ieee international conference on multisensor fusion and integration for intelligent systems  ieee 
aug       pp         

page  

fi