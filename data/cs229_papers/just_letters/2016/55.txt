classification of hand gestures using surface electromyography
signals for upper limb amputees
gregory luppescu
stanford university

michael lowney
stanford univeristy

i  introduction
for our project we classified hand movements based
on surface electromyography  emg  signals from
upper limb amputees  approximately    to    percent
of patients with upper limb amputations discontinue
use of their prosthetic because the cost of carrying
it outweighs its  limited  usage      machine learning
has the potential to greatly improve the functionality
of myoelectric prosthetic limbs  after a patient loses
a limb  they still contain all the necessary nerves to
control their non existing limb  by using emg to
measure the electrical signals sent through these nerves 
amputees can potentially control a robotic prosthetic in
the same way that they once controlled their original
limb  much research still needs to be done in order
for the latest generation of prosthetics to understand
the electrical signals coming from the user  in our
project  we utilize linear discriminant analysis  nave
bayes  and support vector machines to classify a
set of gestures based on emg signals provided by
several upper limb amputees  we also propose our own
collection of features to use for each classifier 

raj shah
stanford university

of a gesture  and     trials were recorded for each
force level  giving a total of over     distinct gesture
signals  an example of a raw emg signal is shown
in fig     for our project  we used data from four of
the nine subjects  these four subjects all had traumatic
amputations on their left forearm 

fig    

raw emg signal from a single channel

ii  dataset and features
a  dataset
the data set was provided by      and consists of raw
emg signals recorded from nine different transradial
amputees  seven traumatic and two congenital  with
unilateral amputation  where electrodes were placed on
and around the stump where a hand  or prosthetic 
would be located  ten pairs of electrodes were placed
on each subject  providing    channels of emg data 
each amputee imagined to perform six different hand
gestures using their amputated limb  the six gestures
in the data set are the spherical grip  index flexion 
hook grip  thumb flexion  fine pinch  and tripod grip 
for each of the six gestures  three levels of force low  medium  and high   were imagined as well  each
trial  signal  consists of an      second holding phase

fig    

experimental setup used in     to acquire emg data

b  features
a total of    features were examined in our project 
these features are popular in modern research for emg
pattern recognition      fifteen of the features were
extracted in the time domain  and three were extracted
from the frequency domain  six of the time domain
features were time dependent power spectrum density
features suggested in      all the features except the
time dependent power spectrum density features are
listed in table i  to compute the other features  we
first calculate the zero  second  and fourth order root
squared moments by

fifeatures

s
m   

s

n



xi 

m   

i  

s

n



xi 

m   

i  

time domain features

n



definition

  xi 

i  

where n is the total number of samples  and xi is
the sample at index i  the moments are then scaled
and normalized by a factor of  to make them more
robust to noise

m
mk   k

where a value of        was used  the six features
f    f          f  are extracted as follows 
f    log m   

mean absolute value  mav 
integrated emg  iemg 
variance  var 
root mean square  rms 
waveform length  wl 
log detector  ld 

 
n

n
i    xi  

n
i    xi  
 
n
 
n  i   xi
 
n
 
n  i   xi
n 
i    xi    xi  
exp  n  n
i   log  xi    

wilson amplitude  wa 

i    xi  xi       

slope sign change  ssc 

the number of times the
sign of the slope changes
 with a threshold  

zero crossing  zc 

the number of times the
signal crosses a threshold
        

frequency domain features

f    log m   m   

mean frequency  mf 

m
m
i   f j pj   i   pj

f    log m   m   

median frequency  mef 

median frequency of the
power spectrum

m 

f    log  
 
m   m  m   m 

modified mean frequency
 mmf 

m
m
i   f j a j   i   a j

time domain power spectrum descriptors

m 
f    
m  m 

f    log

n 
j    x 

f    f    f    f    f    f  as defined in ii b 
ith



 
n 
j     x 

f  is a measure of sparseness and f  is a measure
of the ratio of the zero crossings to the number of
peaks as given in      f  is simply the ratio of the
waveform length of the first derivative to that of the
second derivative  in order to negate the effects of
force  the final six features are found by a cosine
similarity measure between the six features mentioned
above and their logarithmically scaled versions  this
helps in negating the force effects and only takes into
account the orientation of the features      the final
  time dependent power spectrum density features are
defined as
   fi  log  fi   
fi  
 
fi    log  fi   
thus  we have defined all of our features taken into
consideration for each channel  each feature describes
a particular aspect of the emg signal  for example 
waveform length gives a measure of the emg signals
complexity  and both wilson amplitude and log detector give a metric for the level of muscle contraction
observed 

xi sample of the emg signal  n   length of the
emg signal  f j   frequency at the jth sample of the
spectrum  pj   power spectrum at f j   a j   amplitude
spectrum at f j   m   length of the spectrum
table i
t he definitions for the features used for each
channel  

iii  methodology
a  preprocessing
before extracting features  it is important to process
the raw emg signals to ensure the features of interest
are not obfuscated by various sources of noise  to do
this  we apply a cascade of five filters  a high pass
fifth order butterworth filter with a cutoff frequency of
   hz  a low pass third order butterworth filter with a
cutoff frequency of     hz  and three notch filters with
stop bands centered at    hz      hz  and     hz     
the low pass and high pass filters smooth the data and
restrict the frequency components of our signal to the
frequency range of normal emg signals  and the notch
filters suppress interference caused by power lines and
electrical wires     hz in most countries     hz in the
united states  

fib  feature extraction

d  training procedure

the preprocessed signals are segmented into windows of length     ms with     overlap  this is
done to leverage the fact that the signals are pseudostationary in small regions  and leads to better classification results than if one used non overlapping windows      for each window  the    features described
in the previous section are extracted for each of the
ten channels  giving a grand total of     features per
window  an example window is shown in fig    

we trained three different classifiers to predict hand
gestures  linear discriminate analysis  lda   nave
bayes  and multiclass svm  for the nave bayes
classifier the feature vectors are discretized into    
different values  the classifier is then trained using a
multivariate model  for the multiclass svm  we took
the one vs all approach  where we trained a single
classifier per class  with the samples of a specific class
as positives and all other samples as negatives  for
testing  the classifier yielding the highest confidence
level determined the predicted gesture  the classifiers
were trained on each subject individually due to the fact
that emg signals can vary from person to person due
to biological and environmental factors  two different
training and testing procedures were performed  one
in which only the gestures were classified    classes  
and one in which both the gesture and force level were
classified     classes  

fig    

windowed emg signal for which we extracted features

c  feature selection
real time classification is needed for modern myoelectric prosthetics  for this reason  it would be advantageous to reduce the size of the feature set from    
to a smaller number to reduce computation time  for
each classifier  we performed forward feature selection
to determine what the optimal features were  and how
few features could be used while maintaining high test
accuracy 
there are two potential ways to perform feature
selection  one in which we consider all     features
across the ten channels  and one in which we find a
subset of the    features which is applied to each of
the ten channels  due to changes in electrode placement
from subject to subject  we chose to find which of the
   features per channel would give the best results 
using this method  the optimal feature set can be applied irrespective of the channel placement or number
of channels 
feature selection was run on each individual for
each classifier  the test errors were calculated using  fold cross validation  the optimal feature set for each
classifier was decided by using a voting scheme to
average the results across each of the four subjects 
a weighting was applied to each feature depending on
its rank in the output of feature selection  we chose
the optimal feature set for each classifier based on the
features that cumulatively ranked the highest across all
individuals 

fig     test accuracy vs  number of features per channel for lda
and nb classification

iv  results and discussions
the feature selection algorithm was run for the
classification of hand gestures without force labels 
the selected feature sets for each classifier were then
used to classify hand gestures with and without force
labels  the results of the feature selection algorithm
on lda and nave bayes are shown in fig    the
nave bayes classifier quickly experiences over fitting
when there are six or more features  also  the training
and testing accuracy is the lowest for nave bayes 
this was expected as nave bayes makes some strong

fiassumptions about the independence between different
features  which is certainly not the case in this application  the optimal feature set for nave bayes was of
size five and can be found in table ii  the features
are listed in the order they were selected from the
feature selection algorithm  the lda classifier did not
experience any over fitting  but we still decided to pick
the top eight features in order to reduce the feature set 
which would be needed in real time applications  the
optimal feature set for lda can also be found in table
ii 
classifier

features used for each channel  by
ranking 

lda

f   f   rms  f   wl  f   f   ie

nave bayes

f   f   wa  f   f 

svm

wl  f   f   f   rms  mav  f 

table ii
t he feature sets chosen for each classifier

the confusion matrices for lda and nb lead to
an interesting result  among both methods  the two
gestures that are mistakenly classified for one another
are the hook grip gesture and the spherical grip gesture 
these rates of misclassification  when compared to
all other rates of misclassification  are in accordance
with the fact that the two gestures are similar to each
other  in general  the rate of misclassification between
two gestures seems to be correlated with the level of
similarity between gestures 

gesture and force classification
classifier
lda
nave bayes
svm

training
accuracy
      
      
      

testing
accuracy
      
      
      

table iv
t raining and t esting accuracy for g esture and f orce
classification     classes  

implemented the svms with linear kernels  which gave
poor testing accuracy  consequently  we implemented
multiclass svm with gaussian kernels which achieved
high training accuracy  most likely due to the fact that
the gaussian kernel can theoretically fit an infinite
number of points  however  the testing accuracy was
also considerably high and hence  we decided to go
with a gaussian kernel 

fig    

confusion matrix for lda gesture only classification

gesture classification
classifier
lda
nave bayes
svm

training
accuracy
      
      
    

testing
accuracy
      
      
      

table iii
t raining and t esting accuracy for g esture
classification    classes  

for svm  the optimal feature set can be found in
table ii  due to time and computational constraints 
we only ran feature selection for    out of the   
features  but noted that features after this point were
most likely either causing over fitting  or were not
contributing much more to the test accuracy  thus  we
felt it was valid to halt the process early  we initially

fig    

confusion matrix for nb gesture only classification

the feature selection also presented some important
observations  firstly  all the features selected for the

fiout of the    channels  this information could be
used to make prosthetic arms less cumbersome by
including only the necessary channels for classficiation 
lastly  it would be worthwhile to explore if the feature
sets chosen could generalize to all emg signals by
testing on data acquired from other sources of the body 
for instance  one could acquire data on a lower limb
amputee to characterize foot movements and use our
methodologies for prediction 
acknowledgment
fig     confusion matrix for svm gesture only classification
classification

classifiers were time domain features  this suggests
that there is little variance in the frequency domain
features to help classify the emg signals  also  a
number of time dependent power spectrum density
features from     are a part of the optimal feature set 
this implies that these features coupled with others
could prove to be a strong feature set for classifying
emg signals 
finally  lda proved to be best classifier for this
application with high training and test accuracy  also 
it was observed that increasing the number of features
did not lead to overfitting for the lda classifier  unlike
nave bayes and svm  svm gave high training accuracies  but testing accuracies lesser than lda hinting
that regularization may have helped to improve the
testing error 
v  conclusions and future work
in this project  we provided an effective feature set
for real time classification of emg signals using lda 
nave bayes  and multiclass svm  and showed that
lda provided the best overall performance  we were
also able to predict with fairly high accuracy common
gestures that would be useful for modern prosthetic
limbs  we also demonstrated that the same set of
features resulted in fairly high performance for the
classification of gesture and force simultaneously  for
future work  it is worth exploring ways to make the
multiclass svm classifier more efficient and effective
by regularization and by using different kernels  feature
selection can be implemented for all     features
across all channels  which can help to understand the
dependence of features on different channels  different
locations on the arm   also  it would be useful to
implement a method to identify important channels

this project was a part of the cs    machine
learning course at stanford conducted by prof  john
duchi  we would like to thank prof  duchi and the tas
for this insightful course and for guiding us through this
project 
r eferences
    dromerick  alexander w   et al  feedforward control strategies of subjects with transradial amputation in planar reaching  journal of rehabilitation research and development     
            
    al timemy  ali  et al  improving the performance against
force variation of emg controlled multifunctional upper limb
prostheses for transradial amputees         
    e  scheme and k  englehart  a comparison of classification based confidence metrics for use in the design of
myoelectric control systems         th annual international
conference of the ieee engineering in medicine and biology society  embc   milan        pp             doi 
        embc             
    hakonen m  piitulainen h  visala a  current state of digital signal processing in myoelectric interfaces and related
applications  biomed signal process control elsevier ltd 
              

fi