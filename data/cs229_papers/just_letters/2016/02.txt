non stationary autoregressive filters for prediction of subsurface
geological structure
anshuman pradhan
department of energy resources engineering  stanford university
pradhan  stanford edu

introduction
accurate decision making in the petroleum industry is highly contingent on building
a reliable model of the subsurface geological structure  building a model of the
subsurface typically involves solving an inverse problem with acquired data for
various model parameters of interest like p wave velocity  rock porosity etc 
however  issues of poor data quality necessitate regularizing the inverse problem 
where prior geological information is incorporated  a big issue is that geology is
typically highly heterogeneous  non stationary  and conventional regularization
operators fail to capture this non stationarity 
this project uses autoregressive filters that can learn on training images  tis  of the
geological structure  for use as regularization operators in inverse problems  a nonstationary approach is employed  in which multiple filters are trained for a single
grid of the subsurface structure  after training  the filters are expected to provide a
way of incorporating non stationary prior information about geological structure
into inverse problems 

methodology
any inverse problem can be viewed as complementary to a learning problem  here 
the hypothesis  physical model  is assumed to be known and the goal is to predict
the features  model parameters  from targets  acquired data   the commonly used
fitting goals  optimized simultaneously  for model parameters are
       

   

     

   

where    physical model     model parameters  d  data    regularization operator 
      residuals 
equation     is the regularization goal  which is the topic of interest in this project 
machine learning techniques will be utilized to train regularization operator  on
prior geological information  which is expected to help guide the inversion towards
the desired geological solution 
 

fiprediction error filter  pef   claerbout        is a commonly employed
regularization operator  pefs can be trained using autoregression on a ti  for
example  lets assume a geologist has some prior geological knowledge e g  
subsurface channel structures in a deltaic reservoir  shown as tis in figure    to
train the pef  regression equations are formed by autoregression on the ti and
filter coefficients are optimized  however  pef has been shown to fail in the
presence of non stationarity  e g   the heterogeneous channels in figure    in the
training image  claerbout        
to deal with this issue  this project implements a non stationary approach to
training the filters  instead of using a single filter to learn on the entire grid of the ti 
multiple filters are used over the grid  however  this approach comes with its own
complicacies  for instance  in the extreme case of a separate filter for each grid cell 
the total number of filter coefficients to be optimized increases dramatically and the
system of regression equations becomes under determined  claerbout         to
summarize  the dilemma is that more filters are needed to capture geological nonstationarity but there are not enough equations  i started this project by asking the
question how can we make the system of equations overdetermined 
hypothetically  one way out would be the case if instead of a single ti  we somehow
had access to multiple tis 
let us first assume we have access to multiple tis  a mathematical formulation will
now be presented to encapsulate these ideas  let us assume we have n  d training
images  tis   each consisting of   grid cells  the kth ti is expressed as   
              we assume every grid cell has a      filter  i e    coefficients  of its
own  the filter coefficients for the  rd grid cell can be expressed as    
               these filter coefficients are determined by optimizing the following
system of equations in a least squares sense 
        
 
        
   
       
   



  
     
similar fitting equations are formulated for the remaining cells  all the coefficients
can then be determined by minimizing the residual vector of the whole system in a
least squares sense 

data and features
a mathematical formulation was developed for the problem  what is needed now is
a way to generate multiple tis to serve as data  one method is to use geostatistical
simulations  mariethoz et  al         to generate the tis  basically  these simulations
sample from a probability distribution and give us many possible realizations of the
geological structure  figure   shows  as grids of           two possible realizations
of a region in deltaic reservoir  we generate     such tis  another scenario  that of a
stone wall  two realizations of which are shown in figure    is also used to test the
 

fiproposed methodology  albeit not a geological scenario  the structure is highly nonstationary to be representative of geology 
the next task is to determine the features we want to use in the regression
equations  since geology varies in a spatial context   d filters as shown in figure  
are used  thus  the features are neighboring data points in a  d spatial sense  this is
reasonable since the goal is to capture the patterns present in the tis  the shape of
the filters can also be modified suitably according to ones needs 

realization  

realization  

figure    two possible realizations of a deltaic reservoir obtained using direct sampling  highlighted
portions show how the two realizations are different from each other 

figure    two possible realizations of a stone wall obtained using direct sampling 

realizat

realiza

figure    a      filter for   cell  similar filters are used for remaining grid cells

 

firesults
the filters will now be trained and tested for accuracy  in the initial analysis  we
used      filters for every grid cell  regression equations are subsequently formed
for all grid cells  as illustrated in equation     for a single cell  the filter coefficients
are now optimized in a least squares sense using a conjugate gradient scheme
 claerbout        
after training the filters  these filters are tested for their efficacy in prediction of
non stationary geology  it is important to note that  in an ideal case  these trained
filters will be used in solving equation     in conjunction with equation      the
same idea will be employed for testing purposes  we use equation     again but in a
reverse sense  i e   we now optimize  using the trained filter   only equation    
will be solved here for simplicity   since the output of pef is white  equation     is
fitted to random numbers  claerbout         the model parameters are now
optimized in a least squares sense using conjugate gradient  figure   shows the
result of such a procedure for the two scenarios 

figure    simulations of the two scenarios using the trained filters

fortes and failings
figure   shows how the trained autoregressive filters did an excellent job at
predicting the non stationary geology  the highly heterogeneous structures in both
the scenarios were simulated perfectly  the highlighted parts in figure   show
patterns that were not present in either of the two input realizations shown but may
have been present in other realizations  this underscores the fact these trained
filters are successful in capturing the probabilistic prior information present in
geostatistical simulations  now  let us imagine employing these filters in an inverse
problem  since  both equations   and   are optimized simultaneously  it is expected
that equation    which uses the filters trained on prior information  will guide
equation   towards the desired geological solution  implemented correctly for the
desired model parameters of interest like p wave velocity  rock porosity etc   it is
 

fiexpected that this will increase confidence on the high stakes decisions involving
drilling of hydrocarbon wells 
however  one cause of concern in this preliminary approach is the danger of
overfitting  filters were trained for every grid cell  but how justified is this
approach  do the statistics vary too rapidly to warrant the use of filters for every
grid cell  to reduce the number of filters that are used  we can make the filters
constant in patches over the grid  this can minimize the risk of over fitting  we first
tried to make the filters constant along  d patches  claerbout         a  d patch is
shown in figure    left   similar patches were formed all over the grid and the filters
 constant in patches now  were optimized  figure    right  shows the simulation
result using the trained filter  it is clear that the result has degraded in comparison
to the original simulation  my best guess is that this is because of the incongruity in
the shapes of the filter and patches  if we look at the geological patterns more
closely  we see that the patterns are not smooth anymore but rather have become
zagged  this seems like footprints of the patches that were employed  the statistics
of the geology vary in a spatial sense rather than a  d sense  thus  i believe in order
to recreate consistent results while minimizing the risk of overfitting  we need to
employ  d patches that can mimic the spatial variation of the statistics  this idea is
heralded as the subsequent direction of work for this project 

figure     left  a  d patch is shown in orange  all the highlighted cells have a common filter 
 right  simulation result after training filters constant in patches

references
 claerbout  j         geophysical image estimation by example  environmental
soundings image enhancement  stanford exploration project 
http   sepwww stanford edu sep prof  
 mariethoz  g   caers  j         multiple point geostatistics  stochastic modeling
with training images  wiley blackwell 

 

fi