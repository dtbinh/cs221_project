energy measurement in exo     using boosted regression trees
mike jewell   alex rider
june        

 

introduction

the exo     experiment uses a liquid xenon  lxe  time projection chamber  tpc  to search for
neutrinoless double beta decay     an extremely rare hypothetical decay that would indicate
the majorana nature of neutrinos           the exo     experiment has been taking data for over
  years and has published one of the most sensitive limits on   half life 
events deposit energy in the lxe through both scintillation light     nm  and free ionization
charge  the scintillation light is detected at either end of the exo     detector by large area
avalanche photodiodes  apds   the ionized charge is drifted along the z axis of the detector where
it first passes a shielding induction wire grid  v wires  and is than collected by a second wire
grid of collection wires  u wires   each wire is  mm in pitch and wires are ganged into groups of
three before being readout and saved  the total charge energy of an event is then calculated by
determining the sum amplitude of all channels which collected charge 
in order to accurately reconstruct the energy of the waveform signals have to be accurately
identified as either collection or induction signals  this is currently done by performing a   fit
to both a collection and induction signal and than classifying the waveform based on the ratio of
these scores  waveforms classified as induction are flagged and then not included into the sum
when determining event energy  this current technique achieves reasonable efficiency at identifying collection and induction signals but energy deposits spanning multiple channels present a
slight challenge because waveforms will contain both collection and induction signals  in addition 
the waveforms are shaped before being saved to disk making identification and energy estimation
somewhat more complicated  in this study an alternative technique for reconstruction of event
energy in exo     using boosted regression trees from sklearn is explored    

 
   

simulation and data compression
monte carlo

the exo     monte carlo has been described in detail elsewhere      for waveform generation
energy deposits in the detector are used to simulate waveforms on each of the u wire channels using
the shockley ramo theorem to calculate induced signal  to simplify this analysis monte carlo
energy deposits were not generated with geant  as in the standard analysis  instead events with
uniformly distributed energy and position were simulated in the detector  for each deposit the
waveform from the collection channel is saved and tagged as collection while the waveform from
the two neighboring channels are tagged as induction and saved  for each event the true energy of
the deposit was also saved to be used as the target when training and testing 
each waveform in the detector consists of      samples taken at a sampling rate of  mhz with
a fixed trigger time at       in addition  standard monte carlo includes added noise  sampled from

 

fi 

real data into the waveforms  in order to simplify the first stage of the analysis no noise was added 
the second stage of this analysis included added noise into the waveforms  this was done by using
a database of noise waveforms seen in real data and adding these into the generated waveforms at
random an example is shown in figure  b 

   

template generation

initially a template waveform for both induction and collection was created by simulating an event
in the exact center of the detector  the resulting collection and the average of the induction signals
from this event was than used as a template to represent the typical collection and induction
waveform  the results of these templates in time space are shown in figure   
although most induction and collection signals have roughly the same shape  there are some
differences due to the exact position and energy of the initial deposit  using these two templates
offered a reasonable projection into collection and induction space but this did not fully capture
the detailed shaped information  for the final analysis a more sophisticated template generating
algorithm was implemented  this involved using a k means clustering algorithm to find a larger
subset of template waveforms that better samples the waveform space 
results for template generation using the sklearn k means clustering algorithm with    clusters
are shown in figure    waveforms are created using the same monte carlo technique  events with
varying energy are uniformly generated within the detector volume and a set of   k wfs was
generated  each waveform is than normalized by the maximum amplitude and time shifted so the
peaks all occur at the same time  this was necessary so that the clusters represented different
shapes as opposed to different time off sets of the same shapes  the time offset is handled in the
optimal filter stage  in addition  a windowing from sample     to      was implemented  this was
required because the clustering algorithm seemed to fail when the large pre post trigger segments
with   signal were included as this is identical for all pulses  the algorithm succeeds in finding
both collection and induction like clusters  typical templates are shown in figure   

   

optimal filter

the goal of this analysis is to learn a mapping from the space of digitized waveforms to the amount
of charge deposited on a particular channel  early work showed that learning in the full space of
     length vectors that comprise the raw waveforms was impractical  we devised a method for
compressing some of the information stored in each pulse into many fewer than      real parameters
using optimal filters 
optimal filters take as inputs a noisy time series v t  and a template s t  and return the
amplitude of s in v  under certain assumptions it can be shown that an optimal filter is the best
estimator of of the amplitude of s in v  the optimal filtering we employed is equivalent to lms
fitting of the template to the signal in the frequency domain  the    cost function  for a particular
amplitude  a  is defined as follows
z
 v f    as f    
 
   df
   
j f  
where v f    and s f   are the fourier transforms of the signal and the template  respectively 
j f   is the power spectral density  psd  which is used as the weight for each frequency in the
cost function  in practice  the waveforms are always sampled discretely  so that discrete fourier
transforms are implemented using ffts and the integral in equation   is carried out as a sum  for
waveforms generated without added noise  a uniform psd was used but for waveforms with added
noise  the average psd was estimated using real data 
cs    

fi 

as previously stated  we initially started by compressing waveforms into   component vectors
where the first component is the amplitude of the optimal filter with a typical collection pulse shape
used as a template and the second component is the amplitude of the optimal filter with a typical
induction pulse used as a template  the results of doing this for a sample of       monte carlo
pulses is shown in figure   later analysis increased the parameter space to a    component vector
where each component represented the amplitude of the optimal filter with each of the    k means
templates 

 

energy estimation

the compressed pulse data with   components shown in figure   was used to train a boosted
regression tree implemented in pythons scikit lear library to predict the energy in a sample of
test pulses reserved from the training set  the boosted regression tree learned the mapping from
the representation of the pulses in r  to the energy of the pulse by boosting     trees of depth   
together  the boosted tree was trained using   k noiseless mc wfs including both collection and
induction signals  an additional      wfs were used as a test set to determine the test error  a
plot of the predicted energy versus the true energy for the pulses in the test set are shown in figure
 a  the average error in predicted energy for collection pulses is     along the y axis it is possible
to see the   out of      induction pulses that our model erroneously gave energies to  there are
also   out of      collection pulses that our model erroneously assigned   energy  the scatter in
predicted energy for collection pulses is likely due to template mismatch and should be improved
by expanding the space of templates 
in addition this same procedure was repeated for this same testing and training set using the
   template wfs generated in clustering instead of the   typical templates input by hand  the
results of this method is shown in figure  b here no induction signals were assigned non zero energy
    kev  and the energy reconstruction was       this is a huge improvement over the original  
template technique 
finally to test the generalization of this method to mc with added noise we repeated the same
procedure using the    template wfs and   k training wfs generated with noise and reported
the error on a test set including   k wfs with added noise  the results are shown in figure   
this resulted in an error of     in the energy estimation of collection signals and many induction
signals       had energy     kev   given the amplitude of the noise  the intrinsic energy resolution
should be      the drastic decrease in performance with the presence of noise indicates that we
are likely over fitting  future work will focus on determining the optimal depth for the regression
trees and the optimal number of regression trees to boost together  furthermore  simply using a
larger training set may improve the performance of this analysis  we will also experiment with
weak learners different from threshold functions 

 

conclusions

using the boosted regression tree algorithm from sklearn an initial energy reconstruction algorithm has been implemented to predict the energy associated with u wire collection signals in
the exo     detector  the current algorithm uses a set of n    templates to represent pulses as
vectors in rn using an optimal filter  a boosted regression tree learns the mapping between these
vectors and the energy of the pulses  this resulted in      error in the energy estimate for wfs with
no added noise but     error for wfs with realistic noise  future work by the exo collaboration
to improve this analysis will focus on understanding the large error of this estimation 

cs    

fi 

exo     waveform template

exo     waveform template
adc counts

adc counts

    

     

    
    

     

   
   

     

   
    

   
 

 

    
    

     
 

    
   

   

   

   

    

    

    

    

    

         
time  s 

 

   

 a  collection signal 

   

   

   

    

    

    

    

    

         
time  s 

 b  induction signal 

figure    templates of induction and collection signals used in the optimal filter in the time domain 
signals represent pure collection and induction pulses 

induction
collection

   

induction amplitude

   
  
  
  
  
 

 

  

  
  
collection amplitude

  

   

figure    projection of waveforms into collection and induction space using the   templates generated with a charge deposit in the detector center 

figure    templates generated using k means clustering with    clusters  appears to find both
collection like and induction like signals 

cs    

fi 

   

induction
charge collection

predicted energy  mev 

   
   
   
   
   
   
   

   

   

   
   
true energy  mev 

   

   

 b 

 a 

figure    energy predicted by regression tree versus true energy for a sample of test pulses using
  template method      error   a  predicted energy using    templates generated with k means
clustering       error  

 a 

 b 

figure    wfs with noise figure  b and the energy prediction for these wfs figure  a  observed
    error on   k wf test set in measurement of energy for collection signals  in addition many of
the induction signals were assigned large energies 

references
    j  b  albert et al  improved measurement of the   half life of
detector  phys  rev   c                   

    xe

with the exo    

    j  b  albert et al  search for majorana neutrinos with the first two years of exo     data 
nature                
    m  auger et al  the exo     detector  part i  detector design and construction  jinst 
  p            
    f  pedregosa  g  varoquaux  a  gramfort  v  michel  b  thirion  o  grisel  m  blondel  p  prettenhofer  r  weiss  v  dubourg  j  vanderplas  a  passos  d  cournapeau  m  brucher  m  perrot  and e  duchesnay  scikit learn  machine learning in python  journal of machine learning
research                    

cs    

fi