exploring review quality and social network influence in
the yelp academic dataset
taylor dahlke  tjdahlke   giovanni campagna  gcampagn   tamirlan seidakhmetov  tamirlan 

introduction

approach

the primary interest of yelp is to provide high quality
reviews that are useful  insightful  and entertaining  yelp
users can vote on reviews by tagging them as useful  funny
or cool  its in the interest of yelp to find out which users
produce the best reviews based on these metrics  so that
they can reward those users with elite status and other
social perks  as a business  yelp does best when users are
creating reviews that are useful to other users  and wants to
encourage that  because of this  much of our work focused
on one question  can we build a model to help predict
which users make the most useful reviews  we explore
what variables we need to make such a prediction  with an
emphasis on learning how social network information can
help us better answer that question 

we are most interested in predicting the normalized
usefulness of a user    of useful votes over all reviews     of
reviews   and are interested as to whether we can make
use of derived attributes to better approximate that  we
began by building a number of attributes from the business 
review data collected for each user such as 

relative usefulness of reviews when compared to
other reviews for a business  mean and standard
deviation  

relative earliness of review posting date when
compared to other reviews for the same business
 mean and standard deviation  

latitude   longitude of review locations for a user
 mean and standard deviation  

how traveled a user is  max of latitude and
longitude standard deviation  

dataset findings
every year  yelp releases a dataset to be used in their
academic challenge competition  this data set is extensive 
and geographically covers eight cities in north america 
and three in europe  the dataset includes          
reviews  for        businesses and         users  most all
of the information that is publically available on the yelp
website is included in the attributes for each of these three
datasets  in particular  a subset of the friendship graph is
included in the users table 
the dataset was selected primarily by geographical
location  we find that many users are missing reviews  total
count of user reviews is higher than the number of reviews
given for that user in the dataset   we expect this is
because users also review businesses that lie outside the
selected cities  when traveling  etc   fortunately 
subsampling is not found within the social network
established in the dataset  this points to the fact that for the
cities selected  most of the users have yelp friends within
their immediate area  nevertheless  aggregate attributes
that reflect the real data are present for businesses and
users 

next  we derived social network information for each
user  to do this  we first selected from the original data all
the users who have at least one friend  about     of all
users   then we searched through the friends of each user
to build distributions of attributes  for example  a
distribution of the number of fans that each friend of a user
had  then  we split these distributions into discrete bins that
were globally defined for all users  below are the categories
of social network attributes that we built 










total size of users second order network
second order network size for friends  binned
distribution 
number of days since joining yelp  binned
distribution 
number of good writer  good photos  and good
list compliments  binned distribution 
number of reviews for friends  binned distribution 
number of elite friends
how far away friends are  distances from user to
friend average review location   mean and standard
deviation 
how traveled friends are  binned distribution 

 

fialso we looked at various statistics of friends network using
original dataset  particularly the mean and standard
deviation  as well as the minimum and maximum of the
number of friends reviews  fans  useful votes and average
stars for reviews 

pca
the next way that we chose to analyze our data set was by
performing principal component analysis  pca   we found
by doing pca that most of the variance  about      was
accounted for by the first four principal components  figure
   

structural analysis of the user
dataset
we begin with analysis of our dataset to better understand
what attributes might allow us to best make predictions
about a users usefulness and elite status  table   shows
the top   most correlated attributes for each response
variable 
table    correlation values of attributes with normalized
usefulness and binary elite

figure    percent variance explained by each
principal component

given   social network derived attributes
correlation with norm
usefulness

correlation with elite

clustering

attribute
mean relative
usefulness

attribute
    

friends max
  of fans

    

  of cool votes

    

friends max
  of useful
votes

    

  of funny votes

    

  of reviews

    

size of  nd order

    

friends max
  of reviews

    

    

size of  nd

    

network
  friends in   
percentile for good

order network

photo compliments

by finding the correlation between the normalized
usefulness and other attributes  we were able to get a
rough idea of the most influential variables  most of which
appeared to be attributes derived from social network data
 in bold  

one hypothesis that we made after heuristically reviewing
different users in our dataset and on the yelp website itself 
was that elite users tend to be friends with other elite users 
many of them seem to meet a special events hosted by
yelp  further  many elite users seem to get compliments
from these same elite friends  we also find that elite users
tend to be more helpful  average normalized usefulness of
      while non elite have a mean of        in order to
confirm our hypothesis that users are split in two rough
clusters of non useful  non elite users  and useful elite
users  we run k means on the data  with different cluster
numbers  we split the data in a training set  on which we
trained the k means algorithm  and a test test  which we
assigned to the nearest cluster center  and we measured
the test error on an average of    splits  with   
initialization of k means each time  data was preprocessed
by standardization and pca with various numbers of
components  as well as log scaling for attributes that would
grow with the number of friends and the number of reviews 
because they would naturally vary significantly  not
surprisingly  the error was observed to decrease as the
number of cluster increased  but we found a local minimum
with   clusters 

 

fiwe chose svm with a radial basis function  rbf  kernel 
because that would limit our bias and extract the most from
our features  we used a training set of         because the
full dataset was too computationally intensive  and because
we rebalanced to make sure we had     elite and     not
elite  despite having only about    elite in the original
data   we obtained the following results  where precision
and recall should be intended for a elite       
figure    clusters with k      using   pc

figure    clusters with k      after pca   preprocessing
and log scaling of large attributes

table    summary for prediction of elite users
accuracy

precision

recall

train

     

     

     

test

     

     

     

this very high accuracy suggests there is a clear
separation for elite and not elite  which we can also see by
plotting the users in pca   space  the graph also shows
the decision boundary of the svm  although a large number
of points appear to be misclassified because the decision
boundary is plotted in pca   space  but the svm is trained
on the full dimensionality of the data 

figure    test error  total euclidean distance to the centers 
of k means with different ks
empirical analysis of the cluster centers with k     and pca
  preprocessing suggests that the   more marked clusters
tend to be affected the most by the compliment quantiles
attributes in the first order network  that is  the number of
friends with a given  binned  number of compliments  
suggesting that friends with the same number of
compliments are close together  this seemed to agree with
our hypothesis regarding the clustering of elite users  
patting each others back with compliments 

separability of elite binary
following our initial hypothesis that elite status provides
some structural separability to the users  we trained a
supervised model to predict the elite status of the user 
given all other attributes 

figure    elite binary  with svm decision boundary  brown
elite  blue not elite  pca with   components for illustration
purposes 

graph analysis of the user social network
we built a graph from the social network data  linking
each user to each other  using this graph  we were able to
run an assortativity metric to understand the preference of
users to befriend others based on certain attributes  in this
case  positive values indicate a preference toward
clustering based on that attribute  while a negative number
indicates the opposite  while none of the attributes had
particularly strong values  the relative ranking of attributes

 

fistill tells us something about how users are related to their
friends 
we found that users tend to connect to each other
when they have similar spatial extent of where they give
reviews  i e  users who seem to travel a lot tend to be
friends  and those who mostly give reviews locally befriend
users who do the same  we also found that users tend to
be friends with users who share a similar latitude spatially 
also  the relative earliness of reviewing a business
compared to other users who reviewed a business was an
attribute that clustering occurred on  i e  hipsters tend to
group with other hipsters  and trend followers tend to group
with other trend followers   we also found smaller grouping
strengths based on users being elite or not  as well as
based on how useful a user typically is  this suggests to us
a possible link between the social network derived
attributes  and the ability to predict normalized usefulness
and elite status  since these attributes tend to cluster in
friend groups  therefore  information about the friend group
could be useful to predicting these attributes  we later find
this to be the case 

    users reviews  for each user  we started by making two
datasets  one with the top   given attributes  and one with
the top five given derived attributes  see table     we split
our datasets again into     training and     test  and then
did    fold cross validation doing both linear regression and
quadratic regression to generate mean squared error
results  see table     we found that we are able to get a
much better fit to our data using the dataset that included
the derived attributes  with better r   values  as well as
lower mean squared error  mse  on our test set 

linear and quadratic regression  results
table    regression results
data type
linear
reg

quadratic
reg 

r  

mse

given attributes

    

    

given   derived attributes

     

    

given attributes

     

    

given   derived attributes

     

    

figure    summary of regression analysis
figure    relative assortativity of attributes

predicting usefulness of a user
linear and quadratic regression 
methodology
we test supervised learning techniques to predict the
normalized review usefulness   useful review votes for user

feature selection
in order to choose only important features and avoid
overfitting  stepwise regression in both directions  which
includes both backward and forward regression was done 
as a metric to choose the best model akaike information
criterion  aic  and bayesian information criterion  bic 
were used  aic chose    out and bic chose    of total   
attributes  then linear regression was run  in fact  both
models showed similar performance and outperformed all
other models  figure    

 

filasso and ridge regression
another regularization methods that were used to avoid
overfitting by penalizing having many attributes in the
model  despite the fact that lasso model had fewer nonzero attributes  ridge regression showed almost the same
performance as stepwise regression models and
outperformed lasso regression  figure    

regression trees
regression trees was used  however it is a very
computationally expensive model  so parameters were
chosen heuristically  by making some optimization  optimal
parameters are bucket number       cp             split  
    however performance of regression trees was not
satisfactory  figure    

support vector machines  methodology
because we had limited success predicting the normalized
usefulness of a user when we treated the response as a
continuous variable  we changed approach  since it is most
interesting to identify users who have high normalized
usefulness  we decided to split along a quantile threshold
for normalized usefulness  for example  we assign a
response of   to users who had a usefulness above the the
  th percentile  and   to the rest  then we randomly
sampled from this data set to make test and training sets
that were composed of equal parts most useful     and
least useful      we made our training and test sets the
same size       users each   we then fit a svm model to
these datasets  using a linear kernel  which we found
worked the best   this was done with    fold cross
validation to get the error values shown  we repeated this
process for varying splits of the dataset along percentiles of
usefulness  which we plot below 

support vector machines  results
we found that we were able to get increasingly better
predictions of a users usefulness when we were trying to
predict for users that had higher normalized usefulness 
this suggests to us that the more useful users are better
separated from the rest  the figure below shows this
decrease of error in both the test and training sets when we
attempt to predict the more useful users 

conclusions
we began our project with the hypothesis that we might
be able to predict user characteristics  particularly
usefulness  by using derived attributes from review and
social graph information  cursory analytics like simple
correlations between variables showed us that these
derived attributes had higher correlations with usefulness
than many of the given attributes  more advanced
unsupervised learning methods like pca supported our
theory of gaining added value from these derived
attributes by showing us that these attributes explained
much of the variance in our data  in practice  the
application of using these attributes was modestly
successful  our linear and quadratic regression showed
that the attributes do indeed help us better predict
usefulness as a continuous variable  further  our svm
application showed us that some levels of usefulness are
easier to predict than others  our clustering and elite
classification experiments showed us that our data had
higher separability on compliments and elite status  both
of which are loosely associated with normalized
usefulness  we later confirmed by doing associativity on
our social network graph that the attributes that tend to
cluster users include normalized usefulness and number
of years being elite  suggesting a link between the
separability we find among elite   non elite users and the
influence of social network data in helping to predict
normalized usefulness  while being able to predict the
usefulness of a user is not a simple thing to accomplish 
we suggest through our statistical analysis  unsupervised
learning methods  and regression   classification
experiments that our network derived attributes might be
helpful in more accurately reaching this goal 

 

fi