automated detection   classification of arrhythmias

richard tang and saurabh vyas
dept  of bioengineering  stanford university  stanford  ca      
 rhtang  smvyas  stanford edu

abstract
there is a great clinical need for accurate detection and classification of cardiovascular arrhythmias  if arrhythmias are detected early enough  potential lifethreatening conditions  such as heart failure  can be successfully avoided through
therapies and interventions  an electrocardiogram  ecg  provides a surrogate
representation of cardiac activity  analysis of ecgs can allow for accurate classification of arrhythmias  we used the uci machine learning repository arrhythmia dataset to compare the effectiveness of four learning algorithms for arrhythmia classification  multinomial logistic regression  support vector machines 
linear discriminant analysis  and random forest  rf   in particular  we employed
a grouping paradigm to isolate features that are physiologically interconnected in
order to address the relative importance of each feature  using    fold cross validation  we found that rf performed the best with a detection performance  auc 
of        a mean f  score of               and an accuracy of              

 

introduction

heart failure is a leading cause of death worldwide in individuals above the age of     it is often
deadly  mortality rates include     in men and     in women within   years of diagnosis     
if the cause of heart failure is diagnosed from arrhythmias early enough  potential therapies and
interventions can often lead to good prognoses  and prevent death     
   

prior work and current objectives

there are a number of methods to detect and classify arrhythmias from electrocardiogram  ecg 
data  however  each method attempts to balance simplicity of implementation with accuracy  a
good review of many current methods is provided by acharya et al       in most machine learning
implementations  the key to good performance is inherently tied to the quality of the features used 
in this project  we assert that in order to successfully detect and classify the anomalous activity 
we must train the classifier to learn what is important  i e   the classifier must learn to differentiate
normal physiology from abnormal physiology  therefore  all features derived in this work are based
directly on cardiovascular physiology  furthermore  we derive five distinct groups of features from
the ecg data  sec       each with direct physiological relevance  using our derived features  we
train four different algorithms  sec       for the task of  a  automatic detection of arrhythmias from
ecgs acquired from patients in vivo  and  b  classification of arrhythmias into one of four broad
classes  sec        this is done on the university of california irvine machine learning repository
arrhythmia dataset     
   

brief review of cardiovascular physiology

the main function of the heart is to pump blood to the rest of the body  it accomplishes this by
using a complex electrical signaling cascade  when this electrical propagation cascade is modified 
it leads to an arrhythmia  these can range from benign irregularities in the heart rate or rhythm  to
 

fisevere disruptions that prevent the heart from contracting altogether  arrhythmias can be detected
using an electrocardiogram  ecg   an ecg provides an electrical readout of the hearts activity 
this is done non invasively by attaching a set of electrodes to the surface of the skin      a notional
ecg has five main features  and is termed a pqrst wave  figure   a b  show typical pqrst
waves  and describe their role in the cardiac cycle     

 a 

 b 

figure    a prototypical pqrst wave of an ecg  and its relevance to the cardiac cycle
and physiology  panels  a  and  b  were taken courtesy from http   intranet tdmu edu ua  and
http   csmbio csm jmu edu respectively 

 
   

methods
dataset and pre processing

the data represents     patients ecg  each is represented by     features  including amplitudes
and widths of each pqrst wave measured from    different channels  the data is publicly available at the university of california at irvine machine learning repository      the data was preprocessed to have zero mean  and unit variance  furthermore  the signals were de trended  using the
usual methods   and median filtered  using a    kernel   feature extraction is discussed next 
   

ecg feature selection

often the key step in most learning applications is deriving a robust and concise set of features 
in this project  we derived a total of     features from the ecg data  in particular  we extracted
features into one of five broad physiological feature blocks        features concerning biographical
characteristics  i e   age  sex  height  and weight        features concerning average wave durations of
each interval  pr interval  qrs complex  and st intervals         features concerning vector angles
of each wave         features concerning widths of each wave  measured from    channels  and    
   features concerning amplitudes of each wave  measured from    channels 
each algorithm was trained independently on each of the five feature blocks  the output probability
distribution of the model was weighted for each block  and then linearly combined to create the
final output model  the weights were learned using cross validation  e g   learned rf weights are
provided in table     note that this is not a majority vote scheme  actual class probabilities are
computed  weighted  and then combined  further note that we dont mix and match algorithms  this
is repeated separately for each model  figure   provides a visual representation of this paradigm 
   

learning algorithms employed

we start our analysis by using the multinomial logistic regression  mnlr  model  the traditional
model is implemented with standard parameters  next  we use the libsvm implementation of
support vector machines  svm       in particular  we modified the method to use a gaussian
radial basis function  with           where the hyperparameters were learned via cross validation 
we also optimized   the tolerance of the termination criterion   and   the rejection ratio   next 
we wanted to systematically do dimensionality reduction  so we implement a linear discriminant
analysis  lda  based downsampling scheme as a preprocessing step for svm  the typical model
is implemented  and we select the eigenvalues that capture     of the variance  learned threshold  
 

fitable    optimal weights for features
computed for the random forest model
weights
value
w    biographical
    
w    wave durations
    
w    vector angles
    
w    wave widths
    
w    wave amplitudes
    
figure    features are broken into   blocks  independently learned  then weighted and combined 
     

random forest

finally  we implement a random forest ensemble classifier  the typical model is implemented as
given in literature      the model works by continually sampling  with replacement  a portion of the
training dataset  and fitting a decision tree to it  the number of trees refer to the number of times the
dataset is randomly sampled  moreover  in each sampling iteration  a random set of features are also
selected  at the end  the trees are averaged together  this is broadly known as bootstrap aggregation
or bootstrapping  in decision trees  each node refers to one of the input variables  which has edges
to children for all possible values that the input can take  each leaf corresponds to a value of the
class label given the values of the input variables represented by the path from the root node to the
leaf node  the number of trees and the number of leaves are learned via cross validation 

 
   

results
arrhythmia detection

the first main objective of this project was to develop a system that could robustly detect an arrhythmia  figure   provides a roc curve for the detection of arrhythmias using each of the four
algorithms discussed in section    and table   includes the area under the curve  auc  metric for
each of the traces  note that the rf classifier  black trace  obtains an auc of        
table    area under curve  auc 
model
auc
mnlr
      
svm
      
svm lda
      
rf
      

figure    roc curves for arrhythmia detection using each model  rf  black  obtains best auc 
   

arrhythmia classification

the second objective of this project was to develop a method to robustly classify an ecg trace
into one of four broad arrhythmia class  we report our performance for each of the four methods
using two different methodologies  we show confusion matrices for each algorithm  as well as
compute accuracies and f  scores for each class  the confusion matrices for each algorithm are
provided in figure    note that the axes contain labels      normals      coronary artery disease     
myocardial infarctions      sinus arrhythmias  and     bundle branch blocks  each column of figure
  corresponds to a different algorithm  from left to right these include  mnlr  svm  svm lda 
 

firf  the first row shows confusion matrices for the training data  which will allow us to analyze
bias   and the second row includes the confusion matrices for the testing data  where we analyze
variance   the train test datasets were determined using k fold cross validation  k       
the f  score and the mean accuracy for each of the four algorithms is provided in table   for
each of the classes  the average f  score is simply the mean of the f  scores for each class per
algorithm  these results point to the rf classifier significantly outperforming the others in terms
of classification  to that end  we can compute roc curves for each of the four arrhythmia classes
using the rf classier  figure   contains the roc curves for each of the four arrhythmia class  the
title of each subfigure  as well as the caption of the figure  contains the auc value 
mnlr

svm

svm lda

rf

f 

accuracy

f 

accuracy

f 

accuracy

f 

accuracy

normal

    

    

    

    

    

    

    

    

coronary artery disease

    

    

    

    

    

    

    

    

myocardial infarction

    

    

    

    

    

    

    

    

sinus arrhythmia

    

    

    

    

    

    

    

    

bundle branch blocks

    

    

    

    

    

    

    

    

arrhythmia class

table    f  score and accuracy for each learning algorithm  best performance is colored in green 

 a 

 b 

 c 

 d 

figure    the figures in the top row are the confusion matrices for the training set  whereas the
figures on the bottom are the testing set  the columns correspond to different algorithms  from left
to right these are   a  mnlr   b  svm   c  svm   lda   d  rf 

 a 

 b 

 c 

figure    the roc curves for each of the four arrhythmia classes using the rf algorithm  the auc
values for the roc curves from left to right are                         and        
 

 d 

fi 

discussion and future work

it is clear from figure   and table   that the rf algorithm is capable of automatically detecting
arrhythmias with reliable accuracy  auc            furthermore  table   and figure   show that
rf consistently performs the best  mean accuracy        in terms of classification compared to the
other models  see green cells in table     our general approach in this project was as follows  we
started with mnlr and observed in   a  that it resulted in great bias in the training dataset  which
could not be ameliorated with feature engineering or parameter optimization  so we turned to svm 
and in particular gaussian rbfs operating in hilbert spaces  while this improved bias as seen in
  b   it was still below acceptable  and resulted in high variance and poor generalization error 
we observed that removing features  using a backwards elimination scheme  actually improved the
bias  this is expected given the fact that we have     features  total  before using our feature selection paradigm  therefore  we tried using lda to automatically pick optimal features  while
this reduced the bias in the train set  it still suffered from high variance as seen in   c   ultimately 
rf performed the best across the board  we posit that this has to do with its bootstrapping procedure  which reduced the overall variance of the model  each iteration of the rf algorithm operates
on a slightly different  random  training set  and a slightly different  random  set of features  this
causes the trees to inherently become uncorrelated and while each tree individually has very high
noise variance  when they are all averaged together  it leads to an overall reduction of model variance  it would be interesting to see if bootstrapping can be incorporated within svm lda 
we feel the biggest  and perhaps  novel aspects of this work are in the feature selection step  there
are several papers that train independent models on pieces of the data  followed by a nearestneighbor voting scheme to select the final output  we go a few steps further and     actually learn
weights for each of the feature blocks  and  b  look at the raw probability outputs and combine them
and use those to make the final decision  this argument is supported by the fact that if we merely
use all the features  the algorithm perform significantly worse  note  the algorithms also do worse
if all weights are chosen to be the same  therefore  it seems each block makes an unequal  yet
unique contribution to the net result  furthermore  our features in and of themselves are clustered
in a physiologically desirable way  which makes computing weights for them more physiologically
meaningful  for example  it is not surprising to learn that the amplitudes of the ecg components is
more important  w         than biographical information  such as age and gender  w         
the real prize however lies in our follow on work  we will attempt to probabilistically combine
models  it is not clear how one can easily combine the probability outputs from different algorithms  as each are drawn from a different distribution  however  this might be a fruitful endeavor
as svm lda performs well in some cases  e g   coronary artery disease   which could help the
overall accuracy  finally  a note on run time  the models implemented here run in matlab r    a
on a dual core laptop with  gb of ram in less than one minute on the full dataset  sec       

references
    acharya  u r   joseph  k p   kannathal  n   lim  c m   suri  j s   heart rate variability  a
review  medical and biological engineering and computing                        
    ashley  e a   niebauer  j   cardiology explained  remedica       
    bache  k   lichman  m   uci machine learning repository         http   archive ics 
uci edu ml
    chang  c c   lin  c j   libsvm  a library for support vector machines  acm transactions
on intelligent systems and technology                      software available at http   
www csie ntu edu tw cjlin libsvm
    dean  j   lab  m   arrhythmia in heart failure  role of mechanically induced changes in electrophysiology  the lancet                           
    kannel  w b   belanger  a j   epidemiology of heart failure  american heart journal        
             
    liaw  a   wiener  m   classification and regression by randomforest  r news                  
    walraven  g   walraven  g   basic arrhythmias  brady communications company       

 

fi