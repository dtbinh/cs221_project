chemical identification with chemical sensor arrays
quintin stedman
introduction
an electronic nose composed of small 
inexpensive chemical sensors would have many
potential applications in areas such as breath analysis 
hazardous gas detection and industrial process
monitoring  an electronic nose  in anology to a
biological nose  consists of an array of non specific
chemical sensors  with pattern recognition  the
system can recognize individual chemicals or scents 
capacitive micromachined ultrasonic transducer
 cmut  chemical sensors are a particularly
promising chemical sensor technology  they are
micromachined devices  so they can be inexpensively
batch fabricated  in addition  they have extraordinary
sensitivity  a limit of detection of      parts pertrillion  ppt  and sensitivity of      ppt hz to
dmmp  a sarin gas simulant have been demonstrated
     in this work  i demonstrate the application of
machine learning to an array of four cmut chemical
sensors to discriminate between six different
chemicals present in low concentrations in nitrogen 
typically  only the equilibrium response of
chemical sensors is used in chemical identification  i
show that using the response of the sensor over time
provides extra information that improves
classification performance 
i also study the robustness of the system with
respect to variations in sensor sensitivity  and test its
ability to determine the concentration of the detected
chemical once it is identified 
the data used in this work has been previously
been shown at a conference  with some machine
learning tested on it      but the feature selection and
machine learning work in this paper is new  and
shows significant improvement over the previous
results 

figure    sensor response to      ppm acetone

where f is the plate frequency  f is the change in
frequency  m is the effective mass of the plate and
m is the change in effective mass 
in this work  an array of   cmut chemical
sensors was used as an electronic nose  three of the
chips were coated with different polymers and one
was left uncoated  sensors on different chips were
used to make the polymer application easier 
    chemical detection experiments were
performed with   different chemicals diluted to    
in nitrogen  these are summarized in table    the
devices were placed in a small test chamber  nitrogen
was flowed through the chamber for    seconds 
then  the chemical of interest was flowed through the
chamber diluted in nitrogen  maintaining the same
flow rate as for the pure nitrogen  finally  pure
nitrogen was flowed through again until the sensors
returned to equilibrium  the frequency of each sensor
was recorded over time throughout the experiment 
the data from one of the experiments is shown in
figure   
table    summary of chemical identification
experiments

data set

chemical

a cmut chemical sensor consists of a
conductive plate over a vacuum cavity  the device is
actuated electrostatically by applying a voltage
between the plate and the substrate  the top of the
membrane is coated with a sorbent coating 
chemicals in air absorb into the coating  increasing
the mass of the plate and thus decreasing its resonant
frequency according to

methane
carbon dioxide
water
ethanol
acetone
ethyl acetate

    

 

concentrations
tested
       
         
      
      
        
        

number of
measurements
  
  
  
  
  
  

fifeature selection

models

some pre processing was done on the data
before extracting the features  first  linear regression
was used to remove drift  the frequency of the
sensors can drift slowly over time due to variations in
room temperature  pressure or due to electrostatic
effects in the devices  to remove this  linear
regression is performed to the first    seconds and
last    seconds of the data  and the resulting fit is
subtracted from the data 
next  the portion of the data where the chemical
is present is selected  i omit the first   seconds of
data after the chemical turns on  the test chamber
takes about   seconds to purge  so the first few
seconds of data may contain features that are a result
of the way the chamber fills rather than the true
responses of the sensors to the chemical 
the sensor system cycles through the four
sensors  recording the frequency and the time of
measurement for each one sequentially  a data point
is obtained roughly every   second for each sensor 
but the time between measurements is not precisely
uniform  i used locally weighted linear regression to
estimate the frequency at the precise times i wish to
use as features  i used a gaussian weighting function
and a bandwidth parameter of      s 
i used two different set of feature sets in this
work  corresponding to two different types of sensor
operation  in the first data set  i used only the final
frequency shift of the sensor just before the chemical
turns off  this corresponds to a situation where the
sensors are continuously exposed to chemicals and
we use the equilibrium response of the sensors to
identify them  in some linear models  i also use the
squares of the final response as features in order to
capture the small non linearity of final response as a
function of concentration 
in the second data set  i estimated the frequency
every   seconds  this corresponds to a sniffing
chemical sensor system where the sensors are
presented with the sample at a known time  in this
situation  we can use the time dependent response of
the sensors to the chemicals  giving us extra
information that allows better identification
performance than we can get from the equilibrium
frequency shifts alone 
finally  i divide the sensor responses by the
average equilibrium response of all the sensors to that
chemical  this is to ensure that the algorithms cannot
cheat by using the fact that different chemicals
were presented at different concentrations  this also
has the advantage of making the features roughly   or
less  which tends to make the models easier to train 

classification
four models were used for chemical
classification  logistic regression  support vector
machine  svm  with linear kernel and support vector
machine with gaussian kernel 
the liblinear software package     was used
to implement of l  regularized logistic regression
was used  multi class classification is done using a
one vs rest approach  the regularization parameter
was chosen by testing a range of values and choosing
the one which maximized performance on the test
data 
the liblinear software package was also
used to implement an l  regularized linear kernel
svm  again  the regularization parameter was
chosen to give the best performance on the test data 
the libsvm software package     was used to
implement the gaussian kernel svm  the gaussian
variance   was chosen jointly with the regularization
parameter to give the best performance on the test
data 
the final classification algorithm tested was a
feedforward artificial neural network trained with
backpropogation  in this algorithm  nodes are objects
with a sigmoid transfer function 
    

 
     

the nodes are organized into layers  the input layer
has one node for every feature  and each node outputs
the value of the feature  each node in the first hidden
layer receives a linear combination of these outputs 
each subsequent layer receives a linear combination
of the outputs of the previous layer  the last layer
 the output layer  has one node corresponding to each
category  the network is trained so that the output
nodes output   if the inputs correspond to their
category and   otherwise  the network is trained by
minimizing the error of the network using the
backpropogation algorithm  i used a network with
one hidden layer  and used regularization to prevent
overfitting   the number of nodes in the hidden layer
and the value of the regularization parameter were
chosen to give the best performance on the test data 
it is important to note that optimizing a neural
network is a non convex problem  so it is possible for
it to get stuck in local minima 
concentration determination
once the chemical is identified  it is useful to
determine its concentration  by plotting the final

 

fifrequency shifts of the sensors versus concentration 
it can be seen that the final frequency shifts are a
slightly nonlinear function of concentration  since the
dependence of the frequency shift on concentration is
so clear  we do not need a complex model  i chose to
use linear regression  with the final frequency shifts
and their squares used as features  the inclusion of
the squares captures the non linearity 
the amount of data for each chemical is small 
so to avoid overfitting i used weight decay      with
weight decay  the linear regression cost function is

shows the performance using the equilibrium
frequency shifts  the algorithms were tested using
leave three out cross validation 
table    performance of classification algorithms
model
logistic
regression
svm  linear
kernel
svm  gaussian
kernel
neural network
logistic
regression
svm  linear
kernel
svm  gaussian
kernel



 


               
 
 
  

where i indicates the training example  y is the
concentration  x is the features and  is the
parameters    is defined to be the parameter vector 
with the parameter corresponding to the offset term
removed  i use   rather than  so that the offset term
is not penalized for being large  the regularization
parameter  was chosen to minimize the test data
error 

neural network
logistic
regression
svm  linear
kernel

sensitivity variation

features

training
accuracy

test
accuracy

full response

     

     

full response

     

     

full response

     

     

full response
final
response
final
response
final
response
final
response
final
response and
squares
final
response and
squares

     

    

     

     

     

     

     

     

     

     

     

     

     

     

concentration determination

the sensitivity of the sensors may vary for a
number of reasons  the sensitivity may drift as the
sensors age  i the manufacturing process  the
thickness of the chemical sensitive layers will have
some variation  and it would be advantageous not to
have to calibrate every sensor individually  to study
this problem  i varied the sensitivity of the sensors
and calculated the effect on classification
performance  the sensitivities of sensors     were
multiplied by a factor drawn from a normal
distribution with mean   and variance     was
varied from   to     to simulate different severities of
sensor variation  the system was trained on the
uncorrupted data using the parameters obtained by
optimized test data performance  for each value of  
     experiments were simulated  the results are
shown in figure    the sensitivity of sensor   was
not varied since it has no chemical sensitive layer
deposited on the surface and thus should show very
little aging or manufacturing related sensitivity
changes 

table   shows the results from for concentration
determination  testing was done using leave oneoutcross validation 
table    performance of linear regression for
concentration determination
chemical
methane
carbon dioxide
water
ethanol
acetone
ethyl acetate

rms training
error
     
    
    
    
    
    

rms test error
     
    
    
    
    
    

robustness to sensitivity variation
the results of the sensitivity variation
experiments are shown in figure    of the algorithms
that used the full response  the gaussian kernel svm
showed the most robustness to sensitivity variations 
of the algorithms using the final responses  the linear
kernel svm with the squared responses included as
features showed the least reduction in sensitivity 
however  the gaussian kernel svm showed higher
performance with uncorrupted data  so  the gaussian
kernel svm gives the best performance for small
amounts of sensitivity variation while the linear svm

results
classification
table   shows the training and test performance
of the algorithms tested  the svm worked well with
both a linear kernel and gaussian kernel  table  

 

fifigure     performance of chemical classification algorithms as sensitivity variation increases

with squared features gives the best performance for
larger sensitivity variation 

likely due to the fact that the sensor responses are
mildly non linear with respect to concentration 
when the sensors are uncorrupted  the linear models
can find decision boundaries that separate the data
since the nonlinearity is not too large  but the margin
is not as large as it can be with a non linear model 
in general  the concentration was determined
reasonably accurately  with the worst performance
being for methane and carbon dioxide  this is not
surprising since these chemicals produced relatively
small responses from the sensors at the
concentrations tested 
while these results demonstrate that it is
important to consider sensor degradation  they do not
necessarily mean that the algorithms that were most
resistant to sensitivity variation here will be the most
resistance to sensitivity variation in all circumstances 
it may be that if more training data is available  more
complex models like the neural network perform
better while with less training data simpler models
such as logistic regression may be superior 
determining the concentration of the chemicals
once they were identified worked well  the physics
of the sensors means that the responses will increase
smoothly and monotonically as the concentration
increases  examining the data  it could be seen that
the data did not look exactly like this and that there
was some noise due to sensor error  so  the current
limiting factor on the concentration measurement

discussion
when the full sensor responses were used 
excellent classification performance was obtained
from the linear kernel svm  gaussian kernel svm
and neural network  when only the final responses
were used  good performance was obtained from the
gaussian kernel svm  the linear kernel svm with
the squared responses included  and the neural
network  performance was better when the full
response was used  this demonstrates that
incorporating the extra information from the timedependence of the response can improve performance
of the sensor network 
different models showed different robustness to
sensor variation  although neural networks
performed excellently on the uncorrupted data  they
generally showed worse performance with aging than
the svm models  it makes sense that the svms are
less susceptible to aging since they are optimal
margin classifiers and thus place their decision
boundaries as far as possible from the data points 
for this data  it is also important that the model by
non linear  the linear kernel svms did not perform
well in the presence of sensor variation even though
they performed well on the uncorrupted data  this is

 

fiaccuracy is most likely the sensors and not the
regression algorithm 

references
   k  k  park  h  j  lee  g  g  yaralioglu  a  s  ergun  o 
oralkan  m  kupnik  c  f  quate  b  t  khuri yakub  t 
braun  j  p  ramseyer  h  p  lang  m  hegner  ch  gerber 
and j  k  ginzewski  capacitive micromachined ultrasonic
transducers for chemical detection in nitrogen  appl  phys 
lett   vol      pp               

conclusions
i successfully demonstrated the ability of several
machine learning algorithms to classify chemicals  i
showed how using the time dependent response can
provide improved performance compared to using
just the final  equilibrium responses  additionally  i
illustrated that it is important to consider drift in the
data when choosing machine learning models  if drift
may be present  some models may perform well with
perfect data  but perform much worse when the data
is flawed  for this problem  neural networks appear
very promising based on their performance on
uncorrupted data  but they are much less robust to
sensor variation than some of the svm models  this
fact  combined with the fact that neural networks are
trickier and more time consuming to optimize  makes
svms the better choice for this problem 

   h  j  lee  k  k  park  m  kupnik  o  oralkan  and b  t 
khuri yakub  chemical vapor detection using a
capacitive micromachined ultrasonic transducer  anal 
chem   vol      no      pp                  
   r  e  fan  k  w  chang  c  j  hsieh  x  r  wang 
and c  j  lin  liblinear  a library for large linear
classification  journal of machine learning research vol 
        
   c  c  chang and c  j  lin  libsvm   a library for
support vector machines  acm transactions on intelligent
systems and technology  vol      no          
   h  j  lee  k  k  park  m  kupnik  n  a  melosh  and b 
t khuri yakub  mesoporous thin film on highlysensitive resonant chemical sensor for relative humidity
and co  detection  anal  chem   vol      no     pp                 

future
in this work  i was able to find models that were
very effective at chemical classification and
concentration determination  to improve the
performance of the system  the next step will be to
improve the sensors and collect more data 
the polymer coatings used as chemical sensitive
layers for the devices in this work were not optimized
for this chemical identification task  in future  i plan
to try a larger set of coatings  including ones tailored
to strongly absorb specific chemicals of interest  it is
not possible to design perfectly selective coatings 
but selectivity can be improved by engineering the
coatings for the desired task      feature selection
could be used to find the optimal set of sensors for a
given task 
in this work  the sensors only had to deal with
single chemicals  in future  i plan to test the system
on mixtures of chemicals  the difficulty of the
problem will depend on whether the response to
multiple chemicals is equal to the sum of the
responses to the chemicals individually  or if there
are interaction effects 
another type of application i hope to try is using
a sensor array to distinguish complex scents  for
example  chemical sensors have been used to
distinguish between people with lung cancer and
healthy controls     

   g  peng  u  tisch  o  adams  m  hakim  n  shehada  y 
y  brova  s  billan  r  abdah bortnyak  a  kuten  and h 
haick  diagnosing lung cancer in exhaled breath using
gold nanoparticles  nature nanotechnology  vol     no     
pp                
   c  m  bishop  pattern recognition and machine
learning  new york  springer        pp          
   q  stedman  k  k  park  and b  t  khuri yakub 
 distinguishing chemicals using cmut chemical sensor
array and artifical neural networks   presented at the
ieee ultrasonics symposium  chicago  illinois  sept      
     

 

fi