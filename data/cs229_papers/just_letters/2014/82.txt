two step semi supervised approach for music structural classification
prateek verma  yang kai lin  li fan yu
stanford university
abstract
structural segmentation involves finding hoogeneous sections
appearing in a song  the name of these sections depends on
the genre of interest  the task is particularly challenging as
each of the misclassifed labels gives spurious change points 
we have proposed a two step method by finding the boudaries
present in the song followed by segment labelling  novel idea
of transforming the features into posteriori space using unsupervised model fitting is elucidated along with interesting behaviour of increasing the mixtures in gmm  advanced techniques such as hidden markov model is also shown to give
reasonable results for the task of boundaries detection  finally the task of labelling the segments within the detected
boundaries are carried out unlike the existing methods which
give labels such as a  b  and c  the results are presented for
boundary and segment level evaluation 
   introduction
given a song the task of structual segmentaiton is to identify the structure appearing within a song  this is an interesting problem as this information is not given either in the cd
metadata or can be derived from artist or song name  usually
the genre  style information can be extracted to a large extent
by the artist name or meta data information 
apart from applicability to music recommendation systems  this will help in automatic music summary generation
too  for some of the music selling companies  they generally give a small manually generated preview of the song for
a user to buy  however it is difficult to do this for millions of
the song  our system will help in summary or preview generation of the song by learning the structure present in the song
along with the type of sections 
due to the challenges involved and wide spread applicability  this task is part of mirex contest for the past   years 
various approaches have been tried and a standardized dataset
of beatles song is available for comparison of results of various researchers  the approaches used in the mirex contest
are mainly carried out using distance matrix novelty score approach in order to get the boundary  due to the difficulty of
the task  most of the work has been confined to labelling the
structure in the song as a  b  and c instead of the actual labels
of the song 

in this work  we want to implement an approach to classify the actual labels of music sections we have proposed a
two step approach by first trying to find the boundaries present
in the song  after finding the boundaries  the segment between the boundaries are classified  for boundary detection 
we have taken advantage of unsupervised clustering methods
such as gmm and hmm which can use a lower dimensional
feature space to accurately find the structure in the song  posteriori transformed features proposed are robustness to the
noisy feature space  we have also achieved fairly decent accuracy in terms of segment level performance 
the contributions of our work is as follows  first  novel
usage of transforming the features to posteriori probability
features and application to segmentation task of western music  second  behaviour of posterior features when a high
number of mixtures are used to bring out repetitive segments 
third  labelling the segments into the corresponding labels
instead of giving the labels like a  b  and c and achieving
comparable results 
   dataset
the dataset chosen for this task was     songs released by
beatles  the annotations were downloaded from the mirex
website  and since due to copyright issues the audio files were
not available  we manually downloaded all the songs from
youtube  the dataset consists of a total of        sec of
audio files  the sections are labelled as intro  chorus  verse 
outro  refrain  and others as six classes 
   system overview
fig    shows the simple diagram of the proposed system  in
our task  we must first know where the different music structures are  and then we can treat each section as individual
event for our classification problem  thus  our system is a
two step system including  first  the boundary detection  unsupervised  module and  second  the structural classification
 supervised  module 
in detail  first em algorithm is used to compute the parameters followed by posteriori features computation and boundary detection by novelty score computation 
another approach to predict the boundary is by assuming that the temporal features are the outputs from a discrete

fifig     system diagram of the proposed system 

fig     harmony  chroma  and timbre  mfcc  features for
unsupervised boundary detection 
mony and the timbre of the sound 
however once we have generated the boundaries  for the
task of labelling the segments  these features are not sufficient  the small set of features are helpful to cluster within
the song but not across all the songs for labelling the segments  hence we extract a very high number of features
which can characterize and represent the segment labels 

fig     flow diagram of the boundary detection module using
gmm 
markov process  which forms a hidden markov model  the
parameters can be trained by the features  and the resulting
state transition sequence can be used to determine the boundaries 
with the boundary detection results  we can move on to
extract high level feature for each sections segmented by the
boundaries  finally  with the section level feature  the liblinear library and libsvm library     is employed for
training svm models 
   feature
     low level feature
for our task as it is two step approach  we describe two sets
of features  for unsupervised clustering used in the first step 
we do unsupervised maximum likelihood estimation on the
features for clustering to identifying distinct changes occurring in the song  for this  the harmony based and timbral
based features are sufficient enough to capture musically similar sections  the features we used for timbral description
is the mel frequency cepstral coefficients  given an audio
waveform we obtain spectrogram by taking stft 
the parameters used in our analysis are     s hop with
    s frame for the computation of the above features  we
then apply a texture window sampled at    s with texture
frame of  s  this is mainly done to obtain a better homogeneous representation of the audio and remove the noisiness
present in the features  fig    shows the decomposition of
audio into the features desired by us which represent the har 

     high level feature
for supervised classification used in the first step  we consider
a number of baseline approaches for comparison  first  we
use the mirtoolbox  version            to compute a    features covering the temporal  spectral  cepstral and harmonic
aspects of music signals  denoted as timb   second  the conventional mfcc   delta mfcc and  delta  delta mfcc are
also used for their popularity  denoted as mfcc   third  we
augment mfcc and timb by calculating the mean  variance 
and standard deviation over the local frames  finally  we perform early fusion on mfcc and timb  i e  by concatenating
the corresponding clip level representations to form a longer
feature vector  to get our final feature  by doing so  we get
a     dimensional high level feature vector which represents
various properties  similar feature is used in     and considered to be very competitive for capturing every nuance of
music signal  in our task  the structures of music is very complicated due to the variability from one song to another  hence
we consider this high level feature vector to be a good choice
for our task 
   first step i  boundary detection using
gmm
in literature  methods largely follow novelty score  self distance matrix  sdm  computation for a particular song     
on a set of features  a self distance matrix is computed whose
 ith  jth  entry corresponds to the distance between the ith and
the jth feature vector  for correct feature set block structure
appears in the sdm corresponding to the homogeneous segments in the song  a kernel is convolved along the diagonal
elements of the sdm to obtain the change points and the value
obtained is called as novelty score 

fifig     emergence of diagonals in the posteriori sdm for
high number of mixtures 
fig     comparison of feature left  and posteriori feature
sdm right  with the computed novelty score shown below 

diagonals were starting to emerge in the posteriori sdm
even though they were not evident in the feature sdm when
we increased the number of mixtures  as shown in fig     the
it was seen that the computation of novelty score in the
appearance of diagonals in the sdm tells us about the repeatfeature space was very noisy and we see a lot of spurious
ing sections present in the song  for smaller mixtures these
peaks in the novelty score  as shown in fig     this can be
would appear as blocks if the number of mixtures chosen is
accounted for by the fact that some of the feature values are
larger than the number of sections present in the song  when
noisy which result in high value in the distance calculation in
we increase the number of mixtures  the block sizes appearsdm  this motivated us to explore the idea of mapping the
ing in the main diagonal reduces and will give much better
features into posteriori features as done previously in some
temporal resolution  there will exist an optimum number of
speech recognition based applications  we present a methodmixture as very few mixture will model two or more section
ology derived from speech processing applications to address
together whereas higher mixtures will result in splitting up
this problem by mapping the feature vector space to a posthe section into one or more  thus reducing the precision of
teriori vector space  the difference between the approach in
the boundary detection task  the intra segment splitting for
our case is that we do an unsupervised gaussian parameter
higher mixtures was validated as there was little change in the
estimation 
   
   
 m 
recall rates on increasing the number of mixtures  the numlet x    x   x        x   be the features  where
 i 
n
ber of mixtures were finally chosen to be   empirically giving
x  r and i              m  assume that
pnthe distribution
 i 
 i 
of x is gaussian mixture  i e   p x     j   wi f  xi   j   j    the best performance as recall        precision         and
f score        for the boundary detection task with a tolerwhere n is the number of mixture  j   j are the mean
ance of  s  the performance reported by     is given as recall 
and covariance matrix with respect to mixture j  we as       precision      and f score        which is only clustersume that j is a diagonal matrix for simplicity  f    is
ing of segments instead of classification in our case  
the probability density function  pdf  of the multivariate
as we increase m smaller and smaller clusters starts formgaussian distribution with dimension n  the em algorithm
ing 
now if we have the same smaller section present elseis then used to derive the parameters   q w      that
m
 i 
where
in the song too  the cluster will model it perfectly givmaximizes the likelihood function l     i   p x     
t
t
ing
low
value of distance at that instance giving rise to a diagwhere w    w  w     wn                n       
t
onal 
posteriori
features also help us in improving the contrast
        n     after deriving   it can be considered as
of
the
repetitions 
if the features are differing slightly  it will
mapping the features x to the posterior probability space
       
 m 
 i 
n
lead
to
them
belonging
to different clusters when the numpf    p   p        p    where p  r   furthermore 
 i 
   
   
 n   t
ber
of
mixtures
is
large 
and thus the distance between them
we have p    p c    x  p c    x      p c    x     
will
get
amplified
in
the
posteriori
space as opposed to feature
where ci are the i th mixture of gmm 
space 
now after computation of posteriori feature sdm we observe that the novelty score is much better in terms of disfurther the number of repetitions can be estimated accucrimination of section  it is seen that the posteriori features
rately by looking at the sdm matrix  we treated this similar
are more robust to noisy fluctuations  the outliers present
to mnist challenge  images  numbered label   we were able
in the feature space get mapped to uniformly low conditional
to predict with an error of     the number of repeated secclass probabilities  in case of feature space these get mapped
tions occurring in a song using a quadratic gaussian discrimonto non uniform distances depending on the feature value 
inative classifier  to do this  each of the sdm was converted
thus distances in posteriori probabilities vector space can be
into a matrix of       the dimension of such a large feaexpected to be much more uniformly dependent on the undertures were reduced using principal component analysis as the
lying musical segments thus forming honogenous blocks in
data was actually residing in a lower dimensional space     
sdm 
features accounted for       variance of the data 

fifig     example for the state transition sequence with   states
of a given song  the bule lines are the ground truth of the
boundary location 

   first step ii  boundary detection using
hmm
     methodology
an alternative unsupervised machine learning approach we
used in boundary detection is the hidden markov model
 hmm   hmm assumes that the system is a markov process
with unobserved states  markov process assumes that the current state only depends on the previous state and independent
of any other state  which approximates the music temporal
characteristics well  the state is not directly observable  thus
hmm parameters  transition probabilities and emission probabilities with respect to each state  can only be derived from
the observable output  which depends on the underlying state 
in the boundary detection task  we assume that the output is
a single gaussian distribution  the observable outputs are
the feature of each time frame  and the state transition corresponds to the segmentation boundary  the state itself only
presents the homogeneity within the segment  em algorithm
is used to determine the hmm parameters  and the viterbi
algorithm is then used to derive the state transition sequence 
if the current state is the same as the previous state  the current and previous time frame are in the same segment  if state
transition occurs  the boundary is predicted to occur between
the time frames  an example for the state transition diagram
is shown in fig    

     experiment setup
for the hmm  only mfcc in the gmm    dimension features is used since it has higher homogeneity within each segment  the parameters through em algorithm are derived by
using the pmtk  library  after deriving the boundary by the
proposed algorithm  any boundary occurs after the previous
one in less than   seconds is omitted in order to prevent overfitting  the time interval is chosen to be   due to the   second
tolerance we use to evaluate the performance 

fig     the performance of the boundary detection with respect to the number of states  f score reaches its maximum at
  states 

linear
rbf

gmm
    raw     pca
    
    
    
    

hmm
    raw     pca
    
    
    
    

   
    

table    the f score of the classification result  note that
   s task is only clustering of segments instead of classification in our case 
     experiment result
as mentioned in the gmm part  for the boundary detection
task  higher recall is preferable since the result is to be used
in classification task  which is less sensitive to the overfitting  from fig     it can be seen that the number of states is
the parameter actually affects the performance  by choosing
larger number of states  recall will be higher  it is due to the
fact that larger number of states implies that the number of
segment with different characteristics are larger  which will
result in larger number of predicted boundaries  the precision decreases with the increase of recall  which is a typical
trade off  f score reaches its highest value when the number
of states equals   
   second step  structural classification
using svm
     methodology
support vector machine  svm  is a well known supervised
machine learning algorithm for classification and regression
analysis  in particular  svm makes use of the kernel trick
which implicitly maps the input feature to a high dimensional
feature spaces efficiently  in our case  the physical meanings
behind different music structure are usually implicit in music signals  and the difference between different structures is
difficult to annotate in various situation  thus  we consider
svm to be a suitable algorithm for our task because it takes
account of the implicit pattern lying behind the input feature 
which may help us with this complicated task 

filinear
rbf

non
    
    

man
    
    

euc
    
    

zsc
    
    

results for testing  shown in table    our best result       
comes from using gmm for boundary detection  pca with
    components  and svm with rbf kernel  which are all
the best parameters found in previous experiments 

table    results f score  of different normalizations 

linear
rbf

no pca
    
    

         
    
    

         
    
    

         
    
    

table    result of different pca components 
     experiment setup
the features are extracted based on the ground truth annotations for training examples and boundary detection results for
testing examples  the length of each feature is from  s to   s 
to prevent overfitting  we adopt   fold cross validation  cv 
and leave one out cross validation  for all the fold partitions
in   fold cv  we make sure the distribution of sections over
different structures is balanced  and support vector machine
 svm  with linear or rbf kernel is used for classification 
note that we dont have to perform feature pooling because
there is only one     dimensional feature vector for each section as described in section   
     experiment result
to ensure we use our feature properly  we have to find a good
normalization method on the feature for our task  this part
is implemented off line with all the features extracted based
on the ground truth annotations  table   shows the results in
f score  we can see that among z score  euclidean distance 
manhattan distance  and no normalization  z score normalization gives us the best results  where the result can be improved
from      to       this conforms to our expectation because
in our high level feature vector  every dimension represents
different physical meaning and the unit of measurement also
differs a lot  so some of them may be ignored because of the
huge difference of magnitude  thus  it is useful to apply zscore normalization so that each feature dimension has zero
mean and unit variance  we then apply z score normalization
to all the remaining experiments 
we also tried the use of pca in off line experiment  the
    dimensional feature we use is a large combination of different raw features  so it may be useful to apply pca to refine
it  table   shows the results of using pca with different number of components in terms of f score  we can find that using
    components gives us the best result improved from     
to       thus  we would also try pca with     components
in the remaining experiment 
finally  we perform structural classification using the
ground truth annotations for training and boundary detection

   conclusion
we have successfully demonstrated a novel technique based
on a two step appraoch by combining supervised and unsupervised algorithms for finding structure present in a song  posterior feature mapping is an interesting idea which has been
shown to be more robust to feature noise  such an transformation can be applied to other machine learning tasks that
deal with noisness in data  further in order to increase precision of the results further  other change detection techniques
such as bayesian information criteria can be combined to give
better results  hidden markov model based technique which
takes into account the transitional probabilities as well during
the training was demonstrated to be successful in the task of
boundary detection  boundaries derived from unsupervised
posterior feature based approach was found to give better results as compared to hmm based approach both in terms of
boundary f score performance as well as segment level performance  in future this framework can be applied to pca reduced features as well as after application of feature selection
techniques  for the task of assignment of labels to a particular
segment  sparse coding and deep learning based techniques
can be tried in future 
   references
    c  c  chang and c  j  lin  libsvm  a library for support vector machines       
    o  lartillot and p  toiviainen  a matlab toolbox for musical feature extraction from audio  in dafx       
    l  su l  f  yu and y  h  yang  sparse cepstral and
phase codes for guitar playing technique classification 
in proc  ieee  int  conf  acoustics  speech   signal processing       
    ewald peiszer  thomas lidy  and andreas rauber  automatic audio segmentation  segment boundary and
structure detection in popular music  proc  of lsas 
     
    mark levy and mark sandler  structural segmentation of musical audio by constrained clustering  audio  speech  and language processing  ieee transactions on  vol      no     pp               

fi