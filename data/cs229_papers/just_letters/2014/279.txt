characterizing  atrial  fibrillation  burden  for  stroke  prevention  
lichy  han  
  
atrial  fibrillation   af   is  an  arrhythmia  that  is  common   affecting  nearly     million  in  the  us   
although  af  is  known  to  cause  stroke   conventional  biostatistical  approaches  have  failed  to  
robustly   predict   stroke   from   continuous   af   burden   data    i   explored   stroke   prediction   from  
af  patterns  by  using  supervised  machine  learning  in  a  large  cohort  of  cardiac  implantable  
electronic  device  patients  remotely  monitored  in  the  veterans  administration  health  care  
system   af  burden  in  the      days  prior  to  ischemic  stroke  in  cases  were  compared  to  the  
first        days   of   monitoring   in   matched   non stroke   controls   using   a   variety   of   processed  
feature   sets    the   best   performing   set   and   test   combination   was   then   used   to   identify   the  
optimal  number  of  days  to  analyze   using  dynamic  time  warping  with  k nearest  neighbors  
on   a   time   interval   of        days   was   found   to   be   the   highest   performing   based   on   a   f   
measure   of   nearly          specificity   of           and   training   and   test   errors   of   roughly          
demonstrating  that  this  still  remains  a  challenging  problem  in  time  series  classification   
  
and   stroke    using   time   series   analytical  
introduction  
atrial   fibrillation    af    and   atrial   flutter   are   techniques  and  supervised  machine  learning   
arrhythmias  of  the  atria  that  are  known  to  be  a     
cause   of   ischemic   stroke   when   present   in   the   methods  
left   atrium    af   is   exceedingly   common    and   study  subjects  
resulting   strokes   can   be   prevented   with   a   total   of          patients   from   the   veterans  
proper   management   and   anticoagulation    administration   health   care   system   were  
however    though   atrial   arrhythmias   are   enrolled  in  this  study   and  all  patients  enrolled  
common    not   all   of   them   lead   to   thrombotic   gave   written    informed   consent   prior   to  
events  such  as  stroke   and  it  is  not  known  yet   entering   the   study    patients   had   either   an  
what   the   treatment   threshold   for   atrial   implantable   cardioverter   defibrillator   or  
fibrillation  should  be   af  is  thought  to  increase   pacemaker   with   an   atrial   lead    remote  
the   risk   of   stroke   by     fold    and   strokes   as   a   monitoring   using   the   atrial   lead   from   these  
result   of   af   are   thought   to   be   more   harmful   devices  reported  the  number  of  seconds  of  af  
than  strokes  not  associated  with  af      at  the   a   patient   had   per   day    also   known   as   the   af  
same  time   it  is  not  known  if  there  are  changes   burden    the   mean   follow up   was         days   
that   happen   to   the   pattern   and   amount   of   af   with   the   maximum   at          days    remote  
prior   to   stroke    identifying   such   patterns   monitoring   was   terminated   in   the   event   of  
would   allow   for   improved    real time   patient  death   patient  censoring   or  stroke     
prediction  of  stroke  and  affect  anticoagulation   data  preprocessing  
strategies   for   af   patients    classically    it   is   patients   who   had   an   ischemic   stroke   were  
thought   that   any   amount   of   af   will   increase   matched  to  a  control  patient  based  on  several  
the  risk  of  stroke   and  previous  studies  such  as   clinical   variables   including   gender    history   of  
the   assert   trial   showed   a   correlation   myocardial  
infarction   
heart  
failure   
between   subclinical   af    af   lasting   at   least       hypertension   diabetes  mellitus   and  other  co 
minutes   and  stroke      in  this  study   i  further   morbidities    scores   on   the   selim   comorbidity  
explore  the  temporal  relationship  between  af   index  and  the  charlson  comorbidity  index   and  

fithe   chads    clinical   risk   score   for   stroke    for  
cases   that   had   multiple   perfectly   matched  
controls    the   control   with   the   closest   age   was  
selected   intervals  of  length  l                           
and       days  were  selected  as  the  last  l  days  
before   stroke   in   cases   and   the   first   l   days   of  
remote  monitoring  in  controls   respectively   
data   were   processed    yielding       sets   of  
features         raw   data   without   any   processing   
    data  normalized  to  have  zero  mean  over  the  
interval   length   for   each   patient         difference  
data   where  each  data  point  represents  the  af  
burden   on   day   i     minus   the   af   burden   on  
day  i  for  i  from     to  l     and      data  processed  
using  the  fast  fourier  transform   fft    

supervised  machine  learning  

support  vector  machines   svms   
an   svm   model   was   created   using   the   e      
package    the   model   uses   a   gaussian   kernel   
with   a   penalty   of   c             and   gamma   as  
   number  of  features         
random  forest  
random   forest   is   an   ensemble   method   using  
multiple   decision   trees    using   the  
randomforest   package    i   applied   a   random  
forest  classifier  using     trees      

  
  

results  
of  the        patients        had  a  stroke  during  
the   remote   monitoring   period    at   interval  
lengths   of                           and         days    there  
were                      and      subjects   including  
cases   and   controls    in   each   analysis  
respectively    cases   that   were   not   included  
either   did   not   have   the   required   length   of  
consecutive  monitoring  prior  to  stroke   had  no  
atrial  fibrillation  in  the  specified  interval  given  
prior   to   stroke    or   did   not   have   a   suitable  
matched  control   an  example  of  the  af  burden  
in   cases   and   controls   on   the   first   day   of   the  
selected      day  interval  is  shown  in  figure      

all   analyses   were   done   using   r            due   to  
the   small   number   of   subjects   in   the   case  
control   subgroup    all   classification   methods  
were  applied  using    fold  cross  validation   
k nearest  neighbors   knn   
knn   is   a   non parametric   method   that  
classifies   each   sample   based   on   its   k nearest  
neighbors    knn   was   implemented   using   the  
class   package   using   euclidean   distance   with  
k    and  also  implemented  using  dynamic  time  
warping   with   the   dtw  
library   and   k                
dynamic   time   warping   is   a  
dynamic  
programming  
method   used   in   time  
series  analysis  to  align  two  
time   series   and   calculate  
the   similarity   between  
them   this  distance  metric  
was   then   used   in   knn   to  
determine   the   nearest  
neighbor s    
logistic  regression  
logistic   regression   was  
performed   using   the  
liblinear  package   with  l   
regularization   and   a  
figure      af  burden  for  the  first  day  of  monitoring  in  cases   stroke         
          
  
penalty  of  c                
and  in  controls   stroke  

fi  
  

  
  

  
  

the   lowest   test   and   training   error   was   knn  
with   dynamic   time   warping   on   zero mean  
normalized   data    so   this   method   was   used   to  
determine   the   optimal   interval   length   of    
monitoring   for   analysis    this   classifier   and  
feature   set   was   then   applied   to   varying  
interval   lengths    with   performance   statistics  
highlighted  in  figure      
  

  

discussion    

  
  
  

due   to   the   difficulty   seen   in   previous   works  
attempting   to   identify   trends   in   af   time   series  
that   predict   stroke    i   attempted   an   approach  
  
combining   time   series   analysis   with   a   wide  
  
variety   of   machine   learning   classification  
  
methods    as   seen   in   figure        the   majority   of  
  figure      f   measures  comparing  supervised  
patients   have   either   no   or   very   little   af    and  
  methods  applied  to  raw  and  processed  data       
the  ones  that  do  have  some  af  generally  have  
  
continuous   af    spanning   nearly   the   entire  
analyses   were   preliminarily   done   using      
         seconds   per   day    thus    this  
day   intervals   on   all   models    yielding   the   necessitates   identifying   patterns   from   the  
performance   results   shown   in   figure        since   temporal  data  in  addition  to  using  quantity  in  
the   svm   with   a   gaussian   kernel   and   knn   with   order  to  differentiate  cases  from  controls   
k           using   dynamic   time   warping   appear   to   supervised  learning  
have   the   highest   f    measures    more   detailed   specifically    i   chose   supervised   learning  
performance   statistics   are   presented   in   table   techniques   that   spanned   a   wide   array   of  
     the   classifer   and   feature   set   combination   methodologies    from   generalized   linear  
that  showed  the  best  performance  and  nearly   models   to   ensemble   methods    logistic  
regression  was  chosen  due  to  
table      precision   recall   specificity   and  training  and  test  errors  for  the  
its   frequent   use   in   clinical  
methods  w ith  the  highest  f   measures   
data   and   its   interpretability   
l    regularization   was   applied  
to   avoid   overfitting    which  
was   seen   in   initial   analysis   of  
the   data    knn   was   chosen  
since   it   is   nonparametric    and  
previous   work   has   shown   that  
knn   with   k           using   dynamic  
time   warping   has   been  
especially   effective   for   time  
series   classification       svms  
with   a   gaussian   kernel   were  
used   to   explore   the   feature  
space   in   a   higher   dimension   
and   random   forest   was   used  

fisince   it   is   an   ensemble   method   
unlike   the   others    overfitting  
with   random   forest   was   seen  
with   a   tree   number   as   small   as       
which  resulted  in  a  training  error  
of        and   thus       trees   were  
chosen  for  the  analysis     
model  selection  
though   it   appears   that   an   svm  
with   a   gaussian   kernel   has   the  
highest   f    measures    figure        
the   specificity   is   quite   low    table  
      given   that   the   data   is   half  
cases   and   half   controls    this  
suggests   that   the   model   has   a  
tendency   to   misclassify   test  
examples   in   a   manner   that  
results   in   a   low   number   of   true  
negatives    knn   with   k           using  
figure      performance  results  of  knn  with  k      using  dynamic  time  
dynamic   time   warping    on   the   warping  on  zero mean  normalized  data  at  varying  interval  lengths  
other   hand    appears   to   perform  
relatively   well   on   all   the   feature  
stroke   that   would   be   optimal   and   therefore  
sets   and   across   all   the   performance   metrics    most   sensitive   to   changes   in   clinical  
knn   using   dynamic   time   warping   was   not   management    thus    i   applied   my   chosen  
applied   to   fourier   transform   data   since   the   model   of   knn   with   dynamic   time   warping   to  
frequency   data   is   no   longer   a   time   series    so   varying   interval   lengths    using   the   model   on  
dynamic   time   warping   would   not   apply   as   an                           and         days   worth   of   data    it  
appropriate   distance   metric    knn   with   appears  that  the  optimal  interval  of  these  is      
dynamic   time   warping   also   showed   the   days    the   model   applied   to      day   intervals  
smallest  discrepancy  between  the  training  and   has   the   highest   f    measure   and   the   lowest  
test   errors    as   well   as   having   one   of   the   two   training   and   test   error    figure         in   fact    the  
lowest   test   errors   out   of   all        models    tying   training   and   test   error   decreases   from        to  
with   the   svm   applied   to   difference   data    in        days    and   then   increases   and   diverges  
selecting   the   feature   set   to   proceed   with    zero 
when   using   more   than        days    suggesting  
mean  normalized  data  not  only  performed  the   that      days  is  the  most  appropriate  length  of  
best   with   knn   with   dynamic   time   warping    the   feature   set    this   suggests   that   there   may  
but  was  also  an  intuitive  choice  given  that  the     be   some   benefit   to   adjusting   anticoagulation  
the   difference   in   magnitude   between            based   on   the   previous   two   months   of   af  
and       will   have   an   undesired   effect   on   the   burden       
distance   metric   when   trying   to   identify     
fluctuations  in  af  burden   
conclusions  
interval  optimization    
with   up   to   years   of   data   for   some   patients    using   time   series   atrial   fibrillation   data   to  
next   i   was   interested   in   seeing   if   there   was   a   identify  patterns  and  predict  strokes  has  been  
certain   time   interval   of   monitoring   before   a  difficult  problem  that  has  not  been  met  with  
much   success   using   traditional   biostatistical  

fimethods    using   machine   learning   with   time  
series   techniques    the   highest   f    measure   is  
slightly   under          indicating   that   identifying  
patterns   still   remains   a   challenge   in   atrial  
fibrillation   data    linear   and   certain   non 
parametric   models   were   prone   to   overfitting   
even   with   the   use   of   regularization   and  
limitation   of   the   interval   length   to   trim   the  
feature  set   however   by  applying  a  variety  of  
models   to   explore   linear   and   non linear  
decision  boundaries  and  drawing  on  expertise  
from   the   field   of   time   series   analysis    the  
performance   of   the   nearest   neighbor   using  
dynamic   time   warping   produced   consistently  
promising   results   over   a   range   of   interval  
lengths   and   types   of   processed   data    further  
investigation   is   warranted   to   explore   the  
relationship   between   stroke   and   non stroke  
atrial  fibrillation  patients  over  time     

  
future  directions  

since  intervals  in  controls  were  selected  as  the  
first        days   of   monitoring    it   would   be  
interesting   to   test   to   see   if   the   results   are  
sensitive   to   the   timing   of   the   control   interval   
to   accomplish   this    i   would   take   random      
day   intervals   from   the   total   monitoring   period  
in   non stroke   patients   to   serve   as   the   control  
data   in  addition   in  cases  that  have  more  than  
     days  worth  of  data   doing  a  case  crossover  
analysis    whereby   the   first        days   serves   as  
the  control  for  the  last      days  before  stroke   
may   provide   additional   insight   into   this  
problem    this   could   be   particularly   effective  
given   that   there   may   be   multiple   different  
types   of   patterns   in   cases   and   in   controls   
making   the   groups   challenging   to   model   as   a  
whole   and   thus   making   it   easier   to   compare  
cases  against  themselves   
  

  
  

acknowledgements  

thank   you   to   the   palo   alto   veterans  
administration   for   providing   the   data    susan  
schmitt   from   the   turakhia   group   for  
formatting   and   providing   the   data    and   mintu  
turakhia    russ   altman    and   the   cs     
teaching   assistants   for   providing   advice   and  
feedback   additionally   thank  you  to  the  rest  of  
the  turakhia  research  group  and  the  helix  lab   
this   project   was   funded   by   the   dr    jeffrey  
thomas  stroke  shield  foundation   

  
references  

     c   t   january   l   s   wann   j   s   alpert   h   calkins   j   c   
cleveland   j   e   cigarroa   j   b   conti   p   t   ellinor   m   d   
ezekowitz   m   e   field   k   t   murray   r   l   sacco   w   g   
stevenson   p   j   tchou   c   m   tracy   and  c   w   yancy   
      aha acc hrs  guideline  for  the  management  of  
patients  with  atrial  fibrillation   executive  summary   a  
report  of  the  american  college  of  cardiology american  
heart  association  task  force  on  practice  guidelines  
and  the  heart  rhythm  society    circulation   apr          
     j   s   healey   s   j   connolly   m   r   gold   c   w   israel   i   c   
van  gelder   a   capucci   c   p   lau   e   fain   s   yang   c   
bailleul   c   a   morillo   m   carlson   e   themeles   e   s   
kaufman   s   h   hohnloser   assert  investigators   
subclinical  atrial  fibrillation  and  the  risk  of  stroke    n  
engl  j  med   vol         no       pp            jan          
     w   n   venables    and  b   d   ripley   modern  applied  
statistics  with  s   fourth  edition   springer   new  york   
isbn                         
     t   giorgino   computing  and  visualizing  dynamic  
time  warping  alignments  in  r   the  dtw  package   
journal  of  statistical  software   vol        no       pp          
       
     t   helleputte   liblinear   linear  predictive  models  
based  on  the  liblinear  c c    library   r  package  
version                   
     d   meyer   e   dimitriadou   k   hornik   a   weingessel   
and  f   leisch   e       misc  functions  of  the  department  
of  statistics   e        tu  wien   r  package  version          
       
     a   liaw  and  m   wiener   classification  and  regression  
by  randomforest   r  news                        
     x   xi   e   keogh   c   shelton   and    l   wei     fast  time  
series  classification  using  numerosity  reduction   proc   
of  the    rd  international  conference  on  machine  
learning          

  
  

fi