cs     final project

autumn     

identifying gender from images of faces
abhimanyu bannerjee and asha chigurupati
stanford university

abstract
the objective of this project is to identify the gender of a person by looking at his her photograph  this is a case of
supervised learning where the algorithm is first trained on a set of female and male faces  and then used to classify new data 
we have not taken genders other than male and female into account  a preliminary algorithm is run to make sure that an
image is that of a human before classification begins 

i 

introduction

previous research has shown that our brain has specialized nerve cells responding to specific local features
of a scene  such as lines  edges  angles or movement 
our visual cortex combines these scattered pieces of
information into useful patterns  automatic face recognition aims to extract these meaningful pieces of information and put them together into a useful representation in order to perform a classification identification
task on them 
while we attempt to identify gender from facial
features  we are often curious about what features of
the face are most important in determining gender 
are localized features such as eyes  nose and ears more
important or overall features such as head shape  hair
line and face contour more important 
there are a plethora of successful and robut face
recognition algorithms on the web  instead of using
the inbuilt tools that they provide  we start building
various algorithms from scratch to gain a rich learning
experience 
in this project  the following methods were used
for classification  
eigenface method
k means
gda that performs supervised learning on reduced space of pca
svm that performs supervised learning on reduces space of pca
fisherfaces method
svm that performs supervised learning on features provided by the histogram of oriented
gradients  hog  method
we look at how these methods perform on our
data  discuss the relative advantages and disadvantages of these methods and investigate the limitations
on accuracy posed by the dataset itself  the mathe 

matical equations governing these methods will not be
discussed in this report 

ii 

data set and processing

the data we have is a set of high resolution colour images of     female faces and     male faces obtained
from the muct database  all images are frontal views
of the face  the database provides diversity of lighting 
age and ethnicity 
the images also have variations in  
subjects head rotation and tilt
subjects facial expression
subjects face hair accessories
position of the face in the image
however  this challenging database was chosen to
make room for imrpovements in the algorithm 
this data has been used in four different ways
on a single algorithm so that we can study how sensitive it is to the data quality  we run a python
script to center all the images in our database   by
centering the images the faces are aligned at the
axis of symmetry of the face  hehce  we have a
set of centered and uncentered images  we also
use coloured  rgb  and b w versions of the given
images  colour images have been compressed to
   x    pixels and b w to   x   pixels  we now
have four different datasets  dataset  centered  rgb  
dataset  centered b w   dataset  uncentered rgb 
and dataset  uncentered  b w  
the dataset has been split into training set and test
set as summarized in the following table 
 

fics     final project

table    dataset of faces

gender

training set

male
female

   
   

autumn     

female subjects who have short hair  hair tied back or
in a scarf were almost always labeled male  having
insufficient examples for them to train on might have
resulted in this outcome  another key observation is
that  the male faces are better centered and hence male
faces have a more reliable eigenspace 

test set
   
   

in this project  we define misclassification error as 
error  

no 

of

images miscclassi f ied
no  o f images

iii 

eigenface method

   

a popular method in face recognition is the eigenface
algorithm  it takes a holistic approach by processing
the entire face and coming up with an eigenface basis 
in this method  a principle component analysis  pca 
is performed to reduce the dimensionality of
the performance of this algorithm is discussed
here 

figure    plot of nearest distance of female faces in test set from
female red  and male blue  eigenfaces

table    eigenface method on dataset  

gender

training error

male
female

   
    

test error
    
    
figure    plot of nearest distance of male faces in test set from
female red  and male blue  eigenfaces

table    eigenface method on dataset  

gender

training error

male
female

   
    

test error
    
    

on dataset    the algorithm shows very good recognition for males but a very poor one for females  we
conclude here that the algorithm is basically identifying almost every new face to be male  hence contributing to the large error for females  the figure
below demonstrates this  when a male face is projected onto the male eigenspace  the resultant reduceddimension vector matches the other male faces very
well  but when a female face is projected onto the
female eigenspace  the resultant reduced dimension
vector does not match the female faces very well  infact  it favours females over males only about      of
the time 
one disadvantage of pca is that it cannot give
you an intuitive sense of why the algorithm is favouring males  but upon looking at the data where the
algorithm misclassifies the person  we conclude that

running the same algorithm on dataset   reduced
the excessive bias towards males  as now the female
faces were equally well centered 
in all cases  the number of principal components
was chosen to be      we obtained this result by eliminating all eigen values whose value is zero  a k fold
cross validation was performed to decide the number
of dimensions in the reduced space more precisely 
this resulted in a reduced dimension of     
below is a figure showing some images in the training set and the corresponding eigenfaces 

figure    a sample of training set data

 

fics     final project

autumn     

table    pca and gda method on dataset  

gender

test error

male
female

    
    

table    pca and gda on dataset  

figure    eigenfaces of the above sample

iv 

gender

test error

male
female

    
   

k means

we apply k means directly on the pixel data that we
get from images to obtain    clusters for female faces
and    for male faces  we would like to call these the
   most representative female and male faces  we then
run the k nearest neighbours algorithm to classify our
test images  k was chosen to be   after analysing the
performance of the algorithm  using cross validation 
for all possible values of k 

a k fold cross validation was done to determine the
number of pcas required  and we found the optimal
value to be      in order to visualize how gda works
with this data  we take   principal components and
obtain the following plot 

this is done on dataset   and dataset    we get the
following results 
table    k means on dataset  

gender

test error

male
female

    
    
figure    implementing gda for k    

table    k means on dataset  

vi 
gender

test error

male
female

    
    

v 

pca with gda

the eigenface method classifies new data based on
what the nearest vector is in terms of euclidean distance  instead of using the nearest neighbour approach 
we can perform supervised learning over the reduced
space  gda is one such attempt 

pca with svm

svm is yet another way of performing supervised
learning over the reduced space  a k fold crossvalidation was performed to chose the number of pcas
and     was found to be optimum  cross validation
was done for k                    this interval was
arrived at after random sampling of ks 
the pca was applied to reduce dimensionality of
the vectors that serve as inputs to the svm  the svm
then does supervised learning  sometimes this method
is called the fisher discriminant analysis  visualizing
this data in the large dimensional space is hard  so we
do it in  d  we clearly need more attributes to classify
the data 
 

fics     final project

autumn     

table     fishface method on dataset  

figure    implementing svm for k    

performance of this algorithm is  
table    pca and svm on dataset  

gender

test error

male
female

    
    

table    pca and svm on dataset  

gender

test error

male
female

    
    

vii 

fischer faces

when pca reduces the dimension in which we work 
it definitely obtains the most representative reduced
space  but it does nothing to make sure that these attributes also represent the salient differences between
the male class and female class  our algorithms main
aim should be to identify these features and give them
highest priority while classifying them 
fisherfaces instead tries to maximize the variance
between classes  instead of variance within a class 
hence it is much better suited for the gender classification task 
as expected  fisher faces gives us remarkable results of      on uncentered data and     on centered
data  also      is what all the algorithms converge
to when used on uncentered data  this throws light
on the importance of centering it  as information about
features can be very crucial in classifying it correctly 
table     fisherface method on dataset  

gender

test error

male
female

    
    

viii 

gender

test error

male
female

    
    

histogram of oriented gradients
and svm

as a foray into applying advanced and effective gender
classification algorithms  we have used supervise svm
learning after extracting hog descriptors of human
faces  for this particular algorithm  we used code that
was available online 
we carry out the scheme in b w space and use
l   normalization for block normalization  for this
method  images were not normalized during preprocessing  also  the images were not centered because
this method is invariant to geometric transformations
of images 
a plot of gradients show what the most descriptive
cues are that the svm learns over  this is the only algorithm that can give us an insight as to which physical
part of the face contributes most to gender detection 
the accuracy that this algorithm provides is the
best of all  the algorithm also does not seem to be
limited by the challenges that the data poses  giving us
equally good results for both centered and uncentered
data 
table     fisherface method on dataset  

gender

test error

male
female

    
    

table     fishface method on dataset  

gender

test error

male
female

    
    

the gradient images of our dataset tells us that
these are the fundamental differences between male
and female faces 
the interior of a female face has softer face contours
female features are spread over larger areas than
male features
 

fics     final project

the outline of a male face face is more rugged
compared to a female face
turns out that these differences are key in classifying a person to be male or female 

autumn     

and provides an input to a supervised learning algorithm  these algorithms are more
robust to geometric variations in dataset 

x 

future work

now that we have quantitative yardsticks
for masculinity and feminity of a person 
we could extend this knowledge to quantify
what is perceived as beauty  conventionally 
beatiful people are known for epitomizing
either masculinity or feminity  we use this
hypothesis in devising our algorithm 
for this we need a dataset of images where
each image is ranked on the basis of its at 

figure    hog descriptors of human faces

ix 

discussion

gender classification algorithms can be of two
types 
 pictorial  the algorithm reads pixel data
into an array and uses statistical tools to
process that array and make classification 
such algorithms require a dataset where all
images are properly aligned  without any
noise 
 geometric  the algorithm reads pixel data
and gets information on features such as
width of jaw  curvature of cheek etc  it using
this new information as the attribute space

fi