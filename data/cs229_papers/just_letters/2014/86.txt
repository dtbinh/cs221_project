visualizing personalized cancer risk prediction
maulik r  kamdar
biomedical informatics training program  stanford university
maulikrk stanford edu

 

introduction

cancer  as we now know  is a genetic disease  this knowledge entails that to enable evidence based
personalized diagnosis for any patient  the location of where the tumor occurs  e g  brain  liver  etc   is
less relevant than the underlying genetic signature that the cancer cells express  i e  whether genes are
silenced  amplified or mutated   with the advent of high throughput gene sequencing technologies  it
has been possible to sequence the entire human genome of disease diagnosed or normal patients  as a
consequence  large repositories of genomic datasets are now available for data analysis  and identifying
the underlying patterns could aid in the diagnosis  prognosis and treatment on a personalized basis  the
cancer genome atlas   tcga  publishes data pertaining to the molecular information  exon  mrna 
expression  dna methylation  single nucleotide polymorphisms  snp   copy number variations  cnv 
etc   and clinical attributes of around      patients tested across different cancer typologies 
data from tcga is of high value for oncologists as it enables matching the genomic evidence found
in their own patients with those enrolled in the tcga project  tcga data has been widely used for
hypothesis driven translational research as all of its data results are from direct experimental evidence 
previous research has been carried out for the discovery of new tumor bio markers  genes or single
nucleotides  using unsupervised learning algorithms  and classification of patient samples using supervised
learning methods  however most of these analyses use tcga exon expression or snp datasets  it has
been shown recently that dna methylation signatures are robust bio markers  vastly more stable than
mrna or proteins  and hence will extend our ability to classify cancer and predict outcome beyond what
is currently possible  this could lead the development of new approaches for diagnosis and prognosis of
different kinds of cancer      however  class prediction based on these patterns is an under determined
problem  due to the extreme high dimensionality of the data compared to the usually small number
of available samples  hence  a reduction of the data dimensionality  through a combination of several
feature selection methods  is a necessary pre processing step for classification performance 
   

motivation

the motivation of this project is to lead towards the development of a diagnostic framework  integrated
with a cancer genome visualization tool genomesnip      which enables a clinical researcher to visually
predict cancer risk in new patients using machine learning  ml  classification models built over the tcga
dna methylation  dm  and exon expression  ee  data  the researcher would be able to upload the
genomic data for a new patient  load a set of prior classification models and predict cancer risk 
the specific ml goals for the project are 
   obtain the set of genomic features which provide the best evaluation metrics  sensitivity  specificity
and error  for each typology through genomic co occurrence based feature selection
   compare different supervised learning algorithms built over dm and ee data to predict whether
a new sample is tumor     or normal      and also classify subtypes of breast invasive carcinoma
   perform principal component analysis  pca  for generating cluster visualizations of the data
   explore and discuss how well the best classification model developed for one tumor typology can
predict tumor risk in a patient experimentally classified under another typology
the models and features so identified  along with their evaluation metrics  could then be made
available through the genomesnip web application for personalized risk prediction 

 

methods and materials

   

data processing

the raw tcga data is available as zipped text files from their data portal  and consists of dna
methylation     x     or exon expression  x  r    values mapped to a specific position or a range
 

https   tcga data nci nih gov tcga tcgahome  jsp

fiof a human chromosome  e g  chr            indicates position          of chromosome      a preprocessed version is made available by broad institutes firebrowse    where these values are mapped
to a specific human gene annotated with the hgnc nomenclature    in this work  i have used the dm
and ee data for only   tumor typologies  the statistics for which are mentioned in the table below  the
sample type  tumor or normal   is contained within the tcga identifier value  of the sample 
e g  tcga           c   d          tumor types range from           and normal types range from
           moreover  tumor subtypes for a particular patient sample can be determined from the
histological sample type attribute present in the tcga clinical dataset  there were   known subtypes
for breast invasive carcinoma  i had to convert the ee data to log scale  as a    ee value indicates a
   times increased expression of a gene  whereas a     value indicates a    times decreased expression 
the ee values were further normalized for having a   mean and unit variance 
dm data size  gb  ee data size  gb   patients     train test
tumor type
breast invasive carcinoma brac  ta  
     
    
   
              
bladder urothelial carcinoma blac  tb  
    
   
   
              
colorectal adenocarcinoma coadread  tc  
    
    
   
              
head squamous cell carcinoma hnsc  td  
    
    
   
              
lung adenocarcinoma luad  te  
    
    
   
              
prostrate adenocarcinoma prad  tf  
    
   
   
              

table    statistics of the tcga dm and ee data for the six tumor typologies used for this work

   

genomic co occurrence for feature selection
t
t
 dis gene    dis gene    
 p ath gene    p ath gene    
s
s
sim gene    gene       
 
 dis gene    dis gene    
 p ath gene    p ath gene    
t
 p ub gene    p ub gene    
s
 
    bioinput gene    gene   
 p ub gene    p ub gene    

there are         protein coding genes in the
human genome  and other auxiliary genomic segments  which increases our feature space x  n   
m  drastically  performing traditional methods
like l  based feature selection or randomized sparse models on the entire set of human
genes  for reduction to a smaller set  still incorporated some noise and unrelated features  this
resulted in classifiers which were not able to accurately predict cancer risk in newer patients  biologically  however  it has been shown that only
a small number of these genes are actually implicated in the cancer initiation and propagation 
the cancer gene census  maintains an updated
list of hgnc genes  which have been experimentally proven to be implicated in the different types
of tumor typologies  using genome wide association studies  i used this prior biomedical knowledge to reduce the gene list to only     genes 
however  this list in itself is not exhaustive  as
there may be many genes and biomarkers which
may be associated with tumor typologies  but have
yet to be discovered  i used a genomic cooccurrence based method to obtain the set of
fig     genomic wheel visualization
genes which co occur with each of these     oncogenes in diseases  pathways or publications 
using the equation above  i calculate
the similarities of each oncogene with the rest of the genes 
t
 dis gene    s dis gene    
for instance  the term  dis gene    dis gene     indicates the fraction of the diseases where the gene 
 
 
 
 

http   firebrowse org 
http   www genenames org 
https   wiki nci nih gov display tcga tcga barcode
http   cancer sanger ac uk cancergenome projects census 

fiand gene  are simultaneously implicated  i e  their protein products play a major role  with respect to
the total number of diseases either of the two genes are implicated  the equation represents a weighted
measure by including co occurrence of genes as observed in pathways and co mentions in publications 
this co occurrence knowledge pertaining to diseases  dis   pathways  path  and publications  pub  is
obtained from omim   online mendelian inheritance in man   kegg   kyoto encyclopedia of genes
and genomes  and pubmed   knowledgebase of biomedical literature  abstracts  the last term of the
equation  bioinput gene    gene     indicates a user provided measure  which was obtained by allowing
biomedical researchers to interactively click on genes represented in the genomic wheel visualization
during the first evaluation of the genomesnip platform  fig          and denote them to be explicitly
similar  in the genomic wheel  the green and red arcs denote normal and cancer genes on the human
chromosomes  the chords connecting the different genes  indicate the co occurrence relations  red  green
and blue for disease  pathway and publication co occurrence respectively   the values of weights used for
this work were                                     using a similarity threshold sim gene    gene     
      the final number of genes was hence reduced to       combined with three patient demographic
features  gender  age and ethnicity   i had  n        features  performing l  based feature selection
on this reduced set of genes resulted in a much refined set of features  counts shown in fig     
   

classification methods

i primarily have a classification problem for which most of the input features x are continuous valued
random variables and y bernoulli    i have used four different supervised learning methods 
   gaussian naive bayes  gnb 
when dealing with continuous data  a typical assumption is that the continuous values of a feature xj
associated with each class k are distributed according to a gaussian distribution p xj   x y   k   
  i
h

jk
     exp     x
  training the classifier over  x i    y  i   i            m   i find p  y   k   jk
jk
 jk
 
and jk

for each feature xj and k                            for brca subtypes  using ml estimation 
p  i   i 
p  i 
 
 i 
  k     
  k     
i xj i y
i  xj  jk   i y
 
p
jk   p
 

 
jk
 i 
 i 
  k    m
  k    m
i i y
i i y

   support vector machine  svm  with a gaussian kernel
i used the liblinear package with l  loss l  penalty to solve the primal optimization problem 
   decision tree  dt 
decision tree over the training set was generated by partitioning data q at node m recursively using
a candidate split     f eature j  threshold tm    i e  qlef t       x  y  xj  tm   qright      q qlef t  
i used the gini impurity measure  for i  n ode m  with nm examples  and k          or                   
x
  x
pmk  
i y  i    k    h xm    
pmk     pmk  
nm im
k



n t
arg min   nlef
h qlef t    
m

n

right
the classifier finds the optimal   
  n
h qright      and iterates
m
over the partitions until a maximum tree depth of    is reached  with at least   samples on each leaf 
   ensemble method random forest  rf 
for this method  i train k       decision trees fk over a sample space  xk yk   obtained by random
sampling  with replacement  n training examples from  x y   for prediction on a new example x    i
pk   
 
average the predictions over individual decision trees  i e  f   k
k   fk  x   

   

implementation

tcga data was downloaded from firebrowse and processed through three python scripts      extract a
gene patient matrix from the dm and ee files for the      genes     parse the sample types  y         
from the identifiers and retrieve the subtypes and the demographic features from the clinical files  and
   generate the final matrix   x y    the classification methods were initially tested using matlab and
were re implemented using python scikit learn  i carried out a   fold cross validation method and
computed the average evaluation metrics  training error  test error  sensitivity and specificity   the
main aim was to achieve a lower test error and a higher sensitivity  how accurately the classifier classifies
a tumor sample as    for the classifiers  pca cluster plots were generated using matplotlib library 
 
 
 

http   www omim org 
http   www genome jp kegg 
http   www ncbi nlm nih gov pubmed

fi 

results

the training error  test error  sensitivity and specificity were calculated for each supervised learning
algorithm trained using dm or ee data  across each typology using   fold cross validation 
training error    
ta tb tc td te tf
gnb                             
svm                        
dt
                       
rf
                       

ta
    
    
    
    

test error    
tb tc td te
                   
                   
                   
                   

tf
    
    
    
    

ta
    
    
    
    

sensitivity    
tb tc td te
                
                  
                   
               

tf
    
    
    
    

ta
    
    
    
    

specificity    
tb tc td te
                   
                  
                   
                   

tf
    
    
    
    

table    evaluation metrics     for classifiers trained using dna methylation data

the evaluation metrics  in    for the classifiers trained using tcga dna methylation data are shown
in table    it can be seen that the svm and the rf classifiers have minimal test errors               
training errors  and a very high test sensitivity           across all tumor typologies  moreover the
svm classifier has a considerable specificity also with only two tumors having          overall  all the
classifiers did reasonably well with test errors        and sensitivity generally         
ta
gnb     
svm    
dt
   
rf
   

training error    
tb tc td te
tf
                           
               
   
               
   
               
   

ta
     
     
     
     

test error    
tb
tc
td
te
                      
                    
                       
                      

tf
    
    
     
    

ta
    
    
    
   

sensitivity    
tb tc td te
                   
                   
                   
                

tf
    
    
    
   

ta
    
    
    
   

specificity    
tb tc td te
                   
                   
                   
                

tf
    
    
    
   

table    evaluation metrics     for classifiers trained using exon expression data

similar success was not found when training the classifiers using the tcga exon expression data  as seen
in table    gnb had exceptionally huge training and test errors for two typologies            whereas
most classifiers had         test errors and         specificity  out of the four  svm functioned
comparatively well with a maximum of       test error          sensitivity and         specificity 
ta
dm training error     dm test error     ee training error     ee test error    
gnb
    
    
    
    
svm
    
    
   
    
dt
   
    
   
    
rf
   
    
   
    

table    training and test errors     for brca subtype classification

for breast invasive carcinoma  brca  subtype prediction  svm and rf classifiers trained using either
dm or ee data provided great results  here y is a discrete valued variable  y                  

fig     cluster visualization after pca dimensionality reduction

i carried out a principal component analysis for reduction to   dimensions to generate cluster visualizations over the different tumor typologies data  shown in fig      the first row proves that dna
methylation serves as an extremely robust marker to separate the tumor samples  red nodes  from
normal samples  blue nodes  for all tumor typologies  and distinct clusters are observed  this however
is not the case for exon expression features  where no discernible separation is observed 

 

discussion and conclusion

there is large evidence that dna methylation patterns hyper  and hypo methylation in tumor sample
tissues are abberant compared to normal sample tissues  and have been associated with a large number
of human malignancies      dna methylation  involves the addition of a methyl  ch    group to the
 

http   en wikipedia org wiki dna methylation in cancer

ficytosine nucleotide resulting in   methyl cytosine  whose accumulation of high levels over time renders a
gene transcriptionally silent  typically there is hyper methylation of tumor suppressor genes and hypomethylation of oncogenes  resulting in increased cancer growth  as a result  better evaluation metrics
and pca clusters are obtained for classifiers trained using dm data  i believe that the   adjoint pca
clusters seen for the ta using ee data   nd row   st panel  represent   subtypes of brca  as such 
classifiers trained using tcga dm and ee data performed well for brca subtype classification 
feature selection using genomic
co occurrence and then an l  based
approach provided better prediction
statistics as compared to implementing
an l  based restriction on the entire
        gene list  results not shown  
hence prior biomedical knowledge and
user inputs are essential to build better classifiers  svm performed best for
classification overall  whereas rf which
performed better for dm was seen to
over fit ee       specificity   this may
be due to the case that there are more
tumor     samples as compared to
normal      using equal number of
samples  or performing tree pruning
fig     genome tracks view
could alleviate this  new ui controls
could be added to the genomesnip tracks view  fig     so the researcher can select a specific classification model along with the visualized patient data to predict risk 
my last goal was analogous to the classification of tumors using the tcga data  and is particularly
useful from a biomedical perspective  drugs approved by regulatory agencies  and many publication
resources  are still researched in the context of a single tumor typology  if we have a classification model
which could efficiently predict tumor risk for a separate typology  we are essentially linking two tumor
typologies through their genomic signature and this could enable drug repurposing  however  i only
found an svm classifier trained using hnsc  td   samples provided       sensitivity and a desirable
      specificity while predicting coadread  tc   samples  other pairs generated skewed metrics
        sensitivity and         specificity or vice versa   hence additional research is required here 

 

future work

this work revolves around building classifiers using the entirety of tcga dm data and compares the
classification results against similar classifiers using ee data  i would like to build evaluate classifiers
using all the different tcga molecular datasets  snp  cnv etc    independently and in a combination to
determine which would provide the best prediction metrics  also  by the inclusion of clinical features listed
for each tcga patient  such as patient follow up status  drug administered  in our models  we could
extend our diagnostic framework to generate prognosis and therapeutic advice  i would like to experiment
with deep learning methods and conduct user driven evaluation of the system  we showed a preliminary
approach where clinicians select genes from the genomic wheel to guide genomic co occurrence based
feature selection   the system could be configured to allow real time selection of the features  adjust the
weights in the similarity equation  build custom classifiers and generate new predictions  finally  i would
like to do unsupervised learning on the datasets for the discovery of new bio markers 

acknowledgements
i would like to acknowledge dr  marina sirota who extensively guided this research and helped me
understand tcga data  this work was funded under the biomedical informatics phd program 

references
   das  p m   singal  r   dna methylation and cancer  journal of clinical oncology                         
http   jco ascopubs org content            abstract
   kamdar  m r   iqbal  a   et al   genomesnip  fragmenting the genomic wheel to augment discovery in cancer
research  in  conference on semantics in healthcare and life sciences  cshals   iscb       

fi