relativeandabsoluteequityperformance
predictionviasupervisedlearning

alexalifimoff
aalifimoff stanford edu


axelsly
axelsly stanford edu


introduction
investmentmanagersandtradersutilizetwodifferenttypesofindicatorstoguidetheir
tradingdecisions technicalindicatorsarecomposedofinformationprimarilyvisibleon
pricehistorycharts theseincludetherecentpricechangesandvolumeforaparticularsecurity 
fundamentalindicators likeprice equityratioandquarterlyrevenue arebasedupon
numbersprimarilyfoundonacompanysbalancesheet thispaperseekstoevaluatethe
effectivenessofbothfundamentalandtechnicalindicatorsininformingmoderntradingand
investmentdecisionsbyusingthemasfeaturesinsupervisedlearningtopredictabsoluteand
relativeequityperformance 
ourworkattemptstobuildonapreviouscs   termproject automatedstocktrading
usingmachinelearningalgorithmsbydai shah andzhongbyexpandingreturnprediction
totheinvestmentgradetimehorizon 


absolutereturnprediction
theholygrailinmodernfinancialmarketsisabsolutereturnprediction webeganour
projectbyattemptingtousesixmonthsofmonthlypriceandvolumedata andtwoquartersof
price equityratio currentmarketcapitalization andprice bookratio asourfeaturesto
predictthechangeinequitypriceoverthenexttenmonthsusingavarietyofsupervisedlearning
algorithms intotal weused  features withtheexceptionofpastreturndata we
preprocessedallofourfeaturesinputsbyremovingthemeanandscalingtounitvariance 
weselected   equitiesfromtherussell    index asourtrainingset weaimedto
classifyreturnsoverthenextyearaseitherpositiveornegative if p  isthepriceofanequity
today wedecidedtopredictthevalueof    px  p      forsometimeperiod x  weusedsupport
vectormachines logisticregression decisiontrees andgaussiannaivebayestotryto
classifythedata ourresultsonthetwelvemonthtimeframearesummarizedintable  

table  results  monthabsoluteprediction
algorithm
trainingaccuracy
testingaccuracy
svm  gaussian 
     
     
svm  gaussian 
     
     
logisticregression
     
     
decisiontree
    
     
gaussiannaivebayes
     
     
 

precision
     
     
     
     
     

recall
     
     
     
     
     

technicalindicators
fundamentalindicatorsselectedbecauseoftheirrelevancetofinancialanalysts
 
unfortunately thereisntrobustdataavailablefortechnicalindicatorsforsmallmarketcapitalizationstocks sowe
hadtoomitsomeoftheoriginal     russellcomponents 
 

fi
svm correspondstoagaussiansvmwithaclassweightinverselyproportionaltothe
frequencyofexamplesinthatclassandapenaltyparameterof     svm referstoagaussian
svmwiththesamepenaltyparameter  theunderlyingdistributionforthisdatasetwas   
positiveexamples asaresult thebestperformingalgorithmisonlymarginallybetterthan
educatedguessing 
weelectedtousethesamefeaturesettopredictreturnsoverjustthenextmonth 
hypothesizingthatourindicatorsetmightcontainmoreinformationaboutshorttermprice
fluctuationsthanlongtermmovements ourresultsfortheonemonthtimehorizonare
summarizedintable  

table  results monthabsoluteprediction
algorithm
trainingaccuracy testingaccuracy
svm  gaussian 
     
     
svm  gaussian 
     
     
logisticregression
     
     
decisiontree
    
     
gaussiannaivebayes
     
     

precision
     
     
     
     
     

recall
     
     
     
     
     


svm referstogaussiankernelwithapenaltyparameterof  andclassweights
inverselyproportionaltoclassfrequency svm referstogaussiankernelwithpenalty
parameterof   
whiletheseresultsonceagainseempromising theunderlyingdistributionofreturnswas
   positiveexamples asaresult itbecamequiteclearthatattemptingtopredicttheabsolute
returnusingthisparticularfeaturesetwasprimarilyanexerciseinfutility 
wedecidedthenextmostaptstepinrefiningouralgorithmwasredefiningourfeature
set lowtrainingandtestingaccuracyconvincedusthatourfeaturescontainedverylittle
informationaboutwhatwewereultimatelytryingtopredict wedecidedtoattempttovectorize
themajorityofacompanysfinancialreportstodetermineiftheycontainedanyinformationthat
mightbeusefulinpredictingfutureperformance however obtainingrobustfinancialrecords
forthesmallmarketcapitalizationequitieslikethoseintherussell    provedtobenextto
impossible toconductanalysisonfullfinancialstatements weneededtochangeourtraining
settolargercapitalizationstocks 
weusedallfivehundredcomponentsofthes p   asourtrainingset weusedthe
sametechnicalfeaturesasbefore priceandvolumedataforpastsixmonths inadditionto  
keyfundamentalindicators fromthepastthreequartersofthecompanysfinancialstatements 
intotal thetechnicalfeaturesetconsistedof  featuresandthefundamentalfeatureset
consistedof  features 

 

thesewerethebestperformingsvms selectedby  foldcrossvalidation 
weusedcashonhand stockholdersequity retainedearnings beginningnetincome longtermassets current
assets accountspayable income investedcapital revenue earningspershare earningspershare operating  
currentliabilities andlongtermliabilities wehadthreequartersofdataforeachindicator finally weusedthe
currentmarketsector asourfinalfundamentalindicator 
 

fiweutilizedthesetwofeaturesetstodemonstratetheperformanceofabsolutereturn
predictionforthes p    weagaintriedtopredictreturnsonemonthintothefuture our
results comparedtoabestguessofchoosingthedominantmarkettrend  areshownintable  

table  performanceundervariousfeaturesetsgaussiankernalsvm 
trainingset
accuracyimprovementvs bestguess
fundamental technicalfeatures
    
technicalfeatures
    
fundamentalfeatures
    

ourinitialresultsontherussell    datasetwereonlyconfirmedbyouranalysisonthe
s p    thes panalysiswasevenworse fundamentalandtechnicalindicatorscarriedvery
littleinformationthatcouldbeusedtopredictfutureabsolutereturns 
weconcludedthatabsolutereturnpredictionishighlysubjecttooutsideinfluencesthat
havelittletodowiththenumbersonacompanysfinancialreportsandpastreturndata 
typically macroeconomicinfluencesthatdrivemarketconfidencehavemuchgreatereffectson
equitypricesthanacompanyspersonalfinancialhealth 


relativereturnprediction
wedecidedtotrytorefocusouralgorithmsbyattemptingtoremovemarketriskfrom
ourprediction insteadofclassifyingwhetherthereturnofaparticularequitywaspositiveor
negative wedecidedtoexaminetherelationshipbetweenanequitysreturnandthereturnofthe
marketoverall inthisphaseoftheproject weattemptedtopredict 
 pxp  
 
p    rindex    

 

 

where rindex isthereturnofthes p   marketindexfromtimeperiod totimeperiod x  
onceagain welookedatthes p   componentsandusedour  dimensionalfeature
setoffundamentalandtechnicalindicatorstopredictrelativereturns ourresultsareshownin
table  

table  performanceofrelativereturnpredictionfordifferentlearningalgorithms
algorithm
trainingaccuracy testingaccuracy
precision
recall
svm gaussian 
     
     
     
     
logisticregression
     
     
     
     
decisiontree
      
     
     
     
gaussiannaivebayes
     
     
     
     


svmreferstoagaussiankernelsupportvectorclassifierwithapenaltyparameterof
   inthisexample theunderlyingdistributionofpositiveandnegativeexampleswas   and
    soanyperformanceover   isagainoverrandomguessing ourbestalgorithmactually
producesarelativelyappreciablegainoverrandomguessing 
 

forexample inawellperformingmarket asinthetimeperiodwewereexamining thebestguessisthatallequities
willperformwell 
 
penaltyparameterof  andnoclassweighting

fiwewereinterestedinunderstandingwhichfeaturetypeswerethemostusefulin
predictingfutureequityreturns wegroupedourfeaturesintofoursets ifundamental themost
recentquartersfinancialstatementfeatures  iifundamental iiifundamental theoldest
quartersfinancialstatementfeatures  andtechnicalandreconductedouranalysisundereach
featureset theresultsofthisanalysisareintable  

table  performanceofrelativereturnpredictionwithdifferentfeaturesets 
featureset
accuracyimprovementvs bestguess
allfundamental technicalfeatures
     
i iifundamental alltechnical
    
ifundamental alltechnical
    
alltechnicalfeatures
    
allfundamentalfeatures
    


analysisofresults
webelievethatourresultsprovidesomeinsightsintothestructureofequitymarkets 
ouralgorithmsusedfeaturesthatwerealmostentirelycompanyspecificinthattheydidnot
provideapictureoftheoverallhealthoftheeconomy anindividualsdecisiontoinvestina
capitalmarketishighlydrivenbymacroeconomicfactorsliketheriskfreeinterestrate 
unemployment andcurrentgovernmentpolicytowardsthemarket sinceourmodeldidnotuse
thesefactorstomakepredictions itisntentirelysurprisingthatitwasdifficultforustopredict
absoluteequityperformance 
however ourmodelisusefulforevaluatingtherelativeperformanceofequities thereis
substantialinformationcontainedwithinourfeaturesetabouthowoneequitywillperform
relativetoanother thisinsightisinlinewithmodernfinancialtheory whichsuggeststhatequity
performanceisafunctionofaparticularstocksmovementwiththemarket andthatmarketrisk
isdeterminedbyother primarymacroeconomic factors ourmodelcapturesatleastsome
elementofidiosyncraticrisk 
ouranalysisalsorevealswhichelementsofthefeaturesetaremostusefulinpredicting
equityreturns byfar thefundamentalfeaturesetwasthemostusefulforevaluatingcompany
performance likewise themostrecentfundamentaldatacontainedfarmorepredictivepower
thantheolderdata thiscorrespondswithourintuitionthatrecentcompanyfinancialeventsare
mostrelevanttoacompanysperformance 

furtherwork
ourworkdemonstratesthatsupervisedmachinelearninghastheabilitytoaidasset
managersandtradersinprojectingrelativereturns however ourworkisfarfromcomplete we
seeseveralwaysinwhichourworkcouldbeextended 
first wethinkitwouldbeinterestingtobuildonouranalysisbyincluding
macroeconomicfeatureslikeunemployment gdp andhousingstarts itispossiblethatthese
metricswouldbeusefulinpredictingabsolutereturns alternatively thesesamefeaturescould
beusedtopredictgeneralizedmarketreturns asemiaccurateregressionoffutures preturns
wouldgreatlyincreasethevalueofourresearch 
 

conductedusinggaussiansvmwithpenaltyparameterof     

fiouranalysisonlylooksataselectionofequitiesforonepointintime extendingthe
analysistomultipletimeperiodswoulddemonstrateifthepredictivetrendistimedependentor
couldbemoregenerallyapplied thiskindofanalysisisthenextsteptotrulydetermineifafirm
coulduseasupervisedmachinelearningmodeltogenerateaconsistentprofit 
ourinitialanalysisonlylookedatthes p   andtherussell     market
capitalizationdirectlyconstrainstheinvestmentcapabilityoffinancialactors forexample a
largebulgebracketbankcantinvestinmicrocapstockbecausethemaximuminvestment
amountisconstrainedbystockcapitalization thismeansthatequitieswithdifferentmarket
capitalizationscouldhavevastlydifferentbehaviors extendingouranalysistodifferentmarket
capitalizationrangescouldpotentiallyyieldsomequiteinterestinginsightsintomarketstructure
andbehavior 
furthermore ourworkonlyconsiderstheapplicationofsupervisedlearningtoreturn
prediction however largefinancialinstitutionsareoftenconcernedwithothermetrics like
volume whichbecomeextremelyrelevantwhentheinstitutionneedstomovelargeamountsof
equityaroundforclients leveragingthepredictivepowerofmachinelearningtodeveloptools
topredictotherfinancialindicators likevolume isanaturalextensionofourwork 
however wealsobelievethatthereareanumberofinterestingapplicationsof
unsupervisedandreinforcementlearningtofinancialmarkets webelievethatunsupervised
learningcouldaidinunderstandingthecomponentsthatdrivereturnvarianceinmodern
financialmarkets reinforcementlearning ontheotherhand presentsseveralopportunitiesfor
developingafullfledgedtradingstrategyintandemwithapredictivemodellikeours our
referencesincludeaveryexcitingapplicationofreinforcementlearningtoorderexecution 


references datasources
datawasgatheredusingacombinationofcompustat companyfinancials  crsp past
returnandvolumedata  andbloomberg selectedcompanyfinancials  weimplementedallof
ourmodelsusingthephenomenalscikitlearnlibraryavailableforpython finally wewould
liketothankandrewngforhisphenomenalcourseandtheentireteachingstafffortheirhelp
andwisdomthroughoutthequarter 

hsu c apracticalguidetosupportvectorclassification retrievedseptember     
available http   www csie ntu edu tw   ecjlin papers guide guide pdf

dai t  automatedstocktradingusingmachinelearningalgorithms  retrievedseptember 
    available 
http   cs    stanford edu proj     shahdaizhongautomatedstocktradingusingmachinelearni
ngalgorithms pdf

nevmyvaka y  reinforcementlearningforoptimizedtradeexecution  
retrievedseptember     available http   www cis upenn edu  mkearns papers rlexec pdf

pedregosa f  scikitlearn machinelearninginpython  retrievedseptember     
available http   jmlr csail mit edu papers v   pedregosa  a html


fi