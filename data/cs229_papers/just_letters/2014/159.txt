an energy efficient seizure prediction algorithm
zhongnan fang

yuan yuan

andrew weitz

electrical engineering
stanford university
zhongnan stanford edu

statistics
stanford university
yuan    stanford edu

bioengineering
stanford university
aweitz stanford edu

abstractin this project  we sought to develop a learning algorithm that identifies eeg time series as pre ictal  the time just
before a seizure occurs  or inter ictal  the time between seizures 
using undersampled data to reduce the energy consumption and
bandwidth usage  by training the model with segmented   second
intervals and predicting seizures with a decision window  we
achieved high seizure prediction accuracy at a downsampling
rate as high as     these techniques can be broadly applied to
reduce energy demands for a variety of wearable medical and
health device applications 
index termsseizure prediction  logistic regression  svm 
energy efficiency 

fig     we selected two feature sets for seizure prediction  bandpower based
 left  and dwt based  right  

i  i ntroduction

ii  m ethods

bandpower  bp  based

wearable device

  s fft
eeg

energy efficient

feature extraction

 f      hz  df

t        hz 

 f       hz  df
 f        hz  df
 

 f        hz  df
 

 f         hz  df
 

   ch x        features

  s dwt
eeg

t       hz 
t         hz 
t           hz 
t        hz 

 x    x  
 x    x  
 x    x  
 x    x  
 x    x  

 x   x    n x 
 x   x    n x 
 x   x    n x 
 x   x    n x 
 x   x    n x 
 x   x    n x 

   ch x          features

a  data description
data was provided by the american epilepsy society for
its seizure prediction challenge on www kaggle com  eeg
recordings were collected in a single epileptic canine with   
pre ictal  y    and    inter ictal  y    example files  each
file includes    channels of continuous eeg recordings for
   min  sampled at        hz  to increase the amount of
data available for training for seizure prediction  we split each
   min file into   s intervals to be individually classified  this
resulted in a      sample       channel  matrix for each of
the m       files        sec          data points 
b  features
   bandpower based feature  for the first feature set we
investigated  we quantified the eeg spectral power in six
physiological frequency bands  delta        hz   theta     hz   alpha       hz   beta        hz   low gamma       hz   and high gamma         hz   this feature set has
previously been shown to perform well for seizure prediction
using logistic regression and svm           spectral power was
extracted from each   s time series using the bandpower  
function in matlab  because each recording consisted of   
separate channels  the total number of features per   s interval
was thus             fig    left  
   wavelet based feature  for the second feature set we
investigated  we used the discrete wavelet transform  dwt 
with   levels of decomposition  the benefit of the dwt is
that it can capture signal changes in both the temporal and
frequency domain  this is important since the eeg signal is
non stationary and spectrum of the signal changes over time 
to compute the dwt  the time series was decomposed into  

mobile phone  tablet  pc etc 

wireless channel
transfer

t           hz 

 

epileptic seizures afflict over    of the worlds population 
if seizures could be predicted before they occur  fast acting
therapies could be delivered to prevent the attack and restore
a normal quality of life to patients  over the last two decades 
several studies have explored the use of eeg signals to predict
seizures using principles from machine learning         it
is thought that such an algorithm could be implemented in
real time with a wireless  implanted eeg sensor  however 
there are two main constraints for such a portable system 
first  due to limited battery life  energy consumption must
be minimal  second  due to limited bandwidth  the data
transmitted between the sensor and the central processing
device  such as mobile phone  tablet  personal computer  etc  
should be small  to address these issues  we sought to develop
a robust learning algorithm that identifies eeg time series
as pre ictal  the time just before a seizure occurs  or interictal  the time between seizures  using downsampled data 
this could ultimately reduce both power consumption and
bandwidth usage for wearable seizure prediction devices  fig 
   

downsampled eeg

dwt based

 f        hz  df

prediction

smaller bandwidth

fig     undersampling can be used to reduce energy consumption and data
transferring bandwidth on personal medical and health devices  however  the
effect of undersampling on the performance of machine learning algorithms
is still an open question 

 

fierror rate

 

 
   
   
   
   
   
   
   
   
   
 
                   

number of training datasets

svm   linear

 

 

 
   
   
   
   
   
   
   
   
   
 
                 
 

number of training datasets

svm   radial
testing
training

 

 

                 

number of training datasets

   
   
   
 

    
    

    

lr

    

    

    

svm linear svm radial

   
   
 

as noted above  the original data were acquired as single
files of    min eeg recordings  labelled as pre ictal or interictal   which we then divided into six hundred   s intervals 
although our learning algorithms treated the features from
each of these   s intervals as a single data point  we ultimately
sought a way to predict seizures at a larger temporal scale 
such as every    s or   min  to do so  we implemented
a decision window  in which the recording was classified
as pre ictal if the fraction of  s intervals classified as preictal exceeded a certain threshold  the resulting false positive
and false negative rates with different thresholds were then
used to generate roc curves for performance evaluation  to
determine how much data our algorithm needed to generate
a correct prediction  we also varied the decision window size
 i e  how many  s intervals were used to make a decision on
pre ictal or inter ictal   in practice  a smaller window means

    
    

    

lr

    

    

 

e  seizure classification

bandpower features
dwt features

   

 

to confirm that our learning algorithm could accurately
classify pre ictal and inter ictal states using the defined features without under  or over fitting  we first generated learning
curves as a function of dataset size  i e  the number of    min
eeg files   the testing set was kept at a constant size of  
eeg files  with   positive examples and   negative examples 
the training set was evaluated for sizes ranging from   to
   eeg files  always with an equal number of positive and
negative examples 
the generalization error of each learning algorithm was
evaluated using    repeated trials of         hold out crossvalidation  we split the original    eeg files into randomly
assigned groups of    training and    testing datasets 

testing error

 
   

 

d  learning curve and cross validation

   logistic regression  we implemented logistic regression
using the glmfit function in matlab  with a logit link
function 
   linear svm  we implemented a linear support vector
machine using the liblinear package in matlab  feature vectors were scaled to the range      to      as suggested by the
liblinear authors 

bandpower features
dwt features

 

   radial  gaussian  svm  we implemented the svm
radial kernel using the libsvm package in matlab  feature
vectors were also scaled to the range      to      as with the
linear kernel 

c  training methods

training error

ratio of means

fig     logistic  values were compared for both bandpower based and
dwt based features to identify those most important feature for seizure
prediction  for bandpower  the most highly weighted features corresponded to
low frequency bands  for dwt based features  the the most highly weighted
statistic was the ratio between the means of adjacent frequency bands  lower
frequencies were also more highly weighted for   of the   statistics  mean 
sum of squares  and ratio of means   note that  values represent the average
over    channels 

hierarchichal time series with different frequency bands         hz         hz        hz          hz            hz  and
       hz  fig    right   the following statistical features were
calculated to represent the time frequency distribution of the
eeg signals  as originally proposed in     
   mean of the absolute values of the wavelet coefficients
in each sub band  x   
   average power  i e  sum of squares  of the wavelet
coefficients in each sub band   nx   
   standard deviation of the coefficients in each sub band
x  
   ratio of the absolute mean values of adjacent sub bands
 x      x     
with   different sub bands this gives a total of a        
           features  because each recording consists of   
separate channels  the total number of features per   s interval
was thus              

 

sum of squares

 
hz
  
 
   hz
  
h
   z
 
hz
  
  
hz

 

fig     learning curves for each combination of learning algorithm and
feature set were analyzed for potential over  or under fitting problems  each
dataset contains six hundred of   second intervals 

   

theta values

theta values

                 

number of training datasets

dwt feature

logistic regression

 

 

standard deviation

 

 
 

dwt
mean

  
  
     
   hz
 
     h
      z
  h
       z
    
   hz
 
      h
   z
 
     h
 z
  
    
   hz
 
     h
   z
    
  h
       z
    
   hz
 
      h
   z
  
  
hz
  
     
   hz
 
     h
      z
  h
       z
    
   hz
  
 
  
      h
  
            z
     
hz
    
                
          
        h
                z
            h
         z
      
         h
       z
    
   hz
  
 h
z

 
   
   
   
   
   
   
   
   
   
 
 

number of training datasets

 

  
 

b

 

 

  

number of training datasets

 

 

testing
training

  

 

 
   
   
   
   
   
   
   
   
   
 
                 
 

 
 

 

 

 
   
   
   
   
   
   
   
   
   
 
                   

svm   radial

  
 

 
   
   
   
   
   
   
   
   
   
 
 

bandpower

 

svm   linear

  

error rate

bandpower feature
logistic regression

hz

a

    

svm linear svm radial

fig             hold out cross validation showed that logistic regression
and the linear svm using dwt based features result in the lowest error 
error bars give standard error across    repeated trials 

 

fia

inter ictal eeg  y     

   

 
   

 
   

 

voltage  v 

b

 

 

 

 

 

 

 

 

 

  s classification

decision window

 
 

 

 

 
 
time  min 

 

 

 

 

 

 

  

  

area under roc

   
   

    

   
logistic bp
svm linear bp
svm radial bp
logistic dwt
svm linear dwt
svm radial dwt

   

   
 

 

 

 
 
decision window

 

 

 

 

 

 

  s classification

 

 

 
time  min 

 

 

 

 

 

 

 

    

    

   

 

 

    

   

pre ictal eeg  y     

   

   

     
     

   
true positive rate

voltage  v 

a

  

 

b

  

 

   

   

   

               
false positive rate

   

   

 

 
   

fig     representative classification of   s intervals for inter ictal  a  and
pre ictal  b  eeg recordings are shown  a decision window of varying size
is then applied for seizure prediction and generation of roc curves 

   
true positive rate

   

that a prediction can be made at a finer temporal scale  fig 
   
f  downsampling pattern

   
   
   

window size  s 

 
  
  
  
   
   
   

   
   

two different patterns were tested for reducing energy consumption and bandwidth usage  periodic and random downsampling  periodic downsampling is equivalent to reduce the
sampling rate of the original signal  because of the recent
development of compressed sensing theory  random downsampling has also become popular for signal recovery after
downsampling      thus the random downsampling pattern
was also tested in this project 

   
 

 

   

   

   

               
false positive rate

   

   

 

fig      a  the false positive rate versus true positive rate of different
algorithm and feature combinations was compared with a    min decision
window  similar to cross validation  logistic regression and the linear svm
using dwt based features outperformed all other models   b  as the window
size increases  the linear svm using the dwt based feature set gives better
seizure prediction performance 

iii  r esults
a  identification of the optimal seizure prediction algorithm

   selection of the optimal feature and learning algorithm 
we next sought to identify the optimal feature and learning
algorithm with         hold out cross validation  as shown
in fig     training with logistic regression or a linear svm
using the dwt based feature gave the best performance 
achieving less than     training error and less than      testing
error  the radial svm exhibited poor performance  resulting
in almost     training and testing error using the bandpowerbased feature  thus  we conclude that the logistic regression
and radial svm algorithms using the dwt based feature are
optimal for seizure prediction 
   investigating the most important features  we next
analyzed the  values of the logistic regression model to
determine which elements are the most important  as shown
in fig   a  we found the highest bandpower  value is at
the frequency band      hz  which indicates that the most
important differences between the pre ictal and inter ictal
states are stored in this band  similarly  we found the lower

   validation of features and learning algorithms  we
first sought to confirm that the chosen learning algorithms
could classify eeg signals as pre ictal or inter ictal above
a     chance level and diagnose if learning was subject
to under  or over fitting  fig    provides the learning curves
for each learning algorithm using the bandpower  and dwtbased features  logistic regression and the linear svm gave
comparable performance for either feature set  while the radial
svm failed to learn using the bandpower based features and
resulted in relatively higher testing error rate using dwtbased features  with the exception of the radial svm using
bandpower based features  the general shapes of the learning
curves were consistent with expectations  as the training set
size increased  the training error went up  while the testing
error went down  thus the logistic regression and linear svm
models successfully used the extracted features to predict preictal versus inter ictal states 

 

fi   

   x    hz

    
   
    

   

   
downsampling ratio

   

downsample factor   x     hz 

downsample factor    x    hz 

   

  x     hz

fully sampled     hz

periodic downsampling

 

   x    hz
  x     hz

    
   

a

random downsampling
periodic downsampling

true positive rate

  sec cv error

    

   

   

window size  s 
 
  
  
  
   
   
   

   
   
 
 

   

   
   
false positive rate

b

fig       s interval cross validation error of linear svm using the dwt based
features as a function of downsampling rate  two different downsampling
patterns were investigated  periodic and random   for both downsampling
patterns  the optimal algorithm achieved less than     error when the downsampling ratio was less than     when the downsampling ratio approaches
     i e  only one sample is acquired per channel each second   the error rate
increases to      

   

window size  s 
 
  
  
  
   
   
   

   

   

   
   
false positive rate

   

 

random downsampling

 

downsample factor   x     hz 

downsample factor    x    hz 

true positive rate

   

frequency coefficients are also weighted higher in the dwtbased features  importantly  most significant features that were
used for recognition are the ratios between absolute signal
means  x   x    for the dwt based features 
   seizure classification using decision window  the results
reported above refer to the classification of individual   s intervals  because we were ultimately interested in classifying the
eeg signal as pre ictal or inter ictal at different time scales 
we applied simple thresholding on intermediate   s decisions
within a decision window  fig      by varying the seizure
prediction threshold for a    min decision window  an roc
curve that quantifies the true positive and false positive rate at
different threshold is obtained  fig   a   it can be concluded
that the dwt feature with logistic regression or a linear svm
gave superior performance  more than     area under roc
curve   the bandpower based feature had worse performance
than dwt for each learning algorithm  the radial svm still
performed worse than both logistic regression and the linear
svm for either feature  the size of the decision window was
also investigated using one of the best learning algorithms 
i e  dwt feature with a linear svm  as shown in fig   b 
we found that the seizure prediction performance increases
with window size  surprisingly  reasonable performance     
area under roc curve  could still be obtained with only a  
s window 

   

   
 
 

window size  s 
 
  
  
  
   
   
   

window size  s 
 
  
  
  
   
   
   

   

   

   
   
false positive rate

   

   

   

   
   
false positive rate

   

 

fig     although downsampling increased the error rate for   sec classification  the seizure prediction performance could be improved by using a larger
decision window  for example  when the   s interval was downsampled by
   times  our system could still achieve greater than     true positive rate and
less than     false positive rate using a decision window of at least   s 

because the aliasing pattern is more coherent using the periodic
undersampling and thus the learning algorithm could pick up
the aliased features more easily 
   improving performance with larger decision window
sizes  although we showed that the   s cross validation error
increased as the downsampling ratio increased  the seizure
prediction performance could be preserved by increasing the
decision window size  as shown in fig     we investigated the
roc curve with   x and    x downsampling using seven different window sizes  the roc curves are approximately equal
between the periodic and random downsampling methods 
with a window size larger than   s  we found that the optimal
algorithm could still achieve a higher than     true positive rate
and less than     false positive rate when the downsampling
ratio was as high as     at     times downsampling  we found
that decision windows larger than    s could still achieve
similarly high prediction performance  i e  larger than     true
positive and less than     false positive rate  

b  robustness of the optimal seizure prediction algorithm
under downsampling

iv  c onclusions   d iscussions

   cross validation error vs downsampling ratio  we investigated the robustness to downsampling of one of the optimal
algorithms  linear svm with dwt based features   as shown
in fig     the cross validation error using the   s intervals
slowly increased from      to     as the downsampling ratio
increased to     when the downsampling ratio reached    x 
the algorithm failed to correctly classify the   s intervals and
the error dramatically increased to about       another finding
from this test is that the periodic downsampling performs
slightly better than the random downsampling  which could

in this project  we developed an energy efficient algorithm
for seizure prediction  we investigated two different types
of features  powerband based and dwt based   and three
different learning algorithms  logistic regression  linear svm
and radial svm   after cross validation  we found that logistic
regression and linear svm using the dwt based features
outperforms all other algorithms  we also found that low frequency signals contain the most information on the differences
between pre ictal and inter ictal brain states  to improve the

 

firobustness of our classification  we designed a decision window method for seizure prediction  with window sizes as large
as    s  the algorithm could achieve greater than      true
positive rate and less than      false positive rate  surprisingly 
performance was still far better than chance with decision
windows as small as   s  we next investigated the robustness
of one of the optimal algorithms  linear svm with dwt based
features  to downsampling  we found the cross validation error
increased with larger downsampling ratios  although the error
rate was still less than     for downsampling ratios less than
    we also showed that large decision windows could be
used to improve the prediction accuracy using downsampled
data  for example  with a window size larger than   s  we
achieved a greater than     true positive rate and less than    
false positive rate using data sampled at only    hz 
one interesting finding from this project is that the learning
algorithm still performs well when the eeg signal is downsampled with aliasing artifacts  this could be because most
of the important features were stored in the low frequency
domain  another possible reason is that even when the signal
is aliased  the learning algorithm could still use features at
specific aliased locations for classification 
with the proposed robust seizure prediction algorithm 
energy consumption and bandwidth usage on wearable eeg
devices can be largely reduced  this method can also be
implemented in other personal wearable devices  such as a
heart rate monitor  for higher energy efficiency and longer
battery life 

acknowledgment
the authors would like to thank professor andrew ng for
his inspirational lectures and sharing his enthusiasm for the
machine learning  we would also like to thank all tas for
their thoughtful suggestions for this project 
r eferences
    f  mormann  r  g  andrzejak  c  e  elger  and k  lehnertz  seizure
prediction  the long and winding road  brain  vol       no     pp     
          
    y  park  l  luo  k  k  parhi  and t  netoff  seizure prediction with
spectral power of eeg using cost sensitive support vector machines 
epilepsia  vol      no      pp                 
    j  j  howbert  e  e  patterson  s  m  stead  b  brinkmann  v  vasoli 
d  crepeau  c  h  vite  b  sturges  v  ruedebusch  j  mavoori et al  
forecasting seizures in dogs with naturally occurring epilepsy  plos
one  vol     no     p  e            
    a  subasi  eeg signal classification using wavelet feature extraction and
a mixture of expert model  expert systems with applications  vol     
no     pp                 
    z  zhang  t  p  jung  s  makeig  and b  d  rao  compressed sensing
of eeg for wireless telemonitoring with low energy consumption and
inexpensive hardware  biomedical engineering  ieee transactions on 
vol      no     pp               

v  f uture w ork
since the analysis was conducted on a single animal  more
experiments should be conducted to justify the method  the
energy savings gained from downsampling should also be
investigated so that an optimal decision window size can be
identified for embedded applications 

 

fi