recognition and classification of fast food images
shaoyu lu  sina lin  beibei wang
shaoyu   stanford edu   sinalin stanford edu   beibeiw stanford edu

abstract
we aim to utilize learnt machine learning algorithms to do fast food recognition  our goal is to find a
computational efficient algorithm with high accuracy 
we use bag of sift  color histogram and a combination of them as the features  k nn and svm method
 with and without kernel  are used to classify fast food
images to eight classes 

   introduction
food recognition is of great importance nowadays
for multiple purposes  on one hand  for people who
want to get a better understanding of the food that they
are not familiar of or they havent even seen before 
they can simply took a picture and get to know more
details about it  on the other hand  the increasing demand of dietary assessment tools to record the calorie
and nutrition has also been a driving force of the development of food recognition technique  therefore 
automatic food recognition is very important and has
great application potential 
however  food varies greatly in appearance  e g  
shape  colors  with tons of different ingredients and
assembling methods  this makes food recognition a
difficult task for current state of the art classification
methods  and hence an important challenge for computer vision researchers  yoshiyuki kawano and keiji
yanai  kawano and yanai        proposed a real time
food recognition system which adopted a liner svm
with a fast   kernel  bounding box adjustment and
estimation of the expected direction of a food region 
lukas bossard et al   bossard et al         presented
a novel method based on random forests to mine discriminative visual components and efficient classification 

figure    examples from the food image dataset  left 
original dataset  middle  colorcorrected dataset 
right  colorcorrected segment dataset 

in this effort  we intent to utilize learnt machine
learning algorithms to do fast food recognition and
classification  our goal is to develop a computational
efficient algorithm with high accuracy  different features and models have been implemented and compared 

   dataset
the dataset we used in this study was based on
the pittsburgh fast food image dataset  pfid  images  this dataset was proposed by chen et al 
 chen et al         to properly evaluate the performances of food recognition  this dataset is composed
by      food images with rgb color of fast food
dishes mainly acquired in laboratory 

   pre processing
because the original dataset contains different lighting for the same food  we used white balance to
do color correction in order to minimize the within
class variance  besides  the background is not related to the food  thus background segmentation was
used to enable only food features being extracted 
figure   shows one set of example from the three
datasets  original  color corrected  color corrected plus
background segmentation   we labeled the food images into eight categories  bread sandwich  breakfast

fi   features and models
     features
in this study  two popular features in terms of image processing including bag of sift  scale invariant
feature transform   lowe        and color histogram
were chosen to capture the image content in our fast
food images 
we chose sift to extract food image textures and
used bag of features since its invariant to spatial translation and rotation  and it can provide fixed length feature vectors we chose color histogram to extract color
distributions  to ensure both efficiency and accuracy 
we choose    bins per rgb color  later on  we explored combining these two features together and obtained a better result 

     models

   

classification accuracy    

sandwich   burger  chicken  donut  pancake  pizza 
salad and sandwich  classification results comparison among these three datasets will be discussed later 

effect of dimensionality of data on classification accuracy

  
  
  
shrink image
to ratio of    

  
  
  
  
  
  
   

   

   
pixel number of images

   

   

figure    effects of dimensionality on classification  the
data was colorcorrected  modeling used bag of sift
and svm with   kernel 

the bag of sift and   kernel were employed using code from vlfeat  vedaldi and fulkerson        
svm code is from liblinear  fan et al         and
k nn is from matlab machine leaning toolbox  we
developed our own code to compute the color histogram without counting the background color 

   performance analysis

k nearest
neighbors
algorithm
 k nn 
 cover and hart        and support vector machine  svm   suykens and vandewalle        were
used as learning methods in our study  they are two
popular discriminative classifiers with no distribution
requirement  k nn is simple to implement with
usually good result  and the accuracy of this method
can be highly influenced by parameter k  figure
    svm was chosen since its very robust and
well developed for classification   kim et al        
it was originally designed for two class problems 
therefore  we utilized one versus the rest method
in our multi class problem 
moreover    kernel was utilized for both methods as some study shows that its good at image texture recognition   zhang et al           kernel is often used with bag of feature since it is a more natural distance measure between histograms than the euclidean distance   yang et al         the   kernel
comes from the   distribution 

k 
x
xi  i  
i  

i

where xi  n  i   i     i              k 

   

     effects of data dimensionality
data dimensionality can affect the classification accuracy a lot  thus  we need to find an optimal dimension  from figure    at the beginning  the accuracy
increases very fast as the dimension increases  however  when the dimension reaches       the accuracy
increases very slowly  and even decreases a little when
dimension reaches       this is because  when the dimension is too high  the volume of the data space concentrates on the surface  therefore available feature dimension wont increase  thus increasing dimensionality wont help classification at this point  in this study 
the optimal dimension is         which corresponds
to shrink image to     along both x  and y axis 

     effects of k in k nn
from figure    increasing number of neighbors improves the accuracy because it helps reduce noise effects on k nn classification  but including too much
neighbors would ruin the classification  as neighbors
from incorrect class would be involved  from the classification accuracy on test data  we choose the number
of nearest neighbors to be   

fieffects of k on k nn accuracy

      
     

  

     
  

     

accuracy  

classification accuracy    

  

  
we choose k  

  

     
     

with  kernel  

     

  
  
 

     

without  kernel  

     
 

 

 

 

 

 

 

 

  

k  number of nearest neighbors 

     
    

figure    effects of number of nearest neighbors on k nn 
the data here is the colorcorrected    kernel is used 

classification accuracy    

bag  of  sift     
color  
bag  of  sift     k 
svm  
histogram     k 
nn  
nn  

figure    kernel effects on svm and k nn classification
accuracy

accuracy vs  size of training data

  

color  
histogram     
svm  

  
  

     comparison of features and models

  
  
  
  

  

  
  
number of training data in each class
 number of test data is the half 

  

  

figure    effects of data size on classification  the data here
is the colorcorrected  using bag of sift and svm with
  kernel 

     effects of training data size
in this test  we kept the ratio of training data size to
test data size to be   to   and increased the training data
size to see the effects  from figure    the more training data we have  the better classification accuracy we
can obtain  notice that the accuracy increases slowly
when the training size reaches     since the time complexity would increase linearly with data matrix size 
to balance the accuracy with speed  we choose to randomly pick    images from each class as training data
and    as test data 

confusion matrix was used to capture the classification accuracy on the test dataset  figure   shows examples of confusion matrix of classification results on
colorcorrected dataset with color histogram  left 
and bag of sift  right   using k nn  top  and svm
 bottom     kernel was implemented in all cases 
comparing top two with bottom two figures  we can
see svm achieves much better results than k nn 
moreover  from the top two figures  color histogram
performs better on images with more distinct color features such as salad  the accuracy by color histogram
is      on salad while the accuracy by bag of sift is
      on the other hand  bag of sift performs better
for images with distinct textures  such as donut  the
accuracy by color histogram is     on donut while
the accuracy by bag of sift is       the bottom two
matrixes indicate the same conclusion 
in order to take advantages of both color and texture
characters  we linearly combined color histogram and
bag of sift to a new feature  named colorsift  

   results and discussion
     the importance of kernel
as shown in figure      kernel helps svm gain
much better accuracy  this is because svm is a linear classifier who suffers from under fitting  kernel
enables svm to work on high dimensional non linear
problem  which greatly benefits svm  thus we chose
to utilize kernel in following experiments 

colorsift   colorhist    bagofsift    
where  is the weight parameter for color histogram
and     is the weight parameter for bag of sift 
from experiments  we find the optimal of  is      as
shown in figure    the accuracy increased to      
compared with the formal best       

fi              color histogram           vs             bag of sift 
bag of sift and knn confusion matrix          accuracy with kernel 

color histogram and knn confusion matrix          accuracy with kernel 
breadsand

breadsand

    

burger

true class

true class

donut

    

pancake

    

salad

sandwich
pizza

    

pancake

    

    

    

sandwich

    
pancake

donut

salad

    

donut

    

pizza

    

breadsand burger chicken

    

chicken

    

pizza

    
breadsand burger chicken

salad sandwich

chicken

    

breadsand

    

burger

    

donut

    

pancake

    

pizza

    

salad

sandwich
pancake

pizza

    

donut

    

pancake

    

    

salad

    
donut

salad sandwich

    

pizza

    

breadsand burger chicken

pizza

    

chicken

true class

burger

pancake

bag of sift and svm confusion matrix          accuracy with kernel 

color histogram and svm confusion matrix          accuracy with kernel 
breadsand

donut

predicted class

predicted class

true class

svm                      vs                    k nn 

burger

    

chicken

    

    

sandwich

salad sandwich

    
breadsand burger chicken

predicted class

donut

pancake

pizza

salad sandwich

predicted class

  
figure    confusion matrix on colorcorrected dataset with color histogram  left  and bag of sift  right   using models
of k nn  top  and svm  bottom     kernel was utilized in all cases 

model
svm
 with kernel 
svm
 without kernel 
k nn
 with kernel 
k nn
 without kernel 

feature
bag of sift
color histogram
bag of sift
color histogram
bag of sift
color histogram
bag of sift
color histogram

original dataset
      
      
      
      
      
      
      
      

segmented dataset
      
      
      
      
      
      
      
      

color corrected dataset
      
      
      
      
      
      
      
      

table    classification accuracy comparison among the original  colorcorrected and colorcorrected segment dataset 

     comparison between different dataset

   conclusion

from table    we can see three datasets achieve almost the same accuracy via different algorithms 

to recognize different kinds of food with various
appearance  we extracted color and texture features

fibag of sift   color histogram and svm confusion matrix          accuracy with kernel 
breadsand

burger

true class

chicken

    

    

    

donut

    

pancake

    

pizza

    

salad

    

sandwich

    
breadsand burger chicken

donut

pancake

pizza

salad sandwich

predicted class

figure    confusion matrix on colorcorrected dataset with combined feature of color histogram  left  and bag of sift
 right   using model of svm with kernel 

from food images  and utilized k nn and svm to
do the classification  to achieve a higher accuracy 
we linearly combined the two kind of features and
adopted the   kernel  with performance analysis like
dimensionality and data size  we accomplished a highaccuracy result with great computational efficiency 

   future work
we plan to study for better background segmentation and color correction in image processing  we
are also going to explore more machine learning algorithms and technique details  moreover  we will
test algorithms with food images with real life environment 

references
 bossard et al         bossard  l   m  guillaumin  and l 
van gool        food    mining discriminative components with random forests  in computer visioneccv      
springer         
 chen et al         chen  m   k  dhingra  w  wu  l  yang  and
r  sukthankar        pfid  pittsburgh fast food image dataset 
image processing  icip          th ieee international conference on  ieee         
 cover and hart        cover  t   and p  hart        nearest
neighbor pattern classification  information theory  ieee
transactions on           
 fan et al         fan  r  e   k  w  chang  c  j  hsieh  x  r 
wang  and c  j  lin        liblinear  a library for large linear

classification  the journal of machine learning research    
         
 kawano and yanai        kawano  y   and k  yanai       
real time mobile food recognition system  computer vision
and pattern recognition workshops  cvprw        ieee
conference on  ieee     
 kim et al         kim  j   b  s  kim  and s  savarese       
comparing image classification methods  k nearest neighbor
and support vector machines  proceedings of the  th wseas
international conference on computer engineering and applications  and proceedings of the      american conference
on applied mathematics  world scientific and engineering
academy and society  wseas          
 lowe        lowe  d  g         object recognition from local scale invariant features  computer vision        the proceedings of the seventh ieee international conference on  ieee 
         
 suykens and vandewalle        suykens  j  a   and j  vandewalle        least squares support vector machine classifiers 
neural processing letters            
 vedaldi and fulkerson        vedaldi  a   and b  fulkerson 
      vlfeat  an open and portable library of computer vision
algorithms        
 yang et al         yang  j   k  yu  y  gong  and t  huang       
linear spatial pyramid matching using sparse coding for image
classification  computer vision and pattern recognition       
cvpr       ieee conference on  ieee           
 zhang et al         zhang  j   m  marszaek  s  lazebnik  and
c  schmid        local features and kernels for classification
of texture and object categories  a comprehensive study  international journal of computer vision             

fi