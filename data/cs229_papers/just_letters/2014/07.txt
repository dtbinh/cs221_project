predictingcelltypespecificchromatinstatesfromgeneticregulatorynetworks
christopherprobert anthonyho

introduction
the human body consistsofhundredsofuniquecelltypeswithuniquecharacteristics butyetall
contain the same  dna sequence  this disparity is created by cell typespecific gene regulation 
which drives complex patternsofexpressingcertaingenesetsinspecificcelltypes  anddifferent
gene sets in others  an important  variable in this regulatory program is the physical state of
chromatin acomplexofdnaandproteinsinsidethenucleusofcells 
the packaging of a human genome into chromatin allows different regions of the genome  in
particular  enhancer elements  to be made accessibleorprotectedfromdifferentgene regulators 
which are proteins thatbinddnaandactivateorrepressexpressionofgenes understandingthe
factorsaffectingenhancerchromatinstatemayrevealprocessesthatgoverncelldifferentiation 
here  we seek to predict chromatin states in diverse cell types from regulator gene expression
profiles and prior information about regulatory gene physical characteristics  we built a model
based on a boosted alternating decision tree  adt  to predict the chromatin state of genomic
enhancerregions usingmotifcompositionandcellulargeneexpressionasinputfeatures 

dataset
our data is derived from recent largescale genomics projects by the two sequencing consortia
 epigenomics roadmap  and encode     the primary results are data from various types of
sequencingexperimentsacross   differentcelllines 
chromatin states  chromatin states are the labels we wish to predict  dnaseseq experiments
quantify chromatin state  by  degrading dna at sites not protected by chromatin structure 
 dnaseseqdatafromencode dnaseseqdatafromepigenomicsroadmap 
regulator expression  we use  regulator gene expression as a feature to capture variation across
different cell types  encode rnaseq data measures gene expression for     cell types  for
the remaining    cell  types  we used regularized logistic regression models developed by the
kundaje lab at stanford  to impute expression values from other epigenomic state information 
 encodernaseqdata 
motif presence  we use motif presence as a feature to capture variation between enhancer
regions theinputdataareasetofsystematicallydiscoveredhumanregulatorbindingmotifs  
enhancerregions weused thehumangenomeforenhancerannotationsand sequences  genome
hg   




 

fifeaturesandpreprocessing
featurespace
our enhancercell type training examples have both intragenomic and intergenomic variation 
they are from both different positions in the genome  and from different cell  types  to capture
both sources of variation  we use two feature spaces  motif occurrence per enhancer  to capture
variance by genome position   and regulator expression percelltype tocapturevariancebycell
type   thus  for each enhancercell type training example   our model hasachromatinstatelabel
andtwofeaturevectors    geneexpressionvaluesand   motifpresencevalues  
we believe these features are appropriate because they capture variation on both the genomic 
enhancer region and cell type axes  for performance  we  represent the feature space as three
matrixes  figure     where the goalistopredicttheenhancerstatematrixfromtheinnerproduct
space of the motif occurrence and regulator expression  matrices  the model can be represented
as y     f  x t   x t     wherethegoalistolearnthefunction f  

figure    feature space overview  each
example is anenhancercelltypepair   y     this 
corresponds to an enhancer motif presence
vector   x      and a cell type gene expression
vector  x     


preprocessing
regulator expression  we normalized
rnaseq data for each cell type using
standard techniques  fpkm   we used
a list of     encode transcription
factors  as our list of regulator genes 
and extracted expression values for
these genes in each cell type as a
matrix  we used a    fpkmthreshold
tobinarizeexpressionvaluesintheregulatorexpressionmatrix  x     
motif occurrence  we searched genomic enhancer regions using an hmm modelforeachmotif
fromthesetofhumanregulatorymotifs  webinarizedmotifpresenceineachgenomicenhancer
regiontoobtainthemotifoccurrencematrix  x     
enhancer state  we used preprocessed dnaseseq binarized peak calls to obtain genomic
chromatin state  we intersected this binarized chromatin state  data with genomic enhancer
annotationstoobtainbinarizedchromatinstateforeachenhancer  y     




 

fimodeloverview
we wish to predict thechromatinstateofagivenenhancercelltypepairfrominformationabout
the motif structure and cell type regulator expression  the input for the model is a regulator
expression vector and  a motif composition vector for a previously unseen enhancercell type
pair  the output of the  model  is an enhancer chromatin state  which is a binarized value  the
modelistrainedonlabeledchromatinstatecelltypeexamples 
responsevariablefunction
let y be the chromatin state response variable  c be the cell type expression vector  and m be
the motif occurrence vector  where y   c   r arebinarized  then forone  m  c   pair ourmodel
is y   f  m  c     extending this to the feature space described in figure    this can be written
usingthetheinnerproductspace x t   x t  as 
 y     f  x t   x t    
boostedalternatingdecisiontree
alternating decision trees are an extension
of decision trees  where condition nodes ri 
have true false outputs  and prediction
nodes carry realvalued weights ai   the
hypothesis h x  is generated by summing
over all condition prediction node pairs in
anadt a  
a

h x     ri x   ai 
i

figure    adt architecture overview adts have 
prediction nodes ai   yellow astheirrootsandleaves 
which carry realvalued weights the conditionnodes
ri   blue  usearulebasedononemfeatureandonec 
feature 

modelmodifications
we made two modifications to the base
algorithm        only using positive
conditional logic in condition nodes and  usingadifferentzobjectivefunctionthatisfasterto
calculateandonlyincludesweightsforexamplespassingtheconditionnode 
   positive conditional logic makes the model more representative of a biological system 
because we are trying to model the effects of  motif  regulator  pairs on cell type decisions 
the absence  of a motif or regulator does likely not confer asstrongofan effectaspresence 
reproducibility and sensitivity issues with sequencing data also introduce noise that may
create false negatives  and a model without weights on negative conditions is likely more 
robust totheseerrors aregular adt   haspredictionnodesforboth trueandfalseoutcomes
of a condition node  whereas our model has only prediction nodes for true outcomes  e g 
i   ri false        
 

fi   the algorithm seeks to minimize the z  loss  objective function  the regularlossfunction   
is  z      w   p  c w  p  c    w   p  c w  p  c    w  p  c    where w  x  is

 

 

the sum of weights for examples meeting condition x   and w     are sums for positive or
negative examples only  we used the function z      w   p  c w  p  c    w  p  c  
instead  as we are only interested in positive examples  and this requires fewersearchesofa
largematrix    mx     
implementation
we implemented the boosted adt model in python  using numpy sparse matrixes to reduce
memory footprint  and the gnumpy  gpu matrix algebra library to speed up implicit inner
productstepsonthelargefeaturematrixes 

results
we used two different methods to train test our model     randomholdoutoftrainingexamples 
and    leave  one out crossvalidation  loocv  by cell type  these methods present  two 
possible different use cases for the model  and have different results  as our dataset is
unbalanced weusedbalancederrorrate ber forerroranalysis 

figure    error rate analysisoftwoscenarios thelearningcurve left showsbalancederrorrate ber for  
random holdout of training examples  our criteria for convergence was metat      iterations howeverwecontinued
training to  observe overfitting  the ber distribution  right  shows bers for cell type loocv at convergence  the
middleandrightdistributionsaresplitbymeasured middle andimputed right geneexpression 





 

fidiscussion
in the random holdout case  figure    left   the model achieves a          ber onthetestset 
with minimal overfitting        training ber   since the adt algorithm adds one condition
node and one prediction node at each iteration  iteration number is a direct measure of model
complexity  as expected  overfitting  the separation of training and test error  increases with
model complexity  at     condition nodes training  and test ber are within       but at    
conditionnodestrainingbalancederroris    lessthantestbalancederror 
in previously unseen cell types  the model achieves a      average loocv test ber  in this 
setting  the model exhibits much stronger overfitting        average training ber at
convergence       higher than training error   thebalancederrorrateishigherincelltypeswith
imputed         expression than with  measured expression          figure    right   suggesting
thatusingimputedexpressionfeaturesdecreasesaccuracyofchromatinstatepredictions 
conclusion
wehaveshownthatboostedadtscanpredictchromatinstatesusingtwomethods 
random holdout  our model performs well      test ber at convergence forchromatinstate
prediction when data points are randomly held out of training  this method isusefulforseveral
applications  such as denoising chromatin state data identifyingirregularchromatinstate points 
and learning about how specific motif regulator pairs confer chromatin state and cell type
specificity 
previously unseen cell types  intuitively  predicting chromatin states of unseen cell types is a
significantly harder problem than random data holdout  because the new cell types may have
different regulatory dynamics than the cell types trained on  the model assumes that the
response variable  y   f  m  c   is from the same distribution  y   m   c   in the training set as in
thetestset andthismaynotbetrueiftheunseencelltypehasdifferentregulatorydynamics 
future
given more time  we would like to  improve performance on the loocv case by identifying
patterns inerrorsand noising bootstrappingthetrainingset wewouldalsoliketotryexpanding
the feature space to include somenotionoflocalgenomiccontext suchasnearby transcriptional
activity  moreover  regulators such as transcription factors are known to function in conjugates
 called dimers or complexes   and by comparing accuracy  of instantiations of our model with
different factorizations of regulators or groups of regulators  we could elucidate combinatorial
effectsofregulatorygeneactivity 
acknowledgements
wethankprof anshulkundajeandkundajelabmembersforadviceonthisproject 
references
   y freundandl mason thealternatingdecisiontreealgorithm icml      
   b pfahringer g holmesandr kirkby optimizingtheinductionofalternatingdecisiontrees kdd      
   encodeconsortium anintegratedencyclopediaofdnaelementsinthehumangenome nature      
   roadmapconsortium thenihroadmapepigenomicsmappingconsortium naturebiotechnology      
   xieetal systematicdiscoveryofregulatorymotifsinhumanpromoters nature      
   s kyriazopouloupanagiotopoulou a kundaje unpublishedwork      
   t tieleman gnumpy aneasywaytousegpuboardsinpython tnml      

 

fi