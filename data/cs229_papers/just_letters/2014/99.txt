any given sunday 
forecasting nfl quarterback performance
steven hoerning

bobak moallemi

matthew wilson

december         

abstract
we used multinomial logistic regression and support vector machines to predict the number of
touchdowns a quarterback will throw in an upcoming game  our best model correctly predicted
a quarterbacks passing touchdowns       of the time with a mean square error of       this
compares favorably to espns forecasts  which in      correctly predicted a quarterbacks
passing touchdowns     of the time with a mean squared error of      

  

introduction

fantasy sports is a broad genre of games in which participants act as owners  assembling teams of
players to compete against other fantasy owners based on the measured individual performance
of real players  fantasy football is the most popular version of this game among americans 
close to    million people participated in fantasy football leagues last year  spending around
     million on fantasy media products  in fantasy football  participants compete head to head
by selecting nfl players to fill a lineup for a given week  at the conclusion of each game 
each players performance is translated into points by a predetermined formula  for example 
quarterbacks get   points for touchdowns and     points per passing yard  the fantasy player
with the most points after the conclusion of a week wins the matchup 
in this project  we used machine learning to predict the number of passing touchdowns a
quarterback will throw in an upcoming game  to accomplish this we used multinomial logistic
regression and support vector machines  forward selection was used to choose a set of predictive
features from approximately    features related to a quarterbacks passing touchdowns  our
models were evaluated based on their correct prediction rates and the mean squared error of
the predictions  we found that the prediction accuracy of our best models compared favorably
to espns predictions 

  

data and preprocessing

detailed nfl data is available from several data providers  but often at high cost  fortunately 
the website www pro football reference com has a relatively complete collection of nfl data
available at no charge  in order to avoid violating their terms of service  which explicitly
prohibit automated scraping  we manually downloaded data from the      through the     
nfl seasons  after formatting  our data consisted of two tables   one containing team specific
data and the other containing player specific data  the team data includes    features that

 

ficorrespond to what a particular team did in a particular game  for example  this data includes
features such as the total rushing and passing yards a teams offense accumulated  the player
data includes    features that represent a players performance in a particular game  this
includes variables such as touchdowns and passing yards  as well as more detailed information
such as where receivers were targeted on the field  in total  our data consists of       team
performances and        player performances 

  

models and features

we approached our classification problem with both multinomial logistic regression and support
vector machine models  for both types of models  our features consisted of rolling averages of 
statistics specific to the quarterback  statistics specific to the quarterbacks offense  and statistics
specific to the opposing defense  statistics specific to the quarterback include passing yards 
passing touchdowns  interceptions  pass completions and pass attempts  statistics specific to
the quarterbacks offense include turnovers  rushing yards  total yards  sacks  and points scored 
statistics specific to the opposing defense include total yards allowed  points allowed  sacks  and
passing yards allowed  we decided to use a rolling average of these relevant statistics because
each of them can vary greatly from one game to the next  we evaluated our models based on
the proportion of quarterback passing touchdowns correctly predicted and the mean squared
error of our predictions  both of which were estimated using using k fold cross validation  with
k       features were selected using forward selection for multinomial logistic regression and
backward selection for support vector machines  for both the forward and backward selection
we attempted to optimize the proportion of correct predictions 

  

results and discussion

our support vector machine models and multinomial logistic regression models predicted passing touchdowns with similar accuracy  multinomial logistic regression in general predicted more
touchdowns than svm and produced predictions with smaller mean squared errors  we creating features for both models we varied the number of previous games used in rolling average
calculations  in the tables below  the number of games used to create the rolling averages is
represented by m 

    

multinomial logistic regression

the results of our best logistic regression models for different values of m can be seen in the
table below  note that the best model as measured by proportion correct used only the most
recent game to make its prediction  m      
the best set of features found by forward selection can be seen in table    notice that the
best feature set varies depends greatly on m  that said  it is also important to realize that many
of the statistics considered for selection are highly correlated  for example  the number of total
yards a defense allows is high correlated with the number of passing yards a defense allows 
as the first table   shows  the best multinomial logistic regression model  as measured by
proportion correct  coincided with m     and was correct       of the time with a mean squared
error of       the confusion matrix for this model can be seen below  note that this model

 

fitable  

m

proportion correct

mean squared error

observations

 
 
 
 
 

      
      
      
      
      

      
      
      
      
      

    
    
    
    
    

table  

m

features
quarterback  passing 

offense

opposing defense

 
 
 

completions  yards
completions  interceptions
yards  interceptions

rushing yards  total yards
sacks  turnovers
rush attempts

 
 

attempts
attempts 
downs

points scored
points scored

total yards
passing yards
total  rush yards  rush
att 
sacks  total yards
rushing yards  points allowed

yards 

touch 

 and all of the other logistic regression models  never predicted more than two touchdowns for
a quarterback in a game  this could be considered a shortcoming of our models given that elite
quarterbacks regularly pass for three touchdowns in a game 
table  

true tds
 
 
 
 
 
 
 
frequency

predicting tds
 
 

      
      
      
      
      
      

      
      
      
      
      
      

      
      
      
      
      
      

   

    

   

 

fi    

support vector machines

in this section  we present our predictive results using a support vector machine  svm  with a
linear kernel   as was done for the logistic regression  we tested our svm using different values
of m  below  we list the features used within each iteration of the svm  as chosen by backwards
feature selection  just as logisitic regression  the feature selection for the svm varies greatly
table  

m

features
quarterback  passing 

 
 
 
 
 

yards  completions
yards  completions  touchdowns  attempts
yards  completions
yards  completions  touchdowns  attempts
yards  completions  touchdowns  attempts  interceptions

offense

opposing defense

total yards  points sored

rushing touchdowns allowed

total yards  points sored 
sacks allowed
total yards  points scored 
sacks allowed  turnovers 
rushing yards  rushing
touchdowns 
rushing
attempts  home away

rushing touchdowns allowed
passing
yards 
points
allowed  completions allowed  total yards allowed 
passing touchdowns allowed  interceptions  sacks 
passing attempts allowed 
rushing attempts allowed 
rushing yards allowed

with m  that said  the quaterbacks passing yards and passing completetions appear as features
for each m  note that for m      backwards selection simply chooses all the available features 
the following table details the predictive success of each svm  proportion correct equals the
table  

m

proportion correct

observations

 
 
 
 
 

      
      
      
      
      

    
    
    
    
    

fraction of correct predictions made by the svm  computed using k folds cross validation
with    folds  consistent with our results from the multinomial logistic regression  the svm
with m     seems to perform the best  in fact  the proportion of correct predictions is nearly
 

we experimented with a number of other kernels and found that the linear kernel performed best during cross
validation 

 

fiidentical  at         below  we include the confusion matrix corresponding to our svm model
with m      the svm does quite well when predicting a low number of passing touchdowns 
table  

true tds
 
 
 
 
 
frequency

predicting tds
 
 
 
      
      
      
      
      

      
      
      
      
      

 
 
 
 
 

   

    

 

the model is correct more than     of the time when it predicts zero touchdowns  however 
the model does extremely poorly for outcomes beyond one touchdown  in fact  it never predicts
a quarterback throwing more than two  while the logistic regression also fails to predict a high
number of touchdowns  say  three or more   it still predicts some two touchdown events  thus
outperforming the svm here 

  

conclusions

we used multinomial logistic regression and support vector machines to predict the number of
touchdowns a quarterback will throw in an upcoming week  our best model correctly predicted
a quarterbacks passing touchdowns       of the time with a mean square error of       this
compares favorably to espns forecasts  which in      correctly predicted a quarterbacks
passing touchdowns     of the time with a mean squared error of       that said  we are not
ready to conclude that our best model is superior to espns predictions because we have not
yet tested our models on the data from      

  

future work

we would certainly like to further compare our best models to espns model  the most direct
way to do this is to gather data on      and predict the outcome of these games using our models
trained on data from      to       the predictions of our models would be directly comprable
to those of espn  moving forward  we also intend to apply techniques similar to those used in
this project to predict other discrete fantasy football statistics such as quarterback interceptions
and touchdowns by non quarterbacks 

 

fi