stock trend prediction with technical indicators using svm
xinjie di
dixinjie gmail com
scpd student from apple inc
abstract
this project focuses on predicting stock price trend for a company in the near future  unlike some
other approaches which are concerned with company fundamental analysis  e g  financial reports 
market performance  sentiment analysis etc    the feature space is derived from the time series of
the stock itself and is concerned with potential movement of past price  tree algorithm is applied
to feature selection and it suggests a subset of stock technical indicators are critical for predicting
the stock trend  it explores different ways of validation and shows that overfitting tend to occur
due to fundamentally noisy nature of a single stock price  experiment results suggest that we are
able to achieve more than     accuracy on predicting a      day average price trend with rbf
kernelized svm algorithm 
keywords  stock prediction  feature selection  svm  stock technical indicator  scikit 

 

introduction

short term prediction of stock price trend has potential application for personal investment
without high frequency trading infrastructure  unlike predicing market index  as explored by
previous years projects   single stock price tends to be affected by large noise and long term
trend inherently converges to the companys market performance 
so this project focuses on short term       days  prediction of stock price trend  and takes the
approach of analyzing the time series indicators as features to classify trend  raise or down   the
validation model is chosen so that testing set always follows the training set in time span to
simulate real prediction  cross validated grid search on parameters of rbf kernelized svm is
performed to fit the training data to balance the bias and variances  although the efficient market
hyothesis suggests that stock price movements are governed by the random walk hypothesis and
thus are inherently unpredictable  the experiment shows that with      transaction days as
training data  we are able to predict aapls next day acutual close price trend with    
accuracy  better than the random walk  and more than     accuracy on next   day    day    day 
   day price trend  in the end  we conclude that stock technical indicators are very effective and
efficient features without any sentiment data in predicting short term stock trend 

 

feature space

    data collection
the data is pulled from http   finance yahoo com   i picked the   stocks  aapl  msft  amzn 
that have time span available from            to            to get enough data and   market
index  nasdaq and sp       the goal is to predict a single stocks trend  e g  aapl  using
features derived from its time series plus those from nasdaq and sp     for augmentation 
    features of stock indicators

fia stock technical indicator is a series of data points that are derived by applying a function to the
price data at time t and study period n  below is a table of indicators that i compute from time
series and transform to features 
indicators
willr

name
williams
 r

rocr

rate
change

mom

momentum

rsi

relative
strength
index

cci

commodity
channel
index

adx

average
directional
index
triple
exponential
moving
average
moving
average
convergence
divergence

trix

macd

obv

of

on balance
volume

description formula
determines  highest closed   highest lowest     
where
todays
closing
price
fell
within the
range
on
past
  days
transaction 
compute
 price t  price t n      
rate
of
change
relative to
previous
trading
intervals
measures
price t  price t n 
the change
in price
suggests the avg priceup   avg priceup  avg pricedown     
overbought
where  priceup t     price t  price t     price t and
price t       
oversold
pricedown t     price t    price t   price t market
price t       
signal 
identifies
tp t  tpavg t n        md t  
where 
cyclical
tp t   high t  low t  close t     
turns
in tpavg t n  avg tp t   over  t  t      t n    
stock price
md t  avg abs tp t  tpavg t n    
discover if sum   di   di     di   di   n
trend
is
developing
smooth the tr t  tr t   
where
insignificant tr t  ema ema ema price t     over n days
movements
period
use
different
ema
to
signal
buy sell
relates
trading
volume to

osc t  emaosc t 
where
osc t  ema  t ema  t  
emaosc t  emaosc t     k osc t emaosc t    
obv t  obv t      volume t 

fitsf

time series
forcasting

atr

average
true range

mfi

money flow
index

price change
calculates
the
linear
regression
of
   day
price
shows
volatility of
market
relates
typeical
price with
volume

linear regression estimate with    day price 

atr t    n    atr t    tr t   n where
tr t  max abs high low   abs hight close t     
abs low close t     
            money
ratio  
where
money
ratio   moneyflow  moneyflow  
moneyflow tp volume

the above technical indicators cover different type of features 
   price change  rocr  mom
   stock trend discovery  adx  mfi
   buy sell signals  willr  rsi  cci  macd
   volatility signal  atr
   volume weights  obv
   noise elimination and data smoothing  trix
also tsf is another feature that itself does linear regression to suggest trend 
   

feature construction and data labeling

those indicators are computed against different periods from   day to    day and each of them is
treated as individual feature in feature space  e g  rocr   rocr  means relative price to   days
ago and to   days ago relatively 
the feature set used for this project is defined as follows 

full features     adj close    obv    volume    rsi     rsi      sma     ema   
 ema      atr      mfi     adx      adx      mom     mom    cci    
 cci      rocr     rocr     outmacd    outmacdsignal    outmacdhist  
 willr    tsf      tsf      trix    bbandsupper    bbandsmiddle  
 bbandslower  
the feature matrix x is defined as  x t  is a row vector of  full features stocktopredict  
full features sp       full features nasdaq    hence the total features for an example is of
size   len full features       
depends on what we want to predict  the data is labeledwith up or down  y t  is the label for
data at time t  y t    f price t n  price t n    price t   where function f has the value in     
    in this setting  it is guaranteed that future price trend is unseen to any features 
for predicting the next day trend 
y t      if price t    price t   y t       if price t    price t  

fifor predicting the next   day average price trend 
y t      if sma t    sma t   y t       if sma t      price t  

 

model fitting and results

    feature selection with ensemble extremely randomized tree algorithm
limited by the length of document  im not describing the extremely randomized tree algorithm
here and it is in the reference  with total    features  there can exist a lot of noisy features that
will overfit the training data and mislead the prediction  so the goal is to run an algorithm on
training data to decide the ranking of features and pick only top     of features to feed into svm
classifier  the feature selection significantly helps to handle overfitting and below is a table of
some top features chosen by extremely randomized tree for each stock 
ffdfdffgdfgfgfgwillr mom  rocr  rsi  cci   cci   mom  n adx   trix n cci    
aapl
amzn mom   n mom   willr sp mom  rocr  cci   rsi  mom  n rocr 
msft
mom  rsi  willr n mom  cci   sp mom  mom  rocr  macdhist

  
  
  

from the above table we found that aapls feature ranking tend to favor more longer term
indicators such as willr  cci   etc that reflects a general trend  whereas amzns ranking
shows that those     day features are the highest which means it tends to overfit and has high
variance  msft is in the middle  we will see in the next section that this agrees surprisingly well
with the validation of predicting results  the last column number is the number of relevant
features selected by er tree  amzn uses significantly more features than the other two which
implies the trained model is likely to overfit 
    rbf kernelized svm and grid search on parameters
the fitting model is soft margin svm with rbf kernel exp  x p  l   we have two parameter to fit
c and l  for each training set  i do   fold cross validation and grid search on parameter pair  c l 
and pick the best parameter to do validation on test set 
   

validation model and results

to validate the prediction accuracy  we train on     examples and predict on next    days  and
we repeat the training and testing with a step window    examples so that in total we get   
testing precision  taking the mean of them we get the following 
preprocessing is applied to eleminate the mean and normalize the vaiance to    this is to avoid
the magnitude difference of features will poise some significant weight which is undesirable 
company accuracy
apple
amazon
microsoft

 

next   day
     
   
     

next   day
      
   
   

next   day
      
     
       

next    day
      
      
      

analysis and conclusion

the result shows that for apple the prediction is robust and above      for amazon  it suggests
that longer period prediction     day  is significantly better than the shortterm  for microsoft  the
split is between   day  shorter than that it tends to have very high noise while   day and    day
prediction is extremely good  these can be mapped to the top features extracted  apple stock has

fimore generalized indicators weighted heavier than others so that it has low variance  amazons
top features are all     days volatility  so that the model tend to overfit  actually the experiment
shows the training error for amazon is     which is significantly higher than the other two
stocks 
last result is directly predicting next day price trend  it shows on average it acheives    
accuracy  this is very sound result since the next   day price is highly noise in stock market and
should be close to random  with this model  we can do better than random walk consitently 
the result is very helpful in real world investment for non hft inverster  by learning from past
data we are able to get above     accurate prediction on the next couple days trend  for future
work  it worth adding sentiment data as features to augment the technical features  the challenge
is how to eliminate as much as noise in sentiment data and quantify them 

reference 
learning to rank with extremely randomized trees
efficient machine learning techniques for stock market prediction
feature investigation for stock market prediction
an svm based approach for stock market trend prediction
http   stockcharts com school doku php id chart school technical indicators introduction to technical indicators and oscillators
feature  selection  for  price  change  prediction  

  
  

fi