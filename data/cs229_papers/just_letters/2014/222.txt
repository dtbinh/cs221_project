prediction of the onset of epileptic seizures from ieeg data
cs    final report
shima alizadeh  scott davidson  and ari frankel
seizures in epileptic patients can be anxiety inducing  and the resulting medical and social issues can cause distress to a patient  a predictive mechanism to anticipate the onset of a seizure could help a patient prepare for a seizure
and take medication  the literature has shown that the onset of a seizure is directly correlated with a distinct neurological change that can be detected using ieeg measurements  thus the development of a classification model based
on ieeg data can be created to aid epileptic patients  in this project we develop a feature set based on spectral and
statistical features of the ieeg data  with and without ica pre processing of the data  several classication algorithms
were trained on the resulting data sets  including naive bayes  svm  logistic regression  and lasso regularized logistic
regression  it was found that the optimal results were given for regularized logistic regression on pib features without
ica pre processing  though generally all algorithms performed better than a random naive predictor model 

   introduction
     motivation
epilepsy affects nearly    of the population  and is characterized by the sporadic onset of violent seizures  due
to the health threatening nature of the seizures as well as the social embarassment induced  patients feel a constant
anxiety that a seizure may happen at any moment  medicine is available that can reduce the frequency of seizures 
however  the side effects associated with long term constant medication can also cause discomfort to the patient  the
ability to predict the imminent onset of a seizure is thus attractive in that a predictive system can alert an epileptic
patient and give him time to take medication as necessary and avoid the side effects 
epilepsy is a neurological condition and is sporadic in nature  meaning that most of the time an epileptic patient
exhibits no symptoms at all  this suggests that the condition may be associated with a distinct physiological change
in the brain that occurs at the time of a seizure  recent studies support this hypothesis and show that the brain activity
of an epileptic patient may be classified into four stages  interictal  normal brain activity   preictal  prior to seizure  
ictal  during seizure   and postictal  immediately following the seizure       it has been demonstrated that these four
stages may be associated directly with voltage readings in the brain from intracranial electroencephalogram  ieeg 
measurements at different locations  and the preictal stage can be detected with high sensitivity  this suggests that
ieeg recordings can be used to detect preictal brain activity and serve as a predictive tool for seizure onset     

     problem statement
in this project we aim to develop a reliable learning model for seizure forecasting based on long term  continuous 
ieeg records containing multiple seizure events  the data which is provided by kaggle com  was recorded from  
dogs and   human patients with epilepsy  the ieeg record from the dogs were sampled from    electrodes  channels 
at     hz  and recorded voltages were referenced to the group average  in addition  datasets from human patients with
epilepsy were obtained by using varying numbers of channels and sampled at      hz  each training testing example
is a set of time series of voltages measured at different locations of the brain using a number of channels  and each
example labeled as interictal  normal brain activity  or preictal  immediately prior to seizure   using the provided
training examples  we exploit different machine learning algorithms to build a model which can distinguish between
the ieeg records of pre ictal with ieeg clips of interictal activity with sufficient accuracy 

fito gain a better insight about the efficacy of the features used for this classification problem we decided to create
different sets of possible features which have been frequently used in related studies  the feature sets include multiple
spectral ieeg power bands  pib   variance  and time correlation of ieeg records  the extraction of each feature set 
their types and properties and also the number of extracted features are described in section      moreover  a variety of
learning algorithms such as logistic regression  naive bayes  and svm have been utilized for learning different sets
of features  at the end of this project  the outputs and the performance of each learning method will be evaluated by
looking at the test and training errors as well as taking advantage of various error metrics such as the precision  recall 
and aucroc statistics 

   pre processing and feature extraction
     independent component analysis
the data received from an ieeg measurement can be thought of as a linear combination of independent signals in
the brain  each containing a unique set of frequency characteristics  while some frequency characteristics can indicate
important parts of brain activity  some frequency characteristics may be associated with lower level functions  e g 
breathing   thus independent component analysis was used in order to separate out the signals and thus potentially
elicit the features that change the most between interictal and preictal brain activity 
since the entire data set consists of multiple subjects in multiple sessions  it was important to train the unmixing matrix on individual subjects  to reduce potential bias in the training  a random mixture of data was taken from
multiple time segments  half from the interictal and half from the preictal parts of the data  the unmixing matrix was
derived using the ica capabilities of the eeglab library for matlab 

     power in band  pib  features
the changes in spectral power of multichannel ieeg in certain frequency bands have been demonstrated to be
good indicatiors to distinguish between pre ictal and inter ictal states of the brain activity  high sensitivity and specificity can be achieved by developing nonlinear classifiers which are trained based on linear features of spectral power
of ieeg         moreover  the rapid computation of the spectral power with low power consumption is very advantageous in manufacturing implantable predicting devices  to extract features using spectral power of ieeg records from
dogs with natural epilepsy  in each of the    ieeg channels  the ieeg record was partitioned into non overlapping  minute blocks  each block fourier transformed  and the resulting power spectrum was divided into   frequency bands 
      hz       hz        hz         hz         hz          hz   within each frequency band the power was
integrated over band frequencies to produce a power in band  pib  feature  each of the   pib values from a given
channel and time block was summed with the corresponding pibs from other   minute blocks in the same channel 
repeating this procedure on each ieeg channel eventually gave            pib values as the elements of the feature
vector  the pib features were calculated for both pre ictal and inter ictal data to form the training and testing data sets
for the learning algorithms 

     variance and correlation features
two statistical measures of a signal  variance  and correlation coefficient were other possible options to represent
the features of the problem  these form a relatively simple to compute set of features which provide measures of the
power in each channel of the data and the relationships between the signals in different channels  epilepsy is known
to cause increased brain activity in regions of the brain where the seizure is centered      by measuring the variance
of the signals of all of the channels  we anticipate that certain channels variances will change in a consistent manner
during seizures thus which our learning algorithm will be able to detect  measuring the signal variance results in one
feature per ieeg channel  thus for the    channel records     features are formed from the variances  another way
we detect the presence of these spatially consistent brain waves is through the correlation coefficient matrix which
provides a measure of the characteristic correlation of signals detected at specific electrodes in advance of seizures 
 

fidog  roc
 

   

   

   

   

true positive rate

true positive rate

dog  roc
 

   
   
   
   

random prediction
naive bayes
svm
logistic
regularized logistic

   
   
   
 

 

   

   

   

   

   

   

   

   

   
   
   
   

random prediction
naive bayes
svm
logistic
regularized logistic

   
   
   

   

 

 

 

   

   

   

false positive rate

   

   

   

   

   

   
   
   
   

random prediction
naive bayes
svm
logistic
regularized logistic

   
   
 

 

   

   

   

   

   

   

   

   

   

 

dog  roc
 

true positive rate

true positive rate

dog  roc
 

   

   

false positive rate

   

   

   

   
   
   
   

random prediction
naive bayes
svm
logistic
regularized logistic

   
   
   

   

 

 

 

   

   

   

false positive rate

   

   

   

   

   

   

 

false positive rate

dog  roc
 
   

true positive rate

   
   
   
   
   

random prediction
naive bayes
svm
logistic
regularized logistic

   
   
   
 

 

   

   

   

   

   

   

   

   

   

 

false positive rate

figure    the roc curves for each of the dogs using pib features without ica
p
the correlation coefficient matrix  defined as ri j   ci j   ciic j j where ci j is the covariance matrix is symmetric with
ones on the diagonal  thus only the upper triangular portion of the matrix not including the diagonal is used for features 
for    channel records  this gives     unique features 

   learning algorithms and performance
in order to classify the data as interictal or preictal  multiple classification algorithms were trained on the data and
tested using holdout cross validation with     of the data  the algorithms used were naive bayes  svm  logistic
regression  and lasso regularized logistic regression 
since different epileptic patients have different seizure characteristics      each classifier had to be trained on each
subject individually  the roc curves for each of the dogs and each of the classifiers is shown in figure    generally 
the lasso regularized logistic regression classifier outperforms each of the other classifiers  and naive bayes has the
worst performance 
 

fiaucroc
dog  
dog  
dog  
dog  
dog  

nb
     
     
     
     
     

svm
     
     
     
     
     

pib  no ica
logistic lasso logistic
     
     
     
     
     
     
     
     
     
     

nb
     
     
     
     
     

svm
     
     
     
     
     

pib  ica
logistic
     
     
     
     
     

lasso logistic
     
     
     
     
     

table    aucroc statistics for the dogs using pib features  with and without ica pre processing
precision
dog  
dog  
dog  
dog  
dog  

nb
     
     
     
     
     

svm
     
     
     
     
     

pib  no ica
logistic lasso logistic
     
     
     
     
     
     
     
     
     
     

nb
     
     
     
     
     

svm
     
     
     
     
     

pib  ica
logistic
     
     
     
     
     

lasso logistic
     
     
     
     
     

table    precision statistics for the dogs using pib features  with and without ica pre processing
recall
dog  
dog  
dog  
dog  
dog  

nb
     
     
     
     
     

svm
     
     
     
     
     

pib  no ica
logistic lasso logistic
     
     
     
     
     
     
     
     
     
     

nb
     
     
     
     
     

svm
     
     
     
     
     

pib  ica
logistic
     
     
     
     
     

lasso logistic
     
     
     
     
     

table    recall statistics for the dogs using pib features  with and without ica pre processing
aucroc
dog  
dog  
dog  
dog  
dog  

nb
     
     
     
     
     

covariance  no ica
svm logistic lasso logistic
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

nb
     
     
     
     
     

covariance  ica
svm logistic lasso logistic
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

table    aucroc statistics for the dogs using covariance features  with and without ica preprocessing
precision
dog  
dog  
dog  
dog  
dog  

nb
     
     
     
     
     

covariance  no ica
svm logistic lasso logistic
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

nb
     
     
     
     
     

covariance  ica
svm logistic lasso logistic
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

table    precision statistics for the dogs using covariance features  with and without ica preprocessing
 

firecall
dog  
dog  
dog  
dog  
dog  

covariance  no ica
svm logistic lasso logistic
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

nb
     
     
     
     
     

covariance  ica
svm logistic lasso logistic
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

nb
     
     
     
     
     

table    recall statistics for the dogs using covariance features  with and without ica preprocessing
   

   

training error
test error

training error
test error

   

   

   
   

   

   

error

error

   

   

   

   
   
   
   
   

 

 

   

   

   

   

   

m training set size

   

   

   

 

 

   

   

   

   

   

   

   

   

m training set size 

figure    learning curves for one of the dogs for logistic regression  left  and lasso regularized
logistic regression  right  
in order to estimate the effects of bias and variance  a learning curve was generated for one of the dog subjects
using logistic regression and lasso regularized logistic regression  the resulting plots are shown below in figure    for
each of the cases the training error is nearly zero for all set sizes  while the testing error is quite large and decreases
steadily as a function of training set size  in addition  the error decreases in the lasso regularized case  since lassoregularization tends to set feature parameters to zero  this suggests that the large feature set is overfitting the data  and
that either a larger data set or a smaller feature set would help improve the accuracy of a classifier 

   conclusions and future work
we have demonstrated the use of machine learning algorithms for the classification of ieeg data as interictal or
preictal with a relatively high success rate  each of the learning algorithms tested performed better than a random
naive predictor  where lasso regularized logistic regression performed the best and naive bayes performed the worst 
the feature sets tested included pib features and covariance features  both with and without ica pre processing for
signal separation  generally the results showed no improvement with the use of the current ica pre processing  furthermore  the pib features tended to give lower testing error than covariance features  this suggests that the power
spectral density of the ieeg data is more sensitive to differences in preictal and interictal brain activity than the correlation features  the learning curves also suggest that there is room for improvement  however  in that the current
feature set is overfitting the data and either more data or fewer features are needed to improve the accuracy 
a number of other research directions could be included in future work  the large imbalance in the number of
preictal data segments versus interictal data segments suggests that an approach to weight the preictal data more heavily than the interictal data could help improve the accuracy of a classifier  in addition  other measures to filter the data
and reduce noise could help  e g  using a kalman filter on the raw ieeg data  
using discrete wavelet transform  dwt  is another option for extracting features from the frequency bands
which carry more information about the preictal or interictal nature of the ieeg signals than the other bands  as a
 

fifuture work  we plan to utilize the features obtained by dwt to generate new predictive models and compare their
accuracies and properties with the developed ones 
while we explored the effects of using lasso regularization  l  regularization  of the logistic regression classifier 
a ridge regularization  l  regularization  could also have been used to reduce the magnitude of the feature parameters 
and finally  the overfitting problem should be handled by using a model searching method to reduce the number of extraneous features  for example by using a forward or backward search on the information content of a particular model 

references
    howbert jj  patterson ee  stead sm  brinkmann b  vasoli v  crepeau d  vite ch  sturges b  ruedebusch v  mavoori j 
leyde k  sheffield wd  litt b  worrell ga        forecasting seizures in dogs with naturally occurring epilepsy  plos one
     e     
    cook mj  obrien tj  berkovic sf  murphy m  morokoff a  fabinyi g  dsouza w  yerra r  archer j  litewka l  hosking
s  lightfoot p  ruedebusch v  sheffield wd  snyder d  leyde k  himes d        prediction of seizure likelihood with a longterm  implanted seizure advisory system in patients with drug resistant epilepsy  a first in man study  lancet neurol
           
    park y  luo l  parhi kk  netoff t        seizure prediction with spectral power of eeg using cost sensitive support vector
machines  epilepsia             

 

fi