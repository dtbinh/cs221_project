predicting seizures in intracranial eeg recordings
sining ma  jiawei zhu
sma   stanford edu  jiaweiz stanford edu

patterns across patients  and dogs  vary considerably  second  eeg is highly complex and varies
over time 

abstractif seizure forecasting systems could reliably
identify periods of increased probability of seizure occurrence  patients who suffer from epilepsy would be able
to avoid dangerous activities and lead more normal lives 
the goal of this project is to differentiate between the
preictal and interictal states by analyzing intracranial
eeg recordings  data for each hour are organized into
six ten minute time sequences  logistic regression and
support vector machines  svm  are applied to each time
sequence to calculate the average test false negative rate 
the idea of combining data from various time sequences
is also experimented with to examine if false negative
rates can be reduced  the results show that svm provides
better prediction results for patients  and that combining
training examples from different time sequences does not
help improve prediction results  since the pathogenesis of
epilepsy may vary across different species  applying the
same training models to both dogs and patients may be
problematic 

ii  o bjective
this project represents an attempt to demonstrate
the existence and accurate classification of the preictal brain state in dogs and humans with naturally
occurring epilepsy 
iii  data
data used in this project  which we obtained
from a kaggle competition  are intracranial electroencephalography  eeg  recordings sampled from
dogs and patients  the training data are organized
into ten minute eeg clips labeled  preictal  for preseizure data segments  or  interictal  for non seizure
data segments  both the preictal and interictal training data segments are numbered sequentially  the
sequence  numbered        represents the index of
the data segment within an hour  for example  the
sequence   preictal data segment represents the eeg
data between the   st minute and the   th minute
in the hour before a seizure occurrence  the test
data  which are preictal  are also organized into tenminutes eeg clips but are provided in random order 
this allows us to pick any test data segment to
verify the accuracy of every time sequences training
model 
preictal training and test data segments cover one
hour prior to seizure with a five minute seizure
horizon  figure     similarly  one hour sequences
of interictal ten minute data segments are provided 

keywordsseizure  classification  logistic regression 
support vector machines  svm 

i  i ntroduction
epilepsy  characterized by the occurrence of
spontaneous seizures  afflicts nearly    of the population worldwide  epilepsy sometimes leads to loss
of consciousness and control of bowel or bladder
function  creating not only the risk of serious injury 
but also an intense feeling of helplessness that
strongly impacts the everyday lives of epileptic
patients  if computational algorithms could reliably
predict seizure occurrences  devices designed to
warn patients of impending seizures would help
patients avoid potentially dangerous activities  also 
medications could be taken only when necessary to
reduce overall side effects 
an epileptic patients brain activity can be classified into   states  interictal  between seizures  or
baseline   preictal  prior to seizure   ictal  seizure  
and post ictal  after seizures   the primary challenge in seizure forecasting is to differentiate between the preictal and interictal states  past research
on seizure forecasting based on eeg has pointed out
two difficulties  first  preictal and interictal eeg

a  eeg recording for dogs
intracranial eeg for dogs are sampled from   
electrodes at     hz  thus  the canine data contain
   features  and the data for each ten minute time
sequence contain              data points  each
 

fipredicting seizures in intracranial eeg recordings

cs    final project       fall

iv  m odels
a  logistic regression
this is a binary classification problem  so the first
intuitive choice is logistic regression with sigmoid
function h  x   we apply stochastic gradient ascent
to the following equation 
 i 

j    j    y  i   h  x i    xj
where
fig     eeg recordings cover one hour
prior to seizure with a five minute
seizure horizon

 
    et x

h  x    g t x   

a fixed learning rate  is used  and the implementation slowly decreases  to some value around
zero to ensure the algorithm converges to the global
minimum 

data point represents the eeg recording for electrode i at some time t  the competition provided
b  support vector machine  svm 
eeg recordings for   dogs  we choose to use the
the goal of svm classification is to establish
first hour    sequences  training data for dogs   and
and test a mapping x   y from eeg spectral
  
features to either a preictal or an interictal label 
to achieve this goal  we use c support vector
classification which solves the following primal
optimization problems 
l

min
w b 

x
  t
w w c
i
 
i  

subject to yi  wt  xi     b      i  
i     i              l 
where  xi   maps xi into a higher dimension space
and c     is the regularization parameter  we use
the radial basis function  rbf  kernel 

fig     eeg recordings cover one hour
prior to seizure with a five minute
seizure horizon

k xi   xj     exp kxi  xj k   
there are two model parameters  c and the kernel
factor   using the grid search approach  we try
all combinations of c and   and select the combination that produces the maximum classification
accuracy  the search range for log c is from    to
   and for log  is from    to   
we then run c svm with the selected c and  
we use the same c and  for each  individual and
combined  time sequence 

b  eeg recording for patients
intracranial eeg for patients are sampled from
   electrodes at       hz  thus  the human data
contain    features  and the data for each tenminute time sequence contain               data
points  the competition provided eeg recordings
for   patients  we choose to use the first hour   
sequences  training data for patient   
 

fipredicting seizures in intracranial eeg recordings

cs    final project       fall

c  calculating false negative rates

b  dogs

data for dogs and patients are categorized as
either preictal or interictal  for logistic regression 
we label preictal data examples as positive       
and interictal data examples as negative        for
svm  we label preictal data examples as positive
       and interictal examples as negative        
all test examples should be predicted as preictal 
which is positive        we are interested in the
false negative rate  which is the fraction of the
preictal test examples that the algorithm incorrectly
predicts to be interictal  a small false negative rate
implies a high probability of seizure occurrences 
in the following equation  rf n stands for false
negative rate 

we use all the canine data                to
run logistic regression  due to the aforementioned
time constraint  we use only the last            
canine training examples in each time sequence to
run svm  we then combine sequences      and
sequences      to examine if the accuracy can be
improved  see figure       and table ii for dog  
and dog   results 

rf n

average fn rate

 
   
   
   
   

  of test examples predicted to be interictal
 
  of test examples

 

 

 

 

 

 

logistic regression

we apply logistic regression to a time sequence
   times using    different test data segments 
and compute the average of the    false negative
rates  we repeat this step for the other five time
sequence and compare the average false negative
rates   for svm  the process is the same except
we use   different test data segments   the time
sequence with the lowest average false negative
rate is the best in predicting seizures  we then
combine some continuous or randomly selected tenminute sequences  and run the algorithms again 
calculate and compare the average false negative
rates to observe whether combining time sequences
improves the accuracy of seizure predictions 

 a  sequences   to  
average fn rate

 

   

   

   

logistic regression

svm

 b  combined sequences

fig     dog   results

dog  
seq  
seq  
seq  
seq  
seq  
seq  
seq    
seq    
dog  
seq  
seq  
seq  
seq  
seq  
seq  
seq    
seq    

because of the extremely long training time  we
select the last             examples in the canine
data  and the last              examples in the
human data to grid search the optimal values of c
and  

 
 
 

   

 

a  svm parameter selection

c
 
 
 

   

   

v  r esults

dog  
dog  
patient  

 
svm

accuracy
        
        
      

table i  cross validation results for c and 

logistic regression
        
        
        
        
        
        
        
        
logistic regression
        
        
        
        
        
        
        
        

svm
        
        
        
        
        
        
        
        
svm
        
        
        
        
        
        
        
        

table ii  dogs   and   results

 

fipredicting seizures in intracranial eeg recordings

cs    final project       fall
patient  
seq  
seq  
seq  
seq  
seq  
seq  
seq    
seq    

average fn rate

 
   
   
   
   
 

 

 

 

 

 

logistic regression

 
svm

logistic regression
        
        
        
        
        
        
        
        

svm
        
        
        
        
        
 
        
        

table iii  patient   results

 a  sequences   to  
average fn rate

 

improve the results  none of the combined sequences produce false negative rates smaller than
the minimum of the individual sequences false
negative rates  although this contradicts the intuitive
conjecture that adding more data should improve
results  the finding is not entirely surprising because
previous research has pointed out that eeg is highly
complex and varies over time  if there is little correlation between any time sequences  continuous or
random selected  then combining sequences would
only add noise to each model and should not be
expected to yield better predictions 
interestingly  while sequences         in the
human data give low svm false negative rates 
sequences         in the canine data give surprisingly
high svm false negative rates  close to     our
surmise is that logistic regression may not have
classified the preictal and interictal states correctly
because we omitted the process of cross validation
before performing logistic regression 
we observe some patterns from the results of
the two dogs  the logistic regression false negative
rates fluctuate  increase  decrease  increase  and
finally decrease   while the svm false negative rates
exhibit an entirely opposite  and much more volatile
trend  these trends may be evidence that pre seizure
brain activities exhibit a high degree of fluctuation 
if future medical devices can detect such fluctuation  then warning epileptic patients of impending
seizures may be achievable  this approach may be
more effective in forecasting seizures than solely
focusing on the false negative rates of specific time
sequences 
according to the results of patient    svm
outperforms logistic regression as expected  svm
results are all        this means that we are able to
predict seizures with reasonable accuracy  however 
all logistic regression false negative rates are around
     such relative  uniformity  makes it difficult to
interpret which time sequences are better in seizure

   
   
   
   
 
   

   

logistic regression

svm

 b  combined sequences

fig     dog   results
c  patients
we use all the human data                 to run
logistic regression  due to the aforementioned time
constraint  we use only the last            training
examples in each time sequence to run svm  we
then combine sequences      and sequences     
to examine if the accuracy can be improved  see
figure   and table iii for patient   results 

average fn rate

 
   
   
   
   
 
 

 

 

 

 

         

logistic regression

svm

fig     histogram of patients   results

vi  d iscussion   c onclusion
based on the results of dogs and patients  we
observe that combining time sequences does not
 

fipredicting seizures in intracranial eeg recordings

cs    final project       fall

forecasting than others  the   false negative rate for
sequence   is surprising  however  since sequence
  closely precedes seizures  the brains behavior is
expected to differ drastically from that during nonseizure periods  thus the low false negative error 
after comparing the results between dogs and
patient  we observe that sequence   has the lowest
false negative rate for patient   but not for dogs 
this inconsistency implies that the pathogenesis of
epilepsy may be different across different species 
hence  applying the same training models to both
dogs and patients may be problematic 



    y  park  l  luo  k  parhi and t  netoff         seizure
prediction with spectral power of eeg using cost sensitive
support vector machines  epilepsia              
    j  howbert  e  patterson  s  stead  b  brinkmann  v  vasoli 
d  crepeau  c  vite and b  sturges        jan   forecasting
seizures in dogs with naturally occurring epilepsy  plos one
     e      
    snyder de  echauz j  grimes db  litt b        the statistics
of a practical seizure warning system  j neural eng            
doi                           
    american epilepsy society seizure prediction challenge   online  https   www kaggle com c seizure prediction

vii  f uture
this competition also provided data for another
three dogs and one patient  furthermore  for
each dog and each patient  multiple hours
worth of data are available  we could run the
same algorithms several more times to observe
patterns and anomalies  the new results could
be used to verify our conclusions 



instead of   sequences  we could divide an hour
into    or more sequences  that would give
us a better understanding of the pathogenesis
of epileptic seizures and the variation of the
prediction results within shorter time intervals 



logistic regression does not work well for
patient    the reason might be that human
brains are much more complicated than canine
brains  we could apply logistic regression with
regularization to ameliorate the high variance
problem 



svm does not work well for dogs at sequences
     and    the cause is the large number of
support vectors  since the the number of support vectors determines the maximum number
of misclassified data points  we could apply svm instead of c svm  and set         this
approach would force only half of our data to
be support vectors and implicitly adapt c 
r eferences

    c  hsu  c  chang and c  lin         april   a
practical guide to support vector classification   online 
http   www csie ntu edu tw  cjlin papers guide guide pdf 
    r  andrzejak  d  chicharro  c  elger and f  mormann
       july   seizure prediction  any better than chance  clin
neurophysiol 

 

fi