automated bitcoin trading via machine learning algorithms

isaac madan
department of computer science
stanford university
stanford  ca      
imadan stanford edu

shaurya saluja
department of computer science
stanford university
stanford  ca      
shaurya stanford edu

aojia zhao
department of computer science
stanford university
stanford  ca      
aojia   stanford edu

abstract
in this project  we attempt to apply machine learning algorithms to predict bitcoin price  for the
first phase of our investigation  we aimed to understand and better identify daily trends in the bitcoin
market while gaining insight into optimal features surrounding bitcoin price  our data set consists
of over    features relating to the bitcoin price and payment network over the course of five years 
recorded daily  using this information we were able to predict the sign of the daily price change
with an accuracy of        for the second phase of our investigation  we focused on the bitcoin
price data alone and leveraged data at    minute and    second interval timepoints  as we saw an
opportunity to evaluate price predictions at varying levels of granularity and noisiness  by predicting
the sign of the future change in price  we are modeling the price prediction problem as a binomial
classification task  experimenting with a custom algorithm that leverages both random forests and
generalized linear models  these results had        accuracy in predicting the sign of future price
change using    minute time intervals 

 
   

introduction
bitcoin

bitcoin is a digital cryptocurrency and payment system that is entirely decentralized  meaning it is based on peerto peer transactions with no bureaucratic oversight  transactions and liquidity within the network are instead based
on cryptography  the system first emerged formally in      and is currently a thriving open source community and
payment network  based on the uniqueness of bitcoins payment protocol and its growing adoption  the bitcoin
ecosystem is gaining lots of attention from businesses  consumers  and investors alike  namely  for the ecosystem to
thrive  we need to replicate financial services and products that currently exist in our traditional  fiat currency world
and make them available and custom tailored to bitcoin  as well as other emerging cryptocurrencies 
   

price prediction

the bitcoin markets financial analog is  of course  a stock market  to maximize financial reward  the field of stock
market prediction has grown over the past decades  and has more recently exploded with the advent of high frequency 
low latency trading hardware coupled with robust machine learning algorithms  thus  it makes sense that this prediction methodology is replicated in the world of bitcoin  as the network gains greater liquidity and more people
develop an interest in investing profitably in the system  to do so  we feel it is necessary to leverage machine learning
technology to predict the price of bitcoin 
   

prior work

given that bitcoin is still a new technology with highly volatile market price  current price prediction models are few
and of limited efficacy in a production environment  most recently  shah and zhang     described their application of
bayesian regression to bitcoin price prediction  which achieved high profitability  current work  however  does not
explore or disclose the relationship between bitcoin price and other features in the space  such as market capitalization
 

fior bitcoin mining speed  we sought to explore additional features surrounding the bitcoin network to understand
relationships in the problem space  if any  while also exploring multiple machine learning algorithms and prediction
methodologies within our research  in this way  our thought is that such an exploration will help us cast a wider net
and develop a stronger intuition of the problem space  such that we can apply such learning to achieve higher long run
profitability 

 
   

materials   methods
data collection

we collected two sets of data for our project  the first set is daily data with price and    additional features about
the bitcoin network and market  described in table    this was acquired from blockchain info      the    hour
time series minimizes noise concerns from higher granularity measurements and minute volatility  and it serves to
determine which features were relevant in predicting bitcoin price  these features include concepts like the market
capitalization of bitcoin as well as the relationship of bitcoin transaction volume to usd volume 
our second set of data consisted of    second and    minute interval bitcoin price data  the    minute data was
pulled from the coinbase api  a large bitcoin wallet and exchange service based in san francisco      we collected
   second price data by building an automated real time web scraper that pulled from both the coinbase api and
the okcoin api over the course of multiple weeks      okcoin is a service similar to coinbase  based in beijing 
china  the script runs on an amazon ec  instance and is stored in a nosql database via amazon dynamodb  this
real time data collection mechanism allowed us to collect high granularity bitcoin price data and accumulate roughly
        unique price points for use in our modeling step 
   

feature selection

we considered over    independent features relating to bitcoin trading and the bitcoin network  of these     we
selected    to use in our initial algorithm with daily data  these features were selected manually on the basis of
our research of their significance to the problem we are trying to solve  we also performed forward and backward
stepwise selection to additionally corroborate which features may be most meaningful to our model  because these
results were largely different without clear indication as to why  we chose to leverage our hand selected features due
to our pre existing intuition about their role impact within the problem space 
feature

definition

average confirmation time
block size
cost per transaction percent
difficulty
estimated transaction volume
hash rate
market capitalization
miners revenue
number of orphaned blocks
number of txn per block
number of txn
number of unique addresses
total bitcoins
txn fees total
trade volume
transaction to trade ratio

ave  time to accept transaction in block
average block size in mb
miners revenue divided by the number of transactions
how difficult it is to find a new block
total output volume without change from value
bitcoin network giga hashes per second
number of bitcoins in circulation   the market price
 number of btc mined day   market price    transaction fees
number of blocks mined   day not off blockchain
average number of transactions per block
total number of unique bitcoin transactions per day
number of unique bitcoin addresses used per day
historical total number of bitcoins mined
btc value of transaction fees miners earn day
usd trade volume from the top exchanges
relationship of btc transaction volume and usd volume

names and descriptions of the    features we chose that relate to the bitcoin network  we leveraged these features
in developing a binary classification algorithm to predict the sign change in bitcoin price based on daily data points 
our data set consisted of these    variables collected daily over the course of the past   years  since bitcoin emerged 
we specifically looked at the differential of each of these variables  in order to predict the sign of the price change  as
opposed to actual price itself  in order to represent this problem binomially rather than via regression  our training set
comprised of the first     of these data  while our test set comprised the remainder 

 

fi   

time series equations

due to the large occurrence of micro variations and perturbations in the price of bitcoin  we also use    second interval
data to attempt to gain deeper insight  however  as feature data are unavailable or poorly recorded at such small time
intervals  we look to the price curve itself to predict future price change  specifically  with the idea that future price
trends can be inferred directly from a linear combination of existing time series data  we construct three time series
data sets for         and     minutes                data points respectively  preceding the current data point at all
points in time respectively  this means  to predict the price change at a certain time t  we create the datasets
t       s   t
t       s   t
t       s   t
we then run glm random forest on each of the three time series data sets separately  this will give us three separate
linear models  m    m    and m    corresponding to each of the data sets  from m    we can predict the price change
at t  denoted p    similarly  we have p  for m  and p  for m    these values can then be linearly combined to
predict the macro price change defined as
p   w   

 
p

wj pj

j  

where w  is the intercept term representing initial market value at t      and wj is the weight denoting the influence
of sj   this is a linearization problem which we solve with a glm  yielding the price change prediction 
in addition to using    second interval data  we also use    minute interval data to gain a longer term picture of the
price trends  the reasoning is that    second interval data allows for higher frequency trading with much smaller price
changes that rarely pass    or    usd  although riskier  in order to implement a novel trading strategy  we must be
able to make predictions based on larger price changes to achieve higher profitability  given that there is also latency
in current bitcoin exchanges between issuing a purchase or sale and the actual completion of the transaction  it makes
sense to broaden our window to    minutes  as    seconds may be too short to capture this entire workflow  making
our predictions preemtively stale  like before  we model three time series s    s    and s    which correspond to     
minutes       minutes  and      minutes                data points respectively   the same setup before is used 
only the prediction is for    minutes in the future instead of    seconds 

 

results
statistic
sensitivity  tpr 
specificity  tnr 
precision  ppv 
accuracy  acc 

binomial glm

svm

random forest

      
      
      
      

      
      
      
      

   
      
      
      

these are results of our performing three different binomial classification algorithms on daily bitcoin data  using   
features  described above  to predict bitcoin price  we leveraged binomial logisitic regression  support vector machine 
and random forest algorithms 
statistic
sensitivity  tpr 
specificity  tnr 
precision  ppv 
accuracy  acc 

   second glm

   minute glm

   minute random forest

      
     
     
     

     
     
     
     

     
     
     
     

these are results of our performing our prediction algorithm on    second bitcoin price interval data using binomial
logistic regression to predict price change  we then switched to    minute interval data to diminish the effects of
granular price fluctuations  and then ran our algorithm using inner logistic regression and a random forest  we can see
that switching from    second to    minute interval data provided a significant enhancement  while the random forest
performed better than the glm 
 

fithese are results from our algorithms performance on    minute interval bitcoin data  the y axis represents the
change in bitcoin price  in us dollars  between a bitcoin price point and its previous bitcoin price point  the red line
is the actual change in price  the green line represents our results from glm  and the blue line are our results from
using a random forest  we can see that both of our algorithms perform well  but do not capture the random noise and
spikes of variability present in the actual bitcoin price changes  which is likely the rationale behind most test error 

   minute interval bitcoin price with    hour sample     hour sample  and     hour sample  these figures serve to
demonstrate a single example of our linear fits to the    minute interval data  clearly  as our sample size for each
linear fit increases  a linear fit worsens in quality though our thought is that   linear fits of differing underlying sample

 

fisize will allow us to better smooth over noise and random variation that is present in higher granularity data  and in
turn  capture and predict the macro actual price change at a given point 

 
   

conclusion
first phase

the results from the binomial glm exceeded our expectations  this can be likely attributed to the long time interval
between data points leading to dampening of the price fluctuation within the actual bitcoin market  additionally 
the higher percentage of true positives compared to true negatives suggests to us that over the longer term bitcoin
prices are generally rising  when applying the svm algorithm  the observed error rates were much worse than before 
this is perhaps due to the need to create artificial separations between data points in higher dimensional space to
classify points  as svm seeks to find underlying patterns within data  perhaps more frequently timed data points are
needed to fill in the general trend being observed  as for random forest  our results show a high accuracy but lower
precision than binomial glm  this can be attributed to the fact that random forest generates a plethora of decision
trees at runtime  and is thus inherently imprecise from run to run  but still yields result that is fairly close to the data 
additionally  the low precision indicates that random forest predicts an even larger number of positive trends than
data shows  as false positive is the dominating factor 
   

second phase

with random forest and glm time series models  we find that the    minute data gave a better sensitivity and
specificity ratio than the    second data  since we are not looking at high frequency trading but predictive trading  the
   minute data helped show clearer trends  this can be attributed to extremely small and rapid changes in the bitcoin
market that too closely depict the erratic nature of the bitcoin fluctuations  additionally  from the graph it is obvious
that the prediction is less volatile than the actual data  this is inherently beneficial to financial trading as our strategy
can be more lenient with percent changes in buy and sell  although some short term bursts in price change can be
missed out on  the overall gain over a longer timeframe is very promising 
realistically  in developing a trading strategy  one must know more than simply if the bitcoin price will rise or drop in
the upcoming interval  specifically  an adroit trading strategy encompasses the degree of change in price and the price
that we would find most appropriate to actually make a buy sell transaction  thus  it seems possible that    minute
interval data may be more appropriate in this case  because once we establish a price at which we will buy sell  the
probability of us seeing this price within a    minute window is higher than in a    second window  as such  with a
smaller window  we may predict price change correctly  but have a smaller profitability margin based on the fact that
we are unable to dispatch an appropriate trade within the window that our algorithm finds suitable 
we also observed that random forests gave us a better accuracy rate as compared to glm  this is because rfs use
nonparametric decision trees  so outliers and linear separability of the data are not concerns 
   

future work

to improve upon our results in the future  we intend to examine patterns of subsets of the price data  for example 
we will break up the data into sequential combinations of     data points      mers   these vectors will serve as
patterns of how bitcoin changes over a brief snapshot in time  then  we can use k means clustering to cluster these
patterns into a number of groups  then  at new data points  we will pull our most recent     data points and use these
to represent a new unclassified pattern  which we can then cluster  we will then run our linear regression models on
this subset of patterns only  in this way  we are trimming our training set to a set of patterns that is highly similar to
our input pattern  which we believe may improve upon our results  at least more so than the current method  which
only looks at a price change at a single point in time 
references
    shah  devavrat  and kang zhang  bayesian regression and bitcoin  arxiv preprint arxiv                  
    blockchain info  https   blockchain info 
    coinbase api  https   www coinbase com docs api overview
    okcoin api  https   www okcoin com about publicapi do

 

fi