 

short term power forecasting of solar pv systems using
machine learning techniques
mayukh samanta
bharath k  srikanth
jayesh b  yerrapragada

abstract
roof top mounted solar photovoltaic  pv  systems are becoming an increasingly popular means of incorporating clean energy into the
consumption profile of residential users  electric utilities often allow the inter connection of such systems to the grid  compensating system
owners for electricity production  as the systems grow in number and their contribution to the overall load profile becomes increasingly significant 
it becomes imperative for utilities to accurately account for them while planning and forecasting generation  additionally  this information is
useful for system owners who want to optimize their production schedule  we use various machine learning and statistical techniques to train
models on solar irradiance data and different meteorological parameters to forecast solar irradiance  and therefore power  for different forecasting
horizons in the short term future  we begin with a series of nave models  linear regression  locally weighted linear regression and support vector
regression  svr   where we only use meteorological information in the present to make future predictions  and then progress to time series
modeling  we find that both linear and locally weighted linear regression perform rather poorly in the nave case  we consider only svr  both
the regular and least squares variation  along with conventional statistical models such as the seasonal auto regression integrated moving average
 arima  model in the time series implementation  our best results  with an rmse of       w m    are obtained from using least squares svr
 ls svr  with an rbf kernel  trained on solar irradiance data and meteorological features in the   hours prior to the present time t  and from
   and    hours prior to the forecasting time t   tf   where tf is the forecasting horizon  this model performs better than existing models in
literature which use the same dataset 

i  i ntroduction
renewable energy accounted for     of all electricity generation
worldwide as of       with solar pv representing only about      
of the global electricity demand      however  in terms of the
proportion of newly installed capacity  solar pv ranked the highest
in the world overall among all forms of electricity generation in
      in the us  for example  the installed solar pv capacity
is forecasted to be     gw in       more than three times the
size it was three years ago      thus  with a rapid decrease in
manufacturing and production costs  solar pv is expected to make
a significant contribution to meeting the worlds energy demands 
and the need for systems level planning and design is increasingly
becoming more critical 
inter connection is the process by which pv systems are linked to
the electricity grid  and system owners are effectively compensated
by utilities for sending power back into the grid  utilities have
complex planning and scheduling procedures in place for electricity
generation and pricing from their forecasted estimates of load
curves  however  they do not take into account the contribution
of distributed generation sources such as roof top solar pv  this
makes accurate forecasts for these systems particularly important 
as electricity generation at the utility scale involves planning at least
a few days in advance  since electricity exhibits variable pricing
and utilities typically allow only a capped amount of power to
be sent back into the grid  these forecasts would be helpful to
a system owner that wanted to maximize their compensation as
well  a simplified economic interpretation is that the availability
of more information on both the supply and demand sides leads
to a reduction in incomplete information  and therefore increased
economic efficiency  the importance of accurate forecasting is clear 
and this serves as our primary motivation in choosing this problem 
there is a significant amount of literature on short term power
forecasting using various statistical and machine learning methods 
sharma et al      argue that the generation profile of pv systems
is heavily dependent on local  site specific conditions  the use of
analytical models to describe the system becomes difficult because
the factors that determine solar irradiance  and consequently electric
power  vary greatly from one location to another  for instance 

incorporating the effect of the idiosyncracies of a particular pv
system  such as shading and local weather conditions becomes
much harder in an analytical model  this is our motivation for
using machine learning  an automated approach  if implemented
correctly  accounts for these local conditions and makes predictions
with better accuracy 
diagne et al      succintly review the various classes of methods
that have been employed for irradiance forecasting  the most basic
model is the persistence forecast  which is a naive predictor that
assumes that the best predictor of solar irradiance at time t     
xt     is the irradiance at time t  xt   this is the baseline comparison
used in the work of perez et al       sharma et  al report results
using simple linear regression and svm models      and our work
first attempts to primarily build on this  other interesting ml ai
approaches include the use of neural networks  as in the work of
lauret et al      who use a multi layer peceptron structure model 
more detailed neural network models include the work of kemmoku
et al       mihalakakou et al       sfetsos and coonick      fatih et
al       among others  incorporating aspects such as multi stage to
time delay neural network models  some approaches attempt to use
cloud cover and satellite imagery data as well  such as the work of
chow et al        which attempts to predict intra hour  sub kilometer
forecasting of cloud cover using ground based sky images  hybrid
approaches which attempt to utilize the best aspects of different
machine learning approaches have been developed as well       we
adopt some of the insights from prior work into our own modeling
approach  which is described in the next section 
ii  m odeling the p roblem
a  data set
the dataset used in this work is historical weather data from
amherst  ma  and is maintained by the university of massachusetts  amherst  computer science weather station  this data
is from the same source used by sharma et al   except that we use
more a recent dataset 
the data contains solar irradiance values and meteorological
observations obtained from a period of january to july      at five
minute intervals  we have averaged over this dataset to obtain hourly

fi 

data  the resulting dataset contains      rows  the data collected
has different parameters  such as timestamp  temperature  wind chill 
heat index  humidity  dew point  wind speed  maximum wind speed 
wind direction  rain  barometer pressure  extra terrestrial irradiance
and uv irradiance  from this  we have eliminated features that have
large amounts of missing data or seemed impractical to use  such
as uv irradiance  extraterrestrial irradiance and wind direction 

b  models used
in this work  we train a variety of models on our data and
determine which features and models enable us to predict solar
irradiance better  our models are divided into two broad categories 
naive methods and time series modeling methods  the key difference between the two classes of methods was the incorporation of
historical solar irradiance values as features or parameters in the
time series methods  while these values were absent in the naive
methods  in this work  the naive methods are discussed further in
section    and the time series methods in section   

figure    linear regression prediction on a test set of    consecutive days

a  linear least squares regression
linear least squares regression is among the simplest algorithms
that exist to verify the relationship between a dependent variable
and a set of independent variables  given a training feature set x
and a corresponding solar irradiance vector y  the trained model 
is obtained from the equation 
    x t x   x t y

figure    different models and techniques used

c  nature of training and test sets
our training set  unless specified  contains      observations
from the dataset    months worth of data   our test sets contain
    observations  one month worth of data   these training and
test sets were selected from a random permutation of the dataset 
all error values i e  root mean squared error  rmse  and mean
absolute error  mae   have been reported on these random training
and test sets  for all of our models  in addition to the training and
test sets  we also evaluated their performance on a test set of   
consecutive days      hours   this was interesting as it was a good
respresentation of an actual use case for this problem and it allowed
us to compare the performance of the naive and time series models
that we used  it also allowed us to see how closely the model tracked
hourly solar values across a fixed period of time 
iii  naive m ethods
before using any of our models  we experimented with different
dimensionality reduction techniques  such as manually removing
dataset features that had minimal correlation with solar irradiance 
and using principal component analysis      to reduce the dimensionality of the feature set  we found that pca improved the
performance of our models significantly  prior to applying pca 
we preprocessed the feature set so that it had zero mean and unit
variance  this result is discussed in more detail in section iii c 

   

linear regression performed poorly on the randomly generated
sets we used for testing  we found that the models performance
improved by pre processing the dataset  but it still had a large error
in its predictions with a training and test set rmse of        w m 
and        w m  respectively  on the test set of    consecutive
days too  we found that linear regression did not perform too well
as can be seen in figure   
b  locally weighted linear regression
non parameterized algorithms are an interesting class of algorithms to use on our prediction problem  given that we have a
sufficiently large training set  locally weighted linear regression
is a non parameterized algorithm that is a more specialized form of
linear regression  in which the linear coefficients of the model at
a particular point are affected to a greater extent by neighboring
training examples  and to a far less extent by distant training
examples  we used a fairly standard equation to compute the
weights of a sample  given by
wi   exp  xi  x t  xi  x       

   

and computed the training model using the normal equation
    x t w x   x t w y

   

for this model  we had to vary the bandwidth parameter    and
we found empirically that a value of    gave us good performance 
interestingly  for a randomly permuted training and test set  using
locally weighted linear regression did not improve the models
performance significantly  with a training and test set rmse of
       w m  and        w m    we felt that this model was not
much better than the linear regression model  especially when its
intensive computational nature is taken into account  on the test set
of    consecutive days too  the locally weighted regression model
was very similar in performance to the linear regression model 

fi 

figure    performance of the svr model with varying number of principal
components
figure    svr predictions over a test set of    consecutive days

c  support vector regression
support vector regression  svr  constructs a hyperplane  or a
set of hyperplanes  to perform regression on high dimensional data 
the objective of the svr model is

x
 
minimize kwk    c
 i  i  
 

   

subject to
yi  hw  xi i  b     i
hw  xi i   b  yi     i
i   i   
the svr tool we used for this purpose comes from the libsvm
library  the library contains a variety of tools for both classification
and regression purposes  and the particular tool we selected for
svr was the epsilon svr tool  this tool makes use of two free
parameters  c  which represents the penalty parameter of the error
term  default       and   default         which represents the value
for which no penalty is imposed to the training loss function as long
as the predicted values are within a distance  of the actual value
of the training examples 
we used three different kernels to test this model   the linear 
polynomial and radial basis function  rbf  kernels  we found
that the rbf kernel performed the best  with a train and test rmse
of        w m  and        w m    these results were obtained
using the original dataset with basic pre processing  we believe
the good performance of the rbf kernel can be attributed to the
way it maps the input dataset to a higher dimensional space  thus
capturing non linear relationships between the feature set and the
solar irradiance values  also  to achieve the performance that we
mentioned  we used the value c        and the default setting for
 from libsvm  as we found that the model gave us fairly poor
performance with the default value for the parameter of c 
we found pca to be very effective in improving the perfomance
of the svr model  on varying the number of principal components 
we found the model performed best with   principal components 
with a training and test rmse of        w m  and        w m   
the performance of the model with different numbers of principal
components can be seen in figure   
we found that the svr model we described performed reasonably
well on the test set of    consecutive days  with an rmse of      
w m   

iv  t ime  s eries m odeling
from the implementation of our previous models and the variation
of solar irradiance across consecutive hours  we observed that the
data series has a fairly salient time series aspect  that is  the solar
irradiance peaks at a particular time in the day  and hence has a fairly
seasonal trend  thus  it makes sense to model solar irradiance as not
just a causal relationship with the meteorological feature set  but also
as a time series  we experimented with different models  namely
the seasonal auto regression integrated moving average  arima 
model and the least squares support vector regression  ls svr 
to model the time series aspect of this dataset 
a  arima
arima models are the most general class of models for timeseries forecasting       they are composed of autoregressive terms 
non seasonal differences and lagged forecast errors  basic arima
models are non seasonal and work best with stationary time series 
the model is generally referred to as an arima p  d  q  model
where parameters p  d  and q are non negative integers that refer
to the order of the autoregressive  integrated  and moving average
parts of the model respectively  an alternative to the non seasonal
arima model is to use the seasonal arima model  which is
denoted as arima p  d  q   p  d  q   a seasonal arima model
could consist of seasonal autoregressive  ar  and moving average
 ma  terms  and this model can be represented as
    l      lf   lnyt





t  l t  l 
t
t  l t  l 

   

where  l  is the auto regressive operator
 l         l    l        p lp

   

and  l  is the seasonal auto regressive operator   l  is the
moving average operator  given as
 l          l     l          p lp

   

and  l  is the seasonal auto regressive operator  in addition to
these   denotes differencing   denotes seasonal differencing and f
denotes the cyclical frequency of the model  previous studies have
used an arima                   model to build a simple forecasting
model       to use this technique for solar irradiance data  we used
the same model specifications with f       to predict hourly data

fi 

figure    arima predictions over a test set of    consecutive days

figure    time series ls svr predictions on a test set of    consecutive
days

that was seasonal at the    hour horizon  we found that this model
was excellent at capturing seasonal trends of peaks in the data 
i e  the model was able to predict the occurrence of peaks in solar
irradiance in a day very well  however  it was unable to capture dayspecific intensity values  as it had no information regarding any of
the meteorological factors that are correlated to the magnitude of
irradiance peaks a day  thus the arima model performed poorly
as compared to the basic svr model in terms of error  with an
rmse of        w m    subsequently  as an extension to the
arima model  we also experimented with providing the model
with causal inputs  i e  the meteorological feature dataset  however 
this performed poorly too  as we found that providing causal inputs
did not damp the original models seasonal prediction enough to
significantly improve performance 
b  least squares support vector regression
least squares svr is a support vector model that is similar
in nature to vapniks formulation of svr  from section iii c  
one key difference between the least squares svr model and the
conventional svr is that the ls svr solves a system of linear
equations as opposed to the optimization problem described in
section iii c  the least squares svr is formulated to minimize
the following cost function     
minimize j w  b     

 
x  
kwk   
i
 
 

   

subject to
yi  hw  xi i  b   i
where xi can be replaced by a kernel function  xi   as in the case
of the regular svr  to map the feature set to higher dimensional
space  w and b take the same meaning as before  i e  they are
the weights and the bias of the prediction model respectively  the
lagrangian for this problem can then be expressed as
l w  b        j w  b    

x

k  yi  hw  xi i  b  i      

ls svr has a few advantages over conventional svr in terms
of the speed of solving and lower computational intensity  while
retaining the advantages of svrs with respect to solving small
sample size data and nonlinear problems      

   time series ls svr  we first implemented an ls svr model
attempting to capture the time series nature of the dataset and also
compared its performance to a time series implementation using a
regular svr model  as expected  we found that the ls svr gave
us better accuracy in predictions  we used the rbf kernel  as it
gave us the best performance  as described in section iii c   our
feature set in this case consisted of irradiance values obtained at
different points in time between   and    hours before our targeted
prediction time  also referred to as the target hour   a typical feature
set consisted of a few hours of data earlier on the same day as
that of the target hour  as well as data from the same hour on the
previous day  or the previous two days  we found that by using
irradiance values from    and    hours previous to the target hour 
along with   hours of irradiance from the same day we obtained
a model with accurate predictions  the error on the test set of this
model was an rmse of       w m    this result indicated that
the ls svr model was better suited to our application than any
other model we had experimented with thus far  we hypothesize
that  this is because ls svr works to minimize the error obtained
by including the squared error term in the cost function  as opposed
to the regular svr which tolerates errors below a threshold  
   ls svr hybrid model  the increased accuracy of the lssvr model on time series predictions encouraged us to further
enhance our model by implementing a hybrid prediction using a
feature set that included past irradiance values  as well as the
meteorological feature set  our hypothesis was that the ls svr
model would be able to better capture the relationship between
solar irradiance and the causal inputs  as well as its nature as a
time series  as compared to the arima model with causal inputs 
we found that this model did remarkably well and gave extremely
accurate predictions as compared to the other models  with a test
set rmse of       w m    this suggests that ls svr with the
rbf kernel is among the best suited models for this regression
problem  because it is capable of taking both time series data and
meteorological features into account  without unduly weighting one
of these aspects more than the other  thereby providing a result that
is far more accurate than other models  as can be seen from figure
   this model does a very good job of predicting solar irradiance 
c  arima and ls svr hybrid model
finally  we experimented with multiple hybrid techniques using
arima  to capture the seasonal nature of the data  and ls svr  to

fi 

table i
e rrors in the predictions of various models
model
linear reg
lwlr
svr  w o pca 
svr    pcs 
arima
arima ls svr
svr  time series 
ls svr  time series 
hybrid ls svr

samples
train test
    
   
    
   
    
   
    
   
    
   
    
   
    
   
    
   
    
   

rmse  w m   
train
test
      
      
      
      
      
      
      
      
      
     
      
    
      
     
     
     
     

mae  w m   
train
test
      
      
      
      
     
     
     
     
     
     
      
    
      
     
     
     
     

r eferences
figure    hybrid ls svr predictions on a test set of    consecutive days

capture the causal nature   one technique was to model the errors of
the ls svr prediction as a time series using arima  and another
was to use both model independently to predict solar irradiance 
then  subsequently regress over both of these predictions to obtain
a prediction that is essentially an average of the two independent
predictions  in both of these cases  the hybrid models did not lead to
an improved performance  when compared to our previous models 
however  we believe that with further investigation  we can develop
such a hybrid model incorporating both arima and ls svr  to
help predict irradiance values to a very high degree of accuracy 
v  s ummary
we have implemented a variety of models which model solar
irradiance using only meteorological data  such as linear regression 
locally weighted regression  and svr  as well as models that
capture the time series nature of the data  such as arima and
ls svr  we found that the ls svr model performed the best 
however  while these time series models were effectively able to
capture the time dependence of our target variable  they were unable
to model the causal relationship between meteorological data and
solar irradiance  to overcome this  we tried different hybrid models
using ls svr and arima  which did not give us optimal results 
instead  we found that by incorporating meteorological data into the
feature set for the ls svr model  we obtained far more accurate
predictions  we feel that this is because  unlike other hybrid models 
the seasonal component and the weather data are more appropriately
weighted by the ls svr model  both in terms of the features
chosen by us  e g   the extent of historical information provided 
and the inherent nature of the model itself   table   summarizes the
performance of the models we have used in this work 
vi  f uture w ork
we believe that this work can be improved by using a better
constructed hybrid model  as we found that our models often predict
a non zero solar irradiance value during periods of the day when
there is relatively low  or zero  sunlight  by using additional features
such as cloud cover data  and models that capture seasonality well 
such as the arima model  the accuracy of our predictions can be
further improved  another issue that we faced with models that used
the arima framework was the requirement that we use sequential
data points in our training as well as test sets  which leads to
non optimal results  in our future work  we would like to explore
methods through which we could compensate for this as well 

    i  pvps  pvps reporta snapshot of global pv           report
iea pvps t      vol             
    s  e  i  association et al   us solar market insight       year in
review executive summary  solar energy industries association retrieved from http   www seia org research resources us solar marketinsight       
    n  sharma  p  sharma  d  irwin  and p  shenoy  predicting solar
generation from weather forecasts using machine learning  in smart
grid communications  smartgridcomm        ieee international
conference on  pp          ieee       
    m  diagne  m  david  p  lauret  j  boland  and n  schmutz  review of
solar irradiance forecasting methods and a proposition for small scale
insular grids  renewable and sustainable energy reviews  vol     
pp             
    r  perez  k  moore  s  wilcox  d  renn  and a  zelenka  forecasting
solar radiationpreliminary evaluation of an approach based upon the
national forecast database  solar energy  vol      no     pp         
     
    p  lauret  e  fock  r  n  randrianarivony  and j  f  manicomramsamy  bayesian neural network approach to short time load
forecasting  energy conversion and management  vol      no    
pp                 
    y  kemmoku  s  orita  s  nakagawa  and t  sakakibara  daily insolation forecasting using a multi stage neural network  solar energy 
vol      no     pp               
    g  mihalakakou  h  a  flocas  m  santamouris  and c  g  helmis 
application of neural networks to the simulation of the heat island
over athens  greece  using synoptic types as a predictor  journal of
applied meteorology  vol      no     pp               
    a  sfetsos and a  coonick  univariate and multivariate forecasting
of hourly solar radiation with artificial intelligence techniques  solar
energy  vol      no     pp               
     f  o  hocaoglu    n  gerek  and m  kurban  a novel   d model
approach for the prediction of hourly solar radiation  in computational
and ambient intelligence  pp          springer       
     c  w  chow  b  urquhart  m  lave  a  dominguez  j  kleissl 
j  shields  and b  washom  intra hour forecasting with a total sky
imager at the uc san diego solar energy testbed  solar energy  vol     
no      pp                 
     s  cao and j  cao  forecast of solar irradiance using recurrent
neural networks combined with wavelet analysis  applied thermal
engineering  vol      no     pp               
     i  jolliffe  principal component analysis  wiley online library       
     g  e  box and g  m  jenkins  time series analysis  forecasting and
control  revised ed  holden day       
     g  reikard  predicting solar radiation at high resolutions  a comparison of time series forecasts  solar energy  vol      no     pp         
     
     j  a  suykens  t  van gestel  j  de brabanter  b  de moor  j  vandewalle  j  suykens  and t  van gestel  least squares support vector
machines  vol     world scientific       
     y  guo  x  li  g  bai  and j  ma  time series prediction method based
on ls svr with modified gaussian rbf  in neural information processing
 t  huang  z  zeng  c  li  and c  leung  eds    vol       of lecture
notes in computer science  pp       springer berlin heidelberg 
     

fi