predicting function from sequence
in venom peptide families
arvind kannan

g  seshadri

email  afk stanford edu

email  seshg stanford edu

abstracttoxins from animal venoms are small peptides that recognize specific molecular targets in the brains of prey or predators 
next generation sequencing has uncovered thousands of diverse toxin
sequences  but the functions of these peptides are poorly understood 
here we demonstrate that the use of machine learning techniques on
sequence derived features enables high accuracy in the task of predicting
a toxins functionality using only its amino acid sequence  comparison of
the performance of several learning algorithms in this prediction task
demonstrates that both physiochemical properties of the amino acid
residues in a sequence as well as noncontiguous sequence motifs can be
used independently to model the sequence dependence of venom function 
we rationalize the observed model performance using unsupervised
learning and make broad predictions about the distribution of toxin
functions in the venome 
keywordsbioinformatics  machine learning  protein function prediction  venomics 

i 

i ntroduction

over the past fifty years  proteins and small molecules isolated
from animals  plants  and microorganisms have formed the basis of
nearly all clinically approved pharmaceuticals  for example  many
chemotherapeutics for cancer are derived from plant natural products
     and mining microbial communities for biological warfare agents
continues to be the most common avenue for discovering new
antibiotics      as such  the development of both computational
and experimental tools that will enable rapid screening of the vast
chemical space of molecules present in nature for important biological
functions is of profound importance to future drug discovery efforts
    
in the past decade  much attention has been focused on the
therapeutic use of proteins extracted from the venom of snakes 
tarantulas  cone snails  and other predatory animals      venom proteins are particularly attractive therapeutic candidates because they    
typically exist as small peptides that are easy to synthesize      possess
remarkable thermal and chemical stability      are highly tolerant to
mutation  and     often contain flexible loops that can be reengineered
for high affinity and specificity towards relevant biological targets  for
example  a neurotoxin first isolated from cone snail venom has been
developed into an fda approved painkiller      and knottin peptides
from spider venom have been reengineered as tumor targeting agents
for cancer imaging and treatment      moreover  the rise of nextgeneration sequencing technologies over the past five years has given
birth to the new field of venomics  in which mass spectrometry and
rna sequencing of venom extracts are coupled with bioinformatics
analyses in order to identify and catalogue new venom components
     indeed  the rate at which new sequencing data on such proteins is
acquired is far outpacing our conceptual understanding of the structure
and function of venom peptides  necessitating the development of new
computational tools for effectively mining venomic data  figure    
in this paper  we describe the use of both supervised and unsu 

pervised machine learning techniques in order to identify sequencederived features that predict the likely biological targets of venom
components  we have made use of the wealth of publicly available
databases of venom proteins  such as conoserver     and the knottin
database      which contain amino acid sequences as well as annotated structural and functional data for each protein when available 
previous work in this field has led to the development of predictors
that use predominantly sequence homology in order to classify
sequences into venom families       this approach is fundamentally
limiting because homology often provides very little information
about the putative function of a protein  especially because the most
evolutionarily conserved regions of a toxin sequence typically lie in
precursor signal peptide regions  which are subsequently cleaved off
in the mature toxin  moreover  many emerging sources of venom
sequence data  such as proteomics studies  provide information only
about the mature toxin sequence in the absence of the signal peptide 
necessitating the development of predictive tools that do not rely on
signal peptide homology 
for this reason  we have developed classifiers of toxin function
using both physicochemical properties of the amino acid residues as
well as conserved sequence motifs within a peptide sequence  we
demonstrate that these derived features segregate venom constituents
into functional classes with high performance and low generalization
error  we then rationalize the observed performance of our models
using unsupervised clustering and feature reduction  finally  by running our predictors on a larger set of uncharacterized toxin sequences

fig     the protein function prediction problem for venom peptides  on the
left is shown a representative toxin from the fish hunting cone snail conus
striatus  on the right are shown three canonical examples of transmembrane
proteins in the brain whose function can be modulated via the binding of
such toxins  the challenge of functional venomics is to link the amino acid
sequence of a venom peptide with the identity of its molecular target 

fiand comparing the functional clusters that emerge to the known gene
superfamilies based on signal peptide homology  we provide insights
into the evolution and diversification of toxin function 
ii 

m ethods

a  training data
labeled training data for toxin classification were obtained from
two publicly accessible databases  conoserver and arachnoserver 
which contain functionally annotated peptide sequences from cone
snail and spider venom  respectively  in both servers  sequences are
binned into functional categories based on published experimental
data  although the classes differ in the two cases  spider toxins
can target highly heterogenous protein targets  so arachnoserver
classifies each sequence according to the broad functional class of
its target  i e  membrane proteins  ion channels  enzymes  etc    in
contrast  conotoxins function almost exclusively as neurotoxins  so
conoserver groups these peptides according to their neuromodulatory
function on specific subtypes of ion channels and neurotransmitter
receptors  in both cases  the distribution of class members is highly
skewed  with some functional categories containing significantly more
annotated examples than others  table     since greater than     of
the annotated examples were encapsulated in the top   or top   classes
for the spider and cone snail datasets  respectively  we consolidated
all remaining classes into an other category to facilitate learning
and prediction given the low number of available examples 
the available functionally annotated sequences used for training
the models described in this work constitute less than     of
the total database size for both organisms  highlighting a growing
disparity between the throughput of next generation sequencing and
that of functional screens  and emphasizing the need for accurate
bioinformatic tools to bridge this gap  moreover  the low to moderate
pairwise sequence similarity within each functional class  table   
precludes accurate classification using naive sequence alignments and
justifies the use of physically motivated supervised models 
training examples were pre processed by identifying and excising
any signal or pro peptide regions from the toxin sequence using
the spiderp and conoprec utilities available within arachnoserver
and conoserver  respectively  these algorithms utilize svm based
models in conjunction with sequence heuristics to identify likely
protease cleavage sites that demarcate the pro sequence from the
mature toxin  this pre processing step increases the chance that our
models learn real biophysical determinants of venom function as
opposed to artifacts associated with signal peptide evolution 
b  feature representations
two complementary feature representations of the toxin sequences were designed and compared with respect to their pertable i 

s ummary of labeled data used to train functional
classifiers for spider and cone snail toxins  

spider toxins  arachnoserver 
functional
class
membrane
channel
enzyme
other

number
of
sequences
  
   
  
  

pairwise
sequence
similarity
        
        
        
        

cone snail toxins  conoserver 
functional
class
alpha
delta
mu
omega
other

number
of
sequences
   
  
  
  
  

pairwise
sequence
similarity
        
        
        
        
        

fig     schematic of feature representation used for venom classification
using physicochemical characteristics of the peptide sequence 

formance in predicting venom function  in the first strategy  we
represented each toxin as a six dimensional vector that summarizes
the physicochemical properties of the peptide sequence  figure    
in particular  we incorporated the overall sequence length as well as
the number of residues in each electrostatic class  hydrophobic  polar 
and neutral  as relevant features that constrain the types of binding
pockets and receptor motifs which can be accomodated by the peptide 
additionally  we paid special attention to the number and position of
cysteine amino acids within each sequence  as these residues form
disulfide bonds that significantly constrain the fold and stability of
each peptide 
in parallel  we also evaluated an alternative text based representation of the toxin sequences using noncontiguous substrings of length
n  letting  be the set of all amino acid sequences of length n  we
defined the feature representation of a string s as
 s   r    

   

with
u  s   

x

in i    

   

i  ii      in  
 i     in  s 
 u   s i 

here the summation is taken over all noncontiguous substrings of s
that match with the uth word in the dictionary   and the discount
factor         penalizes each match based on the extent of
noncontiguity of the substring  this representation has the effect of
capturing motifs of length n present within the amino acid sequence
of each peptide  and is equivalent to the n gram model in the limit as
     for nonzero   the representation has the capacity to model
correlations between amino acids that are distal along the primary
sequence  and can thus be used to identify  d structural motifs such
as secondary and tertiary elements even in the absence of an explicit
structural model 
c  learning algorithms
learning using the six dimensional physicochemical feature representation described above was carried out using both multinomial
logistic regression 
 k
 
m
k
x
x
x
t  i 
 i 
t  i 
k
x
max
  y   k k x  log
e
   
        k  
i  
k   

k  

k  

as well as multiclass svm using the one vs one strategy 
maxm

m
x

r
 i c i  
t y
   

i 

m m
  xx
i j y  i  y  j  k x i    x j    
  i   j  

   

fik x  y    xt y 

   

as well as a gaussian kernel  rbf  
k x  y    exp    x  y   



   

the scikit learn machine learning library was chosen for efficient
implementation of the above algorithms  with libsvm used as the
optimization engine 
learning using the substring text representation was carried out
using a multiclass svm with the string subsequence kernel  ssk 
     
x
x
x
k s  t   
l i  l j       
u

i  ii      in  
j  ji      jn  
 i     in  s   j     jn  t 
u s i 
u t j 

with   n  and  defined as above  note that while direct enumeration
of this sum is exponentially expensive as a function of n  the
ssk can be efficiently computed in o n   s    t   time using
dynamic programming  thereby enabling its use in learning problems
of moderate size  an implementation of this kernel in the shogun
machine learning library was used to build our functional classifiers 
free parameters in each learning algorithm  such as the svm
regularization constant c  the bandwidth parameter  in the rbf  and
the parameters n and  in the ssk  were chosen so as to maximize the
average test set accuracy over    replicates of   fold cross validation 
and were optimized via grid search 
iii 

r esults and d iscussion

a  performance of learning algorithms
we first compared the performance of the learning algorithms
described above with respect to cross validation accuracy on both
the spider and cone snail datasets  figure     all four algorithms
performed significantly better than chance on both datasets  baseline
accuracies of     and     for arachnoserver and conoserver 
respectively   suggesting that both feature representations capture at
least some of the correlations between toxin sequence and function 
moreover  the top performing models on each dataset exhibit impressive multi class accuracies considering the small training set sizes
and relatively simple models used for learning  quite surprisingly 
all four algorithms exhibited uniformly higher performance on the
arachnoserver data than on the conoserver data  despite the latter
featuring substantially higher sequence similarity within each class on
average  table     suggesting that spider toxins manifest a more direct
link between sequence and function than conotoxins  this conclusion
is consistent with the fact that test set accuracy increases dramatically
as a function of model complexity  rbf and ssk models versus
linear models  for the conoserver data but remains relatively constant
across all models for the arachnoserver data 
since overall test set accuracy can sometimes be a poor proxy for
algorithm performance in multi class learning problems  especially
when class membership is skewed  we computed confusion matrices
for the ssk model  which exhibited the highest accuracy on both
datasets  figure     classification accuracy varied significantly from
class to class  with the most populous class always exhibiting significantly lower error rates than the others  interestingly  classification

   

test set accuracy    fold cross validation 

where the optimization in equation   is carried out for each pair of
classes  the svm algorithm was implemented using both a linear
kernel 

logistic
regression

  

  

svm with
linear
kernel

  

svm with
gaussian
kernel
svm with
string
subsequence
kernel

  

 

arachnoserver

conoserver

fig     comparison of the performance of four learning algorithms with
respect to multi class prediction accuracy on the two toxin datasets considered
in this work  error bars reflect the standard deviation over    iterations
of   fold cross validation on each dataset  all algorithms except the string
subsequence svm were trained on the physicochemical feature representation
shown in figure   

accuracy did not correlate with class size outside of the largest
class  and certain functional categories such as the  conotoxins
consistently performed more poorly than others  this phenomenon
was observed for all learning algorithms  and could reflect either bias
in the training data  i e  non uniform sampling of the sequences in
each class by experimentalists  or intrinsic heterogeneity of certain
venom functions  in all datasets and models  the other class formed
via concatenation of the functions with the fewest available examples
was consistently misclassified into one of the more common classes 
this result is unsurprising given that the sequences in the other
class cover a diverse range of structures and functions  so any
two sequences in this category likely share very little overlap in
either physicochemical properties or primary sequence motifs  as
such  we suspect that the performance of our algorithms could be
further improved by either  a  excluding the other class entirely and
training the model only on the most populous classes  or  b  explicitly
breaking up the other class into its constituent functions in spite of
low sub class representation within the training set  quite strikingly 
all three classes except the other meta class in the arachnoserver
dataset were predicted with near perfect accuracy by all four learning

fig    
confusion matrices for the ssk model evaluated on both the
arachnoserver and conoserver datasets  reported frequencies are averages
over    iterations of   fold cross validation on each dataset  classes are ranked
according to the number of available training examples  and the last class
corresponds to the other category in both cases 

fitest error

logistic
regression

classification error    

  

svm with
linear
kernel

  
  

svm with
gaussian
kernel

  
  
 
  

  

  

  

  

   

svm with
string
subsequence
kernel

training set size    of data 
fig     comparison of training and test error as a function of training set
size for the   learning algorithms used in conotoxin classification 

algorithms  providing further evidence for a robust mapping between
sequence and function in this dataset 
b  error analysis
next  in order to analyze the contributions of model bias and
variance to the observed prediction errors  we plotted training and
test set accuracy as a function of training set size for all   algorithms
when evaluated on the conoserver dataset  figure     this analysis
revealed that the primary source of generalization error in our learning
algorithms shifts from bias to variance as the model complexity
increases from the linear models  logistic regression and linear svm 
to the highly nonlinear models  rbf and ssk   for example  in the
logistic classifier  the gap between training and test error shrinks to
  as the training set size is increased  while the overall performance
remains poor  this suggests a high bias regime  where the learned
model is not sufficiently rich to benefit from additional data  in
contrast  in the ssk and rbf classifiers  a significant gap between
training and test error remains even when     of the data is used
for training  although the overall performance of these methods is
significantly higher than that of the linear models  this suggests
a high variance regime  where the available training data is small
relative to the model complexity and the likelihood of over fitting is
high  the string subsequence model demonstrates an extreme case
of this phenomenon  where the training data is linearly separable
    training error  in the high dimensional space of noncontiguous
sequence motifs  but the resultant classifier is nonetheless imperfect
with respect to the test set 
the linear svm presents a compromise between these two error
regimes  providing reasonable performance  high enough accuracy to
make statistical predictions on toxin libraries but too low for accurate
single sequence classification  while avoiding model variance  as
such  we suspect that the linear svm will be more robust to systematic sources of error in the training set  such as experimenter bias
in the choice of sequences to characterize from each class  relative
to the higher variance nonlinear models  for this reason  we chose to
use the linear svm when making predictions on the distribution of
uncharacterized toxin functions in order to minimize false discovery
at test time  an alternative strategy to reduce variance would be to
increase the degree of regularization in the richer nonlinear algorithms

   
   
   
   
   
   
   
   
     

principal component  

training error

principal component  

  

 

 

 

principal component  

   
   
   
   
   
   
   
   
     

channel
membrane
enzyme

 

 

principal component  

 

fig     principal component analysis of the spider toxin dataset with respect
to the   physicochemical features used for functional classification  the
three most populous functional classes form differentiated clusters on lowdimensional subspaces of the feature space  and reasonable separation of the
classes can be observed with as few as   principal components 

 decrease c   which has the effect of sacrificing optimal accuracy in
favor of model robustness 
c  unsupervised analyses
the extremely high performance and model insensitivity of the
physicochemical feature representation on the arachnoserver dataset
was surprising given the low dimensionality     of the feature space
relative to that of the sequences themselves    l s     in order to
better understand the origins of the observed accuracy  we performed
unsupervised clustering of the entire training set using principle
component analysis  figure     briefly  feature vectors for each
training sequence were constructed as in figure    mean substracted
and normalized in order to weight all features equally  and then
processed using the pca implementation in the scikit learn package 
when functional labels were added to the transformed data  we found
that the three most populous classes form differentiated clusters on
low dimensional subspaces of the feature space  strikingly  reasonable
separation between the classes was observed with as few as  
principal components  these results corroborate the high performance
of the supervised algorithms which use this feature set  and lead
to the unexpected conclusion that a small number of independent
physicochemical properties can explain a significant fraction of the
functional variation among spider toxin sequences 
d  feature reduction
the pca results motivated a forward search procedure to identify
the minimal number of physicochemical features required for accurate
prediction of spider toxin function  for each of the three learning
algorithms based on this feature set  we started from a random model
and sequentially added features to the predictor one by one in random
order  we monitored the algorithm performance as a function of the
number of features used at each iteration of this procedure  figure    
and found that the accuracy quickly converged to its maximal value
for all three models using only a few features at a time  the test set
accuracy when only four features were used was indistinguishable
within error from the fully optimized models  in accordance with the
pca results 
e  predictions on uncharacterized toxins
after analyzing and optimizing our prediction algorithms as described above  we classified all unannotated protein sequences within

fi   

logistic
regression

test set accuracy

  
  

svm with
linear
kernel

  
  

svm with
gaussian
kernel

  
  
   

 

 

 

 

 

 

number of features
fig     forward search procedure for feature reduction on the spider toxin
dataset  test set accuracy was evaluated using   fold cross validation  error
bars reflect the standard deviation over    replicates of the forward search
procedure  each with a different order of feature addition 

the conoserver and arachnoserver databases using the linear svm
 as motivated above   table   summarizes the predicted fraction of
the spider and cone snail venomes present within different functional
classes  we observed that the predicted distribution of toxin sequences
within each functional class differs significantly from the empirical
distribution of the training set  for example  only     of toxins within
the cone snail venome are predicted to be in the alpha functional
class  while     of experimentally characterized sequences belong
to this class  the discrepancy between the two distributions points
to substantial experimental bias in the functional characterization of
venoms  and may guide future high throughput functional screening
efforts to improve sampling of the functional space 
f  extension to gene superfamily prediction
finally  using our predictions on the entire conotoxin venome 
we addressed the question of whether signal peptide homology is
predictive of venom function  which motivated our initial development
of a sequence based functional classifier using only the mature toxin
sequence  predictions of putative venom function were carried out
on all conotoxin sequences in the database that possessed a signal
peptide  and the functional clusters that emerged were compared to
gene superfamily assignments of each toxin based on signal peptide
homology  figure     our models predicted a strong correlation
between the functional role of a mature toxin and signal peptide
that controls its processing and export through the er after protein
synthesis  this result was wholly unexpected and counterinuitive 
given that the signal peptide is cleaved prior to venom secretion and
thus plays no structural or functional role in the mature toxin  as such 
the observed correlation implies a functionally decoupled co evolution
of these two regions of the peptide  future research using similar
machine learning techniques as those described here may provide
valuable insights into the nature and mechanism of this co evolution 
iv 

c onclusions and future work

in sum  we have described the use of both supervised and
unsupervised machine learning techniques to help elucidate the biological function of toxin peptides from two model organisms  using
rigorous cross validation and error analysis  we showed that both

fig     correlation between the functional role of a cone snail peptide  as
predicted by the mature toxin sequence  and its gene superfamily  as assigned
by the signal peptide sequence 

physicochemical summary statistics derived from the peptide sequence  as well as purely text based models  can segregate functional
toxin families with reasonable performance and low generalization
error  moreover  we suggest that application of the predictors to
toxin sequences of unknown function may shed light on both the
distribution and evolution of novel function within the venome 
r eferences
   

   

   
   
   
   

   
   
   

    

    

da rocha  adriana b   rafael m  lopes  and gilberto schwartsmann 
natural products in anticancer therapy  current opinion in pharmacology                     
riesenfeld  christian s   patrick d  schloss  and jo handelsman 
metagenomics  genomic analysis of microbial communities  annu 
rev  genet                     
drews  jrgen  drug discovery  a historical perspective  science
                           
saez  natalie j   et al  spider venom peptides as therapeutics  toxins
                       
stix  gary  a toxin against pain  scientific american              
      
kimura  richard h   et al  engineered knottin peptides  a new class
of agents for imaging integrin expression in living subjects  cancer
research                        
escoubas  pierre  and glenn f  king  venomics as a drug discovery
platform                  
kaas  quentin  et al  conoserver  a database for conopeptide sequences
and structures  bioinformatics                      
gelly  jeanchristophe  et al  the knottin website and database  a
new information system dedicated to the knottin scaffold  nucleic acids
research    suppl           d    d    
kaas  quentin  jan christoph westermann  and david j  craik 
conopeptide characterization and classifications  an analysis using
conoserver  toxicon                        
lodhi  huma  et al  text classification using string kernels  the
journal of machine learning research                   

table ii 

p redicted distribution of toxin functions in
uncharacterized test set 

spider toxins  arachnoserver 
functional
class
membrane
channel
enzyme
other

training set
fraction
 observed 
    
    
    
    

test set
fraction
 predicted 
     
     
     
     

cone snail toxins  conoserver 
functional
class
alpha
delta
mu
omega
other

training set
fraction
 observed 
     
     
     
     
     

test set
fraction
 predicted 
     
     
     
    
     

fi