diagnosing parkinsons disease from gait
daryl chang  marco alban hidalgo  kevin hsu
computer science department  stanford university  stanford  ca
 dlchang  marcoal  kvnhsu  stanford edu

abstractmachine learning methods were used to diagnose
the presence and severity of parkinsons disease from gait 
data was drawn from a public physionet database consisting
of force sensors positioned under subjects feet while walking 
ambulatory features  including swing time variability  center
of pressure  and foot strike profile  were used to differentiate
normal strides from parkinsonian strides  an svm linear kernel
performed the best for predicting the presence of pd  with an
auc of       and an accuracy of        a random forest
classifier ranking the severity of parkinsons disease on a scale
of     achieved an auc of       and an accuracy of       
while past studies have used multiple sensing modalities for this
task  we outline a method for achieving similar accuracy with
only a single set of force sensors 
index termsparkinsons disease  gait analysis  force sensor

  neurodynamics  movement disorders unit of the telaviv sourasky medical center  the data consists of    
gait recordings from    patients with idiopathic parkinsons
disease  pd  and    healthy controls  during data collection 
  sensors were placed underneath each of the subjects feet 
for each subject  measurements of the vertical ground reaction
force  vgrf  in newtons were recorded as they walked at
their usual  self selected pace for approximately   minutes on
level ground  thus  each datum consists of    vgrf time
series  as well as an additional   time series representing
the aggregate force under each foot  finally  each subject is
annotated with demographic information and the presence and
severity of parkinsons disease 
iii  f eature e xtraction

i  i ntroduction
there is no standard test to diagnose parkinsons disease 
a condition that affects up to one million people in the us
     instead  doctors qualitatively assess gait  along with other
clinical observations  to determine the presence and severity of
parkinsons disease  the subjectivity of the assessment opens
up the possibility of inconsistent diagnoses     in this paper
we present a classifier that will diagnose parkinsons from
quantitative measurements of gait 
tahrir et al      showed that svms can diagnose parkinsons
from a combination of spatiotemporal  kinematic  and kinetic
gait data  in that study  spatiotemporal data was collected using
infrared sensors attached to the subjects hips and legs  while
kinetic data was collected using force sensors placed on the
subjects feet  since the former may be cumbersome to collect
in practice  we aim to diagnose parkinsons solely from kinetic
gait data 

a  overview
to decide which features to extract from the dataset  we
conducted a literature survey of medical journal articles describing gait analysis of pd patients  toledo et al      state
that the ability to maintain a steady gait rhythm is impaired
in patients with parkinsons disease  amende et al      also
show a significant statistical difference in stride length and
stride to stride frequency in subjects with pd 
after conducting the literature survey and deciding on a
feature set  we followed the feature extraction process shown
below  first  we segmented gait into stance and swing phases 
where stance is the part of a step during which the foot
makes contact with the ground  and swing is the part during
which the foot is in the air  then  we calculated the mean and
variance for each feature described in the following section 
and concatenated them to create the feature vector for each
subject 

fig     abnormal gait characteristics of parkinsons disease

ii  dataset
data was drawn from a public dataset maintained by physionet and originally collected by the laboratory for gait

fig     summary of feature extraction and modeling

fib  features extracted
   naive features  as a basic feature set  we included the
mean force for each sensor  though the mean force varies as
a function of the subjects weight  it can be used as a naive
indicator of the parts of the foot on which the subject tends
to exert pressure 
   swing and stance times  as stated by toledo et al  
swing time and stance time variability can be a significant
marker for the presence of pd  swing time is defined as the
time from when the foot lifts off the floor to when it lands
back on the floor  a healthy person is more likely to have a
consistent swing time  conversely  for a patient with pd  the
swing time length varies depending on their degree of motor
impairment  thus  a low variance in swing time is associated
with a fairly constant stride in a healthy person  whereas
in parkinsons patients  higher variance could signify trouble
walking and balancing  or freezing of gait  a phenomenon in
which parkinsons patients feel that their feet are glued to the
ground     
for each datum  the    vgrf time series were processed
to extract swing phase and stance intervals for each step  the
mean and variance of the swing and stance times were used
as classification features  figure   plots the strides of two
subjects  in which swing and stance times for the pd subject
are markedly higher than those of the non pd subject 

where n is the number of sensors and f  sj   is the vgrf of
sensor j in newtons 

fig     sensor positions

   foot strike profile  healthy people tend to walk by
lifting their heel and stepping off their toes  then landing
on their heel  parkinsons patients are more likely to have a
flat foot strike  where the heel and toe touch the ground at
relatively similar time points  motivated by this  we built a
feature set that captures foot strike profile variability  for each
datum  we use the    vgrf time series to produce time series
denoting the point in time were the subjects feet first touched
the ground after a swing phase  we then calcluated the  x y 
coordinate of the cop when the foot first contacts the ground 
and took the mean and variance as features 

fig     transition of center of pressure in one gait cycle

c  normalization schemes
fig     stride to stride time series of two subjects

   center of pressure as a measure of weight imbalance 
most healthy adults have a characteristic weight distribution
profile and pattern while walking  in a normal gait cycle  ones
center of pressure will shift from the heel to the toe over the
course of a step  as shown in figure   
to analyze center of pressure  the    vgrf time series
were used to produce a   coordinate  x and y component  time
series of the center of pressure of the subjects foot  the mean
and variance of the coordinates were used as features  note
that these features measure shifts in the weight distribution
both laterally and longitudinally  we calculate the center of
pressure  cop  as follows 
pn
cop  

j sj  f  sj  
p
n
j f  sj  

   pre feature extraction  since each subjects vertical
ground reaction force is proportional to the subjects weight 
we hypothesized that normalizing each of the    time series
by the subjects weight in newtons would refine our features 
in particular the summary statistics of the sensors  however 
this normalization scheme yielded negligible improvement in
performance 
as a data pre processing step we also tried normalizing
the time series so as to have zero mean and unit variance 
however  this also provided negligible improvement as it
eliminated much of the variation in force between the different
sensors 
   post feature extraction  initially  our logistic regression
classifier far outperformed our svm classifier  after using
min max normalization on the feature vectors we were able to
improve the performance of the svm classifier to be on par
with the logistic regression classifier  for a more detailed
explanation see the results and discussion section 

fiiv  m odel s election and r efinement
a  classifiers
we selected a basket of classification algorithms to test 
logistic regression  random forest  linear kernel svm with
regularization  and rbf kernel svm  as a baseline algorithm
for both classification tasks  we ran logistic regression with
the naive feature set described above 

vi  r esults and d iscussion
as shown in figure    the baseline algorithm performed
relatively poorly  predicting the presence of pd with      
auc and the severity with       auc  this was expected
as the force sensor means contain little information about the
abnormal gait features characteristic to parkinsons such as
swing and stance time variability 

b  feature selection
to mitigate over fitting  a subset of the feature set was
extracted using forward search  where the subset size k was
tuned as as a hyperparameter  the best subset was chosen for
the final classifier  the criteria for marginal improvement in
the algorithm was the average auc of an roc curve in   fold cross validation 
c  parameter search
after pruning our feature vector  for each classifier  we
implement a parameter grid search to find the best performing
parameters across a set of possible values  for example  for
the linear svm classifier we run a grid search on the possible
values of the regularization parameter 

fig     forward feature selection and parameter grid search 

v  e valuation m etric
one of the challenges we faced in building the classifiers
was class imbalance and small sample size  as noted in
the section detailing the data set  our input classes had a
    to     asymmetry  pd subjects to non pd subjects  
as a result  traditional accuracy measures would not have
been an effective evaluation metric  instead  we used the
auc  area under the curve  of the roc  receiver operator
characteristic curve  as our evaluation metric  the roc curve
plots the true positive rate against the false positive rate for
a binary classifier system  chen et al      have shown that
the auc to be a good evaluation metric in combating class
imbalance for small samples  as an added precaution  we
sampled training examples with weight inversely proportional
to the class frequency  thus downsampling the pd subjects 

fig        fold cross validation metrics for baseline classifiers 

to improve classification performance  we extracted the
ambulatory features described in section iii  and tested each
classification model described in section v with forward
feature selection and parameter grid search  figure   below
shows a summary of the performance of the models 

fig     average auc score over    fold cross validation for pd diagnosis
classifiers  the blue bars show the performance before parameter grid search
 gs  for best parameter estimation  the orange bars show the performance
after gs 

all models achieved an auc score higher than      with
the linear kernel svm outperforming the others by a small
margin  examining the cross validation metrics for the bestperforming classifiers in more detail  we see in figure   that
the pd classifier and severity classifier perform much better
than the baseline  in particular  the pd classifier auc of
      represents a large improvement over the       auc of
the baseline algorithm  while the pd severity improved from
      auc to       

fig     summary of best performance classifiers

fias mentioned in section iv  we used a forward search
algorithm with the average auc of an roc curve in   fold cross validation to determine the most crucial features
in our model  table i below shows the top features found by
forward selection  confirming the findings of toledo et al  and
amende et al   we find that variability in center of pressure and
foot strike profile are good predictors of pd         the first
finding is consistent with the fact that pd patients shift their
weight erratically  thus increasing the variance in the center of
pressure during the stance phase of gait  the second finding
most likely results from pd patients having a flat foot strike
rather than a heel strike  which would bring the mean foot
strike coordinate closer to the center of the foot 

if a particular dimension of x is much larger in magnitude
than the rest  it will dominate the dot product and thus
affect the separating hyperplane  normalizing adjusts for this
magnitude discrepancy  explaining the performance boost that
we observed upon normalization 

table i
m ost s ignificant f eatures in classifier p erformance
pd classifier

severity classifier

center of pressure variance  foot strike coordinate means
sensor means  center of
pressure variance  foot
strike coordinate means

fig      random forest decision boundary using features  mean xth
coordinate foot strike and variance of y coordinate of center of pressure

fig      linear svm decision boundary for swing time and variance of yth
coordinate of the centre of pressure  min max normalized   data normalized
using min max normalization  regularization c     

vii  c onclusion and f uture w ork
this paper presents several successful classifiers for the
diagnosis of the presence and severity of parkinsons disease
from gait data  we provide an improvement on previous work
by tahrir et al      by presenting a classifier that only requires
kinematic gait data  as opposed to kinematic and spatiotemporal   we also successfully extract gait abnormalities previously
shown to be associated with parkinsons disease and use them
for classification        
for future work  we would like to improve the gait segmentation algorithm to be more resistant against noise and to
segment the stride into further subphases of the gait cycle  we
would also like to extract a richer feature set that incorporates
these subphase features to improve the accuracy of the severity
classifier 
acknowledgment
the authors would like to thank andrew ng and the tas
of cs    for their guidance 
r eferences

indeed  plotting the subjects by foot strike mean and center
of pressure variance  as in figure     clearly separates the data
into pd and non pd clusters by center of pressure variance 
and to a lesser degree by the foot strike mean  the plot also
helps to explain the relatively high auc score of the random
forest classifier  as it is able to modify the decision boundary
to handle the noise in the dataset 
interestingly  both svm classifiers performed poorly  
    auc  before min max normalization  the literature about
svms suggests that large margin classifiers are sensitive to
the way features are scaled  resulting in severe accuracy
degradation if the data is not normalized  in the case of the
linear kernel svm  a prediction is calculated as follows 
 i   i 
m
i   i y hx   xi   b

    understanding parkinsons disease  parkinsons disease foundation 
     
    n  tahir  h  manap  parkinson disease gait classification based on
machine learning approach  journal of applied sciences             
        
    s  frenkel toledo  n  giladi  c  peretz  et at  effect of gait speed on
gait rhythmicity in parkinsons disease  journal of neuroengineering and
rehabilitation              
    i  amende  a  kale   s  mccue  et al  gait dynamics in mouse
models of parkinsons disease and huntingtons disease  journal of
neuroengineering and rehabilitation        vol      p  
    s  perez lloret  l  negre pages  p  damier  et al  prevalence  determinants  and effect on quality of life of freezing of gait in parkinson
disease  the journal of the american medical association       
    andre ng  advice on applying machine learning  stanford university 
http   cs    stanford edu materials ml advice pdf 
    m  wasikowski  x  chen  combating the small sample class imbalance
problem using feature selection ieee transactions on knowledge  
data engineering  vol          

fi