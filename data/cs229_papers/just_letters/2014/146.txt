from  food  to  wine  
  

justin  meier  
  

cs     final  project  
  
  
  

    introduction  
the   art   of   food   and   wine   pairing   has   dated   back  
centuries  and  since  its  first  practice   has  honed  its  rules  
and  regulations  on  what  pairs  well  together     however   
within   these   stringent   rules    nuances   and   differing  
opinions  exist  that  make  selecting  the  perfect  wine  for  a  
food  more  complicated  than  it  may  seem     even  beyond  
this    the   complexities   involved   when   selecting   a   wine  
for  an  entire  dinner  are  even  larger     the  overall  goal  of  
the  following  presented  algorithms  will  be  to  use  these  
complexities  and  see  if  the  nuances  of  wine  pairing  can  
be   simplified       more   specifically    the   goal   of   the   nave  
bayes  and  k means  algorithms  will  be  to  predict  either  
the   color   of   the   wine    red   vs    white    or   a   specific   type   of  
wine   chianti   pinot  grigio   etc    to  pair  with  a  dinner   
  

the   third   dataset   was   far   more   difficult   to   find  
and   the   data   was   only   obtained   after   numerous   emails  
to   the   company   associated   with   the   site       the   final  
dataset  is  a  pairing  of  a  specific  wine  to  a  specific  dinner  
in  which  the  ingredients  of  the  dinner  come  as  a  list  of  
foods       this   dataset   is   ultimately   used   as   my   testing  
dataset   with   which   i   test   whether   my   algorithms  
produced   the   correct   color   or   type   of   wine       an   example  
of  this  dataset  is  given  below   
  

    dataset  
the   total   number   of   datasets   used   in   the  
algorithms   is   three    however   note   that   certain  
algorithms   do   not   use   all   three   datasets   in   order   to  
predict  a  wine     the  first  dataset  contains  self reviewed  
wine  and  food  pairings  in  which  a  specific  type  of  food  
is   compared   to   multiple   types   of   wine       each   pairing   is  
associated   with   a   rating    ranging   from               that  
determines  the  quality  of  the  pairing     a  depiction  of  this  
dataset  is  given  below   
  

  
finally    for   better   clarity   of   the   results   presented   later   
listed   below   are   some   general   dataset   statistics   that  
help  to  put  the  results  in  a  better  context   
  
total  pairings           
unique  foods          
unique  wines          
dinners          
  

    features     preprocessing  
  

     raw  input  data  
  

  

the   second   dataset   maps   wines   to   a   flavor  
profile       each   flavor   profile   contains   ten   elements   which  
ranged   from   a   scale   of              in   which       represents   no  
presence   of   the   taste   in   the   wine   and       represents   a  
strong  presence  of  the  taste  in  the  wine     an  example  of  
this  is  provided  below   
  

for   the   first   dataset    there   are   a   total   of   three  
original   features   associated   with   the   raw input   data    a  
specific  type  of  wine   whether  the  wine  is  red  or  white   
and  a  user  rating     all  of  these  features  are  mapped  to  a  
given   food       the   original   features   associated   with   the  
raw input   data   for   the   second   dataset   are   simply   the  
listed        flavors   and   their   numeric   value       the   specific  
flavors  are  body   red  fruit   black  fruit   floral   herbaceous   
pepper    earth    baking   spice    leather    and   astringency     
the   third   datasets   features   are   a   list   of   foods   that  
composed   a   dinner   and   this   list   was   mapped   to   a  
particular  wine   
  

     derived  features   
  

the   derived   data   comes   from   a   combination   of  
all  three  datasets     the  first  step  involves  calculating  an  
average   wine   flavor   profile   for   each   food   found   within  

fithe   first   dataset       the   averaged   wine   flavor   profile  
results   from   taking   the   flavor   profiles   for   each   wine   
multiplying   them   by   their   rating    adding   all   of   these  
flavor  profiles  together   and  dividing  by  the  sum  of  the  
ratings   found   for   each   pairing   of   the   given   food   to   its  
wine     this  process  ensures  that  the  flavor  profile  is  an  
average  of  all  the  flavor  profiles  of  the  wines  associated  
with   the   food   and   also   ensures   that   wines   that   have   a  
higher   ratings   received   more   input   in   determining   the  
flavor  profile  for  the  food   
a   similar   process   is   used   for   determining   the  
average   flavor   profile   for   a   given   dinner       that   is    the  
average   flavor   profile   for   a   dinner   is   determined   by  
averaging   together   the   wine   flavor   profiles   of   the  
ingredients  found  within  the  dinner   
after  completing  both  of  these  transformations   
a   database   exists   that   contains   the   averaged   flavor  
profiles   for   each   individual   food   and   also   each  
individual   wine       an   illustration   of   this   transformation  
can   be   pictured   below    so   as   to   better   explain   how   the  
process  worked   

  
  

 

      

    
              

  
    

 
  

  
    

  

 

          

 

  

 
    

   
  
       
 

arg max            arg max  
 

      
   

  
that  is   the  best  prediction   whether  it  be  a  the  color  of  
the   wine   or   a   specific   wine     will   be   the   label   that  
produces   the   highest   product   when   considering   the  
probability  that  we  have  a  specific  ingredient  given  our  
label       below   are   the   summaries   of   the   two   types   of  
predictions  that  were  made  using  nave  bayes   
  

       red  vs   white  prediction   
for   the   red   and   white   prediction    i   use   a  
combination   of   score   consideration   and   laplace  
smoothing       if   i   do   not   consider   the   ranking    no   score  
consideration    then  i  simply  calculate  the  probability  of  
a  food  given  a  specific  color  based  on  the  occurrence  of  
the   food   and   wine   color   together             if   i   consider   the  
score    then   i   use   the   ranking   in   determining   the  
probability   that   a   given   food   occurred   given   the   color   of  
the   wine       that   is    wine   pairings   with   higher   rankings  
increase   this   probability    thereby   giving   preference   to  
wines   that   are   paired   well   with   a   food       laplace  
smoothing   works   normally   when   there   is   no   score  
consideration       however    when   there   is   score  
consideration   the  smoothing  parameter  is  given  as  the  
average   of   all   the   ratings   of   food   and   wine       the  
accuracy   of   these   four   types   of   nave   bayes  
classification  can  be  seen  below   

     
 

 


 

    
 

  

    models     results  
the  two  types  of  models  used  are  a  nave  bayes  
algorithm   and   a   k means   algorithm       the   goal   of   both  
algorithms   is   to   either   predict   a   specific   wine   or   to  
predict   whether   one   should   drink   a   red   or   white   wine     
the   input   is   the   list   of   ingredients   found   within   the  
third  database   which  uses  the  raw input  variables  and  
the  derived  variables  to  predict  a  specific  type  of  wine     
the   accuracy   of   prediction   is   given   by   whether   the  
predicted  wine  was  the  color  or  the  type  of  wine  given  
by  the  third  database  of  wines  paired  to  dinners         the  
specifics  of  the  algorithms  are  listed  below   
  

     nave  bayes   
the   nave   bayes   algorithm   uses   the   generalized  
nave   bayes   formula   with   multiples   variables    given  
below   
  

  

  
red  vs   white  
  
red   pred   
accuracy  
no  laplace          
no  score  
laplace  
       
no  score  
no  laplace          
score  
laplace  
       

white   pred    both   pred   
accuracy  
accuracy  
       
       
  
       
       
       

       

       

       

fidetailed   above   and   then   the   prediction   for   the   color   of  
the   wine   is   given   based   on   the   color   of   the   predicted  
wine       ultimately    my   k means   algorithm   would   not  
converge   in   a   measurable   and   feasible   time   range   and  
despite   numerous   attempts   to   resolve   this   issue    it   still  
remains       i   tried   a   multitude   of   things    including  
decreasing   the   side   of   the   variables   associated   with  
calculating   the   euclidean   distance   between   the   points  
and   the   centroids       instead    i   decided   to   change   the  
number   of   iterations   the   results   of   this   are   shown  
below   
  

score  
  

       specific  wine  prediction   
when  calculating  the  probabilities  for  finding  a  
specific   wine    the   algorithm   uses   the   model   with   the  
maximum  total  accuracy  from  the  red white  prediction  
problem       in   this   case    the   probabilities   involve   no   score  
consideration  but  do  involve  laplace  smoothing   
in   order   to   best   interpret   the   accuracy   of   the  
algorithm    i   decided   to   not   only   keep   track   of   the   top  
wine   predicted   by   the   algorithm   by   varying   top   wine  
predictions       then    the   accuracy   of   the   algorithm   is  
determined  by  whether  the  actual  wine  paired  with  the  
dinner   is   found   within   the   top   n   wines   that   were   kept  
track  of     the  results  of  this  are  demonstrated  below   
  

  

  
  
red  vs   white  from  specific  wine  
  
red   pred    white   pred   
accuracy  
accuracy  
iters        
       
      
iters        
       
       
iters                 
       
iters                 
       
iters                 
       

  

  
specific  wine   with  top  n  wines   
n        
      
n        
       
n        
       
n         
       
n         
       
n         
       
  
  

     k means  
the  k means  algorithm  functions  as  a  normal  k 
means   algorithm   with   the   variables   used   to   determine  
distance   being   the   values   associated   with   the   flavor  
profile   from     to      the  points  of  the  algorithm  are  the  
flavor   profiles   of   the   dinners   and   the   centroids   are   the  
flavor   profiles   of   the   wine    given   by   the   original   data  
from   the   second   database       as   each   point   converges  
closer   to   a   centroid    the   algorithm   predicts   the   wine  
represented  by  the  centroid  for  the  dinner  represented  
by   the   point       these   same   ideas   are   used   to   calculate  
both   the   color   of   the   wine   as   well   as   a   specific   type   of  
wine     the  specifics  and  results  of  each  of  these  is  given  
below   
  

       red  vs   white  wine  prediction  

this   algorithm   can   be   approached   in   two  
separate   ways       the   first   follows   the   exact   procedure  

both   pred   
accuracy  
       
       
       
       
       

  
the   second   approach   involves   computing   an  
average   flavor   profile   for   a   red   wine   and   for   a   white  
wine   by   averaging   together   all   the   red   wine   flavor  
profiles   and   all   the   white   wine   flavor   profiles       from  
here   there  are  a  total  of  two  centroids  representing  all  
of  the  white  wines  and  all  the  red  wines     therefore   as  a  
dinner   converges   on   a   centroid    the   algorithm   would  
associate   it   with   the   color   that   centroid   represented     
the  results  of  both  of  these  algorithms  are  given  below   
  
red  vs   white  prediction  accuracy  
with  averaged  red white  flavor  profiles  
red   pred    white   pred    both   pred   
accuracy  
accuracy  
accuracy  
  
  
  
       
       
       
  
  

       specific  wine  prediction   

for  finding  a  specific  wine   i  use  the  number  of  
iterations   that   produced   the   highest   accuracy   when  
predicting   the   color   of   the   wine       this   occurrs   when  

fithere  was  only  one  iteration     much  like  the  nave  bayes  
equivalent   to   solve   this   algorithm    the   algorithm   keeps  
track   of   the   top   n   predicted   wines   rather   than   simply  
the   top   predicted   wine   so   as   to   better   show   the  
accuracy  of  the  algorithm     in  order  to  calculate  the  top  
n   wines   given   that   the   wine   is   grouped   to   a   specific  
centroid   and    therefore    only   one   specific   wine    the  
algorithm   calculates   the   euclidian   distance   from   the  
point  to  all  other  centroids  and  kept  track  of  the  top  n  
centroids  that  have  the  smallest  distance     the  results  of  
this  algorithm  can  be  seen  below   
  

specific  wine   with  top  n  wines   
n        
      
n        
       
n        
       
n         
       
n         
       
n         
       
  
  

    discussion  
  

     nave  bayes  
overall    the   nave   bayes   algorithm   functioned  
quite   well   in   predicting   both   the   color   of   the   wine   and   a  
specific   type   of   wine       in   terms   of   score   consideration  
and   laplace    it   was   evident   that   the   algorithm  
performed   best   when   laplace   smoothing   was   applied  
and  had  a  negligible  difference  with  score  consideration  
as  opposed  to  no  score  consideration   
the   increasing   in   the   accuracy   with   laplace  
smoothing  makes  sense     going  through  the  database   i  
noticed  a  few  foods  that  occurred  with  white  wines  with  
low   ranks   and   then   only   a   few   red   wines   with   high  
ranks       ultimately    the   lagrange   smoothing   more   evenly  
distributes   the   probability   given   a   red   or   white   wine  
and   thereby   increases   the   overall   accuracy   of   the  
equation       this   is   further   demonstrated   by   an   increase  
in   the   accuracy   of   red   wine   prediction   with   a   decrease  
in  the  accuracy  of  white  wine  prediction   
in   terms   of   predicting   a   specific   wine    the  
results   far   exceed   what   would   be   expected       with   a   total  

of         wines    the   accuracy   of   randomly   selecting   a  
single   correct   wine   from   this   set   would   be           but  
the  algorithm  is  able  to  predict  the  top  wine  with        
accuracy    more   than        fold   better   than   guessing       as  
well    the   algorithm   sad   the   correct   wine   in   the   top       
guesses         of   the   time    demonstrating   that   the  
algorithm   is   able   to   recognize   the   correct   wine   as   a  
strong   contender    if   even   it   doesnt   select   the   wine   as  
the  number  one  choice   
  

     k means  

  

overall   the  k means  model  has  a  high  accuracy  
rate  but   based  on  consistency   functions  worse  than  the  
nave bayes   model    as   demonstrated   by   the   k means  
attempt   to   predict   the   color   of   wine   to   pair   with   the  
dinner       in   addition   to   its   inability   to   converge    the   k 
means  model  also  varies  drastically  on  the  accuracy  for  
red   wines   and   the   accuracy   for   white   wines       that   is   
with   fewer   iterations    the   accuracy   for   white   wine  
prediction  is  much  higher   reaching  a  peak  of         in  
fact   with  a  single  iteration     however   as  the  number  of  
iterations   increased    the   accuracy   of   white   wine   drops  
to   a   low   of           with        iterations       this   effect   is  
reversed  for  the  accuracy  of  a  red  wine  prediction   
one   theory   i   have   behind   this   phenomenon   is  
that   quite   a   few   of   the   dinners   that   are   extremely  
strongly  associated  with  a  white  wine     that  is   there  are  
a   few   white wine paired   dinners   that   have   only   highly  
white   wine   weighted   ingredients   such   as   any   type   of  
fish    clam    mussels    lemon    lime    any   number   of  
vegetables    and   olive   oil       essentially    any   type   of  
seafood   dish       however    there   are   a   variety   of   white 
wine paired   dishes   and   nearly   all   red wine paired  
dishes   that   contain   both   ingredients   strongly   associated  
with   red   wine   and   ingredients   associated   with   white  
wines       therefore    at   the   beginning    the   white   wine  
prediction  is  high     however   as  the  number  of  iterations  
increases    the   white   wine   centroids   become   more  
similar   to   the   extreme   white wine paired   dishes       as  
this  occurs   more  dishes  will  be  paired  with  a  red  wine  
because   only   the   few   cases   of   extreme   white wine  
paired   dishes   will   be   clustered   with   a   white   wine  
centroid   thereby  decreasing  the  accuracy  of  predicting  
a  white  wine  and  increasing  the  accuracy  of  predicting  a  
red  wine   
for   predicting   a   specific   type   of   wine    the   k 
mean   models   accuracy   is   extremely   close   to   the  
accuracy   achieved   in   the   nave   bayes   model       that   is   
with   only   selecting   the   one   predicted   wine    the   model  
accurately   predicts   the   correct   wine          of   the   time     
and   with   selecting   the   top        predicted   wines    the  
model   accurately   predicted   the   correct   wine   in   these  
predictions         of  the  time   
  
  

    conclusion  

fi  
based   on   the   results   of   the   two   algorithms    the  
nave  bayes  is  more  consistent  at  predicting  the  color  of  
the  wine     in  terms  of  predicting  a  specific  type  of  wine   
both   algorithms   perform   well   with   negligible   accuracy  
difference  between  the  two   
  
in  terms  of  the  broad  conclusion  draw  from  the  
results    it   seems   that   there   exists   a   strong   set   of   rules  
that   dominate   how   wine   and   food   pair   together       our  
original   features   and   derived   features   originate   from  
the   first   two   databases   whereas   our   method   for  
checking   accuracy   came   from   an   entirely   different  
database       with   the   accuracy   demonstrated   by   training  
and   testing   on   completely   separate   databases    it   seems  
that   all   three   databases   have   an   underlying   theme   of  
wine  and  food  pairing  that  tied  them  together     that  is   
if   any   of   the   databases   did   not   accurately   reflect   the  
wine food   pairing   rules   demonstrated   in   the   others    we  
would   likely   not   see   this   high   level   of   prediction  
accuracy       therefore    using   my   models    it   seems   that  
there   is   a   strict   set   of   rules   that   apply   to   wine food  
pairing   
  
finally    in   terms   of   progressing   from   wine   to  
food   pairing   into   wine   to   dinner   pairing    it   seems   that  
many   of   the   same   rules   are   still   applicable       that   is   
using   the   rules   and   nuances   of   wine food   pairing    one  
can   predict   with   a   high   level   of   accuracy   a   wine   that  
pairs   with   a   grouping   of   food   as   well       therefore    it  
seems   that   the   rules   for   wine   pairing   rules   are   specific  
enough  to  be  represented  accurately  across  a  variety  of  
databases   and   with   a   variety   of   models    but   are   also  
generalized   enough   to   accommodate   for   having  
multiple  foods   
  

    future  
i   think   the   one   thing   that   would   drastically  
increase   the   accuracy   of   the   algorithm   would   be  
considering   the   importance   that   each   food   plays   in   the  
meal       that   is    meat   is   usually   paired   with   a   red   wine  
whereas   most   vegetables   are   usually   paired   with   a  
white  wine     however   in  a  case  where  we  have  a  meat  
as  the  main  component  of  the  dish  and  the  vegetable  as  
the  side  component   it  would  seem  that  the  meat  should  
play   a   larger   role   in   determining   both   what   color   wine  
to   have   and   what   specific   type   of   wine   to   have     
although   difficult    this   could   be   done   by   obtaining   the  
estimated  or  averaged  weight  of  each  ingredient  in  the  
meal  and  using  this  as  a  weight  to  weight  the  influence  
of  each  ingredient  on  predicting  a  wine     i  would  also  do  
more   analysis   of   the   k means   algorithm   in   an   attempt  
to   better   understand   why   it   predicts   white   wines   with  
such   high   accuracy   when   it   has   so   few   iterations   but  
with  such  low  accuracy  when  it  has  a  larger  number  of  
iterations       finally    i   think   have   more   databases   to   use  
would   be   extremely   helping    especially   in   bolstering   the  
idea   that   strict   wine   pairing   rules   exist   across   a  
multitude   of   databases       although   this   appeared   to   be  

the   case   for   the   three   databases   used   in   the   models   
having  more  databases  to  test  this  would  be  ideal   
  
id   love   to   continue   working   on   this   project   in  
hopes  of  making  it  a  practical  application  that  a  variety  
of  people  could  use  to  help  pair  a  wine  with  their  meal     
in   fact    while   at   the   poster   presentation    i   was  
confronted  by  a  man  working  on  an  iphone  application  
that   paired   a   wine   with   a   list   of   ingredients   and   then  
went   a   step   further   and   showed   a   specific   vintage   and  
also  the  best  place  to  buy  the  wine  in  order  to  obtain  the  
cheapest   price          hopefully   i   am   able   to   continue  
working   on   my   models   and   help   contribute   to   this  
application   
  
references  
what  to  pair   online    available   
http   www whattopair com  
  
m   puckette           sept         flavor  profiles  of  wines  
 infographic    online   available   
http   winefolly com review red wine flavor profiles   
  
match  my  wine   online    available   
http   www matchmywine com   

  

fi