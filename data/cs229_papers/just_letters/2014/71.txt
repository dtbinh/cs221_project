gene expression analysis of hcmv latent infection
brian hie and seokho hong
brianhie stanford edu and seokho stanford edu

introduction
human cytomegalovirus  hcmv  infects a large percentage of humans worldwide      in most
individuals  hcmv establishes a largely asymptomatic latent infection  it can  however  lead to
serious disease in immunocompromised individuals  and hcmv infection of the fetus is a
common cause of congenital defects  because it produces relatively few symptoms  hcmv
latency was largely thought to be quiescent  only recently did evidence emerge supporting a
highly active latent infection     
to further investigate hcmv latency  our study takes advantage of relatively recent
improvements in high throughput rna sequencing technology  which has enabled a
quantitative and reasonably confident measure of gene expression across large populations of
individuals  combining rna seq data with environmental variables such as hcmv status can
be used to explore the relationship between environment and gene expression  using this gene
expression data  our study applies machine learning methods that attempt to predict hcmv
infection and to better understand patterns of gene expression during hcmv latency 

data
our analysis was performed on a data set of     tissue samples from     individuals obtained
through the genotype tissue expression  gtex  project      each sample has gene expression
data in the form of rna seq reads  which were mapped to genes using common gene
annotations  ucsc  ensembl  refseq  for a total of        genes and transcripts  raw read
counts were normalized according to rpkm  reads per kilobase of gene per million total
reads   we have metadata on each individuals sex  age  race  bmi  hypertension status  and
sample tissue type 
we also have information on hcmv status as determined by an elisa antibody assay for each
sample  also from the gtex project         individuals were hcmv  and         tissue
samples were hcmv   giving us a relatively balanced data set 

baseline
for a simple baseline  we predicted hcmv status using rpkm with a feature vector consisting
of all        genes and a variety of different classifiers  the results are given in table    all f 
scores in this study were computed using    fold cross validation  cv  

fitable    baseline classification
classifier

f      fold cv 

logistic regression

     

linear svm

     

random forest

     

feature selection
we next performed filter feature selection based on significant association between gene
expression and hcmv status  to do so  we correlated rpkm and hcmv status and computed
a permutation based p value on this correlation  we then played with different p value cutoff
parameters to vary the number of gene features we wanted to keep  a cutoff of p        gave
us a list of     genes  p         gave us      genes  and p         gave us      genes  table
  summarizes the results from classifying on the feature vectors of filtered genes 
table    classification after filter feature selection 
number of genes

classifier

f      fold cv 

   

linear svm

     

   

nonlinear svm  poly  kernel 

     

    

linear svm

     

    

linear svm

     

we reasoned that the full set of        genes caused the svm to overfit  resulting in high
training set error but low test error  reducing the number of gene features using the above
association heuristic allowed the classifier to perform much better 
the non linear svm result on the     genes also shows that there is information to be captured
by non linear interactions between genes  as the number of features grows  however  using
non linear kernels  even a second order polynomial  causes overfitting on the training set and
resulted in poor results for      and      genes 

noise reduction
to improve the performance of our classifier  we next tried to reduce noise in the gene
expression data by regressing out effects from known factors assumed to be independent of
hcmv  known factors in this case were age  sex  race  gender  hypertension status  tissue
type  and individual  removing these known covariates would ideally then increase our power to
detect hcmv related signal from the gene expression data 

fiwe used two techniques to regress out known covariates  we first tried an ordinary least
squares  ols  linear model  for each gene  we would fit the ols model over known covariates
using rpkm for that gene as the target vector  the second technique we tried was peer
 probabilistic estimation of expression residuals           which uses a more sophisticated
bayesian linear regression to model the relationship between known factors and gene
expression  a gamma prior is placed on the weights of each factor  which attempts to drive
unused factors weights to    parameter estimation for peer is implemented based on the
expectation maximization algorithm  for both models  residuals were computed as the
difference between observed and expected expression  which would ideally contain stronger
hcmv related signal  both of these methods assume the covariates have a linear effect on
gene expression 
there was a substantial improvement in the f  scores of the random forest  rf  classifier
when trained on residuals from both methods of noise reduction  on rpkm alone  the rf
classifier had an f  of       table     after either ols or peer  the rf classifier had f  scores
greater than      table     when trained on residuals  other classification algorithms performed
slightly better than baseline  but less well than rf 
table    classification after noise reduction
noise reduction method

classifier

f      fold cv 

ordinary least squares

random forest

     

peer

random forest

     

peer

linear svm

     

peer

nonlinear svm  poly  kernel 

     

peer

logistic regression

     

discussion
the raw rpkm data used for the baseline contained some information  but not enough for most
classifiers to make use of it  careful feature selection and tuning did increase f  score  but the
model was still very weak 
noise reduction through regressing out known covariates slightly improves the linear svm
model that was the most successful from training on raw data  it is clear based on the results of
random forests that nonlinearities are necessary for modeling with gene expression data 
fitting svms with nonlinear kernels proved difficult on both the raw and processed data  mostly
because they tended to overfit on the high dimensional data  using a non linear kernel greatly
increases the dimensionality of the features  and it becomes very difficult to train a good model
without overfitting 

firandom forest does much better because it does not have to expand the dimensionality of the
feature space to capture the nonlinearities of the data  furthermore  random forests can capture
what might only be otherwise possible with a higher order kernel  while svms with a kernel
more complex than a second degree polynomial overfit and simply do not perform well on this
data 
another reason why random forest outperforms nonlinear svms is that gene frequency data is
best modeled by the decision boundaries that characterize decision trees  genes have fairly
clear  but complex relationships with a limited set of other genes  this is not modeled well by an
svm that takes all the features into consideration at the same time  decision trees are much
better at capturing local complexities given the high dimensional data 

future directions
the natural extension of this project would be to gain insight into which genes best indicate
hcmv status  we attempted to do this with the rf classifier using feature importances  but the
most important genes for the rf classifier were not significantly enriched for viral functions 
using feature importances of the decision tree model weakly identified some viral genes  but not
to a satisfactory extent  although linear models would arguably offer greater interpretability 
none of them could classify the dataset accurately enough 
the best solution would be to develop a procedure for increasing the interpretability of random
forests  possible methods might include backward feature selection that narrows the gene
feature set to include the most predictive genes 

references
    j  h  sinclair et al   human cytomegalovirus manipulation of latently infected cells 
viruses  vol    no      pp            nov       
    j  lonsdale et al   the genotype tissue expression  gtex  project  nature genetics  vol 
    pp           may      
    o  stegle et al   a bayesian framework to account for complex non genetic factors in
gene expression levels greatly increases power in eqtl studies  plos comp  bio   vol 
   no     pp        may      
    l  parts et al   joint genetic analysis of gene expression data with inferred cellular
phenotypes  plos genetics  vol     no     pp        jan       
    f  pedregosa et al   scikit learn  machine learning in python  jmlr  vol      pp                 

fi