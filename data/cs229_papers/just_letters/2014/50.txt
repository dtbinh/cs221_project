predicting djia movements from the fluctuations of a subset of stocks 
veronique moore
cs    course project report   december         
   introduction
it is the belief that the dow jones industrial average  djia  is the pulse of the u  s  economy  that
is  djia leads the movements of the stock market  true  or false  regardless  the price behavior of
djia is closely monitored daily by numerous investors around the world  so  what truly influences
djias movements up or down  one might ask 
by definition  invented in      djia is a price weighted average of    significant stocks  from   
large publicly owned companies based in the u s   traded on the new york stock exchange and
the nasdaq  consequently  djia is a strong authority in its own right and many factors contribute
to its stability  the majority of the underlying factors contributing to djia movements have been
commonly attributed to key economic indicators such as gdp  m   cpi ppi  to name a few  as well
as other factors including the asian and european market performances 
this paper attempts to explain djia movements from a non traditional approach  exploiting some
techniques and algorithms of machine learning  we wish to answer the following two questions
 later referred to as our two questions of interest   based on the fluctuations of a subset of
possibly influential stock indices used as training data for a chosen model  can we accurately
predict djia movements 
in addition  if we partition such selected subset of stock indices into   clusters  is one cluster more
representative than the remaining data  and therefore a better predictor of djia movements 
   data collection  cleaning and preprocessing
source of data  www finance yahoo com
we screen stock indices  which had an average trading volume of above   million between january
        and december           covering      trading days 
for each such index  and for  dji  the djia index   we extract      daily historical prices  we
then clean the data obtained  discarding all records that are found to be incomplete  we find that a
total of    indices qualify to work with  serving as the    features of our model  we refer to them as
the full set  see appendix for the specific indices  
we preprocess the cleaned data by converting  for each index  the difference between the current
day and previous day prices into daily fluctuations of   for a fluctuation down  negative difference 
or   for a fluctuation up  positive difference  
   experimental design
we attempt to answer our two questions of interest in four scenarios  using the full set and using  
subsets of the full set  with the k means algorithm where k    we partition the full set into
cluster   with    features  cluster   with    features and cluster   with    features  see appendix
for the specific indices  
  

   

fiin scenarios         and   we use features from the full set  cluster    cluster   and cluster  
respectively  as the input to our model 
for each scenario  out of the      trading days  we reserve the first     days to train  and the
remaining     days to test our machine learning model  making the ratio of training set to test set
roughly     
   models
our problem is a classification one  where the daily prediction is either     dji will move
 fluctuate  up  or      dji will move  fluctuate  down  we consider five such models  the linear
regression  the support vector machine  svm   the support vector machine with rbf kernel  the
nave bayes and the nave bayes with ksdensity kernel classification models 
using these models  not only do we wish to answer our two questions of interest  but also we want
to compare the models performances on our data by way of two related measures  the accuracy and
the f  score  see appendix for formulas  
   dimensionality reduction and data visualization
on each of the four sets of data  we perform the principal component analysis algorithm to
compress and reduce the dimension of the features from    to    and from    to    we are then able
to visualize our data on a   d  and   d plots for the full set  cluster    cluster   and cluster   
   cluster results and analysis
full set   d plot  pca reduced from    d 

cluster    d plot  pca reduced from    d 

 

 

 

 

 

 

 

 

 

 

 

 

  

  

  

  

  

  

  

  

  
   

  
  

  

  

  

 

   

  

  

  

 

cluster    d plot  pca reduced from    d 

cluster    d plot  pca reduced from    d 
 

 

 

 

 

 

 

 

 

 

 

 

  

  

  

  

  

  

  

  
  

  
   

  

  

  

  

  

 

   

  

  

  

  

 

the   d plots reveal that there is a strong association between the first and second principal
components of cluster    the data is indeed very tight together compared to the results obtained on
the full set  cluster   and cluster    we conclude that the data in cluster   is fairly homogeneous 
  

   

ficluster    d plot  pca reduced from    d 

full size   d plot  pca reduced from    d 
 

 
 

 

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

   

   

 

   

   

   

   

 

    

   

cluster    d plot  pca reduced from    d 

   

   

   

    

cluster    d plot  pca reduced from    d 

 

 

 

 

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

   

   
 

   

   

   

   

    

 

   

   

   

   

    

the   d plots show no linearity in the first principal components  a result that is expected given the
binary nature of the data  however data in cluster   is confirmed to be more tight and less scattered
than that of the full set  cluster   and cluster    making it more homogeneous as previously found 
   model results and analysis

model

accuracy

f  score

full set
    indices 
cluster  
    indices 
cluster  
    indices 
cluster  
    indices 
full set
    indices 
cluster  
    indices 
cluster  
    indices 
cluster  
    indices 

linear
regression
      

svm

svm rbf

nave bayes

      

      

      

nave bayes
ksdensity
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

nan

      

these results show that set wise  cluster   and the full set tend to provide comparable  better and
consistent results with the highest accuracy and highest f  score  across all five classification
  

   

fimodels  actually  the linear regression model applied to cluster   performs better than on the full
set  in general  cluster   only performs slightly better than cluster    but can easily be removed
entirely from our learning data  without negative impact to our prediction results 
cluster   does the worst at predicting values  can be considered noise and be eliminated entirely
from the entire set  in an additional step of cleaning our data  indeed  cluster   has the lowest
overall accuracy of        and an f  score of nan  using the nave bayes model  the detailed
results show that out of     test values  the number of true positive  false positive  false negative 
and true negative predicted values is equal to          and      respectively 
model wise  the results show that the linear regression model is our model of choice  followed by
svm with comparable results  the svm rbf  nave bayes and nave bayes ksdensity have
comparable poor results and should not be given any preference  without further tweaking 
   conclusion
in this paper we wanted to know if  using machine learning techniques and algorithms  given the
fluctuations of a subset of possibly influential stock indices as training data  we could accurately
predict djia movements  and if a specific cluster of those indices was more relevant and a better
predictor of those movements than the rest of the data 
from the linear regression  the support vector machine  the support vector machine with rbf
kernel  the nave bayes  and the nave bayes with ksdensity kernel classification models used  our
results indicate that we are indeed able to make the best predictions of djia price movements with
       accuracy and an f  score of         working with the linear regression model and using
only cluster    however  while certainly remaining relatively satisfactory  this prediction accuracy
is not viewed by us as being very robust  in our opinion  it would be prudent to supplement our
predictions in a real time fashion with other  sometimes subjective  factors such as the current news
events in and outside the u s   or what is often referred to as the market belief or sentiment 
   future work
additional analysis
identify which indices best predicted the      stock market crash  during which djia plummeted
      points between september          and october          
improving the current predictions
further study of why cluster   did so poorly  perhaps come up with some additional rectifying
features such as those that account for index volatility  use them on cluster   to improve accuracy 
construct a dedicated kernel  which effectively captures the true geometric brownian motion
nature of the stock indices fluctuations in order to improve the current accuracy 
references
cs    course notes
www coursera org course ml
http   openclassroom stanford edu mainfolder coursepage php course machinelearning
www finance yahoo com
www wikipedia org
  

   

fiwww investopedia com

appendix
   full set indices 

aa  aal  aapl  abx  aig  amat  atvi  avp  bac  bbd  bbry  bsx  btu  c  chk  clf 
cmcsa  csco  csx  cx  dia  dow  ebay  eem  efa  emc  ewj  ewt  ewz  f  fcx  foxa 
fxi  gild  glw  hal  hban  hk  hpq  hst  intc  itub  iwm  iyr  jblu  jpm  key  ko  luv 
mdr  mdt  mgm  mrk  ms  msft  mu  ne  oih  onnn  orcl  pbr  pbr a  pfe  pg  qqq 
rfmd  rig  schw  sdrl  slb  sune  t  tlm  tlt  tsm  vwo  vz  wfc  wft  wmb  x  xlb 
xle  xlf  xli  xlk  xlp  xlu  xlv  xom  xrx  yhoo

   cluster   indices  aa  aal  aapl  abx  aig  amat  atvi  avp  bac  bbd  bbry  btu  chk  cx  dia  dow 
ebay  eem  efa  emc  ewt

   cluster   indices  c  clf  cmcsa  csco  ewz  f  fcx  foxa  fxi  glw  hal  hban  hk  hpq  hst  itub  iwm 
iyr  jblu  jpm  key  luv  mdr  mdt  mgm  mrk  ms  mu  ne  oih  onnn  orcl  pbr a 
pfe  pg  qqq  rfmd  rig  sdrl  slb  sune  t  tlm  tlt  vwo  vz  wfc  wft  wmb  x  xle 
xlf  xli  xlk  xlp  xlu  xom  xrx  yhoo

   cluster   indices  bsx  csx  ewj  gild  intc  ko  msft  pbr  schw  tsm  xlb  xlv
   model accuracy and f  score formulas 
let tp  fp  fn and tn be the number of true positive  false positive  false negative and true negative
model predicted values  then 
by definition  p   precision   tp    tp   fp  and r   recall   tp    tp   fn 
accuracy    tp   tn     tp   fp   fn   tn 
f  score        p   r    p   r 

  

   

fi