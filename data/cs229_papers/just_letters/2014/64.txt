a comparison of classification methods for expression
quantitative trait loci
joe r  davis    nilah m  ioannidis    kim kukurba    zach zappala    carlos d 
bustamante      stephen b  montgomery   
 

department of genetics 

 

biology  and   pathology  stanford university  stanford 
california  usa

introduction
the functional impact of regulatory variation in the human genome remains largely unexplored  one
group of regulatory variants called expression quantitative trait loci  eqtls  has become the focus of
recent large scale efforts to identify variants that effect gene regulation                eqtls refer to
non coding variants that influence the expression of a nearby gene such that individuals homozygous for
one allele of the gene will show decreased expression relative to individuals homozygous for the other
allele  in addition to influencing expression  eqtls are enriched for disease causing variants and variants
that influence molecular phenotypes such as chromatin modifications         thus  these variants are of
important biological interest for addressing disease etiology 
until recently  the study of eqtls has focused primarily on discovery using simple linear models
               only a handful of studies have sought to build more complex models for the purpose
of eqtl classification         these studies have been limited in the scope of models investigated  in
this project  we examine four main classification methods for eqtl detection     logistic regression    
decision trees and random forests     support vector machines  svm   and    neural networks  our goal is
to build a classification model to predict whether a variant influences gene expression using only publicly
available genomic annotation  this model will therefore be able to classify eqtls rapidly without the
need of gene expression data  greatly improving our ability to interpret functional variation in the noncoding genome  in addition  by examining which features annotations are most informative for eqtl
classification  we can make meaningful inferences regarding the underlying biology of eqtls 

data
the geuvadis consortium recently conducted one of the largest eqtl studies to date on     european
derived lymphoblastoid cell lines  lcls       their genotype and expression data is publicly available
 http   www ebi ac uk tools geuvadis das    we re ran their eqtl analysis to generate a list of
     high confidence eqtls with fdr         additionally  we chose as our control set      snps with
no significant association to gene expression 
features for each snp were obtained from the cadd resource  a publicly available database with over
   annotations for nearly every base in the human genome  http   cadd gs washington edu          
features were selected from the cadd database for model training and testing  features were selected
based on missingness rate         and biological relevance  as a pre processing step  we intersected our
list of eqtls and controls with the cadd features  we matched each variant in the cadd database
for the specific alternative allele in our eqtl control list  our final dataset consisted of       eqtls
and control snps with    features per observation 

features
the    selected features cover a range of genomic annotations  from estimates of selection and conservation
to measures of open chromatin and transcription factor binding     features are categorical with number
of factors ranging from   to     while the remaining features are continuous or integer valued  for a
significant number of our    predictors  the missingness rate is quite high     predictors with missingness
         the cadd resource gives guidelines for imputation of missing values for these variables  and
these guidelines were followed in construction of the final training and test sets  missingness for some
of the predictors can be informative  for example  if one of the predictors is measuring the amino acid
change caused by a variant  missing data would indicate that the variant is not within a protein coding

 

fi 

region  therefore  for    predictors with missing values  additional binary categorical predictors were
created as indicators of whether the original predictor was missing or not for a given variant 

models
our goal is to predict using the annotations for a given regulatory variant whether that variant is an
eqtl or not  formally  for regulatory variant i  i           m   we define the class label 

    if variant i is an eqtl
yi  
    otherwise
let xi be the feature vector for variant i  our performance metric will be classification error  we
compared four main types of classification models     logistic regression     svms     tree based models 
and    neural networks  these models were chosen for their ability to handle the disparate feature types 
additionally  our literature review revealed that tree based and svm based methods have performed well
for similar problems focused on coding variation         training was performed on     of the sample
 randomly chosen   while testing occurred on the remaining fraction       
logistic regression models  we first investigated a logistic regression model including the main
effects from    of the    features  the    binary features derived to account for missingness in other
predictors were not included in the model  no higher order interactions were investigated  this model 
termed the full model  is specified as follows 
p  yi     xi    

 
    exp      t xi  

where   is the intercept term and  is the vector of coefficient estimates  we then performed feature
selection on the full model using two methods     forward backward stepwise regression using aic
 akaike information criterion  and    l  regularized regression  lasso regression       the full model
and stepwise model were fit using the r functions glm and step  respectively  we used the r package
glmnet to fit the lasso model        the lasso penalty parameter  was chosen via    fold cross validation 
svms  we considered three different svm models defined by the choice of kernel function     linear 
   radial  and    sigmoid  these kernel functions are defined as follows 
klinear  xi   xj     xti xj
kradial  xi   xj     exp kxi  xj k    
ksigmoid  xi   xj     tanh xti xj  
 
by default  we set the coefficient    dim x 
  models were fit using the r package e         
tree based models  we considered two tree based models     a single classification tree and    a
random forest  for both models  the objective function minimized during model fitting was the training
classification error  the classification tree was fit using the r package rpart       the full tree was fit
and then pruned by minimization of the    fold cross validation error  the final  pruned tree contained
   splits with a complexity parameter of          the random forest was fit using the r package
randomforest      the forest was grown to     trees  there were noprestrictions on tree size  the number
of predictors sampled in each split was set to the default  namely dim x  
neural networks  single hidden layer neural networks were fit using the r package nnet       the
learning decay parameter was set to    default  and the maximum number of fitting iterations was set
to       in all     models were trained  with models having h              nodes in the hidden layer 
models were fit by minimization of the cross entropy or deviance 

argmin


m
x
i  

yi log f  xi          yi   log    f  xi     

fi 

where f  xi     are the predicted probabilities from the network for observation i and  is the vector of
network parameters  the model that minimized testing error  i e  the model with h     hidden nodes 
was chosen for comparison to the remaining three model types 

results
the table below gives the training and test error for all   models  in terms of training error  the neural
network with   hidden nodes performs the best  followed by the tree based models and svms with radial
and linear kernels  however  training error can be a misleading metric if over fitting occurs  on test error 
the tree based models perform the best followed by svms with radial and linear kernels  surprisingly  the
lasso model performs quite well  given that it does not attempt to model higher order interactions unlike
models from the other three types  the neural network performs extremely poorly compared to the other
models and given its performance on the training data  this results argues strongly for over fitting in
the neural network  in general  all models have a performance on the test set around         
model
full additive logistic
stepwise logistic
lasso logistic
svm linear
svm radial
svm sigmoid
decision tree
random forest
neural net

training       
      
      
      
      
      
      
      
      
      

test       
      
      
      
      
      
      
      
      
      

eqtl random forest

random  forest  variable  importance  
tg eur
bstatistic
mindisttss
encexp
ench k me 
mindisttse
ench k  ac
segway
encocfairepval
ench k me 
tfbspeaks
gerpn
tfbs
consscore
tfbspeaksmax
mamphylop
verphylop
encocfairesig
gerps
encocpoliipval
encoccombpval
rawscore
encocpoliisig
encocdnasepval
mamphcons
gc
cpg
encocc
cdnapos
verphcons
































  
  
  
  
meandecreaseaccuracy

tg eur
segway
mindisttss
bstatistic
mindisttse
ench k me 
encexp
ench k  ac
rawscore
ench k me 
priphylop
verphylop
mamphylop
gerps
gerpn
gc
encnucleo
priphcons
verphcons
mamphcons
cpg
consscore
encocfairepval
tfbspeaksmax
tfbspeaks
tfbs
encoccombpval
encocfairesig
mapability  bp
encocdnasesig
































 

   
   
meandecreasegini

 
figure    lasso regression coefficient estimates  left  and random forest variable importance  right 

we were also interested in determining features highly predictive of eqtl status  figure   shows

fi 

the parameter estimates for features selected by the lasso regression  left  and the variable importance
 mean decrease in accuracy  plots for the random forest  right   both models select very similar features as
highly predictive  these features are generally enriched for annotations regarding regulatory potential  ex 
tfbs or number transcription factor binding sites disrupted   distance to nearest gene  ex  mindisttss
or absolute value of the minimum distance to transcription start site   degree of conservation selection
 ex  gerpn  a measure of sequence conservation   and specific chromatin states  ex  segway  a chromatin
segmentation map  

discussion
tree based models achieved the best performance of all models considered  followed closely by svms with
radial and linear kernels  the neural network model performed rather poorly  showing strong evidence
of over fitting  surprisingly  the lasso logistic regression model performed quite well  this model is far
simpler than the tree based and svm models and is also more tractable and interpretable  for example 
from the random forest model we know the feature tg eur  average allele frequency in european
populations  is strongly predictive  but interpreting its exact influence on eqtl classification is difficult
given the higher order interactions implicit in the model  however  from the lasso model  we see that
increasing tg eur increases the probability of a variant being an eqtl  moreover  given that the lasso
model only accounts for main effects  its strong performance suggests that the influence of higher order
interactions is relatively small     parameters were estimated in the full logistic model compared to   
for the stepwise model and    for the lasso model  thus  many main effects also appear to be of little
predictive value 
the performance of our models was bounded below by     miclassification error on the test set  this
low performance is likely partly due to the resolution of our features  most of the features have a resoltion
of         base pairs  we are  instead  trying to predict class labels for single base pair variants  the high
degree of missingness in the feature set could also be limiting model performance  lastly  the problem
could be confounded by the underlying biology  the number of non coding variants in the human genome
is on the order of millions to tens of millions  yet the number of detected eqtls is on the order of tens
of thousands  they are relatively quite rare  and we simply may not have observed enough of them to
determine how they differ from the background non coding variation 
finally  using the coefficient estimates from the logistic regression models and the variable importance
measures from the tree based models  we were able to quantify the relative influence of each of the features
on eqtl state  from these measures  we can make some interesting biological conclusions  for example 
mindisttss was found to be highly informative in the random forest model  it was also found to have a
negative predictive effect  mindisttss       e     in the lasso model  indicating that variants nearer
the site of transcription are more likely to be eqtls  a result previously confirmed by other studies
         more broadly  we can infer that annotations associated with gene regulation  chromatin activity 
transcription factor binding  and conservation are highly predictive of eqtl state  while annotations
associated with protein function  ex  siftval  a measure of deleteriousness of a protein coding variant 
are not predictive  these results provide evidence that the biological mechanisms influencing eqtls 
and possibly other regulatory variants  are not shared by protein coding variation  the development of
predictive models specifically for non coding variations is  therefore  all the more pertinent 

conclusion and future directions
we have presented one of the first studies to apply a diverse range of machine learning algorithms to
the novel task of eqtl prediction  we compared four general algorithms  and found that performance
was optimized by tree based models followed closely by svms and lasso logistic regression  using these
models  we were also able to make meaningful inferences regarding the underlying biology of eqtls 
highlighting there distinction from protein coding variation 

fi 

unfortunately  our classification error for all models was relatively high  future work should focus on
error analysis to understand the source of this high error  additionally  other large resources of regulatory
annotations could be used to increase the feature set  hopefully including novel features that improve
prediction  we can also use other databases of eqtls to increase training and test set size             more
long term  we want to explore these models in the context of other regulatory variation  e g  variants
influencing transcript processing  chromatin modifications  and chromatin activity  we want to expand
our models to produce a resource for annotation of the entire non coding genome  and  thereby  improve
our ability to interpret personal genomic variation 

references
    ivan a adzhubei  steffen schmidt  leonid peshkin  vasily e ramensky  anna gerasimova  peer bork  alexey s
kondrashov  and shamil r sunyaev  a method and server for predicting damaging missense mutations  nature
methods             april      
    alexis battle  sara mostafavi  xiaowei zhu  james b potash  myrna m weissman  courtney mccormick  christian d
haudenschild  kenneth b beckman  jianxin shi  rui mei  alexander e urban  stephen b montgomery  douglas f
levinson  and daphne koller  characterizing the genetic basis of transcriptome diversity through rna sequencing of
    individuals  genome research              january      
    jerome friedman  trevor hastie  and rob tibshirani  regularization paths for generalized linear models via coordinate
descent  journal of statistical software              
    daniel j gaffney  jean baptiste veyrieras  jacob f degner  roger pique regi  athma a pai  gregory e crawford 
matthew stephens  yoav gilad  and jonathan k pritchard  dissecting the regulatory architecture of gene expression
qtls  genome biology        r   january      
    martin kircher  daniela m witten  preti jain  brian j oroak  gregory m cooper  and jay shendure  a general
framework for estimating the relative pathogenicity of human genetic variants  nature genetics              march
     
    tuuli lappalainen  michael sammeth  marc r friedlander  peter act hoen  jean monlong  manuel a rivas  mar
gonzalez porta  natalja kurbatova  thasso griebel  pedro g ferreira  et al  transcriptome and genome sequencing
uncovers functional variation in humans  nature       
    andy liaw and matthew wiener  classification and regression by randomforest  r news                  
    david meyer  evgenia dimitriadou  kurt hornik  andreas weingessel  and friedrich leisch  e      misc functions
of the department of statistics  e       tu wien        r package version       
    stephen b montgomery  micha sammeth  maria gutierrez arcelus  radoslaw p lach  catherine ingle  james nisbett 
roderic guigo  and emmanouil t dermitzakis  transcriptome genetics using second generation sequencing in a
caucasian population  nature                         
     joseph k pickrell  john c marioni  athma a pai  jacob f degner  barbara e engelhardt  everlyne nkadori  jeanbaptiste veyrieras  matthew stephens  yoav gilad  and jonathan k pritchard  understanding mechanisms underlying
human gene expression variation with rna sequencing  nature                    april      
     terry therneau  beth atkinson  and brian ripley  rpart  recursive partitioning and regression trees        r
package version       
     w  n  venables and b  d  ripley  modern applied statistics with s  springer  new york  fourth edition        isbn
              

fi