correlated  feature  selection  for  single cell  phenotyping  
geoff  stanley  
stanford  university   program  in  biophysics  

abstract  
single  cell  transcriptome  sequencing  promises  to  provide  a  complete   unbiased  picture  of  
the  cellular  phenotypes  comprising  mammalian  tissues   unprecedented  amounts  of  data    
expression  levels  of  o         genes   many  of  which  are  functionally  annotated    are  
recovered  per  cell  over  hundreds  of  cells   however   functionally  distinct  cell  types  may  be  
generated  by  very  small  differences  in  gene  expression   analysis  methods  must  be  
developed  that  are  sensitive  to  expression  level  differences  in  only  o        of  expressed  
genes   i  have  sequenced  the  transcriptomes  of       d   and      d   medium  spiny  neurons   i  
have  found  that  they  have  highly  similar  gene  expression  patterns   differing  by  only       
out  of         mutually  expressed  genes   standard  methods  of  dimensionality  reduction  
 pca   tsne   on  the  entire  feature  set  failed  to  differentiate  the  two   i  found  that  by  
correlating  genes  to  find  consistent  expression  signatures   and  reducing  the  feature  set  to  
only  those  signature correlated  genes   i  was  able  to  fully  recapitulate  the  functionally  
relevant  phenotypes  of  striatum   this  work  points  toward  an  important  
  

introduction  
in  collaboration  with  ozgun  gokce  in  the  sudhof  lab   we  have  used  single cell  
transcriptome  sequencing  to  fully  describe  the  cell  types  and  expression  signatures  of  all  of  
the  cell  types  of  the  mouse  striatum   a  region  of  the  brain  that  is  involved  in  responses  to  
reward  and  initiating  motor  action   we  focused  on  two  neuron  types   the  d   and  d   
medium  spiny  neurons   msns    these  neurons  are  very  similar   however   it  has  not  been  
clear  whether  the  d   and  d   classification  represents  the  full  extent  of  phenotypic  
diversity  in  medium  spiny  neurons   as  currently  methods  rely  on  a  small  number  of  genes  
selected  in  an  ad  hoc  manner  to  differentiate  them   
  

goals  




develop  sensitive  unbiased  learning  methods  to  distinguish  between  similar  cell  
types   
discover  the  complete  phenotypic  structure  of  medium  spiny  neurons   
generate  a  list  of  genes  that  classify  all  known  and  novel  msn  subtypes     

  

data  
we  isolated       medium  spiny  neurons  which  were  fluorescently  labeled  by  their  
expression  of  gfp  or  tdtomato  under  the  d   or  d   gene  promotor   respectively     the  
fluorescently labeled  neurons  were  captured  and  amplified  on  fluidigm  c   chip  and  poly 
a   mrna  sequenced  to  a  depth  of      million    bp  paired end  reads cell   the  features  of  

fithe  data  set  are  measured  expression  levels  of          genes     expression  is  measured  as  
log   tpm   where  tpm   transcripts  per  million  reads  per  cell   is  calculated  using  cufflinks  
transcriptome  assembler  on  bowtie tophat  aligned  data     
  

methods  
unbiased  analysis  of  single cell  gene  expression  data  requires  two  basic  components   
dimensionality  reduction visualization   and  classification   i  used  two  pipelines  that  have  
been  employed  in  previous  single cell  papers     
pca  
pca  for  dimension  reduction  and  visualization   and  k means  to  assign  phenotypes   
pca  was  implemented  with  the  r  package  factominer   cit    the  samples  were  plotted  on  
the  first  two  pc  dimensions   the  number  of  subtypes  k  was  inferred  by  looking  at  the  plot   
and  k means  used  to  assign  cells  to  groups     
  
tsne  
    kharchenko  correlation  as  a  cell to cell  distance  metric   t stochastic  neighbor  
embedding  for  dimensionality  reduction  and  visualization   the  kharchenko  distance  
metric  is  a  weighted  correlation  between  cells  over  their  gene  expression   where  the  
expression  level   in  tpm   of  a  gene  in  cells    k  and  l  is  weighted  by  the  posterior  probability  

wi  xik xk   xil xl  
var cellk  var celll  
  t p mik  wi

distk ij  
xik

p

i

wi   p  t p mik   t p mil    

   
   
   

p  t p mi   t p mj         g pois             gnb e 
   
that  its  value  is  actually  correlated  to  its  concentration  as  mrna  in  the  cell   the  weight  for  
given  expression  values  is  the  ratio  of  the  value  of  the  negative  binomial  to  the  poisson  at  
that  expression  level   the  resulting  cell cell  distances  are  mapped  to  a   d  space  by  
minimizing  the  kullback leibler  divergence  between  the  distances  in  high d  space  and  the  
distances  in   d  space     
correlated  feature  selection  
a  symmetric  matrix  was  created  of  the  correlations  of  gene  i  and  gene  j  for  all  i   j  that  were  
expressed  in  at  least  one  cell  and  had  a  nonzero  variance  across  all  cells   
  
corij   cor genei   genej
  
then  i  selected  genes  k  such  that  
maxi  corik     a
  
  
mini  corik     b
  

a  b         

fi  
i e    genes  that  had  a  maximum  positive  correlation  of  at  least  a  to  at  least  one  other  gene  i  
and  a  minimum  negative  correlation  of  at  least   b  to  at  least  one  other  gene   where  a  and  b  
were  determined  empirically   i  then  performed  ward  hierarchical  clustering  on  the  
resulting  matrix   
  
i  selected  genes  manually  based  on  multiple  genes  forming  a  correlation  cluster   red  
square  outline  in  figure   a     i e    multiple  genes  all  correlated  to  each  other   that  were  all  
anti correlated  to  another  correlation  cluster   green  square  outline  in  figure   a    i  then  
ran  both  the  pca  and  tsne  pipelines  on  this  reduced  set  of  genes  and  assessed  the  accuracy  
of  assignment  as  well  as  the  appearance  of  any  novel  subtypes  

results  
to  visualize  the  phenotypic  structure  of  the  neurons   i  compared  the  full  feature  set  pca  
and  tsne  with  pca tsne  on  the  reduced  feature  set  from  correlation  analysis   i  did  not  find  
any  novel  subtypes  with  any  of  the  methods   full feature  set  pipelines  were  unable  to  
distinguish  the  labelled  d  d   msn  subtypes  from  each  other   figure         
  
pca tsne  on  full  feature  set  
pca   fig   a b   seems  to  find  high variance  outliers   however  they  do  not  form  any  kind  of  
obvious  cluster  or  structure   tsne   fig   c   actually  appeared  separated  d   and  d   cells   
however   the  separation  was  not  detectable  with  k gaussians  in  the   d  embedded  space   it  
did  tend  to  separate  a  small          population  of  cells  which  it  clustered  together   i  could  
not  find  any  other  way  of  distinguishing  those  cells  from  the  rest   so  i  considered  the  
population  to  be  an  artifact  of  tsne   

figure      unbiased  analysis  of  full feature  set  data  from  msns   a    scree  plot  showing  
percent  of  variance   normalized  to        covered  by  each  principal  component   b    plot  of  
samples  on  first     principal  compenents   labeled  d    red   and  d    blue    c    tsne   d  
embedding  of  samples  based  on  kharchenko  distance   same  labels   small  cluster  on  right  
appears  to  be  spurious     
  

  

ficorrelated  feature  selection    
  
the  symmetric  heatmap  of  the  correlation  matrix  shows  only  two  clusters  that  are  clearly  
anticorrelated  to  each  other   figure   a    reducing  a  or  b  did  not  introduce  new  anti 
correlated  clusters   i  selected      genes  from  the  two  anticorrelated  clusters   most  of  which  
are  known  d  d   markers   drd a   tac    isl    pdyn   sfxn    drd    adora a   penk   gpr       
  
i  then  ran  the  pca tsne  pipelines  on  all  cells  with  expression  values  for  only  these      
genes   pca  clearly  separetes  them  into     populations   figure   c    it  is  difficult  to  determine  
k  for  the  tsne  plot   so  k means  would  be  ineffective  in  an  unlabeled  setting     

  

fifig      correlated  feature  selection   a    correlation  heatmap  of  genes   each  cell  represents  
the  spearman  correlation  between  two  genes  over  all  cells   red  is  highly  correlated   blue  is  
anticorrelated   b    scree  plot  of  pca   c    pca  biplot  on  first  two  dimensions   the  two  types  
are  well separated  by  the  method   d    tsne  performed  on  the      dimensions   embedded  in  
   dimensions   though  samples  are  spatially  separated   they  do  not  form  very  distinct  
clusters  that  would  be  detectable  with  unlabeled  data   e    cell gene  heatmap  of  expression  
of  the      genes   with  genes  and  cells  ordered  by  hierarchical  clustering  on  correlation  
distance   cells  are  rows   genes  are  columns   clearly  there  are  two  distinct  populations  that  
have  differential  expression   

  
accuracy  of  methods  
k  
  
tsne  
   
pca  
   
cfs tsne  
unknown  
cfs pca  
   
  
discussion  

 d   classified  correctly  
     
n a  
n a  
     

i  have  demonstrated  a  method  for  effective  feature  reduction  of  single cell  rnaseq  
datasets   it  works  because  genes  that  are  exclusively  expressed  in  one  cell  type  will  be  
correlated  to  each  other  and  anticorrelated  to  genes  that  are  exclusively  expressed  in  
another   the  other          noisy  genes  are  filtered  out   d   and  d   neurons  have  critical  
function  differences  in  the  brain   yet  standard  single cell  rnaseq  analysis  would  label  them  
as  undifferentiated   single cell  rnaseq  promises  to  fully  categorize  the  phenotypic  
diversity  of  multicellular  organisms   to  this  end  i  will  continue  to  develop  more  sensitive  
analysis  methods   
  

fi