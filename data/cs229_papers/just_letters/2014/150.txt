predicting seizure onset in epileptic patients
using intracranial eeg recordings
janet an
stanford university
janeta   stanford edu

amy bearman
stanford university
abearman stanford edu

abstractintracranial eeg based monitoring systems
have the potential ability to predict seizure onset  but preictal
 pre seizure  states are difficult to identify and are often
confused with normal variations in brain activity  our goal
was to distinguish between eeg recordings covering preictal
brain activity an hour prior to a seizure  and those recording
purely interictal  non seizure  activity  we modeled this as a
binary classification problem  computing several linear and
nonlinear bivariate features  maximal cross correlation and
euclidean distance  over pairs of eeg channels  we trained
support vector machines  logistic regression  and neighborsbased classification to discriminate interictal from preictal
patterns of features  among the evaluated methods  l regularized logistic regression was most successful  predicting
with       accuracy and an f  score of       
index termsseizure prediction  logistic regression  eeg 
machine learning 

i  i ntroduction
about    of the worlds population is afflicted with
epilepsy  although seizures occur infrequently      of a
patients life is spent in the interictal  non seizure state  
the possibility of a spontaneous seizure causes constant
anxiety for patients and inhibits their ability to lead normal
lives  sufficiently high doses of anticonvulsant medications
can be effective in        of patients  but because they
often come with significant side effects  these medications
should only be administered when necessary  i e   before
a seizure  therefore  some method of predicting seizure
onset is needed to alert epileptic patients to administer
medication and avoid risky activities  such as swimming
or driving 
intracranial electrocorticography  eeg  monitoring systems have the potential ability to predict seizure onset
by measuring electrical activity in the brain  as recorded
from multiple electrodes implanted directly on the surface
of the brain  however  even with this data  preictal  preseizure  states are difficult to identify and often confused
with normal variations in brain activity 
because epilepsy is such a prevalent neurological disorder  with unexpected seizures having such dangerous
consequences  attempts to develop seizure forecasting
systems have been recorded in a number of previous
papers  one aspect of the prediction process that all of
the researchers have had to handle is selecting relevant

catherine dong
stanford university
cdong stanford edu

features from the enormous datasets of eeg recordings 
different approaches to feature selection that have been
undertaken include choosing a small subset of the electrode channels using recursive feature elimination  as well
as spectral analysis using wavelet transform to compress
eeg recordings into a small number of features  after
running their algorithms  mostly using various types of
svms  the previous papers report varying degrees of
success  with accuracies ranging from just barely over
    to around      many of these papers report that
future work to be done to improve the accuracy of these
prediction algorithms include dimensionality reduction of
the data and better feature extraction to obtain potentially
hidden information 
our goal is to apply a variety of machine learning
classification methods to this eeg data in order to more
accurately model the probability that a patient is in a
preictal state 
ii  data
annotated intracranial eeg  ieeg  data is freely available at the international epilepsy electrophysiology portal 
there are ieeg data clips for both human and canine subjects  the data for each subject is organized into ten minute
clips labeled preictal for pre seizure data segments  or
interictal for non seizure data segments  preictal training
and testing data segments are provided covering one hour
prior to seizure with a five minute seizure horizon  i e 
     to      before seizure onset   interictal data is chosen
randomly from the full data record  with the restriction that
the interictal segments be as far away as possible from any
seizure to avoid contamination with preictal or postictal
signals  the pre seizure horizon ensures that seizures can
be predicted with enough time for the subject to take
appropriate action  such as administer medication  

fig     eeg data over   hour pre seizure window

fieach data clip contains a matrix of eeg sample values
arranged row  column as electrode channel  time  in
our subjects data set  there are    electrode channels and
        ieeg readings sampled at     hz  the recordings
span multiple months up to a year  and record    seizures
in our subject  up to     in other subjects   we used  
hours of interictal data and   hours of preictal data for
training  there are    data clips     preictal     interictal  
for        total examples in both the training and testing
data sets 

are computed on each channel separately  in past studies 
bivariate features have been more successful than univariate ones in seizure prediction tasks  though there is
little understanding of the preictal brain state  neuroscience
researchers hypothesize that there is correlation between
the synchronization of brain activity and seizure onset 
this synchronization hypothesis motivated our choice to
use bivariate features 

iii  p reprocessing

cross correlation is a measure of similarity of two
waveforms as a function of a time lag applied to one
of them  cross correlation  c  values between two pairs
 xi   xj   of eeg channels were computed at delays 
ranging from      to     seconds in order to account for
the propagation and processing time of brainwaves  we
retained the maximal value of cross correlation 
 
 
ca b    
   
ca b   max p

ci      cb    

a  maximal cross correlation

a  normalization
since the range of voltage readings in the eeg dataset
vary widely  we normalized the data to avoid heavily
weighting readings that are very positive or very negative 
for each segment  we calculated the minimum voltage
reading over all    channels  as well as the range of the
data for that segment  we normalized each eeg reading 
x  by computing 
x   

x   min x 
  max x   min x  

   

where

b  independent components analysis
ca b      

we attempted to use ica to separate the eeg data into
maximally independent components  in order to potentially
remove noisy artifacts such as eye movement  heartbeat 
or muscle activity on the scalp  we extracted the unmixing
matrix  w   in order to recover the sources  i e   the independent components  including the heartbeat waveform 
by computing s i    w x i    however  we did not recover
any obvious artifacts  and running our models on the
independent sources did not give us higher performance
metrics  so we decided to use the original data  it is
possible that ica was not successful because the eeg
sources were not temporally independent  or that there
were non negligible propagation delays from the sources
to the electrodes     





 
n 

np


xa  t     xb        

t  

cb a    

   

   

and n is the number of readings within the analysis
window  n       in our case   we also retained the nondelayed cross correlation between the two signals 
b  euclidean distance
euclidean distance measures the distance in state space
between the trajectories of two eeg channels  first  each
channel was time delay embedded into a trajectory with a
time delay      readings and an embedding dimension
d       as seen in     
x t     x t   d                x t      x t  

iv  f eature extraction from eeg
the challenge was to distinguish between ten minute
long data clips covering an hour prior to a seizure  and data
clips of the same length recording purely interictal  nonseizure  activity  predicting seizure onset can be modeled
as a binary classification problem  where data clips are
labeled as    negative for interictal and positive for
preictal   our goal was to construct a function that maps
from a feature vector x taken from a data segment to a
correct labeling of the segment 
as a baseline  we created a feature matrix where each
eeg channel reading was one feature  for more advanced
feature selection  we also computed bivariate features over
  second windows that measure a relationship between
two eeg channels  rather than univariate features which

   

then  we computed the distance of each time delay embedded vector to its k nearest neighbors in state space 
n
  x
n t  

 
k
 
k

k
p
k  
k
p
k  

kxa  t   xa  tak  k  
   
kxa  t   xa  tbk  k  

where 
 ta    ta            tak   are the time indices of the k nearest
neighbors of xa  t   and
 tb    tb            tbk   are the time indices of the k nearest
neighbors of xb  t  
 

fi   l  regularized  l  loss linear kernel svm  solves
the following primal problem 

c  pearson correlation
the pearson correlation coefficient measures the linear
relationship between two time series  x  y   giving a value
between    and     where   is total positive correlation   
is no correlation  and    is total negative correlation  the
formula for pearson correlation coefficient when applied
to a sample is 
n
  x  xi  x  yi  y 
   
r 
n    i  
sx
sy

min kwk    c
w

l
x
 max       yi wt xi    

    

i  

   rbf kernel support vector classification  solves
the following optimization problem 
l

x
 
min wt w   c
i
w b   
i  
subject to  yi  wt  xi     b      i

where
v
u
n
n
x
u   x
 
x  
xi   and sx   t
 xi  x  
n i  
n    i  

   

 

using the kernel  k xi   xj     exp   kxi  xj k  
  

are the sample mean and sample standard deviation  respectively  this expression gives the correlation coefficient
as the mean of the products of the standard scores 

   sigmoid kernel support vector classification  this
svm solves the same optimization problem as in rbf
kernel support vector classification  but with the kernel
function 
k xi   xj     tanh xti xj   r 
    

d  spearman correlation
the spearman correlation coefficient is defined as the
pearson correlation coefficient between the ranked variables 
p
  d i
   
  
n n     

   k nearest neighbors classification  neighborsbased classification labels each example  x k    according
to 
k
x
d v  f  x k    
    
f x q      arg max
vv

where di   xi  yi is the difference between ranks 

after selecting our features  we proceeded to run multiple learning algorithms using our dataset in order to select
the model with the highest training accuracy and cross
validation accuracy  in this section  we present the models
we tried and how we found the optimal parameters for
these models 

r  

the results of our testing are shown in table i 
because we have significantly more training instances
than features  we tried non linear kernels to increase the
model complexity for higher accuracy  however  we found
the computational time of the libsvm software on our
dataset to be much too slow to run in real time  even
after scaling our data to a        range  after comparing
all of our models  we found that l  regularized logistic
regression in the liblinear package was the optimal
model in terms of accuracy and computational time 

a  model selection
we trained our data on various types of solvers in
the liblinear package  as well as with varying kernel
options in the libsvm package  see     and      
   l  regularized logistic regression  solves the following unconstrained optimization problem 
l

   

b  parameter selection
for l  regularized logistic regression  the only parameter to optimize is the value of the cost parameter c in
the formulation for the l  regularized logistic regression
optimization problem      to find the optimal value of
c  we first performed coarse grid search by running the
algorithm using exponentially increasing values for c 
from    to       a portion of the resulting plot is shown
in fig     the value in this range that resulted in the lowest
cross validation error was c       we then centered in on

where c is the cost parameter which determines the
degree of misclassification of the objective function 
   l  regularized  l  loss linear kernel svm  primal  
solves the following primal problem 
l

x
 
min wt w   c
 max        yi wt xi      
w  
i  

k  

where each training example v is sampled from the training set v and 
v
u n
ux
 i 
 j 
    
d x   x     t  xir  xjr   

v  m odels

x
t
 
min wt w   c
log     eyi w xi  
w  
i  

    

i   

    

 

fitable i  performance of different models
model

training
accuracy

  fold cv
accuracy

num iterations

l  reg lr  primal 

        

        

  

l  reg  l  loss  linar
kernel svm  dual 





max

l  reg  l  loss  linar
kernel svm  primal 

        

        

  

l  reg  l  loss  linar
kernel svm  dual 





max

l  reg  l  loss  linar
kernel svm

        

        

  

rbf kernel svm

    

   

    

sigmoid kernel svm

   

   

   

knn

    

        



b  ablative analysis
to choose an optimal feature set  we performed ablative
analysis  starting with all features and removing them
one at a time to see how each feature impacts performance  as shown in table iii  removing the pearson
and spearman correlation features actually increased the
cross validation accuracy by a small amount  from there 
removing the time delayed features decreased accuracy
by about       removing the maximum cross correlation
features decreased accuracy by about      and removing
euclidean distance features decreased accuracy by about
     leaving us with the baseline accuracy of about     
using these results  we determined that the optimal feature
subset consists of univariate  euclidean distance  maximum cross correlation  and time delay features  which
gives us an cross validation accuracy of         

this value and performed fine grid search with a smaller
range  and finally deduced that c      was the optimal
value 

table iii  ablative analysis on feature combinations

fig     cross validation error for different values of c
vi  r esults
a  single feature performance
table ii shows the accuracies from running l regularized logistic regression on each of the feature types
individually  it includes the baseline features  univariate  
linear features  mcc   and nonlinear features  euclidean
distance  similarity  spearman correlation  pearson correlation   the best cross validation accuracy achieved with
a single feature type was        using maximum crosscorrelation   however  using a combination of feature
types increased this accuracy by about     as discussed
in the next subsection 

feature combination

training
accuracy

  fold cv
accuracy

univariate   euclidean  
mcc   mcc w  time delay
  pearson   spearman

        

        

univariate   euclidean  
mcc   mcc w  time delay
  pearson

        

        

univariate   euclidean  
mcc   mcc w  time delay

        

        

univariate   euclidean  
mcc

        

        

univariate   euclidean

        

        

univariate

        

        

c  precision and recall
for seizure prediction  high recall is especially important so that seizure warnings are not missed  however 
a relatively high precision is also important to avoid
unnecessary stress caused by false positives  by adjusting
the threshold probability at which to output a positive
prediction  fig      we determined that we acheived a
maximum f  score of        at a threshold of       
 table iv  
table iv  confusion matrix and relevant values at the
threshold probability that gives the maximum f  score 

table ii  individual feature accuracies

prediction
preictal interictal
      
     
     
      
      
      

feature type

training
accuracy

  fold cv
accuracy

univariate

        

        

euclidean distance

        

        

max cross correlation

        

        

mcc with time delay

        

        

similarity coefficient

        

        

precision

      
      

actual

preictal
interictal
total

spearman correlation

        

        

recall

pearson correlation

        

        

specificity

      

f  score

      

 

total
      
      
      

fi a  precision recall curves

which the error converged was higher than our desired
error  we determined that our classifier was suffering
from high bias  so adding more features could help  we
then concatenated the     euclidean distance features
onto the original features  and noticed that the training
and test errors decreased  next  we concatenated on the
maximal cross correlation features and noticed another
decrease in error  finally  after adding on the maximal
cross correlation with time delay features  we were able
to reach a more desirable level of accuracy 
vii  c onclusion
in this project we implemented a supervised binary
classifier for eeg recordings  throughout the course of
our work  we progressed from a basic feature set with
just one feature for each electrode channel  to a more
complex feature space encapsulating non linear and linear
correlations between pairs of electrode channels  through
this process  we were able to increase our cross validation
accuracy from just over     to        corresponding to
an f  score of        

 b  roc curves

viii  f uture w ork
we would like to try different models and feature
combinations on multiple subjects  since we did not get a
chance to experiment with more than one subject and the
international epilepsy electrophysiology portal has many
more intracranial eeg datasets  we might try computing
more complicated nonlinear features  such as dynamical
entrainment or wavelet based measures of synchrony  in
the future  we could also compute relationships on more
than two eeg channels  and eliminate pairs of channels
that do not contribute much to the final prediction  in
order to prevent the dimension of our feature vector from
increasing linearly with the number of types of features
added 

fig     precision recall and roc curves for different
feature combinations
d  error diagnostics

r eferences
    c  c  chang and c  j  lin  libsvm  a library for support vector machines  in acm transactions on intelligent systems and technology                     software available at
http   www csie ntu edu tw  cjlin libsvm 
    f  s  bao  et al   pyeeg  an open source python module
for eeg meg feature extraction  in computational intelligence
and neuroscience  vol        article id           pages       
doi                     
    p  mirowski  et al   classification of patterns of eeg synchronization for seizure prediction electroencephalography and clinical
neurophysiology                     nov      
    r  e  fan  et al   liblinear  a library for large
linear classification  in journal of machine learning
research
        
          
software
available
at
http   www csie ntu edu tw  cjlin liblinear 
    a  shoeb and j  guttag  application of machine learning to
epileptic seizure detection  in proceedings of the international
conference on machine learning  haifa  israel       
    t  p  jung and s  makeig  removing artifacts from eeg  ica
eeg tutorial  web     dec       

fig     training and cross validation error for different
feature combinations
to diagnose the bias vs  variance of our learning algorithm  we plotted the training error and the test error for
different training set sizes  fig      starting with just the   
baseline univariate features    feature for each electrode
channel   because the training error and test error both
plateaued to about the same values  we confirmed that
we did not have high variance  and a larger training set
would not increase accuracy  however  since the value at
 

fi