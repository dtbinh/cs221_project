genre classification using graph representations of music
rachel mellon  dan spaeth  eric theis
november         
abstract
a song can be represented by a graph  where nodes and edges represent individual pitchduration tuples and co occurrence of multiple notes respectively  a set of features can be
derived from said graph for use in a variety of classification algorithms  in an attempt to derive
meaning and utility from these graph features  we tackled the issue of genre classificationa
highly subjective form of categorization in and of itself  we aimed to create a high performing
method of genre classification by examining the capabilities of the algorithms svm  naive bayes 
multinomial logistic regression  and knn using the aforementioned features as inputs 

 

background

the concept of using machine learning to expedite  improve  or enhance the ability to assign
genre classifications to music is not a new one  classification of musical genre  a machine learning
approach  a paper authored in      at university of rome tor vergata  provides a breakdown of
various machine learning techniques  naive bayes  voting feature intervals  j    part  nnge 
and jrip  and their performance in classifying music based on features extracted from their midi
files  for this study  researchers highlighted features that functioned like a musical fingerprint for a
song  including relative frequency in melodic intervals  which instruments are used  meter and time
changes  and extremes such as longest note  highest note  and lowest note  ultimately  naive bayes
performed the best  with about     accuracy  depending on the testing strategy      
another paper  music genre classification  covers a few additional classification methods
such as knn  k means  svm  and neural networks  while using mel frequency cepstral coefficients
 mfcc  as features  the highest performing of these algorithms was neural networks with    
accuracy  although all four algorithms struggled with differentiating two similar genres  jazz vs
classical  metal vs jazz      
in the past  graph representations of music have been used to derive melodic similarity       in
our analysis  we pursued other types of information that could potentially be extracted or derived
from graph representations in order to apply those to genre classification 

 

methodology

for our purposes  we explored an unexamined set of features with respect to genre classification 
using musical parsing scripts  which leverage the mit music   library and the graph tools python
libraries   we translated midi files into graph representations of music  which we then analyzed for
patterns to function as features for this classification 

 

fi   

music as a graph

in order to convert our midi files into feature vectors  we generated graph representations of
each midi song 
conceptually  a song is represented as a graph where each node contains a unique pitchduration tuple  and each directed edge represents the second node occuring directly after the first
node in the song  as such  edge weights represent the number of times the first pitch duration note
is followed immediately by the second pitch duration note  self loops represent repeating pitchduration notes  connected components each represent a different part in the song  where all parts
are heard simultaneously in the original song   this idea has been explored in depth by panos
achlioptas     

the above figure depicts our graph representation of the song black and gold by sam sparro 

   

features

the features that we used come from three main categories  music properties  graph properties 
and motif properties  music properties were extracted from each midi file and included  after feature
selection  only the numerator of the time signature 
graph properties were derived from the graph representation of each song  they were clustering co efficients  pseudo diameter  number of nodes  number of edges  number of self loops  and
average edge weight 
finally  we derived motif counts for each graph  where a motif is a non isomorphic induced
subgraph   the algorithm to derive these count based features required two steps  the first was
finding the count of all induced subgraphs or order k  where k is a predefined number of nodes in
each subgraph  the second was aggregating these counts  by grouping each isomorphism class  in
other words  adding the counts of all isomorphic subgraphs together  

   

models

we investigated several models  which we selected because of their common use to solve supervised classification problems with continuous features 

 

ficlassification model
svm
naive bayes
linear regression
multinomial logistic regression
k nearest neighbors classifiers

details
linear  radial basis  and signmoid kernels
gaussian prior
huber loss function
one vs  rest scheme with l  norm
uniform and inverse distance neighbor weights

while we experimented with using radial basis function kernel svms  sigmoid kernel svms 
and huber linear regression  we did not have the opportunity to tune the parameters of these
models  thus  they are not included in the remainder of this report 
all the algorithms we used were implemented in python with the scikit learn package 

 

data

our data set consisted of two hundred samples  we had    samples from each of five genres 
classical  electronic  country  jazz  and opera  the genre label assigned to each song in our training
sets was determined by the genre assigned by the midi source                                to ensure
each sample contained enough data to generate a structurally unique graph  we only selected files
with a minimum size of  kb  the files can be found in our cloud storage folder     

 
   

results
feature selection

to best understand the uses of graph representations of music in machine learning  we dove
deeper on which graph properties produced the most relevant information for genre classification 
first  we examined the weights associated with each feature in our feature vector from our linear svm
model  this analysis showed that certain features added no value  such as the denominator of the
time signature and the number of parts   while others contained significant importance  including
the numerator of the time signature and all of the remaining graph properties and motif properties  

another key part of our feature selection process had to do with analyzing the relevance and
effectiveness of different orders of motifs  we ran our algorithms on   variations of our feature
vector  see graph above   in order to determine which motif ordersif anyprovided the most useful
information for genre classification 
we found that our best results across various algorithms came from the feature vector with
motifs of orders      the omission of motifs of order   improved performance most probably because
there are such a large number of motifs of order    and they are so specific  they provide more
information on the song than the genre level 
 

fi   

machine learning
binary problem
  error
electronica vs classical
    
electronica vs opera
    
electronica vs country
     
electronica vs jazz
     
classical vs opera
    
classical vs country
    
classical vs jazz
    
opera vs country
    
opera vs jazz
    
country vs jazz
    
  error for multinomial logistic
regression using motif orders    

our highest performing models were naive bayes  multinomial logistic regression  and k
nearest neighbors  both with uniform weights  in which all points in a neighborhood are weighted
equally  and with weights inversely proportional to distance   across all classification problems 
multinomial logistic regression consistently had the lowest error 
our svm with a linear kernel also performed relatively well  but unfortunately  due to a lack
of computational power  we were only able to run the svm on the   way classification with features
including motifs      even so  the linear kernel svm performed extremely well on this classification 
outperforming multinomial logistic regression by roughly    
interestingly  our results also give an informal graph similarity measure between genres  as
binary classification problems between similar genres yeilded higher errors  we see that classical 
opera  and jazz seem to be relatively similar in graph structure  and that country is also surprisingly
similar to jazz 

 

discussion and future work

since the focus of our project was to determine whether graph representations of music could
be used to effectively classify songs by genre  our data serves to prove that they can  in our binary
classification tests  algorithms performed comparably to or better than the algorithms implemented
on feature vectors comprised of other types of musical fingerprints outlined in the background
section of this paper  with binary classification errors in the        range 
the next steps to improve our results would be to continue to fine tune the parameters for
each machine learning algorithm  additionally  it would be useful to expand the types of graph
properties we use as features  for example  we would like to try our models using the counts
of connected non isomorphic sub graphs  instead of motifs  which lose information since they are
induced   additionally  there are features of the graphs such as edge direction and weight that we
neglect entirely  which could be used to derive greater structural meaning from the graphs 

 

acknowledgements

we would like to thank panos achlioptas for introducing us to the idea of graphical representations of music and for his guidance throughout our work on this project 

 

fireferences
    panos achlioptas  musical graphs  arxiv      
    roberto basili  alfredo serafini  and armando stellato  classification of musical genre  a
machine learning approach       
    michael haggblade  yang hong  and kenny kao  music genre classification       
    country midi palace http   countrymidipalace tripod com index html  accessed     november       
    data repository https   stanford box com s nylud x earmj ro mzh 
    aria database http   www aria database com  accessed     november       
    classical archives http   www classicalarchives com   accessed     november       
    cool midi http   www cool midi com electronica midi php  accessed     november       
    download midi http   www download midi com   accessed     november       
     glass pages http   www glasspages org audio html  accessed     november       
     the jazz page http   www thejazzpage de index  html  accessed     november       
     nicola orio and antonio roda  a measure of melodic similarity based on a graph representation
of the music structure       

 

fi