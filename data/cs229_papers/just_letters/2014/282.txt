cs    final project  multi class motif discovery in
keratinocyte differentiation
daniel kim
december         

introduction
enhancer elements are short segments of regulatory dna that play important roles in activating gene expression within dynamic biological processes like cell differentiation  these enhancer regions are often bound
by activating proteins known as transcription factors  tfs   and the dna sites bound by tfs often have a
sequence pattern  known as a motif  that can be matched to individual tfs  with over   million putative
enhancer regions in the human genome  understanding enhancer function is essential to understanding dynamic gene regulation  as such  discovering regulatory sequence motifs within enhancer regions is an area of
continuing research  previous methods have included the use of discovered motifs and looking for matches
within enhancer regions  as well as machine learning techniques  logistic regression and svms  among others
     however  such methods have only compared positive examples to negative examples  in a binary class
format  here  we extend machine learning techniques to discover sequence features in a multi  class format 
which is useful in situations where enhancers have varying activity patterns and we are interested in the
underlying sequence features that are leading to these multiple patterns  we use the skin differentiation
process as our test case 
skin differentiation  the transition from skin progenitor cell to differentiated keratinocyte cell  is a process
disrupted in skin cancer  squamous cell carcinoma and basal cell carcinoma   psoriasis  chronic wounds  and
nearly     inherited human skin disorders  disruption of skin differentiation is most often caused by changes
in gene regulation  as shown in studies on transcription factors and their roles in skin function and development  additionally  accurate genetic models of primary keratinocytes  both in vitro and in vivo  have proven
to be powerful tools in understanding regulation by transcription factors and non coding rnas  furthermore  numerous genomic time series datasets have been generated with primary keratinocytes  the dynamic
nature of epidermal homeostasis  biologically relevant model systems  and availability of genomic datasets
makes keratinocyte differentiation an ideal process to understand enhancer elements and the underlying
sequence differences 

materials and methods
datasets we collected histone chip seq  h k me   h k me   h k  me   h k  ac  h k ac  and
atac seq for   time points in skin differentiation  days       and     we pre process the data so that
we determine enhancers and their activity levels at each time point  then  we convert the sequence in
each enhancer region into counts of k mers  which are short dna sequences of length k  for k    sequences
include aa  ac  ag  at   tt   after pre processing  the rows are examples of enhancers and the columns
are the k mer features  depending on k  there are  k features  since there are   bases   the examples are
labeled with which enhancer activity pattern it belongs to 
pre processing  bifurcation analysis for labeling to get enhancer elements  we first utilize a hidden
markov model to combine histone mark data and output chromatin states across the genome  chromhmm     
we also call peaks from atac seq data  which marks regions of open chromatin  we then intersect the two
set of regions obtained to get a consensus set of regions  we then utilize the atac seq sequencing reads
found in those regions and look for differential peaks utilizing deseq  thus  peaks from one time point
to another can increase      decrease       or stay the same      with three timepoints and two pairs of
comparisons that can be made across time  this allows us to segment the peaks into   different peak patterns 
which constitute our   classes for prediction  we then label each group in order  increase increase is group
   increase same is group    increase decrease is group    and so on  as shown in table    
 

figroup
 
 
 
 
 
 
 
 
 

table    number of samples in each class
day   to day   day   to day   number of samples
up
up
   
up
no change
    
up
down
   
no change
up
    
no change
no change
     
no change
down
    
down
up
    
down
no change
    
down
down
   

multinomial logistic regression we take the sequence data and convert into k mers  lengths of     
and track the counts of each kmer found in the sequence  for each length k  we have  k features  we then
run logistic regression with lasso penalty  r package  glmnet      which runs multinomial logistic regression
based on the equations below 
e    x

p r g     x    pk

k  

 
max

k p   
        k
  r

t

 

   

e k  xt k

k
n
x
  x
p     
log pgi  xi    
n i  

 
   

   

succinctly  the model learns a logistic regression classifier for each class  and then takes the highest
probability outcome as the predicted class  the lasso penalty is used to reduce weights on k mer features
that are relatively insignificant 
multi class svm we use the spectrum kernel  which converts sequence into k mers  lengths of        for
each length k  we have  k features  we then run multi class svm with l  regularization and l  loss with
the one vs the rest strategy  r package  kebabs      which runs the svm based on the equation below 
l

x
 
min wt w   c
 w  xi   yi  
w  
i  

   

succinctly  the svm first uses the kernel to quickly compute the k mer feature values without having to
maintain the k mer feature space  then it runs an svm that takes a single class as a positive class and the
rest as negative classes 

results
multinomial logistic regression running multinomial logistic regression  we find that error rates  defined as all misclassified examples  are high and remain very high  despite increasing the training set size and
the k mer length  figures       however  there is enough of a downward trend that it is possible that more
training data could be useful in decreasing the error rate  on average  we get errors around          however 
we do find that the weights learned in logistic regression for the different k mer features are heterogenous
across the nine classes  suggesting that there are sequence differences across the classes that were learned by
multinomial regression  figure    

 

filogistic regression error analysis  kmer    

logistic regression error analysis  kmer    

     

logistic regression error analysis  kmer    

    

     

training
test

    

    

group

error

group

error

error

    

training
test

    

group
training

     

test

     

    

 

     

     

 

     

training set size  m 

figure    error analysis of
multinomial logistic regression
 kmer   
color key

 

     

     

training set size  m 

figure    error analysis of
multinomial logistic regression
 kmer   

figure    error analysis of
multinomial logistic regression
 kmer   

and histogram

 

count

     

training set size  m 

    

 

         

value

tt

tg

ta

tc

gt

gc

gg

ct

ga

cg

ca

cc

at

ag

aa

ac

 
 
 
 
 
 
 
 
 

figure    heatmap of learned weights for the multi class logistic regression using kmer   
multi class support vector machines running multi class svms  we find that the error rates are high
and remain high  despite changing the k mer length used and increasing the training set size  figures       
however  we again find that the weights learned by the svm are heterogenous across the classes  figure     
svm error analysis  kmer    

svm error analysis  kmer    

svm error analysis  kmer    

     

    

   

     

training
test

group
training
     

test

error

error

group

error

    

group
training

   

test

    

     
   

    

     
    

     

training set size  m 

figure    error analysis of
multi class svm  kmer   

    

     

training set size  m 

figure    error analysis of
multi class svm  kmer   

 

    

     

training set size  m 

figure    error analysis of
multi class svm  kmer   

fisvm error analysis  kmer    

svm error analysis  kmer    

    

    

group
training
test

    

    

    

group
training
test

    
    

    

     

    

training set size  m 

figure    error analysis of
multi class svm
 kmer   
color
key
 

test

    

     

training set size  m 

count

training

    

    

    

group

error

    

error

error

    

svm error analysis  kmer    

     

training set size  m 

figure    error analysis of
multi class svm  kmer   

figure     error analysis of
multi class svm  kmer   

and histogram
    

 

    

value

tt

tg

ta

tc

gt

gc

gg

ct

ga

cc

cg

at

ca

ag

aa

ac

 
 
 
 
 
 
 
 
 

figure     heatmap of learned weights for the multi class logistic regression using kmer   

discussion
error analysis suggests that more data could be useful for multinomial logistic regression but not for multiclass svm  notably  as the k mer length increased for svms  we find significant over fitting   the training
error drops to    while the test error stays around       however  there are only so many enhancers that
are biologically active in keratinocyte differentiation  and so generating more examples of enhancers is not
possible  we do note that there could be quality issues in the data  as the read depths of sequencing of the
atac seq datasets were low   increasing the sequencing levels could lead to better classes of data that lead
to better classification and k mer weights 
we do find that there are different weights on the k mers for the different classes  this suggests that
there are underlying sequence features that do lead to different enhancer activity patterns  however  the
high classification error rate suggests that there are very few sequences in each group that actually have
these sequence features  and thus get classified correctly in the test set   as such  further segmentation of
the classes is likely necessary to actually have better predictions 
this problem of significant heterogeneity within the classes is demonstrated in figure     where k means
clustering is performed on one class of enhancers  using a k of     we see significant heterogeneity leading
to at least    distinct clusters of sequence with differing numbers of each k mer  seeing this heterogeneity 
further segmentation is necessary in each class to produce classification that is representative of the entire
group of sequences in a class 
the high error rates seen in both multi class learning techniques is somewhat expected  given the biological context  when considering the original segmentation of the classes  based on enhancer activity in three
time points   it is highly likely that there are many different mechanisms at work in causing various enhancers
to change activity patterns  in other words  there are many transcription factors and many combinations of
transcription factors that are acting on groups of enhancers to change their behavior  as such  it is likely
that many enhancers in a group may have very different motifs  despite acting in the same manner across
time 

 

fi 

count

         

color key
and histogram

 

   

   

   

ag

tg

ga

gg

ct

gc

tc

ca

at

cc

ta

ac

gt

tt

aa

cg

value

figure     enhancers from group   clustered into    groups using k means clustering  there is notable
sequence heterogeneity in the class 

future directions
logistic regression was not performed on higher order k mers due to computational constraints  utilizing a
kernel within logistic regression could be valuable and very interpretable  additionally  a variety of other
sequence based kernels exist that consider mismatches and gaps  these are more biologically accurate kernels
and may fit a better model  noting the high error rate and the likelihood that biological heterogeneity plays a
role in the error rate  segmenting the sequences further may also act as a filter for creating more homogenous
classes  finally  directly checking for motif instances within the regions may also provide important features 

acknowledgments
thank you to andrew ng and the tas who put on a wonderful class 

references
    ernst  j     kellis  m          chromhmm  automating chromatin state discovery and characterization 
nature methods               doi         nmeth     
    heinz  s   benner  c   spann  n   bertolino  e   lin  y  c   laslo  p       glass  c  k          simple
combinations of lineage determining transcription factors prime cis  regulatory elements required for
macrophage and b cell identities  molecular cell                 doi         j molcel            
    jerome friedman  trevor hastie  robert tibshirani         regularization paths for generalized linear models via coordinate descent  journal of statistical software               url
http   www jstatsoft org v   i   
    j  palme and u bodenhofer         kebabs   an r package for kernel based analysis of biological
sequences unpublished  http   www bioconductor org packages  release html kebabs html
    the spectrum kernel  a string kernel for svm protein classification  c  leslie  e   eskin  w  s 
noble  proceedings of the pacific symposium on biocomputing  psb             

 

fi