cs      solar flare prediction
paul warren
pwarren stanford edu

gabriel bianconi
bianconi stanford edu

december     

 

problem

solar flares  the release of energy the equivalent of                 megatons of tnt in the form of high energy
particles  occur when unstable magnetic field lines reconnect into a series of loops  releasing energy that accelerates
high energy particles into space  often disrupting satellite operations and damaging astronaut health  although
we understand the general process  we dont know enough details to forecast flares with any reasonable degree of
reliability  large frames are always preceded by magnetic field activity  but magnetic field activity isnt always
followed by large flares   its common for two extremely similar magnetic fields to lead to two different results 

figure    an image of the sun in fe xviii  which shows plasma at temperatures of     megakelvin  mk   the
very intense brightenings are solar flares  frame   is more active than frame    but frame   leads to a larger much
flares    hours later  its also common to see two similar frames where one leads to a flare and the other doesnt 

 

literature review

machine learning is new to most of astrophysics  and solar physics is no exception  a search for the keywords
machine learning on the astrophysics data system paper library returns only     abstracts  what little previous
work exists focuses on vector magnetic field data or line of sight magnetograms  bobra        after consulting a
solar physicist  we decided to combine line of sight photospheric magnetic field data and images that show the high
temperature corona  what we believe to be a novel feature set  to predict solar flares    hours in advance  the
temporally resolved image data should give insight into stresses in the magnetic field that lead to the flares 

 

data

the nasa solar dynamics observatory  sdo  has been recording solar temperature and magnetic field data via
the atmospheric imaging assembly  aia  and helioseismic and magnetic imager  hmi   respectively  since may
      the noaa satellites  goes  have been recording solar radiation data via the x ray sensors  xrs  since
the     s 
aia images give us information about the high temperature corona in the form of snapshots of different types of
iron plasma  which appear at various temperatures  moving across magnetic field lines  fe xviii  for example 
 

fiis     million degrees hot  and fe xxi       is       million degrees hot  literature review suggested most large
flares were preceeded by large amounts fe xviii and fe xxi  although large amounts of fe xviii and     dont
always lead to large flares  hmi images are magnetograms of the photosphere  goes data measures the amount
of x rays emitted from the sun and tells us if a flare happened somewhere on the sun 
goes data is taken for every   seconds  aia data is collected every     seconds  hmi data is collected every
    seconds      day chunks of goes  aia  and hmi data were collected for the regions that produced each of
the    largest flares within    degrees of the central meridian  the area we have high quality data from  since may
      this data was processed into   aia snapshots  one every    hours  with the goes and hmi data for a   
hour period  some files were corrupted or incomplete  we were left with        hour chunks  of which     had
class m  or above flares  a max     value above     e      all data was scaled by log   for crunchability and
normalized by the mean and standard deviation for comparability 

figure    intensities in the aia images show the amount of fe ix      fe xii      fe xviii  and fe xxi     on
the sun  these emission lines appear at   million degrees      million degrees      million degrees  and       million
degrees  respectively  blos and cont are hmi images that show the photospheric magnetic flux and sunspots
on the white light continuim  respectively  the challenge is to use these snapshots and the time evolution over the
past    hours to predict if a flare will occur in the next    hours 

figure    goes tells us if theres a flare  but doesnt say
figure    lightcurves of goes       and fe xviii for   where  we used linear regression to map the global goes
flare threshold to a local     flare threshold to determine
hours after the aia images are taken
when a flare happened in the region we were looking at 

 

fi 

features
   total unsigned magnetic fluc
   total fe xviii
   standard deviation fe xvii past    hours  if available 
   standard deviation goes x ray past    hours  if available 
   standard deviation fe xxi     past    hours  if available 
   standard deviation fe xvii past    hours  if available 
   standard deviation goes x ray past    hours  if available 
   standard deviation fe xxi     past    hours  if available 
   standard deviation fe xvii next    hours  if available 

features were selected from previous work  feature   gives us information about the photospheric magnetic field 
feature   gives us information about the high temperature corona  which is a good proxy for information about
the coronal magnetic field  features     tell us information about the solar activity over the past    hours for the
    data points that have that information  features     tell us information about the solar activity over the past
   hours for the     data points that have that information  and feature   tells us information about the magnetic
flux over the next    hours  the period when were trying to predict the solar flares 

 

analysis

all machine learning algorithms were evaluated using two metrics  accuracy and true skill score  tss   accuracy
may be skewed as a result of our data set being skewed towards flaring regions  but the tss takes into account
wrong guesses and goes from    to   
true skill score  

   

true positives
false positives

true positives   false negatives false positives   true negatives

svm

we used scikit learn to determine the true skill score of an svm for each pair of features  we trained and tested a
two dimensional svm on each pair of features  we tried splitting the     data points into a testing and a training
set  but our data set is so small our tss on the training set varied from    and    from run to run  so all tsss are
calculated using the same training and testing set 
to make sure our svm worked  we predicted flares over the next    hours using data about the variability of the
plasma for the next    hours and  as expected  got a high result  a true skill score of       because the data
was so linearly separable  a linear kernel was comparable to an rbf kernel  most data points were thoroughly
mixed  though  so rbf kernels usually outperformed linear kernels  most svms performed similarly  with a tss
around      the best one being the total amount of fe    and the standard deviation in     for the past    hours 
this makes sense because both values relate to instability  and literature review suggests large flares are often
preceded by instability  although instability doesnt always lead to large flares   the tss are so low because of
the high number of false positives that result from the fact that were trying to predict data thats really difficult
to categorize  if we had more regions without large flares  as previous work has  the tss would likely be much
higher  its possible there are so many non flaring data points near flaring data points because those regions had
recently flared and active regions are unlikely to have large flares twice in a row  a lot of data points  e g     
and fe     seemed to be linearly correlated  and so wouldnt provide additional useful information if added to a
multi dimensional input learning algorithm 

 

fisvm feature pairs
    
    
    
    
    
    
    
    
    
    
    
    
    
    

accuracy
   
   
   
   
   
   
   
   
   
   
   
   
   
   

true skill score
   
   
   
   
   
   
   
   
   
   
   
   
   
   

svm feature pairs
    
    
    
    
    
    
    
    
    
    
    
    
    
    

accuracy
   
   
   
   
   
   
   
   
   
   
   
   
   
   

true skill score
   
   
   
   
   
   
   
   
   
   
   
   
   
   

table    svm results on each feature pair

figure    blos magnetograms were reduced from     x     to     x     and fed into a neural net

   

neural net

we also reduced the amount of data in a blos magnetic field data image and fed it to a neural net using the
fast artificial neural net  fann  library  the ann had        input neurons     hidden neurons  and   output
neuron  the      prediction rate of the training data suggests overfitting  but the     of the testing set makes
that seem unlikely  the tss for the training set was      below the usual tss for the svms  likely because this

 

fitraining set      images 
testing set      images 

accuracy
    
   

true skill score
    
   

mse
     
     

table    neural net results

neural net has no concept of data over time 

 

conclusion

the goal of the project was to predict flares    hours in advance  our svms did so with around     accuracy and
our neural net did it with     accuracy  this is better than the     accuracy bobra achieved  but the results may
be biased because of how we constructed our data set  the similarities in accuracy arent reflected in the respective
tsses   svms tss were higher than the ann tss by     likely because the svms incorporated temporal data
and the ann didnt 

 

future work

future work includes working with multidimensional svms  experimenting with the type and settings of the ann 
experimenting with new flare thresholds  using new features like variability in the magnetic field  and collecting
higher cadence data on regions without large flares 

 

acknowledgements

dr  harry warren of the naval research laboratory helped significantly with the literature review and feature
selection 

 

references
   bobra  m g    couvidat  s        astrophysics journal   tbd  tbd

 

fi