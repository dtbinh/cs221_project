classifying fmri images using sparse coding 
a project for cs   
christopher archibald
cja stanford ed

evan millar
emillar stanford edu

december         

 

introduction

recent work has been done by rajat raina and other researchers at stanford
in applying sparse coding techniques to various classification problems  in
this project we follow that tradition by applying sparse coding to the problem
of classifying fmri images  in particular  we try to classify fmri images
based on what the subject was doing when the fmri image was obtained 
the two classification possibilities we consider are whether the subject was
looking at a sentence or looking at a picture 
rajat raina provided direction and advise on sparse coding techniques 
as well as a code base for sparse coding and classification  we acknowledge
him and thank him for his help 

   

fmri images

fmri  functional magnetic resonance imaging   is a method of using magnetic resonance imaging to measure the change in blood flow and oxygenation of blood in the brain  fmri data is typically noisy and very highdimensional  it is also difficult to obtain large amounts of data from single
subjects  fmri data must be pre processed in a fairly significant way so
that the resulting data is usable 
for our project  we started with the data obtained in the star plus fmri
project at carnegie mellon  this data has already been preprocessed and
arranged in a manner that makes dealing with it more practical  each patient
has      snapshots  half of those snapshots the patient is looking at
a sentence  and the other half the patient is looking at an image  each

 

fifigure    sample fmri images
snapshot contains eight two dimensional images  each of which is a cross
section or slice at a certain depth in the brain 

   

sparse coding

sparse coding is a technique for representing information that has been postulated to occur in the v  portion of the visual cortex  sparse coding algorithms learn bases that can be linearly combined to reconstruct the input
data  sparse coding algorithms specifically try to come up with a set of bases
that will allow for accurate reconstruction of the input with as few images
as possible 
given input images x i    the sparse coding algorithm finds activations a i 
and bases b to minimize equation    
min
b a

x
i

  x i  

x

 i 

aj bj          a   

   

j

our hope in applying sparse coding to fmri data is to be able to identify
regions in the brain that have correlated activity  much like rois  regions of
interest  used in typical fmri data analysis  rois must be hand identified
by someone with neuroscience knowledge  who can analyze the brain and
designate the regions of interest as defined by specific anatomical landmarks 
through sparse coding  our hope was to achieve comparable performance
without brain specific knowledge 

 

experiment

originally we wanted to be able to train bases and a classifier that worked
across multiple subjects  our goal was to be able to train on data from a
group of subjects  and then test on a new subjects data  however the shape
and size of the brain varied substantially between subjects  we realized that

 

fiin order to make this work we had to somehow normalize the fmri data
across subjects 
we decided to translate and scale each fmri slice to a standard size
of   x   pixels  this helped to line up the slices so that the brain size
and shape across patients had more congruency  however upon calculating
bases and training classifiers with this normalized data  we discovered that
this data normalization was not sufficient to be able to compare data across
subjects effectively  after doing more research into how this issue is dealt
with in past studies  we found that this is actually a significant problem
in machine learning of fmri data  the most common solution is to use
manually labeled regions of interest and then compare those regions across
subjects  we decided that for the scope of this project we would stick with
single subject bases and classifiers  this in itself is a hard problem  and one
that has not been perfected as yet  we felt that this was still a significant
topic to tackle  and one that could perhaps be improved upon by sparse
coding techniques 
once we decided to work to classify within a single subject  we tried
several test runs of the whole process on one subject  with variations in the
sparse coding and pca parameters  we varied things like the pca reduction
dimension  the  value  or sparseness penalty  in the sparse coding algorithm 
the number of bases learned  and the size of the test and training sets  from
the results of these varied experiments on a single subject we decided to
proceed with experiments involving the rest of the subjects  reducing our
data to     dimension through pca  using a  value of    and using    
of the data as training data and     as test  we then proceeded to run the
code with this setup on two other subjects  we present the results in the
next section 

 

results

most of the subjects data contained about      voxels  using pca  we
reduced this data to     dimensional data  this reduction usually preserved
between     and     of the total variance of the original data  figure   
shows an original fmri image and then that same image reduced to    
dimensions and then converted back to its original dimensionality  this is
what we used to give us a feel for how the different pca reduced dimension
sizes were doing at preserving the original data 

 

fifigure    comparison of original fmri image  left  with pca reduced image

   

sparse coding results

the sparse coding algorithm learned    bases for each of our subjects  the
sparsity penalty  was    and this gave us average activation activities around
    meaning each fmri image was reconstructed using only about    of the
bases  with    bases learned  this means that on average we were using
between   and   bases to reconstruct a given image  an example of a reconstruction that used only   bases is shown in figure    

        

       

figure    reconstruction of fmri image from bases    and   

   

classification results

we ran our code on the fmri data of   subjects  and trained gda classifiers
on     of the data and tested on the other      as a baseline for comparison we also trained classifiers on the raw voxel information after the pca
dimension reduction  this is shown in the table under raw features  the
results of these experiments are shown in table    

 

conclusions and future work

results of our various experiments were varied and inconsistent  some indicated that sparse coding had a significant impact on the accuracy of classification of fmri images  while others showed that sparse coding struggled
to compete with use of raw voxel information to classify the images  our
conclusions are that more work needs to be done determining just how much
 

fitable    classification accuracies for gda classifiers trained using raw and
sparse features
training size raw features sparse features
subject     
   
     
     
   
     
     
   
     
     
    
     
     
subject     
   
     
     
   
     
     
   
     
     
    
     
     
subject     
   
     
     
   
     
     
   
     
     
    
     
     
sparse coding can impact fmri classification  the amount of time necessary
to complete a cycle of bases learning and classification limited the number of
experiment we were able to complete  as it was  we completed a fair number
of experiments  but almost always with different parameters involved 
in the future  we would like to continue with a more comprehensive evaluation of some of the techniques we have used in this project  specifically 
it would be very helpful to use some form of cross validation to evaluate
the classifiers results on this data set  we plan also to vary the number
of bases we learn  and see what effect this has on classification ability  we
also would like to investigate the effectiveness of sparse coding as applied
to time sequences of fmri images  as opposed to single time snapshots  as
we attempted in this project  bases learned on time sequences might give
us more robust classification possibilities and might contain new information
about the relationships of different areas of the brain  we plan also to use
sparse coding to help classify fmri images or sequences into more categories
than just two  this would be necessary in the pittsburgh brain activity
interpretation competition  www ebc pitt edu   which would also provide a
lot of data and opportunity to determine the effectiveness of a sparse coding
approach  we are optimistic about the possibilities of sparse coding in the
future of fmri interpretation 

 

fi