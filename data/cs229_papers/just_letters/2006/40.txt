waveform based musical genre classification
charles tripp

hochak hung manos pontikakis

abstract
for a human  recognizing the genre of
a piece of music is usually an effortless and
thoughtless task  for a computer  genre classification is not a simple task  previous research
on this topic has found it to be a difficult machine learning problem  we have carefully
chosen relevant features and an appropriate
classification algorithm which achieve high accuracy genre classification  features are extracted via spectral and time domain analysis 
and then the logitboost algorithm is used to
build an effective classifier for the data  this
paper discusses the final feature set  why we
chose those features  our final classification algorithm  and why we chose it 
introduction
in this project we have implemented an
automatic musical genre classification system
which extracts its features directly from the
music waveform  understanding which statistics and aspects of a musical piece are most relevant to classifying its genre is an important
problem for both musical database organization
and music recommendation systems  we have
compiled a dataset of over       songs  each
belonging to a specific musical genre  and extracted a number of carefully chosen features
from each song  in order to achieve a broadly
applicable classification system  we have chosen to classify music between five distinct and
large musical genres  rock  hip hop  techno 
classical  and pop  after a careful exploration
of various features  and classification algorithms  we have arrived at a set of     relevant
features which allow the logitboost algorithm
to achieve an overall classification accuracy of
     our features were chosen based on recommendations of related work               as
well as careful hands on analysis of the spectral
and time domain properties of songs from each
genre  if an effective classification system can

be created  it can be used to automatically classify songs by genre  or with slight modifications  recommend songs similar in style to a
given sample of songs  potential applications of
such a system include improved automatic musical programming for radio stations  improved
musical recommendation systems for vendors 
and musical databases which allow searching
based on various musical qualities 
related work
previous work on this problem is limited  and many studies have either classified
based on notational  e g  midi  data         or
were limited to very specific recognition tasks
 identifying classical instruments from a piece
of classical music       however  many previous attempts which used the waveform data
have focused almost exclusively on one type of
feature and analysis  for example      and    
use only the spectral characteristics of windows
of the song  while     uses only gross spectral
and time domain statistics of the entire song 
as one might suspect  a plethora of features
have been proposed  but few have proven to be
consistently helpful in genre classification 
critical features
upon examination  a classification
problem such as this requires a careful choice
of the relevant features  while a four minute
long     bit recording of a song requires over
  mb of storage space  a practical classification algorithm  without a very large training set 
can only handle perhaps several tens of features
per song  therefore  in order to create a practical algorithm  a small number of statistics
which are critical to identifying the genre of a
song must be found  features which have been
particularly useful in previous work were explored  as well as several new features  in the
end  a selection of both new and old features
proved to be the best for our problem 

fimany previous papers have suggested
that vocals can be fairly easily detected from a
song by measuring a statistic known as the
zero crossing rate  zcr               the
zcr of a waveform is merely the average number of times that the waveform passes through
zero per second  vocal tracks tend to have high
zcr s due to the dominance of the singer s
voice in the waveform  and the dominance of
frequencies in the low kilohertz range in the
singer s voice   singing  as well as most
speech  tends to have waveforms with high
zcr s  so it is natural for vocal music to also
have high zcr s  in general  the zcr is an indicator of the overall dominant frequency figure    the power spectrum of two songs 
throughout the length of a signal  our experi  to its restricted selection of instruments and
mentation has shown zcr to be one of the highly repetitive structure 
in addition to these simple measuremost important features in genre classification 
additionally  most successful designs ments of power distribution  a slightly different
have used gross spectral measurements of a set of features was selected to further hint at the
piece of music      knowing the shape of the overall texture of the frequency distribution of
frequency power distribution is a critical com  a song  we decided to logarithmically partition
ponent to identifying the genre of a song  as the frequency spectrum into    bands from
musical genres have distinct overall spectral   hz to   khz  and report the relative energy
shapes  this can be seen in figure    the power within each band  a logarithmic partitioning
spectrum of chopin s nocturn no     and    scheme is natural due to the fact that the human
cent s candy shop  the two songs of different ear has a logarithmic sensitivity to frequency 
genre s have strikingly different spectrums  as well as the fact that the musical scale scales
these differences are representative of the gen  logarithmically in frequency  frequencies bere s as a whole  rap music has strong beats and low   hz were not reported because the human
loud bass  resulting in a number of large low  ear cannot detect them  and frequencies above
frequency peaks  on the other hand  this instru    khz were not reported because the sample
mental classical piece has a series of harmonic music was only encoded up to this frequency 
peaks at midrange frequencies which are char  these features are the most significant features
we encountered 
acteristic of string and wind instruments 
intuitively  the beats per minute
our experimentation has found that a
 bpm 
of a song is an important statistic for
useful combination of these are  mean  median 
identifying
the genre of a piece of music  this
maximum power  and the variance of the power
distribution across the spectrum  these features intuition has been confirmed by previous work
give a simplified representation of the spectral               many genres tend to stay within a
power distribution of the song  and have proven certain range of tempos  and the bpm of a song
themselves to be quite useful in separating indicates that tempo  there are several known
songs by genre  for instance  classical music methods  such as comb filters  for detecting the
tends to have a low maximum power due to its overall bpm of a piece of music  but as sugbroad varieties of instruments  while techno gested in       one of the most useful bpm
tends to have a very high maximum power due statistics are extracted on a per band basis  our
implementation subdivides the song into over 

filapping    th second hanning windows  achieving a resolution of    windows second   the
power spectrum of each window is calculated
and then further subdivided into the same frequency bands as used for the spectral shape
features  each band then uses a common moving average plus threshold system to detect the
mean and variance of the bpm within each
band  this system allows the observation of
not only the tempos and speed of the music
within each frequency range  but also how
steady that tempo is  these statistics are very
helpful in separating genres  for instance  classical music tends to have a wandering melody 
which shows up clearly as a high bpm variance  on the other hand  techno music has
steady beats which show up as very low bpm
variances  hip hop tends to have very high
bpms in comparison to the other genres  especially at lower frequencies 
finally  in order to grasp the overall
qualities of the dominant musical instruments
of a song  we have implemented a set of features which have not been previously investigated  some previous work in the area suggested that the linear coefficients resulting from
fitting a simple linear model to the song might
be helpful      but it does not appear that this
has been attempted  the shape of this linear
model indicates several properties of the dominant instruments used in the song which are
normally difficult to extract  these properties
include  pitch  attach  decay  reverberation  and
timbre  for our system  we used stochastic gradient descent to fit a linear model using the previous      samples of the song  the songs used
a     khz sampling rate  to predict the next
sample  in order to reduce the number of features sent to the classification algorithm  the
power spectrum of the resulting coefficients
was subdivided into the same    frequency
bands  and the energy within each band was reported  these statistics clearly lost some detail 
including phase information  however  they
still proved to be quite useful and allowed our

system to achieve an    higher classification
accuracy than without using them 

figure    scatterplots of several distinct features

genre classification
having compiled this rich dataset of
musical features for each song  we have applied
multi class classification techniques to recognize these   distinct categories of songs  in all
of our experiments we have used    fold crossvalidation to train and test 
firstly  we tried the classic k means algorithm to create   centroids of genres  and
then we classified the songs in the test set by
computing the euclidean distance between the
song and each centroid and then classifying the
songs to their nearest centroid  this approach
did not yield to good results  as we only
achieved a classification accuracy of       
this is not a big improvement over the approximately     accuracy of randomly choosing a
genre 
next  we used matlab and the
weka data mining package to apply support
vector machines using the multi class classification method   against all which breaks the
multi class problem into several binary classification problems  svms gave a significant im 

fiprovement in classification accuracy with the
linear kernel  this resulted in        overall
classification accuracy  in an attempt to increase the performance  we tried using svms
with the second power polynomial kernel as
well as the rbf kernel  but  it turned out that
the linear kernel was the best for this problem 
the other two kernels yielded accuracies of    
and      respectively 
furthermore  we have experimented
with other classifiers hoping that we could find
a better classifier than svms for this particular
problem  in     the authors mention that the
current state of the art performance in music
genre classification is achieved using ensemble
classification methods and more specifically
adaboost with a weak classifier decision
stump  adaboost performs large margin classification by iteratively combining the weighted
votes of a collection of weak learners such as
decision trees or more simply decision
stumps  we ran adaboost using    boosting iterations and the classification accuracy
achieved was      this far surpassed the results we achieved using svms 
we wanted to improve this accuracy
even more so we decided to explore the boost 

ing techniques  in addition to adaboost we
also tried the logitboost algorithm       logitboost uses newton stepping with the hessian 
rather than the line search of the generic boosting algorithm  however  as all boosting algorithms are  it is sensitive to overfitting if the
number of boosting iterations increases above a
specific level  for that reason we have experimented with logitboost with the weak learner
decision stump using between   and    boosting iterations  figure   shows the classification
accuracy we were able to achieve for each of
those experiments  looking at the results  it is
clear that when using    iterations the accuracy
is improved by    over adaboost  for all individual genres  the accuracy was higher than
    and the recall was between      recall for
pop genre  and       with the highest recall to
be for the classical music genre  understandably  for all classifiers  the two most confused
genres were pop and rock  these are two genres which humans have difficulty defining as
well as separating  classical music was the easiest to separate  which seems natural because it
is also the easiest of the five for a person to
pick out 

    
   
   
   

svm linear kernel
svm rbf kernel
adaboost with decision stump
logitboost with
decision stump

   
   
   
   
   
   
  
classical

hip hop

pop

figure    per class classification accuracies

rock

techno

overall

ficonclusion
we have implemented some of the most
useful features found in previous research on
musical genre classification  as well as a carefully chosen set of new features  the combination of this powerful feature set with a wellchosen classification algorithm allows us to
achieve high accuracy genre classification 
comparable to that of human accuracy  both
logitboost and adaboost are well suited to this
problem  logitboost ultimately performed better because it was very successful in separating
the rock genre  which was very intermixed with
the other genres  however  adaboost and the
rbv kernel svm were significantly better at
classifying techno songs  which were more isolated from the other genres 

references
    e  scheirer and m  slaney  construction
and evaluation of a robust multifeature
speech music discriminator  proc  int  conf 
acoustics  speech  signal processing
 icassp   pp                 
    p  ahrendt and a  meng  music genre
classifation using the multivariate ar feature
integration model       
    g  tzanetakis and p  cook  musical genre
classification of audio signals  ieee
transactions on speech and audio processing 
vol      no     july      
    e  vincent and x  rodet  instrument
identification in solo and ensemble music
using independent subspace analysis  ismr 
     
    m  shan  f  kuo  m  chen  music style
mining and classification by melody  proc 
ieee icme    lausanne  switzerland       
    w  chai and b  vercoe  folk music
classification using hidden markov models 
proc  of ic a          
    k  martin and y  kim  musical instrument
identification  a pattern recognition
approach     th meeting of the acoustical
society of america  oct          
    j bergstra  n casagrande  d erhan  d eck 
b kegl  meta features and adaboost for
music classification       

figure    logitboost accuracy results

confusion matrix     iteration logitboost 
classical
hip hop
pop
rock
techno

classicalhip hop
   
 
 
   
  
  
  
 
  
  

pop
  
  
   
  
  

rock
 
  
  
   
  

techno
 
  
  
  
   

 rows are the actual genres  columns are the classified genres 

    e  scheirer  tempo and beat analysis of
acoustic musical signals  j  acoust  soc 
amer   vol       no     p            jan     
     j  foote and s  uchihashi  the beat
spectrum  a new approach to rhythmic
analysis  proc  int  conf  multimedia expo  
    
     j  friedman  t  hastie  r  tibshirani 
additive logistic regression  a statistical
view of boosting  stanford university       
     f  patkin  beat detection algorithms 
gamedev net      

fi