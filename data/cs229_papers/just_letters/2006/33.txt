are you
cs    final project
jim hefner   roddy lindsay

 

fi   introduction
we use machine learning algorithms to predict attractiveness ratings for photos  there is a wealth of
psychological evidence indicating that facial beauty is dependent on a number of factors  such as symmetry 
averageness  and proportional size of features    it is unclear  however  which of these features would be
useful for a machine to learn given a set of two dimensional images  one application that easily follows from
such a project is a web site where a user could upload a photo of themselves to find out how attractive he or
she is  or  more accurately  how internet users would rate them  without worrying about potential
consequences of having ones photo online  for example  a user could compare several different photos
and select the one with the highest score to submit to a match making website  previous attempts at using
machine learning to classify facial attractiveness have used a very regular set of images  and ratings
compiled from votes by the same group of people    we attempt to predict scores for highly variable photos 

   materials
our dataset comes from the web site hotornot com  which hosts photos submitted by users to be
rated by the public  a persons hotness is rated on a scale of one to ten  rounded to the nearest tenth 
we focused our efforts exclusively on photos of females  and we came across photos rated as high as    
and as low as      with vote totals ranging up to several thousand  training images were filtered based on
the number of votes and the positioning of the subject  we used     votes as the minimum number
required to include the photo  since we found personal estimations of attractiveness to be highly correlated
with the given ratings with that many votes  we chose photos with women facing forwards with an
unblocked face  at a resolution that would make the face still discernable when scaled to     x     pixels 
photos that featured too much of the subjects body  not just the face  were eliminated to prevent bias
unrelated to facial attractiveness  a total of     photos were collected in this manner  the dataset was then
split into a training set of size     and a test set of size    

   eigenfaces
     eigenfacesmethods
the first approach employs principle component analysis  we used the eigenfaces   method for
image processing and adapted code for the matlab implementation   following collection of the dataset 
each photo was cropped to a square which started just above the left eye and extended to the analogous
point above the right eye  to counteract the vast variability in lighting  each photo was embossed using a  pixel convolution filter  this filter is known to improve machine learned facial recognition under variable
lighting conditions    finally the images were converted to grayscale and resized to    x    pixels 

fig         an example of the embossing
procedure 

 

zimmer      
eisenthal et al       
 
turk and pentland      
 
serrano
 
kouzani et al       
 

fig         a subset of the resulting
eigenfaces 

fiwe used correlation between eigenfaces features and attractiveness ratings to find the best
eigenfaces to use as features for the learning algorithm  the maximum correlation between the coefficients
of an eigenface for the training data and the training scores was just over      expressing each face as a
linear combination of eigenfaces yields a highly variant and non linear dataset  and attempts at score
estimation using regression methods were exceedingly inaccurate  we elected to classify the data using a
support vector machine  and we used k nearest neighbors as a baseline for comparison  the training data
was separated into hot and not hot categories  with the threshold of     separating the categories  the
mean of the training set was approximately      and the median was      
to determine the number of neighbors to use for the knn and the number of eigenfaces to use as
features for the svm  we used a forward search feature selection wrapper model  features were added in
decreasing order of attractiveness correlation  from three to sixteen eigenfaces and the appropriate training
algorithm was then retrained using those k features  cross validation was used to determine accuracy 
training and testing on the sets as described above 
 
the svm was implemented via platts smo algorithm   with tolerance          c    and
max passes       the input features were the coefficients for each photo of the most highly correlated
eigenfaces and the target variables were contained in a vector of  s and   s  corresponding to whether an
input image represented a face with score        or        respectively 

    eigenfacesresults

fig         accuracy of knn when computed using vectors composed of eigenface coefficients 
raw pixel intensity  and facial geometry distance ratios 

k nearest neighbors was implemented  calculating neighbors both by euclidian distance of the pixel
intensities of the raw image files and of the feature space for the sixteen most highly correlated eigenfaces 
we calculated the knn accuracy for every number of neighbors between one and twenty  although due to
ambiguity  i e  an equal number of hot and not hot neighbors  only the odd numbers of neighbors are
statistically relevant  for the euclidian distance of the raw image files  the knn classifier was essentially at
chance         accuracy   with maximum performance at five neighbors  fig          for the euclidian
distance in the eigenface feature space  accuracy ranged from     to     depending on the number of
neighbors used  fig          while the svm did converge  it failed to make any semblance of accurate
predictions on the test data  the maximum accuracy was     and the minimum was      i e  at chance 

   facial geometry
    facial geometrymethods
the second approach makes predictions based on facial geometry  the ratio of the distances
between various points on the face   for the preprocessing  the original photos were cropped about the
face as before to remove irrelevant background  next  a matlab script was written which cycled through

 

platt     

fithe images and displayed them on the screen  using the ginput   function  each photo was tagged with a
series of    points believed to be related to attractiveness  fig        

fig        an example face tagged with the
ordered points used in the facial geometry
method 

fig        several of the features found to be
most highly correlated with facial attractiveness 

rather than select our input features to be geometric ratios based on preconceived notions of facial
attractiveness  the ratios most highly correlated with attractiveness were selected  this was done via brute
force  an algorithm was implemented which computed the ratio of the distance between every two point
subset to the distance between every other two point subset  next  correlation was computed between
each of these ratios and the given scores on the training set  several of the most highly correlated features
are displayed above  fig         the maximum correlation coefficient was       we chose eleven of the top
ratios which corresponded a diverse set of facial geometries  and their counterpart on the opposite side of
the face  for example  we would discard a ratio that included the top of the eye to the chin if the similar ratio
of the bottom the eye to the chin was already chosen as a feature 
as a baseline  k nearest neighbors was implemented measuring euclidian distance of    facial
geometry features  the support vector machine  using the smo algorithm  was then implemented for binary
classification  we also implemented linear regression for score estimation  for all three algorithms  we used
the forward search feature selection wrapper method to find the optimal number of features or neighbors to
use 

    facial geometryresults
results for the facial geometry method were a vast improvement over the eigenfaces method  knn
classified test images with a maximum of     accuracy using seven neighbors  and with a minimum of    
accuracy using nineteen neighbors  fig          the smo algorithm achieved a maximum training set
accuracy of     at                         features used  fig          which is well above chance  for linear
regression  the maximum correlation between the predicted scores and the actual scores for the test data
was       using seventeen ratios as features  fig        

fifig         predicted decimal scores vs  actual scores using linear
regression 

fig         binary classification accuracy vs  number of facial features used for both svm and
linear regression with threshold 

   discussion
with our training data  the facial geometry method was more successful in predicting facial
attractiveness than the eigenfaces method  the data was drawn from a highly irregular set of images 
slightly different head positions  facial expressions  facial blockage due to hair and glasses  and picture
resolutions greatly impacted the eigenfaces while effectively preserving facial geometry information  with
such varying images and a limited training set size  the eigenfaces generated simply were not good enough
to accurately reconstruct the input images  applying the embossing filter to all of the images in the dataset
had the positive effect of eliminating the lighting discrepancies  but it may also have eliminated facial features
that are important indicators of attractiveness  the overall low correlations between individual eigenfaces
and attractiveness indicate that a much larger training set would be necessary to utilize the eigenfaces
approach  since the data is so non linear  given these low correlations  the fact that the svm and the knn
did not score much higher than chance is not surprising 
we believe the facial geometry method performed well primarily due to the method of feature
selection  the results of the brute force method to select relevant features were surprising  whereas
psychological research indicates that humans calculate attractiveness of conspecifics using pure ratios such
as nose width to height  eye to nose distance  and chin to jaw distance  these particular features were found

fito be poorly correlated with attractiveness in our dataset  the      correlation for linear regression
estimation is comparable to the      correlation obtained by eisenthal et al  that used a highly controlled
dataset trained on the psychological features 

   conclusion
our results lead us to believe that facial attractiveness can be predicted fairly accurately with
machine learning algorithms on a diverse training set of two dimensional images  we found the facial
geometry approach to be superior to the eigenface approach   ur predicted to actual score correlation of
     is comparable to that of eisenthal et al  with a correlation of       we believe our success on a diverse
training set is due to the fact that we did not pre select the training features based on psychological
evidence  but found novel and unpredicted features by the brute force method  further research should
determine the upper boundary on score correlation by increasing the size of the training set and further
optimizing the feature selection of facial geometry 

   references
    eisenthal  yael  gideon dror  and eytan ruppin   facial attractiveness  beauty and the
machine   neural computation                     nov      
 http   portal acm org ft gateway cfm id         type pdf coll  dl acm cfid          cf
token         
    kouzani  a z   f he  k sammut  and a bouzerdom   illumination invariant face recognition  
ieeexplore org        edith cowan university     nov      
 http   ieeexplore ieee org iel                      pdf arnumber         
    platt  john  fast training of support vector machines using sequential minimal optimization  in
advances in kernel methods  support vector learning  b  scholkopf  c  burges 
a  smola  eds   mit press        
    serrano  santiago   eigenface tutorial   drexel university  drexel santiago     nov      
 www pages drexel edu  sis   eigenface   tutorial htm  
    turk  m  and a  pentland          face recognition using eigenfaces   proc  ieee conference on
computer vision and pattern recognition        
    zimmer  a   beautycheck         universitat regensberg     nov        http   www uniregensburg de fakultaeten phil fak ii psychologie psy ii beautycheck english bericht beauty mi z
ensiert pdf  

fi