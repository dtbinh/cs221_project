beat induction
peerapong dhangwatnotai  rajendra shinde  pawin vongmasa
  th december     
abstract
previous works       have focused on finding the tempo and the beats in music given the entire
signal as input  the goal of this project is to find an online algorithm for real time beat detection 
our approach is to discretize the audio signal into short frames and make a prediction on whether
the current frame is a beat or not depending on the current and previous frames  we propose
a novel two part classification system for beat detection  the first part of the prediction uses
a classification algorithm such as logistic regression and support vector machines to predict the
probability of the current frame being a beat  the second part involves the use of the temporal
location of the previous beats to predict the probability of the current frame being a beat  thus
while the prediction of the first part is based on the current features  the prediction of the second
part is based on the onsets of beats in the past 

 

introduction

when we listen to music  we never find any difficulty in tapping along the beat  but how exactly do we
do that  is it possible to make the computer do the same task  for a couple of years  the problem of
automated beat induction has been studied as a step toward better understanding of human perception 
many models have been proposed for beat perception  none of which are perfect  and there is a general
consensus that it is impossible to find a perfect model because the formal definition of beats does not
exist  because of this intrinsic ambiguity in the notion of beats  it is fair to expect a beat induction
algorithm to work on a set of specific assumptions regarding beat period or specific inputs  possible
applications include music classification based on rhythm  synchronizing machine accompanists with
human performers  and in automated transcription systems  visualizations to music 

 
     

background and related works
beat induction algorithms for symbolic input

many researchers have tackled the problem of beat induction from different levels and with different
approaches  longuet higgins and lee      were the first to initiate the idea of beat induction on
symbolic input  beat onsets have been annotated   after this there have been many algorithms based
on input in midi format which use onset information and inter onset intervals  iois  meaning the
time intervals between onsets  and other features to build up hypotheses of beats  desain       gave
good comparisons and discussions on some prominent algorithms by longuet higgins and lee          
     

the role of machine learning

recently  gouyon et al        viewed the problem differently  and showed that the best indicator for
identifying whether a beat occurs in the given time framed signal or not are energy features  they got
this result from running ten fold cross validation to choose the most relevant features   note that this
is a classification problem where the given query is a short signal and the expected result is whether
this signal indicates a beat or not   this shows us not only that we can use energy features and get
a good prediction  but also that it is not necessary to depend on onsets or iois we can determine

 

fithe beat by seeking periodicity in other features as well  however  we will still need to take iois into
account in order to get the most probable tempo among its multiples 

 

database

we used the database for the mirex       which is a contest for music information and retrieval 
the database can be obtained at  http   www music ir org mirex     index php main page   this
database consists of a set of    music files  each having a sampling frequency of     khz and each being
of    sec duration  the temporal beat locations derived from    different listeners for each music file
have been specified in text files 

 

the online beat induction problem

the following is our formulation of the online beat induction problem 
the signal of a piece of music  represented as a discrete sampling of the original performance  is
grouped into overlapping frames  each frame contains      samples  which is about        seconds 
given frame   up to frame t  determine whether frame t is a beat 

 

difficulty of beat induction

the beat induction problem is different from conventional classification problem in many aspects 
first  there is no single right answer  humans perceive beats at different metrical levels  one may
perceive a beat with   second interval  another may perceive a beat twice as fast  this is evident in
the mirex      dataset we use in this project  for each piece of music  there is       sets of labels 
each from a different person  for some set of labels  there are twice as many beats as another set 
it is impossible to train a classification algorithm with all of the labels because obviously some are
contradictory  this is different from having noisy labels because the problem inherently has many sets
of correct answers 
the way we get around this is by creating a standard set of labels  let bij denotes whether
person i thinks
frame j is a beat  bij     if person i thinks frame j is a beat and bij     otherwise 
p
the sum i bij   j counts the number of people who think frame j is a beat  then in our standard
set of labels  frame j is a beat iff j   max j      this should capture the beats at the most salient
metrical level  according to the consensus  
another property of beat induction problem is that the correct set of beats must have a constant
inter beat interval  this is another constraint that conventional classification problem does not have 
below  we suggest an idea about this but do not have time to fully explore this aspect 

 

our approach

we break this problem into two parts  first  we assume that it is possible to tell  with high probability 
whether the current frame is a beat given the current frame and the last two frames  we want to
compute p beat   the last three frames   this is just a classification problem and we have tried
applying svm and logistic regression to it 
however  it is not always possible to tell whether the current frame is a beat given just the last
three frames  or    or    frames   for example  a silent frame  a frame with almost no sound  can
either be a beat or not a beat depending on the previous beats  human perception of beats continue
even after the signal disappears  this can be translated into the constraint that inter beat interval is
constant  therefore  we also need to model p beat   onsets of previous beats   then combine the two
parts together 
in this report  we will show how we tackle the first part and propose models for the second part 

 

fi   

the first part

features
we design our features using subband energies which have been reported as being a good feature
for beat detection        more specifically  each frame is converted to the frequency domain using fast
fourier transform  the energy of each frequency is the norm of its coefficient  the frequencies are
group into    subbands and the energy of each subband is the average energy of the frequencies in
that subband  then we compute the ratio of each subband energy to the moving average  let eti be
the energy of subband i at time t  the energy ratio of subband i at time t is
k  et
rit   pk itj
j   ei

   

where k is the size of the period that we average over  in the experiment  we use k       when t is
small  we dont have that much data in past   k is t    
the feature set for each frame is the subband energy ratios of the last three frames  formally  it is
 r t   r t        rnt   r t    r t         rnt    r t    r t         rnt    
classification algorithm
we tried svm and logistic regression as the classification algorithm  we did not get a good
result from svm  we have tried svm with a polynomial kernel of degree up to   and the results are
unsatisfactory  svm almost never classifies a frame as a beat  for this reason and the training time
consideration  we decided to continue working with logistic regression 
we trained logistic regression using batch gradient descent and the features described above  the
data is obtained from mirex       the signals are down sampled to       hz      of the data is
used for training and     is used for testing 
 
 
 

 

   

 

   

 

   

beat prob 

 
   

classification

 
   

 

   

 

   

 

 

   

 

   

 

 
   
 
   

figure    a sample run of the beat detection algorithm  the top plot is the audio signal  the middle
plot is the beat probability  the bottom plot is the classification  whether the probability is greater
than     

 

fi    
    
    
 
    
    
    

   

   

   

   

figure    comparison between the programs output and the label  the x axis is time  the circles
are the beats labeled by human  the dots are the beats output by the program 

   

the second part

after we have got the probability of the current frame for being a beat or not  we will incorporate
this with our guesses made in the past to make a better guess according to the long periodic nature of
beats  we models dependency of the present and past data by the following equations 
  pt 

fi
fi  
fibp      bp    t  fip    p 
t   t    

  tt   t  

s t  t  

 

 

t   t 

 

argmax s t  t  

   
   

t

bp  t 


  s t  t   t  bp  t  t   t        s t  t   t   h x t  

   

where t    t       and p are parameters  their meanings are as follows 
 t  and t  are the minimum and the maximum number of frames corresponding to the fastest
and the lowest tempi respectively   we choose t      and t       to indicate the tempo between
   and     beats mean minute  
  determines how far in the past we will consider  it must be a positive integer   we use     
in our experiments  
  determines how much we will depend on the past data  it must be a number between   and   
 we use        in our experiments  
 p indicates the way we measure the vector  it is analogous to p norm of the vector  we used
p     in our experiments 
 
equation     defines the tempo probability t at the time t  it can be seen that if bp repeats itself
with period t   s will have a high value  equation     picks the most probable period t    finally 
equation     computes the beat probability by putting the weight between the predicted value of the
current frame h x t   and the past data bp  t  t   t   

 

fi 

results

for the first part  logistic regressions accuracy over the test set  which includes    pieces of music  is
        a sample run of the beat detection program on a piece of music is shown in figure    it is more
fun and more intuitive to listen to the music while looking at the programs output  unfortunately  we
cannot embed audio into this report  the algorithm can pick out salient acoustic cues of the beats but
fails on the more subtle ones  when used with the second part  we got the result as shown in figure   

 

discussion and future works

the subband energy ratio is an informative feature for beat detection  while the logistic regression
with subband energy ratios achieves the accuracy of         it still misses many of the beats as shown
in figure    this is expected because the algorithm is local  i e  it only looks at signal around the
current frame  about     seconds   but beats have long range influence on one another       seconds  
an algorithm that uses the information from previous beats such as the one proposed in the second
part should improve the accuracy  this can be an item for future work 

references
    h  c  longuet higgins and c  s  lee  perception of musical rhythms  perception       
    p  desain and h  honing  computational models of beat induction 
proach journal of new music research       

the rule based ap 

        c  s  lee  the rhythmic interpretation of simple musical sequences  towards a perceptual model 
musical structure and cognition       
        f  gouyon  g  widmer  x  serra  and a  flexer  acoustic cues to beat induction  a machine
learning perspective       

 

fi