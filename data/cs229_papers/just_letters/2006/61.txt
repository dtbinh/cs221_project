just keep flying  machine learning for uav thermal soaring
cs     final project
geoffrey bower and alexander naiman
introduction
unmanned aerial vehicles  uavs  have recently become popular for aircraft missions
that would be dangerous or exceedingly boring for human pilots  one potential application of
uavs is for extremely long endurance missions  such as for military surveillance or for
commercial use as atmospheric satellites  for this reason  extending the endurance of uav
flight is currently an area of major research interest 
one way to extend the duration of a uav s mission is to take advantage of energy
available in the atmosphere in the form of wind velocity gradients  or wind gusts  by adjusting
an aircraft s attitude  speed  and direction of travel when it encounters a gust  a properly
trained pilot can greatly extend the duration of a flight  even indefinitely if enough wind energy
is available  glider pilots  radio control aircraft pilots  and birds all use these gust soaring
techniques to reduce the amount of propulsive energy required to stay in the air 
designing an automatic control system to take advantage of atmospheric energy for
extending mission duration is a very difficult problem  the flight environment is not easily
predictable  and gust detection equipment such as doppler radar and lidar is prohibitively
expensive in both dollars and power usage  these issues make this a perfect problem for
utilizing a machine learning algorithm with simpler sensors inputs 
this project considered vertical thermal updrafts and how to best control the velocity
and bank angle of the aircraft to extract the most energy from them  the goal of this project
was to use reinforcement learning to determine control laws that lead to the longest duration
flights on average  the control law inputs were based on sensors that can be placed on a
small uav  the aerodynamic properties and dynamics of a small uav were modeled and
used in a simulation with the control laws  a thermal model developed at nasa dryden was
used to model thermal generation based on the time of year  time of day and local
atmospheric conditions 
current research undertaken using the thermal model in maximizing duration of uavs
at nasa has used heuristics to search for thermals and then makes a number of
assumptions about tracking and centering in the updrafts     sec to center  then fly at optimal
radius   through reinforcement learning  improved performance should be obtainable without
relying on heuristics to search for and self center in thermals 
thermal model
for this project  choose to use a thermal updraft model developed by allen at nasa
dryden  ref       for a similar autonomous uav soaring project  this model was developed
using atmospheric data collected by the noaa in nevada using rawinsonde balloons
released every    hours over the course of a year 
thermal updrafts form when an air mass close to the ground is warmed and becomes
unstable  this air then begins to rise and cool until it reaches equilibrium with the surrounding
atmosphere  conservation of mass dictates that this rising air be replaced by generally
sinking air outside the thermal updraft  allens model provides the variation of the velocity and
height parameters that characterize thermals  and also provides for the proper spacing and
duration of thermal updrafts 
for this project  we used allens model to create a dynamic field of thermal updrafts of
various characteristic heights  velocities  and durations inside a specified test area for one
hour  which the uav was constrained to fly inside  figure   shows an example of such a field

fiat a particular time during the simulation  where the wireframes indicate the extent of positive
updraft velocities  allens model of the ground assumes a uniform radiative heat flux over the
test area  in the real world  thermals are more likely to be formed over certain ground
features that radiate a lot of heat to the air  for example  paved parking lots  a possible
modification of this model would increase the probability of thermals forming over certain
parts of the test area and decrease the probability over other parts  this would likely have a
significant impact on the machine learning aspects of this problem  as the uav would
hopefully learn to look for thermal updrafts in more likely areas  this modification is beyond
the current scope of this project  however 

figure    sample thermal updraft field
dynamics model
the airplane we modeled was based on a small unmanned glider built by a stanford
student  chinmay patel  for his research on autonomous soaring through high frequency
gusts  this airplane was chosen because it is currently outfitted with an autopilot system and
sensors  so as time permits the learned control algorithm could be tested on real hardware 
the dynamic modeling of this airplane was simplified so that rapid simulation could be
performed  the glider was modeled as a point mass with a simple parabolic drag polar 
based on the lift coefficient  bank angle  and updraft velocity  the flight path of the glider can
be determined as well as the inputs to the control law at the next time step  the control
outputs were the desired lift coefficient and the bank angle of the airplane 
sensors present on the airplane that were used as inputs to the control laws are the
gps position  x y z   gps velocity  u v w   airspeed  v  and bank angle     all sampled at  
hz  some constraints were placed on the changes in the control output that are related to the
dynamics of the actual airplane  these limits relate to the maximum pitch rate and roll rate of
the actual airplane  the important properties of the airplane are tabulated in table   
this simple model captures the dynamics of the real airplane fairly accurately  but the
assumptions create some short term dynamic differences from the real airplane  unsteady
and non linear aerodynamics along with control transients limit the accuracy of the model in

fithe regions of maximum control input  for this reason conservative constraints were placed on
the pitch rate and roll rate 
table   airplane properties
   
mass
      kg clmax
 
wing area
      m
   deg
max
effective aspect ratio  eo ar     
 dcl dt max      sec
cd 
     
 d  dt max
   deg sec
control strategy
due to run time constraints for this project  we chose a simple objective that would
allow rapid simulation  the selected objective was to maximize the altitude of the uav at the
end of an hour of simulation  this rewards control strategies that find the most thermals and
center as quickly as possible in them to gain as much altitude as possible 
the control algorithm used in this project was based on a simple online learning
strategy  the uav attempts to find the strongest thermal updraft that it can and stays in it as
long as possible  thereby gaining as much altitude as possible  to implement this strategy 
we used a value function based algorithm to estimate the vertical velocity at each point within
the flying area  a separate control policy was then used to command the uav to fly to the
point within the flying area with the greatest expected vertical velocity 
more specifically  the online learning algorithm discretizes the flying area into    meter
square cells  initially  the expected vertical velocity in each cell is randomly set to a negative
or very small positive value  between      and      m s   the uav can sense its own vertical
velocity with gps at each time step  as it flies  it updates its estimate of the vertical velocity
of each cell that it enters to be the current measured velocity in that cell  if it reaches its target
cell and finds a negative velocity there  it re randomizes the estimates of the vertical
velocities in all of the cells that it has not visited yet  figure   shows an example of a value
function field  note that the path of the uav is clearly visible among the noise of the
randomized  un visited cells  and that the location of thermals as plateaus of vertical velocity
are also clearly visible 

figure    sample value function field

fibecause the updrafts have a finite lifetime  the value function estimate of a particular
visited cell becomes less and less accurate depending on how recently the uav has visited
it  to reflect this increasing uncertainty with time  a discount factor of       was applied at
each time step such that the estimated velocity of each cell gradually decays toward zero 
in our dynamics model  we have two control inputs to the flight path of the uav  bank
angle to control turning and lift coefficient to control speed and ascent descent rate  the bank
angle control policy used simple open loop controller to control the heading  commanding the
uav to fly toward the desired point  the lift coefficient control policy  on the other hand  can
greatly affect the performance of the overall algorithm  the optimal control policy will
generally decrease the lift coefficient when outside a thermal updraft  increasing the flight
speed and covering more area  which increases the chance of finding an updraft 
to find this optimal control policy  we implemented a policy search algorithm to
maximize the altitude of the uav after one hour  the policy family consisted of a linear
combination of vertical velocity  bank angle  and a constant  c l   aw  w   a     b   we used
the stochastic gradient ascent algorithm to optimize these three coefficients  fifty simulations
were performed for each policy at each step of the optimization  and the reward for a
particular policy was taken to be the average final altitude of the fifty simulations 
results
this control strategy worked very well in our simulation  two important parameters
characterized each simulated flight of the uav  whether the uav found a thermal updraft 
and if it found an updraft  whether it was able to avoid hitting the ground for the entire hour 
the chance that the uav will find a thermal if it flies in a straight line across the flight area is
approximately     based on the thermal model  the sink rate of the uav is approximately
     m s  depending on its lift coefficient  so if it fails to find a thermal in its first five minutes
from its initial altitude of     m  it will hit the ground  if it finds a thermal  however  its chances
of staying aloft greatly increase  it is for these cases that the control policy has the greatest
effect  since the policy affects how the uav reacts when it finds a thermal updraft  figure  
shows an example flight path in red  with thermals in blue  the uav has found two thermals 
centered itself in their cores where the highest vertical velocities are found  and spiraled
upward as high as possible 
we ran two of our control policies  the initial one from which stochastic gradient ascent
was run and the final optimized policy  for      simulations each in order to gauge their
average performance  the initial and final policies are summarized in table   below  for the
initial policy  the uav found thermals in       of the simulations  when it did find at least
one thermal  it stayed aloft for the whole hour in       of the simulations 
table   control policy
aw
initial
   
after    iterations of policy search      

a
    
     

b
    
     

for the optimized policy  the uav found thermals in     of the simulations  when it
did find at least one thermal  it stayed aloft for the whole hour in       of the simulations  we
conclude from these results that our policy search greatly increased the efficiency of our
control of lift coefficient  allowing the uav to stay aloft for longer flights 

fifigure    sample simulated flight path
future work
several avenues are open for future work on the subjects that this project explored  as
mentioned above  increasing the complexity of the thermal and aircraft dynamics models
would help to increase the realism of the simulation  additional control strategies could be
explored  and the policy search could be refined  we also hope to eventually test the control
algorithm on a real uav platform 
acknowledgements
thanks are due to professor ilan kroo for advice on how to proceed with this project 
and to chinmay patel for providing his airplane as the basis for our model 
references
 
allen  m  j   autonomous soaring for improved endurance of a small uninhabited air
vehicle  aiaa              rd aiaa aerospace sciences meeting and exhibit  reno 
nevada        january       
 

allen  m  j   updraft model for development of autonomous soaring uninhabited air
vehicles  aiaa              th aiaa aerospace sciences meeting and exhibit  reno 
nevada       january       

 

wharington  j   autonomous control of soaring aircraft by reinforcement learning  phd
thesis  royal melbourne institute of technology  melbourne  australia  november      

fi