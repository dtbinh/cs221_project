combination of experts approach to image boundary detection
david cohen and jim rodgers
 dscohen jimkr  cs stanford edu

december         

  introduction and background

vide better inputs for image segmentation  alternatively 
it may allow us to combine the image segmentation alboundary detection in two dimensional images is an im  gorithms boundary output with other boundary detection
portant problem in computer vision  there are a wide va  algorithms outputs for even better results 
riety of algorithms to accomplish this task  but none have
come close to human proficiency  we explore a variety of
  methodology
ways to use machine learning algorithms to combine existing boundary detection algorithms with the goal of ex  our goal is to predict which pixels in an image fall are
ceeding the performance of any particular algorithm  we edges between objects in that image  unfortunately  as
present methods using adaboost and linear regression and noted above  there is no clear definition of an edge in an
show favorable results produced by them 
image  further  even when human beings agree on edges 
boundary detection is a classification problem which they often disagree on precisely which pixels in an imentails labeling a subset of pixels in an image as part of age correspond to them  to account for this  we use soft
an edge that separates two objects  however  there is boundary maps computed from the edges selected by a
no clear definition for which objects should be separated  number of human subjects as our ground truth  similarly 
the most common approach is to attempt to find a set of we use our algorithms to produce soft edge maps  which
edges which a human being would consider reasonable  we evaluate by applying various threshold values  thinnonetheless  for any given image  there may be disagree  ning wide edges  and measuring the quality of each of the
ment among human beings as to what set of edges best resulting thin hard edge maps  we evaluate these edge
captures the image  additionally  while some boundary maps using precision  recall  and f score  where 
detection algorithms impose hard boundaries  others instead provide probabilities that each pixel in an image is
precision  
part of an edge 
p  point is an edge in the ground truth image 
boundary detection  an active research area within the
point is predicted as edge     
artificial intelligence field of computer vision  has a variety of applications to higher level vision tasks  many
recall   p  point is predicted as edge 
object recognition algorithms use image boundaries as inputs  furthermore  boundary detection algorithms help
point is an edge in the ground truth image     
show the precise orientation of an object in space  which
   precision  recall
is useful for robotic manipulation tasks  this approach to
   
f score  
precision   recall
boundary detection is particularly interesting to us  since
plotting precision and recall for each threshold value
we are working on an mrf based image segmentation
algorithm that takes the output from a boundary detec  produces a curve which characterizes an algorithms betion algorithm as its input  thus  this project could pro  havior  and the maximum f score of the data points plotted
 

fiyields a single number which summarizes the algorithms exp fdist  x  y  e    v  where v is the variance of our
success 
gaussian distribution  we experiment with several such
variances 
in constructing training sets  we vary the ratio of edge
  experts and features
pixels to non edge pixels in our training set  we create
non balanced training sets by randomly sampling pixels
we combine the results of currently existing boundary de  from our training images  and we label a pixel as an edge
tection algorithms to produce our edge predictions  we if it falls within a one pixel radius of any pixel with a
assemble a large number of boundary detection algo  non zero value in the ground truth edge map  these trainrithms and experiment with methods of combining them ing sets are composed of approximately     edge pixels
to produce a single boundary map  our set of boundary and     non edge pixels for each image  we also create
detection algorithms currently includes six hard threshold balanced data sets by sampling     edge pixels and    
classifiers which produce logical boundary maps  and non edge pixels from each image 
five probabilistic classifiers which produce soft boundary
maps  associating each pixel with the probability it is an
edge  some of the soft edge maps are drawn from        learning algorithms
five of the hard threshold methods and all of the softthreshold methods approximate gradients in the image we explore several learning algorithms to combine the
and predict edges at points which correspond to local predictions of our experts  the two most successful
maxima of the gradient  the two remaining detection of these was real valued adaboost  followed by leastmethods are a laplacian of gaussian algorithm which se  squares linear regression  real valued adaboost is an itlects points where the laplacian of the image changes erative algorithm that converts features into classifiers by
its sign  and felzenszwalbs graph based image segmen  choosing the specific feature and threshold with maximal
tation algorithm     which merges regions of an image performance on a weighted version of the training set  for
based on their variations in intensity  by varying the pa  example  one such classifier might be 
rameters of these algorithms  such as threshold values and

filter sizes  and by varying the image channel on which
edge
if feature k   threshold t
these algorithms are run  red  green  blue  or grayscale   prediction  
non edge otherwise
we produce    different edge maps for each original image  we call each parameterization of a boundary detector at each iteration  adaboost reweights the training set to
increase the importance of data instances misclassified by
on each image channel an expert 
in order to learn from our experts  we consider the the newly chosen classifier  the result of running adproblem of classifying a single pixel as an edge or non  aboost for n iterations is a linear combination of n classiedge point based on its treatment in the experts edge fiers  with coefficients determined by the accuracy of each
maps  since each expert produces one edge map per im  classifier on the weighted data set  this linear combinaage  it contributes exactly one feature for each pixel  we tion of classifiers is then applied to test data 
experimented with three different methods for extractthe other successful algorithm we find is least squares
ing features from experts edge maps  let fa  x  y  e  linear regression  which finds the linear combination of
be the feature extracted by algorithm a from expert e the features that minimizes the squared error of featurefor pixel  x  y   and let me be the edge map produced value predictions  unlike adaboost  which attempts to
by expert e  in our first feature extraction method  di  directly classify data instances  linear regression estimates
rect extraction  fdirect  x  y  e  takes the value me  x  y   an arbitrary real valued function with a line through dfor euclidean distance extraction  fdist  x  y  e  has the dimensional space  where d is the number of features  we
value of the euclidean distance in me between  x  y  use linear regression to estimate the same features in the
and the nearest edge pixel in the edge map  in gaus  test data that we calculate in the training data  raw pixel
sian distance extraction  fgaussian  x  y  e  takes the value value  euclidean distance  or gaussian distance 
 

fioriginal image

ground truth

adaboost result

linear regression
result

figure    sample results of running adaboost and linear regression on the original image  and a comparison with the
human generated ground truth 

  results

over balanced datasets scored at or above       and all
adaboost runs with non balanced training sets scored at
or below       we believe that this result arises from the
ratio of edge points to non edge points  rather than the absolute numbers of edge or non edge points  as evidence 
we note that our f score on a balanced gaussian distance
dataset  with standard deviation of   pixels  only dropped
by      when we halved the number of training examples used  this highlights the distinction between our objective function  the accuracy  and our evaluation mechanism  the f score  the distinguishing characteristic of the
f score is that it completely ignores true negatives  the
number of non edge points correctly classified by an algorithm does not affect its f score  though misclassifying
non edge points as edge points does lower an algorithms
f score  the f score captures the intuition that edges are

we train and test our algorithms on twenty images from
the training set and test set  respectively  provided by the
berkeley segmentation dataset      figure   shows a
sample of our results on some of the images  we find
that adaboost performs the best of all the algorithms  both
visually and according to the f score  when trained on
a balanced data set based on gaussian distance features
with a standard deviation of   pixels  adaboost achieved
an f score of       we note that this exceeds the f score of
our best expert by       but also that this particular expert
achieved that score when tested on a     image test set 
this indicates a small performance gain over the baseline 
we find that the most significant factor in our success
with adaboost was the use of a balanced training set  observing that all of our experiments with different features
 

fimore important than non edges in an edge map  and accounts for the fact that the number of edge points in an
image varies linearly with its scale  whereas the number
of non edge points varies quadratically  adaboost yields
similar accuracy on both types of training sets  but both
the f scores and the visual appearance of the results on
non balanced sets are inferior 

 

precision

    

   

least squares linear regression produces results that
are not as good as those we obtain with adaboost  see
figure     but are nonetheless reasonable  the composi    
tion of the training set has little impact on the results  we
believe that this is consistent with the non classification
nature of linear regression  the idea of balancing the
f      adaboost  gaussian dist  balanced set
training set between edges and non edges is less meaningf      linear reg  gaussian dist  balanced set
ful when dealing with an algorithm that does not attempt
 
 
    
   
    
 
to match edge non edge labels  but rather match the realrecall
valued feature that corresponds to any given ground truth
pixel  linear regression performs similarly with gaussian figure    precision and recall curves for best adaboost
distance and direct pixel values as features  it performs and linear regression results  adaboost performs better
very poorly with euclidean distance as a feature  yield  than linear regression
ing edge maps that predict edges almost everywhere  we
achieve the best results        with gaussian features and
standard deviation of   pixels  figure   shows precision    conclusion and future work
recall curves for adaboost and linear regression using
different training sets and feature composition 
we conclude that adaboost is a suitable method for combining expert predictions for the image boundary detection problem  not only does it appear that our current
in addition to adaboost and linear regression  we adaboost classifier may perform better than all of its comexplore support vector machines  svms  and locally ponent experts  we have yet to confirm this by testing on
weighted linear regression  neither produce acceptable the full berkeley test set   our findings also offer several
results  we train svms  using the svmlight package      avenues for further improvement  first  we achieved a
on balanced and unbalanced data sets using pixel values large improvement by changing the composition of our
and euclidean distance features and obtain very poor re  training set  but have not attempted to find the optimal
call scores  furthermore  we find a large number of sup  training set edge to non edge ratio  further exploration
port vectors during svm training  which hurts svm per  of training set composition may continue to improve our
formance  locally weighted linear regression yields no results  second  we found significant f score differences
obvious visual differences from standard linear regression based on the variance used for gaussian distance features 
when run with a wide variety of bandwidth values  while and would like to find the optimal variance using crossmassively increasing runtime  whereas standard linear validation  furthermore  we currently optimize the accuregression produces only one set of parameters  locally racy and evaluate performance on the f score  but boostweighted linear regression learns new parameters for ev  ing may allow us to optimize the f score directly  and thus
ery pixel in the test set  and thus appears intractable in the improve our results  also  we wish to incorporate knowledge of the softness of our ground truth edge maps by
context of edge detection 
 

fif     

f     

f     

f     
 

    

    

    

    

    

   

    

   

    

f                   t     
 
 

    

   
recall

   

    

f                   t     
    

 
 

 

    

   
recall

   

    

 
 

 

    

   
recall

   

    

f                   t     

f                   t     
    

precision

 

precision

 

precision

 

precision

precision

f     
 

    

 
 

 

    

   
recall

f                   t     

    

 
 

 

    

   
recall

    

 

 a  adaboost  gaussian dis   b  adaboost  euclidean  c  adaboost  direct pixel  d  linear regression  gaus   e  linear regression  ditance  balanced set  f       distance 
balanced
set value  balanced set  f       sian distance  balanced set rect pixel value  balanced set
 f      
 f      
 f      
f     

f     

f     

f     
 

    

    

    

    

    

   

    

   

    

f                   t     
 
 

    

   
recall

   

    

f                   t     
    

 

 
 

    

   
recall

   

    

 

 
 

    

   
recall

   

    

f                   t     

f                   t     
    

precision

 

precision

 

precision

 

precision

precision

f     
 

    

 

 
 

    

   
recall

f                   t     
    

 

 
 

    

   
recall

    

 

 f  adaboost 
gaussian  g  adaboost  euclidean  h  adaboost  direct pixel  i  linear regression  gaus   j  linear regression  direct
distance  unbalanced set distance  unbalanced set value 
unbalanced
set sian distance  unbalanced set pixel value  unbalanced set
 f      
 f      
 f      
 f      
 f      

figure    precision recall curves and their maximum f score for different combinations of features and training set
composition  best performance is with adaboost  gaussian distance  and a balanced training set 
weighting edge pixels by their ground truth pixel values 
tern analysis and machine intelligence           
and thus force our algorithm to favor correct predictions
          
on the stronger edges  finally  we wish to gather more experts for use in adaboost and explore more methods for     p  felzenszwalb and d  huttenlocher  efficient graphbased image segmentation  international journal of
extracting features  adding more experts and features  escomputer vision              
pecially ones significantly different from those currently
used  may improve the resulting edge maps 
    t  joachims  making large scale support vector machine learning practical  in a  smola b  scholkopf 
c  burges  editor  advances in kernel methods  sup  acknowledgements
port vector machines  mit press  cambridge  ma 
     
thanks to steve gould  gal elidan  and ben packer for
providing helpful feedback and suggestions 
    d  martin  c  fowlkes  d  tal  and j  malik  a
database of human segmented natural images and
its application to evaluating segmentation algorithms
references
and measuring ecological statistics  in proc   th intl
conf  computer vision  volume    pages        
    d martin  c  fowlkes  and j  malik  learning to dejuly      
tect natural image boundaries using local brightness 
color  and texture cues  ieee transactions on pat 

fi