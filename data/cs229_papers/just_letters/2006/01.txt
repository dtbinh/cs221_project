auto tagging the facebook
jonathan michelson and jorge ortiz
stanford university     
e mail  jonmich stanford edu  jorge ortiz stanford com

introduction
for those not familiar  the facebook is an extremely vast social networking web service for college students 
users can present contact information  retain lists of friends  and upload images to a personal online album using
the service  and can even tag regions of those pictures where their friends appear  essentially putting names to
all the faces  many users have uploaded hundreds  sometimes even thousands  of fully tagged pictures of
themselves and others  however  the tagging process is tedious and time consuming  and as such our goal was to
implement a machine learning algorithm for quickly and automatically tagging newly uploaded pictures 
to develop the automated tagging feature  our implementation was essentially divided into three parts 
   data acquisition
   face detection
   face recognition
we will therefore address each part in turn  we note that  while our motivating example is the facebook  the
methods for detection and recognition used here could be applied to any area requiring object detection and
recognition  which is the reason so much research is being conducted in this field 

data acquisition
though there are many online face databases  most focus on specific features of face recognition  e g  lighting 
angle  etc    and almost none contain the portion of the face we were interested in  furthermore  these databases
are usually produces from images taken in strict  controlled environments  and do not provide the range of faces
we expect to encounter  therefore  the decision was made to create our own face database  which we
accomplished by extracting thousands of faces from images off the internet  a further benefit of this choice was
that most pictures on the web exhibit a huge variety of poses  lighting conditions  and people in general 
presenting both a greater challenge in terms of identification but also a greater variance with which to train data 

face detection
method
it was decided from the outset that based on the variance and complexity of our dataset  every image is a    dimensional vector  and each pixel is a     dimensional multinomial   that a generative model would be more
appropriate for the task of face detection  previous research in the area supported this conclusion  and a mixture
of factor analyzers approach was taken  while a rigorous mathematical treatment of the subject can be found in
     only an extremely simplified understanding is presented here 
standard factor analysis basically proposes that a set of vectors can actually be reduced to a linear transformation
of a much smaller random vector  plus some noise  the mixture of factor analyzers model  on the other hand 
supposes that there are several of these latent vectors  each with a different mean  that contribute with certain

fiprobabilities to the final images  while at first this may seem extremely complex computationally  an efficient
em algorithm exists for solving the problem     

data set
for our face detection algorithm we first manually cropped     images of faces from our face database  such that
the smallest square containing both the eyes and mouth was used  we then took each face  and randomly rotated
it by up to    degrees and zoomed in our out by a random factor of up to      we did this five times per image 
then mirrored the image and repeated  for a total of    images per face  finally  we scaled the image down to a
  x   image and loaded it into our face matrix  in total  we ended up with      faces    
we then derived non face images by taking    extremely large images of random objects  such as mountains 
cars  maps  and horses  then taking random section of random sizes from those images and applying similar
transformations to them as we did to our face images  in this way we generated a sample of       non face
images 
finally  we broke our data up into training and testing samples for both faces and non faces  the training  
testing splits were            and             for faces and non faces  respectively    

experimental results
on our first attempt  we began our training with the same set of specifications as in      first  we used pca to
reduce each image from     dimensions to     following that  we tested the mixture of factor analyzer model
with    factors and a latent dimension of     finally  we tested this model on the training set of non faces to seek
a threshold value for the log likelihood  such that any new vector tested could be classified based on whether it
satisfied the threshold or not  this method failed 
despite thorough testing with almost every combination of the parameters  no setting could be found that
achieved acceptable results  we inevitably ended up with the same threshold trade off curve  and though setting
the pca dimension reduction to    instead of    pushed the curve as far down as it would go  no threshold setting
achieved an adequate success rate  as even trying to keep the false detection rate below     resulted in    
missed faces  which would be unacceptable for our application  our second approach proved far more successful 

 
 

in our post processing step  images that were not square or could not be adjusted to   x   were discarded
we randomly chose      images from the remaining      to examine

fifor our second attempt  an approach similar to that taken with nave bayes was used  wherein we decided to fit a
mixture of factor analyzers not only to the faces set  but also to the non faces set  once given a new vector  we
would ask both models what the likelihood of their generating that vector is  and classify based on which is
higher  at its best  this method yielded a false detection rate of       with a successful face detection rate of
     this was achieved with a pca reduction to a    dimensional space  followed by a mixture of   
gaussians each with latent dimensionality    
though initially it proved extremely slow to test the log likelihoods of a new vector  it was discovered that the
majority of the processing time went into matrix inversion and determinant computation  both operations that
were independent of the vector being tested  therefore those values were pre computed  and calculating the log
likelihood of a new vector was cut down to a        second process    
given the relatively high success rate  a new image was processed in the following way  a square of varying sizes
 based on the input image size  scrolled   over the entire image  testing each sub image it came across  once
completing the scan  we multiplied the square by     and repeated the process  continuing to do so until the square
became over   times its original size  we note before proceeding that this is by far and away slower than the
actual testing process  and for actual application a superior method of examining the photo would be needed to
have auto tagging work in an acceptable amount of time 
once a scan completed and log likelihoods determined  sub images that our algorithm classified as faces were
clustered together by first conjoining any overlapping sub images of different sizes  then clustering any
overlapping images of like sizes  the results are best demonstrated with examples 

 

tested by dividing the time it took to calculate       log likelihoods of vectors drawn from both our face
and non face databases
 
the scrolling was done in a deterministic  iterative process  where each iteration involved shifting the
square either  of its size to the right or downward  eventually covering the entire image 

fithe face detection algorithm at work  for judy denchs image the algorithm
seems to be successful  while for bush and kerry we note the damage that false
positives could cause 

comparison with previous work
yang  kriegman and ahuja        claimed to experience superior success with a similar algorithm  one that
employed a threshold technique instead of a classifier comparison  however  it is important to note that both their
training set and their testing set involved almost perfectly aligned faces  while our database  drawn from real
images  involved faces with significantly greater variance  this distinction is further exaggerated by their results
on     images drawn from the internet  where they experienced an       success rate with    false detections 
which suggests great limitations on their input range  finally  they began their set with      manually cropped
and perfectly aligned faces  while we began with roughly half that 

face recognition
method
for the facial recognition aspect of the tagging process we were hopeful that a combination of principal
component analysis and linear discriminant analysis could achieve satisfactory results  with the success of the
face detection algorithm  we believed we could automatically locate the key eye mouth portion of the face  which
would in turn allow us to ignore much of the variance present in an image with a background 

data set
two data sets were used  the first was a set of     images of nine different subjects  with each image being
   x    pixels and having a roughly centered face  these images were not cropped 
the second data set contained     images of the same nine subjects  each manually cropped to contain only the
eyes and mouth  they were then scaled to be   x    so as to simulate the results of a perfect face detector 

experimental results
since similar experiments in the literature used only a small number of images per person to form a training set 
we followed suit and selected between five and eight images per person  as in      pca was run on the training
set to reduce the images down to   dimensions  one fewer than the number of classes   each image in the test set
was then classified based on its norm difference from the classes in our training set  we also tested an lda
algorithm  which first performed pca before attempting to discriminate  on the same training data  and used a
similar norm difference approach for classification 

pca
lda

percentage of correctly classified images  n training set size 
data set  
data set  
n  
n  
n  
n  
n  
     
     
     
    
     
     
     
     
    
     

though performance was better than random guessing         the results were nevertheless quite disappointing 
for the first data set  an explanation for the failure could be attributable to the extremely high variance of the
images  faces were not necessarily centered  backgrounds alter  lighting conditions change  for the second

fidataset  while variance was perhaps not as significant as in the first  we did have to deal with the added
complication of different poses  which significantly skews pca 
comparison with previous work
using a database of images taken under tightly controlled conditions  turk and pentland        achieved
accuracies of between     and      depending on variations in lightning  orientation  and size  while such
statistics seem phenomenal  it is important to note that we lacked such controls with our data  because of the need
to classify people in vastly different poses and lighting conditions  a precise algorithm that required strict controls
would not have been useful  regardless of the success rate 

conclusion
though at first it appeared tractable  the task of automatically tagging the facebook now seems infeasible  while
face detection using a mixture of factor analyzers model works  its false detection rate  even at       is still too
significant to make it functional  perhaps with more training samples this factor could be reduced  but given that
even the task of scanning a    x    image takes over    seconds  significant strides in image processing would
be needed to make the task quick enough for online processing 
as for face recognition  the huge variance of poses  lighting  and time passing  hair changes especially  make the
task extremely difficult  if not impossible  while attempts with non linear kernel pca or lda could be tried  the
acute degree of our failure to successfully match faces with only   classes suggests that obtaining satisfactory
results with a network of hundreds of thousands of people seems infeasible 
therefore  while the work produces a useful database and a modestly accurate face detection program  the goal of
automatically tagging the facebook remains unattained 

sources
   
face detection using multimodal density models
ming hsuan yang  david kriegman  and narendra ahuja
september     
   
the em algorithm for mixtures of factor analyzers
zoubin ghahramani  geoffrey e  hinton
may     
   
face recognition using hybrid feature
hong tao su  david dagan feng  xiu ying wang  rong chun zhao
november     
   
using graph model for face analysis
deng cai  xiaofei he  jiawei han
september     
   
eigenfaces vs  fisherfaces  recognition using class specific linear projection
peter n  belhumeur  joao p  hespanha  david j  kriegman
   
face recognition using eigenfaces
matthew a  turk  alex p  pentland

fi