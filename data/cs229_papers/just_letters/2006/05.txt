machinelearningappliedtobuildingperformancemetrics
tobiasmaile
introduction
the performance of air conditioning systems in buildings is hard to evaluate and typically includes an
expertanalyzinglargetimeseriesdatasetstofindoperationalpatternsthatareanomalous duetothesize
ofthedatasets thisisatimeconsumingprocessandthusveryexpensive thisleadstoasmallsubsetof
buildings for which such ananalysis has been doneand its energy performance evaluated  this projects
aimstoapplymachinelearningalgorithmstosupportexpertsinanalyzingthesehugetimeseriesdatasets 
asafirststepnecessarypreprocessingofthedatawasidentifiedtoeliminateirregularitiesintherawdata
set  furthermore  an anomaly detecting framework has been implemented to determine anomalies in the
timeseries lastlysomeexperimentationonclusteringthedatasetshasbeenconducted 
thedataset
the basic dataset consist of timeseries from both observations and predictions  the predictions were
created with a building energy performance simulation engine  namely energyplus       the measured
datawascollectedata naturallyventilatedofficebuilding andconsistsof  differenttemperaturepoints a
pressure difference measure     velocity measures and window opening measurements  the building in
question uses a natural ventilation strategy and these measurements have been installed to verify the
performanceofthisinnovativeventilationstrategy theinitialdesignsimulationshavebeenupdatedwith
actualmeasurementsresultinginfairlyaccuratepredictionsoftheactualbehaviorofthebuilding inthis
particularcasetherawdatacomparisondidnotleadtoreliableresultsfortheanomalydetection sincethe
differences between the observations and predictions did only have similar patterns  which had some
differences in absolute values  thus the data needed an additional preprocessing step besides the outlier
detectionandeliminationandintervalaveraging thusithasbeen correctedbyitsmeanandscaledona
dailysubset basis thepredictionshavebeenupdatedthroughtheuse ofupdatedinput for examplethe
measuredoutsideairtemperaturehasbeenusedtoinputactualexternalconditions themeasureddatais
collectedinoneminutetimestepsandhasbeendividedintodailysets sincethepredicteddataisbasedon
   minute time intervals the observed data also needed to be averaged over    minutes  there are two
reasons why a division into daily sets is useful  due to the dependency on the outside air temperature 
which usually follows a daily pattern  low temperature during nights and high temperature in the
afternoon  alltimeseriesfollowthispattern furthermore adayisareasonabletimeframetolookatfor
furthermanual analysisincaseanomalieshavebeendetected 
preprocessing
threetechniqueshavebeenusedtopreprocessthedataset toremoveoutliersasimplequartilealgorithm
hasbeenimplemented furthermore tominimizethedifferencesbetweentheobservedandpredicteddata
set bothhavebeennormalizedonadailybasistotimeserieswithequalmeanandscale inaddition the
differenttimeintervalshavebeenaccountedforbyaveragingtheoneminuteintervalsover  minutes 
outlierdetectionandelimination
preprocessingofthedataisnecessary sincethemeasureddataisrawdatacollectedfromsensors thedata
contains some outliers due to false readings of the sensors  the following formulas have been used to
identifytheoutliers 
x i   q     iqr

x i  q      iqr

whereq  andq  arethefirstandthirdquartilesofthedataandiqristhedifferencebetweenq  andq  
thissimple procedure    couldsuccessfullydetecttheoutliersinthedatasetsee figure foranexample
ofadetectedoutlier 

fifigure  outlierintimeseries

detected outlierswherereplacedthroughinterpolatedvaluesofneighbor points sincetheoutliersinthis
datasetareonlysinglepointsthissimpletechniquewasabletodetectallsevenoutliersinthedatasetthat
wereidentifiedduring thedataanalysis 
anomalydetection
onemajortaskduringthedataanalysis of professional expertsis to finddays or part of days wherethe
performancediffersfromtheexpectedperformance thiscorrespondstoanomalydetectioninmultivariate
timeseries whileitisnotveryinterestingtohighlightalldifferencesbetweenthepredictedandobserved
dataset thealgorithmneedstodetectsignificant differentpatternsoccurringinthedataset 
relatedwork
recently there have been various efforts in anomaly detection and analysis of timeseries  a technique
described by salvador et al  detects anomalies in single timeseries based on states and rules      this
techniqueasawholeisnotapplicableforthisdataset sincethethermodynamicprocessescannoteasilybe
describedwithdifferentstatesandregulartransitionsbetweenthem however thereferreddataclustering
technique gecko and the lmethod seem applicable to automatically estimate the needed number of
clusters  in case clustering of resulting anomalies would have been pursued  in addition automated
analysesformultivariatetimeseriesareavailable bayetal    uselocalmodelstodescribesubsetsofa
reference timeseries and test the training data on the determined local models  another technique
 hotellingst isdescribedbyyeatal    isusedtoidentifycyberattacksbasedonnetworktraffictime
series  it uses norm profiles from training data to detect anomalies in the test dataset  initial
implementationsofthe hotellingstmethoddidnotleadtoreliableresults allrelatedimplementations
have incommonthatacombinationofalgorithmshasbeenusedtofullymanageanomalydetection 
furthermore varioustechniquestodescribetimeserieswithsomekindofparametersareavailable e g a
techniquetoindexmultivariatetimeseriesseems   tobeausefultechniquetorepresenttimeseriesina
lowerdimensionalspace buthasnotbeenfurtherevaluated inthisprojectduetotimeconstrains 
modified dartsalgorithm
oneexistingframeworktodetectanomaliesinmultivariatetimeseriesisthesocalleddartsalgorithm
    theframeworkconsistsof  majorsteps illustratedinfigure  
   preprocessing
   createlocalmodelsforthetraindata predictions 
   createlocalmodelsforthetestdata observations 
   comparethelocalmodelsintheparameterspaceandcalculatetheanomalyscore
   calculatetheanomalycutoff
   identifytheanomalyregions

fifigure   process ofthemodifieddartsframework

thefirststephasalreadybeendescribedearlierinthisreport 
the second and third step entail the estimation of local ar  autoregressive  model for thedatasets  two
parameters characterize this process  the order of the armodels and the length of the timeframe of the
local models  while the order of the ar models should be relatively small to minimize data loss  the
durationofthelocalmodelshasmajorimplicationsontheperformanceofthealgorithm ifthesizeofthe
localmodelsissmall thedatacanbefittedverywellhowever thisleadstooverfittingandproduceshigh
anomalyscoresformostofthetestingdata ontheotherhandlocalmodelsforalargetimeperiodunderfit
thedataandproducefeweranomalies forthisdatasetatimeframeof hourswhichcorrespondsto  data
pointsworkedwell 
fortheforthsteptocomparethelocalmodelsintheparameterspacetheprobabilitydensityfunctionhas
not produced reliable results  bay et al  have identified the same problem in their work  the referred
problem is thatthe multiplication of very small probabilities withinthe kernel method tends to produce
zerovaluesinareaswhereanomaliesoccur however thekthnearestneighboreuclidiandistanceworked
wellforthisdataset frommyexperimentsthenumberofkhasasmallinfluencetotheactualdetectionof
anomalies  if it stays within midrange values  any kvalue between    and   identifies the sameset of
anomalies 
thefifthstepcalculatesasocalledanomalycutoffthatdeclaresanomalyvaluesthatareabovethecutoff
forsignificant itisdeterminedbytestingthelocalmodelsofthetraindatawiththetraindataitself this
significantanomalyvaluesidentifythedetectedanomalies whichisthelastandsixthstep 
this framework has produced reliable results for the dataset in question  while the actual manual data
analysis is still in progress  there was no final identification of anomalies available  however  regions
where this implementation produces anomalies show significant variations and or differences in the
patterns and many of them have been part of the discussion during the data analysis  two examples for
detectedanomaliesoftemperaturetimeseriesareillustratedinfigure and  

fifigure  ceilingsurfacetemperature

figure  zoneairtemperature

the two anomalies detected in figure   have decreased slops and therefore smaller variations of the
observed temperature  between      and        this is an anomaly which has been identified as one
duringthemanualanalysisprocess butitscausewassomewhatunresolved one possibletheoryisthatthe
airismovingondifferentpathsthanusualonthesetwo days additionalmeasurementshavebeeninstalled
inthemeantimetofurtherinvestigatethisphenomenon 
thefirstidentifiedanomalyinfigure  justbefore    hasnotbeenidentifiedassuchduringthemanual
process however onecanseethatthereissignificantdifferencebetweenthetwotimeseries thesecond
anomaly  between     and       can be described as a higher peak in temperature during the day 
interestingly  the solar shield has fallen of the sensor allowing for a greater solar influence and thus a
highertemperature readingoccurs duringtheday 
clustering kmeans 
initial kmeans clustering implementations could successfully categorize the outside air temperature into
three different sets  one where there is only a small temperature difference between day and night  one
wherethisdifferenceismediumandonewithahighdifference whilethisimplementationhasnotbeen
focused on further  it could be useful to create three sets of data based on the clustering and perform
analysisforeachofthesubsetstobetterunderstandthedifferencesthatoccurduetooutsideairconditions 
inaddition clusteringoftheanomaliesaftertheirdetectionmaybeusefultoidentifyanomalycategories
andsupportthedataanalysisfurther duetothelimitednumberofanomaliesforeachcharacteristictime
seriestherehasnobeenanyusefulresultsforclusteringoftheanomalies thismaybedone ifthedataset
hasgrownbigger 
conclusions
for the time consuming and expensive procedure of evaluating building energy performance based on
manualdataanalysisofobservedandpredictedtimeseriesthemodifieddartsframeworkhasprovento
be veryusefulinidentifyinganomaliesoftheavailabledataset outlierdetectionandnormalizationwere
needed to get the data in a form that was suitable for the anomaly detection  within the framework the
representationofthedatawithinlocalmodelsandtheparameterspacewasusedasatechniquetohighlight
only the significant differences and or anomalies in the dataset  additional procedures could be
implemented that determine some of the parameters found during testing  such as the length of the time

fiwindowoflocalmodels theirarmodelorderandothers whilethedescribedprocedureworkedwellfor
thisdataset ithastobetestedforfurtherdatasetsofthisbuildinganddatasetofadditionalbuildingsto
validate its usefulness in general for this data analysis problem  further methods such as clustering the
detectedanomaliesoridentifyingpossiblesourcesoftheanomaliescouldextendthiswork 

references
   

energyplus www energyplus gov

   

mathematicaldefinitionofoutliersatwikipedia
http   en wikipedia org wiki outlier

   

salvador s chan p brodie j  learningstatesandrulesfortimeseriesanomalydetection 
americanassociationofartificialintelligence     

   

bay s saito k ueda n langley p   aframeworkfordiscoveringanomalousregimesin
multivariatetimeseriesdatawithlocalmodels      

   

ye n chen q emran s m vilbert s  hotellingst  multivariateprofilingforanomaly
detection proceedingsofthe    ieeeworkshoponinformationassuranceandsecurity
unitedstatesmilitaryacademy westpoint ny   june      

   

vlachos m m hadjielefttheriou m gunopulos d heogh e   indexingmultidimensional
timeserieswithsupportformultipledistancemeasures inproc acmsigkdd pages       
     

fi