cs    project report
detect leaders in cow group movement using pairwise distances
yang li
introduction
project background
studies in animal social behavior show that group living animals  such as cows  travel together
in a collective pattern known as spontaneous group movement     such movement exhibits the
leader follower phenomenon  that is  some individual are more likely than others  to initiate group
movement that causes others to follow  we call these cows leaders of the group movement  an useful
tool in cattle management is to automatically identify the group movement leaders by analyzing
cow motion data  the goal of this project is thus to find out whether we can model the leader
probability of individual cows based on the pattern of recent group movements 
we define the leading cows of a group movement to be occupants of the front positions in the
direction which the group is moving  although it is easy to determine a cows relative position
within the group given its accurate geographical location tracked using gps  it is often infeasible
to deploy gps devices to cattle on a large scale due to cost  power and signal limitation  an
alternate way of data collection proposed by students in eth zurich university    is dispersing the
environment with sparse landmarks and equipping the cows with inexpensive sensors that records
contact events with other sensors and landmarks     previous work by stanford students daniel
chen and johnathan jiang showed that it is possible to estimate the distances between sensors
from contact information  knowing the cow to cow distance  we define the neighbour distance
distribution of cow i to be the distribution of distances between cow i and other cows within the
group  we can describe this distribution using a gaussian model  p di    n  i   i    where i and
i  are empirical estimations of mean and variance  we expect leading cows to have very different
i and i from non leading cows  figure   compares the neighbour distance of cow   and cow
          base
   at frame      in this case  we have                                  and   
on this intuition  this project applies several supervised learning models to estimate a cows leader
probability from its neighbour distance distribution 
  

 

 

cow  
cow   

out      

 

 

 

  

  

  

figure    the neighbour distance of a leading cow  left  and a non leading cow  right 
 

data courtesy of dr  silvia santini  institute for pervasive computing  eth zurich 

 

fidataset description
our original dataset contains the gps traces of    cows and clustering results from previous work 
gps traces 
in an experiment conducted by previous researchers  the exact locations of
   cows were tracked using gps continuously for   days at  hz frequency  for the prototyping
purpose  we used a filtered dataset sampled at   seconds intervals  which contains       frames
and have size   mb 
clustering results  in previous research  single linkage clustering were used to partition the
cows into clusters in each frame  according to the clustering results  we can see that most cows
move in large groups  with individuals leaving and joining a group at random occasions  in most
frames  there is one or two large clusters of cows and a few outcasts 
for this project  we primarily looked at the first     frames of data  during this time all but
  cows are within a single cluster  labelled c   to simulate the senario of working with pure
sensor collected data  we limited the training data to pairwise distances of    cows at every frame 
synthesized from the gps traces 

methods
feature design
let m be the number of frames that the training data spans  the design matrix for modelling
 t 
the leader probability of cow i is an m by   matrix  each row vector xi represents a training
example characterizing cow is distance and relative speed with respect to its neighbors at time t
 t       m  


 t 
 t     t   t     t 
xi   i i i i
 t 

 i i 
 t 

 t 

  mean and variance of cow is neighbor distance distribution at time t 

 t 

 i i    mean and variance of the speed correlation of cow i and other cows over a time
window  t  r  t   r   where the positive integer r represents the window radius  the relative
speed between cow i and cow j at time t is approximated using the forward difference 
 t 
si j   d i  j  t   d i  j  t    
 t 

 t 

 t 

in the case of logistic regression  xi is augmented to    i i    for fitting the constant term 
without the loss of generality  we will drop the subscript i in the rest of this section 
in most of the design matrices  the value of    t     is much larger the value of  t    it is therefore
necessary to normalize the feature vectors to have mean   and standard deviation    for instance 
let xk and k be the mean and standard deviation of the kth feature vector  then the normalized
k
feature vector is xk    xkx
 
k

target labelling
the training target yit is a binary value that indicates whether cow i is at a leading position in
frame t  the ground truth labels are generated geometrically using the first k algorithm  in this
algorithm  each cow is represented by a  d point  define v  t    the velocity of the cluster at frame t
to be the difference of the cluster mean between frame t    and frame t  we then ranked all points
in the cluster by their relative positions in the direction of the cluster velocity  see figure     then
the leaders are the k points with highest ranks  here we chose k     to ensure we have sufficient

 

fipositive examples for training  while preserving the sensitivity requirement of the problem  in
particular  yi     implies cow i occupies one of the first   positions of the group at time t 

figure    leader classification of cows in cluster c  at frame t        each cow is represented
by a labelled dot  the gray line is the trajectory traced by the cluster mean  and the black arrow
represents to the cluster velocity  the points are colored by position ranking  the top   ranked
points are highlighted in yellow 

logistic regression
with logistic regression  lr   we modelled the likelihood of a cow being at a leading position given
 
parameter  using the familiar sigmoid function p y x      h xi    
  we proceeded to
  et x
pm i
i
maximize with respect to   the log likelihood  l     i   y logh x         y i  log    h xi    
using newtons method  we obtained the optimal parameter   r    the probability that
cow i is at the leading position given a new distance distribution x       can be evaluated as
p y x      h  xi   at x 
         
    
 

 

    

   

   
   

true positive rate  tpr 

    
   

    
   

    
   

    
   

   

    
    
    

   

   
   

    
   

 

 

   
    
   
    
   
   
   
   
     

roc for leader detection of individual cows
median roc  labeled by shreshold 
tpr    fpr
   

   

   

   

   

   

   

   

 

false positive rate  fpr 

figure    roc curve for data source gps traces of    cows in   days leader detection using
training data pairwise distances of    cows during lr 
in the leader detection problem  the size of the leader class is much smaller than the size of
the non leader class  this leads to a problem when we use p y x          as the leader detection
 

ficriterion  lr often finds a trivial classifier that labels all cows
 as non leaders 
 we therefore biased
  p y x     t
the criterion by a threshold parameter t   such that yt  
 
  p y x      t
we used roc curves     shown in figure    to determine the best t for all models  the training
examples were randomly partitioned into a training set of size          of the original training
set  and a test set of size      for each model  we repeatedly trained and tested our model with t
ranging from   to   at step size       then the true positive rate  tpr  was plotted against false
positive rate  fpr  over the threshold space  forming a roc curve  the median roc curve for
all models is highlighted in red 
we approximated the optimal threshold t to be the intersection of the roc curve with the
line f p r      t p r  this can be interpreted as setting the number of false positives equal to the
number of false negatives  in our problem  we found t         which non surprisingly coincided
with the threshold value that maximizes the f  score   

linear svm
the second model we attempted is l  regularized linear support vector machine  svm   regularization is necessary since the models are clearly non separable  since our problem is low dimensional
and has small scale  we did not need to worry about the additional computation cost of l  regularization over l    the model fitting
was done using the liblinear package  solving optimization
p
problem min w    wt w   c m
max   
   yi wt xi    for optimal margin parameter w  constant
i  
c  with default value    is the penalty parameter  the predicted outcome is   if wt x    b  where
b is the bias constant 
we used a   step grid search method to find the  c  b  pair that maximizes the f   score of
the model  in the coarse step  we searched within the range    c    and    b    at step
size      we then performed a finer search with step size      the final parameters we obtained is
c        and b        

figure    comparison between true labels  lr predicted labels and svm predicted labels for cow
   

results
we used   fold cross validation to evaluate the lr and svm models  in each trail  the number of
training examples was      and the number of test examples were      the mean and variance of
 

here we used f        r  p  p   r 

 

ficross validation errors  precisions and recalls over all    models are summarized in table    we
found no significant difference in the average test errors and f scores between the two methods 
in addition  we experimented with mixing all training examples together to train a global leader
detection model for all cows  the training and testing size became       and       and the model
evaluation results are shown in table    the results shows little difference from the average of
individual models  hence increasing training examples did not seem to improve fitness of the
model 

lr
svm

test error
mean std
    
    
    
    

precision
mean std
    
    
    
    

recall
mean std
    
    
    
    

f score
mean std
    
    
    
    

table    test error  precision and recall of lr and svm models for individual cows

svm

test error
    

precision
    

recall
   

f score
    

table    test error  precision and recall of svm model for all cows

conclusion
in this project  we tackled the cow leader detection problem through learning the pairwise distance
and speed correlation of cows  we designed a feature extraction scheme  fitted our model using
logistic regression and linear svm  and performed cross validation to evaluate the fitted models 
it was surprising to see that lr models are on average competitive to svm models  while both
methods were insufficient to detect leaders with high sensitivity under reasonable specificity  one
inherited challenge of our problem is the low prior probability of leaders in our training examples 
comparison between the f scores of individual models with the prior probability in the respective
training sets reveals that  detection models trained on data with higher prior probability are better
fitted than those trained on data with low prior probability 
in order to deploy leader detection in practice  additional features need to be considered  future
work may incorporate cow to landmark distances  a piece of information that we did not employ
under the scope of this class project  as a final remark  this project has been part of a research
project that studies motion patterns in the trajectory data of mobile objects  the cow leader
detection problem presented here can be generalized to other scenarios that involve the leader and
follower phenomenon  such as crowd movement and trends on social network  machine learning
techniques will most likely play important roles in studying these topics 

references
    brano kusy  silvia santini  and leo guibas  trajectory estimation using network traces of mobile devices 
unpublished       
    a  ramseyer  a  boissy  b  thierry  and b  dumont  individual and social determinants of spontaneous
group movements in cattle and sheep  animal                       
    wikipedia  receiver operating characteristic  http   en wikipedia org wiki receiver operating 
characteristic 

 

fi