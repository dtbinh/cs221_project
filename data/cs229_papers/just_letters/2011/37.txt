object segmentation and tracking in  d video
with sparse depth information using a fully
connected crf model
ido ofir
computer science department
stanford university
december         

abstract
this project extends the most state of the art technique for multiclass image segmentation     to a technique that incorporates geometric
and temporal data for multi class segmentation and tracking of unknown classes of objects  previous video rate segmentation techniques
only achieve fast performance with considerably lower accuracy by reducing the density of pairwise connected graphs  this has been done
using hierarchical region level models or pixel level models with connectivity limited to nearest neighbors  a fully connected crf model
over the complete set of all pixels results in billions of connections
and has therefore been impractical to segment before now  using this
new technique which defines edge potentials as a linear combination
of gaussian kernels  it is possible to approximate the segmentation
of a fully connected crf in a fraction of a second  this project extends the core algorithm to incorporate sparse geometric features from
a laser scanner into the segmentation  it also provides some tracking
capabilities for the segmented objects 

 

introduction

basic crf models are composed of unary potentials on individual pixels or
image patches and pairwise potentials on neighboring pixels or patches  new
state of the art techniques allow for a highly efficient inference algorithm for
fully connected crf models in which the pairwise edge potentials are dened
by a linear combination of gaussian kernels in an arbitrary feature space 

 

fiin the problem this paper considers that feature space included color and
geometry information from a camera and depth sensor  the data sequence
comprised of a long series of frames from video recordings  with the purpose
of segmenting and tracking primary objects in each video  the problem
was augmented by the sparse nature of the geometric information  previous
crf models were designed to resolve a data set with consistent features 
due to the physical limitations of range sensors  geometric features could
not be measured for         of indoor data and         of outdoor data 
this inconsistency in the features available required considerable changes to
the crf model 

   

the fully connected crf model

the fully connected crf model that this project extends solves an energy
function where the potential for any given edge in the graph is given by a
linear combination of unary and binomial compatibility scores  the unary
potential in this approach computes the probability that any individual pixel
has a specific labeling  this learned probability is easily learned and computed in o n  time  but is insufficiently accurate for labeling  the pairwise
potential is based on the expectation that two pixels share the same label  two pixels with different labels accrue a penalty that is determined
by the compatibility of the labels  this allows for labels the often occur
together to receive smaller penalties  the brilliance of this technique lies
in the fast mean field approximation of the distribution the minimizes the
kl divergence in linear time with respect to the number of features 

   

mean field approximation

instead of computing the exact distribution p x   the mean eld approximation computes a distribution q x  that minimizes the kl divergence  each
iteration of the algorithm performs three steps 
   a message passing step where each variable evaluates a sum over all
other variables 
   a compatibility transform  o n 
   a local update passing  o n 
the message passing step can be approximated using the permutohedral
lattice  which reduces the quadratic complexity to linear complexity 

 

fi   

the permutohedral lattice

the permutohedral lattice     provides a high dimensional gaussian lter
that is both linear in input size and polynomial in dimensionality  the ddimensional permutohedral lattice is formed by projecting the scaled grid
 d     z d   onto the plane  x          more on the permutohedral lattice
can be found here 
http   graphics stanford edu papers permutohedral

 

data

this project used data from two distinct sources  it was the original intent of
the project to focus exclusively on data from the stanford autonomous car 
after much analysis it proved that the data acquired by that system was
too sparse      available  due to the laser scanner  the rest of the project 
including the final result was done with the xbox kinect  the images below
show a typical frame captured from the kinect  the image on the right shows
the depth data that was successfully measured  note the measurement error
in the mid right portion of the frame which greatly affected the performance
of the segmentation 

   

depth sensors

 

fi   

spares data

sparse data was problematic for several reasons but the greatest of which
was the gaussian kernels for pairwise potentials  where data was missing
in one of the two samples the potential energy would discount them as too
dissimilar  where both data samples showed missing data the kernel would
assign them a very strong affinity and would not label them as separate
classes 

 

implementation

the solution used in this project was to substitute the kernel for missing
data points with an alternative kernel that would provide the correct affinity
score using the remaining features  the whole project was implemented in
c   with the exception of the mixture of gaussians unary features that
where borrowed from matlab 

   

unary classifiers

of the several simple unary features used in this project the best performing
one i tried was the mixture of gaussians algorithm  the data i used was
completely unsupervised which limited my options in this respect  it is
important to note that the performance of the unary classifier was directly
and linearly related to the performance of the segmentation overall  this
observation can be explained by considering the roles of unary and bilateral
potentials in the crf model  the unary features attempt to label pixels
as different classes while the bilateral potentials attempt to minimize the
classes labeled  without a proper labeling of the unary feature the algorithm
reduced the segmentation to a single class 
     

mixture of gaussians

i used mixture of gaussians to label the pixels into   different classes and used
the labelings as initial probabilities for each class  the mixture of gaussians
segmentation performed much better on color features without the geometry
information  the number of labels and potential weights used throughout
the project was selected to best match the data using grid search 

 

fi     

previous segmentation cost of change

the final unary features were a linear combination of the mixture of gaussians component and the probabilities derived from the labelings of the
previous frame  this was done for several reasons  chief of which was to allow for tracking in completely unsupervised segmentation  the assumption
behind this approach is that in a high frame rate video  there is a high likelihood that a pixel will maintain its classification from the previous frame 
this approach work well in practice  but is susceptible to drift errors  the
weights for the probabilities and for the coefficients of the linear combination
where tuned by hand 

   

pairwise cost functions

the original intent of the project was to relay of pure  real world geometry
and color features to form the gaussian kernels for the pairwise potential of
the crf  however  due to the issues already discussed  it proved impossible
to relay on these kernels alone in the absence of valid geometric data 
     

alternate kernels in image space

even in the absence of any depth measurement  some geometric data is
still available  the alternative kernels i used as a replacement for samples with partial data  were the original image space appearance kernels 
these gaussian kernels follow the same premise of increasing the potential
as samples get closer to each other  but instead of using real world distances 
using image pixel distances  the kernels had to be carefully calibrated the
proved similar results  however because of their non linear relationship the
do introduce a bias which shifts with distance from the camera 

 

learning

learning was done using unsupervised data  recorded in on an xbox kinect
sensor  data sets included both in door and out door videos  and featured
both rigid and articulated object  specifically a panning around several
statues and recordings of my cat 
because of the size of the data set and a lack of personal resources all
data was unlabeled  the lack of ground truth made testing and evaluation
very difficult to quantify  as such  i can only provide qualitative results as
this time 

 

fi 

results

the segmentation results seen above were typical of the segmentations
achieved using the mixture of gaussians unary classifier  better  supervised
classifiers provide much more accurate segmentation  as most of the errors
were in fact introduced by the mixture of gaussians unary classifier 

references
    p  krahenbuhl and v  koltun  efficient inference in fully connected
crfs with gaussian edge potentials  nips       
    a  adams j  baek and a  davis  fast high dimensional filtering using
the permutohedral lattice  eurographics       

 

fi