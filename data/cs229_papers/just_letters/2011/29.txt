analyzing gene expression time series
cs     fall      final project
marco cusumano towner
advised by sofia kyriazopoulou panagiotopoulou
december         

 

introduction

there are approximately twenty thousand genes in humans  each which can be expressed at different
levels at different times  under different conditions  and in different tissue types  in fact it is exactly
differences in gene expression that determine tissue type   broadly speaking  the expression levels
of genes in a cell approximate the current state of the cell  modern high throughput techniques like
cage       can comprehensively measure the expression levels for all genes at a given time point 
the amount a gene is expressed can be measured by counting the number of mrna transcripts
associated with that gene  these are  very roughly speaking  copies of the gene waiting to be
translated into proteins  
most often gene expression analyses begin by measuring expression levels under two or more
conditions  e g  healthy or disease condition  or environmental or stress conditions   and aim to
identify which genes are differentially expressed between the two and why  e g        gene expression
time series instead measure the expression levels in a single condition over time  often after the
introduction of a stimulus       or during a cellular process        and aim to discover the dynamical
response of the cell to this stimulus  and possibly the underlying regulatory networks that govern
this response       
in this project  we have subjected a particular gene expression time series dataset to a series of
analyses  primarily involving clustering of the genes  clustering can reveal groups of co regulated
genes  genes that are regulated by the same factors   or genes involved in the same functional
pathway        clustering of gene expression time series is a challenging task  given the notoriously
noisy nature of gene expression measurements  and the often sparse and unevenly spaced time
points       

 
   

methods and results
preprocessing

we considered two datasets for this project  a time course of human leukemia cells after introduction of hemin  and vascular endothelial cells  cells that line the blood vessels  after application of
vegfc  vascular endothelial growth factor c   both datasets included three replicates of the same
experiment  we analyzed the statistics of both datasets  such as correlations between replicates 
 

fiand determined that the endothelial cell time course likely had less noise than the leukemia time
course  and we used this dataset for further analysis 
because different genes can be expressed at different general amplitudes  gene expression analyses are usually concerned with the log fold changes for each gene g  we use the log fold changes
 g 
 g 
with respect to the first time point  log  yt  log  y    
the transcriptional  gene expression  response to any given stimulus generally involves a subset
of all the genes  therefore  an essential first step in analysis of whole genome gene expression data
is determining those genes that are likely part of the biological response and removing the rest
before further analysis  to do this  we only included a gene if it reached below half or above twice
its initial value in all replicates  we replaced all zero values with the value two before calculating
log fold changes  after filtering       genes remained  we also discarded the last two time points
because they exhibited sudden biologically uninterpretable changes in value  and further removed
genes with the worst fits to the impulse model  described below   the final product was      genes
with    values  sampled at  min    min    min    min   hr   hr  min   hr  min   hr   hr  min 
 hr   hr  min   hr   hr  and  hr  we used the log fold change data from one replicate for our
further analyses 

   

validating algorithm output

we need to verify that the output of clustering algorithms is biologically meaningful  before using
the output to guide hypotheses regarding new biological meaning  the genes within some clusters
should be related to one another biologically  in whole genome bioinformatics  biological relationships are often determined by annotations  e g  gene x is involved in blood vessel development or
chromatin modification  that biologists have assigned to genes  we test if clusters are statistically
enriched for any biological functional annotations  in particular  a hypergeometric test  or onetailed fishers exact test  is used to asses whether significantly more genes in a set are associated
with any annotation than would be expected if the gene set was selected randomly  we use the
online tool g profiler       for this analysis 

   

choosing the number of clusters

we attempted to choose the number of clusters  k  by observing how the distortion function decreased with increasing k  by using hierarchical clustering  and by assessing the consistency of cluster
assignments between replicates for various k  however  visually identifying k values that struck a
balance between low within cluster variance and low between cluster similarity proved more direct
and intuitive 

   

k means clustering

our first attempt at clustering used plain k means  we used the standard euclidean metric as
well as the pearson correlation coefficient metric in which the distance between genes i and j is
d y  i    y  j         r y  i    y  j     and r y  i    y  j    is the pearson sample correlation coefficient  the
correlation metric is a common choice for this data domain  because any fine grained fluctuations in
the data are likely masked by noise  clusters from k means with the correlation metric are shown
on the left in figure    the clusters returned from k means were not significantly enriched for any
relevant biological annotations specific to the stimulus condition  this is likely because k means fit

 

fito random patterns in the data  which are present because of the large number of genes and the
small number of time points  coupled with the high level of noise         a sign that this is occuring
in our results is that many of the clusters are distinguished by sudden changes in value during the
middle or end of the time course  which are unlikely to be true biological events 

figure    clusters from k means run on the raw data  left  and the impulse fitted data  right  
centroid shown in red  individual gene time series shown in blue  the x axis measures minutes after
stimulus  and the y axis measures  zero mean unit variance transformed  log fold change values 

   

clustering using least squares fits to a continuous model

to prevent fitting to random noise or systematic nonbiological fluctuations  we would like to restrict
the clustering algorithm to only detect biologically meaningful patterns in the data  in addition 
the basic k means distance metrics described above are limited in that they ignore the temporal
dependencies in the data  and treat each time point as an independent dimension 
to deal with the noise problem  prior work fits a parameterized continuous model to the data 
which is then used as input for enrichment analysis or clustering algorithms  in particular     
introduce a model for gene expression time series that parameterizes a set of impulse shaped
curves with six biologically meaningful parameters  initial steady state value  onset time  peakvalue  offset time  final stead state value  and a rate parameter   the authors claim this model
captures the observed typical reaction of gene expression levels to many stimuli  we fit this model
to our data by minimizing the sum of squares reconstruction error with respect to the parameters 
we also fit a variant given in      that places more constraints on the parameters  e g  offset time
must be greater than onset time  
we ran k means on these model fits  where we also sampled the continuous fitted functions
more densly than the original time series  the resulting clusters and centroids are shown on the
right in figure    the only cluster that shows enrichment for biological functions related to our
experimental condition  vascular endothelial cells  stimulated with a vascular endothelial growth
factor   is the top left cluster  which also corresponds to a cluster when fitted using the constrained
impulse model  this cluster is enriched for blood vessel development  among a host of other less

 

fispecific terms  if this cluster is representative of the true signal in the data  the amount of withincluster variance around the centroid illustrates the predominance of noise in the data  we did not
see major improvements in enrichment analysis using the more constrained model 

   

analyzing cdfs of fitted parameters

as a complementary analysis to testing the enrichment of clusters  we followed      and investigated
whether genes with a certain annotation had any significantly different impulse model parameters
from genes without the annotation  e g  perhaps the onset time parameter is earlier than on
average for genes involved with cell cycle   for this we used the ks  kolmogorov smirnov  test to
compare the empirical distributions  empirical cdf  of the parameter for genes with and without
the annotation  we did this for all annotations  we found several annotations related to our
condition that were enriched for parameter distribution  although a number of unrelated terms
were also enriched  so the significance of these is not yet clear  however  this analysis did lead to
discovery of a set of nine genes related to a certain phase of the cell cycle that all have a very similar
time profile  decrease rapidly in the first time sample  then rebound   these genes were located in
the same cluster in our model fits  but their common annotations were not identified as statistically
significant due to the large size of the cluster 

   

integrated clustering and modeling algorithm

the final algorithm we evaluated        is a recent impulse based iterative clustering algorithm for
gene expression time series related to k means  in which cluster centroids are represented as priors
over the parameters of the impulse model described above  in the assignment step  the genes are
fitted to the impulse model while regularizing the parameters with respect to each of the priors 
the prior that results in the least total regularized cost for a gene becomes that genes cluster  in
the m step  the priors are fit to the average of the genes in their respective cluster  this model
aims to further prevent overfitting of the impulse fit to the data 
due to the high computational demands for this algorithm  we were only able to run it for
five iterations  however  the resulting clusters after five iterations are very similar to the clusters
obtained by running k means on the fits  as described above  again  there was one enriched cluster
of genes that rise then fall  with many of the same genes   this suggests that overfitting was not a
problem with the fit then cluster approach for our data  however  this algorithm also has a number
of regularization parameters which could be further tweaked  and could potentially improve the
results 

 

discussion

although the impulse model has been used successfully in prior works              our results suggest
that it might not appropriate for use with our data  perhaps a subset of the gene expression profiles
are indeed captured by the impulse model but others follow a multimodal pattern  perhaps related
to the  periodic  cell cycle  in addition  the discovery of a small set of nine genes with highly related
functional annotations and very similar time profiles that were not identified in enrichment analysis
of clusters suggests that our cluster sizes may be too large  however  decreasing cluster sizes risks
splitting related genes 

 

fi 

future work

there are a number of other clustering algorithms for gene expression time series that are worth
exploring  several algorithms use iterative soft em like assignments  of note is a method that uses
mixtures of hmms        as these authors point out  hard assignments of genes to clusters is not
entirely biologically meaningful  because the interaction network between genes is not composed of
separate connected components  and a mixture model may be more appropriate  this model also
does not constrain the time profiles to have an impulse shape  but instead learns profile templates
from the data  and can represent both impulse profiles and periodic profiles  integrating a softassignment mixture model with enrichment analysis would be an interesting course of research that
could potentially identify very small groups of related genes without over partitioning the genes
and breaking apart other related gene groups 

references
    oleg m alekseev  richard t richardson  oleg alekseev  and michael g orand  analysis
of gene expression profiles in hela cells in response to overexpression or sirna mediated
depletion of nasp  reproductive biology and endocrinology   rb e        january      
    mukesh bansal  giusy della gatta  and diego di bernardo  inference of gene regulatory networks and compound mode of action from time course gene expression profiles  bioinformatics
 oxford  england                april      
    gal chechik and daphne koller  timing of gene expression responses to environmental changes 
journal of computational biology a journal of computational molecular cell biology           
          
    raymond j  cho  michael j  campbell  elizabeth a  winzeler  lars steinmetz  andrew conway  lisa wodicka  tyra g  wolfsberg  andrei e  gabrielian  david landsman  david j 
lockhart  and ronald w  davis  a genome wide transcriptional analysis of the mitotic cell
cycle  molecular cell             july      
    p  dhaeseleer  s  liang  and r  somogyi  genetic network inference  from co expression
clustering to reverse engineering  bioinformatics                august      
    jason ernst  gerard j nau  and ziv bar joseph  clustering short time series gene expression
data  bioinformatics     suppl   suppl    i   i          
    charles plessy et al  linking promoters to functional transcripts in small samples with
nanocage and cagescan  nature methods              july      
    juri reimand  tambet arak  and jaak vilo  g profilera web server for functional interpretation of gene lists       update   nucleic acids research     suppl    w        june      
    a  schliep  using hidden markov models to analyze gene expression time course data  bioinformatics               i     july      
     julia sivriver  naomi habib  and nir friedman  an integrative clustering and modeling algorithm for dynamical gene expression data  bioinformatics         i   i          

 

fi