cs    final project report
a multi task feature learning approach to human detection
tiffany low tlow stanford edu
abstract
dataset
we focus on the task of human detection using
unsupervised pre trained neutral networks  the goal
is to use multi task feature learning to pre train the
network to identify people given image data 
intuitively  by learning features to identify subparts
of human figures  such as arms  legs or torsos  these
features can then be used for the learning task of
classifying people  we train smaller convolutional
networks on a dataset comprising of annotated video
data of people in a variety of environments and poses
and on existing datasets of labeled body part data in
still images  the shared features that are learnt as a
result of the multi task feature learning are then
applied to learning humans in an object classification
task 

the datasets were compiled from five sources 
lamda  sapp  jordan and taskar n d    cvpr
 hofmann and gavrila        ethz  eichner and
ferrari n d    h d  bourdev and malik n d   and
videopose  sapp  weiss and taskar n d   datasets 
for each of these datasets  the relevant body parts
were identified and an appropriate bounding box of
the relevant scale drawn over the body parts  the
generated patches were then evaluated to removed
occluded data  particularly from the cvpr dataset  

related work motivation 
human detection has strong commercial and defense
applications for a variety of purposes  including
surveillance  analytics and entertainment  the task of
detecting humans with high precision and recall is
still a challenge  multi task learning has been used to
boost accuracy and learning rate in classification
tasks that are related  unlike single task learning  the
goal is to simultaneously learn across all tasks 
implicitly depending on a
shared feature
representation  this has been successfully used
in applications such as detecting generic  d
objects  human faces expressions  torralba  murphy
and freeman       and  d symbols  krempp 
geman and amit       
there exists a large body of work based on recursive
models  zhu  chen  et al        zhu  lin  et al        
and
on
spring based
models
for
object
classification detection  ramanan        these
approaches rely on a priori knowledge of the human
model when tackling the object classification task  in
particular  unsupervised learning has been used with
a combination of levels of recursion  zhu  chen  et
al        to learn the hierarchical dictionaries for a
class of    object models automatically  with a
shared common dictionary of   features  this multitask learning approach results in both part sharing
and appearing sharing  enabling more efficient
learning and inference 

figure    sample image from h d dataset with output training
patches generated for head  arm and torso datasets 

the raw images for each of these body parts were on
the order of      training examples  there are  
body part datasets  head  torso  arms and legs  the
images are rescaled to patches of   x   pixels  this
aspect ratio was chosen to better train patches for the
classification task of detecting human figures  which
have approximately a     ratio 
convolutional neural networks 
convolutional sparse networks as developed by
 kavukcuoglu  et al  n d    allow for faster training
with similar performance as compared to traditional
steepest descent sparse coding  the convolution
operator allows for structures at a given orientation
within the data to be modeled independent of their
locations in the image 

 

fipipeline 

figure    sample cnn with two layers  one output node 

the work is on a multi task training algorithm to
produce a common set of features across the datasets
for the purposes of a human detecting neural network 
motivated by work from  zhu  chen  et al         the
network is trained using all the datasets
simultaneously  to obtain common feature sets  this
feature set is then evaluated as an input to the human
detection network  the human detection system is a
convolutional
neural
network
 convnet  
implemented by zou  w  the networks trained use a
single layer of hidden nodes  with features such as
max pooling and maximum suppression to boost
classification accuracy 
network training 
all networks were   layer cnns using   feature
maps with dimensions   x   a pooling factor of  
with response maps of size  x   for each output node 
there are a total of     weights  an additional round
of training was conducted using    feature maps for
each network 

figure    network structure used for human classification using
part data

the training sets consisted of positive training
examples taken from the inria training set  negative
examples from the inria training set  and training
sets for the various parts  arms  legs  head and torso  
networks were trained for     iterations or until the
learning rate was cut off  in this case  the maximum
iteration count was reached first for all networks
trained  refer to figure    for explanations of the
different networks trained  a total of    different
types of configurations were considered 

given a sample input image  sliding windows of
various sizes are run over the image  the input patch
is then run through the detection network to observe
if a person has been detected in that region  the
activation maps over all the sliding window sizes are
then agglomerated into bounding boxes greedily 
starting with the box with the highest probability and
then either merging it to nearby boxes or eliminating
overlapping boxes otherwise  the output bounding
boxes are then passed as input to the detection unit 
which evaluates a hit if the bounding box
approximates the annotation by more than      or
otherwise as a miss 
experimental results 
for the part trained datasets  their performance was
validated against a test set of patches from the part
databases which were set aside from the training set
 figure      the performance on the test and training
sets demonstrate reasonable accuracy on part
detection  given the limited feature size 
  feature maps

   feature maps

partsonly

     

     

head

    

     

torso

     

     

arms

     

     

legs

     

     

peopleparts

     

     

head

     

     

torso

     

     

arms

     

     

legs

     

     

figure    percentage accuracy on test set for part classification

the performance of the different networks was tested
on a sample taken from the inria test set  these
samples label people with bounding boxes of a
similar aspect ratio        but only people who are
upright or are clearly in the frame  cropped people
parts are considered negative examples   first  sliding

 

fifigure    network configurations used for experiments 

 

fifigure    roc curves for   feature map networks and    feature map networks 

window detection was run at several image scales 
bounding boxes were only drawn for those parts that
were above a variable threshold value  based on the
threshold value  we can obtain an roc curve of the
performance of the differently trained networks
 figure    in terms of their miss rate and false
positive rate 

some degree of performance on a cross validation set 
and then applying this result to train a people
detection network  similarly  a network with a larger
number of feature maps  or an additional
convolutional layer  could be trained 

we observe that the addition of part data to the
training set results in a significant performance gain
for the trained networks  the parts based networks
achieve a lower miss rate to a minimum of      
although at the cost of a higher ffpi  this suggests
that these networks identify additional regions for
people parts  as shown in figure    the parts based
networks identify people who are only partially
visible in the image  and thus not marked as positive
in the inria test set   for more discussion on some
sample false positives and bounding box limitations 
refer to figures   through     which give some
bounding box annotations returned by the
partialinitial network 

the project would not have been possible without the
guidance and support of will zou and the
collaboration with rukmani ravi  involved as part of
research  

it is unsurprising that the dataset trained only on part
data and negative examples performs poorly on
people detection  here  the activation nodes for part
labels are considered labels for person detection 
however  we observe that using such a part trained
network as initialization weights for people detection
results in significantly better performance on the   
feature map networks 

acknowledgements

references
bourdev  lubomir   and jitendra malik  h d dataset  n d 
http   www eecs berkeley edu  lbourdev h d   accessed october           
eichner  m   and v ferrari  ethz pascal stickmen  n d 
http   www vision ee ethz ch  calvin ethz pascal stickmen   accessed
october           
gourier  n  d hall  and crowley   estimating face orientation from robust
detection of salient facial features   icpr international workshop on
visual observation of deictic gestures       
hofmann  m  and m gavrila   multi view  d human pose estimation
combining single frame recovery  temporal integration and model
adaptation   cvpr                    
kavukcuoglu  koray  pierre sermanet  y lan boureau  karol gregor 
michael mathieu  and yann lecun   learning convolutional feature
hierarchies for visual recognition   n d  krempp  s   d  geman  and y 
amit   sequential learning of reusable parts        
sapp  ben  chris jordan  and ben taskar  lamda   limbs annotated from
movies dataset  n d  http   vision grasp upenn edu video  accessed
october           
sapp  benjamin  david weiss  and ben taskar  video pose  n d 
http   vision grasp upenn edu cgibin index php n videolearning videopose  accessed october          
tang  lei   multi task learning   n d 
www public asu edu  ltang  presentation multitask pdf 
torralba  antonio  kevin murphy  and william freeman   sharing visual
features for multiclass and multiview   ieee transactions on
pattern analysis and machine intelligence      

conclusion
the inclusion of part classification into the training
of people detection networks is shown to improve
performance of such detectors  a simple extension to
the project would be to train part classifiers to reach

 

fi 

fi