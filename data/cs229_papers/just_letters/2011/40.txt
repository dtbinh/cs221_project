shin lin
cs    final project
identifying transcription factor binding by the dnase hypersensitivity assay
background
in the dna of cell nuclei  transcription factors  tf  bind regulatory regions throughout the genome in
tissue specific patterns  the binding occurs for three reasons     the tf is present     a section of dna is
in an open conformation  so called euchromatin   and    the sequence contains a tf specific cognate
sequence  to date  the most reliable method to assess if and where a tf is binding is to perform the
chromatin immunoprecipitation  chip  assay  briefly  tfs are cross linked to their bound dna  and the
protein nucleic acid complex is isolated by a particular tf specific antibody  the dna is then freed and
sequenced  so called chip seq   the sequences may be mapped back to loci in the genome  in this way 
the binding locations of one specific tf can be determined globally 
the dnase hypersensitivity assay  dhs  presents a potential method of querying all locations of all tfs in
a single assay  briefly  chromatin is treated with dnase i  euchromatin regions are cut  and these cuts
are then sequenced  looking more closely at these spans of high cut regions  one sees short stretches
notable for fewer cuts  viz  the footprint   which correspond to       nucleotide  nt  sequences where
tf binding protects the dna from the dnase activity and usually harbor tf specific cognate sequences 
figure    cut profiles using lymphoblastoid cell line gm      for tf srf  the average cut number is plotted against
nucleotide position with the motif in the middle  the profile corresponding to bound tf is in black  not bound tf  red  note
the divot or footprint in the middle of the bound tf profile 

concretely  the features are vectors x corresponding to sequence lengths several hundred nt long  each
position can be a non negative integer  representing the number of cuts produced by the dnase i
hypersensitivity assay  the target variable is whether a sequence harbors a bound tf  y      or not  y  
    an estimate of e x y     black  and e x y     red  is shown in figure    simply  the work described
herein applies machine learning models to distinguish regions resembling the black profile from the red 
the training and test cases are created using chip seq results for specific tfs as the gold standard  the
objective is to be able to recognize areas bound by tf with dhs results only  so the biologist may
dispense with undertaking multiple chip seqs  
to date  there have been two major approaches to handling this problem  pritchard s group used what
they termed a hierarchical mixture model   it is an unsupervised approach analogous to the mixtures of
gaussians computed with the em algorithm in class  the model distributions employed are different 
however  instead of multinomial priors for the latent variable  the prior is modeled with a bernoulli

page    

fishin lin
cs    final project
identifying transcription factor binding by the dnase hypersensitivity assay

distribution whose parameter is derived from a logistic regression using the features tf motif similarity
score  distance to transcription start site  and sequence conservation  the probability of the data given
the latent variable is modeled by a negative binomial  for the number of cuts  multiplied by a
multinomial  for the position of the cuts   instead of  as in the class example  gaussian distributions 
boyle and colleagues took another approach   they used a hidden markov model  hmm  to assess
whether a region was likely to harbor a binding tf simply from the cut profile  the advantages of this
method was that it requires only dnase cut sites and did not rely on other information such as tf motif
similarity score  distance to transcription start site  and sequence conservation  which is extra
information that must be inferred and is not without its own underlying uncertainty 
 i 

figure    representative x s  number of cuts is plotted against nucleotide position with the cognate tf sequence centered 
 i 
 i 
 i 
the x with y     is in black  the other with y      red 

results
at first blush  the dnase cut profiles between tf bound and not tf bound seem distinct enough  and
one may presume the problem to be easily solved  this unfortunately did not prove to be true  we first
employed linear support vector machine  svm  model  with rather poor results  precision        recall
      l  regularized linear logistic regression was no better  precision        recall         finally  we
tried another svm model using the radial basis function as kernal   which was a better fit but still poor
figure    average cut profile after features  precision      recall       the data used were dhs
modified  e x y    for the forward strand is results for human embryonic stem cell h  with tf atf 
represented in black  e x y    for the reverse
chip seq data as the gold standard  all generated from the
strand  red  e x y    for the forward strand  blue 
encode project  http   www genome gov           
e x y    for the reverse strand  green 
in the aforementioned computations  the error was
unacceptably high in the context of using the training set as
the test set  this result implied a problem of bias  we
therefore sought to reformulate the features  a careful
look at the features of individual data points suggested this
was the right path to take  although on average  the x i s
between those with y i      and y i      are very different
 figure     on an individual case by case basis  the
difference is not so easy to distinguish  figure    
one of the steps pique regi and colleagues performed in

page    

fishin lin
cs    final project
identifying transcription factor binding by the dnase hypersensitivity assay

processing their data was to distinguish between cuts of the forward strand from those of the reverse   
also  it seemed that using cuts approximately    nt to the left and right of the cognate tf motif was
excessive  since the peripheral positions seemed to harbor few cuts  the range was reduced to    nt to
the left and right of the motif  the subsequent svm fit with the radial basis function as kernal was
improved with a better recall  precision      recall      
we next sought to understand the reason for the mistakes from this svm model  figure   shows a plot
of the average cut profiles of the true positives  tp   false positives  fp   false negatives  fn   and true
negatives  tn   in this representation  the values of the forward and reverse strands are placed end to
end  i e  the forward strand runs from positions   to      the reverse strand       to       as can be
seen  the svm model does separate out the different cut profiles well in the sense that the tp and fp as
figure    average cut profiles from svm fit  points are stratified as true well as the fn and tn appear similar 
positives  black   false positives  red   false negatives  green   and true this plot suggests that the there may be
negatives  blue  
issues with the training data  rather
than with the model 
indeed  the gold standard may not be  in
fact  perfect  the presence of a bound
tf was inferred probabilistically from
chip seq experiments  operationally 
the tf peaks were called with quest  
which has a fairly stringent threshold 
heretofore  a region with a specific
motif was considered not to harbor a tf
if quest did not call a chip seq peak in
the region  however  there could have
been regions for which there was mild moderate evidence for tf binding that quest discounted  these
same regions could have had very strong evidence for tf binding by the dhs assay  our method would
leave these potentially mislabeled points in the training set 
to address this issue  the training set was reconstituted with stricter criteria for designating a region not
tf bound  briefly  the area had to have had significantly more control sequences over tf sequences to
be considered a negative data point  for more on how chip seq is analyzed  please refer to valouev et
al     after fitting the svm model  we achieved precision of      and recall of      these numbers
were calculated using    fold cross validation 
a natural question is how these methods compare with the work of pique regi et al   and boyle et al   
the latter framed their validation in a subtly more nuanced manner and will not be considered in this
work  the former used other information in addition the dhs cuts  viz  tf motif similarity score 
distance to transcription start site  and sequence conservation   and moreover the group s data sets
were not available to us 
to directly compare our svm model with the hierarchical mixture model of pique regi et al     we
analyzed the dhs data of lymphoblastoid line gm      and the tf ctcf chip seq data  with the svm
model with the radial basis function kernal fitted by    fold cross validation  we achieved a precision of
    and recall of      this compares favorably with pique regi and colleagues  reported results of
       and        for the same measures  respectively  of note  our results are no worse even

page    

fishin lin
cs    final project
identifying transcription factor binding by the dnase hypersensitivity assay

though the latter used other biological information in making final calls  the comparison must be
viewed with a jaundiced eye  however  because we did not use precisely the same validation set as they
did  even though we started with the same raw sequence files  the actual data points abstracted from
these sources were different 
to make an even more direct comparison  we ran pique regi et al  s hierarchical model implemented in
r  package centipede  on our ctcf data  we used only the gm      dhs cuts as input  the model
achieved a precision of     and recall of      the decrement in accuracy may be attributed to not
using extra dhs information  increased difficulty of our data set  and or the lesser discriminatory power
of their hierarchical model vis a vis an svm one 
discussion
we have shown that svms can be a powerful tool to distinguish between regions with tf binding and
non binding with the dhs assay  further work must be done to compare the method with others for
many more transcription factors beyond ctcf  another avenue is to see if the same svm fit can be used
across multiple  or maybe all tfs   the concept of boyle et al  s hmm sought to achieve this objective 
pique regi et al  s model required a different model to be fit for every tf 
this last point has important implications for how dhs data can be used to supplant an exhaustive set of
chip seq tf experiments to elucidate the cellular regulome  the promise of dhs data was not only to
define the positions of known tfs  but to allow identification of new ones  which would only be known
by their sequence motifs  since the hierarchical model must be fit for every new tf  the identification of
new tf positions is not as direct 
it is by no means impossible  pique regi et al  were able to achieve this goal by looking for sequence
motifs not previously described across dhs cut enriched areas  having identified common motifs  they
fit their hierarchical model for each set of regions with a common  novel motif 
this is in contradistinction to what boyle et al  s approach can possibly do  and what the svm can
potentially do better   a single model may be run across the dhs cuts across the genome  regions
marked highly probability of bound tf are marked  the search for common motifs can then be
relegated to a much smaller search space  the material difference of these two approaches is that this
latter method can identify motifs of low abundance across the genome  further work will be required
to realize this goal 
references
  
pique regi r  degner jf  pai aa  gaffney dj  gilad y  pritchard jk  accurate inference of
transcription factor binding from dna sequence and chromatin accessibility data  genome
res               
  
boyle ap  song l  lee bk  london d  keefe d  birney e  iyer vr  crawford ge  furey ts  highresolution genome wide in vivo footprinting of diverse transcription factors in human cells 
genome res               
  
fan re  chang kw  hsieh cj  wang xr  lin cj  liblinear  a library for large linear classification 
journal of machine learning research                   
  
chang c  lin c  libsvm  a library for support vector machines  acm transactions on intelligent
systems and technology                 

page    

fishin lin
cs    final project
identifying transcription factor binding by the dnase hypersensitivity assay
  
  

valouev a  johnson ds  sundquist a  medina c  anton e  batzoglou s  myers rm  sidow a 
genome wide analysis of transcription factor binding sites based on chip seq data  nat
methods                    
r  a language and environment for statistical computing  computer program   version       

page    

fi