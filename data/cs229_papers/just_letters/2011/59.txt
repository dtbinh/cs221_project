 

cs    project  yang zhang            dec     

interpreter aided salt boundary segmentation using svm
regression shape deformation technique
problem introduction
for the seismic imaging project in offshore oil and gas exploration  a good
velocity model is a must in order to achieve the best seismic image quality  accurate salt
body geometry extraction is a key component in the velocity model building workflow 
however  salt body boundary picking is a very human intensive procedure even with the
help of currently available automatic picking tools 
it is very unlikely that there can be a super algorithm that can fully automates the
boundary extraction procedure without sacrificing the result quality  therefore this report
addresses the problem of automatically and accurately segmenting the salt body in a
series of neighboring seismic slices given only the accurate salt segmentation result on
one single reference slice  this is achieved with a landmark based shape deformation
technique plus svm style regression  in this way  we can achieve the optimum trade off
between the amount of manpower and the quality of segmentation result 
due to the large noise in seismic data  simple image processing filter plus local
boundary tracker algorithm gives very poor result or fails easily  very often some parts of
the salt boundary are just missing due to poor illumination or miscellaneous source of
noise  see fig     human interpreter s inputs at these trouble regions are essential
 halpert        
however as today s seismic imaging practices evolve to   dimensions  think that
the   d images now becomes   d volume   it would be too time consuming for the
human to manually take care every single slice  therefore the idea of manually
segmenting only a small amount of key slices and then intelligently propagating these
results to the entire volume comes into play  here i use a land mark based shapedeformation technique to propagate a single slice of manual segmentation result into its
neighboring slices  thus yielding much better segmentation result than simply applying
automatic methods  the design goal for such intelligent boundary propagation consists of
two parts 
 first  i ask the new boundary to honor the available boundary information that
can be extracted from the image 
 secondly  the new boundary should preserve the shape information known from
the manual segmentation input  such that the boundary will deform reasonably
where we dont have well defined boundaries 

methodology
similar situations are encountered in the medical imaging field as well  my
approach is based on the paper from wang        in iccv      please refer that paper
for details   i will briefly describe this workflow in the following paragraphs 
let me define the references image slice that has been properly segmented as the
template image  and define the image that we want to propagate the segmentation result
to as the input image  the segmentation result in the template image is characterized by a
set of contours  for simplicity  we consider the case in which the template contains only
one single closed contour  extension to the case of multiple contours is straightforward 

fi 

cs    project  yang zhang            dec     

 a 

 b 
fig    a  a typical seismic image showing the salt body in the center  some parts of the
boundary are not well depicted due to the very limited image quality   b  the same image
shown with the human interpreted boundary 
we represent the known contour as a set of landmark points  v  v  v     vn 
where vi    xi yi   then for each landmark vi  the proposed method first identifies a set of
possible corresponding landmark points bi    vi j   j         ni  on the input image  where
vi j   xi j  yi j    then conceptually the problem is solved in two major steps 
   identify the best landmark point vi  from the landmark set bi such that v     v   v     
vn   located in or near the real object boundary in the input image 
   deform the prior shape v to match v  while keeping the general shape characteristics
of v 
the cartoon below illustrates this landmark searching step 

fig  search for best landmarks on the input image based on the initial landmarks in the template  wang        

fi 

cs    project  yang zhang            dec     

in practices  it is difficult to determine the best landmark point vi  in advance  and
therefore we just choose randomly an element in bi as the initial set v  and iterate this
process during which we update the set v  such that v  more likely contains the correct
corresponding landmarks 
the deformation step is formulated by finding the optimal solution to an objective
function which takes into account both the goal of deforming the points in v into the
current landmark set v  and the goal of preserving the prior shape v  use the bending
energy formula from bookstein          the objective function is shown below
   
in which t defines the deformation as a mapping  i e  t   x y   f x y  g x y    x  y   
function q describes the term that penalizes the mismatch between v   the landmarks we
found on the input image  and the mapping defined by t v   such term corresponds to the
first goal mentioned at the beginning of this paragraph  function   t  is a regularization
term  which tries to force the mapping to t be smooth  in other words  preserving the
global shape information of the original v 
we can see that these two terms are fighting with each other  therefore a  
 
parameter is added to balance these two parts  the optimization
is solved using the
classical svm optimization technique  the fitting outliers are identified by the supportvectors  therefore we use this information to update the estimate of the best landmarks s
et v   i iterate the procedure above for a few iterations 

experiment results
i test this algorithm on a   d seismic image cube from gulf of mexico survey 
the cube is of discrete size    x   x   in depth z  inline x  crossline y  directions
respectively  i have the human interpreted segmentation result in slice   only  which i use
as the template image  i did initial processing on this segmentation result to extract the
template landmarks as shown below 

fig   preprocessing flow on the segmentation result of the input image     build the saltbody mask     extract the boundary     subsample to a list of landmarks     find the outnormal directions for each landmark on the contour 
to find candidates for the set bi  i overlay the landmark on the input image  neighboring
slice   then i search along the normal direction for certain image features which might
suggest the position to be a part of boundary  here i just use a very simple criterion  i
choose the image locations that the image envelope amplitude local maxima lie as the
boundary point candidates 

fics    project  yang zhang            dec     

 

then i run the svm optimization for a few iterations  within each iteration i identifies all
the support vectors  which corresponds to the fitting outliers   for each support vector
index i  i try to use other candidates in bi set such that the fitting   hi     i   gets improved 
fig   the update of set v  in one
iteration 
blue indicates all support
 
vector points  red shows the
original points in v   green shown
the updated v  set by replacing the
badly fitting point vi  with better
fitting candidates in bi 

finally i deform all    slices one by one  from slices close to the template slice to slice
far from the template  in figure    i show the comparison between the obtained deformed
boundary and the boundary found by automatic methods  the improvement is very
prominent 

conclusion
in this paper  i propose to improve the salt body segmentation for   d seismic
images by deforming the accurate boundary on human interpreted slice into the
neighboring slices  the deformation not only honors the available boundary information
on the input slice  but also preserves the shape information from the template slice  the
numerical examples show very promising results 

references





song wang  weiyu zhu  zhi pei liang     shape deformation  svm regression
and application to medical image segmentation   computer vision        iccv
      proceedings  eighth ieee international conference on  vol    no   pp        vol        
halpert  a   r  g  clapp and b  l  biondi        interpreter guidance for
automated seismic image segmentation  presented at the   th annual
international conference and exhibition  eage 
bookstein  f l    principal warps  thin plate splines and the decomposition of
deformations  ieee trans  pami              june      

fi 

cs    project  yang zhang            dec     
fig    the
segmentation result for
slice no          
using the boundary
deformation  left
column  and using the
simple automatic
methods  right
column  

fi 

cs    project  yang zhang            dec     

appendix
math details for solving the optimization  you can safely skip it if you are not
interested 
with regard to the actual form of the objective function in      particularly i
choose function q to be the   insensitive l  norm  as the following

 
since new landmarks in v  is searched along the shapes normal direction ni  we confine
that the desired mapping t v  should map along ni as well  i e 
   
t v i     v i     ini  
since points in v  is found along normal directions of v as well  we have v i    v i   hini  
then the previous objective function can be written as
 
 

subject to constrain     
as for   t    we choose the so called bending energy term  it is defined as
 

 

where
  the nice thing about choosing such bending
energy term  is that we know in advance  given all the mapping t that satisfies constrain
     the thin plate spline interpolation will minimize the bending energy  bookstein 
       which takes the form  t    f g   and
k is the well known thin plate kernel function 
as shown in wang        we can also represent   t  with the vector
       i   i           n    therefore this variational problem  optimization with variables as
functions  turns into one much simpler numerical convex optimization problem  then we
just try to find the optimal        i   i           n  that
 

 

 

 
 
here x   y is the vector representation of the first and second coordinates of the points in
set t v   keep in mind that t v i     v i     ini   
using the standard svm technique  we can instead solve the dual problem according to
the k k t  condition  it ended up as being a standard quadratic programming problem
with both upper and lower bounds  see wang        
 

fi