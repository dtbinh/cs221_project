predicting differential drug response using demographic based variation in gene
expression profiles
michael januszyk and sarah xing
introduction
demographic factors have frequently been
shown to influence disease outcomes and drug
response  however  these relationships are typically
derived through de facto trial and error in the clinic 
and the associated learning curve is expensive both
in terms of healthcare costs and patient safety   the
need for a systematic strategy to prospectively
identify such interactions is well recognized within
the medical community     however  until recently 
the biomedical informatics infrastructure has been
insufficient to support such large scale endeavors 
and these goals remain largely unattained  
clinical decision support models using
known pharmacologic relationships have proven
highly effective for identifying and avoiding
specific adverse drug drug interactions   they have
also been used successfully to modulate dosing for
a handful of high risk drugs using demographic and
genotypic information   however  due in large part
to inconsistencies within the structure of electronic
medical records  emr   the overwhelming majority
fail to routinely incorporate even the most basic
non pharmaceutical information  
emr also provide a fertile testing ground
on which to rapidly evaluate suspected clinical
relationships  emr based approaches have inherent
advantages over traditional retrospective chart
reviews in terms of both efficiency and accuracy  
this form of in silico validation is a particularly
powerful tool when paired with public data driven
approaches to biomedical discovery  as this
effectively affords an environment of paperless 
zero patient risk clinical research 
we developed a novel bioinformatics
pipeline with which to identify candidate drugs for
which specific demographic attributes may
modulate clinical outcomes  in order to evaluate
putative drug demographic relationships  we apply
various machine learning techniques using high
temporal resolution patient data obtained from an
electronic health records database  our goal is to
leverage genomics derived knowledge in order to
more effectively identify patients likely to elicit an
abnormal response to a given drug  such a method

would provide a useful adjuvant to the existing
paradigm of drug based decision support models 
methods
we constructed a biomedical informatic
pipeline using publically available genomics and
pharmacological databases in order to identify
putative drug demographic associations  this
consisted of three principal phases  figure        
identify genes whose differential expression
profiles exhibit demographic linkage over the scope
of thousands of microarray experiments     
translate these demographic gene associations into
demographic gene drug or demographic geneprotein drug relationships using pharmacologic
databases      evaluate putative demographic drug
relationships through the construction of machine
learning models trained using an emr database 
                                                
  
                                 

a  b                                           c   
                                       
  
 
  d   e  fg h     ie  

j   k                         c  l                    
              m c   no c  c       c      
  
 
                 g d   pq    

j a  qr        l                              l   
      cp          c        c       
  
 
 
  q q n     

fig     bioinformatic pipeline for the identification and
evaluation of putative demographic drug associations 

   identifying a list of candidate genes
we began with a meta analysis of the      
human microarray datasets currently available in
geo  gene expression omnibus   a public
genomics data repository maintained by the nih  
our initial query for gender specific human
microarray series produced    datasets with at least
one sample from each sex  corresponding to      

fiindividual microarray samples  mean       
chips dataset  and spanning four distinct gpl
platforms  individual microarray chips were
classified according to gender  as well as one
principal experimental variable  typically subject
disease status  e g   healthy vs  diseased  or tissue of
origin  e g   bone marrow vs  blood    and each
dataset partitioned accordingly 
for each dataset  j  j  we computed
separate mean signal intensity values  proportional
to the logarithm of mrna content  for samples
belonging to each of these four groups  male
treatment  male control  female treatment  and
female control   as well as the associated groupwide variance  we then evaluated the differences in
mean intensities for male  treatment vs  control  and
female  treatment vs  control  samples 

and defined the gender based differential response
as the difference of these differences  i   imale ifemale   which is the log ratio of mrna foldchange variation in response to treatment 
we computed gender based differential
responses  is  independently for every unique
gene           within each dataset  we then
combined the i values from each dataset j
according to 

that is  for every gene  the mean change in signal
intensity response associated with each dataset was
weighted according to both the number of samples
in that dataset  n j    as well as the variance among
those samples    j      in order to arrive at a single
dataset wide mean change in signal intensity
response   i bar  
   classifying and ranking candidate drugs
pharmgkb and drugbank are publicly
available  human curated pharmacology databases
containing  among other parameters  confirmed or
suspected drug gene interactions  all        genes
obtained from the geo analysis described above
were routed through pharmgkb and drugbank to
identify known drug gene interactions overlapping
with our top i rated genes  gene drug
interactions  and  implicitly  gene protein drug
interactions  were stratified according to the nature

of interactions  e g   target  transporter  and
enzyme  and cross listed between databases using
drugbank ids  weighted scores were then
constructed for each drug according to the average
i associated with each of its gene interactions
divided by the total number of gene interactions for
the given drug  non fda approved drugs were
excluded from this analysis  thus  a list of drugs
with suspected drug gene interactions was produced
and sorted by weighted i  because i is a
proxy for demographics factors  gender  in this
case   the list can also be interpreted as being sorted
by predicted degree of drug gender interaction 
   evaluation of putative drug demographic
relationships using electronic health records
mimic ii  multiparameter intelligent
monitoring in intensive care  is a publicly
available repository of electronic medical records
data  including lab values  from the beth israel
deaconess medical center intensive care unit
covering approximately        patients across
multiple icu admissions  and also contains high
temporal resolution telemetry data for a subset of
patients  telemetry data includes second by second
measures of respiration rate  heart rate  arterial
systolic blood pressure  arterial diastolic blood
pressure  and mean arterial blood pressure  using
mimic  putative demographics driven variations in
drug response can be evaluated for top candidate
drugs identified from the steps above 
for each top ranking drug in our list  we
identified the number of mimic patients to which it
was administered  as well as the frequency of
administration  as expected  nearly half of the
drugs in our list were never administered to patients
in mimic  consistent with the character of an icu
population  the remaining drugs  along with their
relative ranking and administration frequency  were
manually reviewed by a physician  m j   in order to
identify those whose efficacy was most readily
testable given the breadth and temporal resolution
of the parameters available in the mimic icu
database  testable outcomes were limited to lab
values  e g   serum na   k   and telemetry
 including cardinal vital signs   using these data 
we were able to assess how each patients values
responded to a target drug administration in order to
study the pharmacodynamic effects of the drug on
the patients system 
we identified the antiarrhythmic drug
amiodarone  the antihypertensive drug furosemide 

fiand the heart failure drug metoprolol  as frequently
administered drugs with testable outcomes seated
high on our drug  gene  demographic interaction
list  amiodarone and metoprolol are known to
decrease heart rate  sometimes to the point of
bradycardia   and furosemide and metoprolol both
decrease systolic blood pressure  sometimes to the
point of frank hypotension   we evaluated whether
demographic factors will have a differential effect
size on modulation of heart rate and blood pressure 
to test this hypothesis  we queried mimic
ii for all available data on patients receiving these
three drugs in the icu  for every patient  the first
pharmacy order for each drug was identified  and an
administration schedule derived to determine the
earliest administration date and time  a similar
process was repeated for each pharmacy order for
each patient to identify any other drugs
administered within    hours of this time point 
demographics data  age  sex  and route of
administration were also determined 
of the patients initially identified in
mimic as having received each drug  roughly half
had corresponding telemetry data overlapping the
drug administration period  for each patient  we
averaged telemetry data over every    second
period and identified the minimum heart rate and
blood pressure within a one hour window following
the first administration of each drug  we then
classified patients as having a slow heart rate
 determined as minimum heart rate less than     or
low blood pressure  determined as minimum
systolic blood pressure less than     during the one
hour window following first administration  such
patients appear to be strong responders  sometimes
pathologically so 
we then sought to determine whether
demographic factors were significant predictors of
differential response to our target drug  for each
patient  a set of binarized features was determined 
age over     sex  oral or iv route of drug
administration  and previous administration of     
other drugs  each of which was administered to at
least one patient in our dataset  we then performed
feature selection using the sequential forward
search algorithm  with ten fold cross validation as
the optimization function over the following
classifiers      logistic regression      random
forest      support vector machine  and     nave
bayes with laplace smoothing  for each classifier 
the results of    fold cross validation     fold cv 
were recorded using strictly pharmaceutical factors 

non pharmaceutical factors  e g   age  gender   and
features selected from the combined set 
results
generation of candidate gene list
the top i ranked genes resulting from
our initial analysis of geo are shown in figure   
as expected  several of the top genes by i score
are located on sex linked chromosomes  x y  
including clic   usp y  and ddx y 
interestingly  among the non sex linked genes  the
matrix metallopeptidase mmp  ranked highest 
this protein is critical to bone remodeling  and
these differences may reflect  in part  gender based
differences in bone density and composition 
gene
symbol
mmp 
clic 
lcn 
pvalb
usp y
ceacam 

chromo
some
  
x
 
  
y
  

ido 
ddx y

 
y

gene name
matrix metallopeptidase  
chloride intracellular channel  
lipocalin  
parvalbumin
ubiquitin specific peptidase    y linked
carcinoembryonic antigen related cell
adhesion molecule  
indoleamine     dioxygenase  
dead box polypeptide  

fig     selection of top i ranked genes from geo human
microarray analysis 

identification of candidate drugs
we combined our list of top gene
candidates with gene drug interaction data obtained
from drugbank and pharmgkb in order to
evaluate whether demographic factors associated
with differentially responsive genes can be linked
via
known
gene drug
interactions
to
demographically  differentially responsive drugs 
among the most highly implicated drugs  many had
physiologic axes that intersected trivially with
gender  e g   estradiol  testosterone   and others
could not be tested either because that drug was not
given routinely in the icu  e g   melatonin  or no
readily evaluated emr outcomes were available
 e g   tamoxifen   of the remaining top drugs  three
were manually selected  m j    and paired with one
or two testable clinical outcomes  figure    
drug

class

rank

clinical outcome

amiodarone
metoprolol

antiarrhythmic
beta blocker

  
  

furosemide

diuretic

  

bradycardia
hypotension 
bradycardia
hypotension

fig     top ranked  testable candidate drugs 

fiamiodarone
 bradycardia 

metoprolol
 bradycardia 

metoprolol
 hypotension 

furosemide
 hypotension 

baseline hr

baseline hr

route

metoprolol

gender

age

baseline sbp

baseline sbp

metoprolol

route

pantoprazole

atorvastatin

age

gender

gender

aspirin

route

nitroglycerin

age

furosemide

acetaminophe
n

atorvastatin

vancomycin

calcium

aspirin

amiodarone

furosemide

amiodarone

albuterol

albuterol

aspirin

clopidogril

fig     top selected features for each drug outcome by vote
among the four models  lr  rf  svm  nb  

machine learning
for each of these candidate drugs  we
constructed four classifiers  logistic regression
 lr   random forest  rf   support vector
machines  svm   and nave bayes  nb  to predict
the associated clinical response  bradycardia and or
hypotension  as a binary variable  corresponding to
strong and weak responders as described above  we
initially limited our input features to the list of coadministered drugs  i e   all drugs given to the
patient within a    hour window beforehand  
which is the set routinely employed by emr based
decision support models   we then repeated our
training evaluation using exclusively nonpharmaceutical factors  e g   age  gender  relevant
vital signs   and performed a third evaluation using
the combined feature set 
due to the large number of features       
relative to the number of patients in the
pharmaceutical and combined feature sets  we
employed feature selection using the sequential
forward search algorithm  with ten fold crossvalidation  to determine a set of features for each
drug classifier pair  figure   shows the results
 condensed for clarity by voting among the four
models  of the top   features selected for each drug 

not surprisingly  figure   recapitulates
several well known drug drug interactions  such as
metoprolol and pantoprazole  which are both
metabolized by the liver enzyme cyp d     other
entries represent obvious physiologic interactions 
such as amiodarone and metoprolol  each of which
acts independently to slow cardiac conduction  and
thereby heart rate   while some drugs such as
aspirin likely function as a proxy for icu patient
stability  interestingly  the importance of gender as
a feature correlated roughly with the drug ranks
from figure   
using the resulting feature sets  we
evaluated each model using ten fold crossvalidation for all four drug response combinations
 figures       although none of our classifiers
achieved an accuracy of greater than     for any
single drug  each optimal model did considerably
improve upon the baseline incidence rates
 amiodarone        metoprolol            
furosemide         corresponding to the trivial
knn  k   n  classification  these results are
consistent with those typically accepted in the
context of the information loss inherent to the
binarization of complex  continuous clinical
outcome variables   
it is also noteworthy that in nearly all cases 
the addition of non pharmaceutical features
improved the predictive ability of our models  this
was most pronounced for amiodarone and least so
for furosemide  consistent again with the relative
strengths of their demographic based differential
responses  surprisingly  in several cases  the nonpharmaceutical feature sets actually outperformed
their training counterparts  these results in
particular strongly support the argument for an
expansion of drug based decision support systems
to incorporate readily available  ancillary clinical
information 
metoprolol  bradycardia 

amiodarone  bradycardia 

logistic
regression
random
forest
svm
nave
bayes

pharmaceutical
only
     

nonpharmaceutical
     

all features
     

     

     

     

     

     

     

     

     

     

fig     ten fold cross validation accuracy for bradycardia
following amiodarone administration 

logistic
regression
random
forest
svm
nave
bayes

pharmaceutical
only
     

nonpharmaceutical
     

all features
     

     

     

     

     

     

     

     

     

     

fig     ten fold cross validation accuracy for bradycardia
following metoprolol administration 

fimetoprolol  hypotension 

logistic
regression
random
forest
svm
nave
bayes

furosemide  hypotension 

pharmaceutical
only
     

nonpharmaceutical
     

all features
     

     

     

     

     

     

     

     

     

     

fig     ten fold cross validation accuracy for hypotension
following metoprolol administration 

conclusion
we have shown that it is possible to
integrate large volumes of publically available
human transcriptional data with open access
pharmacologic databanks to identify meaningful
demographic gene
and
demographic gene protein  drug associations  further  we have
demonstrated that the strength of these associations
can be evaluated through the application of machine
learning algorithms to a database of electronic
health records  and that for specific candidate drugs 
models incorporating these relationships outperform
those using only the default input parameters  in
this case  co administered drug records  
moving forward  we anticipate that the
continued rapid expansion of the bioinformatics
resources from which our method draws will serve
to make such an approach increasingly valuable in
the coming years 

logistic
regression
random
forest
svm
nave
bayes

  

  

  

  

  
  
  

   

references
  
  

kemper  e m   et al  towards evidence based
pharmacotherapy in children  paediatr anaesth    
               
parekh  a   fadiran  e o   uhl  k   
throckmorton  d c  adverse effects in women 
implications for drug development and regulatory
policies  expert rev clin pharmacol           
       

nonpharmaceutical
     

all features
     

     

     

     

     

     

     

     

     

     

fig     ten fold cross validation accuracy for hypotension
following furosemide administration 

acknowledgements
we would like to thank our erstwhile cs    
colleague bob arrigo for his sustained efforts
throughout this project  as well as professor nigam
shah for facilitating our access to the mimic ii
database 

pharmaceutical
only
     

   

mulla 
h 
understanding
developmental
pharmacodynamics 
importance
for
drug
development and clinical practice  paediatr drugs
                   
galanter  w l   didomenico  r j    polikaitis  a 
a trial of automated decision support alerts for
contraindicated medications using computerized
physician order entry  j am med inform assoc    
               
xu  h   et al  facilitating pharmacogenetic studies
using electronic health records and naturallanguage processing  a case study of warfarin  j am
med inform assoc                    
overby  c l   tarczy hornoch  p   hoath  j i  
kalet  i j    veenstra  d l  feasibility of
incorporating genomic knowledge into electronic
medical records for pharmacogenomic clinical
decision support  bmc bioinformatics    suppl   
s          
wheeler  d l   et al  database resources of the
national center for biotechnology information 
nucleic acids res                  
kohavi r  j g  wrappers for feature subset
selection  artificial intelligence              
       
tamblyn  r   et al  a randomized trial of the
effectiveness of on demand versus computertriggered drug decision support in primary care  j
am med inform assoc                    
nozawa  t   et al  influence of cyp d  genotype
on metoprolol plasma concentration and betaadrenergic inhibition during long term treatment  a
comparison with bisoprolol  j cardiovasc
pharmacol                    
lin  f p   anthony  s   polasek  t m   tsafnat  g 
  doogue  m p  bicepp  an example based
statistical text mining method for predicting the
binary
characteristics
of
drugs 
bmc
bioinformatics                

fi