machine learning approaches to breast cancer diagnosis and
treatment response prediction
katie planey  stanford biomedical informatics
   introduction
given the disease severity and wellpublicized philanthropic efforts concerning
breast cancer  it is not a new arena for
medical researchers  computational or
otherwise  the goal in most breast cancer
classification problems is to determine
whether a patients lesion is malignant or
benign 
machine
learning
has
been
successfully applied to this problem in
recent years  for example  a group in turkey
reported higher than     accuracy for svm
classification on the widely used wisconsin
university breast cancer dataset  however 
the holy grail of machine learning
techniques that fuse high or even reasonable
accuracy with readily accessible features
from the average clinic has proved elusive 
the previously mentioned group used
carefully measured pathological features
such as single cell epithelial size and
mitoses that are not always included in a
standard clinical report   thus  it is still
highly clinically relevant to search for breast
cancer machine learning features that are
highly predictive of disease state 
this project lays the foundation for
continued research on two machine learning
applications to breast cancer  predicting
malignant vs  benign tumors to aide in
biopsy decisions  and predicting whether a
patients cancer will successfully respond to
specific treatment regimens 
   methods
    diagnosis dataset
this dataset from stanford
radiology includes patients who had
suspicious breast lesions and underwent mr
scans  after radiologist inspection of the
mri  results were still inconclusive for   

patients  and thus these patients had biopsies
and pathology reports done to determine if
the tumor was indeed malignant  thus  these
patients did not have obvious malignant or
benign tumors  the tumors themselves were
often difficult to even identify on a scan 
the dataset includes    lesions total
 one patient had two lesions   and      
were path proven malignant tumors  this
means that there was an unnecessary biopsy
for       of tumors 
      features
the currently available data beyond
the biopsy confirmed response variable of
malignancy status incudes the three basic
measurements of age  longest tumor length 
and adc  or apparent diffusion
coefficient  adc maps are created from
diffusion weighted images  dwi   adc
measurements provide a quantitative
measure of the underlying vasculature in
tumor structures by measuring water flow
patterns through the tumors 

dwi

adc

dwi scans  and therefore adc
values  are not yet widely used in clinical
practice  mainly due to dwi being a
relatively new mr technique  however 
adc values have proven correlative to
tumor status  and further supporting
evidence such as its utility as a machine
learning algorithm feature could impact
clinical imaging protocols 

fi    treatment dataset
stanford is the main treatment center
for a phase ii neoadjuvant breast cancer
study of gemcitabine  carboplatin  and poly
 adp ribose  polymerase  parp  inhibitor
bsi      neoadjuvant therapy implies that
chemotherapy or other drugs are given to a
patient before surgical removal of the tumor 
in an attempt to shrink the tumor and
prevent re growth  and or avoid a complete
mastectomy  in certain patient groups 
neoadjuvant therapy has proven efficacious
in eradicating cancer growth  

pre treatment

post treatment

while gemcitabine and carboplatin
are standard chemotherapy treatments  the
parp inhibitor is a novel therapeutic agent
recently shown to increase progression free
and overall survival in triple negative breast
cancer patients   this class of breast tumor
is known to be extremely aggressive  and 
until the parp inhibitor drug  it was often a
grim diagnosis for this patient subset 
some patients have had dramatic
results on the drug  such as the patient
above  whose tumor essentially vanished
after parp inhibitor treatment 
      features
the trial is ongoing  at this point in
time  the final dataset used included   
patients and    multinomial features 
outlined in table i  all input features were
measured before treatment or only after  
cycle of treatment  patients had a total of    
treatment cycles   the response variable was

a binary complete or incomplete pathologic
response 
unfortunately 
most
of
the
quantitative mri measurements are not yet
complete  due to hipaa anonymization
pre processing requirements   and thus
could not be included in this initial
experiment  however  the current dataset is
still quite rare  given that it includes
pathology tissue results of both the lymph
nodes and main tumor  and gene tests 
table i  key parp features
term
definition
demographics
race ethnicity of patient
age
age in years
clinical stage
  iv  iv  most aggressive
node sample
biopsy result  cancerous or
benign 
node imaging
nodes present on mri 
node baseline
nodes palpable to clinican 
node c d 
palpable after   drug cycle 
initial measurement initial tumor size
c d  measurement size after   drug cycle
total drug cycles
  or   cycles
pathology grade
         fastest cell growth
brca   gene test positive for known harmful
brca   gene mutations 
brca   gene test positive for brca   gene
mutations 
mri tumor length length  cm  on mri
pathologic response response variable  patient
fully responded to treatment
or had an incomplete
response  i e  cancer is still
present after all cycles
completed 

   pre processing
    diagnosis dataset
following hipaa protocol  i
downloaded all patient scans from stanford
pacs  picture archiving communication
system  and anonymized them  i was given
a brief tutorial by stanford radiologist dr 
bruce daniel on how to identify breast
lesions so that i could compute length and

fiadc measurements using osirix  an opensource dicom viewing software 
    treatment dataset
for the treatment dataset  i had
access to stanfords redcap database  a
secure online site that stores irb approved
study information  there were
approximately    features total  and i
consulted stanford radiologist dr  jafi
lipson to understand the clinical
significance of each feature  i then chose
features based on both clinical significance 
and how many patients already had a
specific feature measured  in an attempt to
maintain a reasonably sized dataset 
    discretization
in order to test classification rates
using models such as nave bayes  logistic
regression  and svm classification  all
features had to be discretized  in the
diagnostic dataset  all three input features 
age  tumor length  and adc value  were
discretized  and in the treatment dataset  age
and any tumor measurements were
discretized 
in an attempt to create biologically
intuitive models  i did not simply assign a
blanket number of discrete states to all
features  as this would mean that for any
categories in which no observed feature
occurred  i would have to assign this zero
state a small nonzero probability to avoid
computational issues  yet consider the
tumor length feature in the treatment dataset 
none of the patients had tumors less than  
cm in diameter  as this was a patient
entrance criterion for the trial 
assigning a separate state to say
tumors below  cm would not create
computational errors  but it would create a
model that is fitting parameters based on a
nonsensical medical setting for this subset of
patients  thus  i took care to look at every
single feature in both datasets  continuous or

discrete  to decide the best discrete
categories  attempting to retain medical
intuition in breast cancer datasets is no new
phenomenon  gene signatures from machine
learning techniques have already come
under scrutiny  

  

figure      an  example  of  the  difficulty  of  biologically  
intuitive  discretization   here   one  can  see  that     
separate  categories  for        does  not  reflect  the  true  
patient  distribution  and  will  result  in  lower  statistical  
power  for  categories  with  extremely  sparse  data  points 

even in the already discrete category
of stage in the treatment dataset  no patients
had a stage of    therefore  i discretized the
lowest state to    stage    because this data
is only for extremely high risk patients  it
should be fit to optimize this patient cohort 
even if this limits model usage beyond
triple negative patients 
    matrix preparation for libsvm
once discretized  each category
within a multinomial feature was
represented as one binomial feature  while
not a requirement for all the classification
software packages used  the libsvm
development group at national taiwan
university recommend on their website to
prep the data matrices in this manner  sparse
matrices were then created using the
sparsem package in r 
    classification packages used
the diagnostic dataset was initially
run on a nave bayes multinomial model

fiwith laplace smoothing coded in matlab
and tested on a randomly selected    
holdout sample 
further classification attempts on
both datasets were done in r  using the
libsvm package  glm  and knn  knearest neighbor   for cross validation on
glm and knn  the cv glm and knn cv
functions were used  leave one out crossvalidation  loocv  was the only accuracy
measure employed on all models due to the
small size of these datasets 
   classification   results
    varying svm and glm inputs
for svm and glm  a wide array of
function inputs was tested  in svm  both
classification type i and type ii  labeled c
and nu in r  and all available kernels
 radial  sigmoid  linear  polynomial  were
tested  a range of function inputs such as
gamma and cost were also tested  in glm 
distribution models of binomial and
gaussian were tested 
testing various scenarios of these
function parameters did not lead to
significant increases in accuracy  this is
most likely due to the small size of the
datasets  no specific combination of
classification function inputs led to a
serendipitous jump in accuracy 
because logistic regression and gda
assume continuous outputs  i tested both the
discretized and original datasets  the
discrete diagnostic dataset had been split
into greater than five categories for each of
the three variables  leading to little
difference between discrete and continuous
states  most features in the treatment dataset
were already binary and could not be
construed as true continuous random
variables 
    diagnosis predictions
the key results from classification
models on the diagnostic dataset are listed in

table    logistic regression performed the
best with     loocv accuracy  it is
intuitive that a regression model performed
best  given that the original features were
indeed continuous 
it is reassuring that the nave bayes
model obtained     accuracy both with a
random     hold out sample in my own
matlab code  and with loocv in r 
table ii  diagnostic classification results
loocv
model
accuracy
nave bayes   laplace smoothing
   
k nearest neighbor  k   
   
k nearest neighbor  k   
   
logistic regression
   
svm type    sigmoid kernel
   

    treatment predictions
loocv accuracy rates deviated on a
wider scale for the treatment dataset than the
diagnostic dataset  for example  the
libsvm svm i function with a linear input
kernel resulted in     accuracy  while the
polynomial kernel with degree    the best
performer  resulted in     accuracy 
table iii  treatment classification results
loocv
model
accuracy
k nearest neighbor  k   
   
k nearest neighbor  k   
   
logistic regression
   
svm type    linear kernel
   
svm type    radial kernel
   
svm type    polynomial  d  
   

the high variability is most likely
due to the small sample size of    patients
with    multinomial features  resulting in
about    total binomial features  and the
dataset being a mix of continuous and
discrete variables  attempting to employ
knn beyond k   resulted in a significant
drop in accuracy  indicating that the dataset

fidid not contain many repeat patients of
similar feature inputs and response results 
because knn cv saves the prediction results 
i was  however  able to note that there was
not a significant difference in the number of
false positives and false negatives predicted 
on either dataset 
expanding the features in a higherdimensional space with a polynomial kernel
of   proved to provide the best results  with
   support vectors being chosen by libsvm
for the model  however  both logistic
regression and svm with a radial kernel
provided similar results 
   discussion   future work
    diagnostic data
even though a predictive accuracy of
    is not high enough for widespread
clinical use  it is surprising that with my
own untrained eye both identifying and
outlining tumors  my logistic regression
model performed better than the clinician
      in deciding which tumors should be
biopsied 
this result emphasizes the potential
utility of adc values in diagnostics 
additionally  a logistic regression using the
adc feature alone resulted in     loocv
accuracy  highlighting its predictive strength
as a stand alone feature 
i plan to present these initial results
to stanford breast cancer radiologists with
two aims     re identify and outline tumors
with the aide of a trained radiologist to
reduce noise  decrease error    recruit
radiologists to participate in studies that
compare their performance alone to
combined performance with machine
learning aids that incorporate adc values 
additionally  the diagnostic dataset
has a host of quantitative features in dcemri images that can be data mined  i hope
to employ unsupervised clustering
techniques to find quantitative  unbiased
feature inputs i can add to the model 

    treatment data
i am particularly excited about the
groundwork laid for the parp treatment
dataset  while the accuracy is only     at
the moment  imaging features have yet to be
added  i will also be working on another
treatment dataset from ucsf next quarter
that has hundreds of patients  is extremely
well curated  includes a wider range of
breast cancer types  and is longitudinal 
given that this small initial dataset
still achieved     predictive accuracy  work
on the more comprehensive ucsf dataset
could result in models that are truly
implemented in clinical practice 
   acknowledgements
i would like to thank dr  bruce
daniel and dr  jafi lipson for their
continued research collaboration  i am also
very grateful to dr  daniel rubin  my
research advisor  for guiding me through
both the trials of mri pre processing and
the design of novel feature experiments 

references
     akay  m   f            support  vector  machines  
combined  with  feature  selection  for  breast  cancer  
diagnosis                    
     woodhams  r    et  al           diffusion weighted  
imaging  of  malignant  breast  tumors   the  usefulness  of  
apparent  diffusion  coefficient   adc   value  and  adc  
map  for  the  detection  of  malignant  breast  tumors  and  
evaluation  of  cancer  extension   journal  of  computer  
assisted  tomography                         
     liedtke  c    et  al           response  to  neoadjuvant  
therapy  and  long term  survival  in  patients  with  triple 
negative  breast  cancer   journal  of  clinical  oncology         
              
     o shaughnessy  j    et  al           efficacy  of  bsi       a  
poly   adp ribose   polymerase     parp    inhibitor   in  
combination  with  gemcitabine carboplatin   g c   in  
patients  with  metastatic  triple negative  breast  cancer  
 tnbc    results  of  a  randomized  phase  ii  trial   journal  
of  clinical  oncology  meeting  abstracts            s        
     drier  y   domany  e            do  two  machine learning  
based  prognostic  signatures  for  breast  cancer  capture  
the  same  biological  processes   plos  one              e        

fi