automated market sentiment analysis of twitter for options trading
rowan chakoumakos  stephen trusheim  vikas yendluri
 rowanc  trusheim  vikasuy  stanford edu
abstract
we implemented predictive classifiers that combine economic analysis of stocks with features based on
natural language processing of twitter comments related to each stock in a specified portfolio to enable
options straddling stock trading strategies  identical svm models built on this combination set of features
showed an average improvement of      percentage points over economic analysis features alone  enough
to make an options straddling strategy profitable for some stocks in the portfolio  these results show that
information gleaned from twitter comments can be predictive of major stock price movements for
individual stocks 
introduction
stock trading is an open opportunity for
applications of machine learning algorithms  of
particular interest is a trading strategy called
options straddling  which allows a trader to profit
by betting that a stock will have a large price
movement  regardless of the direction of change 

consumer technology manufacturers and
consumer retailers   the types of companies that
we thought would be frequently discussed on
twitter  atvi  adbe  aapl  dell  erts  grmn 
mat  nflx  rimm  and urbn 

most public trading strategies use economic
models of individual stocks to predict days when a
stock will have a major price difference  mpd 
event  i e   when the opening price of a stock
changes by       of its previous opening value  
we propose that these standard economic models
could be improved by automated sentiment
analysis of twitter 

twitter data were acquired through a corpus
provided by yang   leskovec       which
contained        of tweets daily from junedecember       standard stock data  open close 
high low volume  were acquired from yahoo 
finance     for every trading day in the period
january december       all models were trained
from june    october              trading days 
and tested from october     december        
    trading days         of stock days in the
training period had mpd events  and       of
stock days in the testing period had mpd events 

this approach builds upon work by bollen et al 
     which showed the general sentiment reflected
in twitter posts was predictive of the the daily
closing direction of the dow jones industrial
average  i e   the entire market  with      
accuracy  we expand this work to focus on a
specific small portfolio of stocks  we further
expand it to become more directly applicable to an
options straddling strategy by predicting when
mpd events will occur for all stocks in our
portfolio  instead of predicting their future closing
direction 

methodology
choice of stocks
we chose a portfolio of    stocks from the
nasdaq stock exchange to test our classification 
based on previous work       which suggests that
quantitative analysis of public sentiment is most
useful with a large corpus of tweets  we selected

data  training and testing

metrics of success
because an options straddle trading strategy
necessitates trading only on days when there will
be a mpd event  accuracy is not a meaningful
statistic  we only need high precision when
predicting mpd events  for that reason  our
primary metric of success was high precision and
reasonable recall when predicting mpd events 
informal analysis of profitability of trading
strategies suggests that approximately    
precision when predicting mpd events could lead
to a    expected return per option straddle 
development methodology
we created classifiers in three phases  based on
the framework suggested by pham  chien   lim
    

fi   development of a baseline classifier that
uses only economic data to predict future mpd
events 
   development of classifiers based on analysis
of twitter data  and
   development of combination classifiers that
use both sources of data 

development and results

   baseline classifier  analysis of best features
and results

   baseline classifier  replicating bollen et al 
as a simple sanity check  we first
wanted to replicate the baseline
model  i   found in bollen et al 
a regression svm fit using the
smo method with a rbf kernel
and a complexity parameter of
       resulted in      
accuracy in predicting the future
close directions of aapl stock
based on the past three days of
close prices  these results are
within a     margin of error of
the results found in bollen  which
used a self organizing fuzzy
neural network 
this result suggested the
applicability of non linear svms
to the problem of predicting stock
events  a heartening first step 
   baseline classifier  mpd
events

resulted in the highest precision over the testing
dataset  we used weka       to quickly build and
test models      we found that back propagation
neural networks did not result in good fits in
general  with high bias on the training dataset 
based on the success with svm modeling  the rest
of the models we built and tested used these
choices of parameters 

table    information gain of
baseline classifier features
feature
i  gain
deviate eavg  amt 
      
 d derivative mavg   
      
deviate mavg   amt   
      
 d derivative mavg  
      
 d derivative mavg  
      
deviate eavg   amt
      
 d derivative mavg  
      
deviate mavg  amt
      
 d derivative mavg 
      
  normalized amount of deviation above the   day
exponential moving average of opening price    
normalized moving average of the one day
derivative of the opening price      normalized
amount of deviation above the    day opening
price moving average 

ta b l e   s h o w s t h e r e s u l t s o f
information gain analysis on the top   
constructed features  the results show
that none of the features are
particularly predictive of mpd events 
and those that are primarily rely upon
long term trends  such as a stocks
price opening above its    day
average   we hypothesize that these
results show that a baseline classifier is
good at predicting the sorts of longterm gains that might not be reflected
in twitter sentiment  which could form
the basis for an excellent supporting
classifier 

table   shows precision recall for the
best classifiers over our portfolio  the
table    twitter dataset statistics average precision in predicting mpd
 total tweets and avg  per day 
events is        max         much too
dataset
total
avg day
low to create an effective trading
aapl terms        
        
strategy alone 
atvi terms

      

        

based on the success of the
replicated bollen baseline
classifier  we constructed a
classifier specifically to predict
mpd events  we constructed    
features based on standard
technical analysis methods     in
an attempt to provide as much
information as possible based on
the simple data available to us 

erts terms

      

        

adbe terms

      

        

dell terms

      

        

dell ticker

      

        

nflx terms

     

      

mat terms

     

      

rimm terms

     

      

mat ticker

     

      

grmn terms      

      

urbn terms

    

      

aapl ticker

    

     

we cross validated multiple
models and model parameters on
the dataset created by this
baseline classifier  and found that
logistic svm models built by the
smo algorithm using an rbf
kernel  with gamma      and c  

rimm ticker

   

    

nflx ticker

   

    

urbn ticker    

    

atvi ticker

  

    

grmn ticker   

    

adbe ticker

  

    

erts ticker

  

    

   preparation of twitter dataset
we wanted to consider only those
tweets which were related to a stock
in our development of nlp based
classifiers for the data  we started by
only considering those tweets that
contained the stock ticker symbol of
the company  the ticker datasets  
but found that most of the stocks in
our portfolio had       tweets day
using that criterion  table    
we therefore expanded our criteria to
seven  in the terms datasets 
stock ticker symbol  company name 
names of major products  informal
names of major products  ceo 
president names  informal company

finames  and names hashtags of major conferences
that the company puts on  our terms list only
included terms known before june      to avoid
information leaks  using these criteria  all stocks
had over     tweets day  table   

closing direction of the djia  information gain
analysis and model validation showed that neither
calmness nor the   other mood dimensions were
predictive of mpd events of any stock in our
portfolio 

we then tokenized each tweet using potts 
sentiment and twitter aware tokenizer since it is
better suited than other tokenizers for the type of
content that appears on twitter     

we hypothesized that the public mood was less
indicative of individual stock performance than it is
of the market as a whole  for that reason  we
sought a more general method that could utilize a
larger lexicon to predict mpd events 

   development of sentiment classifiers

   lexical analysis  mulitinomial distribution
over words

because bollen et  al showed success with
sentiment analysis  we attempted to replicate their
method of classifying sentiment using gpoms
analysis of twitter posts  unfortunately  gpoms is
not publicly available  so we attempted to recreate it based on available literature 

as a first attempt  we simply counted the
frequencies of all tokens in the previous day of
tweets in the  ticker  dataset   we theorized that
directly related tweets would have the best
p re d i c t i v e p o w e r  o u r p o r t f o l i o s h o w e d
unfortunately low average results of      
precision and       recall 

   sentiment classifiers  poms expanded
as with gpoms  we built upon the profile of mood
states  poms  psychological rating scale to
measure   mood dimensions  calm  alert  sure 
vital  kind    happy  the original lexicon for poms
uses    adjectives to measure mood      we
expanded the lexicon to     terms using wordnet
by mapping each adjective to parent synsets that
reflect the sentiment of the adjective      all words
in the synset families were stemmed and included
in the poms expanded set 

data further indicated that the classifier had high
variance  as testing on the training set resulted in
an average of        precision and        recall 
we therefore elected to add more training data 
increasing the corpus to the terms datasets  this
increase in data resulted in a gain of    
percentage points in precision and    percentage
points in recall  figure     even with this increase 
however  classifiers showed high variance and we
had no more data that we could easily add 
additionally noting that we had far more features
 up to     thousand  than instances  we elected to
determine if feature selection could help reduce
variance 

for each stock in our portfolio  we performed a
daily measure of the   mood dimensions by
tallying the occurrence of each of the     terms in
the tweets related to the stock  grouping the tallies
of each term into six counts corresponding to the
poms mood dimensions  and normalizing with
   lexical analysis  feature selection
respect to the volume of tweets for the day  we
then used these normalized
we first used information gain feature
table    poms expanded
counts as features to predict
selection available from weka to select the
classifier results
whether the next day would
top twenty features using ranker search
 terms datasets 
have an mpd event 
method  this resulted in a slight decline in
dataset precision recall
both average precision and average recall 
 
 
   sentiment classifiers  atvi
       and       respectively   the
erts
 
 
results
precision when testing on the training set
aapl
 
 
also decreased  to a average precision of
our classifier using these mood adbe
 
 
       and average recall of         thus 
dimensions did not have good dell
 
 
we had a smaller variance gap  but still
results  precision and recall nflx
       
experienced poor performance 
were almost always zero  table
mat
 
 
    while bollen indicates that
rimm
 
  our second attempt at performing feature
measures of calmness on
grmn
 
  selection was to use token frequency
twitter are predictive of the
inverse document frequency  tf idf 
urbn

 

 

fiinstead of raw frequency in our normalized counts
    lexical analysis  results
     we pruned tokens that were in the bottom
we were able to increase our precision up to     
    and top     to eliminate both common
 figure     even though the f score decreased to a
words and rarely seen words that may result in
little under     the key part of our trading strategy
over fitting  this method resulted in higher average
to ensure profitability is to maximize precision  we
precision of       and lower average recall of
selected the final domain specific words method
       this precision  though greatly improved 
to combine with our baseline classifier 
was not satisfying  thus 
table    example domain words
we turned our attention to
    combination classifiers
classification
example words
applying domain
after testing and validating both
buy  call  bought
knowledge of the stock buy signal
approaches  we combined the features
stock event
analyst  earnings
market 
generated in our baseline economic
sell signal
sell  sold  short
    lexical analysis  trading activity
information classifier  step    and in our
trade
domain specific words
domain specific words lexical analysis
investing activity
invest
 step     and compared the results to
we analyzed our twitter short term signal day  tomorrow
identical svm models built on each
c o r p u s t o d e t e r m i n e long term signal week  month
dataset individually  in this final step  we
words that may contain
compared
models at c      to reduce
some domain knowledge of stock market trading
variance 
and could provide predictive knowledge on
whether a stock would be having a major price
movement  we determined seven categories of
words and manually generated example words in
each category  table     we then counted the
frequency of these words occurring in the previous
day  this method performed poorly when
classified by our tuned svm  however  when we
ran this experiment with a multilayer perceptron
configured using the default parameters in weka
       data showed average precision of      and
a recall of      when averaged across of all our
stocks  figure    
figure  

    combination classifier results
table   shows results from the combination
classifiers on each stock  analysis of these results
shows that combination classifiers improve the
precision of mpd prediction by an average of     
percentage points  and improve some stocks up to
    precision  average precision over our
portfolio is        insufficient to make a profitable
trading strategy  but two stocks  atvi and erts
 show sufficient precision to trade        and
       respectively    atvi and erts  additionally 
had a recall of      and      which would trigger
   trading events over the    trading days in the
test set 
figure  

fitable    precision and recall of developed classifiers
test set
train set
atvi terms
erts terms
adbe terms
dell terms
nflx terms
mat terms
rimm terms
grmn terms
urbn terms
average

baseline economic classifier
precision
recall
f score
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

stock words classifier
precision
recall
f score
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

this result may be due to the fact that atvi and
erts had the most related tweets in the dataset
period  figure   shows a weak correlation between
the total number of tweets observed in the
timeframe and the percent improvement in the
combination classifier  with r        

conclusion
our results suggest that twitter data are predictive
of major price difference events  mpd events  
svm classifiers using a combination of economic
data and features gleaned from twitter feeds
predict mpd events with higher precision than
classifiers based on economic data alone  over a
portfolio of    consumer technology companies 
combination classifiers improved the precision of
mpd prediction by an average of       percentage
points 
while the average precision is        too low to
create a profitable options straddle trading
strategy over the entire portfolio  the two stocks
with the highest twitter comment volume show
precisions of       and        this suggest that
having more twitter data related to the stock will
improve predictive performance of mpd events on
the stock 

combination classifier
precision
recall
f score
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

acknowledgements
we would like to thank mihai surdeanu for his support and andrew
ng for the opportunity to construct this project 

works cited
    johan bollen  huina maoa    xiaojun zeng          twitter mood predicts the stock
market   journal of computational science  volume    issue   
    pham  hung and chien  andrew and lim  youngwhan   a framework for stock
prediction         http   cs    stanford edu proj     phamchienlim pdf s
    potts  christopher   sentiment symposium tutorial         sentiment analysis
symposium  http   sentiment christopherpotts net 
    manning  christopher d   and hinrich schtze  foundations of statistical natural
language processing  cambridge  mass   u a   mit        print 
    mark hall  eibe frank  geoffrey holmes  bernhard pfahringer  peter reutemann  ian
h  witten         the weka data mining software  an update  sigkdd
experimentplorations  volume     issue   
    mcnair  douglas and maurice  lorr and droppelman  leo  profile of mood states 
educational and industrial testing service  san diego  ca        original source
unattainable  list retrieved from http   www  ul ie pdf           pdf
    princeton university  about wordnet   wordnet  princeton university         http   
wordnet princeton edu 
     technical indicators and overlays   chartschool stockcharts com  stockcharts com   simply the web s best financial charts  web    
dec         http   stockcharts com school doku php 
id chart school technical indicators   
     yahoo stock search data set   infochimps   infochimps   smart data for apps and
analytics   big data solutions   infochimps  web     dec         http   
www infochimps com datasets yahoo stock search  
     yang j   leskovec j  temporal variation in online media  acm international
conference on web search and data mining  wsdm            
     zhang  wenbin  and skiena  steven   trading strategies to exploit blog and news
sentiment  international aaai conference on weblogs and social media         n  pag 
web     dec      

fi