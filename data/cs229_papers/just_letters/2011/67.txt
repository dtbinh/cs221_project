cs     machine learning

forecasting with expert opinions
khalid el awady

background
in      the wall street journal  wsj  introduced its monthly economic forecasting survey 
each month the wsj polls between    and    well known economic experts asking their
forecasts of future key economic variables such as gdp  inflation  us treasury rates 
unemployment  housing starts  and other data  the forecasts are always for set times of the year 
namely the ends of the first and second half of the calendar year  so while the data is collected
monthly  the forecast interval varies from one to six months ahead  the forecasts of all
participants are made public  but the wsj also presents a consensus view which is simply the
sample average forecast of the participants 
the data set suffers from a number of challenges 
 small number of observations  i was able to extract a series of m      observations
representing six years of   month ahead forecasts  prior to      the data collected and
the format used was not consistent with data after      
 large number of features  forecasters   over the   year period     to    experts
provided forecasts each month  with a total of    different forecasters providing inputs
over the   year period 
 missing data  only        of the    forecasters provided forecasts for the whole time
period  depending on indicator  experts routinely drop out and new ones are added  also 
not all experts polled at a given time chose to provide a forecast for every variable  of the
possible      data points over one third are missing from each of our variables 
in this paper we seek to explore two things 
   how much improvement over the average forecast can be made with machine learning
techniques discussed in class 
   bayesian networks are often chosen as the preferred way to represent expert opinion     
i will attempt to implement one of these on this data and explore the insights it provides 

data
three data sets of   month ahead forecasts were extracted from the wsj data for analysis 
      year us treasury rate     observations from    experts
   us unemployment rate     observations from    experts
   oil price    observations from    experts  this variable was added to the forecast in      

linear regression with pca
the wsj data is shown in figure    each red triangle represents the forecast of a single expert at
a point in time   months earlier  e g   the red triangles in dec   represent the forecast made in
june   for the value of that variable in dec     the blue line is the average or consensus
forecast of the experts presented by the wsj  and the black line represents the actual value of the
variable on the shown date  as can be seen  the forecast vary widely  and even so  the actual

fivalue can deviate far from the consensus view  we also notice two issues with the forecast  it
tends to lag actuals  i e   forecasters guess of next periods value often looks very much like this
periods value   and forecasters underestimate the variance  i e   they dont believe it will change
as much as it often does  

figure       year treasury rate  top left   unemployment rate  top right   and oil price  bottom left  

we first try a linear regression model to see how much improvement can be obtained over the
simple average  we do this through the following processing steps on the data 
 remove forecasters with incomplete data over the whole time period  this leaves   
forecasters and corresponds to the features of the machine learning problem 
 divide the data into a training set of size   samples for the rate and unemployment  and  
samples for the oil price  and a test set of size   samples for each indicator 
 reduce the feature set size  the data set is under determined with a small number of
observations    or    and a large number of features         to avoid overfitting  we
convert this to a more traditional regression problem using pca to reduce the feature set
to a number below the number of observations  table   below summarizes the chosen
pca parameters and the associated mean square errors  mses  of the estimates 
we notice that linear regression with pca resulted in significant reduction in the mean squared
error of the estimate compared to the sample average in the case of unemployment and oil prices 
the    year rate  though  shows relatively small improvement 

fivariable

   year rate
unemployment
oil price

samples

  
  
 

forecasters
with
complete
data
 features 

number of
principal
components
in reduced
feature set

portion of
variance in
selected
principal
components

mse using
consensus
 average 

  
 
   
    
  
 
   
    
  
 
    
     
table    forecasting with linear regression and pca 

training
mse
using
linear
regression
with pca
    
    
   

testing
mse
using
linear
regression
with pca
    
    
   

bayesian network estimates
we postulate a bayesian network inspired by the model presented in problem set    question   
for each of the economic indicators we assume there is a latent intrinsic value that is normally
distributed with an unknown mean and variance  each of the forecasters is modeled as a latent
node contributing a bias of their own  also normally distributed with unknown mean and
variance   the bayesian network combines these two and adds an independent noise source  this
is depicted graphically in figure   

figure    bayesian network influence diagram for economic indicators 

the parameters                  and      are estimated using the em algorithm of problem   in
problem set    where the subscript e refers to each of the three economic indicators  because of
the different natures and scales of the indicators the parameters for each are estimated from their
respective forecasts independently  the parameters     are assumed known and tuned to
accommodate the difference in forecasts from actual value 

fithis approach allows for a varying number of forecasters each time sample as well as forecasters
dropping out and new forecasters coming in  it thus makes maximal use of available information 
figure   shows the estimated intrinsic value from the bayesian network for the economic
indicators 

figure    economic indicator data with bayesian network intrinsic estimates 

table   shows the performance of the bn intrinsic estimate compared to the sample mean and
the pca   linear regression estimate in terms of mean square error relative to the actual data 

variable
   year rate
unemployment
oil price

observations
  
  
 

forecasters
with
complete
data
 features 
  
  
  

average
number of
forecasts in
any given
sample
  
  
  

mse using
consensus
 average 

testing mse
using linear
regression
with pca

    
    
     

    
    
   

mse using
bayesian
network
    
    
     

table    comparison of bayesian network performance to the sample mean and the pca estimate 

fiwe notice that the bn estimate of the intrinsic mean differs slightly from the sample mean  but
it does not do a better job of forecasting as its mean squared error relative to the actual data is
about the same as the sample mean 

commentary and conclusions
we investigated a forecast data set based on expert opinions that consists of many more features
than samples  and forecasters who drop out and new forecasters who join in at each time sample 
the sample mean of the forecasts is nominally put forward as the consensus view  comparison
of this consensus estimate to the actual data shows the consensus view is often far from the
actual data 
we applied two machine learning techniques to the data in an attempt to improve the forecast  a
supervised approach and an unsupervised one  the supervised technique involves extracting a
complete subset of the data comprising only forecasters who have provided forecasts for each
time sample  this reduces the usable data roughly by over a third  principal components are used
to extract a lower dimensional feature set and a regression is then applied to relate the projected
data in the principal component space to the actual values  this pca based regression provides a
much better fit to the actual data in the case of the unemployment and oil price forecasts  but
doesnt improve the    year rate forecast much 
the unsupervised learning technique uses a bayesian network to estimate latent intrinsic values
of the indicators  this has the advantage of using all available data at each time sample  the
estimate obtained  though  is not better at forecasting the actual value 
we conclude that there are structural deficiencies in the forecasters estimates that can
sometimes be corrected for when actual values are employed to detect these  this would include
the tendency of forecasters to rely too heavily on the previous periods values  as well as the fact
that they underestimate the volatility of the indicators  further  the sample mean captures the
intrinsic value of the forecasters quite well and a bayesian network did not provide a
meaningfully different estimate 

references
   d  heckerman         a tutorial on learning with bayesian networks   microsoft
research tech  report  msr tr       
   a  ng  cs    notes  stanford university       
   t  lai and h  xing  statistical models and methods for financial markets  springer 
     

fi