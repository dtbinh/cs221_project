julian kates harbeck

cs    final report

julian kates harbeck  cs    final report
classifying galaxy morphology using machine learning
introduction 
the goal of this project is to classify galaxy morphologies  generally  galaxy morphologies fall
into one of two categories   early types   elliptical galaxies  and spiral galaxies  like the milky
way  additionally  a celestial object of interest may be categorized as neither  which usually
corresponds to an image of a point source  e g  a star  or to an artifact of the data  although
humans are generally successful at classifying astronomical images  the sheer amount of data
that is currently produced is far too immense to be interpreted by humans  the sloan digital sky
survey  sdss  for example  the number one source for publicly available astronomical
imaging data  has a growing catalog of over     million celestial objects  successful
classification of all of these objects could represent a major step forward in the field of
observational astronomy  ultimately bringing us closer to the goal of better understanding the
composition and origins of our universe  several attempts have been made to classify the
images from sdss  one interesting project is the galaxy zoo project  c  lintott et al    the idea
of the project was to have humans  more specifically volunteers with some prior knowledge of
the subject  e g  science teachers   interactively classify images of celestial objects online 
every given image was classified by several people  in order to produce a measure of reliability
of the classification  using these statistics  as well as several data reduction and cleansing
methods  a data set of about         reliably classified galaxies was produced  a common
object id identifies the objects used in galaxy zoo with the images from sdss  in this project 
we use the classifications from galaxy zoo together with the corresponding observational data
from sdss as our data set 
this project consists of   separate approaches  in the first  we hand pick pre computed features
from sdss for every galaxy and run classification using those features  in the second and far
more challenging approach  we aim to classify galaxies using only the raw image data  as a
training set  we use the clean images from galaxy zoo  those galaxies where at least     of
observers agree on the morphology  we evaluate
evaluator vs 
meaning
information
all classifiers using    fold cross validation 
feature
gain
concentration

i  classification using pre computed features
data selection 
the sdss catalog  in addition to the raw image
data  offers a set of preprocessed features for
every object  the total number of such features is
very large and many of them are not useful for
morphological classification  using the weka
package  m  hall et al    we analyze the
classification power of different features  using
several attribute selection methods  we find that
the feature set with the strongest classification
power is very similar to the feature set used by
banerji et al  the features are described and the
classification power is presented in table   

g r color
devab i
expab i
mrrcc i
me  i
me  i
lnlexp i
lnldev i
mcr  i
r i color
lnlstar i
texture i

petror   petror    ratio of radii
containing     and     of the
petrosian flux
green minus red color  redshift
removed 
devaucouleurs fit parameter
 infrared 
exponential
fit
parameter
 infrared 
adaptive second moment
adaptive shape measure
adaptive shape measure
exponential
disk
fit
 log
likelihood 
devaucouleurs fit  log likelihood 
adaptive fourth moment
red minus infrared color  redshift
removed 
log likelihood of being well
modeled as a star
texture parameter  infrared 

     

     
     
     
     
     
     
     
     
     
     
     
    

table    description of the different features and relative classification power
 arb  scaling   

fijulian kates harbeck

cs    final report

classification results 
using the optimized features  we employ several machine learning techniques on our data 
specifically  we use a simple nave bayes classifier  a logistic regression classifier  an
alternating decision tree  a random forest  using    trees and   random features per tree  and
an svm with a linear kernel  the results are presented in table    we can see that the
classification performance reaches a maximum of        with a logistic regression classifier 
for most classification techniques  the performance lies between     and      the only
outlier is the nave bayes classifier  this is an indication that the nave bayes independence
assumption is not well justified  indeed  for the sdss feature set  several features often aim to
describe the same characteristic  for example  both concentration and me  i me  i
describe the width of the brightness distribution in the image 
ii  direct image classification
while we were able to achieve good results using the pre compiled features from sdss  a far
more interesting problem is to classify the galaxies using only the raw image data  the goal is to
train a classifier that can  just like a human  take a raw image of a galaxy and classify it as
either spiral or elliptical 
image processing 
the imaging data retrieved from sdss consists of     x     pixel rgb
images  a typical collection of sdss imaging data is shown in fig     it
quickly becomes obvious that before the raw image data can be used for
classification  several issues need to be overcome  first  the image data
contains a strong background noise level  the regions that appear black
in the images actually have a consistent magnitude of about  of the
maximum magnitude of the image  second  the imaging data  apart from
the actual galaxies  contains many other bright secondary objects  these
secondary objects may be artifacts of the camera  stars  quasars  or other
galaxies  third  the images are subject to random rotations  in our final
figure    typical imaging data from
classifier we do not want the rotation of the image to affect the sdss  spiral  top  and elliptical  bottom 
classification of the galaxies  one of the most challenging aspects of this galaxies  single objects  left  and
project was the development of a reliable image processing procedure that images with secondary objects  right  
would remove the three issues listed above  the following is a summary of the developed image
processing pipeline 
first  the rgb image is converted to a grayscale image  flattened   i e  a single     by
    matrix  in order to subtract the constant background  we find the minimum pixel value and
subtract it from the matrix  we further zero all pixel values bellow a certain magnitude cutoff  we
found that half the mean of the matrix was ideal   this further reduces random fluctuations in the
ideally black regions of the image 
the second step  the removal of bright secondary objects  proved to be the most
challenging  due to their brightness  secondary objects are usually not removed by the above
described procedure  the two key insights that lead to an efficient solution were the following    
the images queried from sdss are almost exactly  within   pixel  centered on the objects of
interest    galaxies generally are almost perfectly invariant under     rotation  thus  we can
compare each pixel of our image matrix to the corresponding pixel rotated     about the center
of the image  taking advantage of     a strong enough difference in magnitude of these two
pixels means that they are very likely part of secondary objects and can thus be set to zero 
there are however a few subtleties involved in this algorithm  first  spiral galaxies sometimes

fijulian kates harbeck

cs    final report

have structural elements  such as indications of galaxy arms  that are not
exactly symmetric under     rotations  second  the condition for strong
enough must be optimized  since a too high threshold would miss
objects  while a too low threshold might cause obstruction of the galaxy
itself  we found that the optimal condition for strong enough is a relative
difference in magnitude of over      further  in order to guarantee that
the main structure of the galaxy itself is unaffected  we run the algorithm
only on pixels that are further than     of the total image radius away
from the image center 
finally  we wish to process the images such that rotation of the
original image will not affect the classification  the key insight here is that
galaxies share a common ellipsoid structure in the images  i e  they all
have two orthogonal axes of symmetry  by calculating the second
moments in x and y of the image as well as the correlation of x and y  we
can construct the covariance matrix of the galaxy image  this allows us
to deduce the major variance carrying axis  teague   we can now use
the angle of this axis and rotate every image onto its major axis 
in summary  we now have a clean  centered image with
consistent definitions of the x and y axes  without secondary objects and
with all pixels other than those of the main object set to zero  a summary
of the image processing pipeline is given in figure   
image analysis 
using the clean image data  we train both a blind classifier that
processes the image without any insight into the data as well as a more
intelligent classifier that uses scientific knowledge of galaxies in order to
extract features that might be especially indicative of morphology 
in our blind approach  we compute the  d fourier transform of
the image  discarding the high frequency terms  which carry mostly
noise   specifically  taking the central    by    fourier components
showed the best performance  when performing classification using figure    image processing pipeline as
these     fourier coefficients directly  we achieve a classification illustrated with an example galaxy
accuracy of        with an roc area of       using an svm with a  greyscale images as heat maps   raw
linear kernel  after further dimensionality reduction using ica and image  top   flattened image  upper
retaining only the coefficients of the    most prevalent independent center   background and secondary
components     yielded the best results  as features  we achieved objects removed  lower center  
rotation normalization  bottom  
       classification accuracy with an roc area of       using an
svm with a gaussian kernel 
our knowledge based classifier takes advantage of three main distinguishing
characteristics between elliptical and spiral galaxies  first  the typical color spectrum of elliptical
galaxies is different from that of spiral galaxies  since most elliptical galaxies are very old  they
are often also called early type galaxies  and thus are subject to a stronger redshift than the
usually  younger spiral galaxies  we use the three rgb matrices of the raw unflattened image
 corresponding to the intensities from the green  red and infrared color channels of the original
photometric sdss image  together with a bitmask obtained in the image processing step
separating the galaxy from the background  to extract the color composition of the galaxy  we
then compute the fractions of the r  g and b pixels of the total image magnitude  thus obtaining
the fractions of green  red and infrared light of the total brightness of the galaxy  respectively 
second  we take advantage of the fact that spiral galaxies  unless they are viewed
directly from their axis of rotation  appear as very eccentric ellipsoids  while elliptical galaxies

fijulian kates harbeck

cs    final report

show very uniform circular symmetry with low eccentricity  we use up to  th order normalized
central moments in x and y as well as generalized tsr  translation  rotation  scaling  invariant
moments  hu  flusser  of the images to capture this information  since our images are centered
and rotated onto their major axis  the x and y moments wont be affected by rotation of the
galaxies 
classifier
accuracy roc area
third  we make use of the
pre computed
features
difference
in
radial
intensity
      
     
distributions between elliptical and logistic regression  pcf 
random forrest
      
     
spiral galaxies  generally  elliptical svm  smo  linear kernel 
      
     
galaxies experience an exponentially decision tree
      
     
decreasing intensity profile with radius  nave bayes
      
     
while spiral galaxies are better
blind image classification
modeled using a devacouleurs profile  image analysis   ica   svm
      
     
knowledge based
image
classification
 for
image

analysis

 

feature

      

     

some constant k   srsic   by taking selection   svm  poly  kernel   
advantage of the symmetry of the image analysis   feature selection       
     
galaxies
and
their
rotational   random forest     trees 
     
normalization onto the major axis  we image analysis   feature selection       
 
logistic
regression
can capture most of the information by
using the  d density profiles along the
   this table summarizes classification performance from the different parts of
major and minor axes of the image table
the project  the best performing classifiers are printed in bold face 
instead of the full  d radial profile  thus
simplifying the computation substantially  specifically  we compute the distances in x and in y
from the center that capture     and     of the total magnitude of the  d intensity profile
along the major and minor axes  respectively  we then take ratios of these   values  including
cross terms  these features capture information about the radial density distribution well 
the combined features from the color study  the distribution moments and the density
profiles are then fed to several different classifiers  as summarized in table    the best
performance is achieved using an svm with a  rd degree polynomial kernel  we achieve a
maximum classification accuracy of        with an roc area of        exceeding the
benchmark performance in section i using the pre computed features 
color

pre computed
features

sdss
imaging
data

useful
feature
extraction

 

svm

knowledge
based
classification

moments and
eccentricity

svm

 
radial density
profille

raw images

background
removal

artefact
removal

rotational
normalization
 blind 
classification

 d
fourier
analysis

ica

svm

figure    summary of the learning systems used in this project  classification is performed using pre computed features as well as raw image
data  for the raw image data  we use both knowledge based and  blind  features 

fijulian kates harbeck

cs    final report

conclusion and future work
we have presented a system consisting of an image processing algorithm in conjunction with a
knowledge based classifier that can with high accuracy classify galaxies using only the same
raw image data that was available to humans in the galaxy zoo study  comparing the blind and
insightful classifiers  we have also shown that using physical insight into the details of a problem
can lead to significant improvement of classification performance  the summary of our learning
systems is given in figure    and the summary of classification performance is given in table  
there are two major areas for possible improvement of our system  first  due to the
computational complexity of the problem of image cleansing and feature extraction and
limitations of our computational processing and memory resources  we were only able to create
a training set of      galaxies for testing and training  a larger training set will very likely result
in even better classification performance  second  one physical difference between elliptical and
spiral galaxies that we have found difficult to capture in our feature set is the very fine spiral arm
structure  in some cases  a spiral galaxy viewed from above  close to or along the axis of
rotation  can show  usually very slight  indications of spiral arm structure  while an elliptical
galaxy is always azimuthally homogeneous  a more advanced feature set including this
information would most likely increase the classification accuracy even further 
acknowledgements 
i would like to thank dr  mark allen from the stanford physics department for his helpful input
and suggestions for this project 
references 
m  banerji et al   galaxy zoo  reproducing galaxy morphologies via machine learning   monthly notices
of the royal astronomical society  vol            pp          
flusser  jan   on the independence of rotation moment invariants   pattern recognition                
m  hall et al   the weka data mining software  an update   sigkdd explorations  volume     issue  
     
hu  m   visual pattern recognition by moment invariants   ire transactions on information theory     
feb       
c  lintott et al   galaxy zoo    data release of morphological classifications for nearly         galaxies  
monthly notices of the royal astronomical society      
   galaxy zoo  morphologies derived from visual inspection of galaxies from the sloan digital sky
survey   monthly notices of the royal astronomical society      
srsic  j  l   influence of the atmospheric and instrumental dispersion on the brightness distribution in a
galaxy   boletin de la asociacion argentina de astronomia       p     
teague  m  r   image analysis via the general theory of moments   journal of the optical society of
america august               

fi