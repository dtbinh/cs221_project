ica for musical signal separation
alex favaro

 

aaron lewis

garrett schlesinger

introduction

when recording large musical groups it is often desirable to record the entire group at once with
separate microphones for each instrument  this technique allows the group to record a piece as
they would perform it while still producing multiple tracks for later balancing and tweaking  the
mixing process is made more difficult in this scenario  however  by the sound of each instrument
bleeding in to the other microphones such that the recorded instruments are not truly isolated 
ideally we would like to completely remove this effect by separating the signals generated by each
instrument into individual tracks  in general we are unaware of the factors which contribute to the
bleeding effect so the problem is an example of blind signal separation  bss  
one of the more common solutions to bss is independent component analysis  ica   most
ica algorithms use a generative model that assumes that the observed signal is generated from a
linear combination  i e   instantaneous mixture  of statistically independent sources  formally  at
each time sample i we observe
x i    as i 
   
where s i   rn are our n source signals at time i and a is an unknown square matrix called the
mixing matrix  given this assumption  the demixing matrix w  a  is obtained by maximizing
the statistical independence of the source signals that we wish to isolate 
in practice  instantaneous mixtures of audio signals are quite rare  microphones in a real
recording scenario will pick up not only the direct sound from each source but also their reflections
from walls and other objects  even when such reflections are minimal  as might be the case in a
well equipped recording studio  the sounds will reach each microphone at different times due to
propagation delay  a more accurate model describes each observed signal as a linear combination
of delayed source signals  concretely  observed signal j at time sample i is given by
 i 

xj  

n
x

 itjk  

ajk sk

   

k  

where n is the number of signals  ajk is the j  k th element of a  and tjk is the amount of delay
from source k to microphone j 
given this formulation of the problem we attempt to extend ica to handle the real world
problem of signal separation in musical recordings  in section    we discuss the data that we used
to test our methods  section   describes each method and its results in turn  we conclude in
section   with a discussion of room for improvement and future work 

 

fi 

data

figure    guitar data

we tested our approach on a number of different data sets  each of our recordings includes
four instruments  an electric guitar  a piano 
a tenor saxophone  and a snare drum  with
a separate microphone for each instrument we
recorded three scenarios  each instrument playing independently  i e   not the same piece of
music   a b  major scale played in unison and
with various rhythmic patterns  and a simplified
arrangment of tower of powers aint nothin
stoppin us now  in each case we recorded all
of the instruments together to create the bleeding effect and also separately with no bleeding 
as a sanity check we also artificially mixed our
separately recorded tracks to recreate the bleeding effect both with and without propagation
delay 
our data is stored in a lossless audio format
that allows us to easily operate on the time domain  time vs amplitude  of the signal  we also
generate spectra for the signals which allow us
to operate on the frequency domain  frequency
vs amplitude  as well as spectrograms that represent the spectra at different time windows 
figure   shows the data generated from the
guitars microphone while playing a b  major
scale 

 

 a  time domain

 b  frequency domain

 c  time frequency domain

methods and results

although ica performed well in the time
domain on our artificially created instantaneous mixtures  the algorithms performance
degraded rapidly when propagation delays were
introduced  the recovered signals from our real
world recordings were less isolated than the observed signals  to account for these propagation delays we subsequently focused our efforts
on separation in the frequency domain 

 

fi   

ica in the frequency domain

note that after applying the fourier transform to our signals equation   becomes
 i 

xj  

n
x

 i 

ajk exp itjk   i   sk

   

k  
 i 

 i 

where xj and sk are the fourier transforms of observed signal j and source signal k  respectively 
and   i  is the frequency at sample i  thus propagation delay in the time domain becomes complex
rotation in the frequency domain so the observed signals are now instantaneous mixtures of the
source signals  our mixing matrix  however  is now a function of signal frequency 
initially we ignored the frequency dependency in the mixing matrix by running a version of fastica for complex valued data  cfastica      over the fourier transforms of our observed signals 
we recovered the source signals by applying the inverse fourier transform to the resulting independent components  our hope was that the propagation delays    ms  would be small enough
that the frequency dependent components of the mixing matrix would be negligible 
we only had small success in separating tracks using cfastica  in artificially mixed b  scale 
the drums were entirely separated out of one track  though the melodic instruments are all mixed
to a greater extent than in the source tracks  in all tracks with propagation delay  both natural
and artificial  the outputted signals were more mixed than the source files  this mixture occurred
because the source tracks are co dependent in the frequency domain 
we also decided to try running fastica on the magnitude of our frequency responses as a
heuristic to generate the mixing matrix  this greatly simplifies the signal by removing the phase
information  which in turn ignores any propogation delays  to recover our signals  we take the
resulting demixing matrix and apply it to the frequency response of our observed signals  we then
apply an inverse fourier transform on the results to get our estimated independent components 
figure    frequency domain results
 a  observed

 b  recovered

we had success in isolating artificially mixed tracks by running fastica on the magnitude
of the fast fourier transform  in both the artificially mixed scale and jam tracks  the piano
 

fiand snare drum separated well  the snare drum in particular isolated with effectively no audible
interference from other sources  figure   shows the observed and recovered frequency domain
signals for the snare drum on b  scale  we hypothesize that the snare drum isolates particularly
well in the frequency domain because its frequencies are the most independent  the guitar  piano 
and saxophone play many of the same notes over the course of a track  and in the case of the b 
scale  all of the same notes   this means that their frequencies are heavily dependent  leading ica
to perform poorly  however  the snare drum does not vary in frequency over the course of a track
and is in this way the most unique and independent instrument  so ica is able to recover the drum 

   

frequency banded ica

we can rewrite equation   in a more familiar form as
x i    a   i   s i 

   

where a   i    is our mixing matrix as a function of frequency  thus the problem in the frequency
domain is a set of instantaneous mixtures as in equation    since the frequency dependencies
in the mixing matrix are similar for close values of  we can run ica on a number of relatively
small frequency bins  the source signals are recovered by appending the resulting independent
components and applying the inverse fourier transform 
one issue that arises with this approach is known as the permutation problem  given only the
observed signals  the permutation of the recovered sources is arbitrary  we must therefore ensure
that the permutation of sources recovered by ica is the same for each frequency bin  a number
of approaches have been suggested to overcome the permutation problem         we implemented
the simplest of these  which calculates the demixing matrix for the frequency bins one at a time
using the matrix calculated for the previous bin as the initial guess for the next bin  since the
neighboring frequency values should be somewhat close to one another this helps to ensure that
the permutation will not change from bin to bin 
unfortunately this approach to the permutation problem was insufficient to overcome the complexity of our data  although we believe that equation   was a good way to view the problem  and
the literature would seem to agree          the results we obtained from this method were unsatisfactory  many of the recovered signals were washed out and clearly contained sounds generated by
all of the sources  for our data at least  a more sophisticated solution to the permutation problem
is necessary 

   

ica with linear regression

our third approach to the propagation delay problem was to modify how the mixing matrix is
computed in ica directly  by inverting the problem we define the j  k th element of our demixing
matrix as follows
wjk      cjk exp itjk  
   
fastica uses a deflation method that solves for the source signals one at a time      in the iteration
 i 
 i 
that computes source signal j  wjk is updated to be the mean over all wjk where wjk is the estimate
for wjk computed from sample i  to remove the frequency dependency from our model  we modify
 i 
this update step to instead calculate cjk and tjk from the wjk s 

 

fitaking the natural logarithm of equation   we obtain
log wjk   log cjk   itjk 

   
 i 

which is linear in   we can therefore use linear regression on log wjk and   i  to obtain estimates
for log cjk and itjk from which we calculate cjk and tjk   once all the cjk and tjk s are computed
we can use equation   once more to write our demixing matrix as a function of  and recover the
source signals 
this change essentially modifies our estimate of wjk by fitting a   deminsional polynomial to
the wjk s at each frequency instead of a   dimensional polynomial  while this change seemed
promising and logical  its results were not satisfactory  introducing the new degrees of freedom
resulted in fasticas gradient descent failing to converge in any reasonable amount of time  the
values of cjk and tjk produced at each iteration appeared at times to be oscillatory and at other
times to randomly shift  this method may have the potential to be successful with future work
and investigation but at the time of writing was not successful 

 

conclusion

in conclusion  signal separation on real world data is difficult  we primarily focused our separation
methods on accounting for the volume decay and propagation delay present in recording multiple
instruments in one setting  however  solving for these variables given the different mixes and the
knowledge that the sources are independent pieces of music was a tougher task then we expected 
we started with an algorithm that was capable of separating the observed signals if there was no
propagation delay present  and throughout our various methods the best results were to separate
out one or two instruments  we attribute this result to the difficulty of simultaneously solving for
volume decay and propagation delay as well as the difficulty present in musical data sets   that the
sources are not entirely independent 
while our results are not indicative of finding an optimal solution to the problem  we do feel
that we have made progress  we were able to separate some of the signals and succesfully isolate
some of the instruments in our data set  in addition  we also investigated innovative methods to
solve for both the volume decay and propogation delay which  given more time and effort  may be
able to produce better results 

references
    hyvarine a   fast and robust fixed point algorithm for independent component analysis 
ieee trans  on neural networks                      
    bingham e  and a  hyvarine  a fast fixed point algorithm for independent component analysis
of complex valued signals  helsinki university of technology       
    smaragdis p   information theoretic approaches to source separation  mas department 
massachusetts institute of technology       
    mitinoudis n  and m  davies  audio source separation of convolutive mixtures  ieee trans 
on speech and audio processing              

 

fi