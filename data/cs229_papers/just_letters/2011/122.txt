predicting groundwater levels using linear regression and
neural networks
sara maatta
december         

abstract
water resources managers can benefit from accurate prediction of the availability of groundwater 
in this project i present two models to predict groundwater levels in an unconfined shallow aquifer
in the searsville basin  part of the jasper ridge biological preserve  the input data  ie  features 
for the models includes local weather  lake stage  and stream flow data  and moving averages of the
weather  stage and stream flow data taken over time frames of one week  one month  three months
and six months  when moving averages are included as features  a linear regression model does well
at predicting summer groundwater levels  in contrast  a feed forward time delay neural network
does well at predicting winter groundwater levels  in combination  these models can provide useful
predictions for groundwater levels throughout the year  feature analysis indicates that the most
important features are the longer time frame moving averages that measure the seasonality of the
example 

motivation
in california  groundwater levels follow a roughly sinusoidal pattern  high in the winter and low
in the summer  in a perfect world  we could use a mass balance to calculate groundwater levels
using massin   massout   storage  but practically  we can only estimate global mass fluxes from
measurements taken at discrete locations at discrete times  precipitation  recharge from stream
and lake levels and subsurface flows bring mass  water  into the system  and evapotranspiration 
withdrawals  well pumping   discharge to streams  and subsurface flows take mass  water  out of
the system  in an unconfined aquifer  the change in storage in the aquifer is represented by change
in groundwater table as measured by piezometers  the change in groundwater table elevation is an
approximately linear function of volume stored  depending on aquifer geometry 
in the field of hydrology  models of subsurface water flows typically require knowledge or estimation of the hydrologic parameters of the basin  the hydraulic conductivity and porosity of a
soil define how water will flow through the subsurface  but these parameters are difficult to determine empirically  it requires thorough three dimensional knowledge of the subsurface  thus most
hydrologic models estimate the effective hydraulic conductivity and porosity from relatively few soil
samples 
this project will attempt to model groundwater levels without any explicit knowledge of the soil
parameters of the basin  by training a machine learning model  the parameters and weights will
implicitly represent the effective soil parameters of the basin  instead of basin soil parameters  the
inputs for the machine learning model for this project will include daily weather  lake stage  and
stream flow data 

 

fics     final project

average daily temperature

 
 

     

   

     

   
 
   
 
   

   

 

 

 

 

 

 

 

 

 

   
  
  

   

   
  

  
  

  

   
  
  

   

   
  

  
  

   

  

 

   

   
  

  

  
  

  

  

 

   

   
  

  
  

  

 

 

 

 

 

 

   

  

  

   

   

  
  

   

  

 

 

 

 d 

  

  

  

   

  

  

   

   

  
  

   

   

   

  

  

  

  
  

  

  

   

  

  

 

   

 

     

  

 

 

 

 

 

 

   

   
  
  

  
  

   

   
  

  

 

 

 

 c 

  

   

  

  
  

   

   

   

   
  
  

  

 
  

  
  

  

  

   

 

 

  

 

 

 

 

 

 

   

   
  
  

   
  

  
  

  

   
  

 

 

 b 

  

   

   
  

  
  

  

   

   

   
  

  

  
  

  

  

 

 

 

 

   
meters below ground surface

 

 

 a 

searsville lake water elevation  meters msl

 

   

average daily wind speed at     meters

 

 

ground water elevation at station e d  ground surface           m msl
   
 

  

 

searsville lake water elevation
     

  

  

 

average daily temperature at     meters  degrees celsius

  

   

 

 

 

 

 

 

 

 

 

   

   
  
  

  
  

   

   
  

  
  

   

  

  
  

   

   

   

   
  
  

  

  

  
  

  

 
  

  

   

  

  

  

   

 

 

  

   

  

  

  

  

 

  

  

 

  

  

precipitation  mm

  

average daily wind speed

  

  

   

  

daily precipitation
   

sara maatta

 e 

figure    hydrologic data from jasper ridge biological preserve  please zoom in to view 
eventually  technology like groundwater prediction can help agriculture and water resources
managers plan for availability of groundwater  the goal would be for this technology to be able to
use weather predictions for a coming season to predict change in the groundwater levels 

data
the weather station providing weather data for the project is located at the jasper ridge biological
preserve  the lake stage data is from the searsville reservoir  located on the preserve  the stream
flow data is from corte maderas creek  which flows into searsville reservoir  the piezometer used
to measure groundwater level is located less than  km upstream of the reservoir 
the weather data include precipitation  average temperature  wind speed  and humidity    the
data for this project were provided by various student and faculty projects located at jasper ridge 
and compiled by dr  david freyberg  figure   shows timeseries of the data used in this project 
note that the date ranges for each series is slightly different  so a common subset  nov         to
june          will be used as the input  training and testing  for the models 
data is preprocessed to have zero mean and unit variance  except precipitation  which is in units
of centimeters 

model results
linear regression
the first model implemented to predict groundwater levels was unweighted linear regression  for
the training set  i used the subset of data from nov         to june          for the test set  i
used the subset of data from june         to june          the training matrix x is composed of
rows containing the x i  s  each with the data inputs for day i  weather  lake stage and stream flow  
 i 
and x       the results vector y is composed of the groundwater level y  i  observed on day i 
 
   t
the unweighted linear regression finds  according to to the normal equations     x t x
x y 
figure   shows the training and test results using unweighted linear regression  with   features  an
evaluation of the model using the mean squared test errors results in mse        meters squared 
  evapotranspiration data are not collected at the jasper ridge weather station  though evapotranspiration is expected to play an important role in governing mass flows out of the aquifer system  typically  when evapotranspiration
data are not measured directly with evaporation pans and crop coefficients  they can estimated from average daily
temperature  wind speed  humidity  and solar radiation  for this project  instead of explicitly calculating evapotranspiration using one of these methods  we will simply use temperature  wind speed and humidity data as inputs into
our model  and allow the model to develop appropriates weights for these inputs 

 

fics     final project

 a  test results

sara maatta

 b  test and training results  training occured from nov
         to june          and testing occured from june   
     to june         

figure    test and training results using unweighted linear regression
model evaluation and improvement
an evaluation of testing and training error versus number of training examples indicates that the  feature system has high bias  figure   shows the test and training error against number of training
examples  to correct for the high bias  i created more features  specifically  features that give a
measure of seasonality to each example  the features i selected were moving averages of the six
original features  calculated for the previous one week  one month  three months  and six months 
i also included a variable m           to represent the month that the example is in  as another
measure of seasonality 
with these    features  the linear regression model does much better  with mean test error of
mse        meters squared 
inspection of the    feature model indicates that the model does worst during the winter months 
when the groundwater levels are highest  in an attempt to help the model correct for this issue  i
created another feature that is an indicator of high groundwater likelihood  based on the height
of the lake stage  high lake stage is strongly correlated with high groundwater table   thus if lake
stage is above      m mean sea level  the indicator variable is    and   otherwise  the mean squared
error for the model including the high lake stage indicator is mse         meters squared  so we can
see that inclusion of this feature did not help the model predict winter levels any better 
next i performed an ablative analysis to investigate which features and subsets of features are
the most important  table   shows the results of the ablative analysis  interestingly  the six month
moving averages appear to be the most important features for the system  this results implies that
the most important aspect of the system to consider is not the recent weather  but the past seasons
weather  for an area with an arid climate like california  this finding makes intuitive sense  because
groundwater levels are expected to be strongly influenced by the season 

neural network
i trained a feed forward time delay neural network with backpropagation using a sigmoid transfer
function  the network architecture has two layers of hidden nodes  each layer had    nodes  i
trained for    iterations  ie    epochs   with a delay vector of                   
the test error is mse         meters squared  which is significantly worse than the linear
 

fics     final project

 a    features

sara maatta

 b     features

figure    test and training error for linear regression

ablated feature
  all features included 
  month moving averages
  month moving averages
  month moving averages
  week moving averages
precipitation features
lake stage features
temperature features
wind speed features
humidity features
stream flow features

test error    
   by definition 
    
   
  
  
   
   
   
   
   
   

train error    
   by definition 
   
   
  
  
  
   
   
  
   
   

table    ablative analysis of linear regression model  the higher the change in test error  the more
important the feature s  for the success of the model

 

fics     final project

 a  test results

sara maatta

 b  test and training results  training occured from nov
         to june          and testing occured from june   
     to june         

figure    test and training results using a neural network
regression with    features  but comparable to the linear regression with   features  as you can see
in figure    the neural network severely overfits to the training set  and doesnt do very well on the
test set 
however  the neural network does perform better than the linear regression in one respect  the
neural network is much better at predicting the winter groundwater levels 

model comparison and conclusion
linear regression does a good job of predicting groundwater levels in the summer  when water levels
are low  while the neural network does a good job of predicting groundwater levels in the winter 
when water levels are high  this result supports the combination of linear regression and neural
networks for predicting hydrologic response up to one year in advance 
long time frames  ie    month and   month moving average  are extremely important features
for the linear regression algorithm  while short term    month and   week moving average  are less
important 

acknowledgements
   data from david freyberg  department of civil and environmental engineering  stanford
university
    neural networks for the prediction and forecasting of water resources variables  a review of
modelling issues and applications  by maier and dandy  environmental modelling   software 
                 

 

fi