contextual window based neural network model for predicting rainfall
in rural india
paavni rattan  rishita anubhai  amogh vasekar
stanford university

abstract 
we propose a neural network based model for predicting rainfall and subsequently  the occurrence of floods for
any given city in india  our initial implementation has primary focus on a rural city in bihar  a state which
experiences erratic rainfall behavior 
we start with simpler models based on time series analysis and linear regression  ultimately combining them
using a novel contextual window method  the initial results are promising and comparable with the state of theart methods published in this domain 
introduction 
in this project  we aim to develop novel methods that allow us to reliably predict the amount of rainfall a given
indian city would receive in any month  as an extension  we also develop a model that predicts the occurrences of
floods in that area 
the motivation comes from the fact that in developing countries  a majority of the farmers rely on rainfall for
cultivation of their crops  and plan their sowing or harvesting periods accordingly  erratic rainfall behavior has a
particularly adverse effect on their planning  leading to huge economic losses  in recent times  the burden of these
losses due to unpredictable rainfall behavior has lead to a sharp rise in suicide among farmers  this is especially
true in rural indian areas where a majority of the population earns their livelihood through farming and related
activities  we try to address this problem using machine learning techniques 
related work 
this field of work is popularly known as the  all india summer monsoon rainfall  aismr prediction  since rainfall
prediction can have tremendous socio economic impact  work on aismr prediction has been an evolving topic of
research  work on aismr prediction began as early as the     s using himalayan snowfall data  and extra factors
such as wind pressure in mauritius  zanzibar and seychelles  these prediction models were all evolving more
along the lines of choosing predictors  rather than developing machine learning techniques 
the predictors were broadly classified under four main categories as follows 
   regional conditions
   enso  el nino south oscillation  indices
   cross equatorial flows
   global hemispheric conditions  kumar et al       
the regional circulation conditions were observed to be most significant of these categories  while enso indices
were also considered good indicators for this work 
after this point  while work continued to be done with respect to choosing the right indicators  machine learning
techniques used for aismr prediction also started diversifying  to avoid over fitting as a result of too many
predictors  or predictors that were highly correlated  pca became a commonly agreed technique  the two major
methods used for generating the model were multi variate linear regression and non linear regression using
neural networks  methods such as limited area model  lam  and mesoscale model    mm   are categorized as
numerical weather prediction  nwp  methods  which also form an important category of methods 
as nwp methods became more popular  a shortcoming found with these methods was high variation in results
based on initialization conditions  and their approximations of complicated physical process and interactions  as a
result  ensemble methods and superensemble methods  krishnamurti        became the state of the art
methods  which are essentially a mix of multiple nwp methods  the ensemble methods weigh the nwp methods
individually based on the spatial and temporal performance of each method  and combine the results by these
weights  many recent papers have analyzed the performance of these methods  bhowmick  durai        
data 
we primarily use data made publicly available by india water portal and tyndall centre for climate change
research  the data is published on a website  which we scraped due to lack of apis  to create structured records 

 

fithe data contains information from      to       at monthly granularity  about all indian cities for    climatic
parameters listed below 












precipitation  i e  rainfall 
cloud cover
wet day frequency
vapor pressure
ground frost frequency
potential evapotranspiration
reference crop evapotranspiration
minimum temperature
maximum temperature
average temperature
diurnal temperature range

thus  in essence  we have time series data about rainfall and related climatic parameters for indian cities  we
picked the city of kishanganj in the state of bihar  which has seen high deviation in rainfall  to train and test our
model  choosing one city allows us to efficiently concentrate on development and implementation of methods 
since the data contains parameters using different metrics and scales  we normalize the data  we also employ svd
to try and remove highly correlated parameters  we found that svd does not significantly alter the data 
the second data set was created by annotating occurrences of floods in the state of bihar for every month from
     to       this was done using publicly available reports 
methodology 
we start by analyzing the data using two tangential methods  in the first  we only use historical rainfall
information and view it as a time series of rainfall with      data points     years x    months   in the second
method  we use only the climatic features mentioned above to predict rainfall  both the methods use linear
regression  our major effort focuses on effectively combining the above two methods  since each has its own
advantages  we describe this method based on neural networks later in the section 
the above methods address the problem of predicting rainfall  in each of these cases  the training data is a slice of
   years of the whole data set  we test on the data for remaining    years 
to predict floods  we use logistic regression using the climatic features  the second data set mentioned in the
previous section   we train on data from             and test for data from            
   time series analysis
we disregard the climatic features and consider only rainfall in this approach  given the seasonality of months in
india  we follow the intuition that the rainfall in any month is correlated to the observed rainfall in the previous
   months  along with the rainfall in the same month over the previous    years  for example  this model builds
on the hypothesis that rainfall for the month of august in year      is dependent on the rainfall observed from
august      to july       as well as the rainfall recorded in the month of august for the years                    
this forms our historical time series of data 
thus  every training data point now contains    values representing the features mentioned above  and the actual
value of the rainfall for the month of interest 
we then use linear regression to predict the rainfall using above features 
   climatic parameters analysis
this method assumes that the rainfall in a month is dependent on the    other climatic parameters mentioned
previously  thus  for this analysis  we use linear regression to model the rainfall as a function of all the other
climatic features 
   feed forward neural network with single hidden layer
both the complementary methods described above capture a particular relationship in the data  our major effort
has been concentrated on trying to combine the two approaches  the intuition behind this was that a model that
combines the time series relationship of the data along with the effect of climatic features should be ideal  this

 

fiapproach uses a combined data set  thus  every row represents one month of a year in the matrix input to the
neural network 
 a non contextual neural network
in this approach  we provide the complete data matrix as input to the neural network  every data point is a simple
concatenation of all the climatic features  the model is trained using this matrix as an input  and by tuning the
parameters for number of hidden nodes  number of iterations to convergence  learning rate and non linear
activation function 
 b contextual window based neural network
in this novel approach  we define a context for each data point based on a rolling window  the intuition behind
this approach was that rainfall in a certain period of the year depends on the rainfall in the same period of
previous years  rather than all the rainfall in the past  as a result  the neural network gets inputs in the form of
what we define as context windows i e  windows of relevant feature vectors of the past for a given month 
example  if the subject of our attention is january       the window is a concatenation of feature vectors of
january       january       january      and so on  another type of context we defined was a context of the
immediate past few months where january      would get the context of december       november      and
so on  we experimented with providing different sizes and types of context windows  we summarize this
approach as neural networks with contextual windows  we experimented with windows based on adjoining
months  same months in the previous years and same months in the available future years  and combination of
these approaches  on parameter tuning  we found that the month wise historical contextual windows gave the
best results  and the intuition behind yearly cycles of seasons and rainfall seemed to hold true 

figure    contextual window based neural network

stochastic tuning of weights
we use a step by step method for tuning the weights used by neural networks  using the optimal weights obtained
from one window as initialization of weights for next window  we initialize the weights randomly between     
in the first step where
       hidden size    number of features context window size  
this is because        fan in   fan out  is known to be a good choice for this range of initialization in neural
networks 
logistic regression for predicting floods
to predict the occurrence of a flood  we have used the logistic regression method  it is essentially a binary
classification problem with rainfall for a month being the input  once we predict the amount of rainfall using the
contextual window based approach  we feed the information to a logistic regression based method for
classification  as mentioned at the start of the section  the model was trained using flood occurrences from      
results 
to predict the rainfall  we use two error measures to evaluate and compare the models  the first error measure is
the mean absolute error  mae  of the predicted rainfall  however  this measure can be misleading since our final
goal is to predict the occurrence of floods  and not to accurately predict the rainfall  specifically  being able to
predict rainfall within a range of say     to    mm  when the actual rainfall is in the range of     mm is still very
accurate  in essence  a more relevant error measure should also capture the deviation of the predicted rainfall

 

firelative to the actual rainfall  thus  we also report weighted absolute error  wae  of our predictions  with the
actual rainfall constituting the weights  this allows us to measure the variance in predictions relative to the actual
rainfall observed 
in our initial analysis  the historical data explains      r            of variance in the precipitation and climatic
data explains      r            of the variance in precipitation  on tuning the non contextual neural network we
find the following values as optimal for parameters  number of nodes in the hidden layer       number of
iterations to convergence        leaning rate        and activation function   tanh  using this as baseline we
tune the contextual window based model and find the following values as optimal for parameters  number of
nodes in the hidden layer       number of iterations to convergence        regularization parameter          
and window size if used       we also find that using only the past data is most optimal 
we find the contextual window based approach using a    year look back window to work the best using both
the mae and wae errors  as expected  the non contextual neural network method reports a lower mae  but only
slightly  importantly  it reports a higher wae as compared to the time series approach  this suggests that noncontextual approach does not completely capture the historical relationship  thus  it corroborates with our
intuition of using contextual windows 
we use cross validation technique to test our models  specifically  we train on data up to the year      and test
on data from      to      

mean absolute error  mm 

time series
analysis
     

weighted absolute error  mm       x      

climatic feature non contextual
based regression neural network
     
     

contextual
neural network
    

     x      

     x      

     x      

figure    actual vs  predicted rainfall

the above figure compares the rainfall predicted by the contextual window model against the actual observed
rainfall in our testing set  it is important to note the correct prediction of peaks in some months  which allows us
to proceed with the prediction of floods  the figure below shows the distribution of error  mae  for the model 
we observe a long tailed distribution indicating that most of the values predicted by us have a low mean absolute
error and only a few values are very different from actual values 

 

fifigure    distribution of error

the latest published results  vivekanandan        in this domain use rms error as the measure  compared to
their rms error of about   mm our model obtains a value of   mm 
our logistic regression model for predicting floods has a precision of     but a recall of only      the lower
recall can be explained as the occurrence of floods is a rare event  and we have limited training data 
future work 
we plan to evaluate our model against the data for other cities with different patterns of rainfall  we also plan to
run our algorithm on data sets used by existing algorithms so as to obtain a better comparison with these
methods  we also plan to experiment further using more hidden layers  and see if it provides better results 
it is conjectured that atmospheric pressure and winds are highly correlated to rainfall  and we are trying to obtain
data for the same to use in our model 
in addition  we wish to extend the work to predict droughts as well 
conclusion 
we have successfully developed a novel method using contextual windows to predict rainfall in a rural indian
district with mean absolute error of about  mm  our method yields comparable results than currently published
work in the domain  subsequently  the algorithm can predict the occurrences of floods in the area  we hope our
work and methods will help the concerned authorities plan better to help farmers in rural india  and also
motivate usage of machine learning techniques to solve a socially relevant issue 
references 
   india
water
portal 
arghyam 
  
july
     
web 
  
nov 
     
 http   www indiawaterportal org metdata  
   munot  a  a   and k  krishna kumar   long range prediction of indian summer monsoon rainfall   j  earth
syst  sci                      
   roy bhoumik  s  k   and v  r  durai   mulit model ensemble forecasting of rainfall over indian monsoon
region   atmosfera                     
   cannon  alex j   and ian g  mckendry   forecasting all india summer monsoon rainfall using regional
circulation principal components  a comparison between neural network and multiple regression
models   international journal of climatology                    
   guhathakurta  p   m  rajeevan  and v  thapliyal   long range forecasting indian summer monsoon
rainfall by a hybrid principal component neural network model   meteorology and atmospheric physics
 springer   verlag                    
   vivekanandan n   prediction of seasonal and annual rainfall using artificial neural network india water
week       water  energy and food security 
big thanks to prof  andrew ng and the staff of cs    for guiding us throughout the project

 

fi