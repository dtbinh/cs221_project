k means clustering of states in dual beam optical trap assays
chao liu
december         
abstract
dual beam optical trap is a common biophysics tool to study proteins on the single molecule level  it has
been used to characterize actin based myosin function which forms the basis for muscle contractions  data
consisting of time position traces obtained from the assay is currently manually analyzed to discriminate the
two different states of the actin myosin system      in order to improve accuracy and efficiency  the
unsupervised k means clustering algorithm is applied to this classification problem using several features
derived from the time position traces  different weighted combinations of features are evaluated to give the
best performance  the algorithm correctly clusters simulated data with precision      and recall      and
also performs very well on real data 

  introduction
at the molecular level  muscles contract when the motor protein myosin binds to actin and exerts a pull  the
biophysical study of actin myosin interaction on the single molecule level can be performed using the dualbeam optical trap assay      as shown in figure   a   two micron sized dielectric beads in solution are
trapped under the electric potential of two highly focused laser beams and are connected to each other by a
taut actin filament  they undergo brownian motion while being confined in space by the traps potential 
when a myosin immobilized to the surface binds to the actin filament and executes a stroke along the
filament  the attached beads experience an additional force and are displaced from their original position 
over time while the actin myosin system switches between bound and unbound states  detectors track and
record the position of each bead  various factors can be then extracted from this data  including the length of
time myosin is bound to actin and the step size taken by the myosin motor  these factors are important both
in understanding normal myosin behavior and in characterizing changes seen in diseases such as
cardiomyopathies caused by mutations in cardiac myosin genes        
the critical data analysis step for dual beam optical trap assays is thus the discrimination of bound and
unbound states in the recorded traces  difficulties arise from low signal to noise ratio because displacement
due to brownian motion is on the same order as that due to myosin binding and stroking     nm  so that
short binding events may be misidentified as noise and vice versa  moreover  states are currently assigned
manually      a very time consuming process which also produces large variability in the interpretation of the
data by different human analyzers 
the purpose of this project is then to improve the accuracy and efficiency of classifying myosin actin
bound and unbound states in dual beam optical trap assays by automating the interpretation of data using kmeans clustering  this unsupervised learning algorithm exploits multiple features extracted from the
recorded trace data  including mean displacements for each bead  standard deviation of displacements  signal
to noise  and bead bead correlation  performance is first assessed on simulated data along with feature
weights selection  then on real data taken in assays of actin filament and cardiac myosin 

 

fi  data
although a large amount of data from dual beam optical trap assays of the actin myosin system already
exists  there is much variability in the manual assignment of states due to various factors in the data not
completely understood  so that the correct labels are not entirely known  therefore it is informative to test
a learning algorithm on cleaner simulated data first 
two tethered brownian motions representing displacements of the two trapped beads in a dual beam
optical trap assay are simulated as prescribed in      with several modifications  first  the steps of the two
random walks are sampled from a bivariate gaussian distribution with nonzero covariance in order to
incorporate the correlation in displacements of two connected beads      the variances of the two
displacements are assumed equal but can be readily adjusted  second  in the bound state  the values used for
both the covariance and variances are lowered as observed in real data      in addition  a fixed displacement
representing the stroke taken by myosin is added to each beads brownian motion during the bound state 
this simple addition does not entirely capture the physical details but should suffice for the purpose of
simulation to test the learning algorithm  finally  the durations of bound and unbound states are sampled
from two exponential distributions with means expected of the waiting times of myosin unbinding and
binding  respectively  the much longer average duration of the unbound state is mainly due to the diffusion
limited rate of myosin binding  key parameters used are summarized in table    several hundred bound and
unbound events are generated  a short segment of simulated data is shown in figure   b  
one set of real data containing roughly    binding and unbinding events taken from a dual beam optical
trap assay of actin filament and cardiac myosin is provided by professor jim spudichs lab in stanfords
biochemistry department  a short segment is shown in figure   c   note that here the displacement induced
by the bound state is negative and  more importantly  that it is difficult to consistently manually assign states
due to the much greater complexity present in real data but not in simulated data 

  methodology
the generated displacement time data of the two beads is first evenly binned in time so that five features can
be calculated for each bin  mean displacement of bead    mean displacement of bead    standard deviation of
bead   displacement  standard deviation of bead   displacement  and correlation between bead   and    two
additional features  signal to noise ratio  snr  of bead   and snr of bead    are then calculated for each bin
as the mean displacement divided by the standard deviation  a choice of thirty to fifty raw displacement data
points per bin easily results in several thousand bins  or examples  depending on the amount of data used 
thus the training set consists of several thousand examples  each given as a seven element feature vector 
the k means clustering algorithm is then applied to the examples  with k    to group them into two
clusters representing the bound and unbound state  the two cluster centroids are initialized by setting their
values equal to the features of two randomly chosen examples  each iteration of the algorithm then  i 
assigns examples to the closer cluster centroid and  ii  moves each cluster centroid to the mean of the points
assigned to it  convergence is achieved when the cluster centroids no longer change significantly 
in applying k means clustering to the dual beam optical trap problem  a few adjustments are made 
before calculating the distance between an example and a cluster centroid in step  i  of each iteration  each
feature  whose magnitude may be on a very different scale from that of other features  is first normalized by
its standard deviation across all examples  this prevents uncontrolled bias of cluster assignment based on
large valued features  after this rescaling  each feature may be assigned a weight based on empirical
knowledge of how informative it is to cluster discrimination  the same normalization and weighting of a
feature are applied to all examples 
after k means clustering has grouped the data into two clusters  the labels unbound and bound are
assigned simply based on prior knowledge of each states characteristics 
 

fi  results
results of k means clustering of simulated data are given in figure    figure   a  shows the clusters found
using only the features mean displacement   and    giving precision      and recall       false positives
occur at the boundary of the two states  caused partly by the closeness of clusters and by the highly skewed
cluster sizes  showing that using only the mean displacements  essentially thresholding  to perform clustering
is not sufficient  table   presents the result of using various different weighted combinations of the seven
features  this reveals that the means and snrs are very relevant features yielding high accuracy as
compared to standard deviations and correlation  however  the best performance with both high precision
and recall is achieved by a weighted combination of all seven features  with means and snrs having the
largest weights  figure   b  displays the clusters found using this optimal weighted combination  producing
precision      and recall      
results of k means clustering of real data are given in figure    figure   a  shows the clusters found
using the optimal weighted combination of all seven features as determined in testing simulated data  despite
the complexity of real data  the learning algorithm has successfully discriminated two states by exploiting the
features  precision and recall are not calculated because the correct labels are not known unless a human
subjectively assigns them  nevertheless  a qualitative inspection of the assignments by the learning
algorithm  given by a plot of a short segment of raw displacement time trace in figure   b   suggests that the
correct classifications have indeed been made 

  conclusion and future work
current manual assignment of bound and unbound states in data taken from dual beam optical trap assays of
the actin myosin system is inconsistent and time consuming  therefore an automated data processing is in
need  the k means clustering algorithm has been successfully implemented and tested on simulated data and
produces high accuracy by exploiting a weighted combination of features available  it is observed to also
perform surprisingly well on real data despite the significant increase in the complexity of real data due to
various noisy factors ignored in simulation  based on these results  successful application of this algorithm to
real data in future work is promising  to this end  the advantage of unsupervised clustering over supervised
learning is its adaptability  different data sets taken from trap assays can give different characteristics such as
standard deviation  displacement due to different stroke direction and size  and other variables  while a
supervised learning algorithm restricts these values owing to its learning of specific feature values associated
with known labels  the k means unsupervised clustering readily group examples in any given data set 

acknowledgements
i would like to thank jongmin sung from the spudich group for the helpful discussions and for providing the
real data 

references
    sung j  sivaramakrishnan s  dunn ar  spudich ja          single molecule dual beam optical trap
analysis of protein structure and function  methods enzymol              
    palmiter ka  tyska mj  haeberle jr  alpert nr  fananapazir l  and warshaw dm          r   q and
l   v mutant beta cardiac myosin from patients with familial hypertrophic cardiomyopathy exhibit
enhanced mechanical performance at the single molecule level  j  muscle res  cell motil             
    beausang jf  et al          elementary simulation of tethered brownian motion  am  j  phys             
 

fiposition sensitive detectors
ir laser beam
actin filament

myosin

optically trapped beads

gfp
antibody
immobilized platform bead

a
simulated coupled optical traps

displacement of beads in a dual beam optical trap assay

  

  

bead  
bead  
binding and stroke events

  

bead  
bead  
  

displacement  nm 

displacement  nm 

  
 
 
  

  

 

   

   
   

   

b

   

c
 

    

   

    
time  s 

   

    

   

   

 

    

   

    
time  s 

   

    

   

figure    dual beam optical trap assay for study of myosin  a  experimental setup  drawing not to
scale  figure taken from      b  a short segment of simulated displacement over time of the two
trapped beads  red and blue   binding and stroke events are simulated as positive displacements and
shown in black  c  a short segment of real data taken from dual beam optical trap assay of actin and
cardiac myosin  provided by the spudich lab  bead   and   displacements shown in blue and red 
binding and stroke events in this data correspond to negative displacements  labels of bound and
unbound states are not clear due to the greater complexity of real data 

stroke size
mean unbound time
mean bound time
brownian bias

  nm
    s
   ms
   

variance unbound
covariance unbound
variance bound
covariance bound

 
   
   
   

table    key parameters used in simulation of two coupled tethered brownian motion

 

fibead   vs    averaged displacements   predicted

bead   vs    averaged displacements   predicted

  

  
bound
unbound
fp
fn

a

 
 
 
 
 
  

 
 
 
 
 
  

  

  

  

  

  
   

  

 
 
averaged displacement    nm 

  

bound
unbound
fp
fn

  

averaged displacement    nm 

averaged displacement    nm 

  

b

  

  
   

  

 
 
averaged displacement    nm 

  

  

figure    result of k means clustering on simulated data  displayed by plotting the feature mean
displacements  bound in green  unbound in red  fp  false positive  in blue  fn  false negative  in black 
a  using only mean displacements of bead   and    precision         recall         b  using all seven
features  weighted  where wmean      wsd        wsnr        wcorr        precision         recall        

wmean
 
 
 
 
 
 

wsd
 
 
 
 
 
   

wsnr
 
 
 
 
 
   

wcorr
 
 
 
 
 
   

precision
    
    
    
    
    
    

recall
    
    
    
    
    
    

table    results of k means clustering on simulated data using weighted features

bead   displacement and predicted states

bead   vs    averaged displacements   predicted
  
  
  
bound    or unbound   

averaged displacement    nm 

scaled data
predicted bound
predicted unbound

bound
unbound

 
 
  
   
   

 

 

   
   

a

   
   

   

   
   
  
 
averaged displacement    nm 

 

b

  

 

   

   

   

   
   
time  s 

   

   

   

   

figure    result of k means clustering on real data  a  display of clusters by plotting the feature mean
displacements  predicted bound in green  unbound in red  all seven features used and weighted  where
wmean      wsd        wsnr        wcorr        b  a short segment of raw trace of bead   displacement with
assignment of bound state in green and unbound state in red  displacement has been scaled for display 
 

fi