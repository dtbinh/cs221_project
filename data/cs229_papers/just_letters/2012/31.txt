cs     final project report
learning to decode cognitive states of rat using functional magnetic resonance imaging time series
jingyuan chen   department of electrical engineering  cjy     stanford edu  

i background
ii  classifiers
recent fmri studies have observed that the functional
classifiers were trained using short intervals of rat fmri
connectivity between different brain regions may exhibit data known to correspond to either rest state or
significant dynamic changes when people are at rest      anesthetized state  after training  the classifier was
despite the little known nature of the temporal dynamics at supposed to determine whether an unseen segment of fmri
rest  its still possible for us to localize those dynamic dataset corresponded to a rest state or anesthetized state 
sources by comparing the fmri time series at rest state to
the analysis consisted of five steps 
anesthetized state  a mental state characterized by a
 a  choose p elements  voxels  networks  that will enter
profound loss of conscious and a more stable baseline the classification analysis 
condition of the brain  however  as both states are task free 
 b  define measures of brain activity  voxel intensity 
we are unable to reference an external task waveform and functional connectivity  time frequency coherence  and
utilize linear regression method to pre select the corresponding samples 
voxels regions of interest        it naturally becomes a
 c  use a subset of trials to train the classifier via
problem dealt with machine learning project  patterns that are support vector machines  svms  
informative with respect to the differentiation of rest state
 d  use    fold cross validation to test the generalization
and anesthetized state may likely have strong error of the classifier 
neurobiological relevance  and are hypothesized to be a
 e  map the weighting of each element 
potential candidate for the dynamic source in the rat brain 
for the specific project  advantages of using rat as the
the primary focus of the present project was step  a 
object are twofold   i  the cognitive mental states of rats are and  b    section iii iv v  from now on  let        denote
 
anticipated to be less complicated compared to human beings  the fmri time series of voxel i after preprocessing      
 
 
along with the smaller voxel amount  the dimensionality of denote the rest state time series          denote the
classification features can be greatly reduced without losing anesthetized state time series 
useful information   ii  anesthesia can be easily accomplished
in section iii  p voxels clusters were pre selected based
in rats 
on various dimensionality reduction methods  considering
that the fmri time series were temporally correlated with
ii problem illustration
each other  the modified voxel intensity                  i e 
average of the absolute voxel intensities across five
i  object
consecutive time points  was chosen as the measure of brain
the fmri datasets from   rats were analyzed in the activity 
present project  each rat underwent an   min rest state scan
in section iv  p networks were generated via
and an   min anesthetized state scan 
independent
component
analysis
 ica  
network
preprocessing of the fmri time series consisted of  connectivity measure  sliding window pearson correlation
slice time correction  motion correction  low frequency drift
and wavelet transform coherence  were introduced to
detrending  signal amplitudes were further scaled to characterize the brain activity 
percentage change 

fiiii feature selection  voxel intensity
 
since the number of voxels inside the rat brain is large
         with the protocol in the present data acquisition  
including all voxels for classification analysis is sub optimal 
 i  it would increase the computation complexity and be quite
time consuming  given the large feature dimension   ii 
machine learning algorithms  like svm  might degrade their
performances if the number of voxels conveying the
discriminative information is much smaller compared to the
total number of voxels        which is always true under the
small world assumption of brain models  this is also
confirmed by the results of the present project  thus  its
reasonable and helpful to perform a dimensionality reduction
prior to svm classification  three dimensionality reduction
approaches were implemented in the project 
i  significance based feature selection under the hypothesis
that informative patterns only consist of voxels that show a
significant
difference
between
rest state
and
anesthetized state  it would therefore be reasonable to
restrict our analysis to those significant voxels  which can
also simply the interpretation of the final results 
previous studies have demonstrated that the raw voxel
intensity of fmri time series        can be well fitted by
gaussian models  noting that our modified observations
               actually follow folded normal distributions  a
simple two sample t test used by previous literatures      
might introduce bias into the present testing model  to
address this problem  non parametric wilcoxons rank sum
tests were introduced in addition to t test to select those
significant voxels 
 significant voxels    t test  p          rank sum test  p      

ii  principal component analysis consider the fact that in
fmri studies                          always hold  the
computation of svm can be greatly reduced via the pca
kernel trick  while preserving all the feature information 
   
   
specifically      
 
and     
 
were temporally
 
concatenated     denotes z transformation  zero centered
and divided by its standard derivation  to avoid the improper
mapping due to significant differences in signal intensity
 
 
under two states   however      
  and     
  were taken
as the training samples of svm  so here existed an
inconsistency between pca mapping and svm training 

later  we can notice a difference between various data
reduction methods  the inconsistency here was thought as a
candidate source to the observed differences 
iii  clustering analysis i also utilized cluster analysis
methods to accomplish dimensionality reduction  i e 
separated the rat brain into various small regions  and
simplified each small region as a single feature  due to the
slow computation of k means clustering method  i chose
normalized cut method  http   www cis upenn edu  jshi soft
ware   to perform the clustering analysis  which takes each
voxel as a node  and recast the image segmentation as a
graphic partition problem  in the current analysis  i chose the
pearson correlation with threshold     as the weight measure  
the observation corresponding to each cluster is derived as
follows  for each voxel within the cluster  sum up its
correlation with all the other voxels within the same cluster 
choose    voxels with the highest summation of correlation
values  and take the average of their observations 
to be more confident with the clustering result  i also
compared the clustering results from n cut method with
those from k means method for a couple of datasets  a
measure of similarity        between the generated clusters
is defined as follows 
let            denote the cluster index of voxel   resulted from
k means methods and normalized cut methods 
 

          

 

                                                      
                         

i e  the ratio of cases that two methods give consistent
clustering results with respect to a voxel pair  two voxels are
within the same network or not   i assume that the larger
extent that the two clusters overlap with each other  the more
reliable the clustering result is               in the tested
datasets indicated a convincing clustering result  shown in
figure   
the classifiers trained after dimensionality reduction
worked surprisingly well  the generation error in the    fold
cross validation were   for all the three approaches  however 
the discriminative patterns were inconsistent across rats
 figure   c d  and dimensionality reduction methods  figure
   a  b  c     wi  larger than     of the max  wi   was to
approximate p            

fiiv feature selection  network connectivity
as mentioned above  previous machine learning
approaches to fmri analysis were mainly confined to
voxel roi intensities  i was especially interested to see
whether choosing features that can characterize connectivity
behaviors  which attracts the primary attention of fmri
researchers  can also give informative discriminations
between various mental states  again  the dimensionality
issue becomes more problematic when it comes to the
connectivity behavior  as
      
 
          
          
 
 
therefore  i attempted to explore the connectivity at the
network level instead of the voxel level  independent
component analysis  ica  method  via a matlab based
toolbox  http   mialab mrn org software gift   was utilized to
generate the networks ics   to be consistent with prior
literatures  ic number was set to be           networks of
interest noi  were further chosen through visual inspection 
resulting       networks per rat 
i  sliding window pearson correlation analysis to get the
time varying observations of the connectivity between
different network pairs  the sliding window correlation
coefficient     was introduced  figure   
the sliding window correlation between two network time series  x
and y  is defined as                                    where w is the
window size          and         denote the portion of the time series
from t to t w    corr    denotes the computation of pearson correlation
coefficient 

not surprisingly  like using voxel intensity as the feature 
svm gives    training error in    fold cross validation 
however  features  network pairs  with the maximum     are
still not consistent across rats  taking together the result
from section iii     training error indicates that rest state
and anesthetized state are highly separable  inconsistency
across methods rats may likely imply a wide spread
discriminative patterns  or perhaps due to rats individual
differences  as the mental states of rats are less controllable
compared to human beings 

 
                                                  
classifiers trained by voxel intensity and pearson correlation

have achieved perfect generative performance  but the
discriminative patterns  voxels network pairs  are not
consistent across rats  i further extended the features into the
frequency domain  hoping to explore whether the
discriminative patterns of different rats reside in similar
frequency bands  figure   a  
wtc http   www pol ac uk home research waveletcoher
ence   offers a measure of the time varying coherences
within different frequency bands for each network pair     
          

                
         

     

 

 

         

     

 

                      

                                                                     
                                                                          
                              

to simplify the computation  i further separated the
frequency into four frequency bands        hz 
         hz           hz          hz  tr  the sampling
rate is  s  by averaging the wtc falls into the corresponding
frequency range  figure   b  
for n network pairs  we therefore got      features  by
taking the coherence value at different time spots as a sample
and applying svms to the wtc results  we got the
weightings                                      of the coherence of
different network pairs across different frequency bands 
for each rat  the discrimination level of a specific
frequency band     is defined as 
 

      

        

 
            

           

 
              
 

reflects how discriminative the between network
coherences within the j th frequency band is compared to
other frequency bands 
as shown in figure    the   rats showed a similar
pattern  the most discriminative information mainly resided
in the low frequency bands  this result is in accordance with
general acknowledgement that rest state is characterized by
low frequency fluctuations 
  

fi figure   feature mapping after dimensionality reduction  green  brain mask     slices   red  voxels surpassing the thresholds
 
       
       
       
       
 

                                     
                            

                             a  b          c  def                    a  b        
                              

figure   clustering results of k means and n cut  similarity         

                              

    def                    a  b        
                              

figure   illustration of sliding window pearson correlation
             g           h      

i     j                    

n       

      

figure   illustration of wtc
figure  

         k     j   e        l   gg      
g  m      c     g              h      
 c 

  e  g         h        

fiv feature selection revisit

 
vi summary

feature selection methods introduced in lecture note  
and recursive feature elimination  rfe  proposed in    
in the present project  ive tried to apply machine
were also tested in the present study to see whether they learning knowledge to detect patterns  voxel intensity 
could improve the generalization performance of the network connectivity  that are informative respect to the
classifiers  as mentioned in section ii and iii  using the mean differentiation of rest state and anesthetized state in rats 
absolute value                as the voxel intensity resulted in    results indicated that   a  both voxel intensity based and
generalization error for all dimensionality reduction cases network connectivity based feature selection methods can
 which could not be further improved   instead  i used the result in minimum classification error   b  the trained
raw voxel intensity        to train the classifiers      clusters classifiers are sensitive to the dimensionality reduction
generated by the normalized cut method were chosen as the methods   rats individual differences in the present study 
features 
 c  wtc analysis showed that the network coherence
differences between rest state and anesthetized state
i  mutual information   forward feature selection
mainly reside in the relative low frequency band 

 

 a  kl divergence was utilized as a criterion to sort the     features 
 b  forward feature selection      fold cross validation were
combined to find the optimum features 

ii  rfe
while   stop 
 a  train svms using    fold cross valiation 
 b  compute the scoring function of each feature 
          

  
            

  

vii acknowledgement
i gratefully acknowledge dr  gary glover in radiology
department and emily ferenczi in neuroscience department
for rat fmri data acquisition 

 
viii references

                 

 c  sort the features based on       
 d  eliminate features with smallest scores
end

    chang et al   timefrequency dynamics of resting state brain
connectivity measured with fmri  neuroimage                   
                        a            b                                    

the results are shown below 

                                  c d       e      f          
           fg        h           i   jjk  lijmllkn   
 o   p                  f        q                            fg c    
                   h          rk   jjl  dsllmd jjn   
 r   f                  a  b                                           
                                                           fg  
                  h          ro   jji  rrmkin   
 k   d              h      t    a                 d               uuu 
                                                                  e   
    h   i   jjj  
 v   a      a        w         a          d              fg  
x           ad   l  jjk          y    n   

                                                       
                                                    
                                                       
                                                    
                                             

 z  q          g   b                                        ph d  
 js   e   sjl  h  sj  olzlmolir        
 i  q                                  a                         
                h                    g            x    y           
h              jss  os  sj   ozzvmozio      

fi