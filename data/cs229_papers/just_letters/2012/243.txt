cs    predicting transcription factor binding
authors 
jon tatum  jdtatum 
daniel williams  danielhw 
zoey zhou  cuizy 

advisor  sofia kyriazopoulou panagiotopoulou  sofiakp stanford edu 

introduction
since scientists have successfully determined the dna sequence of the human genome  the
next step is to understand the roles of the different regions  especially of gene regulation  the
transcription activity of a gene can be controlled by transcription factors  tf   proteins that bind
to specific dna sequences and either promotes or represses the transcription of the nearby
dna to mrna      the dna sequences these transcription factors are likely to bind are called
motifs  and the encode consortium has listed some known motifs derived from experimental
datasets 
with just the knowledge of the dna sequence  it is not enough to predict which regulatory sites
will be bound and the effects it has in overall gene regulation  indeed our bodies are composed
of many different cell types that have different gene expressions profiles according to cell type 
but all stem from the same copy of our dna  what biological factors can predict tf binding can
allow us to better understand the basic biological mechanisms and perhaps make new
discoveries  in addition  understanding how gene regulation changes in different cell types and
especially in diseased cell states is essential 
chromatin immunoprecipitation with massively parallel sequencing  chip seq  is the standard
assay for genome wide detection of tf binding locations for a specific tf  however the
limitations are that chip seq can only detect one tf a time over one cell type when the reality is
that hundreds of tfs are binding and regulating dna transcription  using machine learning
methods to predict tf binding can potentially allow us to compare across numerous different
tfs as well as across cell type  in addition to using chip seq data  we incorporate other
biologically relevant data such as dnase   sensitivity  chromatin usually exists in the cell as
complicated structures tightly bound with histones that prohibit transcription  dnase activity
indicates whether it is an open region of chromatin that tfs can bind to      we use machine
learning with supervised learning and features extracted from chip seq and dnase activity data
to make predictions about tf activity in different cell types 

methods
text extraction
specific base pairs that are referenced in chip seq peaks can be extracted using the hg  r
eference genome  our chip seq peak data provides the location of the peak and a window of
the     bp surrounding the peak  with the chromosome number and position  we can access
the dna sequence in fasta format using the hg   genome      this format accounts for

fipossible variations in the dna such as snps  given the size of the reference genome  this must
be done efficiently  initially  we attempted loading the genome into memory  because the
genome is so large     x    base pairs  we found that our development machines couldn t
handle this  this led us to use random disk accesses to extract the sequences  this proves very
expensive  but only needs to happen once for each unique peak location 
motif finding
first  we extract the dna sequence corresponding to high ctcf binding levels using the
reference genome and chip seq peak coordinates  initially  we used all     encode motifs  and
their associated pssms  position specific scoring matrices  to find motif matches on the dna
sequence for each peak  these matches are only dependent on the dna sequence  the pssms
relate a notion of how likely a sequence is compatible with a molecule that binds to dna  we
used the log of this likelihood as a feature  on advice from our advisor  we used only the    
features that have been experimentally determined to affect tf binding  the remaining    
have been statistically determined    this is also expensive  for each peak and motif  we need to
calculate the pssm score for all subsequences ie s      s        
dnase and histone modifications
since dnase activity indicates if the chromatin is open  ie  transcription factors can bound in
that region   high cumulative dnase levels should correlate with tf binding  in addition  the
acetylation and methylation state of various histones are also an indicator of the shape of the
dna chromatin complex and if transcription factor binding is promoted or repressed  we used
histones h k    h k   h k  and h k   in various states as features because there are prior
studies indicating related activity and also because it is available      dnase and histone data is
also available in the form of subsamples over   bp regions in the     bp region around peak
ctcf tf binding  from this  we extract the maximum and median signal of each as features 
machine learning
using      positive sets of high chip seq scoring peaks and      negative sets of low chip seq
scoring peaks of the gm      lymphoblastoid cell line from a donor  we trained both a linear
svm and a logistic binary classifier  the feature vector we used includes the maximum log
probability for a set of motifs matching a given subsequence in the peak  the maximum and the
median of the dnase signal and chromatin protein signal  the linear svm was implemented
with the liblinear svm software and logistic regression was implemented using the matlab
native command glmval and glmfit 
we tested our model on     negative and     positive data points from the k    cell line  from
a leukemia patient 

firesults
we found that our models performed relatively well  we first included only the motif likelihood
and dnase signals as features  with linear svm  we obtained     test set accuracy  with the
logistic regression model the test set accuracy was increased to      this provides evidence
that the model fits the data relatively well  the highest weighted features were the max and
median dnase score  this indicates that openness of the chromosome is one of the most
important factors determining whether a transcription factor may bind 
we then implemented the same machine learning methods with the additional data from the
various histone states that are known to be associated with transcription  with the inclusion of
the new features  the training set accuracy did not differ much from the previous learned
models  however the test set accuracy was dramatically improved with the linear svm model
producing a test set accuracy of     and the logistic regression model with a test set accuracy
of      it could be that the model learned worked particularly well with the k    cell line we
used as the test data 
in general the logistic regression model seems to be a better fit for predicting transcription
factor binding  this is most likely due to the features contributing non linearly to the binary
classifier  we also implemented a radial basis kernel svm method  however the accuracy was
poor  only     even after cross validation to find the best parameters  thus this model was
excluded for our final evaluation 
we found that the motif scores with the greatest influence were ets known  and sp   the
presence of ets known  indicates that ctcf binding is unlikely whereas sp  indicates that ctcf
binding is likely 

fi  accuracy

training data test data

linear svm

   

   

logistic regression    

   

precision recall f  score
linear svm

     

   

    

logistic regression      

   

    

including data from other histone factors 
  accuracy

training data test data

linear svm

   

   

logistic regression    

   

precision recall f  score
linear svm

     

logistic regression      

conclusion

   

    

         

chromatin immunoprecipitation with massively parallel sequencing  chip seq  is the standard
assay for genome wide detection of tf binding locations for a specific tf  however the
limitations are that chip seq can only detect one tf a time over one cell type when the reality is
that hundreds of tfs are binding and regulating dna transcription  in addition to using chip seq
data  we incorporated other biologically relevant data such as dnase   sensitivity and histone
modification  which indicates the availability of chromatin structures for transcription  using
linear svm and logistic regression machine learning methods  we can predict tf binding in a
different cell type with good accuracy  in particular  logistic regression was a good model for
this biological application 

fifuture research

in addition to the set of features outlined above  it may be worthwhile to consider more rich
features  for example  we could include the relative position of motifs with respect to the peak 
additionally  it would be worthwhile to consider different models for this problem 
furthermore we can check for the biological significance of our prediction algorithm  by
comparing if the predicted positive and negative tf binding regions existed in the training cell
data  and the relation between transcription of benign and cancerous cells 

acknowledgments

our advisor  sofia kyriazopoulou panagiotopoulou suggested the project  she was an immense
help throughout the process  she provided general guidance throughout the process  supplied
the datasets that were used in this project  and provided many references for background
knowledge 
works cited
  

  

  
  

  
  

  

   cheng c  alexander r  min r  et al       understanding transcriptional regulation
by integrative analysis of transcription factor binding data  genome research
            
natarajan a  yardimci gg  sheffield nc  crawford ge  ohler u       predicting celltypespecific gene expression from regions of open chromatin  genome research
            
thurman re  et al       the accessible chromatin landscape of the human genome 
nature           
pique regi r  degner jf et al       accurate inference of transcription factor binding
from dna sequence and chromatin accessibility data  genome research           
    
single letter codes for nucleotides 
http   www ncbi nlm nih gov staff tao tools tool lettercode html
chih chung chang and chih jen lin  libsvm   a library for support vector machines 
acm transactions on intelligent systems and technology                      
software available at http   www csie ntu edu tw  cjlin libsvm
histone code  http   en wikipedia org wiki histone code

fi