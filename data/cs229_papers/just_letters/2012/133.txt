alvaro aguilar
sebastian echegaray

observing dark worlds
project overview
in this project  we analyze images showing galaxies in space to predict the location of dark matter
halos  dmh   which by definition cannot be observed directly 
galaxies are elliptical in nature  but we assume this property to be inherently random across all
space  such that the total ellipticity with respect to a given point averages out to zero  a dmh between
us and the observed galaxies will bend space time  forcing the galaxies to appear to have a different
ellipticity than they actually do  this phenomenon is known as gravitational lensing  and was first
introduced in the     s 
the stated problem is part of a competition between     teams organized by winton capital and
kaggle     

data
our training and testing data consists of     simulated skies of     x     pixels  each simulated sky
contains anywhere from     to     galaxies  each galaxy is represented by an  x y  coordinate    to
     pixels  and a measure of ellipticity  which tells us the shape and angle of the galaxy with respect to
a given point in the sky  each image can contain from   to   dmh  additionally  the dmh are
represented as a point source by their  x y  coordinates  giving the ground truth for each simulated sky
image  the data is provided by winton capital  in figure   we can observe three generated images
showing the position of the dmhs as a red circle and each galaxy as a white ellipse  the ellipses maintain
the original ellipticity of the simulated galaxies  after being affected by the dmh  

figure    rendered images from our training dataset  dmh are shown as red circles with arbitrary radius and galaxies as
white ellipses

a limiting factor is that the above data is simulated by the contest organizers  therefore subject to
random noise  which is added to the underlying physics euqations describing the gravitational lensing

fialvaro aguilar
sebastian echegaray
effect  a key assumption for the two and three halo skies is that the effect of each dmh can be added
linearly to obtain the final effect on total ellipticity 
since each image consist of      x      pixels  our approach was to divide each image into bins of
    x      with each bin consisting of    pixels  this division was necessary due to the computing
complexity of evaluating each pixel in a     x     grid  by lowering the number of possible locations
we make the problem easier to tract in memory an in processing power 

feature extraction
we initially focused on extracting two features  signal map and maximum likelihood  for each of
the bins described above which helped us find the centers of the dmh  these features were inspired by
the tutorial in     
our first feature  called signal map  calculates the interaction tangential ellipticity from all the
galaxies in the sky to a given point in the image  to do this  the algorithm assumes there is a dmh on a
particular bin  and calculates the angle of each galaxy in the sky with respect to that bin  using the
angular information  it then adds the tangential ellipticity from every galaxy in the sky with respect to
that bin  the algorithm assigns the bin a score proportional to the amount of ellipticity it can account 
the process is repeated until all bins have been assigned a score  as was stated in the introduction  in
the absence of dmhs  we would expect the average tangential ellipticity of any given point in the sky to
be zero  using this information  we know that the bin which records the highest tangential ellipticity is
the bin where the halo is most likely to be  a heat map used for visualization of this data is shown in
figure   

figure    signal map showing most probably location of a dmh  note for this rendering  the sky was divided into    x   
bins  rather than    x    

our second feature  called maximum likelihood  assumes that the distortion caused by the dmh has
an effect that acts only on galaxies that are close to it  this is commonly described as a having a
drop off  where is the radial distance between the center of the proposed dmh and a given galaxy 
and is a factor which allows control of the expected drop off  the algorithm for calculating this feature
is as follows  assume there is a dmh in a particular bin  calculate what the total ellipticity of the sky
would look like given a
model  and finally try to fit the predicted ellipticity of the sky to the actual
ellipticity using a chi squared distribution  sweeping the exponent on the term allows us to vary how

fialvaro aguilar
sebastian echegaray
local the gravitational lensing caused by the dmh is  the chi square distribution is used because the
random variable for total ellipticity is described by the sum of squares of two independent random
variables     
 
   
    a heat map for the same simulated sky as
 
 
figure    but created using the maximum likelihood approach is shown in figure   below 

figure    heat map generated using the maximum likelihood approach with a

dropoff factor  with

inspired by the better performance of this
model  we modified our initial signal map algorithm
to include this factor in its calculations and therefore generate a third set of features  the idea is that
the total ellipticity calculated can be multiplied by a
factor in order to assign different weights to
ellipticities of galaxies according to distance  by analyzing how well our algorithm predicted the location
of dmhs in our training dataset we empirically found that
provides the best compromise
between local and global information  however  we also included heat maps using this technique for
 
and
in our feature set 
as a fourth approach  which we have called directional bias  we take advantage on the fact that
ellipticities of all galaxies should sum to zero if there is no distortion  for this feature we create a multiscale grid and calculate the ellipticity bias  i e  the average ellipticity  in each of the cells  our hypothesis
is that for each galaxy          where    is the ellipticity that we can read
from the dataset     is the original galaxy ellipticity  and   is the distortion caused by the
warping effect of the dmh  then 


 







 


by taking the mean of a group of galaxies close to each other  we can approximate the ellipticity
caused by the distortion of that cluster  using this feature  we can try to find patterns which show the
location of the dmh across different skies  the idea is drawn in figure    where we can observe how the
biases  shown as blue lines  organize themselves tangentially to the dmh  shown as a red circle  

fialvaro aguilar
sebastian echegaray

figure    calculated biased directional ellipticity in a grid  the ellipticities  shown in blue  aligned tangentially to the dmh
center  shown in red 

feature fitting
using the first three features  signal map  maximum likelihood  and local signal map   we created
features for each bin in the     training skies  recall each sky has    x    bins  each measuring   x  
pixels   these features were evaluated by themselves and in group in their ability to find the dmh
centers  to combine the features we used an ensemble of trees classifier  the treebagger algorithm
provided by mathworks       the results are shown in table   
distance from closest halo
feature used
average  bins  median  bins  standard dev  bins 
global signal map
    
    
     
max likelihood  a     
    
    
     
local signal map  a     
    
    
     
local signal map  a     
    
    
     
local signal map  a     
    
    
     
table    results after using an ensemble of trees classifier for     simulated skies

for testing  we used five fold cross validation by sky  that is  we separated the skies randomly into
five groups of    skies each  these groups were in turn composed by    skies with one halo     skies
with two halos and    skies with three halos  then we trained the classifier in four of the five groups and
used this to test the fifth group  we repeated this procedure for each of the five groups  this allowed us
to maximize the amount of data that we could extract from our training set as we tested against the
samples that were not trained  and that we had ground truth  

conclusions
the project was a very educational experience in two separate fronts  first came the understanding
of the underlying physics explaining the gravitational lensing effect  using this as our basis  we were
then able to extract useful features for our classifier  finally  we ended up with a classifier that over fit
our particular training set and didnt perform as well when presented with new data  as of right now we
are creating new ground truth by convolving a gaussian with the original position of the dmh  this will
give us a probability map of each location  we will try to use regression to improve our results and
submit to the competition  which finalizes on sunday december          

future improvements
there is room for improvement in our initial feature extracting algorithms when it comes to dealing with
multiple dmh in a given sky  given dmh effects add linearly for each halo present in the sky  two
approaches for dealing with multiple halos can be implemented

fialvaro aguilar
sebastian echegaray
separately detect multiple halos and add their effects
the proposed feature extraction algorithms all perform reasonably well when extracting the location of
one dmh  even when there are multiple dmhs in an image  under two  or three dmh skyes  the
algorithms could be modified to compute the effect that the first dmh had on the total ellipticity in the
sky  and attempt to subtract it in order to find the effect that the second halo will have  this could get
overly complicated for skies containing three dmhs  presumably  on the two dmh sky  knowing the
location and the exact effect of the second halo will somehow affect our initial choice for the first halo 
this means that after finding the second halo  we should go back and modify the location and effect of
the first halo  and then try to find the second one again  it is easy to see that having three halos would
become computationally expensive 
simultaneously detect multiple halos
given knowledge of the number of halos in each sky  the maximum likelihood algorithm could
potentially sweep the sky and calculate the effect two or three halos at different positions would have
on the ellipticity  since the maximum likelihood algorithm allows us to fit the predicted ellipticity to the
overall ellipticity given by the sky  modification to include multiple halos comes naturally  by trying to fit
the predicted ellipticity to the known ellipticity for all dmh at once  the problem of assigning different
weights to the effect each halo contributes to the overall ellipticity can be avoided  a possible algorithm
would proceed as follows  assign dmhs to three separate bins  predict the ellipticity cause by these
halos assuming a
model  and fit the predicted ellipticity to the actual ellipticity using a chi square
distribution  now using the sum of squares of six independent variables  namely
and contributed
by each of the three dmhs   the algorithm would then change the location of one dmh at a time until
all halos have been assigned to each bin in the image  finally  the combination that produces the highest
likelihood gives the correct location for each of the three dmhs 

references
    kaggle   observing dark worlds   kaggle   online   available  http   www kaggle com c darkworlds 
 accessed             
    d  harvey  obersving dark worlds  a beginners guide to dark matter   how to find it  kaggle    
          online   available  http   blog kaggle com            observing dark worlds a beginnersguide to dark matter how to find it 
    kaggle  observing dark worlds  evaluation criteria              online   available 
https   www kaggle com c darkworlds details evaluation
    mathworks              online   available  http   www mathworks com help stats treebagger html

fi