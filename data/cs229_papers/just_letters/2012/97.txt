developing fingerprints to computationally define functional
brain networks and noise
sochat  v 
 

program in biomedical informatics  stanford university

abstract
objective  independent component analysis can be used with functional mri  fmri  data to extract independent components that encompass a mix of true functional  resting state brain networks and
noise  this method is growing in popularity in the field of neuroscience as a data driven way to distinguish artifact or identify different
networks to diagnose neuropsychiatric disorder  however most of
this work is not automatized and is reliant on group derived templates and matching metrics that do not scale to large data  this
paper aimed to develop robust spatial and temporal features to automatically characterize functional brain imaging data  and to start
preliminary work exploring group differences in more detailed subnetworks extracted from the same data 
methods  an extensive set of     spatial and temporal features has
been developed to be used to predict   sets of labels indicating
different types of noise and networks represented in a large set of
independent components derived from fmri data  the method employs an unsupervised learning algorithm to define functional networks at two levels  and a supervised learning algorithm to discovers characteristic features of these networks  ten fold cross validation and permutation testing is used to evaluate the models 
results  using fmri datasets from persons with schizophrenia and
matched healthy controls  this method successfully distinguishes
different types of noisy components for   out of   of the manually
curated standards  specifically  the model for the standard that encompasses all noise types performs with a cross validation accuracy
of       and area under the curve of       
conclusion  this work demonstrates that noisy components can be
computationally defined using spatial and temporal features  and 
that automated methods can use these features to filter large data 
extension of this method to derive disorder specific fingerprints of
functional networks will allow for the development of automated
decision support systems using large  publicly available data 

 

introduction

understanding and subtyping of neuropsychiatric illness remains an
unsolved challenge because of the heterogeneity of these diseases 
and the complexity of the human brain  the world health
organization estimates        of the total years lost to illness 
disability  and premature death in the united states are due to these
disorders  and that they cost americans a total of       billions of

december      

dollars annually      neuropsychiatric disorder  in its simplest form 
can be understood as aberrant brain activity that leads to noticeably
different behavior and cognition that negatively impacts daily life 
regardless of the etiology of the disorder  in order to infer diagnosis
and provide treatment  a comprehensive understanding of what
distinguishes aberrant from normal is necessary  how might this
difference be measured 
    measuring neuropsychiatric disorder
asking people about their thoughts and behavior directly  selfreport   measuring behavior with tasks  or observational methods
based on checklists  the diagnostic and statistical manual of mental
disorder  th ed   might give insight to a correct diagnosis  however
ideally this information should come directly from the source  the
human brain      aberrant function of the human brain  when
understood on a computational level  will be the most robust and
consistent methodology  what might this brain data look like 
the best data would be a recording of the firing  action potential  of
every single of the brains approximately     billion neurons  but
current research is limited to single neurons  single cell recording  or
small groups  multi cell recording        this task is infeasible on a
large scale for the obvious reason that is invasive  the next best
option is non invasive brain imaging  such as functional magnetic
resonance imaging  fmri   fmri allows for the measurement of
brain activity on the level of the voxel  typically a     mm cube with
an associated value that reflects a blood oxygen level dependent
 bold  response of   k    k neurons that has been shown to be a
strong measure of neural activity       fmri is not detailed or perfect 
but it represents an abstraction of neural activity for small regions of
the brain  and is a good way for identifying large scale patterns of
brain function 
    standards for functional networks and noise
identifying these patterns of functional networks from resting bold
data requires some standard for what constitutes a functional brain
network  and there currently exists no such standard beyond manual
annotation of network by an expert       spatial templates and
matching procedures are commonly used to identify networks of
interest from single subject data  however missing is work to define
temporal and spatial features to automatically complete this task 
arguably  this gap in methodology is due to the tendency of the
neuroscience community to set extremely stringent criteria on
analysis parameters  in this environment  efforts to establish a
standard are likely not successful due to lack of agreement about an
accepted acquisition protocol  processing pipeline  and the right
data to use  while the data is noisy and has high variance  patterns
in these independent signals do exist  and an effort to break down

 

fiv sochat

these established barriers and approach brain science more
abstractly with large data is badly needed  lack of a perfect gold
standard for functional networks that might be used for a classifier
should not hold back an understanding of aberrant function of the
human brain  manual annotation of networks and noise belonging to
a dataset is far from a gold standard  but it is completely feasible to
distinguish components  and will allow for the beginnings of a
computational understanding of brain signals  given the current
neuroinformatics landscape  the time for this type of work is now 

represents a pattern of signal that the particular voxels contribute
over the entire functional scan       the decomposition is illustrated
in figure    abstractly  ica expresses a mixed brain signal as a
linear combination of statistically independent component variables 
a fundamental assumption of this method is the independence of
different brain signals  and that each component has a distinct
spatial map that shares brain anatomy 

    the neuroinformatics landscape
large  publicly available databases of resting bold fmri data of
neuropsychiatric populations  indi  ndar  abide  nitrc  can be
utilized with established standards and methods from machine
learning to discover patterns of brain function that serve as biomarkers of disorder  the infrastructure needed to achieve this goal
are    an automatic method to extract functional networks and other
signals  components of the data     standards to classify noise in
the data to leave only components that represent neurological signal  and    unsupervised approaches to infer diagnosis  this paper
addresses the first two points to provide rationale for using computational fingerprints to distinguish noise from real neurological signal 
finally  the third point is briefly explored  specifically  functional
brain primary and sub networks can be extracted with an automatic
approach  independent component analysis  ica   and different
types of noise can be defined by patterns of spatial and temporal
features  these models can then be used as filters  leaving functional networks to be used to diagnose neuropsychiatric disorder 

 

methods

    data
resting bold fmri was acquired for    individuals     
schizophrenia     healthy control  with mean age    years    
male    female  from the mind institute  new mexico  
schizophrenia was chosen as a disorder as significant functional
brain differences have been shown to exist      
data were motion corrected  spatially smoothed with a  mm full
width at half maximum gaussian kernel  bandpass filtered       to
   hz  and spatially normalized into the standard montreal
neurological atlas space in preparation for probabilistic independent
component analysis  performed with melodic  multivariate
exploratory linear decomposition into independent components 
version       part of fsl  fmrib s software library       
    independent component analysis
ica is appropriate for task free resting bold fmri data because it
does not require specification of a design matrix  as is required by
the commonly used general linear model  glm   when applied to
four dimensional fmri data  the data is reshaped into an n x m
matrix with n time points and m voxels flattened into a row from a
single  d image  the data is decomposed into two new matrices 
the first including temporal information  time course components  in
columns  and the second including associated  statistically
independent and sparse spatial components  whole brain maps  in
rows  each row of this second matrix can be reassembled into a  d
image to visualize the map  each time course in the first matrix

 

figure    an ica decomposition of  d fmri data produces a timecourse and spatial maps 

two levels of ica were performed  first using the fastica algorithm
    
to estimate a correct number of dimensions using the laplace
approximation to the bayesian evidence of the model order          and
second using the highest dimensionality possible given the data size
     components   fastica is aimed at achieving maximum degree
of non gaussianity for all estimated source signals  there are many
modifications of these algorithms          however fastica is a solid 
practical approach that is commonly used and a good choice for this
analysis  the resulting data set encompasses two sets of
independent components derived on two levels from the equivalent
   datasets  components encompass real neurological signal 
physiological signal  scanner noise  and artifact 
level   of independent component analysis  the lower level
decomposition that reveals main brain networks reflects a standard
practice in the field  and is important for creating labels  resulting
components are interpretable by a human  and thus can be ascribed
with meaningful labels to allow for the creation of a classifier  this
decomposition includes      components  ranging from       per
individual  with an average of approximately    per individual  
level   of independent component analysis  for the higher level
decomposition  representing more detailed signals  sub networks  
encompasses      components  expert annotation is infeasible if
not impossible  therefore  it makes sense to build a model of noise
using the level   of ica  remove the noise from level   with this
model  and then use unsupervised clustering to look for patterns in
the filtered level   data 
for both levels  each component is z transformed to allow for
comparison by subtracting the mean and dividing by the standard
distribution  resulting in voxel values that are z scores  each zscore map is then thresholded to include the     of values in the tails
of the distribution  this means that  for any two particular
individuals networks  we are not comparing the values themselves 
but rather  comparable degrees of activation from the individualspecific means  this is not problematic because spatial features
account for the presence of any significant activation as opposed to
the z score itself  and temporal features are concerned with the
normalized distribution of values as well  and this practice is
consistently done in the current literature 

fideveloping fingerprints to computationally define functional brain networks and noise

    standards for functional networks and noise

neurological signal  

the development of a simple matlab tool allows for the annotation of
components derived from ica  the tool  figure    displays the
spatial map  associated time course and its distribution for a set of
selected components  and outputs a set of labels that works
seamlessly with the next stage of analysis  the derivation of a
component fingerprint  section       using this tool  the entire set
of      components for   component types    representing specific
noise  head motion  white matter artifact and ventricles  eyeballs    
representing all noise types  and   representing real functional
networks  parieto occipital cortex  primary visual cortex  ventral
primary sensorimotor cortex   is manually annotated 

    unsupervised methods to explore subnetworks
each noise fingerprint will have its own model  or a set of weights
applied to a particular set of features to output a class label  the
model created for the labels that include all noise types is used to
filter level   sub network data  and this filtered data can be explored
with unsupervised methods  it should be noted that the sheer
number of these components and their blob like nature makes
evaluation of the filtered result infeasible  and so exploration of the
clustering of disorder type is done knowing this limitation 

figure    tool to annotate ica components

    spatial and temporal features
a total of     spatial and temporal features  available at 
http   www vbmis com bmi class cs    features nica features xlsx 
and automatic extraction methods developed based on current
literature and intuition were extracted from all components for both
levels of decomposition             
    supervised methods to define fmri components
a supervised method  least squares linear regression with the least
absolute shrinkage and selection operator  lasso        is utilized
to perform both feature selection and classification of the
components extracted with ica using the manually curated labels
that define a particular noise type  this modification of least squares
regression places a penalty on having more non zero coefficients 
and so it is good for finding sparse solutions  the optimal parameter
alpha that controls sparsity is chosen with a grid search  and the
optimal lambda is equivalently determined by choosing the value
that maximizes the cross validation accuracy  this approach was
chosen to identify features of different noise types with the
hypothesis that each type can be defined by a small subset of the
total features  the chosen features from this step for each
component type defined in the main network standard compose a
functional network fingerprint  a binary classifier was chosen
because  while it might not be possible to ascribe a meaningful label
to every single component  it is entirely feasible to pick out a single
noise type or functional network 
    evaluation of selected features
a ten fold cross validated receiver operator characteristic  roc 
curve is built into the classification step to evaluate specificity and
sensitivity  and a       iteration permutation test that attempts the
equivalent model construction with a random permutation of the
labels is used to assess the significance of the cross validated
accuracy  it should be noted that this approach is only used to
evaluate the labels that comprise all noise types for which there is
an equal proportion between the two classes  noise and real

from this filtered subset of sub networks the goal would be to use
unsupervised clustering to diagnose neuropsychiatric disorder 
intuitively  sub networks that cluster together are not necessarily
good for distinguishing schizophrenia from healthy control  and so
the next goal is to find clusters of sub networks that are most pure
with regard to disorder type  k means clustering using euclidian
distance is utilized to select clusters with     or greater
membership of either schizophrenia patients or healthy control  kmeans was performed across    values of k  ranging from    to    
with intervals of     this threshold and the values of k were chosen
arbitrarily  this results in a filtered subset that includes subnetworks that belong to clusters with the strongest class labels  as
determined by k means 
k nearest neighbor  knn  unsupervised clustering is then
employed for each sub network to ascribe it with a likely diagnosis
based on the diagnoses of the nearest neighbors  the percentage of
k nearest neighbors that have the diagnosis   due to the previous
step of selecting sub networks with strong class membership  it was
decided to set k   to reflect the two classes  for k means  since
the correct value of k is unknown  it was decided to try a method
that mimics an ensemble approach  and combine score vectors for
the same individual across values of k  this is done with the idea
that if a sub network is particularly good for distinguishing
schizophrenia from healthy control  it might appear as a pure
cluster across multiple values of k  and using its multiple repetitions
is akin to weighting it more highly in the final diagnosis 
this final diagnosis score  a value between   and   that represents
the probability of having schizophrenia  is computed for each
schizophrenia patient or healthy control based on the average of
these scores  with a value of   representing a healthy control  and a
value of   representing a pure schizophrenia patient  the threshold
to distinguish the two classes was decided as the mean of the
distribution of total scores 

 

results

    noise and functional fingerprints
subsets of spatial and temporal features were identified to
distinguish comprehensive noise  eyeballs  head motion  white
matter artifact and ventricles  parieto occipital cortex  primary visual
cortex  and ventral primary sensorimotor cortex  with best cross
validation accuracies for the first five of                            
and        respectively  the area under the curve for the set of
labels used to filter sub networks was        complete results 
including component fingerprints  selected features  and

 

fiv sochat

fingerprints for the successful models are displayed in figure   

functional network type that  also surprisingly  did not look broken
apart at all  this would suggest that the linear relationship between
the voxels in this component is so strong that even forcing the
derivation of more components does not split the group into two 
biologically  this reflects an insular  strongly connected functional
network  or an anti hub  this is an interesting finding that deserves
further investigatation  because it might be the case that the degree
to which a network can be broken apart is a salient feature to
distinguish disorder from healthy control 

   discussion

percent total activation in csf
percent total activation mni    edges
kurtosis measure outlier prone ts
caudate r
percent total activation skull
caudate l
percent activation in eyeballs
paracentral lobule l
spatial entropy of ic distribution
percent total activation spinal cord

percent activation in eyeballs
spatial entropy of ic distribution
avg distance btw    local max
skewness of ic distribution
  activation voxels lr symmetric
rectus l
olfactory r
percent total activation in wm
perfect total activation in gm

percent total activation skull
  activation voxels lr symmetric
power band     to       hz
  total activation mni    all edges
avg distance btw    local max
hpsd bin   freq  to pi         
percent total activation in csf
four lag auto correlation
hpsd bin   freq  to pi         
three lag auto correlation

percent total activation ventricles
percent total activation in wm
caudate r
cingulum post r
caudate l
thalamus l  thalamus r
max cluster size    local max
region
growing thresh          overlap
power band      to     hz
cingulum post l

occipital sup r
occipital mid r
parietal sup l
percentage activation voxels lr
symmetric
occipital mid l
occipital sup l
parietal inf l
parietal sup r
occipital inf l
parietal inf r

figure    component types  spatial maps  network counts  cross validation accuracy 
roc curve  fingerprints  and top     or fewer  selected features for level   ica
components  these models demonstrate the computation signature of fmri components 

    supervised methods to define fmri components
filtering the original      components derived with higher
dimensionality ica  the sub network level  with the comprehensive
noise classifier resulted in a subset of      components
representing real neurological signal  cluster goodness to
potentially choose a particular value of k was evaluated based on
mean centroid distance  and lack of a clear best choice further
supported the decision to combine across values of k  the final
calculation of accuracy for this exploratory method with k   was
        adjusting the threshold of decision to slightly greater than
the mean  accuracy improved up to        
evaluation of pure clusters reveals novel noise type  across
   values of k there were       pure clusters comprised of at least
    of one class  a random sample of    of these pure clusters
was visually evaluated  and surprisingly  a novel type of noise
emerged in many of the samples  figure     further exploration of
entire sets of clusters for a particular value of k made it apparent
that this noise appeared consistently across values of k and cluster
membership was predominantly schizophrenia patients 

figure    novel type of
noise revealed by k means
clustering of filtered subnetworks

 

evaluation of pure clusters reveals
anti hubs  a quick glance at a set of subnetworks derived with the higher level
decomposition and reading current literature
   
leads one to believe that the
majority of components representing real
neurological signal are pieces of broken
apart whole functional networks that might
be seen at a lower level decomposition  the
visual evaluation revealed clusters of one

it has been demonstrated that independent component analysis can
be used to extract a mix of functional brain networks and noise  and
that spatial and temporal features can automatically distinguish
network types to allow for automated filtering of fmri data  further 
this paper provides rationale that interesting  disorder specific
patterns exist on the level of sub networks  and more work is
needed to characterize these differences  additionally  it was not
checked  beyond counting the number of components of each type 
that each individual contributed exactly one network  the counts
 n in figure    suggest that this might be the case  but what is
needed is a counting of how many times we see a particular
network  these frequency counts would allow for more probabilistic
approaches applied to classifying the data 
this ability to automatically ascribe labels to functional networks and
noise breaks down the barrier to pursuing data drive methods for the
diagnosis of neuropsychiatric disorder  this type of work is starting
to be done with moderate success with structural data for which the
standard is simply a standard brain anatomical template      
    selected features as validation
the selected spatial and temporal features serve as unofficial
validation of the component  for example  it is expected to see
percent activation in eyeballs as the mostly highly weighted feature
for the eyeballs component  percent total activation in ventricles as
the top feature for the ventricles component  and percent activation
skull for the head motion component  from a biological standpoint 
these selected features make sense  an interesting observation that
has been shown in the literature is the fact that noisy components
tend to be defined more so by time course features  while functional
networks show selection of predominantly spatial features 
additionally  successful models were built for all   noise types  while
only one of the three functional networks resulted in a successful
model  it could be the case that this observation is just chance
based on the standards that were created  or it could be the case
that the features are not good enough to distinguish the networks  it
is salient that the features were developed with the intent of
classifying artifact and noise  and so further work is needed to both
create more functional standards for testing and developing features
that might better classify the networks once noise is removed 
    next steps for subnetwork exploration
the unsupervised methods applied to the filtered sub network data
provide impetus for further work in this problem space  the
clustering and scoring methods utilized were by no means
complicated  and so an accuracy of        is surprisingly high given
this simplicity 

fideveloping fingerprints to computationally define functional brain networks and noise

the discovery of a visually identifiable novel type of noise on the
level of the sub networks that was not seen on the level of the main
networks speaks to the fact that the higher dimensionality ica
extracts more detailed independent signals that would be mixed
with a stronger trend in the data at a lower level decomposition 
this finding also provide rational that higher dimensionality ica is
more promising to find subtle group differences  the challenge
remains  however  that manual annotation of these networks is
infeasible  although the task is daunting  developing features
characteristic of sub networks would assist in better clustering the
networks to identify group differences 
unsupervised methods need more data  it was decided to derive
diagnosis scores by combining across values of k in order to make
up for not having enough data at any one value of k  thus  it is clear
that more data is needed 
    limitations of standards
with the constraints that are currently set in the neuroscience
community for what encompasses a gold standard   i e  a labeling
done by many experts   it would be incredibly challenging and time
consuming to entice even one expert to label a set of      networks
multiple times  this work was done under the guise that a careful
annotation of one experienced individual would be superior to some
effort using amazon mechanical turk  or attempting to convince a
set of experts to look at small subsets of the data  the standards
used for this work in no way represent robust  widely accepted
standards  however the point is to show that groups of components
intelligently identified by a human being to belong to a particular
group in fact can be computationally defined  to pursue this type of
work the rules must be changed to allow for imperfection  the
neuroscience community must acknowledge that when working with
large data  the standard might not be perfect  but the large data will
still allow for discovery 

   conclusion
the definition of standards and features that define different types of
noise and functional networks is a move toward the goal of
understanding the function of the human brain  and how this function
can be aberrant across disorders  on a simple level  machine
learning allows us to use our human expertise to teach a computer
what encompasses a brain network  we can provide labels for the
components that we do understand  and the resulting models can
provide further insight to the components that we do not understand 
as we develop functional biomarkers of disorder  we can further
integrate genetic data  currently being developed by the allen brain
atlas   structural data  and go as far as making connections between
patterns of brain function and emerging trends such as the microbiome to answer the question of how our brain function relates to
who we are  on a speculative and exciting level  logical takeaways
from this work include the following 
  
  
  

need for the development of sub network specific
features
determine frequency of each network type for different
disorders  priors  to allow for probabilistic modeling
understanding of which functional networks do not break
apart between different levels of decomposition  and

  

perhaps how the degree to which they break apart might
differ between disorders 
guided ica  a with reference approach  to bias the
decomposition to add an additional constraint that
incorporates prior information when updating the weights
    
 

this is a prime time to be in neuroscience  we are not so far away
from finding a meaningful difference in structure or function of the
human brain for a particular disorder  and then querying the
individuals genome for genes expressed in that region  and then go
into the blueprint of the entire machine and making a system wide
fix to actually  cure  or help some of these disorders 
references
    a  hyvrinen  r  cristescu  and e  oja  a fast algorithm for estimating overcomplete ica
bases for image windows  proc  int  joint conf  on neural networks  washington  d c  
     
    american psychiatric association          diagnostic and statistical manual of mental
disorders   th ed   text rev    washington  dc 
    assessing the economic cost of serious mental illness  american journal of psychiatry 
     june                 
    bansal  r   staib  l  h   laine  a  f   hao  x   xu  d   liu  j   weissman  m   et al 
        anatomical brain images alone can accurately diagnose chronic neuropsychiatric
illnesses  plos one         e       doi         journal pone        
    beckmann  c  f          modelling with independent components  neuroimage        
        doi         j neuroimage            
    c f  beckmann and s m  smith  probabilistic independent component analysis for
functional magnetic resonance imaging  ieee transactions on medical imaging
                   
    ciuciu  p   varoquaux  g   abry  p   sadaghiani  s     kleinschmidt  a          scalefree and multifractal time dynamics of fmri signals during rest and task  frontiers in
physiology    june        doi         fphys           
    de martino  f   gentile  f   esposito  f   balsi  m   di salle  f   goebel  r     formisano 
e          classification of fmri independent components using ic fingerprints and support
vector machine classifiers  neuroimage               
doi         j neuroimage            
    gian  r          a novel k means based multivariate clustering of ic fingerprints 
frontiers in neuroscience                     doi         conf fnins              
     grosenick  l   klingenberg  b   knutson  b     taylor  j  e          a family of
interpretable multivariate models for regression and classification of whole brain fmri data 
most                  
     hyvrinen  a   oja  e         a fast fixed point algorithm for independent component
analysis  neural comput                  
     hyvrinen  a   karhunen  j   oja  e         independent component analysis
     jones  d  t   vemuri  p   murphy  m  c   gunter  j  l   senjem  m  l   machulda  m  m  
przybelski  s  a  et al          non stationarity in the resting brains modular
architecture  plos one        e       doi         journal pone        
     nandi  a         blind estimation using higher order statistics 
     liu  j   ghassemi  m  m   michael  a  m   boutte  d   wells  w   perrone bizzozero  n  
macciardi  f   et al          an ica with reference approach in identification of genetic
variation and associated brain networks  frontiers in human neuroscience    february      
     neuroscience  h   calhoun  v  d   eichele  t     pearlson  g          functional brain
networks in schizophrenia   a review    august       
     roberts  s   everson  r         independent component analysis  principles and
practice  cambridge university press 
     song  aw  diffusion modulation of the fmri signal  early investigations on the origin of
the bold signal  neuroimage                 
     s m  smith  m  jenkinson  m w  woolrich  c f  beckmann  t e j  behrens  h 
johansen berg  p r  bannister  m  de luca  i  drobnjak  d e  flitney  r  niazy  j 
saunders  j  vickers  y  zhang  n  de stefano  j m  brady  and p m  matthews  advances
in functional and structural mr image analysis and implementation as fsl  neuroimage 
   s               
     thomas  c  g   harshman  r  a     menon  r  s          noise reduction in boldbased fmri using component analysis  neuroimage                  
     tibshirani  r          regression shrinkage and selection via the lasso  journal of
the royal statistical society                
     t  minka  automatic choice of dimensionality for pca  technical report      mit
media lab vision and modeling group       
     wang  z  kelly  r  e   alexopoulos  g  s   gunning  f  m   murphy  c  f   morimoto  s 
s   kanellopoulos  d   et al          visual inspection of independent components  defining
a procedure for artifact removal from fmri data  journal of neuroscience methods         
       doi         j jneumeth            
     world book       chicago  world book inc             
     kelly  r  e   alexopoulos  g  s   wang  z   gunning  f  m   murphy  c  f   morimoto  s 
s   kanellopoulos  d   et al          visual inspection of independent components  defining
a procedure for artifact removal from fmri data  journal of neuroscience methods         
       doi         j jneumeth            

 

fi