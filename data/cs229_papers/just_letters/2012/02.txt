cs    final project report
predicting epitopes for mhc molecules
xueheng zhao  shanshan tuo
biomedical informatics program
stanford university
abstract
major histocompatibility complex  mhc 
plays a key role in immune response by
presenting antigenic peptides  which are
recognizable to t cells  identifying mhcbinding peptides is crucial to understand
pathogenesis and develop corresponding
vaccines  direct identification of mhc binding
peptides by biological assays is laborious and
expensive  because of the huge size       of
potential combinations  current computational
methods are also not satisfactory  many of
them failed to capture the features of nonconserved
motifs 
mhc
molecule
polymorphism  and non specific binding to
low affinity peptides  large datasets from
national institute of health  nih  public data
repository and our own research data  with
machine learning methods  provide a great
opportunity for addressing this problem  thus 
we aim to develop an efficient and accurate
method to identify and predict mhc binding
peptides and to further differentiate various
mhc subtypes by their peptide binding
specificities  by selecting       peptide motifs
as features  we built classifiers with naive
bayes and svm based approaches  these
classifiers achieved accuracy up to     on
four most frequent human mhc subtypes
hla a    hla a    hla b    and hlab  with    fold cross validation  we
applied these classifiers onto experimental
dataa pool of potential binders  it has been
found that up to     peptides are classified as
binders and the classifier can be used to
determine the specific subtypes  we also
applied another approach  iterative statistical
search in feature optimization  this iterative
approach showed very promising results in our

  

preliminary test  by applying this approach in
feature generation  we achieved about    
accuracy with less than    features  further
exploration of this approach will optimize
feature space and improve algorithm
efficiency 
introduction
the immune system acts as a physical
barrier against pathogen infections by
activating b cells and t cells  b cells and t
cells are special types of white blood cells that
can recognize nonself cells  including
pathogen infected cells  and trigger immune
response  in particular  cytotoxic t cell
receptors can bind to major histocompatibility
complex  mhc  that are antigen specific
receptors on the nonself cells and alert
immune system to kill these infected cells
 smith garvin et al          among three
classes  i  ii  and iii  of mhc family  class i is
by far the most well characterized subgroup 
which we focused on in this study  class i
mhc proteins have a special structure with
four antiparallel  strands in the center region
and two  helices on one side  the two helices form a groove that contains six aminoacid binding pockets and can only
accommodate short peptides of   to    amino
acidsshort fragments of antigens  in other
words epitopes figure    mester et al         
identifying and predicting mhc binding
epitopes are essential to understand the cause
of diseases and develop corresponding
vaccines  lundegaard et al         
due to the size of the potential binding
peptides            billion  for each mhc
molecule  liao and arthur         empirical
approach by biology experiments is laborious

fiand expensive to identify binding peptides 
multiple computational approaches including
artificial neutral network  ann  based method
were developed to predict binding peptides
 lundegaard         but many of them failed
to capture and quantify the complex mhcbinding properties due to few conserved
peptide motifs  polymorphism in mhc
molecules  and binding ability to low affinity
peptides  nielsen et al         peters et al  
       to overcome these challenges and
better predict the epitopes from binding
peptides of different mhc molecules  we
studied the characteristics of the peptides and
mhc protein sequences near the peptidebinding region  we extracted more than       
peptides that bind to four most frequent mhc
subtypeshla a    hla a    hla b   
and hla b   from immune epitope database
    and resource analysis  iedb   we then
selected and optimized features to built
classifiers  using machine learning algorithms 
we are able to predict binding peptides from a
lab generated dataset 

figure   structure and binding groove of major
histocompatibility complex  mhc  molecules
 adapted from website of institute of
structural and molecular biology at university
of london 
data collection
binding peptides were collected from
immune epitope database     and resource
analysis  iedb   and newly generated data
from our lab at systems biology department by
high resolution mass spectrometry  from iedb
database  we extracted four datasets of mhc 

  

binding peptides to four mhc subtypes
hla a   hla a   hla b    and hlab  each dataset containing about     
binding and      nonbinding peptides  for labgenerated mhc binding peptides  we purified
cell lysate proteins of b cells that associate
with mhc proteins and sequenced the short
mhc binding peptides with orbitrap mass
spectrometry  we focused on   mer peptides 
because it is the dominant form that binds to
mhc class i alleles  our lab data include    
distinct peptides  which are a pool of potential
binding peptides to all four mhc subtypes 
to generate mhc non binding peptides  we
applied markov model based on uniprot
protein database  elias         the probability
that these peptides actually bind mhc is really
low and can be ignored 
feature selection
motifsshort conserved sequence patterns
of amino acids or nucleotidesare usually
associated with key functional sites involved in
catalysis and or binding to other molecules 
considering that mhc molecules have
preference to some amino acids at certain
positions  we selected motifs as features to
build the classifier for epitope binding
prediction  we define a motif in our analysis as
a   amino acid over an alphabet of    amino
acids  acdefghijklmnpqrstvy  and  
denoting any of the    possible amino acids  a
sequence s   s s     s  is said to contain a
certain motif if it contains exactly the same
amino acid patterns 
protein sequence motifs are typically
extracted from non gapped regions  blocks  of
a multiple sequence alignment  figure     each
position in the motif represents the variability
in a column of the block  in our study  features
were selected as follows  for each position 
select amino acids that have at least    overall
occurrence in the dataset  build features
containing   or   selected amino acid  figure
    total number of features varies somewhat
between different datasets because of different
occurrence rate for individual amino acid 

fifigure    feature selection for machine learning approaches
machine learning approach
to develop the classifier for mhc binding
peptides  we used machine learning algorithms
including naive bayes and support vector
machine  svm   in both methods  we preprocessed four groups of raw data  one for
each mhc subtype  with feature mapping 
each   mer peptide was transformed and
represented by a high dimensional vector
based on features selected as described above 
the processed data were fed into weka to
build models with naive bayes and svm    fold cross validation using the binding and
nonbinding datasets was performed to
compare methods of naive bayes and svm
with different kernel functions  accuracies
and roc areas were obtained from weka
reports and plotted for visualization 
we tested our four svm models  one for
each mhc subtype  to predict the binding
peptides to each mhc subtype from
experimental peptide dataset 
iterative statistical search method
to find significant motifs and decrease
search space to improve algorithm efficiency 
we developed a python program to statistically
search the significant motifs from a peptide
dataset based on schwartz and gygi        
two frequency matrices     by   in
dimension  of all residues at every position
were built from binding and nonbinding

  

datasets collected as above  each row
represents an amino acid  each column
represents the position  value at row i and col j
represents the probability of observing residue
i at position j given a probability p  which was
calculated for this residue position pair from
the background data set  a greedy recursive
algorithm and pruning procedure were applied
to search the sequence space to identify highly
correlated
residue position
pairs
with
significant binomial probability values  thus 
the sequence database is decomposed into a
list of significant motifs and we can apply
these motifs as features in our learning
methods 
results and discussion
svm based method with       features gave
high accuracy
to obtain the optimal features  we
compared the overall accuracy with different
number of features in    fold cross validation
of naive bayes and svm  i e  motifs includes
one or two frequent amino acids and motifs
with one  two and three frequent amino acids 
and with results from statistical iterative
search  table     our preliminary results
showed that svm based method with about
     features achieved accuracy close to     
increasing features to        motifs would not
contribute much for accuracy but rather wastes
memory space and increases running time 

fitable    overall accuracy by different feature selections
motif sets with   or   motif sets with   to   statistical iterative search
amino acids        
amino acids          
generated features      
nave bayes

     

support vector      
machine  svm 

na

     

     

     

so we decided to restrain our feature space to
     in the following study 
for each dataset for a particular mhc
subtype  we compared the results from    fold
cross validation  figure     for all mhc
subtypes  svm provided a high accuracy and
area under a roc curve close to    on the
other hand  naive bayes algorithm gave an
area around     for subtypes hla a    hlab    hla b    but achieved high value close
to   for hla a   subtype  overall naive
bayes
achieved
inferior
performance
comparing with svm based method 

the structural difference among these
subtypes needs to be investigated to fully
understand the underlying mechanism
affecting binding affinity 

figure    roc area in    fold cross validation
using naive bayes and svm for four different
mhc subtypes

validation of algorithm
to evaluate the performance of our
algorithm  we compared the performance of
our approaches with netmhc epitope
webserver      netmhc     used artificial
neural network training method  which has
been benchmarked as the best among available
methods  it achieved about     confirmed
accuracy on a large set of pathogenic viral
proteome  lundegaard et al         using our
experimental data  netmhc predicted     as
binders for four mhc subtypes  whereas our
svm based method achieved     positive

mhc subtypes differentiated by peptidebinding
specificity
by applying our trained svm based
classifier on our experimental data  we were
able to determine which peptides mhc
subtypes can specifically bind to  figure     it
is a little unexpected that hla a    hlab   and hla b   subtype binds to a group
of peptides that have no affinity to hla a   

  

statistical iterative approach gave relatively
high accuracy with small feature space
to further optimize features for a better
efficiency and specificity  we adopted a
statistical iterative search method to generate
relevant motifs from training dataset  since
only significant motif can be generated from
this search  we are able to decrease our
features to a less than    motif set  using
these features to train our svm based
classifier and applied on the prediction of our
lab generated dataset  we achieved    
positive identification  this result showed
that the patterns identified through an iterative
search would be useful in the optimization of
feature selection  due to the time limit for this
project  we were unable to pursue further in
optimizing feature selection and applying this
method to binding prediction 

fiprediction  the reason that our approach
showed much better performance might due to
our using the most updated iedb dataset
which covering more mhc alleles thus our
approach picks up more features overlooked
by netmhc 

software  an update  sigkdd explorations        
    
institute of structural and molecular biology
 ismb  
university
of
london
http   www cryst bbk ac uk pps   assignments projec
ts coadwell     htm
liao  w   arthur  j  predicting peptide binding to
major histocompatibility complex molecules 
autoimmunity reviews                  
lundegaard  c   lund  o   kesmir  c   brunak  s  
and nielsen  m  modeling the adaptive immune
system  predictions and simulations  bioinformatics 
                   
lundegaard  c   lamberth  k   harndahl  m   buus 
s   lund  o   and nielsen  m  netmhc      accurate
web accessible predictions of human  mouse  and
monkey mhc class i affinities for peptides of length
     nucleic acids research      w    w         

figure    binders identified by netmhc 
naive bayes  and svm methods from labgenerated data

mester  g   hoffmann  v   stevanoic  s  insights into
mhc class i antigen processing gained from largescale analysis of class i ligands  cellular and
molecular life sciences                  

future work
in this study  we identified better features to
represent mhc properties and applied and
compared naive bayes and svm based
methods to predict and identify mhc binding
peptides and to further differentiate mhc
subtypes 
in the future  we plan to scale up our data
sets by importing more peptides from
databases and test our developed method 
optimize feature selection by integrating the
flanking region motifs with the binding
peptide motifs  improve motif identification
and subtype identification algorithm by
incorporating more mhc structural and
functional properties combined with different
kernel functions 

nielsen  m   lundegaard  c   worning  p   hvid  cs  
lamberth k et al  improved prediction of mhc class
i and class ii epitopes using a novel gibbs sampling
approach  bioinformatics                    

references
elias  j e  markerofpeptide perl script for peptide
generation      
hall  m   frank  e   holmes  g   pfahringer  b  
reutemann  p   witten  i  the weka data mining

  

peters  b   sette  a  generating quantitative models
describing the sequence specificity of biological
processes with the stabilized matrix method  bmc
bioinformatics             
smith garvin  j   koretzky  g   jordan  m  t cell
activation  annual review of immunology                  
schwartz  d   and gygi  s  an iterative statistical
approach to the identification of protein
phosphorylation motifs from large scale data sets 
nature biotechnology                    
vita  r   zarebski  l   greenbaum  j a   emami  h  
hoof  i  et al  the immune epitope database     
nucleic acids res     database issue  d       
    

fi