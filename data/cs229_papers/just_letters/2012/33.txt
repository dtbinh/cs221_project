automatic detection and of dipoles in large area squid
magnetometry
lisa qian
december         

 
   

introduction
scanning squid magnetometry

scanning squid magnetometry is a powerful tool for metrology of individual nanomagnets because of its incredible flux sensitivity  as low as     electron spins  and
non invasive nature  with micron sized pick up loops  this technique has been used to
study individual magnetic dipoles in a variety of systems such as magnetotactic bacteria 
nanofabricated bar magnets  and naturally occurring nanomagnetic patches in complex
oxide heterostructures  figure  a shows a cartoon of a scanning squid magnetometer
over individual point dipoles  a dc magnetometry image of a silicon substrate containing individual magnetotactic bacteria is shown in figure  b  where the individual dipole
orientations are clearly visible  such an image is a convolution of the local magnetic field
component perpendicular to the pick up loop with the point spread function defined by
the pick up loop geometry 
pickup loop

 m

 a 
    

 
 
 
  m

 b 

    
m 

figure     a  cartoon of a scanning squid imaging magnetic dipoles   b  a typical
magnetometry image  which is a convolution of the samples local magnetic field with
the squid pick up loop shown in  a  
 

fiusing both fine and course motion scanners  we can cover a sample area as large
as  mm mm  each scan can be as large as    m   m  and often contain many
individual dipoles that may be clustered together  once a scan is taken  we often need
to analyze properties of each individual dipole such as their dipole moments  current
practice is to identify each dipole by eye  manually crop the image  and send the cropped
image to an analysis program  in crowded images  selection of dipoles is a slow and
monotonous process  in addition to finding each dipole  the crop window  or bounding
box  for each dipole is also of importance  since magnetic fields are long range  we want
to make the bounding box as large as possible without picking up magnetic signals from
neighboring dipoles or uneven background 
the goal of this project is to automatically detect magnetic dipoles given a large
area magnetometry scan and to determine the appropriately sized bounding box 

 

supervised learning

the idea is to go through the entire large area scan with a sliding box of fixed dimensions 
each image is an example and is classified as either a part of a dipole     or not     
because stronger dipoles extend across more space than weaker dipoles  many boxes
classified as     might be needed to cover an entire dipole  at the end  neighboring  
boxes are merged to form the bounding box for a dipole 

   

challenges

classification and feature design for this project was challenging for several reasons 
first  many magnetometry scans have slowly varying background signals that can be on
the order of the dipolar signals themselves  but because the dipolar fields themselves are
long range  it is often challenging to properly remove background fields while preserving
the structure of the dipoles  second  the strengths of the dipoles we measure vary across
roughly four orders of magnitude  from     b to     b    thus the spatial extent of the
dipoles also vary greatly  ranging from approximately  m m for the weakest dipoles
to   m  m for the strongest ones  initially i used a very large feature vector to
cover all the entire range of pixel intensity  along with sliding boxes of varying sizes 
both of these ideas proved to be not computationally feasible 

   

feature selection and svm

the background problem was solved by using the gradient of the large area scan instead
of the magnetometry image itself  figure   shows a magnetometry image with particularly strong background fields and how simply taking the gradient nearly completely
removes the background  to obtain training test examples  i take the gradient of the
large area magnetometry scan and go through this gradient image with a sliding window
as described previously 
the feature vector for each image obtained through with the sliding window is a
histogram of pixel intensity of that image  i discretize the feature vector linearly from
 

fi   m   m to    m   mum in increments of    m   mum  for a given training test
example  i count up the number of pixels in that example corresponding to each discretization level  this results in a length     sparse feature vector  i used an svm to
train and classify 

 a 

 b 

figure     a large area magnetometry scan  without background removal   b the
gradient of  a   without additional background filtering 

   

training and test examples

i collected training samples by looking at a total of seven large area scans  these scans
contain a total of     dipoles  to get a good variety of dipoles  i chose large area scans
taken at different heights and with levels of crowdedness  a large scan image is usually
around     pixels      pixels and covers about    m   m  the size of the sliding
window is set to      pixels  which is the size of the smallest dipole i found amongst
the seven large area scans i looked at  for training examples  i skipped by    pixels
between each image  for test data  i skipped by    pixels between images 
it is important to note that since dipolar fields are long range  there is no precise
way of determining when a dipole ends and draw the appropriate bounding box  in my
work here  i labeled an example as   when any stray dipolar fields are on the order of
the noise level of the background 

 
   

results
leave one out cross validation

because i had a limited sample size  seven large area scans   i used loocv to train  test
and compare my models  using an svm with a polynomial kernel gives     precision
and     recall  an svm with a gaussian kernel gives     precision and     recall 
only four false positives were found among all   large are scans 
these results are very satisfactory   the dipoles that were missed by the classifier
were very weak and right at the noise level  figure   a and c show the results of the
model on two large area scans  each of these scans were classified using an svm with
gaussian kernel trained on the other six scans  further improvements could be made
by including more positive training data 
 

fi   

merging to form bounding box

the final step is to merge neighboring test images that have been classified as    part
of a dipole  to form the final bounding box for the dipoles  figure   b and d show the
final results  while this process works well on scans with sparse dipoles  b   it does not
work well for crowded scans  d   this is because the sliding window is currently quite
large and can cover more than one dipole at a time in crowded images 
while this problem will be alleviated using a smaller window size  breaking up the
scan into more and smaller test images   it will always be a problem because of the long
range nature of the dipolar fields  when the dipoles are crowded  it becomes impossible
to separate out individual dipoles from a cluster  in these cases  i would eventually like
to identify the cluster as a separate classification 
 

 

   

   

   

   

 

 

   

   

   

   
m

m

   
 
   

   

   

 
   

   

 

 

  

  

   
 
 

   

   
 
 

 
    m 

   

   

 
    m 

   
m

m

 a 

 b 
 

 

   

   
   

   

 

 
   

m

m

   
   

 

   

 
   

   
  

  

 

 
   

   
 
 

  

   
m

   

 
 

m  

 c 

  

   
m

   

m  

 d 

figure     a results of svm classification on a large area magnetometry scan   b after
merging to form one bounding box for each dipole   c     d the same for another  more
crowded scan 

 

fi   

conclusions

in this project  i successfully trained an svm classifier to automatically detect dipoles in
a large area squid magnetometry image  using a gaussian kernel yields slightly better
results over a polynomial kernel  with a precision of     and recall of      these results
are satisfactory and can be improved by including more positive training examples and
reducing the sliding window size  significant improvements still need to be made to draw
appropriate bounding boxes in crowded images 

 

fi