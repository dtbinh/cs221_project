predicting fantasy football   truth in data
matt bookman
december         
  
 introduction
the study of sabermetrics is defined by bill james as  the search for objective knowledge about baseball     via
data analysis  sabermetrics seeks to dispel or validate traditional measures used to construct a winning baseball
team  the goal of this paper is to begin the search for objective knowledge about fantasy football 
yahoo sports provides an online fantasy football league to its user base  end users create leagues and then
those individuals construct a roster of real nfl players each week for head to head competition  nfl players
are assigned fantasy points based on their achievements in each football game  and each head to head
matchup produces a winner and loser based on the respective teams accumulated fantasy points  fantasy points
are assigned based on elements such as rushing yards  receiving yards  passing yards  and points scored 
yahoo sports also provides  projected points  from a  rd party   for each nfl player prior to a game  to help
end users better assemble a team lineup for each week  along with the projected points come branded  news
and notes  and  scouting reports  to help one make informed decisions in filling out a weekly lineup 
personal experience has indicated dubious value for the projected points and scouting reports  the objective
of this project is to produce more useful predictions of fantasy points and to glean the value of advice such as a
team playing at home or on the road or a quarterback facing a strong passing defense 
results of linear regression and ranking svm machine learning predictions are compared against the yahoo
sports projected points as well as a baseline random predictor 
  
 data
to generate predictions  player and team data was sourced by scraping web pages from espn coms weekly
nfl statistics and parsing the html  player statistics  and game results    team statistics  were source for
week   through week    of the           nfl season 
earned fantasy points and projected fantasy points were sourced by scraping web pages from the yahoo
fantasy football web site   fantasy data was sourced for quarterbacks  running backs  wide receivers  and tight
ends for week   through week    of the           nfl season  fantasy projected points were sourced for the
top    for each position  fantasy points  results  were sourced separately for the top    at each position 
for this project  focus was narrowed to predictions on the quarterback position  the quarterback was chosen for
a number of reasons  chiefly 
   quarterbacks provide the most consistent
dataset  there is typically one quarterback who
plays the entire game  and so the projected
versus actual data is most complete     training
elements were produced for each week 
   quarterbacks acquire both passing and rushing
fantasy points  not all quarterbacks generate
rushing yards  but enough do to force the
inclusion of rushing statistics in the analysis of
quarterbacks  this adds to the interest of the
problem 
the initial feature set used for machine learning
predictions can be seen in table    all data
statistics are treated as per game averages 
matt bookman  mbb stanford edu  

individual player
passing completions
passing attempts
passing yards
passing touchdowns

opposition defense game specifics
passing yards
home away
yards per pass
rushing yards
yards per rush

rushing attempts
rushing yards
points
yards per rush
total yards
rushing touchdowns yards per play
sacks
interceptions
fumbles

sacks
interceptions
fumbles recovered

table    machine learning feature data

  

cs    final project   fantasy football

fi  
 preliminary data analysis
figure   shows a histogram of all quarterbacks per game fantasy points and a histogram of the yahoo sports
prediction errors 
while the mass of the errors in projected points is in the    to   range  standard deviation           the average
fantasy points is just over     making such an error range quite large  in fact a naive predictor that blindly
predicts the mean produces a slightly better average absolute error        vs         and a slightly narrower
standard deviation          

figure    a  weekly fantasy points for nfl quarterbacks  b  prediction error in projected points

however  the value of a prediction for building a team is not necessarily in getting close to the actual points 
when filling out a roster in a given week  more valuable would be a ranked list of available players for a
position  the value is in the ordering of projections  not the accuracy of the values 
thus the metric used for comparison of the machine learning projections to the yahoo projected points is a
pearson rank correlation coefficient 
  
 data preparation
an attempt was made to capture two commonly held approaches to predicting how a player will perform    
how has the player performed over the course of the season  and    how has the player performed recently 
as feature input for each training element  the individual player weekly values were included as 
   previous games totals
   last   games average
   season average
opposition defense statistics were included as season averages only 
a training element thus consists of    feature fields         individual      defense     home away   the target
value for each record is the fantasy points the nfl player accrued for the given week 
  
 machine learning methods
 a  linear regression
linear regression over training elements for quarterbacks was performed using the matlab regress function 
predictions were then made by computing x   w  x is a matrix such that each row is a training element and
the columns are the input features  plus constant   w is the learned coefficient vector  including constant term  

matt bookman  mbb stanford edu  

  

cs    final project   fantasy football

fito be of true value and not just academic interest  one must be able to make predictions for a coming week
based only on past statistics  thus the procedure followed is 
for each week  min week     through max week
train on data for min week through week    
test on data for week producing projected fantasy points
convert linear regression week projected points into a vector of ranks
compute pearsons rho for linear regression rank versus actual rank
convert yahoo week projected points into a vector of ranks
compute pearsons rho for yahoo rank versus actual rank
compute pearsons rho for random permutation    to test size  versus actual rank

 b  ranking svm
support vector machines  svms  are one of the most powerful tools available in machine learning today with
the ability to trade off training error predictions for better generality  larger margins   and the ability to use
kernels to explore higher dimension feature vectors  efforts to produce better web page results has led to a
technique of applying svms to make ranking predictions    for each pair of training elements the rank ordering
between them becomes a constraint of the objective function 
the svmrank software was used to make ranking predictions in a similar fashion to linear regression  six data
files were produced representing ranked training data for weeks       through      through          through    
six data files were produced representing test data for weeks              
one significant difference between the svm results and linear regression is that the svm results are of value
strictly as ranking and not as predictors of specific projected fantasy football points 
svmrank was run with all default parameters  notably the svm parameter c  the c value allows one to make
trade offs between having training elements be in error with increasing the size of the separation margin 
raising this value from its default of     only produced inferior results 
attempts were made to run svmrank with non linear kernels  but the performance was so poor as to make those
options unusable 
  
 preliminary results
early results of linear regression when limited data was available produced poor results  an approach was
taken to make random         splits of the data into training and test sets in an attempt to extract a best
model  this approach did produce better results when limited data was available 
however this approach turned out to simply be an ad hoc way of finding the most predictive features  the
results of regress provide confidence bounds for the generated coefficients  these results were used to
eliminate the least informative features  it was ultimately observed that specific weeks  training through week  
and training through week    had models that predicted better than others over all subsequent weeks  both
models learned had eliminated all but   of the original    fields 
week  
pass yards  last   game 
pass yards  last   games 
rush yards  last   games 
defense passing yards  season 

week  
pass yards  last   game 
pass yards  season 
rush yards  last   games 
defense passing yards  season 

empirical testing demonstrated little difference in prediction results for the two choices  mean      per week  
but the better of the two  week   features  were chosen as the feature set used for all predictions 
matt bookman  mbb stanford edu  

  

cs    final project   fantasy football

fi  
 final results
the first prediction week     had effectively no correlation in rank predictions  lr           svm          
which is likely due to having a single week of training data  for four of the five subsequent prediction weeks 
both linear regression and svm predictions were superior to yahoo projected points and often by a significant
margin  figure    
in the four weeks that linear regression and
svm ranking correlations were higher than the
projected points  the average correlations were
      lr  and       svm  higher  in the single
week they were lower it was by       lr  and
      svm  respectively 
lr
svm
yahoo
weeks                                  
week  
                    
table    mean rank correlation over weeks
when machine learning was superior inferior to
yahoo

figure    rank correlations for all prediction methods week
  through week    

the results of a random ranking predictor are
shown in figure   to demonstrate that the
machine learning and yahoo predictions are
better than random  and also that one can be
fooled  see week       and     if not careful 

a critical step in achieving these results was the reduction of features discussed in the previous section  figure
  shows the result of better feature selection on both linear regression and svm  when trained on all features 
linear regression predictions were better than yahoo in only   of the   key prediction weeks  svm predictions
were better than yahoo in only   of the   key prediction weeks  with improved feature selection  mean rho
for linear regression improved from        to        and for svm improved from        to        

figure  a  linear regression predictions with all
features and with only the most predictive features 

figure  b  svm ranking predictions with all features
and with only the most predictive features 

table   shows the mean contributions of each of the   remaining features  an interesting result is that on
average a more significant contribution to a quarterbacks fantasy points  and wider variation  comes from the
matt bookman  mbb stanford edu  

  

cs    final project   fantasy football

fiquality of the opposition passing defense than from the quarterbacks own statistical history  predicting rank
only on the defense yields a superior correlation coefficient          to individual passing yards          
pass yards  previous game  pass yards  season  rush yards  last   games  defense passing yards  season 
mean std               
              
             
              
table    average contributions to linear regression predictions for each feature  including the constant term         

mean  yields a mean prediction of         fantasy points 
the primary objective of this project was to produce superior
rankings  however linear regression numerical predictions of the
fantasy football points are not devoid of value  when compared to
yahoos projections  linear regression results are again superior as
shown in figure   
linear regression average prediction error was      versus yahoos
     and is better in all weeks  however  that the linear regression
mean error is less than yahoo in week   illustrates the point that on
its own  minimizing mean prediction error may not achieve the
desired result as rank correlation for week   was virtually   
figure    linear regression has mean
  
 conclusion
prediction error less than yahoo and well
as with all sports  the games are played on the field and are not
within standard deviation for points
simply simulations based on statistics  one can never expect
perfect predictions  however  this project has demonstrated that machine learning techniques can produce
results of significant quality in predicting the rankings of nfl quarterbacks for fantasy football  both machine
learning approaches applied here produced consistently better rankings than yahoos projected points 

while both linear regression and ranking svm produced strong results  on the whole  the results of svmrank
were somewhat disappointing  a significant draw to using an svm is the ability to use different kernels and
explore higher dimensional mappings of the original feature space  the svmrank implementation in practice did
not allow for using anything but a linear kernel which made the results almost indistinguishable from linear
regression 
there is much still to be explored to build on the results achieved here  a preliminary analysis suggests
building a mixture model with two different categories of quarterbacks     the running quarterback  there are
   and    the pocket quarterback  there are      these two categories may be better modeled by two different
sets of features and coefficients 
in the end  the large numbers of features producing inferior results demonstrates that the right data and right
model are critical and many elements perceived as relevant by expert scouting reports are in fact  noise 
  
 references
grabiner  david j   the sabermetric manifesto   the baseball archive 
 http   seanlahman com baseball archive sabermetrics sabermetric manifesto  
 

yahoo help  understanding projected points in fantasy football
http   help yahoo com kb index page content id sln    
 

 

espn nfl weekly leaders         http   espn go com nfl weekly leaders   type 

 

espn nfl schedule         http   espn go com nfl schedule

 

yahoo fantasy sports  http   football fantasysports yahoo com  note  user account required 

joachims  thorsten  optimizing search engines using clickthrough data  proceedings of the acm conference on
knowledge discovery and data mining  kdd   acm       
 

matt bookman  mbb stanford edu  

  

cs    final project   fantasy football

fi