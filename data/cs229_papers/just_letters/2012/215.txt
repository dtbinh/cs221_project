 

identifying dementia in mri scans using machine
learning
victor miller  stephen erlien  and jeff piersol

abstracta support vector machine and naive bayes
classifier are used to identify the presence of dementia
in mri brain scans  features are computed for each
scan  scans are processed via k means to segment the
image into different tissue types  from which different
quantities are computed  e g   total gray matter  a measure
of symmetry   principal component analysis is used to
reduce dimensionality of the images  and forward feature
selection is used to identify the most important principal
components  which are then included in the feature set 
using a naive bayes classifier  we were able to obtain a
classification accuracy of         with precision of       
and recall of        
keywordsdementia  eigenbrain  mri

i 

i ntroduction

d

ementia currently afflicts more than    million
people globally  and this number is projected to
grow to     million by the year       the disease
is tragically debilitating for the individual  and also
takes a significant emotional toll on family and friends 
furthermore  caring for those who suffer from dementia
currently costs the us healthcare system roughly     
billion per year  and is forecast to cost    trillion per
year by          
diagnosis of dementia is typically done through a
clinical examination of a patients mental state  which
can be a subjective measure of ones health  and often
does not provide a concrete indicator of which type of
treatment is most likely to produce favorable results 
neurological mri imaging has provided physicians with
better means to diagnose dementia  and physicians have
discovered that dementia can exist in a variety of mixed
forms      even so  neurological mri scans are complex
and often noisy  which make them a challenge to interpret
even for a neurological radiologist with years of training
and experience  in this work  we apply machine learning
techniques to identify those mri scans that indicate
some form of dementia  with the goal of increasing
the likelihood of early detection of dementia  given
the education  experience  and expertise of neurological
radiologists  our goal is not to replace a radiologist  but to
provide a tool to help prioritize mri scans which display
the most potential for disease diagnosis 

fig    

typical axial scan from oasis data collection

this report is structured as follows  first  we present
the dataset of mri scans that contains both healthy
and diseased brains  second  an initial set of features
is motivated and the methods employed to extract these
features are described  third  initial results of machine
learning algorithms applied to this small set of features
are presented  based on the results of this initial set
of features  additional features are motivated and the
methods to determine these features described  lastly 
the results from ml algorithms applied to this larger set
of features are presented and discussed 
ii 

data

our work utilizes a dataset containing     neurological mri scans made available by the open access
series of imaging studies  oasis  project      the
subjects ages range from    to    with     subjects
being clinically diagnosed with very mild to moderate
alzhiemers disease  each scan consists of    x   x   
voxels which have been preprocessed to remove the skull 
leaving only brain matter in the images      each scan is
associated with additional information about the subject 

fi 

image for zero lag  normalized by the integrated signal
in the original slice 
p
p
g x  y gf  x  y 
x 
py 
s    g   gf       
   
x  g x  y 
symmetry measures are computed for left right and updown symmetry about the middle of the image  and an
example measure of left right symmetry is displayed in
fig     the average value of this symmetry is used in the
feature set 
in order to incrementally build complexity into our
work  we start by using age  sex  education level  socioeconomic status  intracranial volume  normalized brain
volume  average measures of gray matter  white matter 
csf  and up down and left right symmetry as an initial
feature set 
iv 
typical axial scan preprocessed into segmented colors

including age  sex  education level  socioeconomic status 
intracranial volume  and normalized brain volume  and
two measures of dementia  the clinical dementia rating
 cdr  and mini mental state exam  mmse  
a single  axial slice of a typical scan is shown in
fig     in addition to the preprocessing to remove the
skull  the scans have been further processed by oasis
 using the k means algorithm  to bin pixel intensities into
one of four colors which correspond to the background
     cerebrospinal fluid  csf       gray matter      and
white matter      this segmented image is shown in
fig    
iii 

f eature e xtraction

each subject is labeled as demented or not demented
based on his mmse score  where a subject receiving
an mmse score less than    is classified as demented
    is the maximum possible score and corresponds to
a healthy individual   for each subject  a set of features
is created using the previously mentioned information
included for that subject  e g   age  gender  and additional
features extracted from the subjects brain scan  it is
known that the severity of dementia is correlated with
volume of gray and white matter      and so the total
amount of gray matter  white matter  and cerebrospinal
fluid in each slice of the scan is computed  asymmetry
in brain structure can also be indicative of abnormality 
so a measure of symmetry in each slice is computed by
taking the correlation of a given slice with its flipped

a support vector machine  svm  and a naive bayes
modelled with normally distributed features were used on
the feature set described above  an svm was chosen to
exploit linearly separable patterns in the data  while naive
bayes was chosen to exploit the normal distribution of
the feature data  originally  only the features described
in the previous section were used  raw pixel data was
not used directly in the feature set  moreover  each
feature was normalized to values between   and   
and performance was determined using    fold cross
validation 
the learning curve for an svm with a linear kernel is
shown in fig     the performance with the full dataset
is        however  the data only has     examples of
demented subjects and a trivial classifier could easily
achieve a performance of     by always outputting
no dementia  for this reason  the precision and recall
metrics are calculated and displayed as well in fig   

   
lr symmetry  a u 

fig    

i nitial r esults

 
   
 
   
 
 

fig    

  

   
z  slice

   

   

example of lr symmetry vs slice of a typical scan

fi 
  

svm train error
svm test error

  
  
  

error    

  
  
  
 
 
 

fig    
healthy brain  left  versus demented brain  right  with
structural differences highlighted

 
 
  

   

   

   

   

   

   

   

   

number of scans

fig    

svm learning curve on initial feature set
   

svm precision
svm recall

  

  

percentage    

  

  

  

  

  

  

  

  
  

   

   

   

   

   

   

   

   

number of scans

fig    

svm precision and recall on initial feature set

the learning curve suggests we have high bias and
therefore would benefit from additional features  to
ensure that the svm is not heavily reliant on nonmedical features  we removed the education level and
socioeconomic status and achieved a nearly identical
performance 
preliminary naive bayes classification yielded results
similar to that of an svm 
v 

a dditional f eatures

the initial results indicate high error rates in both
the training and the test data  implying high bias in the
model  these results suggest additional features could
be used to improve performance  a close examination
of scans from demented and non demented subjects  like
those illustrated in fig     provides insight into additional
features that may be useful in identifying demented
subjects  as indicated  the demented subject shows cerebrospinal fluid in the areas which are occupied by brain

matter in the non demented subject  principal component
analysis  pca  is used to capture these structural features
from the voxel data in the scans  running pca on the
entire scan is computationally burdensome  and instead
coronal slice      shown in fig     is used since it
captures structures indicative of dementia 
the mean centered and unit variance scaled    th
coronal slice from each subject was represented as a
vector  x i    pca on this set of vectors produced a set of
eigenbrains  each represented as a vector  v  i    in class 
we discussed computing the eigenvectors of the empirical
covariance matrix 
m
  x  i   i t
x x
   
m
i  

as a method for determining the principal components  in
practice  explicit computation of this covariance matrix
is computationally burdensome for the    x    pixels
in the slice  methodologies that use svd decomposition
provide much faster methods for computing the principal
components  moreover  matlab has a built in function 
princomp    which computes the pca decomposition
directly from the given data  and we leveraged this
capability in our work  the results of running pca
on this slice for all subjects is a set of eigenbrains 
some of which appear to capture structures found in
demented subjects as seen in fig    while others appear
to capture general brain structure as seen in fig     using
all of these eigenbrains as additional features causes
our learning algorithms to overfit the training examples
and subsequently perform poorly on the test subjects 
therefore  forward feature selection was used to select
only the eigenbrains that appear to capture structures useful in classifying demented subjects  eigenbrains were
added as features in this manner until the increases
in performance were minimal  this method resulted in
about five eigenbrains being used as additional features 
once the eigenbrains were computed  given a subjects

fi 
  

nb train error
nb test error

  
  
  

error    

  
  
  
 
 
 
 
 
  

   

   

   

   

   

   

   

   

number of scans

fig    

naive bayes classification error on final feature set
   

  

fig    
eigenbrain capturing dementia indicating structure as
identified by forward feature selection

  

percentage    

  

  

  

nb precision
nb recall

  

  

  

  

  
  

   

   

   

   

   

   

   

   

number of scans

fig     

fig    

region counting was implemented by adding the largest
three regions of light matter  gray matter  and csf in
slice     as   new features to the original feature set 
and no significant change in test error was observed  it is
likely that the effects of region sizes are already captured
in the features that give the total volume of light matter 
gray matter  and csf 

eigenbrain capturing general brain structure

   th axial scan and the ith eigenbrain  a feature  y  i   
can be calculated as
y  i    v  i t x i 

naive bayes precision and recal on final feature setl

   

this scalar can then be used as a feature to indicate the
presence of the eigenbrain in the subjects scan 
another method explored to extract features was
region counting  as the cerebrospinal fluid seems to
occupy larger contiguous regions in scans of demented
subjects  the area of csf seems like a natural feature
to use in classification  however  our results indicate
no substantial improvement when using such features 

vi 

f inal r esults

after using forward feature selection to incorporate the
best features  svm classification yielded a test error of
        and naive bayes yielded test error of        
importantly  the recall rate using an svm was        
meaning that        of dementia cases were not detected  using naive bayes         of dementia cases
were undetected 
it should be noted that age alone seems to be a strong
indicator of the presence of dementia  a naive bayes
model with age as the only feature yielded a test error

fi 
  

viii 

  

svm train error
svm test error

  
  

error    

  
  
  
 
 
 
 
 
  

   

   

   

   

   

   

   

   

number of scans

fig     

svm classification error on final feature set

running classification on a larger dataset that more
accurately represents a cross section of the population would help verify or refute the results presented 
particularly  the results of naive bayes depend on
p age no dementia   and the oasis dataset used does
not accurately reflect the true likelihood of age given no
dementia 
since the class labels for dementia were found by
discretizing a relatively continuous scale  a helpful improvement may be to cast the problem as a multi class
classification problem with more possible output classes 
this would add another layer of prioritization for doctors
who will analyze these scans 
r eferences

   

  

   

  

percentage    

  

  

  

  

svm precision
svm recall

  

  

  

  
  

   

   

   

   

   

   

   

   

number of scans

fig     

f uture w ork

svm precision and recall on final feature set

of        and recall of         however  an svm
with the same setup had nearly     error  and naive
bayes classification with the full feature set excluding
age had        error  therefore  the classifier is not
merely keying to age data in order to produce an accurate
result  the likely reason for the performance using only
age is that there is a high concentration of data samples
with age near     resulting in a non dementia likelihood
p age no dementia  that is heavily skewed to lower age
values 
vii 

c onclusion

by extracting features from brain scans  selecting
relevant features  and classifying the scans based on their
features  we were able to detect dementia with       
accuracy  the most indicative features were found to be
normalized brain volume  volume of gray matter  and
volume of csf  though far from being able to replace a
neurological radiologist  the classifier is of great benefit
in prioritizing scans for radiologists to analyze 

s 
hall 
the
dementia
plague 
internet 
www technologyreview com featuredstory        thedementia plague page     october        dec        
    jc stout         aug    association of dementia severity with
cortical gray matter and abnormal white matter volumes
in dementia of the alzheimer type  archives of neurology 
              
    marcus  ds  wang  th  parker  j  csernansky  jg  morris  jc 
buckner  rl  open access series of imaging studies  oasis  
cross sectional mri data in young  middle aged  nondemented  and demented older adults  journal of cognitive
neuroscience               
    m  jenkinson  c f  beckmann  t e  behrens  m w  woolrich 
s m  smith  fsl  neuroimage                 

fi