cs    project  classification of motor tasks based
on functional neuroimaging
gerald brantner
mechanical engineering  stanford university  stanford  ca        usa  geraldb stanford edu

georg schorpp
management science and engineering  stanford university  stanford  ca        usa  gschorpp stanford edu

brain machine interfaces  bmis  aim to establish a new way of communication between humans and
computers  especially paralyzed individuals could greatly benefit from bmis  currently  most successful
systems rely on the implantation of electrodes on the motor cortex  but due to its invasive nature  this
technique prohibits extensive research on human subjects  for this reason  a new approach is needed  as
functional magnetic resonance imaging  fmri  is human safe  research using this method can be performed
at a higher scale  because brain structure and activity varies among individuals  machine learning is an
essential tool to calibrate and train these interfaces  in this project we developed binary and multi class
classifiers  labeling a set of    performed motor tasks based on recorded fmri brain signals  our binary
classifier achieved an average accuracy of     across all pairwise tasks and our multi class classifier yielded
an accuracy of      we demonstrated that combining fmri and machine learning is a viable path for
research on bmis 
key words   machine learning  functional magnetic resonance imaging  fmri   brain machine interface

  

introduction

brain signals of human and non human primates have previously been translated to control mouse
cursors            keyboard inputs      and to guide a robotic hand         most successful systems
rely on electrodes that are implanted in the brain  electrodes  however  are invasive  which prevents
the use on human subjects  functional magnetic resonance imaging  fmri  is a very promising
alternative     because it is     non invasive      does not rely on ionizing radiation  and     has high
spatial and temporal resolution  which makes it a safe method for research using human subjects 
in this research we connect motor tasks with neural activity  in order to classify a subjects motor
states based on observed brain signals using fmri 

  

data collection and preprocessing

we used data from a study conducted at the stanford center for cognitive and neurobiological
imaging  cni  by gb  author   sm  and ca  acknowledgements   the experiment required the
test subject to perform a set of ten different tasks  table     the subject repeated each task   
 

fibrantner  schorpp 
cs    project  classification of motor tasks based on functional neuroimaging

 

task   description
wrist   up down
 
wrist   rotate
 
elbow   up down
 
shoulder   up down
 
shoulder   rotate
 

task   description
wrist   up down weighted
 
wrist   rotate weighted
 
elbow   up down weighted
 
shoulder   up down weighted
 
shoulder   rotate weighted
  
table  

set of tasks

bold fmri time series for voxel  

bold fmri time series for voxel  

   

   
task 
task 
task 
task 
task 
task 
task 
task 
task 
task  

activation  normalized

   

   

activation  normalized

   

task 
task 
task 
task 
task 
task 
task 
task 
task 
task  

   

  

  

 
 

  

   

 

 

  

  
time  s 

figure  

  

  

  

  

 

 

  

  
time  s 

  

  

  

sample fmri bold signal for   voxels and varying tasks

times and the tasks were randomly ordered  the fmri scanner partitions the brain into        
voxels  cubes of volume    mm     for each of these voxels we simultaneously recorded the fmri
bold     signal  which measures oxygen consumption due to activation at a temporal resolution
of one second  figure     the raw signals were preprocessed using a standard pipeline 

  

support vector machines

in this section we describe the implementation of our classifier based on support vector machines 
we employed matlabs integrated svmtrain and svmclassify functions  by default  the training
function normalizes the data so that it is centered at its mean and has unit standard deviation  we
found that a linear kernel performs very well for this problem and we chose sequential minimal
optimization  smo  as an optimization method 
   

initial feature selection

we faced two problems while classifying motor states with fmri data  first  the feature size is
very large  due to the large number of voxels  and second  the number of samples is much lower
than the number of features  the low number of samples is a result of the time constraints and
operational cost associated with the mr scanner  we performed preliminary tests and found that
the most successful features are the concatenated time series of a subset of the recorded voxels
 figure     we used a two stage selection process 

fibrantner  schorpp 
cs    project  classification of motor tasks based on functional neuroimaging

 

   filter by region of interest  roi   for the scans  we only selected voxels that are part of the
brains motor cortex 
   the voxels were ranked by an fir models reliability at capturing variance in bold signal
responses to tasks  the top      voxels were selected 
   

binary svm

we first used a binary svm to pair wise classify all combinations of tasks  for each pair we use   
data points     for each task  the parameters for the algorithm are the number of voxels considered
as well as the length of the input signal  the algorithm uses leave one out cross validation for every
pair and computes the overall mean accuracy  which reaches      figure     shows the individual
classification accuracy across all pairs  we can see that the accuracy is decreased for similar tasks 
especially for a task and its weighted counterpart   green ellipsoids   this is expected and further
validates this approach 
   

multi class svm   one vs one

next we developed a multi class svm algorithm that classifies across all    tasks at the same
time  we found that one vs one yields the best results compared to other methods  such as one vsall  section       for each test point  this algorithm applies binary classification over all possible
   
voxel  
voxel  
voxel  
voxel  

   
   
 
   

 

  

  

figure  

figure  

  
feature no

  

   

illustration of a data point

confusion matrix for          voxels and    sec duration

   

fibrantner  schorpp 
cs    project  classification of motor tasks based on functional neuroimaging

 

combinations and assigns a point to the winning class  eventually the test point is classified to
the class scoring the most points  this method in its standard implementation  however  does not
account for ties  our enhanced method instead applies another  binary   multi class  classification
between the tied task types to make the final decision 
   

heuristic feature selection enhancement

after implementing both the binary and multi class svm we found that using all available data  i e 
     voxels over a    sec time window  does not lead to the best predictions  instead  considering
only the        most significant voxels over the first       seconds of the task execution leads to
much better and more robust results  figures   and     the graphs illustrate that the svms are
more sensitive to choosing the right time window than to choosing the number of voxels 

mean accuracy binary svm vs voxel and time  low resolution

mean accuracy binary svm vs voxel and time  medium resolution
   

    

   

    

    

   
    

   

    

   

    

    
   

    
    
    

  of voxels

  of voxels

   

   

   
   

   

    

    
   
    

    

    

   
   

   

   
    

 

  

  
time interval

figure  

  

   

  

 

 

 

  

  
time interval

  

  

  

  

grid search for binary svm  mean accuracy vs  voxels and t

accuracy multiclass svm vs voxel and time  low resolution

accuracy multiclass svm vs voxel and time  medium resolution

    

   

    

    
    

    
   

    

    
   

    
    

    
   
    

    
   

  of voxels

  of voxels

    

   
   

    

    

    

    
    
   

    
   

    

    

    
   

   

   
 

  

  
time interval

figure  

  

  

  

 

 

 

  

  
time interval

  

  

grid search for multi class svm  accuracy vs  voxels and t

  

  

fibrantner  schorpp 
cs    project  classification of motor tasks based on functional neuroimaging

  

 

comparison to other approaches

as discussed earlier  binary svm and one vs one multi class svm turned out to be the best choice
compared to other approaches tested  which we describe in this section 
   

binary logistic regression classifier

we also implemented a binary logistic regression classifier  similar to the method described in
section     and found it to perform     less accurate 
   

multi class svm   one vs all

as an alternative to the one vs one multi class classifier  section       we tested one vs all  onevs one achieves an accuracy of up to      whereas one vs all only performs slightly better than
random classification 

  

conclusion

in this study we developed binary and multi class classifiers to label performed motor tasks based
on recorded neural activity using fmri  on average  we achieved     accuracy for the binary case
and     for the multi class case using optimal parameters  compared to the other approaches
tested  svm proofed to be the superior method  based on these results developing a brain machine
interface using fmri is feasible 

acknowledgments
we thank samir menon for contributing with data collection  preprocessing  and for providing valuable
advice throughout the project  we thank chris aholt for volunteering as a subject during the fmri scans 

references
    p r  kennedy  r a e  bakay  m m  moore  k  adams  and j  goldwaithe  direct control of a computer from the
human central nervous system  rehabilitation engineering  ieee transactions on                    
    m d  serruya  n g  hatsopoulos  l  paninski  m r  fellows  and j p  donoghue  brain machine interface  instant
neural control of a movement signal  nature                         
    e c  leuthardt  g  schalk  j r  wolpaw  j g  ojemann  and d w  moran  a braincomputer interface using
electrocorticographic signals in humans  journal of neural engineering                
    g  santhanam  s i  ryu  m y  byron  a  afshar  and k v  shenoy  a high performance braincomputer interface 
nature                         
    l r  hochberg  m d  serruya  g m  friehs  j a  mukand  m  saleh  a h  caplan  a  branner  d  chen  r d 
penn  and j p  donoghue  neuronal ensemble control of prosthetic devices by a human with tetraplegia  nature 
                       
    j m  carmena  m a  lebedev  r e  crist  j e  odoherty  d m  santucci  d f  dimitrov  p g  patil  c s  henriquez  and m a l  nicolelis  learning to control a brainmachine interface for reaching and grasping by primates 
plos biology       e         
    j h  lee  j  ryu  f a  jolesz  z h  cho  and s s  yoo  brainmachine interface via real time fmri  preliminary
study on thought controlled robotic arm  neuroscience letters                  
    s  ogawa  tm lee  ar kay  and dw tank  brain magnetic resonance imaging with contrast dependent on blood
oxygenation  proceedings of the national academy of sciences                        

fi