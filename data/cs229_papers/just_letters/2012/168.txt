estimating convergence probability for the hartree fock
algorithm for calculating electronic wavefunctions for
molecules
sofia izmailov  fang liu
december         

 

introduction

in quantum mechanics  molecules can be described by their wavefunctions  the wavefunction is given by the schrodinger equation 
h   e
where h is the hamiltonian operator and e is the energy of the system described by  
the schrodinger equation cannot be solved exactly for molecules larger than a hydrogen
atom  therefore  certain assumptions are often made to simplify the problem  the bornoppenheimer approximation is frequently used and it treats nuclei as stationary because
their velocity is much lower than that of the electrons  this allows the wavefunction to
be broken into the nuclear and electronic components  for many applications in chemistry
we are concerned with solving the electronic wavefunction  since the schrodinger equation
cannot be solved exactly  basis sets  e g  gaussian type functions  are used to approximate
electronic wavefunctions 
the hartree fock algorithm calculates the electronic wavefunction for a system given
some basis set  the algorithm tries to solve a system of non linear equations using an
iterative procedure  specifically  the problem requires a solution to a eigenvector equation
in the form fc   c where the fock matrix f is dependent on c  convergence is reached
when certain properties of the system stabilize  e g  energy reaches a stable minimum
or the basis set coefficients stabilize   however  sometimes the algorithm converges very
slowly  oscillates around some value  or even diverges  many modifications to the original
algorithm exist to increase convergence rate and decrease the likelihood of failure 
one such algorithm is the directed inversion in the iterative subspace  diis  method
     in this algorithm  we determine an error vector for each iteration associated with the
fock matrix used in that iteration  the error for the next
pnstep is approximated as a linear
combination
of some n previous error vectors en     i ci  ei   with the constraint that
pn
c
 
  
the
goal is to minimize this approximation of the error so this problem can
i
i
be solved by standard the standard lagrange multiplier method  the c coefficients are
than used to update the fock matrix for the next step  then the actual en   error may
be calculated from the fn     the process is repeated until en is sufficiently small 

 

fiwhile the diis method does increase convergence rate and decrease failure rate in
electronic structure calculations  some systems continue to fail to converge or converge
slowly  since the calculations of each step of the hartree fock algorithm can be really
expensive  especially when large molecules or large basis sets are used  it would be very
useful to have a method of determining whether a current calculation is going to converge
soon  this way  one may choose whether to continue on with an existing calculation or to
start over and try a different set of initial conditions which may lead to a more successful
calculation 

 

generating data

hatree fock calculation with diis algorithm was carried out with terachem    quantum
chemistry package  we chose benzene as the model molecule to generate examples of
hatree fock calculation data  and the detailed process is described as follows 
   different conformations of benzene were generated with amber    molecular dynamics package  then the hartree fock calculation for these conformations were conducted
with terachem  the     g basis set was employed throughout the calculation to make sure
that the size of error matrices remained the same for all calculations  maximum number
of diis iterations was set to      so the calculation was terminated if not converged within
    steps  finally     different examples were obtained  with    easily converged ones
 within    iterations      slowly converged ones         iterations    and    non converged
ones  for each example  the calculation result was composed of history of total energy
difference between two consecutive iterations ei   diis error matrix for each iteration ei  
and the diis linear p
equation matrix b  which was generated for minimizing the approximated error en     ni ci  ei   with lagrange multiplier method 


 

          

 
   b   b     
  c   
  




   
      


  
      



 
     
  ci     
b

ij



  
  
  
 
 
 
where bij the scalar product of any two error matrices for the last    iterations  bij  
t r ei   e 
j    ei and b were chosen as input features 
a feature vector was generated for every step in each iteration  for the response
variables  steps which were more than n steps from convergence were labeled   and steps
that were n or fewer steps from convergence were labeled as     we used the values
n            to create three sets of response variables 

 

modeling the data

we used the libsvm package    to generate severals svm models for our data  the
quality of the models was assessed by random   fold cross validation of the training set
data 
we had a training set of       trials  the features were  the number of molecular
orbitals used in the model  the e in calculated energy for the previous m steps  the c
 

fivectors and  values for the previous m steps  and the bij values for the previous  m steps
where m ranged from   to     since many of the trials represented steps that were too
early in the calculation to have m or  m previous steps  we treated the calculation as if 
prior to the actual first step  the calculation had simply failed to make any progress  that
is  we set e     and we set the c    and e  which is used to calculate bij   to the values
they have at the first step in the energy calculation 
we used the c svc with a radial kernel
exp  f m  uv     where fm is the number of
number of previous steps number of
features generated from taking the previous
used to form features  m  features fm
m steps into account  in order to evaluate
 
  
the quality of our models  we looked at the
 
  
overall accuracy of prediction  the f score 
 
  
and the area under receiver operating char 
  
acteristic curve  we looked at how feature
 
   
size affected these metric for the three sets
 
   
of response variables we created for different
 
   
convergence distances  for any given fea 
   
ture set and metric we optimized the cost
 
   
c to give the highest value of the metric
  
   
possible 

 

results

figures       and   show the optimal accuracy  f score  and area under roc curve for
feature sets m               
the overall accuracy increases with feature set size  accuracy is also higher when fewer
data points are labeled as near convergence  it is to be expected that steps farther away
from convergence would be more difficult to identify as near convergence  accuracy for
predicting convergence within   steps is very high but this could be due to overfitting  the
same amount of data was used for all the svm models but limiting the allowed distance
from convergence also shrinks the data in the near convergence category 
the area under the roc curve for different convergence distances and feature set sizes
shows two opposite trends  predicting convergence in    steps has a larger area under
curve for larger feature sets but predicting convergence in   or   steps has a smaller area
under curve for larger feature sets  this decrease may also be due to the relative sizes
of the two categories  near convergence and not near convergence  the relative rate
of false positive and true positives is changing there are few true positives to begin with 
increasing training set size would likely help make an upward trend like in the case of
estimating convergence in    steps 
f score increases slightly for predicting convergence in    steps and stays approximately
constant or increases very slightly for the other trials  this may mean precision and recall
are not changing much 

 

fi 

future work

the application of svms to determine whether a diis calculation is likely to converge soon
has been promising  however  there is further work necessary to improve the quality and
ensure the applicability to more generalized problems  a larger number of training samples
would improve prediction quality  additionally  it would be necessary to consider multiple
molecules in order to be able to build an svm which would be more generally applicable
to systems other than benzene  with a large number of different molecules represented 
svms can be generated for other basis sets as well 

references
    pulay  p          improved scf convergence acceleration  j  comput  chem             
    i s  ufimtsev and t j  martinez  quantum chemistry on graphical processing units 
   analytical energy gradients and first principles molecular dynamics  j  chem 
theory comput            p     
    d a  case  t a  darden  t e  cheatham  iii  c l  simmerling  j  wang  r e  duke  r 
luo  r c  walker  w  zhang  k m  merz  b  roberts  s  hayik  a  roitberg  g  seabra 
j  swails  a w  goetz  i  kolossvry  k f  wong  f  paesani  j  vanicek  r m  wolf  j 
liu  x  wu  s r  brozell  t  steinbrecher  h  gohlke  q  cai  x  ye  j  wang  m  j 
hsieh  g  cui  d r  roe  d h  mathews  m g  seetin  r  salomon ferrer  c  sagui  v 
babin  t  luchko  s  gusarov  a  kovalenko  and p a  kollman         amber    
university of california  san francisco 
    chih chung chang and chih jen lin  libsvm   a library for support vector machines 
acm transactions on intelligent systems and technology                      software
available at http   www csie ntu edu tw  cjlin libsvm

 

fifigure    best accuracy for convergence for different m values

figure    best f score for convergence for different m values

 

fifigure    best area under roc curve for convergence for different m values

 

fi