separation of speech from noise challenge
nagachaitanya vellanki
vellanki stanford edu
december         
 

introduction

signals  the snr defined as

the goal of this project is to implement the methods submitted for the pascal chime speech separation and recognition challenge       in particular  estimating the spectrographic mask using svm for missing feature methods      of
noise compensation 

 


snrdb      log  

es l   es r
en l   en r



where l  r refer to the left and right channels and s n are speech
and noise backgrounds  e is the energy which is the sum of
the squared sample amplitudes measured for the speech or
background signals between the start and end points of the
utterance 
the data set also has        files containing     utterances
of each of the    speakers to train acoustic speech models 
these utterances were provided with reverberation but free
of additive noise  additional   hours of background noise
data for train background models  the test set is similar to
the training set      utterances at   different snr     db    
db    db    db    db    db   at    khz  there is no overlap
between the backgrounds of the test set and the noisy background data  under the challenge guidlines  models should
not take advantage of the snr labels and should not exploit the fact that same utterances are used at different
snr 

chime

the main task in the chime challenge is to recognise the
letter and digit in each noisy utterance the dataset consists
of utterances of simple sentences by    speakers     male
and    female  in a domestic environment in the presence
of noise sources of a typical family home  two adults and
two children  tv  footsteps  electronic gadgets laptops and
game console   toys  some traffic noise from outside and
noises arriving from a kitchen via connecting hallway  the
recordings were made using a mannequin with built in
left and right ear simulators that record signals that are an
approximation of the acoustic signals that would be received
by the ears of an average adult listener  the sentences consist
of simple six word commands of the following form 

 

command format 
  command    color  preposition  letter  number  adverb 
where each word can have the following alternatives 
fi
fi
fi
 command   bin fi lay fi placefiset 
fi
fi
fi
 colour   blue fi green fi red fi white 
fi
fi
fi
 prep   at fi by fi in fi with 
fi fi fi
fi
fi fi fi fi
 letter   a fi b fi c fi     fi u fi v fi x fi y fi z 
fi
fi
fi
fi
 number   zero fi one fi two     seven fi eight fi nine 
fi
fi
fi
 adverb   again fi now fi please fi soon 

representing data using spectrograms

the methods used in this project operate on log mel spectrograms  of the utterances  these log mel features are computed from wav files using hcopy of the htk toolkit with
targetkind is set to fbank    the log mel spectrograms of speaker    for command  lay blue in t four again
are shown in figure      and  

example commands 
lay blue by h five again
lay blue in t four again
figure    command with a childs voice in background at  
db snr

the training data consists of      stereo    bit wav
files      utterances at   different snr     db     db    db 
  db    db    db   at    khz or    khz  each wav file
contains a single noisy utterance  the noise background can
have multiple sources but not more than   active sources at
a time  the speech and noise backgrounds are two channel

  a spectrogram is a two dimensional representation of a speech signal 
in spectrogram time is displayed on x axis and the frequency on y axis  each
time frequency location in the spectrogram represents the power of the signal  in log mel spectrogram  time is displayed on x axis and logarithm of the
output of kth mel filter on y axis  see section     of      for more details on
spectrogram and variants

  http   spandh dcs shef ac uk projects chime 
challenge html

 

fivided in training set  these oracle masks will be used to provide reliability labels for the features of the svm classifier 
   

subband energy to subband noise floor ratio  subband
energy to fullband noise floor ratio  flatness  subband
energy to full band energy ratio  kurtosis  spectralsubtraction based snr estimate are used as the features for
the classifier  missing eature methods do not make any assumptions about the nature of the corrupting noise so the
mask estimation process should also be be free of assumptions about the noise  the above features make minimal assumptions about the background noise and rely only on the
characteristics of the speech signal  the details of the features
will be described here briefly  refer to         more details  

figure    command with no background noise

figure    background noise at   db snr

 

spectrographic mask estimation

     

spectrographic mask estimation methods divide the observed
log mel spectral features into speech  noise dominated regions  the speech dominated time frequency components
of are considered reliable estimates of clean speech  s t f 
is the clean speech that could have been observed if the
signal was not corrupted with noise  the noise dominated
time frequency components n t f  are considered unreliable 
they only provide a upper bound on the speech values    
n  t  f    s t  f    we can see that clean speech information is missing in unreliable components  the spectrographic
masks are used in missing feature methods of noise compensation for speech recognition in order to identify unreliable components  missing feature methods were shown to
be very successful at compensating noise when the spectrographic mask labeling every time frequency location as reliable or unreliable is known          in missing feature methods the recognition is then performed using the reliable components or by reconstructing the unreliable components prior
to the recognition 
   

     

subband energy to subband noise floor ratio

noise floor of a the noise corrupted speech signal is useful
for estimating the snr  the energies of all frames of an subband are put into a histogram and the lower peak is found 
the energy bin in the histogram corresponding to this peak
value is considered as noise floor  the ratio of the energy
of a subband of a frame to the noise floor in the subband
will help determine that a specific spectrographic location has
been corrupted by noise 
     

subband energy to fullband noise floor ratio

the energies of all frames of an utterance are put in a histogram and the lower energy peak is found  the energy bin
in the histogram corresponding to this peak value is the noise
floor of the noisy speech signal  the ratio of the energy of a
subband of a frame to the noise floor of the noisy speech signal will help determine that a specific spectrographic location
has been corrupted by noise 

the oracle mask     can be constructed by comparing the
log mel spectral features of the clean speech s with the added
noise n  the reliability of time frequency cell is given by    
  de f
    reliable

subband energy to full band energy ratio

subband energy to full band energy ratio is the log ratio of
the energy in subband to the overall frame energy  as background noise is added to speech  the spectral shape changes
as a function of the spectral characteristics of the noise  subband energy to full band energy ratio is a measure of the effect of background noise on a particular subband and on the
overall frame 

oracle mask

m  k  j   

feature for the svm

s k j   n  k j   

de f

    unreliable

     

where k is the frequency band  j is the time frame and     
db is the fixed mask threshold 
the oracle masks were computed for all utterances across

spectral subtraction based snr estimate

the snr estimate used to compute the oracle masks  including snr estimation was shown to provide improvement over
baseline recognition in      
     

flatness

flatness is the variance of subband energy in a neighborhood of spectrographic locations around a given pixel  noisecorrupted spectrographic locations have a lower variance than
cleaner ones  flatness is given by the following equation

figure    oracle mask with a threshold of    db snr  black
regions in the mask denote unreliable features

 f lat  n  i    

snrs using the clean speech  background noise files pro 

  i    n   
  s  j  k    s  n  i    
  k 
i   j   n  

fifor a      neighborhood of pixels where s n  i   represents
the subband energy of frame n and subband i   and s  n  i  
is the mean of the subband energy values in      neighborhood around frame n and i
     

kurtosis

kurtosis is defined as
kx  

e  x   
  e  x     

where the expectations are calculated for each subband 
   

figure       db snr

svm mask estimation

an svm classifier is trained for each of the f     melfrequency bands for each of the    speakers using libsvm
    on      frames randomly extracted from the utterances
of the particular speaker in the training set across different
snr     db     db    db    db    db    db    with a total
of        models  reliability labels used in training were
derived from the oracle mask of the utterances obtained from
the clean speech and background noise data  each classifier
used the same set of single frame based features subband
energy to subband noise floor ratio  subband energy to fullband noise floor ratio  flatness  subband energy to full
band energy ratio  kurtosis  spectral subtraction based
snr estimate features derived from the noisy mel features
along with the noise mel features  the features were normalized to mean   and variance   before training the svm  the
svm was trained using the rbf kernel and the hyperparameters c   were chosen using grid search in a  a where
a                                            by doing a   fold
cross validation on additional held out     frames  this setup
was used in     for svm mask estimation  each model was
tested on      additional held out frames in the training set 
the results for each of the        model were captured  only
results for the speaker        on some randomly selected utterances will be described in this report and the results for rest
of the speakers will be handed in along with the report  the
svm estimated masks were obtained by testing the above
trained models on utterances at snr     db     db    db 
  db    db    db  figure       svm estimated masks at
different snr along with the oracle mask of threshold at
   db snr for speaker     command  lay blue by h  
again

figure      db snr

figure      db snr

figure      db snr

 

evaluation and experiments

the performance of the mask estimated by the svm classifier
can be evaluated in two ways
   the classification accuracy of the estimated mask compared to the oracle mask 

figure       db snr

   the improvement in recognition accuracy achieved by
 

fifigure       db snr

figure     classification accuracy for speaker     command  lay blue by h   again at snr     db     db    db 
  db    db    db 

using the classifier generated masks in missing feature
methods 
in this project the performance of the mask estimated by the
classifier is evaluated by comparing it to the oracle mask as
described in      
   

   
     

evaluation

there are two types of errors the classifier can make miss
and false alarm  a miss can be defined as incorrect labeling of unreliable spectrographic location as reliable and false
alarm as incorrect labeling of a reliable spectrographic location as unreliable  similarly  there are two types of correct
identifications the classifier can make  hit and correct rejection a hit can be defined as correct labeling of a unreliable spectrographic location and correct rejection as correct
labeling of a reliable spectrographic location  the classifier
is considered optimal if it maximizes hits and minimizes false
alarms  as seen in figure     the classifier clearly needs more
information to correctly identify reliable spectrographic locations as snr information cannot be used in the models  further experimentation can be done by adding additional features like harmonic      aperiodic part of the harmonic decomposition       long term energy estimate      gain factor
     vad       comb filter ratio          autocorrelation peak
ratio         to the classifier and also by including neighboring n  n features around a spectrographic location as there
is some correlation between a reliable spectrographic location
and its neighbors     

experiments
varying training set size

the classifier was trained training set with varying training
set sizes from      to       in steps of      for speaker
    command  lay blue in t   again at   db snr and the
masks were obtained for each training set size  there was
little improvement in the accuracy but the original problem
of correctly identifying reliable and unreliable spectrographic
locations remained 

figure     mask obtained after training with       frames
and tested with speaker     command  lay blue in t   again
at   db snr

     

spectral based subtraction snr estimate as feature

the classifier was trained without  with the spectralsubtraction based snr estimate feature to see the improvement in classification accuracy 
the classification accuracy improved when snr estimate was one of
the feature as stated in      
this experiment also
shows that the classification accuracy is not exclusively
controlled by the snr estimate as shown in table   

figure     percentage hit  miss  false alarm  correct rejection for speaker     command  lay blue by h   again at snr
    db     db    db    db    db    db 

 

fitable    classification accuracy of svm for speaker    
across    mel frequency bands
without snr estimate
train
test
 
   
     
 
     
     
 
     
     
 
     
    
 
     
    
 
     
     
 
     
     
 
     
     
 
     
     
        
     
        
     
        
     
        
     
        
     
        
  
        
     
        
     
        
     
        
     
        
     
        
     
        
     
        
     
        
     
        
     
        
    

 

explaining about extracting training data for the svm classifier using the log mel features and reliablity labels from the
oracle mask  his thesis      has been very useful in understanding the details of the mask estimation process 

with snr estimate
train
test
     
    
     
     
     
     
     
     
     
     
     
     
     
     
     
    
     
     
     
     
     
    
     
     
     
     
     
     
     
     
     
     
     
    
     
    
     
     
     
     
     
     
     
     
     
    
     
     
     
     
     
     

 

    the pascal chime speech separation and recognition challenge
       by j barker  h christensen  n ma  p green  e vincent 
    kallasjoki  h   keronen  s   brown  g  j   gemmeke  j  f  
remes  u   palomaki  k  j         mask estimation and sparse
imputation for missing data speech recognition in multisource
reverberant environments  in  proc   st int  workshop on machine
listening in multisource environments  chime   pp       
    j  gemmeke  b  cranen  and l  ten bosch  on the relation between statistical properties of spectrographic masks and recognition
accuracy  in sppra              pp         
    jort f gemmeke  b cranen        tr     state dependent oracle masks for improved dynamical features
http   arxiv org abs          
    christophe cerisara  sebastien demange  and jean paul haton 
on noise masking for automatic missing data speech recognition 
a survey and discussion comput  speech lang   vol      no     pp 
            
    h  van hamme  robust speech recognition using cepstral
domain missing data techniques and noisy masks  in proc  icassp 
montreal quebec  canada  may       pp         
    m  seltzer  b  raj  and r  stern  a bayesian classifier for spectrographic mask estimation for missing feature speech recognition 
speech communication  vol      no     pp               
    c  chang and c  lin  libsvm  a library for support vector machines         online   available  http   citeseerx ist 
psu edu viewdoc summary doi               
    van hamme  h     handling time derivative features in a
missing data framework for robust automatic speech recognition  acoustics  speech and signal processing        icassp
     proceedings       ieee international conference on   vol   
no   pp i        may      
     van hamme  h   robust speech recognition using missing
feature theory in the cepstral or lda domain  proc  eurospeech 
geneva  sept        pp            
     voicebox  speech processing toolbox for matlab 
http   www ee ic ac uk hp staff dmb voicebox 
voicebox html
     m  l  seltzer  automatic detection of corrupted speech
features for robust speech recognition  masters thesis  department of electrical and computer engineering  carnegie mellon
university  may      
     vizinho  a   green  p   cooke  m   josifovski  l         missing data theory  spectral subtraction and signal to noise estimation
for robust asr  an integratedstudy  proc eurospeech   
     j  ramrez  j  gorriz  j  segura  c  puntonet  and a  rubio 
speech non speech discrimination based on contextual information
integrated bispectrum lrt  in ieee signal processing letters  vol 
    no           pp         
     m  p  cooke  p  d  green  l  josifovski  and a  vizinho 
robust automatic speech recognition with missing and unreliable
acoustic data  speech commun   vol      pp              
     raj  b   reconstruction of incomplete spectrograms for
robust speech recognition  ph d dissertation  carnegie mellon
university  may      

future work
   converting features from log spectra to cepstral domain 
since log spectra and cepstra are related by a linear
transform  a solution for converting from log spectra to
cepstral domain has been described in      
   add additional features like harmonic      aperiodic
part of the harmonic decomposition       long term energy estimate      gain factor      vad       comb filter
ratio          autocorrelation peak ratio         in the
classifier
   use the spectrographic mask obtained using the svm
classifier in missing feature compensation methods of
speech recognition and run the baseline recognizer system to compare the results with submissions

 

acknowledgements

i would like to thank andrew maas    stanford university for
this project suggestion and for helping through the project 
jort florent gemmeke    esat psi speech group  ku leuven  belgium for providing mdt tools package to understand the mask estimation process  special thanks to mike
seltzer    speech technology group  microsoft research for
  http   ai stanford edu 

references

amaas 

  http   www amadana nl 
  http   research microsoft com en us people 
mseltzer 

 

fi