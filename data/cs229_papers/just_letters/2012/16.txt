deep learning for wireless interference
segmentation and prediction
sandeep chinchali
csandeep stanford edu

sameep tandon
sameep stanford edu

abstract
the proliferation of wireless devices ranging from smartphones to medical implants has led to unprecedented levels of interference in shared  unlicensed spectrum  modern devices face the challenging task of estimating such interfering
signals from received transmissions in order to effectively cancel interference in
analog circuitry  in an effort to solve this problem  we use deep learning to segment corrupted wireless transmissions into a desired signal of interest and interference estimate  we exploit cyclostationary repeating patterns unique to manmade
wireless signals to extract sparse feature representations of signals using autoencoders and k means clustering  we then train neural networks and linear models to
predict wireless interference from received signals  our results indicate that neural networks and linear models trained with features extracted from deep learning
are extremely effective at predicting interference  allowing upto about an   db
gain in signal to noise ratio  snr   further  our neural network architecture is
much more robust than conventional schemes such as adaptive filtering with the
least means squares  lms  algorithm  which rely on accurate estimates of interference  we demonstrate our results on synthetic traces of wireless interference
and experiments from signal generator traces 

 

introduction

as wireless communication becomes ubiquitous  a plethora of devices ranging from smartphones to
medical implants are increasingly competing for use of unlicensed spectrum  radios on these devices interfere with each other  limiting the real world throughput and capacity of todays networks 
to cope with this challenge  wireless devices must estimate the nature of interference and predict
future time samples to cancel unwanted components of a corrupted received signal 
if not accounted for  interference can lead to corruption of data that leads to unnecessary retransmission of corrupted packets  since this results in a degradation of network performance  solving the
problem of wireless interference prediction will yield networks with robust performance even while
multiple devices contend for limited  shared spectrum 
solving the wireless interference problem is challenging because a wireless signal can be corrupted
by a variety of other ambient wireless signals  such as bluetooth  wi fi  or long term evolution
 lte  protocol transmissions  these signals can be further attenuated by the environment  such as
walls and obstacles  the net randomness can make determining wireless interference a challenging
endeavor  at the same time  wireless signals may exhibit specific periodic structure and cyclostationary features      modern wireless architectures have not fully realized the potential of utilizing
this data to segment and predict wireless interference 
we present a data driven approach to predicting and segmenting wireless signal interference  we
use deep learning and stacked autoencoders to extract key features of wireless signals  then  we
use these learned features in neural networks to predict future time samples of wireless signals 
we also use neural networks for segmentation in order to separate a composite corrupted signal
 

fiinto a signal of interest and ambient interference  to demonstrate the efficacy of our approach  we
show our segmentation results lead to significant gains in signal to noise ratio  snr  compared to
conventional techniques such as adaptive filtering with the least means squares  lms  algorithm 

 

related work

prior research in the stanford networked systems group has led to degrees of freedom  dof   an
algorithm that identifies cyclostationary repeating patterns in manmade wireless signals to classify
interference as belonging to wifi  zigbee  or bluetooth protocols      support vector machines
 svms  were trained to classify signals  however  the full potential of this work to forecast future
interference samples guided by knowledge of signal type has not been realized 
in      lee et  al use convolutional deep belief networks for audio classification by learning features
for a spectogram of various musical and speech time series  in a similar vein to our goal of wireless
signal segmentation  kolter et  al use discriminative sparse coding to segment an aggregate energy
usage profile into the usage data of different appliances      our work differs from     since it
addresses time sample prediction while it differs from     since we use neural networks and deep
learning for wireless interference estimation 

 

methods

interference segmentation and prediction may be cast in the standard learning framework  formally 
let x    xt   xt             xt n     and y    yt   yt             yt n     be a vector of n contiguous samples of the composite and interference signals respectively  the composite signal x is the summation
of the desired signal of interest s  the interference signal y  and additive gaussian noise n  we denote the protocol associated with the interference by a subscript so the composite measurement of a
wifi packet corrupted with zigbee interference is given by x   swifi   yzig   n 
for segmentation  the goal is to predict the current interference y given the current composite signal x  for prediction  the goal is to predict the future interference given the current
composite signal x  formally  we will overload notation and denote the future interference as
y    yt n   yt n              yt  n      the disambiguation of notation depends on the problem being solved  e g  segmentation or prediction   we obtain samples  x i    y i    to generate a training
and testing data set from a matlab synthetic packet generator script and lab experiments 
   

interference segmentation and prediction

at a high level  our system performs the following steps 
   preprocess the data using a pca whitening scheme 
   execute an unsupervised learning algorithm to learn a sparse feature representation
   train a learning algorithm to predict interference 
     

preprocessing

the data is preprocessed using pca whitening  first  each x i  is normalized by subtracting off
the mean  we then run pca on the entire data set  removing dimensions with variance less than
a specified threshold  in practice  we found that the threshold did not matter much  the resulting
dimensionality reduced data is fed into an unsupervised learning algorithm 
     

unsupervised learning algorithms

we evaluated two unsupervised learning algorithms for learning a sparse feature vector representation  k means and sparse autoencoders  these algorithms were chosen because of their success in
practice  e g      
formally  denote the feature vector as f  x    rn   rk where x is the input after preprocessing 
 

fiin brief  k means clustering is an iterative algorithm that finds k centroids and assigns each data
point x i  to a cluster ck   k              k  the corresponding sparse feature representation is
fk  x i        x i  assigned to cluster k   since this feature representation is overly sparse  a soft
k means assignment is used      in particular  this representation is
fk  x    max     d 
where dk   kx ck k and  d   

 
k

pk

i   zk  

dk  

in practice  this representation is typically half sparse 

the second algorithm we use is a sparse autoencoder with k hidden units  this algorithm learns
weights w   rkn   biases b   rn   such that f  x i      g w x i    b  where g is a sigmoid
function  the autoencoder has a reconstruction term  using the feature vector representation  to
reconstruct the input and a sparsity target term on the feature vector  if the number of hidden units
is small  the autoencoder will try to learn a sparse  dimensionality reduced representation  using the
underlying structure of the data     
     

supervised learning step

using the feature representation  we considered two supervised learning algorithms  linear regression and feedforward neural networks  these algorithms were trained using input f  x i    and output
y  i    as noted above  y  i  is the observed interference for the segmentation problem or the future
observed interference for the prediction problem 
   

adaptive filtering  least mean squares

as a baseline comparison for our segmentation approach  we explored the conventional technique
of adaptive filtering  adaptive filtering uses the least means square  lms  filter for adaptive noise
cancellation  anc       in adaptive filtering  a corrupted signal x is input to the lms filter along
with a reference interference signal yref which may differ from the actual interference y  the lms
filter adjusts its impulse response via the widroff huff learning rule discussed in class to estimate
the actual interference y that corrupts the signal of interest 

 
   

experiments
validation with synthetic data

to generate synthetic data  we built upon starter matlab code from the stanford networked systems
group which generates wifi and zigbee protocol packets at various channels  frequencies   we
then attenuate the desired wifi packet by a factor  with respect to the zigbee interference and
corrupt the interference with low power additive gaussian noise n to generate a composite signal
x   swifi   yzig   n  signal parameters are given for the experiments detailed in figure    each
training and test example consisted of n      consecutive time samples  sampled at     mhz for
synthetic data   an amount m        training examples of size n were randomly selected from
the first half of the full composite signal x and interference time series y  the second half of the
time series was reserved for testing data 
   

measuring interference for training data

to obtain real traces of wireless interference  we used a signal generator to create a signal of interest
at a specified amplitude such as an   dbm bluetooth trace at a     ghz center frequency  we
simultaneously used another signal generator to create an interfering signal such as an   dbm wifi
trace  the signal of interest and interfering packet were added using a signal combiner and the
resulting composite waveform was sampled at   m hz  though we measured the composite signal
directly  we could not simultaneously measure the signal of interest since we only had one spectrum
analyzer  hence  we followed the same approach as for the synthetic data of artificially combining
a signal and interferer  except in these cases the signals were real packets from a signal generator 
 

fiactual interference
linear model
sparse autoencoder with ffnn
kmeans with ffnn
adaptive filtering

   

actual interference
linear model
sparse autoencoder with ffnn
kmeans with ffnn
adaptive filtering

   

   

   
   
   
   

 

 

   
   
   
   
   
   

     

   

 

     

    

     

    

     

    

    

    

    

    

    

 

x   

figure    left  comparison of various schemes for estimation on synthetic data corresponding to
experiment in col   of figure    the zigbee interference is estimated well by all schemes except
conventional lms since it is provided a reference at a different channel compared to the actual
interference  right  all schemes work worse with real data since it is more erratic and noisy  the
plots correspond to col   of figure   
   

results

each column of table   indicates a specific interference experiment  columns             and  
combined synthetic data packets while columns   and   correspond to packets measured on a signal
generator that were artificially combined in matlab  the autoencoders and all neural networks were
trained for      epochs  which was ample time for convergence  the autoencoder and neural network training and setup was done with the matlab deep learning toolbox      for each interference
experiment  we compared the performance of the following models 
   k means nn  k means with k      centroids is used in feature selection for a neural network  nn  with   hidden layer of    units 
   sae nn  an autoencoder with    units was used for feature selection and then a neural
network with   hidden layer of    units was used to refine the weights 
   lm  linear regression using pca whitened data 
   lms  least means square  lms  filter predicts the interference given a reference signal 
to compare the efficacy of various models  we compute the signal to noise ratio  snr  in decibels
 db   for segmentation problems  the snr is computed as the true signal vs the segmented signal
 composite minus interference  and for prediction problems  the snr is computed as the predicted
interference vs the actual interference  we also report the snr for the case when the composite
signal is stored without any cancellation as a baseline  clearly  the linear model outperformed the
others while the neural network approaches performed similarly  in nearly all cases  all models
provided significant snr improvement over the case when no cancellation was done  we see that
lms filtering performs badly since it is not robust to errors in reference selection  for example 
when the reference estimate of the interference is of the correct protocol but at a wrong channel 
adaptive filtering is quite off while the other schemes still predict interference well 

 

conclusion

overall  our experiments illustrate that simple linear models operating on data pre processed with
pca are extremely useful for predicting interference followed by neural networks trained on features selected by k means and stacked autoencoders  the results are promising since these methods
worked with actual signals measured in the lab and provided extremely large snr gains compared
to the case when no cancellation or adaptive lms filtering were enacted  further validation comes
from the observation that linear fitting and neural networks performed better than conventional lms
filtering because the adaptive filter needs an accurate interference reference  in many wireless coexistence scenarios    db gains from cancellation are considered quite large  since we significantly
 

fiactual interference
linear model
sparse autoencoder with ffnn
kmeans with ffnn

   

   

actual interference
linear model
sparse autoencoder with ffnn
kmeans with ffnn

   

   
   
   
   
   
 
 
   
   
   
   
   
   

   
    

     

 

     

    

     

    

    

    

    

    

    

    

 

x   

figure    left  comparison of various schemes for prediction on synthetic data corresponding to
experiment in col   of figure    right  all schemes work worse with real data since it is more
erratic and noisy  the plots correspond to col   of figure   
method
s 
s  
s 
s 
p 
p 
p 
k means nn     
    
    
                    
sae nn
    
    
                          
lm
    
    
    
                    
anc
                         



figure    results  reported are snr  db  results for  s egmentation and  p rediction tests  for
segmentation problems  the snr is computed as the true signal vs the segmented signal and for
prediction problems  the snr is computed as the predicted interference vs the actual interference 
the number represents the wifi channel evaluated on  hence s  corresponds to segmentation test
on wifi channel     s   is an example of a poor reference provided for anc  for all the tests  the
linear model performs the best  followed by the neural networks  and trailed by anc 
pass this threshold in many experiments  our work may be incorporated into an actual cancellation circuit which could pass the interference estimate from a neural network or linear model to an
adaptive filter for further refinement in a two stage pipeline 
without doubt  societys insatiable demand for wireless connectivity will make current challenges
for wireless coexistence and interference management more acute  our work illustrates that machine
learning techniques can serve an integral role in a holistic solution for interference cancellation that
will hopefully bring us closer to realizing ideal  cooperative wireless devices 

 

acknowledgements

we thank professor sachin katti  kiran joshi  and dinesh bharadia from the snsg lab for advice 

references
    unsupervised learning and deep learning tutorial  http   ufldl stanford edu wiki        
    adam coates  andrew y  ng  and honglak lee  an analysis of single layer networks in unsupervised feature learning  journal of machine learning research                  
    s  hong and s  katti  dof  a local wireless information plane  in acm sigcomm       
    j z  kolter  s  batra  and a y  ng  energy disaggregation via discriminative sparse coding  in
neural information processing systems       
    h  lee  y  largman  p  pham  and a y  ng  unsupervised feature learning for audio classification using convolutional deep belief networks  nips                    
    b  widrow  j r  glover  jr   j m  mccool  j  kaunitz  c s  williams  r h  hearn  j r  zeidler 
jr  e  dong  and r c  goodlin  adaptive noise cancelling  principles and applications  in
proceedings of the ieee                    december      
 

fi