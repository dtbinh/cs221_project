classifying substance abuse among young teens
dylan rhodes  sunet  dylanr
december         

abstract

this project attempts to use machine learning to classify substance abuse among young
teens  it makes use of a dataset published by the substance abuse and mental health data
archive for open use and analysis  the dataset comprises a nationally representative sample of
     american schoolchildren with the results of a questionnaire posing topics such as home life 
eating habits  family structure  hobbies  personality attitude  school life  bullying  and physical
activity as well as the use of alcohol  tobacco  marijuana  and other controlled substances  over
the course of the project so far  three machine learning algorithms were trained  tested  and
compared  logistic regression  unweighted linear regression  and a kernelized support vector
machine  as a baseline  the naive classier  which always predicts     no substance abuse   was
compared to the three algorithms  ultimately  the kernelized support vector machine displayed
slightly higher classication accuracy with properly tuned parameters  but logistic regression
oered similar results with a lower time complexity 

 

introduction

as previously stated  the goal of this project was to use lifestyle factors to predict substance abuse
among young teens 

this is an important task for several  fairly obvious reasons 

first  early

substance use  besides being objectively undesirable in and of itself  has been shown to indicate
problems later in life including delinquent behavior and later abuse        second  another objective
of the project was to identify the factors most strongly correlated with substance use  both negatively and positively   which could be used to develop more eective programs aimed at discouraging
substance use 
there has been a fair amount of research on this problem spanning several decades  including
several statistical and machine learning based studies 

in general  they have conrmed that a

number of personality characteristics and environmental inuences are predictive of early initiation
to alcohol and other substances and high intensity of use 

in particular  several have concluded

that individual attitude characteristics and quality of parental relationships are some of the most
highly indicative factors for early onset substance use         over the course of this project  factor
analysis was used to examine and verify these claims 
several challenges are immediately apparent when considering this problem  however  first  the
dataset is fairly skewed towards non use  especially for  harder  drugs  to overcome this issue  it
was decided to restrict predictions to use of alcohol  tobacco  and marijuana  all of which had a
signicant population of users         second  it is obvious that substance use does not stem from
a single  or even specic combination of several  factors  this makes use hard to predict  as it is
a fairly complex problem  with psychological and environmental components  however  judging by
the correlations exhibited by other studies  and the large number of features in the dataset      
per participant  as well as their large range of topics  i hoped to achieve some greater degree of
accuracy than a naive classier 

 

fi 

approach

during the project  three methods were tested and compared with the baseline method  naive
classication  all of the approaches were basic machine learning algorithms including logistic regression  unweighted linear regression  and kernelized support vector machines  they were chosen
for inclusion for various reasons 
unweighted linear regression is a simple algorithm with a closed form solution  it is a simple
maximum likelihood based estimator which can be run very quickly  with a time complexity of

o mn   

and space complexity of

o mn 

where

m

is the number of training examples and

n

is

the length of the feature vector  it was chosen to contrast with the other two algorithms in both
simplicity and low space and time complexity and expected to perform poorly as a result 
logistic regression is also a maximum likelihood estimator with uses the sigmoid function as a
probability distribution 
where

m

and

n

it has a time complexity of

are as dened above and

k

o mnk 

and a space complexity of

is the number of iterations  for this project 

o mn 
k      

which was chosen as both a reasonable choice for convergence and to put the runtime in between
linear regression and the support vector machine 

it was chosen as an algorithm of mid range

simplicity and complexity 
finally  a kernelized support vector machine  svm  was evaluated against the other two algorithms  svm s use hinge loss to maximize the margin between a high dimensional decision boundary
and the examples on both sides closest to it  svm s can expand the feature vector into higher dimensions using kernels  which are a set of functions that compactly represent the dot product of
two transformed vectors ie 

k  x   z      x     z 

for some function

 

the space and time com 

plexity of the svm depends on the kernel chosen  but in general  both are higher than the space
and time complexity of the other two algorithms  the svm was chosen as the most complicated
and hopefully accurate algorithm 

 

experiments

for the experiments  the three algorithms were all trained over a randomized sample of     of the
dataset and tested on the remaining      a binary vector was extracted from the dataset with
   values indicating no use of the substance and    values indicating use for alcohol  tobacco  and
marijuana  initially  the feature vector included the responses to all     questions on the survey
excluding those for direct use of the substances  unfortunately  this produced a      successful
classication rate over the dataset  due to the inclusion of several  directly correlated features   for
example  use over the past month   which made the classier s job far too simple  thus  feature
analysis was performed on the survey  and    questions which were directly related to substances
were removed from the dataset  leaving     features to use for classication  these features were
organized into the categories of demographics  computer usage  auence  living arrangements  physical activity  nutrition  body image  hygiene  physical and mental health  interpersonal relationships 
school activity  bullying  and parents  occupations 
after the feature vector had been trimmed  linear and logistic regression were run over the
dataset  producing the following results  to see the code  please read the attached les  
baseline results 

true pos 

false pos 

true neg 

false neg 

accuracy

marijuana

 

 

    

   

       

alcohol

 

 

    

   

       

tobacco

 

 

    

   

       

linear regression 

true pos 

false pos 

true neg 

false neg 

accuracy

marijuana

   

    

   

 

       

alcohol

   

    

   

 

       

tobacco

   

    

   

 

       

 

filogistic regression 

true pos 

false pos 

true neg 

false neg 

accuracy

marijuana

   

  

    

   

       

alcohol

   

  

    

   

       

tobacco

   

   

    

   

       

as you can see  the results of linear regression were fairly dismal  while logistic regression
managed to outscore the baseline in all cases by around      

its runtime  however  was fairly

longer  as expected 
to further analyze the results of linear regression  it is clear that the classier was skewed towards
a positive prediction  had i wanted to further optimize the performance of this algorithm  i could
have transformed the dataset into a more symmetric form and rerun the algorithm  however  the
linear regression algorithm was not really my focus  more a yardstick for the performance of the
other two  so i moved on 
logistic regression produced a well trained classier  in the end  it turned out to have nearly
the accuracy of the svm with tuned hyperparameters  moreover  the algorithm had a signicantly
shorter runtime than the svm with the chosen number of iterations  had i wanted to optimize
its performance further  i could have increased the number of iterations and analyzed the training
dataset to remove outliers  the theta vector was also analyzed for the features with the highest
weights  corresponding to the features with the highest correlation for or against substance abuse 
this list broadly conrmed the ndings of other  similar studies in terms of most important risk
factors  the full analysis is in the conclusion 
finally  the svm was run against the training data  the libsvm library version      was used
to both train the model and test it over the test set 

the data was output from matlab into a

libsvm compatible format and the algorithm was run in the shell  initially  no hyperparameters
or optimization techniques were used to provide a baseline for further optimization 

  svm train trainingdata model
  svm predict testingdata model output
marijuana accuracy

alcohol accuracy

tobacco accuracy

       

       

       

initial svm results 

as you may notice  these results are identical to those of the naive classier  indicating that
the model always predicted    

obviously  this was an overtting of the skewed data  so it was

decided to scale the feature vector in order to reduce variance  then  the test was run again  with
the following results 

  svm scale  s scale params trainingdata   scaletrainingdata
  svm scale  r scale params testingdata   scaletestingdata
  svm train scaletrainingdata scalemodel
  svm predict scaletestingdata scalemodel scaleoutput
scaled data svm results 

marijuana accuracy

alcohol accuracy

tobacco accuracy

       

       

        

at this point  several options for optimization manifested themselves  first  there were several
kernels to train and test the dataset on  second  from the output le it was clear that the model
was still skewed towards a    prediction  so another idea for optimization was to weight the   
examples more heavily than the    using a weight hyperparameter  finally  once kernels had been
selected  there were additional hyperparameters to optimize for each 
to examine the eect of dierent kernels  the svm was run again with linear  polynomial  of
degree     sigmoid  and radial basis function kernels  in the interest of time  it was decided to select
the two highest performing kernels for further optimization  which turned out to be the linear and
radial basis function kernels 
next  the hyperparameters of each kernel were tuned to optimize accuracy  the linear function
takes a cost parameter and the radial basis function kernel takes both a cost parameter and a

 

figamma value  using an exponentially growing test for the linear cost and a an exponential grid
search to optimize radial basis function cost and gamma  the optimal values of each were ascertained 
unfortunately  there is not room in my writeup to include all of these gures  but ultimately  the

c      while the optimal parameters for the radial basis
c                   these parameters turned out to be optimal for

optimal cost for the linear kernel stood at
function were determined to be

 

all three datasets  strangely  but likely because they were fairly similar 
finally  in recognition of the remaining skew towards a positive prediction  the weight values
were optimized for both kernels  binary search over the    to    range weighing the    to the   
values converged on the optimal weight value for each dataset  which did dier between the three
substances  ultimately  the following optimal accuracies were produced  including each algorithm 
marijuana accuracy

alcohol accuracy

tobacco accuracy
       

linear svm

       

       

optimal weight

   

    

    

radial basis function svm

       

       

       

optimal weight

   

    

    

logistic regression

       

       

       

linear regression

       

       

       

baseline

       

       

       

as you can see  the tuned linear kernel turned out to be the most eective algorithm overall 
although its performance was narrowly exceeded by the logistic regression algorithm when predicting
alcohol use  interestingly  the optimal    weight parameter for the alcohol use dataset for the linear
kernel turned out to be less than    which was unexpected  due to the preponderance of    examples 

 

conclusion

overall  the results of the project were somewhat disappointing  although somewhat informative 
the best algorithm did clearly exceed the baseline test  but not by an enormous margin  it is likely
that the complexity of the social problem examined  substance abuse  lends itself to a dicult
prediction  since it would seem more than possible for two teens with the same lifestyle habits
to make individual choices whether or not to abuse a substance 

however  the relative success

of the algorithm over the baseline illustrates that lifestyle features are correlated with substance
abuse in teens in some way  which supports the existing literature 

in particular  to return to

the analysis of the results of the logistic regression  the highest common risk factors of the three
substances consisted of more friends using substances  older age  and separation of parents  while
the factors most correlated to lack of abuse consisted of asian heritage  white heritage  living with
one s grandmother  and interestingly  living in foster care  these results conrm those of previous
studies with the exception of the inuence of friends using substances  which previous studies have
claimed to be secondary to personal traits  but which in my analysis turned out to be by far the
most important risk factor for substance abuse    

 

references

references
    marsha e  bates and erich w  labouvie 

adolescent risk factors and the prediction of per 

sistent alcohol and drug use into adulthood  alcoholism  clinical and experimental research 
                   

 

fi    patricia l  dobkin and richard e  tremblay  individual and peer characteristics in predicting
boys  early onset of substance abuse 

a seven year longitudinal study 

child development 

                       
    j d  hawkins  r f  catalano  and j y  miller  risk and protective factors for alcohol and other
drug problems in adolescence and early adulthood  implications for substance abuse prevention 
psychological bulletin                  

    steve sussman  clyde w dent  and linda leu  the one year prospective prediction of substance
abuse and dependence among high risk adolescents  journal of substance abuse            
          

 

fi