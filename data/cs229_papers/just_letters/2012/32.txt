accelerating neuronal genetic research in c  elegans with
computer vision   machine learning
roshni cooper
stanford university
    serra mall  stanford  ca      
rccooper stanford edu

abstract
this final project for cs    implements a software system to classify c  elegans as wild type or mutant based on
biological fluorescence images of synapses  the connections
between neurons and muscles  in the worms  the project
uses features of two neurons in the images  the da  and
da  motorneurons  which were calculated as part of the
cs   a final project  using these features  the software
trains an svm using a radial basis function kernel  the
software was cross validated on over     images with    
accuracy  the input images are very noisy and blurry  so
human accuracy can be as low as      in comparison  the
software is precise 

future distribution permission
the author s  of this report give permission
for this document to be distributed to stanfordaffiliated students taking future courses 
   introduction
     motivation

for the cs   a and cs    final project  i developed software to analyze biological fluorescence images of synapses  the connections between neurons and muscles  in the nematode c 
elegans  synapses appear as lines of dots  with
varying intensity and spacing  figures  a and  b
show images of the da  and da  motorneurons 
which i will be focusing on for this project  each
motorneuron signals to different muscles in the
worm  and together they help the worm move 
the da  synapses are tagged with two fluorescence proteins  gfp  green fluorescence protein 
and mcherry  a red fluorescence protein   when

excited  the green and red fluorophores in the
da  synapses become visible  and the synapses
appear yellow  the da  synapses are tagged only
with one fluorescence protein  so the red dots in
the image represent the da  synapses  figure
 a shows a normal  wild type worm  the yellow and red dots are distinctly separated in this
worm       on the other hand  figure  b shows
a mutant worm  with overlapping da  and da 
synapses  the overlap causes the same muscles
to receive neurotransmitters from two different
motorneurons  these potentially conflicting signals can hamper the movement of the worms 
understanding the genes and biological mechanisms that cause the motorneurons to develop incorrectly  as in in figure  b  can ultimately help
to explain neuromuscular function and diseases 
to perform this genetic research  biologists
image hundreds of individual worms  and then 
based on various visual characteristics of the
synapses  they decide whether the animal is wildtype or mutant  these characteristics include the
intensity of the synapses  the position of synapses 
etc  if the worm is a mutant  its genome is studied
further to learn more about the genetics behind
the nervous system  currently  biologists look at
hundreds of randomly mutagenized worms and
search for mutant animals to set aside  because
the decision is made manually  the process is tedious  subjective  and error prone  hence  i developed software to use computer vision and machine learning to identify the mutant worms  i
focused on identifying animals that have a muta 

fi a 

 b 

 c 

 d 

figure    example input images and corresponding output masks   a  wild type input image   b  mutant input image   c 
wild type output synapse mask   d  mutant output synapse mask 

tion in the gene plx    such as the worm in figure
 b  in the future  this software could be used to
identify other mutants as well 
     problem statement

the project comprises two main tasks     identifying the synapses in an image  and    using the synapses to determine whether the animal
is a wild type or a mutant  part     is a computer vision problem and was implemented for
the cs   a final project  which will be briefly
mentioned in this report  part     has been completed for the cs    final project and will be detailed in this document 
     technical approach overview

to solve the problem of identifying the
synapses  the software first identifies which pixels
belong to the synapses of the da  and da  neurons  then it extracts various features from the
images  such as the length of the synaptic region
or the mean intensity of the synapses  and uses
those features to train an svm using the radial
basis function kernel 

     related work

with advancements in fluorescence imaging in
the last few decades  biological research has become increasing visual  biologists are learning
more and more about  for example  the nervous
system by pouring over countless images  surprisingly  computer vision and machine learning are still largely unused by most biologists
     some such techniques have been applied to
neuronal research  and these approaches involve
using svm to detect synapses in an image  as
in       and using svm and pca to determine
whether the animal is wild type or mutant  as in
    and      these techniques have been shown to
be reliable given a large set of training data 
   technical approach
     synapse extraction

figure   shows a high level block diagram of
the software for synapse extraction portion of the
project  the cs   a project   synapses are found
separately in the red channel  using linear filtering  and the green channel  using k means clustering  the resulting images of the synapses in the
two channels are combined to determine which

fifigure    final project block diagram 

synapses belong to the da  motorneuron and
which belong to da   yielding two mask images
as output  for more details  see the final report
for cs   a      figure   shows two input images   a and  b  with their corresponding output
synapse masks   c and  d  
     image classification
     

features

the first step in performing the image classification is selecting which features to use  this portion of the code uses information from both the
original image and the mask generated in the previous section  the features of interest are shown
in table    each of these features were calculated for four synaptic regions the most obvious
three regions are all of the synapses  both da 
and da    only the da  synapses  and only the
da  synapses  the features were also calculated
for the overlapping region at the border of the
da  and da  synaptic regions  because of variations in worm size  imaging intensity  etc   the
ratios of each of the features from the overlap to
the three first regions were also calculated  for
example  the ratio of totalarea of the overlapping region to totalarea of the red synaptic region was another feature  taking the ratio
helped to normalize the overlap from image to image  giving a better sense of how much overlap
a worms neurons actually exhibited 
once the features were selected  each feature
was scaled to the range         in order to give
each feature equal weighting in the training pro 

cess      the feature scaling was performed on
the entire data set as a whole  since there was no
specific training data versus test data 
the data set  which is described in greater detail in later sections  contained     images  since
   features seemed like a large number of features
given the data set      i tried to reduce the number
of features to avoid any overfitting of the data  i
tried two methods for reducing the number of features  first  i ran cross validation with each feature individually  then i sorted the features based
on accuracy  i e   f    f    f          f      where the
accuracy with fi is greater than the accuracy with
feature fi     next  i ran cross validation with
both  f    f     then with  f    f    f     etc   and kept
adding features  the intention was to stop adding
features when the accuracy of the cross validation
was no longer increasing  adding features kept
increasing the accuracy  though  so i tried another
method of feature reduction  instead of sorting
the features based on the cross validation accuracy they yielded  i sorted them based on the variance of the feature vector  again  adding more
features into the mix only improved the accuracy 
so i kept all    features for training the svm 
     

model parameters

the svm to classify the images was created using libsvm     and liblinear      the linear
and polynomial kernels yielded worse accuracy
than the radial bias function kernel  essentially a
gaussian kernel   furthermore  it has been shown
that the rbf kernel can emulate the performance

fifeature
num
totalarea
meanarea
totalintensity
meanintensity
len

description
number of synapses
total area occupied
by synapses
mean area occupied
per synapse
total intensity
of all synapses
mean intensity per pixel
of all synapses
distance between
terminal synapses

calculated on     
output mask
output mask

using      
matlabs bwlabel
matlabs regionpropss area property

output mask

totalarea divided by num

input image  
output mask
input image  
output mask
output mask

matlabs regionpropss meanintensity
property multiplied by num
totalintensity divided by totalarea
euclidean distance between leftmost synapse
and rightmost synapse

table    features

of both linear and sigmoidal kernels  so it encompasses multiple models           
the parameters of the rbf kernel are c and
  a grid search was used to try      combinations of c  logarithmically spaced from   to
       and   logarithmically spaced from     
to     since there was no separate training
set from the test set of data  three fold crossvalidation was used to calculate the accuracy
of the svm  hence the options string input to
the function svmtrain in matlab was  c
            g            v   
   experiment
     data set

the software was evaluated on images of both
wild type and mutant worms captured in my research lab  i grew wild type and plx   mutant
worms  and captured those images using a microfluidics system developed at georgia tech     
this system allows the user to image multiple
worms per minute  which is faster than the current
process of selecting individual worms and placing
them on slides 
due to the size of the microfluidics system
imaging chamber  the worms need to be the same
age when imaged  c  elegans grow very quickly
 their lifespan is less than a week   so special
precautions need to be taken to synchronize the
worms ages  worms are bleached to isolate their
eggs  which are placed on petri dishes with bacteria to begin growing at the same time  then the

wild type images
mutant images
total images

  
  
   

table    data set
cross validation accuracy
human accuracy
accuracy improvement

   
   
   

table    accuracy

worms are sent through the microfluidics system
to be imaged  i imaged over     worms over multiple imaging sessions  see table     then i used
those images to train and test my software 
     evaluation
     

accuracy

according to biologists who are familiar with the
microfluidics system  approximately         of
the images captured with the system are considered usable for various reasons       sometimes
the worms are rotated  or other tissues block the
view of the synapses  sometimes the worms are
still moving during imaging  so the output images are too blurry to use  the human accuracy
of     for classifying these images corroborates
this statistic  see table     in comparison  the
    cross validation accuracy of my software is
nearly a     improvement over the status quo 

fi     

speed

a key benefit of my software over the current
manual method of classifying c  elegans is the
increase in speed  the fluorescence molecules
that are imaged are susceptible to photobleaching when they are excited by the fluorescent light
in the microscope  the photobleaching causes an
exponential decay in intensity       so it is critical to make decisions about the worm quickly  in
particular  when the biologists are classifying the
worms  if they are unable to classify them before
the fluorescence molecules fade  my software can
still make those decisions accurately 
to find the synapse masks manually  the user
needs to click on each pixel in synapse and classify which neuron it belongs to  which is an incredibly tedious process  then  even if the biologist is not manually calculating all of the features mentioned above  the user still needs to take
time to consider such a high dimensional problem  conversely  using my software  synapses
can be identified in an image  on average  within
  seconds  i used matlabs profiler to track the
amount of time spent on processing each image in
my data set  training the svm takes time  but obviously that step only needs to be completed once 
and does not increase the time to classify a worm
at the time of imaging 
   conclusion
for the cs    final project  i implemented
software to classify fluorescent biological images
of synapses in c  elegans  the algorithm trained
an svm with a radial basis function kernel and
has     cross validation accuracy  which is very
high given that biologists only consider about half
of the images captured with the microfluidics system useful  the software also incorporates work
completed for the cs   a final project  which
identifies synapses in the noisy input images  the
entire software package can classify an image
quickly  on average within four seconds   making
it not only more accurate  but also much faster 
than a biologist 

references
    c  c  c  c  w  hsu and c  j  lin  a practical guide to support vector classification       
    c  c  chang and c  j  lin  libsvm  a library for support
vector machines  acm transactions on intelligent systems
and technology                     software available at
http   www csie ntu edu tw  cjlin libsvm 
    k  chung  m  crane  and h  lu  automated on chip rapid
microscopy  phenotyping and sorting of c  elegans  nat
meth                    
    r  cooper  accelerating neuronal genetic research in c  elegans with computer vision   machine learning  cs   a
final project report       
    m  m  crane  j  n  stirman  c  ou  p  t  kurshan  j  m 
rehg  and k  s  h  lu  autonomous screening of c  elegans
identifies genes implicated in synaptogenesis  nat meth 
                  
    g  danuser  computer vision in cell biology  cell 
                    
    r  e  fan  k  w  chang  c  j  hsieh  x  r  wang  and c  j 
lin  liblinear  a library for large linear classification 
journal of machine learning research                   
    j  hua  z  xiong  j  lowey  e  suh  and e  r  dougherty  optimal number of features as a function of sample size for various classification rules  bioinformatics                 
     
    s  keerthi and c  lin  asymptotic behaviors of support
vector machines with gaussian kernel  neural computation 
                     
     p  kurshan  personal communication       
     h  lin and c  lin  a study on sigmoid kernels for svm and
the training of non psd kernels by smo type methods       
     a  s  miguel  personal communication       
     n  b  vicente  j  e  d  zamboni  j  f  adur  e  v  paravani 
and v  h  casco  photobleaching correction in fluorescence
microscopy images  journal of physics  conference series 
                   
     j  g  white  e  southgate  j  n  thomson  and s  brenner 
the structure of the ventral nerve cord of caenorhabditis elegans  philos trans r soc lond b biol sci                 
     

honor code acknowledgements
the software developed for the cs   a and
cs    final projects will be used in my research
lab at stanford  prof  kang shens lab in biology   the synapses were extracted for the
cs   a final project  and then the images were
classified for the cs    final project  i worked
by myself so all of the completed code was implemented by only me 

fi