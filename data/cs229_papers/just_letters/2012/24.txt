detecting dark matter halos using principal component analysis
william chickering  yu han chou
computer science  stanford university  stanford  ca      
 dated  december          
principal component analysis  pca  based pattern recognition is employed to predict the locations of dark matter halos within simulated galaxy distributions  local maxima in the net tangential
force produced by galaxy positions and ellipticities forms a feature space upon which pca is performed to distinguish halo from non halo maxima  within a dimensionally reduced space large halo
types are successfully clustered into two types  facilitating smart subtraction from the tangential
force landscape in order to better resolve minor halos  the strengths and weaknesses of this novel
approach are examined 

introduction

no community can claim greater big data challenges
than that of astronomers  for example  the large synoptic survey telescope  lsst  is scheduled to come online
in      and will produce on the order of    petabytes of
data during its ten year run      in response to this impending deluge of information  astronomers are seeking
new approaches for analyzing their observational data 
the kaggle com competition observing dark worlds
 http   www kaggle com c darkworlds  is an example of this  the challenge is to locate the center of
one to three dark matter halos given the positions and
ellipticities of galaxies produced by a simulation based
on a model of general relativity  to illustrate this  in
fig    we show the galaxies of a typical sky  ignore
the intensity data for now   galaxies are represented
as short lines with orientations representing their ellipticities  a large dark matter cloud can alter the apparent positions and ellipticities of galaxies  such that they
appear to circulate around the center of the dark matter  this effect  known as weak gravitational lensing  is
exploited by astronomers to locate dark matter  historically  model fitting is used to predict halo center locations
     our approach is different  in this article we outline
an image processing technique  based on principal component analysis  that could potentially complement standard physics based techniques to improve the precision of
dark matter detection 
feature space

our dataset consists of a simulated distributions of
        galaxies spread over a square field referred to as
a sky  a training set is provided consisting of     skies 
each of which includes one to three dark matter halos 
within a sky  each galaxy is fully described by position
coordinates x and y along with ellipticity    vector components e  and e    we choose not to use these raw data
but rather analyze a derivative quantity etf called tangential force which is known to be correlated with dark
matter and is defined as

etf    e  cos      e  sin     

   

where  is the angle formed between a galaxy and a field
point  x  y    given by

   arctan



y  y
x  x



 

   

that is  a particular galaxy exerts a etf upon a field
point that depends only on   we construct featurepvectors using the net tangential force etf  x   y     
etf
obtained by summing the contributions exerted by all
galaxies upon a particular field point  unlike the galaxy
distribution itself  etf has the virtue of being continuous
and differentiable across a sky 
the true distribution of galaxy positions and ellipticities is essentially random such that on average etf     
when a dark matter cloud is positioned between a group
of galaxies and a distant observer  the collective mass of
the cloud bends the light  elongating galaxy shapes and
correlating galaxy positions such that regions of large etf
form  in fig    we show a typical sky simulation illustrating the relationship between the galaxy distribution
and etf where dark regions indicate positive etf and
light green regions indicate negative etf   the darkest
region in the figure correlates with a circulating pattern
of galaxies and indicates the general vicinity of a large
dark matter halo  what is not obvious from inspecting
the figure is that a second  much smaller  halo is positioned roughly half way between the large halo and the
right edge of the sky  the dominance of a single large
halo and near invisibility of one or two minor halos is
characteristic of the competitions dataset 
method

the observing dark worlds competition has attracted
a great deal attention  it is clear from online forums that
contestants are applying a number of techniques  while
many  including the authors  have had success in predicting the locations of dominant halos  it is the virtually

fi 
   

   
   

maxima counts

halo counts

   

   

   

   
   
   
   

  
  
 

 
                   
distance to nearest maximum

fig     an example galaxy distribution from the kaggle com
observing dark worlds competition  the intensity data represents net tangential force etf with dark regions indicating
relatively large positive values that are consistent with the
presence of a dark matter halo 

imperceptible minor halos that present the greatest challenge  a viable approach to this problem would seem
to be to study the training data to learn the functional
form of the etf resulting from a large halo  indeed the
standard framework used for numerical analysis of gravitational lensing effects employs a variety of models to
which data is fit     alternatively  one could take a more
naive approach  without the aid of physics  and apply
fitting algorithms such as a weighted linear regression
or estimation maximization to fit the gross features of a
skys big halo 
our initial efforts consisted of such fitting techniques 
in particular  an estimation maximization algorithm in
which the tangential force is modeled as having a gaussian profile produces reasonable predictions of large halos  but proved ineffective at identifying their minor counterparts  in addition  several weighting strategies were
applied to construct quantities derivative
p of athe tangential force  e g  replacing etf with
etf  r   where
    a      in an effort to achieve greater resolution of the
minor halos  but again  the results were disappointing 
next  clustering techniques were employed  which yielded
somewhat better results  in particular  a divisive hierarchical clustering approach  which breaks apart the etf
landscape at local minima effectively reduces the original
problem of finding minor halos in the sky to evaluating
the likelihood that a particular cluster  with its respective
features of size  shape  etc   contains a halo  ultimately 
none of these results were satisfactory  resigned to the
fact that we faced a very difficult challenge  we decided

 

 

                   
distance to nearest halo

fig     left  histogram of dark matter halos binned according to distance to nearest local maximum in etf   right  histogram of local maxima in etf binned according to distance
to nearest halo 

to take a radically different approach and treat the problem of halo prediction as that of image recognition  it is
the authors belief that an optimal solution to a problem
as challenging as the detection of secondary halos will ultimately consist of many techniques working in tandem 
in this spirit  we focus our report on the use of principal
component analysis  pca  to develop a pattern recognition algorithm for detecting dark matter halos 
using pca

in developing an image processing technique  windowing of the data is helpful in order to isolate relevant features in the data  one approach to the present problem
could be a sliding window in which the algorithm scans
through training data recording features along with labels indicating the presence or absence of a halo  the
problem with such an approach lies in the fact that halos
are so uncommon  and therefore  the amount of negative y  i      training data dwarfs that of the positive
y  i  data  a critical observation helps us here  in the
left panel of fig    we show a histogram of dark matter halos binned according to the distance to the nearest
local maximum in etf   the data clearly show that the
preponderance of halos are located near such a maximum  an overly optimistic interpretation of this data
might suggest that halo detection is not so difficult after
all  the right panel of fig    reveals the sobering reality
that while nearly all halos are found near maxima  the
vast majority of local maxima are nowhere near a halo 
so  while peaks in etf do not solve the problem of halo
detection  confining our algorithm to the analysis of regions around maxima dramatically reduces the problems

fi 
   
   
first pc

  

   

  
  

   
pca score

pc loadings  a u  

   

   
   

  
 

  

  

 

  

  
   

  
 

 

 

 
 
principal components

  

  

fig     the first ten principal component loadings within the
space formed via pca performed on windowed  the red curve
corresponds to halos while the blue data corresponds to nonhalos  error bars correspond to  one standard deviation 
the data clearly shows separation of halo from non halos in
the  d projection onto first principal component  the inset
shows the first principal component 

phase space 
to train the algorithm  a square region  with side    
that of the full sky  surrounding each local maxima in
etf forms our feature vector x i    pca is performed on
    of all skies resulting in m          training vectors
among which about     are halos  i e  y  i           
of the skies are excluded to allow for testing of the algorithm  once in the basis formed by pca only the first
ten principal components are used such that our data is
dimensionally reduced  when testing a sky the region
within a window centered at each local maxima in etf is
projected into this ten dimensional space  using a naive
bayes model  the principal component loadings reveal a
probability that a local maxima is a halo 
the utility of pca is that it provides a basis in which
the variance of the data is maximized  even using our
local maxima technique  the ratio of positive to negative
training data is       the basis formed through pca
therefore provides a representation in which the variance
among local maxima is maximized  it is not clear a priori that halos would be distinguishable from non halos in
such a basis  fortunately  the distinction can be made 
in fig    shows the first ten principal component loadings for halos y  i      versus non halos y  i       the
error bars correspond to  one standard deviation  the
data makes clear that separation is achieved by more
than one sigma in the first principal component  which
is depicted in the inset of fig     note that the first
principal component captures the radial symmetry that
characterized a large halo  importantly  the degree of
separation achieved within this dimensionally reduced

  

 

 

 

 
 
principal components

  

  

fig     the first ten principal components of big halos  y  i   
   in the pca space formed from full skies centered about
local maxima in etf   the data clearly identifies two types of
big halos  represented by the blue and red curves 

space is largely dependent on how well the data is vetted
prior to the pca  that is  if a larger number of negative
results were included the principal components chosen
would correspond to those that maximize the variance
among negative results and less so between positive and
negative  simply considering all local maxima in etf
with values greater than zero  this approach effectively
predicts major halos 
two halo types

to predict the position of minor halos the algorithm attempts to subtract the effect of the major halo  this process is complicated by several factors  not least of which
is the fact that the etf resulting from big halos varies in
shape  once again pca helps us  to learn about big halo
types we process our training data in a separate manner
from that described above  for each local maximum in
etf in each sky  we circularly shift the sky such that
the maximum is centered  pca is then performed on a
collection of full skies  that is  a separate training set is
formed consisting of         full sky feature vectors  as
was true in the case of the windowed algorithm described
above the big halos can be distinguished from non halo
maxima  although not as well as before  but distinguishing between halos and non halos is not the goal here 
rather  we find that big halos cluster quite convincingly
within this full sky local maximum pca space  this fortuitous discovery is represented by fig     which shows
the first ten principal component loadings for the mean of
the two halo types  once again  the errors correspond to
 one standard deviation  particular components   and
  show good separation  k means clustering was used to

fi 
 
   

tangential force  a u  

 
   
 
   
 
   
 
   
 

 

  

  

  
  
position  a u  

  

  

  

fig     the mean profiles of the two big halo types discovered
within the pca space formed from full skies centered about
local maxima in etf   type i is sharp is characterized by a
tall sharp peak  while type ii is shallow with minima of    
the magnitude of its peak 

separate the big halos within this dimensionally reduced
space  note that larger cluster numbers did not yield consistent results during k mean clustering but rather were
very sensitive to initial conditions  thus  we can only convincingly identify two clusters or types of big halo  in fig 
  the etf profiles of the two halo types are shown  the
two types have very different min max ratios indicating
that a subtraction of the wrong type would dramatically
distort a skys etf landscape 
subtraction

the discovery of two big halo types in this space allows
for a smarter subtraction  having identified the location
of the big halo using the windowed pca algorithm  we
then circularly shift the sky to center the halo and then
project the full sky into the ten dimensional pca space
represented by fig     as in the windowed pca algorithm  we use a naive bayes model of this space to
determine probabilities of the test halo being type i or
type ii  we then subtract the average halo of the corresponding type from the test sky  fig    demonstrates
this process  in the topmost panel is a contour plot of
the skys original etf   the red  roughly circular contours
indicate the position and magnitude of the major halo 
two minor halos also exist in this sky and are circled in
the figure  the middle panel show the average big halo
type identified with the sky  the etf of the middle plot
is then subtracted from the original sky yielding the contours shown in the bottom plot  the minor halos are
now more easily resolved with the same technique used
for identifying major halos 

fig     full sky contour plots of etf demonstrating the subtraction process  the upper panel shows the original etf   the
large red peak corresponds to a major halo  two minor halos that are difficult to resolve within the original landscape
are circled  the middle panel shows the average type i big
halo identified as most resembling the sky  represented with
the ten dimensional space created via pca  which has been
aligned with the major halo of the sky  the bottom panel
shows the result of subtraction  after which the minor halos
are much better resolved 

results

using pca we successfully predict the locations of big
halos  the observing dark worlds competition includes
several benchmarks to which our algorithm compares
favorably  in particular  two benchmarks in the form
of algorithms referred to as gridded signal benchmark
and maximum likelihood benchmark average distance errors of      units and     units  respectively  when predicting major halo locations on the first     training
skies  our pca based algorithm  meanwhile  achieves

fi 
    units  while our algorithm performs much better
than the provided benchmarks  it should be noted that
these algorithms are clearly quite poor and that other
techniques are known to outperform the pca algorithm
in its present form  nonetheless  we feel our technique
has value in that it is a novel approach to the problem
and offers avenues toward composite techniques 
reliable prediction of minor halos remains elusive  the
subtraction method described here works on some skies 
but far from all  it is likely that the present approach
is well suited for only a subset of dark matter halo configurations  as a consequence  using pca may be best
employed as part of a suite of techniques when performing halo detection 
moreover  this pca approach is far from optimized 
forming predictions on particular principal components
rather than simply the first ten significantly improves
performance for certain skies  similarly  feature selection
could be further optimized by modulating the window
size and or shape during halo detection  as well as using
different window size shapes when searching for minor
versus major halos  other key parameters such as bin size
and the distance tolerance for determining label during
training could be optimized  finally  a key defect in our
present algorithm is the use of circular shifts which result
in significant artifacts when subtracting halos near a sky
edge  finally  the authors also speculate that performing
pca exclusively on big halosthat is  omitting non halo
etf local maximaone might successfully cluster major
halos into more than the two classifications identified in
the present work 

conclusion

by employing pca and other machine learning algorithms  we can successfully predict the positions of major
halos  by confining the feature space to local maxima
in tangential force we dramatically reduce the problems
phase space and significantly improve the effectiveness of
pca at distinguishing halos from non halos  using a separate pca technique  in which clustering technique are
employed on a dimensionally reduced space  two distinct
halo types are identified facilitating the categorization of
test skies  by identifying major halo type  smarter subtractions are achieved providing greater resolution of the
effect of minor halos on the tangential force landscape 
by applying image pattern recognition techniques to a
new problem space  a novel approach is developed and
explored 

    lsst and technology innovation   online   available 
http   www lsst org lsst about technology 
    e  jullo et al   new j  phys                
    m  turk  a  pentland  journal of cognitive neuroscience
             
    the
ellipticity
describes
the
elongation
of
a
galaxy
along
the x
and
y
axes 
see
http   www kaggle com c darkworlds details 
an introduction to ellipticity for details 

fi