cs    term
t
projeect reportt

leaarning to
o predictt flight d
delay
lei sun
sunlei stanforrd edu

a
abstract
flight delayy is a very common riskk when people
ttake airplan
ne  it is a frrustrating e
experience n
not
o
only to the people wh
ho have scheduled events
a
after it  bu
ut also to the peop
ple who ha
ave
cconnecting flights  and
d even to th
he people w
who
al at the airport terminals  but w
with
meet arriva
reliable pre
ediction  peo
ople can ha
ave a head up
o
of how likkely their fflights are going to be
d
delayed such that the
ey can mittigate the rrisk
d
days before the fligh
ht  in this project  three
d
different machine learning models are
d
developed to predict the likeliho
ood of a flig
ght
d
delay  the result from
m these thre
ee models will
w
be compare
ed 

iintroduction
a flight dela
ay is a delayy in which a
an airline flig
ght
ttakes off an
nd or landss later than its scheduled
ttime  the federal aviattion administration  fa
aa 
cconsiders a flight to b
be delayed when it is   
minutes late
er than its scheduled time     
unfortunate
ely  air trafffic control is
i a large and
a
ccomplicated
d system  w
which depe
ends on ma
any
ffactors  esp
pecially  flight safety iss a factor that
a
always hass the highe
est priorityy  and should
never be compromise
ed  in year           of
tthe        
    flight operations in usa are
d
delayed      in anotherr word  one
e flight out of
ffive is delayyed 

fflight delayss are a frusstrating inco
onvenience to
p
passengers  a delayed flight might be costly to
p
passengers by makin
ng them late to their
p
personal sch
heduled eve
ents  a passsenger who
o is
d
delayed on a multi p
plane trip ccould miss a
cconnecting fflight 
a
according to
o risk mana
agement theory  a riskk is
q
quantified by its probabilityy and its
cconsequence  flight delay hass both hig
gh
p
probability a
and high co
onsequence
e  thus shou
uld
b
be definitelyy considered
d as high rissk 
in this project  i am going
g
to d
develop som
me
m
machine lea
arning mod
dels to pred
dict the flig
ght
d
delay by an
nalyzing som
me historica
al data  sin
nce
a
all the flight information
n and weath
her forecastt is
kknown befo
ore a flight  then it is possible th
hat
ssome predicction can be
e made to ssee how like
ely
a flight is go
oing to be delayed  the
en people can
m
make some migration p
plan in advance 

d
data colleection and
d overview
w
a
according to
t the statisstics from t
the researrch
a
and innovative tech
hnology a
administratio
on
page    

fis
   features that are related to
initially  we select
asons listed by rita 
the   top rea

arrival

departure

 rita   the   top reaso
ons that cause flight de
elay
a
are  air c
carrier reason  extreme weath
her 
national avviation systtem  nas  reason  la
ate   
a
arriving airccraft and seccurity

t
the figure above show
ws the perccentage of tthe
he flight delay  at the first
f
reason whicch caused th
g
glance  surrprisingly  weather ca
auses onlyy  
percent of flight dela
ays  but the
ere is another
ccategory off weather w
within the n
nas catego
ory 
t
this type off weather slo
ows the ope
erations of tthe
ssystem butt does nott prevent flying  during
 
           
  of nas de
elays were d
due to weather
   
 
o
provide
es
detailed
rita
also
on time
performancce data with
hin some time range for
research pu
urpose  it co
ontains mosst of the flig
ght
information
n  more imp
portantly  th
he data sett is
large enoug
gh for both training and
d testing 
unfortunate
ely  the wea
ather data iss not provid
ded
in the data set  but du
ue to its dire
ect and stro
ong
p with flight delay  i decided to
relationship
ccollect all the weath
her data fo
or each flig
ght
record  afte
er trying a couple of approaches  i
ffinally
ch
hose
to
on
use
the
api
w
wundergrou
und com  although fo
or some sm
mall
a
airports  on
nly some lesss accurate historical data
is available   but they should be su
ufficient forr us
tto build the
e model 

day of week
ca
arrier
aiirport
viisibility
w
wind speed
co
ondition  sn
now  rain  
aiirport
viisibility
w
wind speed
co
ondition  sn
now  rain  
distance of fllight

 

 

owing four figures  i showed the
in the follo
p
percentage of delaye
ed flight versus som
me
sselected featture data to
o visualize th
he patterns in
itt  and also we can ro
oughly tell that if it iss a
sstrong indiccator of a fflight delayy  due to the
h
high dimenssion of featture data  i plotted the
em
in
ndividually in each figu
ure 
a
according to ritas stu
udy  air carrrier is one of
the main re
easons for delay 
d
altho
ough we ha
ave
 
   carriers in our data
a set  for sspace reaso
on 
o
only the top
p   carriers with most delay
d
and the
top   with least delay are shown in the figu
ure
b
below  the worst airlines for flig
ght delay are
a
ffrontier  atllantic  jetbllue  alaska   and unite
ed 
w
while the be
est airlines are hawaiia
an  southwe
est
a
and airtran
n  this result is very ssimilar to the
sstatistics tha
at i can find from other sources     

page    

fiweather features  the rrelationship is
these two w
a
almost perfe
ectly linear 

from our intuition  airport should be another
ffactor that a
affects the flight
f
delay a lot  becau
use
larger airpo
ort tends to
o have heavvier traffic th
hus
is more like
ely to cause
e delay  ou
ur data veriffies
tthis assump
ption that b
busier airport have higher
d
delay rate  but on the other hand  the wo
orst
a
airports in our data set are no
ot one of tthe
ports in the
e us  such as new yo
ork
busiest airp
a
airport  jfk
k  or los ang
geles airporrt  lax  

iin addition  even comm
mon sense ccan tell us that
bad and exttreme weather contribu
utes greatlyy to
fflight dela
ay  from the historical weather
d
database  i picked th
hree featurres that ha
ave
sstrong tie with delayy  visibility  mile   wind
sspeed  mph  and wea
ather condition  such as
t
rain  snow  cloudy  or hail   the following two
ffigures sho
ow the rela
ationship b
between flig
ght
d
delay versus visibility  a
and relation
nship betwe
een
tthe delay p
percentagess versus win
nd speed  for

o
on the oth
her hand  however  two featurres
ssurprisingly show no in
ndication of flight dela
ay 
d
day of wee
ek  mondayy  tuesday  is initia
ally
sselected due to the re
eason that the air trafffic
ot 
sshould be he
eavier durin
ng weekend  which is no
h
however  supported byy the data  a
also the flig
ght
d
distance is a
another feature that do
oes not sho
ow
a
any pattern
n and is fin
nally removved from the
ffeature set 

m
model    n
nave bayyes
t
the first mo
odel i built w
was nave b
bayes  since
e it
iss the most straightforw
ward mode
el and easy to
b
be implemented 
in order to build the model 
m
i firrst discretized
ssome contin
nuous value
ed input  succh as visibility
a
and wind speed  afterr some exp
periments  the
page    

fibuckets that achieve best resu
ult are sho
own
hat is used as
below  whicch is the ssame as wh
vvariables in the figures in the last ssection 
visibility   mile 
wind  mp
ph 

   

   

   

  
 

 

 

 

 

    

     

 
     

  
  

 

 

 

 

t
there are o
only   classses in outpu
ut  delayed or
not delaye
ed  so for training data 
d
delayyed
minutes wiill be discrretized usin
ng the officcial
d
definition   
   minutes or more is considered as
d
delayed 
a
after tuning
g the mode
el  the best result from  ffold cross validation is       
   for stu
udy
also did som
me experim
ment on mu
ultipurpose i a
cclass modell  because itt is also inte
eresting to see
s
how the m
model performs when w
we want it to
predict the delay time
e more preccisely  such as
d
delayed    minutes o
or    minuttes instead of
jjust two cattegories  delayed or no
ot  as shown
n in
tthe figure b
below  with more num
mber of outp
put
buckets  the
e performan
nce become
es lower 

kknown as nave bayes assumption
n  in our data 
h
however  w
we are no
ot confiden
nt about it 
e
especially on
n weather d
data  for exxample  foggy
d
days alwayss have low
wer visibilityy than sunny
d
days  so they are obvviously not independe
ent
ffeatures  mo
oreover  sincce we have enough data 
w
we dont h
have to m
make any other strong
a
assumptionss like p x yy  follows a gaussian
d
distribution  therefore
e  logisticc regressio
on
sshould be m
more robustt  as a seco
ond exercise
e  i
d
developed a logistic regression model with
sstochastic g
gradient asccent rule tto see if th
his
m
model can provide uss better prediction ovver
n
nave bayes 
itt turned ou
ut that the accuracy
a
fro
om model   is
 
        it in
ndeed is bettter than tha
at from nave
b
bayes mode
el  although the improvvement is n
not
a
as large as i expected  we can alsso safely dra
aw
the conclusiion that no
ot all the fe
eatures in o
our
are perfectlyy  mutually independent 
ffeature set a
t
this also lea
ads me to lo
ook for a be
etter model to
d
describe the
e data 

m
model    n
nonlinear with kern
nel trick
o
one of the
e limitation
n of logisttic regressio
on
m
model is tha
at its decisio
on boundaryy is still linear 
w
we can add some extra
a features and use a hig
gh
o
order polyno
omial  but tthere are tw
wo difficultie
es 
ffirst  it take
es too much time to g
generate ne
ew
ffeatures due
e to the hig
gh volume o
of the training
d
data set  se
econd  we a
are not sure
e about wh
hat
h
high order p
polynomial iis the best fit 

model    logistic r
regression
n
a
as discussed in class  nave
n
bayess model makes
a very strong assumption tthat xs are
cconditionallly independ
dent given y 
y which is a
also

k
kernel trick is a very p
powerful too
ol in machine
le
earning domain  and more impo
ortant  it can
ssolve the tw
wo difficultie
es when usin
ng high ord
der
p
polynomial  so in the third model  id like to
b
build a non  linear regre
ession model with kern
nel
trick 

page    

fifrom problem set    we derived an approach to
kernelize the perceptron algorithm  similarly  we
will consider a stochastic gradient descent like
implementation of the classic linear algorithm
where each update to the parameters  is made
using only one training example 
it is also worth mentioning that the first two
models are classification models  while this
model is a regression model which has
continuous valued output  so when we get the
continuous valued late minutes  we can tell the
flight is delayed  greater than     or not  at the
same time we can easily evaluate how bad the
delay is  after all  delay    minutes or delay  
hours is totally different experience 
from the classic linear regression model  the
update rule is 


the way i evaluate the performance of this
model is to calculate the average difference
between the actual delay and the prediction on
the test data 
after tuning  the performance is very satisfying 
the average error is      minutes which means
the prediction is only about   minutes off the
actual value on average 
furthermore  when i convert the continuous
valued prediction result into two categories as
in the first two models  the accuracy         is
the highest among the three models  which is
also an expected result 

conclusion
flight delay is directly related to airport location
and weather condition thus can be predicted by
machine learning algorithm  nave bayes model
performs ok considering its simplicity  logistic
regression model is slightly better because it
removes the independence assumption  kernel
based non linear regression model has the best
performance but time complexity is higher
especially when there are many training data 


since

each training data is passed into the training
once 

 

then

the prediction step is
 

reference
   http   en wikipedia org wiki flight delay

despite the high dimension of   we dont have
to update  explicitly  we just need to keep
tracking the value of
 

   http   www transtats bts gov homedrillchart asp
   http  bts gov help aviation html understanding
   http   www travelandleisure com articles best an
d worst airlines for delays

in this model  i used a degree   polynomial
kernel  the above iteration keeps running until

page    

fi