non stationary covariance models for discontinuous functions
as applied to aircraft design problems
trent lukaczyk
december         

 
   

introduction
application

the nasa n   supersonic aircraft project is a collaborative effort between lockheed martin
corporation and stanford university that aims to advance the state of supersonic passenger jet
technology  stanford university is contributing to this by developing a generic multi disciplinary
analysis and optimization  mdao  framework capable of identifying aircraft designs that
demonstrate increased fuel efficiency by reducing drag and reduced sonic boom loudness from a
standpoint of external aerodynamics  in order to evaluate the aircraft performance  we perform
high fidelity computational fluid dynamics  cfd  simulations using our unstructured euler
solver su     this can generate visualizations of the airflow around the aircraft as well as estimates
of drag and sonic boom loudness 
by changing the design of the aircraft with shape deforming design variables  we can build a
performance response surface  a response surface is an n dimensional surface that characterizes
the relationship of design variable inputs and performance parameter outputs  traditionally  it
is necessary to model a complex problems response surface with a less expensive surrogate
model because direct evaluations of the underlying problem are computationally expensive  two
surrogate models commonly used in mdao are second order least squares regression  and
kriging  a form of weighted linear regression  thus in a broader sense  most machine learning
approaches are applicable to this problem 

   

problem

an important result from chung    is the discovery of discontinuities in the response surface
for sonic boom loudness  figure   shows this behavior found in cfd simulations of a similar
business jet with variations in the radii of two fuselage sections  the existence of these design
space discontinuities for supersonic aircraft problems is a major motivation to find approaches
capable of modeling them  if a machine learning based model can be applied  significant gains
in efficiency can be found when optimizing on these problems 

 

fiboom overpressure
 psf 

 

   
 
   

   

x 

 

 

   

   

 
 

   

x 

figure    supersonic business jet response surface discontinuities    

   

approach

most machine learning models applied to surrogate modeling assume stationarity in the feature
space  for example  a typical approach to weighted least squares regression assumes that that
the length scale parameter  l  is constant with changes in input features  a non stationary
covariance model might allow l to vary in the feature space  allowing it to shrink near areas of
high variation in the data  or grow in areas of low variation  this would allow it to model rapid
changes in function value around discontinuities  and maintain smooth features elsewhere 
these models are difficult to manage because the variation of the covariance parameter must
be learned as a function of the feature space and even as a function of the target variables  a
proposed simplification to this algorithm explored in this report is to iteratively update the local
tau parameter as a function of local gradient until the regression model converges  this way the
model may be able to learn the location of discontinuities 

 
   

present work
non stationary weighted linear regression

a preliminary form of non stationary regression was build from the weighted linear regression
model 
to generate an approximation to sampled data of an piecewise smooth function  i am using
weighted linear regression with a gaussian weight model 
y   x 

   

where x is a design matrix with rows of feature vectors  model parameters  are solved with
the normal equations 
    x t w x    x t w y   
   

 

fiwhere w is a diagonal matrix of weights chosen by the function 
 
 x i   x  
wi i   exp 
 
 l x  

   

non stationarity is easily added by allowing l to be a function of the input features  however
this function must now be learned as well 
to estimate the distribution of l  i constructed a second machine learning estimator of the
y
probability of target variable y having a discontinuity at x conditioned by the gradient x
 
fi 
 

fi y
y
 
fi
  h  x       g
 
   
p w x      fi
x
x
where w is the indicator function for the discontinuity  and g is some mapping function which
was chosen to be a form of the gaussian distribution 
 
d
x
 y xd   
g z    exp 
 
   
 
d

where  is a scaling parameter that must be learned and the normalization constant has been
dropped to ensure that the distributions output ranges in        
the length scale is then itself scaled by the probability of it not being a discontinuity 
l x    lo    x    lo  g  z x    

   

where lo is a baseline length scale  another parameter that must be learned 

   

non stationary factor analysis

non stationarity can also be applied in the context of factor analysis  where we build the model 
f  x   x  f  n  f    v f      

   

based on the prior distribution assumptions


 

k xp   xq   k xp   xj  
fp
 n   
 
fk
k xk   xq   k xk   xj  
  fi  xi     i           n    

  ft  xt     t

   

          m   

and apply a non stationary kernel k     derived from the relation from gibbs provided in
rasmussen    



k x  x    



 lo    x   x   
lo      x        x   

d
 

exp 

d
x
d

 
 xd  xd   
 
    xd         xd  

where  has been assumed isotropic but non stationary in the feature space 

 

   

fi   

iterative discontinuity steepening

to steepen the discontinuity  i am iterating the response surface to improve the estimate of   
the basic process is to generate an initial guess of the response surface  and calculate its gradient 
then use this estimate of the gradient to update the discontinuity indicator    then the response
surface is regenerated using the updated tau  and the process repeats until convergence 

 

results

to test these approaches  i built on top of an existing matlab code for gaussian process
regression  adding the iterative discontinuity steepening algorithm and non stationary covariance
functions 
i ran numerical tests with a toy data set made of with a sinusoidal function plus a small amount
of random noise  and a discontinuous shift of the data at x      applying the iterative method
described above and using non stationary weighted least squares regression  the response surface
model of the data was able to converge to capture the discontinuity in     iterations 

figure    non stationary least squares weighted regression example
another test case i ran was one with no noise but fewer data  and using the factor analysis
approach  an example regression is shown below 
the advantage here was that the scaling parameter b for the discontinuity model could be easily
learned as part of the marginal likelihood maximization  because of the sparsity of the data
 which must be acceptable for this method to be useful for response surface modeling   there is
more ringing around the discontinuity than that in figure    building an indicator of where more
data could be added as part of an adaptive sampling process could be a future improvement to
this method 

 

fifigure    non stationary least squares weighted regression example

 

conclusions and future work

this report has presented the development of a machine learning model which attempts to
identify locations of discontinuities in a response surface  a modified gaussian distribution was
chosen to model the distribution of a discontinuity indicator informed by the gradient of the
response surface  and an iterative method was used to build an estimate of this indicator  using
two toy examples  this method was shown to capture discontinuities in the training data 
more work is needed to validate this approach  for example  the generalization and estimation
error could be evaluated in more thorough sense by generating a random set of toy models with
different locations and magnitudes of discontinuities  if the model as built is well suited for this
problem  the average generalization and estimation error across this test set would be low 
additional future work would be to include additional observations of gradients of the training
data to better inform the fit  adding adaptive sampling capabilities to refine the training data
round the discontinuity could also be advantageous  finally  this approach can be applied to
the supersonic passenger jet design problem to evaluate its usefulness in a real engineering
application 

references
    chung  h   and j j alonso  design of a low boom supersonic business jet using
cokriging approximation models   th aiaa issmo symposium on multidisciplinary
analysis and optimization  aiaa            atlanta  ga  september      
    rasmussen  c e  and c k i  williams gaussian processes for machine learning  mit press 
cambridge ma       
    stephensen  j   k  gallagher  and c c  holmes beyond kriging   dealing with discontinuous spatial data fields using adaptive prior information and bayesian partition modeling 
geological society special publications  london  january      
 

fi