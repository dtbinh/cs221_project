on and off pathways of ganglion cells in the salamander retina
bongsoo suh
department of electrical engineering  stanford university
bssuh stanford edu

one of the main goals in neuroscience is to explain the computation and functional role of
sensory neurons and its connection to the underlying biological mechanisms  in the vertebrate retina 
various statistical structure of the visual scene is transformed  decomposed and encoded through the
signal processing in the inner retinal circuitry to ganglion cells  a certain ganglion cell receives a
combination of excitatory and inhibitory inputs from many presynaptic neurons  where the inputs can be
represented as the average response from on type and off type bipolar cells  to understand the biological
circuit structure  a parallel two pathway linear nonlinear ln  model is used to capture the average
features represented by each pathway  here  i applied machine learning approaches to find the twopathway ln model that best represents the ganglion cells circuitry 

   introduction
in neuroscience  a central research problem is to understand the mathematical description
between the stimulus and response of sensory neurons and its relationship to the underlying biological
circuit structure  one widespread approach to this problem is to use a simple quantitative model  mapping
the stimulus and the neuronal response  in the early visual system  specifically in the retina  the problem
is to describe the relationship between the retinal neural activity and the light intensity as a function of
time  space and wavelength  one of the main interests is to have a compact description that predicts the
response of ganglion cells  known as spikes  having such description would provide a good tool in
understanding what features of the visual input are encoded by the cell 

figure    a schematic diagram of vertebrate retina  baccus        
the retina encodes visual scene by transmitting light intensity into a sequence of spikes  the visual stimulus is
detected in the onl  converted into a continuous time electrical signal  the signal is processed through the inner
layers  inl and ipl  to the ganglion cell layer  gcl   and it is encoded into spikes 
p  photoreceptor  h  horizontal cell  b  bipolar cell  a  amacrine cell  g  ganglion cell 

fiin the vertebrate retina  the visual stimulus is converted into electrical signals by the
photoreceptors  and it is processed through the inner layers to the ganglion cell layer  figure     a
ganglion cell receives diverse inputs from multiple interneurons  bipolar and amacrine cells  where each
interneuron plays role to shape and process particular features of the visual input  the response of a
ganglion cell incorporate the signal processing in the inner retinal circuitry and at the ganglion cell level 
explaining selected or discarded components of the visual information  baccus         a conventional
way to understand the computation of a ganglion cell and how visual stimuli are related to the ganglion
cells response is to find a single average measure  a linear nonlinear  ln  model  where a linear
temporal filter is followed by a static nonlinear transformation  figure  e   the linear filter represents the
average input stimulus feature that the cell is sensitive to  and the nonlinearity is the average
instantaneous comparison between the filtered input and the cells response  chichilnisky        
however  the underlying system is more complex that cannot be explained by a simple model 
although the linear filter is associated with the receptive field of the ganglion cell  this single ln
model explains less about the complex connectivity of inner neurons to the ganglion cell  previous reports
have shown that ganglion cells encode visual stimulation relying on parallel processing pathways 
representing inputs from on and off type bipolar cells  fairhall et al        geffen et al        gollisch
and meister         the computation of the ganglion cell related to the visual stimulus can be modeled as
having two average on  and off type bipolar pathways  the two pathways represent population of cells
that responds to light intensity by either being activated when the lights turned on or when the lights turn
off respectively  to incorporate this biological circuit structure  a parallel two pathway ln model can be
used to capture the average feature each pathway is processing  figure    

figure    modeling of retinal function  baccus        
 a  visual stimulus drawn from a white gaussian distribution   b  raster plot  spiking response of a single
salamander ganglion cell to repeated stimulus sequence  recorded with a multielectrode array  each row corresponds
to a repeat  and the vertical mark represents a spike   c  the firing rate of the cell  peristimulus time
histogram psth    d  the firing rate predicted by a linear nonlinear ln  model   e  the ln model  the visual
stimulus is convolved with a linear temporal filter and the output is then transformed by a static nonlinearity 

fifigure    parallel two pathway linear nonlinear ln  model 
visual light intensity denoted s t  is passed through on  and off type biphasic filters  producing goff t  and gon t   the
filter outputs are transformed by threshold nonlinearities  and then linearly summed to produce the firing rate
response  the rate is calculated by taking the average of the number of spikes in a time bin of   ms  top ln
represents the off pathway and the bottom is the on type  the pathway type is defined by the filter shape  the offtype pathway responds to the time course of light changing from negative to positive and the on type pathway vice
versa  nonlinearity is modeled by a sigmoidal function having midpoint and slope as variable 

in this project  i generated spiking data with a two pathway spiking model  where the linear
filters of each pathway were given to match the average on  and off type bipolar cell pathway  my first
goal was to estimate the two linear filters by correlating the spikes and the stimulus  i varied the
parameters of the two pathway spiking model to mimic the change of threshold change at the bipolar cells 
and identified the different eigenvalue spectrum of the covariance matrix of the set of stimuli that elicited
spikes  in addition  i performed gradient decent based optimization to fit a two pathway ln model to the
generated spike data 

   methods
in order to generate multiple spike trains  i used a two pathway spiking model  the spiking
model is composed of a two pathway linear nonlinear kinetic  lnk  model followed by a spiking
block  s   figure     the lnk model accurately captures both the membrane potential response and all
adaptive properties of ganglion cells  ozuysal and baccus         the spiking block consists of a
decision function and a feedback loop adapted from keats model  keat et al          i used a set of
lnks parameters that fit the experimental data  a set of optimal lnk parameters was used that
estimated the intracellular membrane potential recording  i separately measured the spiking block
parameters that optimally captured the spikes from the intracellular membrane potential  to produce some
variation in the output  the gaussian noise was given to the spiking model to vary the timing and the
number of spikes  for each trial  i generated    s of spatially homogeneous light stimulation  s t   and
passed through the lnks model to produce multiple spike trains  ri t   i aimed to fit the two pathway ln
model to this stimulus and spike train data sets 

fifigure    the two pathway linear nonlinear kinetic spiking lnks  model 
the input s t  is passed through a linear temporal filter  a static nonlinearity and a first order kinetic model  where
the input u t  scales two rate constants  the output v t  is the active state a  which are passed through the decision
block of the spiking block to generate spikes  for every spike  a negative exponential is fed back to v t  

the ganglion cell response at any instant of time is determined by the stimulus sequence that the
cell observed  to estimate the two on and off filters of the two pathway ln model  the spike triggered
stimulus ensemble is found  figure     the ensemble consists of the set of stimulus segments that
preceded the spike  the spike triggered average  sta  stimulus is computed by taking the mean of this
ensemble as shown in figure x  to decompose the sta into two filters  i first performed spike triggered
covariance analysis to represent the ensemble in a low dimensional subspace by simply applying the
principal component analysis  pca  to the spike triggered ensemble  the first four principal components
of the ensemble generated by the lnks model are shown in figure    the input light distribution and two
nonlinearities of the lnks model shown in figure  a are used  next  i applied k means clustering
algorithm to identify the means of two clusters  these two filters are compared to the filters of the lnks
model  additionally  i changed the nonlinearity midpoint of the lnks model to see in which situations
the two pathways were possible to identify  finally  the two pathway ln model is found by optimizing
the two pathway model to minimize the l  norm between the generated firing rate and the estimate using
the fmincon function provided by matlab  spikes were smoothed using a gaussian window to get the
firing rate in the optimization procedure 

figure    light intensity and spike triggered stimulus ensemble  gollisch and meister       
spatially homogeneous light stimulus is given and it produces spikes  spike triggered stimulus ensemble is
computed by collecting the stimulus segments preceded spikes  the average vector of this ensemble estimates the
stimulus feature the cell is sensitive to  sta  

fi   results
performing the principal component analysis to the spike triggered ensemble  spike triggered
covariance  gives a good starting point to identify the two pathway filters  the significant principal
components give the directions that the complete stimulus variance differs the most to the variance of the
stimulus set that elicited spikes  simply assigning the first two significant principal components as the
filters of the two pathway ln model  and measuring the static nonlinearities by instantaneously
comparing to the firing rate may lead to a good numerical estimate of the output  however  the two filters
found using pca explains less of biophysical characterization of the inner circuitry  as expected that the
nature does not choose two components to be orthogonal  the first component is a biphasic on filter 
whereas the other components seemed to be very noisy  figure    left   for comparison  the spiketriggered average  sta  and two linear filters of the lnks model are shown  figure    right   the sta
describes that the ganglion cell response is due to the light decrease followed by an increase and another
decrease  it can be also thought as the inner circuitry forming off center receptive field  and having
delayed effect from the surrounding receptive field  thus  the two filters of the model should aim to
capture these biological explanations of the temporal processing of the two average on  and off bipolar
pathways 
the shapes of the two filters of lnks model  shown in figure    can be interpreted as both onand off bipolar cells having biphasic processing of the spatially homogeneous visual stimulus  this is
due to the fact that the stimulus excites both the receptive field center and inhibitory surround of bipolar
cells  also  the off filters have faster kinetics  meaning that the time to the first peak is shorter than the
on filters  several studies have reported basic techniques to separate two filters that explain these on and
off pathway behaviors  two clusters of the spike triggered ensemble can be found by separating along
the zero axis of the first principal component and assessed the mean of two clusters to be the filters
 fairhall et al        gollisch and meister        in another study  k means clustering method was used
to find the center of two clusters  geffen et al          here  i followed the latter approach 

figure    principal component analysis  pca  and the sta compared to on  and off filters
left  the figure shows the first four principal components of the spike triggered stimulus 
right  the sta and pc  are compared to the on and off filters of two pathway lnks model used to generate
simulated spikes  the average response of the stimulus ensemble  sta  is indicated by the green dotted line  the
black line is the first principal component  the off  and on  filters of the lnks model are the gray lines 

fifigure    identifying the two pathway filters from spike triggered ensemble
 a  the distribution of the input and two nonlinearities  on   red  off  blue   thresholds are   and   
 b  the eigenvalue spectrum of the principal component analysis  for this case  the eigenvalue of the first principal
component is distinctive from other eigenvalues  where the pc  is shown in figure   
 c  on and off linear filters  gray filters are the ones that i used to generate the response  and blue and red filters are
the recovered on and off filters respectively  recovered filters are the mean of each cluster shown in  d  found by
k means clustering algorithm  dotted green is the spike triggered average sta  
 d  the original stimulus ensemble and the set of spike triggered stimulus ensemble projected onto the first two
principal components  here  two clusters are distinctive  the red and blue corresponding to off and on filters in  c  
the gray dots denote the total stimulus ensemble 

figure   describes the results assessed using the k means clustering algorithm  due to the
linearity of gaussian process  the stimulus convolved with the linear filter is also gaussian distributed
 figure  a   then  the outputs of the linear filters are transformed by two different nonlinearities  the
nonlinearities are sigmoidal functions having different thresholds respective to the output distribution of
the filter  as shown in figure  a  these nonlinearities are expected to be caused by the voltage dependent
calcium channels of the bipolar cells  one pathway having a higher nonlinearity threshold led to a
distinctive eigenvalue compared to others  as shown in figure  b  and the spike triggered ensemble
clearly formed two clusters  by applying the k means clustering algorithm to the ensemble  i was able to
classify the ensemble in to two clusters  i computed the means  spike triggered average  of two clusters 
and identified two filters  as shown in figure  c 

fiadditionally  to see the effect of nonlinearity threshold playing role in recovering the two
temporal filters  i have followed the same procedure to each changed nonlinearity threshold case  for
simplicity  i used the same nonlinearity threshold for two pathways as shown in figure    the k means
clustering algorithm failed to identify two clusters in the spike triggered ensemble when both thresholds
were low  figure    first row   i increased the data size upto      s  but it did not improve  especially  by
looking at the eigenvalue spectrum  as shown in the second column  k means algorithm was not
sufficient to estimate the two filters of the lnks model  when there was no distinctive principal
component  the projection of the spike triggered stimulus ensemble onto the first two principal
components also indicates that the data varies similarly to stimulus features  forming just one cluster 
thus  having both low nonlinearity threshold values explains that neither on nor off pathways have
strong effect on the response of the ganglion cell  in contrast  as the threshold was increased  a significant
component was detected forming two distinct clusters  the third and fourth row of figure   shows that
the estimated two filters are very similar to that of the lnks model 

figure    identifying two pathway filters for various nonlinearities of the lnks model 
first column  the distribution of the input light intensity and two nonlinearities  the thresholds of two nonlinearities
for the on  and off pathways are identical  second column  the eigenvalues of the principal component analysis 
third column  on and off linear filters and their estimates compared with the spike triggered average  sta   fourth
column  two clusters identified by the k means clustering algorithm 
the nonlinearity thresholds are          and   from the top to bottom 

fithe two pathway ln model was optimized to fit the firing rate data that was generated by the
lnks model  the two filters found from the k means clustering were used as initial filters  i performed
gradient descent based optimization algorithm where the cost function was to minimize the l  norm of the
distance between the firing rate data and the model estimate  the overall correlation coefficient of the
firing rate between the data and the two pathway ln model was       which was significantly higher
compared to      computed with a single pathway ln model estimated by the sta and an
instantaneous static nonlinearity  the comparison plot of the firing rates is made in the figure   

figure    comparison of a two pathway ln model and a single pathway ln model fit to the firing rate 
gray  the firing rate data generated using the two pathway lnks model as shown in figure   
red  the estimate of the firing rate using the two pathway ln model 
green  a single pathway ln model prediction of the firing rate  the linear filter l  is the sta  and the
nonlinearity n  is an instantaneous transformation from the output of the sta and the firing rate 

   conclusion
to have a deeper understanding of the retinal inner circuitry  a parallel two pathway linearnonlinear ln  model is used  where each pathway represent the average response from on and offbipolar cells  in this project  i applied principal component analysis and k means clustering algorithm to
identify these two pathway linear filters  having higher nonlinearity threshold produced a distinctive
principal component which allowed me to detect two clusters  in contrast  it was difficult to classify
spike triggered ensemble using k means algorithm when low nonlinearity threshold value was assigned 
the two pathway ln model using the two filters has more biophysical explanation  and thus fits the
firing rate data more accurately compared to using just a single pathway ln model  future work may be
done to resolve the poor detection problem of two clusters for lower nonlinearity threshold 

   acknowledgements
i thank steve baccus and all the members of the baccus lab for insightful discussions  the experimental
data is from yusuf ozuysal 

fi   references
baccus  s  a          timing and computation in inner retinal circuitry  annual review of physiology     
       doi         annurev physiol                 
chichilnisky  e  j          a simple white noise analysis of neuronal light             
fairhall  a  l   burlingame  c  a   narasimhan  r   harris  r  a  puchalla  j  l     berry  m  j         
selectivity for multiple stimulus features in retinal ganglion cells  journal of neurophysiology        
        doi         jn           
geffen  m  n   de vries  s  e  j     meister  m          retinal ganglion cells can rapidly change polarity
from off to on  plos biology        e    doi         journal pbio        
gollisch  t     meister  m          modeling convergent on and off pathways in the early visual
system  biological cybernetics                  doi         s               y
keat  j   reinagel  p   reid  r  c     meister  m          predicting every spike  a model for the
responses of visual neurons  neuron               
ozuysal  y     baccus  s  a          linking the computational structure of variance adaptation to
biophysical mechanisms  neuron                 doi         j neuron            

fi