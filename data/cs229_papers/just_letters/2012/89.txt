forecasting baseball
clint riley
clintr stanford edu
december         

abstract

ularities  see references for a small sample   most of
these sources  however  do not present their data in a
way that is amenable for automated processing 
retrosheet org is the source for the data that was
used in this project  retrosheet presents their data
in files offering pitch by pitch granularity with files
covering as far back as the     s  although older
data has a tendency to be less detailed and less
accurate      additionally  retrosheet provides tools
that handle their specific data format and output csv
files according to various parameters  using these
files  along with a few dozen sql queries  it was
possible to create a sql database containing all
of the relevant information and to produce a huge
amount of training data  with nearly every desired
feature 
unfortunately  large amounts data brings its own
baggage  and calculating the desired features turned
out to be non trivial from a database with many millions of rows  so it wasnt possible  in this short timeframe  to exhaust the amount of training data that is
theoretically derivable from the database 

forecasts for the outcome of sporting events are coveted by nearly everyone in the sporting world  in
this paper  a number of machine learning algorithms
for predicting the outcome of baseball games are explored  using both classification and regression approaches 

 

introduction

baseball is americas national pastime and has become increasingly popular around the world in recent decades  wherever baseball goes  the boxscore 
and massive amounts of data in the form of statistics follow  because of the sheer volume and detail
of available data for the game  especially in major
league baseball  where accuracy of scorekeeping
approaches        it lends itself very well to be analyzed and forecast using statistics and machine learning algorithms  the effectiveness of various learning
algorithms in predicting the outcomes of games from
previous data is explored below 

 
 

data collection

   

features
sabermetrics

there are a multitude of websites and many dozens sabermetrics is a term that is derived from the
of books offering baseball statistics in varying gran  acronym of the society for american baseball re 

fi   k bb   strikeouts to walks ratio

search  sabr   bill james  now employed by the
boston red sox   one of the pioneers of the area 
invented the term  the mantra of the sabermetrics
community is the search for objective knowledge
about baseball  a concept that dovetails well with this
paper 
baseball statistics and boxscores have been
around nearly as long as the game  and in massive
quantities  a number of the more prevalent statistics  however  have significant problems  consider
wins for a pitcher  for instance  the official rule for
determining a winning pitcher is several paragraphs
long  but the major flaw is that it depends as much
on the teams offense   which the pitcher has zero or
minimal influence over   as it does on the pitchers
performance  a hurler could pitch nearly flawlessly
and not be credited with a win  for example  consider
ken johnson  who  remarkably  didnt allow a single
hit during an outing in       yet was charged with
a loss   conversely  a pitcher could allow a dozen
runs and still pick up a win if his teams offense is
even more explosive  with these caveats in mind 
the features used in this paper were chosen with the
goal of accurately reflecting a players impact on runs
scored  the ultimate predictor of wins and losses    
      these statistics were tested and shown to have
a nonzero correlation with the number of runs scored
        

pitching statistics
  
  
  
  
  
  

era    league adjusted earned run average
whip   walks plus hits per inning pitched
k g   strikeouts per game
bb g   walks per game
k bb   strikeouts to walks ratio
the above batting statistics  for batters facing
the pitcher 

fielding statistics
   fldp   fielding percentage

in an effort to reflect the aging curve  which indicates a player will ramp up to his potential  peak 
and then decline towards the end of his career     
these statistics were taken over differing time periods  the short term period covers the previous three
months  the medium term covers the previous two
seasons  and the long term covers the players entire
career  a period shorter than three months is essentially meaningless due to the random nature of the
game and since momentum in sports has been shown
to be largely a myth  outside of certain niche sports
     
additionally  two plus statistics were used 
ops  and era   which aim to isolate the players
batting statistics
performance from the stadiums he has played in 
this is known as adjusting for the park factor  two
   obp   on base percentage
of the more extreme parks are home to teams in the
   slg   slugging percentage
nl west division  coors field  home of the rock   ops    league adjusted on base percentage ies  and at t park  home of the giants   simplistiplus slugging percentage 
cally  a park factor is a number that is multiplied with
   rc g   runs created per game
statistics to normalize them  coors field  a very of   iso   isolated power
fense friendly park  has a park factor of        while
   sb cs   stolen base to caught stealing ratio
at t has a park factor of just       making it a
   k g   strikeouts per game
friendly confine for the giants pitching staff      
 

fitable    adaptive boostingresults
tr  examples weak classifiers test error
    
  
     
   
     
   
     
    
  
     
   
     
   
     
    
  
     
   
     
   
     
    
  
     
   
     
   
     

table    logistic regression results
training examples training error test error
    
    
     
    
    
     
    
    
     
    
    
     

 

learning algorithms

the most frequently used approach to predicting the
outcomes of sporting events is to use a straightforward  or not so straightforward  binary classification  this works reasonably well  but doesnt capture the fashion in which games unfold  i e  its not
possible to tell what the score of the game was from
a win lose label   to tackle this issue  a regression
approach was pursued  in addition to classification 
the idea of the regression approach is to forecast
how many runs a given team will score  compare
that to the forecast for the opponent  and decide from
these comparisons who is more likely to win 

   

adaptive boosting and decision trees
most of the effort in the classification realm was
spent on the adaboost algorithm  to review  the basic idea is to leverage a large number of weak classifiers  and weight them appropriately to form one
strong classifier      the weak classifiers used in the
following experiments were decision trees 
as table   indicates  the best result produced from
adaboost is     accuracy  yielded by     weak
classifiers  decision trees   no improvement was
seen moving to      training examples from      
but it is likely further gains would be possible with a
higher number of training examples  given how noisy
baseball data can be 

classification

logistic regression
as a first step towards experimenting with classification algorithms  plain old logistic regression was
run with varying numbers of training examples  as
illustrated in table    the results were less than spectacular 
it should be noted  however  that the fully fleshed
out feature set was not tested with logistic regression  so it is possible that the results would be improved  that being said  however  there is little reason to believe that plain logistic regression would
perform better than the more advanced classification
methods 

   

regression

linear regression
as another early attempt  simple linear regression
was performed  but resulted in unreasonably high error  yielding mean squared error on the run totals
of greater than    this was abandoned relatively
 

fifigure    bagged regression trees   mse

figure    bagged regression trees   classification
accuracy

quickly 
and the accuracy on the y axis 
these values were calculated using an external test
set of     examples 
quantities of learners greater than     were
briefly tested  but resulted in higher test error due to
overfitting 

bagging and regression trees
bagged regression trees yielded the best result of
the considered algorithms for this particular problem and feature set  yielding an accuracy of         
like boosting  bagging is an ensemble learning
method that utilizes a large number of weak learners  unlike boosting  however  each one is weighted
equally  and each tree is trained on some set of examples chosen randomly with replacement from the
entire training set  the predicted result is the mean
of the weak learner outcomes 
there are two ways to evaluate the performance of
bagged regression trees on the problem at hand  the
first is to compare how significantly the predicted run
value differs from the actual runs scored  this is reflected in figure    with the number of weak learners
 regression trees  on the x axis and the mean squared
error on the y axis 
the second way to evaluate the accuracy is to
use the predicted run totals to determine which team
would win the game  these results appear in figure
   with the number of learners again on the x axis

 
   

future work
additional features and data

mlb gameday data
one thing that is surely worth exploring is the utilization of major league baseballs  mlb  gameday
data  this contains a truly amazing amount of detail
about every single pitch of every single game  mlb
has installed specialized cameras in the stadiums designed to track the speed  trajectory  and break of
each pitch  from this  it could be possible to find
tendencies in pitchers and hitters and leverage that to
predict performance 
 

fifielding and defensive statistics

    bishop  christopher m   pattern recognition
and machine learning       springer 

the utilization of fielding and defensive data was notably deficient in this project  fielding percentage
alone does not sufficiently reflect how effective a defensive player or team is  consider  for example  a
player with extremely limited range  that is  hes unable to reach balls more than one foot from where
he began the play   he may be able to handle these
very well and as a result have a high fielding percentage  but clearly he is a much less effective fielder  in
preventing runners from reaching base and thus scoring runs  than someone with a larger range who is
marginally less sure handed 

    bradbury  j c  the baseball economist      
plume 
    freund  y  and schapire  robert e   a
decision theoretic generalization of on line
learning and an application to boosting  journal of computer and system sciences       
    keri  jonah  baseball between the numbers
      basic books 
    lichtman 
mitchel 
how do baseball players age 
 hardball times 
http   www hardballtimes com main article howdo baseball players age part         

incorporation of external features
data outside of baseball statistics could be incorporated into the algorithm  an example would be twitter sentiment  which has been shown to be useful in
some cases  its unclear if there would be sufficient
data from twitter to produce a meaningful signal for
a regular season mlb game  however 

   

    marsland  stephen  machine learning  an
algorithmic perspective       chapman and
hall 
    mohri  rostamizadeh  and talwalkar  foundations of machine learning       the mit
press 

other algorithms

     moscowitz  tobias and wertheim  l  jon
scorecasting  the hidden influences behind
gradient boosting
how sports are played and games are won
      three rivers press 
this is another variant of ensemble learning for regression problems that has shown promise for vari     ng  andrew  cs     autumn      
ous applications 
stanford machine learning lecture notes 
http   cs    stanford edu materials html

references

     schwarz  alan the numbers game  baseballs
lifelong fascination with statistics       st 
    adler  joseph  baseball hacks  tips   tools
martins griffin 
for analyzing and winning with statistics 
     witten  frank  hall data mining  practical
      oreilly 
machine learning tools and techniques      
    albert  jim and bennett  jay  curve ball      
morgan kaufmann 
springer 
 

fi