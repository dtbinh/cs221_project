dark matter detection  finding a halo in a haystack
paul covington  dan frank  alex ioannidis

 

introduction
tm

the predictive modeling competition platform kaggle
recently posed the observing dark worlds prize  challenging researchers to design a supervised learning algorthim that predicts the position of dark matter halos in
images of the night sky  although dark matter neither emits nor absorbs light  its mass bends the path of a light
beam passing near it  regions with high densities of dark mattertermed dark matter halosexhibit this so called
gravitational lensing  warping light from galaxies behind them  when a telescope captures an image of the sky 
such galaxies appear elongated tangential to the dark matter halo in the image  that is  each galaxy appears
stretched along a direction perpendicular to the radial vector from the dark matter to that galaxy  aggregating
this phenomenon across a sky filled with otherwise randomly oriented elliptical galaxies  one observes more galactic elongation  ellipticity  tangential to the dark matter than one would otherwise expect  fig    and     the
challenge is to use this statistical bias in observed ellipticity to predict the position of the unseen dark matter
halos  fig    and    left  
training sky        galaxies    halos

objective value for sky  

    

    

    

    

    

    

    

    

 

 

     
     
     
     
     
     
     
     

 

    

    

    

    

 

    

    

    

    

figure    left  a sky with one halo  white ball at upper left   galactic ellipticities are notably skewed by the
halo  right  plot of an objective function  described below  that we designed to have its minimum at the most
likely location for the dark matter halo  the position of this minimum is marked by a red dot in the plot at left 
training sky          galaxies    halos
    

    

    

    

 

 

    

    

    

    

figure    left  a sky with three halos  white balls  with our methods predictions indicated by red dots  due
to interactions of halos with differing strengths on each galaxy it is no longer easy to discern the position of the
halos  the now   d objective    dimensions in the position of each halo  cannot be visualized  right  ellipticity 
the elongation and orientation of an ellipse  can be described by components e  and e  such that k e    e   k     

 

fi 
   

methods
datasets and competition metric

the training data consists of     skies  each with between     and     galaxies  for each galaxy i  a coordinate
 i   i 
 i 
 x i    y  i    is given ranging from   to      pixels along with an ellipticity  e    e     here e  represents stretching
 i 
along the x axis  positive for elongation along x and negative for elongation along y   and e  represents elongation

along the line    to the x axis  fig     right   each sky also contains one to three halos  whose coordinates
are given  predicting these halo coordinates in test set skies is the challenge  in these test skies only galaxy
coordinates  ellipticities  and the total number of halos is provided 
the algorithms performance on a test set of skies is evaluated by kaggle according to the formula m   f      g
where f represents the average distance of a predicted halo from the actual halo and g is an angular term that
penalizes algorithms with a preferred location for the halo in the sky  positional bias  

   

objective function

physically  the distortion induced by a halo on a galaxys ellipticity should be related to the distance of closest
approach to the halo of a light beam traveling from the galaxy to the observer  we explored the functional form
of this radial influence on distortion by plotting distance of a galaxy from the halo on the horizontal and on the
vertical either etangential    e  cos      e  sin      the elongation along the tangential direction  or eradial
 the complementary elongation along a line    degrees to the tangential direction  for each galaxy in all single
halo training skies  fig     two functional forms were proposed to fit the dependence of tangential ellipticity on
radius  k  r    etangential  exp  r a      gaussian  and the more general k  r    etangential  exp  r a d  
 learned exponential   the parameter vector     a or     a  d  respectively  is learned from the training skies
 see parameter fitting section below  
   

learned exponential model
gaussian model

   

radial ellipticity erad

tangential ellipticity etan

   

   

   

    

    

    

    

radius r

    

   

   

   

    

    

    

    

    

radius r

    

    

figure    left  tangential ellipticity  left  for galaxies in a particular sky varies with distance from the dark
matter halo  while radial ellipticity  right  does not 
for a one halo sky the ellipticity for a particular galaxy is then modeled as 
e   x  y      k  r  cos       
e   x  y      k  r  sin       
where   and   represent the random components of the galaxys ellipticity  and  is a parameter associated
with each halo that represents its strength  and is determined from the observed galaxy data  see optimization

 

fisection below   for a multiple halo sky the influence of each of the halos on a galaxys ellipticity is assumed to
form a linear superposition  the predicted ellipticity for a galaxy i is thus 
 i 
e     x  y        

 

nh
x

 i 

 i 

 i 

 i 

 i 

 i 

j k  rj   cos  j      

j  
 i 

e     x  y           

nh
x

j k  rj   sin  j      

j  

the objective function is formed by summing the squared errors between the model predicted ellipticity compo i 
 i 
 i 
 i 
nents  e  and e    and the observed ellipticity components  e  and e    over all galaxies in a given sky 
 


e   x  y          

x
i

e i 
 

 

x

 i 
 i 
j k  rj   cos  j  

j

 


 

e  i 

 

x

 i 
 i 
j k  rj   sin  j  

j

finally  predicted halo locations   x   y     and strengths     are found by minimizing the objective for a
particular sky 
   x   y              argmin e   x  y        
 x y  

this objective is a squared error loss function for the deviation of the observed galaxy ellipticity components
from their maximum likelihood predictions given the halo positions  assuming that the deviations    and    
of each galaxys ellipticity components from their model predictions follows a bivariate gaussian with spherical
covariance  the optimum of this squared error loss function objective also is the maximum likelihood estimate
for the halo positions  moreover  assuming a uniform prior probability for the halos positions in the sky  this
maximum likelihood estimator for the halo positions is also the bayesian maximum a posteriori estimator for the
halo positions  thus  under these assumptions the highest probability positioning for the halos given the observed
galaxy ellipticities is the argmin of this objective 

   

optimization

the optimal halo strength parameters i for each galaxy can be found analytically  since the objective is quadratic
in the i   differentiating the objective with respect to each i and setting equal to zero yields a linear system
for the i  
x
x
 i 
 i 
 i 
 i 
 i   i 
a   b with aj k  
k  rj  k  rk   cos   j  k    and bj  
k  rj  etangential  xj   yj  
i

i

with the i determined explicitly  and assuming the model parameters are already fit  see parameter fitting
section below   we need to optimize the objective only over the space of possible halo positions  each halo may
be positioned anywhere in the   dimensional sky image  so we have a   d    d  or   d search space for the one 
two  and three halo problems respectively  this optimization is performed using a downhill simplex algorithm 
employing random starts to overcome local minima 

   

parameter fitting

the radial influence models etangential  exp  r a      gaussian  and etangential  exp  r a d    learned exponential  require fitting values to the parameter vector   where    a or     a  d  respectively  since we
consider these models to be approximations to a universal physical law  we require these parameters be constant
 

fifor all halos across all skies  fixing  both prevents overfitting to the training data and allows us to arrive at
a more accurate estimation of it  when fitting the more general learned exponential model these benefits are
crucial  since  in constast to a  which just alters the scaling  the parameter d alters the functional form of the
model  introducing significant flexibility and implying very high dimensionality  the parametric estimation of
 was performed similarly to the non parametric estimation of halo positions previously described  specifically 
the sum of squared errors between modeled and observed galaxy ellipticities for all single halo training skies was
minimized with respect to  

 

discussion

to determine the efficacy of our optimization algorithm  we compared the value of the objective at the true halo
locations in the training data to the value returned by the optimization routine  see fig      for modest number
of random starts  corresponding to a few minutes per sky on a desktop machine   the optimization algorithm
plateaus consistently finding a minimum below that of the true solution  this diagnostic suggests the optimization
is finding the objective functions global minumum  but this objective function minimum does not correspond
to the true halo positions  we concluded that we should focus on improving our objective function rather than
pursuing improvements to our optimization algorithm  we decided to improve our objective by refining our model
of k  r  from the gaussian form to the learned exponential form  another question addresses the validity of our

normalized objective value

    

    

    

    
  

  

  

  

   

number of random starts

   

   

   

figure   

a line is plotted for each sky showing the minimal normalized objective value  given by
returned for increasing numbers of random starts   the predicted values were derived
with our gaussian model  
e x  y   e xtrue  ytrue  
 
e xtrue  ytrue  

 i 

 i 

 i 

initial assumption of gaussian distributed deviations    and     for the galaxy ellipticity components  e  and
 i 
 i 
 i 
e    from their predicted values  e  and e     this assumption was crucial  since it allowed us to use a squared
error loss objective to find our maximum likelihood  and maximum a posteriori   estimators  the quadratic
form of this objective further allowed us to solve explicitly for the halo strength parameters i   reducing the
dimensionality of our final optimization space  unfortunately the assumption is clearly not true  the support of
 i 
 i 
  and   is the unit cirlce  fig      so their deviations must come from a pdf with a similarly limited support not
a gaussian with infinite support  however this theoretical objection is not a severe problem in practice  figure  
shows that for moderate etangential values  less than     the ellipticity pdfs are close to bivariate gaussians with
spherical covariance  moreover  so little probability density is near the unit circle boundary that approximating the
ellipticity deviations with a gaussian pdf is tolerable  this self consistently justifies our original use of a minimum
squared error objective  for regions with predicted etangential  plotted as e    larger that     approximating the
ellipticity deviations with a bivariate gaussian of spherical covariance becomes less tenable  see fig    bottom
plot  fortunately  very few galaxies lie so close to a dark matter halo as to be inside such a high predicted
etangential region   one might incorporate the departure from spherical covariance for galaxies in high predicted
 

fi  

   

   

   

 

e 

e 

 

   

   

   

 

   

   

e 

   

   

    
    

   

    

   

 
   

    

   

 

      

    
   

   

 
   

    

   

   

 
   

    

   

 

   

   

   

 

e 

   

 

      

   

   

   

e 

   

   

   

      

   

   

e 

   

   

    

    
    

   

    

e 

    
   

    
    

   

    
    

      

   

   

   

e 

   

    

figure    these four plots look across all training skies at regions of those skies where tangential ellipticity is
predicted  by the learned exponential model  to be             and    respectively  the actual tangential ellipticity
observed for each galaxy in such regions is labeled e    and its complementary ellipticity component is labeled e   
by aggregating these ellipticity values across the many training galaxies found in each region  and using kernel
density estimation  the corresponding ellipticity pdf can be found  these are the pdfs plotted above 
etangential regions by adjusting the weights of the squared errors of e  and e  to vary with the magnitude of the
predicted etangential for the galaxy  this would still not alleviate the departures from even spherical gaussian
shape that occur for extreme etangential values  

 

results

our dark matter halo position prediction algorithm performed well on both the training set and test set and
tm
compared favorably with the other kaggle
prize entrants  see table   below  here we see a comparison

gridded signal  kaggle 
maximum likelihood  kaggle 
gaussian model
learned exponential

  halo skies
distance error
    
   
   
   

  halo skies
distance error
    
   
   

  halo skies
distance error
    
    
   

all skies
distance error
    
   
   

kaggle
metric
    
    
    

table    the distance metric gives the average distance of predicted halos from actual halos on the training set 
the kaggle metric was described in methods  lower is better  and describes error on the test set 
of the performance of our initial gaussian model and our later more general learned exponential model to the
tm
performance of kaggle
provided benchmarks  against all benchmarks we showed superior results  indeed  our
algorithm outperformed even an astrophysical standard  the        line lenstool maximum likelihood code 
kaggle ranking  team skynet     th out of     competitors with score of        

 

fi