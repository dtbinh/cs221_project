cs        observing  dark  worlds  
anubhav  singla   nandan  sawant  
guide   prof   andrew  ng  
  
introduction  

the  halo     we  denote  the  ellipticity  induced  by  
the  halo  on  the  galaxy  at  distance  r  by  f r      

dark   matter   halo   is   a   hypothetical  
component   of   a   galaxy   whose   mass  
dominates   the   total   mass   of   the   galaxy   
dark   matter   is   said   to   neither   absorb   nor  
emit   light   and   therefore   cannot   be   directly  
observed    however    the   existence   of   dark  
matter   halo   can   be   inferred    it   bends   the  
space time   such   that   any   light   from   a  
background   galaxy   will   have   its   path  
altered   making   the   galaxy   appear   elliptical   
in   this   project    we   investigate   the   problem  
     of  predicting  the  halo  locations  based  on  
ellipticities  of  galaxies  in  the  sky   

the   ellipticity   of   a   galaxy   at   point    x y   
tangential  to  the  halo  at   x y   is              
     cos         sin       where      is   the  
angle   of   the   galaxy   with   respect   to   the   point  
 in  our  case   the  dark  matter  center   given  by  
   arctan

     
     

however    the   galaxies   are   inherently   elliptical  
 and   not   circular     moreover    we   are  
approximating       dimensional   distances   and  
ellipticities   in       dimensions    we   model   the  
effect  of  all  these  factors  as  an  additive  white  
gaussian  noise     

problem  and  data  

for  a  galaxy  at  point   x   y    we  can  write   

the   data      consists   of         training   skies   and  

                             

      test   skies    each   sky   contains            
galaxies    locations    x       y   co ordinates    and  
ellipticities    e        e     of   the   galaxies   are  
known   a  sky  can  contain         or     halos   the  
number   of   halos   in   each   sky   is   told   to   us   a  
priori    locations    x       y   co ordinates    of   the  
halos  in  the  training  skies  are  provided  to  us   

     x    y    is   the   halo   location   and  
                            
converting  back  to  e   and  e    
         cos         
         sin         

our   goal   is   to   accurately   predict   locations   of  
the  halos  in  the  test  skies   evaluation  metric       
is   the   average   distance   between   predicted  
and   actual   halo   locations    with   an   additional  
penalty  term  for  any  angular  bias   

in  case  we  have  n  halos  in  the  sky     
 

   cos                      

        
   

model  

 

   sin                      

        

the   ellipticity   induced   by   the   dark   matter  
halo   on   the   galaxy   is   tangential    we   assume  
that   the   ellipticity   induced   is   radially  
symmetric  and  a  function  of  the  distance  from  

   

in  vector  notation   

   
  

   

fi 

       

              
   

where   
e  
   
 e   
e  t  
and  
t
         cos          sin         
for   each   sky    we   are   given   e x y    for   all   the  
galaxies    we   want   to   predict   halo   locations  
 x y    that   best   explain   these   observations   
we   use   the   model   described   above   to   design  
the  prediction  algorithm   

  
figure      lwlr  curve  modeling  induced  ellipticity  as  a  function  
of  the  distance  between  halo  and  the  galaxy  

effect  of  halo  versus  distance  

figure   shows    the   red   curve    our   estimate   for  
f r     we   also   plot   the   histogram   of   deviation  
from   the   lwlr   estimate    this   reaffirms   our  
assumption  that  the  noise  is  awgn   

in   this   section    we   learn   f r     the   induced  
ellipticity   as   a   function   of   distance   from   the  
halo     
the   function   f r    can   be   derived   using   the  
theory   of   gravitational   lensing   but   this  
approach  
would  
require  
a  
deep  
understanding   of   the   subject   matter    we  
tried  several  data  driven  approaches    linear  
regression   polynomial  fit   of  up  to   th  order   
and   locally   weighted   linear   regression  
 lwlr     lwlr   seemed   to   give   us   the   best  
results    which   we   describe   below    this   isnt  
surprising   given   the   enormous   amount   of  
data           data  points    which  ensures  that  
lwlr   does   not   over fit   and   at   the   same   time   
provides   more   degrees   of   freedom   than   a  
linear  regression  or  a  small  order  polynomial  
fit   

  
figure      the  deviation  from  the  lwlr  fit  of  induced  ellipticity  

further    we   conjecture   that   f r    is   not  
identical  for  all  halos   in  the  physics  context   
we  can  attribute  this  to  halos  having  different  
masses   and   sizes    based   on   our   crude   data  
analysis   we  assume  that  there  are     types  of  
halos   and   run   an   unsupervised     means  
clustering   algorithm    the   labels   were  
assigned  to  the  halos  based  on  the  minimum  
norm   while   the   cluster   centroids   were  
computed   using   lwlr    notice   that   this   is  
slightly   different   from   the   traditional   k 
means   clustering    figure   below   shows   the  
two  corresponding  lwlr  cluster  centroids   

we   first   look   at   the   training   skies   with   only  
one   halo    for   each   sky    we   compute   the  
tangential   ellipticities   of   the   galaxies   with  
respect  to  the  halo  location   we  run  a  locally  
weighted   linear   regression   between   the  
computed   tangential   ellipticities   and   the  
distance  between  the  halo  and  the  galaxy   we  
see  the  following  results   

   
  

fiwith  these  feature  vectors  at  disposal   we  can  
potentially   model   the   problem   as   a   logistic  
regression   and   train   it   using   a   soft max   or  
svm   classifier    however    given   the   variable  
number  of  galaxies  in  each  sky   small  number  
of   training   skies           as   compared   to   the  
typical   size   of   such   feature   vector              
and  a  priori  knowledge  of  number  of  halos  in  
the   sky    we   instead   use   a   matched   filter     
technique   known   to   be   optimal   for   signal  
processing   problems   with   gaussian   noise  
profiles   

  
figure      lwlr  cluster  centroids  after    means  clustering  

let   eij   be   the   observed   ellipticity   feature  
vector   for   the   candidate   halo   location          
according   to   matched   filter   technique    we  
pick   halo     location   x y   as  

we  also  observe  that  a  significant  fraction  of  
halo    s   was   mapped   to   the    blue    cluster  
centroid       while   most   of   halo       and       were  
mapped   to   the    red    cluster   centroid       
moreover    running   clustering   algorithm   on  
halo       and       alone   does   not   yield   such  
separation    this   leads   us   to   the   conclusion  
that  halo     is  much  stronger  than  halo     and  
     in   further   discussion    we   model   halo       by  
f  r   and  halo     and     together  by  f   r      

    

arg max
     

     
  

 

  

where    f ij   is   the   predicted   ellipticity   feature  
vector  based  on  the  distance  based  modeling  
described   in   figure        note   that   this   is  
nothing   but   the   weighted   average   of   the  
components   of   the   feature   vector   i e    this   is   of  
the   form          figure   below   shows   the  
matched  filter  output  over  the  candidate  halo  
locations     

matched  filter  approach  
in   the   last   section    we   showed   that   the   effect  
of   halo       is   much   stronger   than   the   effect   of  
halo       and        therefore    we   can   estimate  
location   of   halo       independent   of   halo       and  
halo     treating   interference   from   halo       and      
as  noise   
we  discretize  the  problem  by  dividing  the  sky  
into  a  fine  grid   center  of  each  grid  square  is  a  
candidate   for   the   halo       location    if   the   sky  
contains   g   galaxies    each   candidate   halo  
location   can   be   represented   by   a   g  
dimensional   feature   vector   where   gth   feature  
corresponds   to   tangential   ellipticity   at   the  
galaxy   g   with   respect   to   the   candidate   halo  
location     

  
figure      matched  filter  output  for  halo     prediction   red  dot  is  
the   actual   halo       location   while   black   dot   is   the   predicted  
location  for  halo      

   
  

fiafter  predicting  halo      we  subtract  the  effect  
of  halo     for  each  galaxy  and  re compute   the  
feature  vectors    we   use   similar   matched   filter  
technique   for   halo       and       and   choose   halo  
locations   x y   such  as  

location   making   the   likelihood   of   finding   the  
next  halo     in  the  close by  grid  squares   
low  pass  filtering  
nearby   grid   squares   in   the   sky   would   have   a  
similar  likelihood  of  being  the  halo  locations   
therefore   we  pass  the  output  of  the  matched  
filter  through  a  low  pass  filter  to  average  out  
any  abrupt  variations     

    

arg max
     

      
  

  

  

where     f  ij  is  the  predicted  ellipticity  feature  
vector  based  on  the  distance  based  modeling  
described   in   the   previous   section    figure  
below  shows  the  matched  filter  output  of  the  
sky  after  subtracting  the  effect  of  halo        

further  classifying  halo     
we   further   classify   the   halo       into   two  
categories      strong   and   weak   and   use   a  
separate   distance   dependence   of   induced  
ellipticity   for   each   class    the   detail   that   was  
omitted  in  earlier  sections  for  simplicity   
results  
our   algorithm   does   an   excellent   job   of  
predicting   halo       locations    the   scatter   plot  
below   testifies   for   the   accuracy   of   our  
predictions     

  
figure        matched   filter   output   after   removing   halo        notice  
that   the   red   cluster   indicating   high   values   around   halo       has  
disappeared   black  dot  indicates  the  prediction  while  green  and  
blue  dots  indicate  actual  halo     and     locations   

the  process  above  is  repeated  for  each  sky   
additional  heuristics  
we   also   implement   some   additional  
heuristics  to  improve  the  performance  of  our  
system   

  
figure      predicted  locations  vs   actual  locations  for  halo      note  
that  most  predictions  fall  around  the  slope     line  

zero  padding  

we   achieve   the   average   halo    distance   error  
as  low  as      units   the  evaluation  metric     of  
      can  be  achieved  for  halo      

we   observe   that   the   locations   of   the   two  
halos   in   the   sky   are   sufficiently   separated   
therefore    after   detecting   a   particular   halo   
we   zero   pad   the   area   around   the   predicted  

however   the  performance  for  halo     and     is  
not   as   great    figure   below   shows   the   scatter  
   

  

fiplot   of   predicted   halo   locations   versus   actual  
locations  for  halo      

is  shown  below   we  also  use  this  histogram  to  
fine  tune  the  parameters  of  our  algorithm   

  

  

figure      predicted  locations  vs  actual  locations  for  halo          

figure      histogram  of  performance  metric  for  randomly  chosen  
test  sets  of       skies  each  

notice   that    although   the   points   are   close   to  
the  slope     line  to  an  extent   there  are  a  large  
number   of   misplaced   halos   increasing   the  
average   distance   error   to   around             
units   for  randomly  chosen       skies    

one  can  notice  that  the  performance  averages  
around   the   score   of          with   standard  
deviation   of          and   the   best   score   of            
our   score   on   kaggles   public   test   set   is          
here  is  a  summary  of  the  performance     

we   have   a   theoretical   explanation   for   this  
performance    from   figure        the   standard  
deviation   of   awgn   noise      is          the  
matched   filter   computes   the   weighted   sum  
over   all   the   galaxies    which   brings   down   the  
noise   to     

 
 

benchmark  
randomly  placed  halos  
gridded  signal  benchmark  
lenstool   
our  algorithm    

                   where   g   is  

   based  on  theory  of  gravitational  lensing  
    averaged  over  the  training  set  

the   number   of   galaxies    based   on   the   lwlr  
curve   found   in   figure        the   magnitude   of  
average  tangential  ellipticity  induced  by  halo  
    is            halo       is   therefore   accurately  
estimated    on   the   other   hand    the   average  
induced  ellipticity  for  halo     and     is  close  to  
       this  value  being  close  to  the  magnitude  
of  the  noise  leads  to  poor  prediction   

acknowledgements  
wed   like   to   thank   prof    ng   and   the   entire  
cs      teaching   staff   for   their   able   guidance   
wed  like  to  thank  kaggle com  for  the  dataset   
references  
     http   www kaggle com c darkworlds   

to  provide  a  better  measure  of  performance   
we   randomly   chose         skies   out   of   the        
training   skies   provided   to   us    as   our   test   data   
we   compute   the   evaluation   metric   for   this  
test   set    we   repeat   this   process   for          such  
test   sets    the   histogram   of   the   performance  

     
http   www kaggle com c darkworlds detai
ls evaluation    
      wireless   communications   by   andrea  
goldsmith   cambridge  univ   press         
   

  

score  
      
      
      
      

fi