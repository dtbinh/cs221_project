predicting airline delays
raj bandyopadhyay  rafael guerrero
          

introduction
in this project  we use publicly available data originally from the bureau of transportation statistics
to analyse and predict flight departure delays for a subset of commercial flights in the united states 
we have three goals in mind  first  we would like to identify the factors which are most likely to cause
flight delays  second  we want to predict whether an individual flight will be delayed  finally  if there
is a delay  we would like to estimate its magnitude 
in this paper  we first describe the important features of the data  along with our preliminary preprocessing and analysis  as part of this step  we use linear regression to identify the most important
factors aecting delays  subsequently  we use a classifier  svm  to predict if there will be a delay  to
estimate the magnitude of delays  we use a non parametric quadratic regression algorithm 

the airline delay data set
the original data set     contains information for all commercial flights in the us from      to      
since the data set is extremely large  several million records  we extracted a reasonable subset of the
data as follows 
 two years       and      
 one airport of origin  ohare  chicago   since it is one of the busiest airports and is exposed to
a wide range of weather conditions 
 one airline  aa  american airlines   since it is the largest airline using the ohare airport 

this reduces the size of our data set to around        records  for each record  we use secondary data
sources to enrich it with information about airplanes and historical weather statistics  at the end of
the pre processing steps  our data set has the following features 
 flight features  these include the times of departure and arrival  the destination airport  and
the distance covered by the flight  except for the distance  we convert all variables to categorical
form 
 airplane features  these include the make and model of the plane  its age and engine type 
 weather features  we use the weather underground api     to obtain historical weather information for the time closest to the departure time  the weather data includes several categorical
features indicating the presence of snow  hail  thunder  rain and tornado warnings  it also contains
a few numeric features such as wind speed  temperature and humidity 
 

fifigure    linear regression coecients for selected features

preliminary analysis using linear regression
as our first pre processing step  we use histograms and basic plots to eliminate features that have no
impact on the delays  such as the airplane manufacturer and temperature  we then use linear regression
 as implemented in r      as a quick and dirty first technique to examine the data  our goal with linear
regression is threefold  first  we want to use the regression parameters to identify prominent factors
aecting delays  second  we would like to get a baseline estimate of how accurately delays can be
predicted  third  we want to analyse how the prediction error changes with the size of the training set 

features aecting delays
the coecients of the linear regression  figure    give us a good idea of the relative importance of
various features  we observe that the features most correlated with delays are the flight departure
times  followed by certain bad weather conditions  for example  flights departing during evening hours
 around   pm  tend to have more delays  also  adverse weather conditions such as snow  thunderstorms 
rain  sleet and fog show a high correlation with delays  somewhat surprisingly  the month has little
eect on the delay  in fact  certain months  such as october  even show a small negative correlation 
indicating that flights tend to be early in those months 

influence of training set size
in order to study the eect of training set size  we run cross validated linear regression on data sets
ranging from     to        samples and measure the root mean residual error  the data sets are
generated by randomly sampling the original data  we find that beyond       samples  this error
remains practically the same for all sample sizes  this leads us to conclude that for a well shued data
set  the size of the training set has little influence beyond a relatively small size of       points 

predicting delay with classifiers  naive bayes and svms 
in order to predict whether a flight will be delayed or not  we model the problem as a classification with
two classes  delayed for flights with delays above    minutes  and non delayed otherwise  using the
 

fitable    performance of classifiers in predicting non delayed flights
accuracy   precision recall f score
naive bayes
    
     
    
    
svm  unweighted 
     
     
     
     
svm  weighted    fn      fp 
    
     
     
     
random forests  unweighted 
     
     
     
     
random forests  weighted 
     
     
     
     
table    performance of classifiers in predicting delayed flights
accuracy   precision recall f score
naive bayes
    
     
     
     
svm  unweighted 
     
     
     
     
svm  weighted    fn      fp 
    
     
    
     
random forests  unweighted 
     
     
     
     
random forests  weighted 
     
     
     
     
weka machine learning toolkit      we first apply a naive bayes algorithm with ten fold cross validation
on the entire training set  the naive bayes algorithm runs extremely fast and provides some baseline
results  as shown in tables   and   
the naive bayes results show us that the classifer performance is far better in predicting non delayed
flights than delayed ones  the f score on predicting on time flights is       while that for delays is only
       so  how can we improve the performance of the classifier  particularly in predicting delays 
we train an svm  which is reputed to be the best out of the box classifer  our initial attempts
at using the svm  with a gaussian kernel  does not greatly improve performance  in fact  the svm
performs slightly worse than naive bayes in predicting delays  f score        
since its more important  in our opinion  to predict a delay correctly than an on time flight  we
run an svm again  this time setting a      cost penalty for delays  that is  predicting a false negative
incurs    times the cost of a false positive  this step improves our classification result significantly for
delays  pushing the f score slightly above naive bayes  but it adversely impacts the classification of
on time flights 
as a digression  we also show some classification results with random forests      while they
perform worse in general than naive bayes and svms  running random forests with a weighted penalty
improves classification on delays without significantly hurting that on non delayed flights 

estimating delay magnitude with non parametric regression
why does linear regression perform so poorly  in order to investigate this question  we perform some
experiments on a smaller training set        samples  and test set         samples  we first plot the
distributions of the actual and predicted departure delays and notice a very large discrepancy  while
the distribution of predicted delays looks spread out  the actual delays are drawn from an extremely
skewed and narrow distribution  figure     this results in a high rms error     minutes  
our first thought is to use a glm to model the delay distribution  the glm is based on a gamma
distribution  whose shape is close to the actual delay distribution  in order to get this to work  we add
 

fifigure    distribution of actual delays  left  predicted by linear regression  right 

a positive number to the delay  since the gamma distribution is only defined for non negative numbers 
however  when we use a glm  our rms error actually increases to    minutes  this is because while
the glm models the peak of the delay distribution well  it fails to fit the tail  thereby performing
poorly on large delays  figure    
our next approach is to use a non parametric regression model  based on the following justification 
   we need a way to model the skewness of the distribution 
   small training sets do as well as large ones 
   in real life  airplane delays often occur in clumps  i e   flights get delayed around the same time 
this is borne out by some simple time series plots  can we use this fact to our benefit 
since we have several features in our data set involving flight departure time  month  day  hour   flights
closer in time to a given sample flight are more influential on the prediction for that sample  also 
the slow execution time of non parametric regression can be mitigated  in this case  by using a smaller
training set without losing much in terms of predictive power 
using a non parametric regression implementation in r and cross validation  we train several models
on randomly constructed sample data sets and evaluate the best parameters for the model  we find
that a locally weighted quadratic regression gives us the best results that we have attained so far in
terms of modeling the delay distribution  however the rms error decreases only slightly to    minutes 

discussion
we have had mixed success in attaining our three goals for this project  we have achieved the first
goal of identifying factors that influence delays using a simple linear regression  for the second goal
of predicting whether a flight will be delayed  we have shown that overall  a simple naive bayes does
pretty well  a weighted svm does a slightly better job in predicting delays  but takes a much longer
time to train  our eorts have been least successful in estimating the delay magnitudes  while a

 

fifigure    predicted delay distribution with glm  gamma  regression  left  and non parametric regression  right 

non parametric regression produces a distribution of predicted delays that is closer to the actual delay
distribution  it still has a high rms error overall 
why is the data so resistant to prediction  in our opinion  the highly skewed distribution has an
important eect on the algorithms  the distribution has two main characteristics     a very high peak
around zero and    a long right tail  all of the algorithms we tried so far do very well on one of the two
characteristics at the expense of the other  for example  the glm gamma regression captures the peak
but not the tail  while the non parametric regression captures the tail but not the peak  as a result 
each algorithm makes either a few big mistakes on larger delays  or many small mistakes on smaller
delays  thereby keeping the rms error high 

future work  using a mixture model
based on our experience with this data set so far  we would like to try a density estimation approach 
since each of our current models has diculty modeling either the tail or the peak of the delay distribution  we would develop one model for the peak  small delays  and another for the tail  long delays  
this is analogous to using a mixture of gaussians  but our models would not necessarily be gaussian 
assuming that our data is drawn from this mixture model  we would estimate the parameters governing
the individual components using an expectation maximization  em  approach 

references
    american statistics association  data expo       http   stat computing org dataexpo      
    the weather underground api  http   www wunderground com weather api 
    the r project for statistical computing  http   www r project org 
    weka  http   www cs waikato ac nz ml weka 
    random forests  http   www stat berkeley edu  breiman randomforests cc home htm
 

fi