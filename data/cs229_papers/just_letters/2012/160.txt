stock option price prediction
abraham adam

   introduction
the main motivation for this project is to develop a better stock options price
prediction system  that investors as well as speculators can use to maximize their
returns 
many research papers have been written to help investors predict stock price as
well as pick portfolio to maximize their returns  however  the there isnt much
papers that exist for maximizing returns on stock options or predicting stock
option prices 
looking at nips and icml  i saw there is a papers for better comping up with a
better stock price predicting  based on the given conditions  however  it assume
that you already knowing the stock prices for the option 
the goal of this project is develop a system that will help predict the percent
price change for a stock and use that to predict the percent price change of the
underlying option for the stock  this can also be used in order to help predict
best option portfolio to help or develop an options trading strategy to maximize
returns 
   options overview
stock options are investment instruments that are mostly used in order to
minimize risk for a stock trader  an option contract comes in two types 
      call options  allows the owner to buy     shares of the underlying
equity at the price the option specifics 
      put options  allows the owner to sell     share of the underlying equity
at the price the option specifics 
options have expiration date  as such the price of an option decreases with each
passing day until they become worthless if they are out of the money     or equal
to the difference between the price of the equity and option contract if its in the
money    options come in two flavors   american and european   the difference is
that american options can be exercised at any time while european options can
only be exercised at expiration  for the purpose of the project we will think of all
the options as european options 
date  december          
 
higher than the equity price for call options  and lower than the equity price for put options
 
lower than the price of the option for call options  higher than the price of the equity for put
options
 

fi 

abraham adam

some speculators and traders choose to use options in order to maximize risk and
reward rather than minimize risk  the reason that options as risky is that they
are constantly losing value and their price is affected by volatility sense they are
intended to counter volatility  if the stock doesnt move the expected direction
fast enough  the owner of the option can lose more of the value of the option on
time decay and volatility 
   data sets
for the purpose of this project    stocks where chosen as the examples for the
general stock market  those two are 
    intel which is a dow    component  it represent a large cooperation with
low volatility 
    nvidia which is a nasdaq component  it represents a smaller company
with high volatility 
for the two stocks chosen  stock volume   open price  closing price  volume  high
and lower were obtained from yahoo   from the time they went public to
december  th        this data was used to compute technical indicators that
helped us predict stock prices for future days 
options data were also obtained for both stocks from ivolatility   for   month of
data june  th       to december  th         that is     trading day  and every
day has in the range of     different option   different strike price and expiration
dates for each call and put  the data that was obtained contains  option type 
strike price  mean option price  volume open interest 
delta vega gamma theta rho  
   stock and option parameters
     stock indicators  in order to predict the change in price for a stock 
technical indicators are used to help point the direction we expect the stock to
move  below is a small description of the    technical indicators that are used  
    stochastic oscillator  location of the current price relative past prices 
    relative strength index  how strong is the stock moving in its direction 
    chaikin money flow  measures if money is flowing in or out of the stock 
    simple moving average  average over the stock prices for a given period 
    exponential moving average  gives higher value to later values 
    macd  difference between two emas
    williams  r  determine if stock overbought over oversold 
    ultimate oscillator  combines moving averages from different periods 
    mass index  indicates reversal based on different from high and low 
     volatility  standard deviation of a stock over a period 
there is a total of    features because different parameters are used in sma and
ema to capture more of the trend 
 
nvidia  http   finance yahoo com q hp s nvda historical prices 
intel  http   finance yahoo com q hp s intc historical prices
 
http   www ivolatility com data download
 
explanation of each of those parameters is in the following section
 
for exact details about how to calculate each of those indicators go to the stockcharts com
link in the references

fistock option price prediction

 

     option parameters  when looking at an option it is important to
understand how its price change depending on the underlying equity as well as
due to time decay and volatility  those factors are captured by the greeks for
each option 
p rice
delta  option
equity p rice   change in option priced based on underlying equity
   option p rice
   equity p rice   sensitivity of delta to underlying equity
option p rice
vega  equity v olatility   change in option priced based on volatility of equity
p rice
theta  toption
ime to maturity   amount lost from option value for every passing day
option p rice
rho  riskf reei nterest   change in option price based on change of riskless interest

gamma 

   data processing
for stocks  instead of using the stock price as the the expected output for our
algorithm  the change in price with respect to the day before is used instead 
the ema and sma values that we got are subtracted from the stock price and
divided by the stock price so we only have to see the difference of the averages
with respect to the stock  that is needed because the expected output is the
days change
the technical indicators for the stock were normalized with respect to the mean
and the variance  this was needed because some of the data are stochastic data 
so they only oscillate between a certain range  while other are free numbers 
as extra features for each option  the number of days till expiration  and volume
of the underlying stock was added  for performance reasons   the options
parameters set is filtered to contain only the options with strike price within  
dollars of current price  after filtering we have about       data points for each
stocks 
black scholes   was calculated for the options based on the predicted stock prices
and it was used in the calculations 
   steps for stock price prediction
the first step for future options price change is being able to predict the price
change of the underlying stock  with some reasonable correctness  in order to
predict the price change of the future  the technical indicators pointed above are
used 
at first an attempt was done to generate regression lines using svm  however 
after realizing that the model observed gives over     error on the training set  a
switch was done to try support vector regression epsilon and nu with gaussian  
kernel which provided much better results  the same data sets were with lms
linear regression to see if the results are improved on the training set 
 running any learning algorithm on the full set takes over    minutes
 http   en wikipedia org wiki black scholes
 the function that is chosen is radial basis function

fi 

abraham adam

   steps for option price prediction
before testing predicted the price of options based on the prices predicted  option
prices where predicted based on the true price  that showed high enough results 
so a swap was made to the predicted stock price with confidence in the option
prediction system 
when predicting the prices three measurement were made in order to see what
helps us get the most accurate result  first  measuring options price based on
price change and the options parameters listed above  second  measuring options
prices based on black scholes with no learning  just applying the equation 
lastly  measurement where taking for using the result of black scholes as a
parameter to svr and lms 
for testing the results stated below is based on     of the options data going to
training set and     of the data going to test set 

   results for option price prediction
correctness is a measurement of the number predictions that are within a certain
of margin of error from the true price divided by the total number of predictions 
correctness proves to be a more accurate indicator of how good is the prediction
than mean square error because the large number of options in the test set 
below c    denotes correctness within the  
results with actual stock price ran on the nvidia set

set
training set without black scholes svr
training set without black scholes lr
training set without ml
training set with black scholes svr
training set with black scholes lr
test set without black scholes svr
test set without black scholes lr
test set with black scholes svr
test set with black scholes lr

mse
      
      
      
      
      
      
      
       
      

c     
        
        
        
        
        
        
        
         
        

c     
        
        
        
         
        
        
        
         
         

c     
        
        
        
        
        
        
        
         
         

from the results above its clear that running svr with with black scholes yields
the best result  so when running the learning algrothem on predicted prices for
nvidia and intel we will measure the expected prices using black scholes svr
results with predicted prices for nvidia and intc

fistock option price prediction

set
mse
test nvidia for next day
      
test nvidia for next   day       
test nvidia for   day
      
test intel for next day
      
test intel for next   day
      
test intel for next   day
      
results for prediction for nvidias stock
set
mse
test nvidia for next day
      
test nvidia for next   day       
test nvidia for   day
      

c     
        
        
        
        
        
         
price
c       
        
        
        

c     
        
        
        
         
        
        
c      
        
        
        

 

c     
        
        
        
        
        
         
c      
        
        
         

   conclusion
with over     accuracy we can predict options for next day    days and next  
days  if     error is allowed  and nearly     accuracy if     error is allowed 
black scholes dramatically improves the correctness of svr as well as lr  and
adding the greeks adds a slight improvement over just running black scholes
with no machine learning 
one thing worth noting is that even though the correctness of the predicted
option price is low  svr attempts to make up for the difference and produced
better results for the option pricing than we had for the expected stock change 
we also notice that increasing the number of days we look in the future doesnt
significantly lower the correctness 
in the future  it is worth putting more time into doing a better job predicting the
underlying stock prices  the day of the week or month of the year can be added
as helpful parameters  analyzing the news may also help yield higher accuracy   as
words as federal reserve or war may help us predict the price change better 
    references
 articlecc  a  author   chang  chih chung and lin  chih jen  title  
libsvm  a library for support vector machines  journal   acm transactions on
intelligent systems and technology  volume      issue      year         pages  
           note   software available at http   www csie ntu edu tw  cjlin libsvm
 miscwebsite stockcharts  author   interactive data corp  title   technical
indicators and overlays  year              url  
http   stockcharts com help doku php id chart school technical indicators
 miscwebsite cs     author   ng  andrew  title   machine learning at
stanford  year         url   http   cs    stanford edu materials html
 book author   haug  espen gaardner  title   the complete guide to
option pricing formulas  year         publisher   mcgraw hill
professional

fi