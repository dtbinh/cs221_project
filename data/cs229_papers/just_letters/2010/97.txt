automated classification of galaxy zoo images
cs    final report
michael j  broxton   broxton stanford edu

   introduction
the sloan digital sky survey  sdss  in an ongoing effort to collect an extensive image and spectral
catalogue of deep sky objects  billed as the most ambitious and influential survey in the history of
astronomy  the sdss contains rich information that has had a significant impact on our understanding of
the history  structure  and evolution of our universe  york        unfortunately the enormous size of the
sdss data catalogue makes it unwieldy and difficult to analyze by hand  one viable approach for
processing sdss data on a large scale was demonstrated in      by the galaxy zoo   project  lintott
       in which internet users were asked to categorize millions of images of galaxies into three
morphological classes  elliptical  spiral  or other    however  after one year of collecting user input  this
effort ultimately classified only   million out of     million objects in the survey catalog  with more
observations being added on a daily basis  there is an ever growing need for robust  automated analysis
  classification techniques 
the goal of this project is to demonstrate that machine learning algorithms can be trained to produce
results that consistently agree with galaxy classifications produced by human click workers  using
classification statistics released by the galaxy zoo project for nearly         objects  lintott       as a
training   validation data set  we show that modern machine learning architectures can be trained to
perform well on the sdss galaxy classification task  we directly compare galaxy morphology
classifications produced by our algorithms to those produced by galaxy zoo users  with this as our error
metric  we test various machine learning approaches using two different feature modalities that are readily
available from the sloan digital sky survey      hand engineered features that are good proxies for
galaxy morphology  e g  color  luminosity  spectral
features  or structural parameters   and        x   
green   red
green minus red color  red shift removed 
pixel    channel color images of the galaxies  note
red   infrared
red minus infrared color  red shift removed 
that human classifiers on the galaxy zoo website
devab i
axial ratio for a fit to a galaxy bulge model
 de vaucouleurs fit axial ratio 
based their classifications solely on color imagery  i e 
expab i
feature set      it is therefore a primary objective of
axial ratio for a fit to a galaxy disk model
 exponential fit axial ratio 
this project to determine whether a machine classifier
liklihood of being well modeled as a galaxy
lnlexp i
 disk fit log liklihood 
with a disk like feature
can produce comparable results using the image
liklihood of being well modeled as a galaxy
lnldev i
feature set alone  in section   we describe these
 star log likelihood 
with a central bulge feature
feature modalities in more detail  then in section   we
liklihood of being well modeled as a point
lnlstar i
present two machine learning architecture for
 star log likelihood 
source
processing color galaxy images  results are
ratios of radii containing    and    percent of
petror   i petror   i
 concentration 
the petrosian flux
presented in section    and we discuss our
second moment of object intensity in the
mrrcc i
conclusions in section   
ccd  robust to noise 
ae i

   feature modalities

mcr  i
texture i

it has been shown in various studies  odewhan
       lahav       ball       elting       banerji
      that promising automated galaxy classification
rates can be achieved by leveraging the wealth of
morphological and photometric statistics available in

adaptive ellipticity    based on me  and me  
adaptive fourth moment
ratio of range of fluctuations in surface
brightness to full dynamic range of object

table    these    hand tuned features capture the color 
morphology  and photometric properties of galaxies  they are
available for download for all sdss observations  and were
chosen here because they were used in previous galaxy
classification studies  specifically  banerji        

  the other category in the galaxy zoo data set is used for hybrid objects like galaxy mergers or partially occluded galaxies  or objects that were

incorrectly classified as galaxies by sdss automated data pipeline  such as stars and quasars 

michael broxton  cs    final report

fithe sdss database  for consistency with past
studies  we chose the same twelve features
used in  banerji        listed in table     these
capture a range of properties including the
galaxys color  degree of ellipticity  and surface
brightness profile  classification using handtuned features serves as a baseline case for the
purposes of this study 
our novel contribution is to show that modern
machine learning architectures can classify
galaxies using exactly the same input as was
available to human classifiers  namely color
galaxy images alone  in fact  we will show that
image features consistently outperform handengineered morphological and photometric
features  in order to achieve this result we found
it necessary to first compute the fourier
transform of the imagery  take the magnitude of
the result  i e  discarding phase information   and
then cropping this power spectrum image to
retain only the low frequency components  this
spectral signature still contains most of the
salient information from the original image  but is
invariant to phase and robust to the high
frequency image noise that is prevalent in
galaxy zoo images  this approach was inspired
to a certain extent by models from neuroscience
of complex visual receptive cells that respond to
the frequencies and orientations of imagery  but
exhibit a high degree of phase invariance  such
complex cells can be well modeled as acting on
the power spectra of visual stimuli  david       
in our case  the intuitive justification for this preprocessing step is that the frequency content
and orientation of galaxy images contain salient
features that are useful for detecting spiral
structure and elliptical eccentricity respectively 
whereas the phase is less important since the
positions in an image of disks  bulges  spiral
arms  and other features do not encode much
useful information for classification purposes 

galaxy zoo
images

normalization  cropping

compute magnitude of fft 
crop to discard high freq 
spectral signatures

whiten  pca 
ica
independent components

multiply ic s   spectral signatures

input layer

sparse layer  greedily trained 

sparse layer  greedily trained 

softmax layer

activations
support vector machine

sparse network

ica   svm

classifications
  spiral  elliptical  other  
figure    our two machine learning architecture for galaxy
classification learn sparse features on the fourier power spectrum
of galaxy images  in this study we consider two architectures that
first learn useful features from the imagery in an unsupervised
setting  and then we conduct supervised training using class labels
from the galaxy zoo data set 

figure   shows these pre processing steps in
more detail  images are first normalized and then cropped to a    x    pixel window centered on the
galaxy  the square root of the fourier power spectrum is then computed by taking the magnitude of the
fft for each galaxy image  the resulting    x    pixel frequency space image is further cropped to the
center   x   pixel region  in essence throwing out high frequency components of the fft that are
dominated by image noise  finally  the data is whitened using pca  retaining     of variance   we refer
to the final whitened spectral image as the spectral signature of the galaxy 

michael broxton  cs    final report

fi a 

 b 

 c 

figure    three sparse feature dictionaries learned from the fourier power spectrum of galaxy zoo images  the features produced
using ica  a  and the sparse autoencoder  b  are similar  both contain filters that select for an assortment of frequencies  round 
ring like features  and orientations  asymmetric  oriented features   some sparse autoencoder features change after fine tuning
 c   while others remain largely the same  note that color seems to play an important role in feature morphologies  different color
channels often select for different frequency characteristics within the same filter 

   learning architectures
we have developed two separate systems that learn sparse features on the fourier power spectrum of
galaxy zoo images  the ica svm system  left half of figure    uses independent component analysis
 ica  to learn m independent components that exhibit a high degree of selectivity for frequencies  via
round  ring like features  and orientations  via asymmetric  oriented features   figure   a  shows typical
independent components learned from spectral signatures  we then compute activations for a given
galaxy image by multiplying spectral signatures by each independent component  this produces m
activations per galaxy  we selected m      in this study   finally  we train a svm using a linear kernel on
these activations to match known classifications in our training data set 
our second approach employs a neural network with hidden layers that are greedily trained as sparse
autoencoders  ng        during pre training  this sparse network system learns a set of features like
those depicted in figure   b   features are subsequently refined during the supervised fine tuning phase
 see figure   c   at the same time as the network trains its softmax output layer to identify galaxies 
sparse weights are held constant during the first    iterations of fine tuning  and then allowed to change
during the remaining         iterations or until the algorithm converges  in this study we tested networks
with one or two sparse hidden layers  each containing     sigmoidal units trained with a lifetime sparsity
constraint as well as a regularization term that helped to prevent over fitting 
note that the ica svm approach produces hard classifications with only one label per galaxy  whereas
the sparse network  by virtue of its softmax output layer  produces soft classifications with three
separate probabilities that indicate the likelihood that a galaxy is a member of each class  we will show in
section   that soft labels are useful for rejecting low confidence matches that would otherwise appear as
false positives in the final results 

   results
we consider three subsets of the galaxy zoo data for testing and validation of these algorithms  the
clean subset contains galaxies for which     or more of human classifiers agree on a given galaxys
class  we also consider an uncertain subset for which only     or more of human classifiers agree 
finally  we test performance on the full galaxy zoo data set  rejecting only those entries with incomplete
metadata from the sdss  in which there is sometimes substantial human disagreement  the uncertain
and full subsets contains images that are far more challenging for humans to categorize consistently  and
it shows how the performance of our algorithm degrades as data becomes increasingly ambiguous  all
michael broxton  cs    final report

ficlassifier   feature set  
prior art  banerji et  al       
 hand tuned features 

clean subset

uncertain subset

     or better human agreement 

     or better human agreement 

elliptical

spiral

other

overall

 
reject

elliptical

spiral

other

overall

 
reject

elliptical

spiral

other

overall

 
reject

   

   

   

  

  

  

  

  

  

  

   

   

   

  

  

softmax regression                             
 hand tuned features 

support vector machine            
 hand tuned features 

 

ica   support vector machine                 
 power spectral features 

full dataset

                            

                            

     

  

           

  

     

  

                

     

  

           

  

     

  

     

  

           

  

     

  

sparse network    hidden layer                              

                            

                           

sparse network    hidden layers                              

                            

                           

sparse network    hidden layers                              

                            

                           

 power spectral features 
 power spectral features 

 hand tuned   spectral features 

table    results from classification tests for different feature sets and classifiers  the best performance is obtained using a
combination of spectral signatures and hand tuned features  however this only improved slightly over performance with spectral
signatures only  spectral features consistently out perform hand tuned features in all of our tests  note that these are results of
individual tests  we have not yet had time to conduct thorough cross validation  some data was not available  and some tests with
hard classification outputs did not allow for us to reject inconclusive entries  these entries are marked with    

tests were conducted using        randomly selected galaxies from one of the three data subsets 
images were split into       records for training and       records for testing 
table   shows results for various combinations of learning algorithms and feature sets  results are
broken out by class  with an overall classification rate shown in bold face  in the first row we have
included results from the  banerji       study  which they obtained by training a three layer neural
network on hand tuned features  in order to draw an accurate comparison to this prior work  we have
adopted a similar strategy to the one employed by banerji et  al  for interpreting classification results 
this first requires rejecting a certain number of inconclusive classifications made by the machine
algorithm for galaxies that did not receive more than a     probability of belonging to any one of the
three classes  culling out weak classifications in this manner decreases the number of false positives in
all classes  and improves classification rates  i e  the fraction of true positives out of all classifications
considered for a given class  by several percent  with the     threshold  we typically rejected between
   and     of the total galaxies being classified  the   reject column in table   shows the exact
percentage of testing examples rejected in each test 
note that the     threshold was chosen arbitrarily  and should be considered a parameter that can be
tuned to minimize false positive rates at the expense of increasing the number of false negatives 
however  we did not have time to study this tradeoff closely  but in future work one could find the optimal
cutoff that perfectly balances false positives and false negatives for any given machine learning algorithm 
following banerjis example  we did in fact study the trade off between false positives and false negatives
for each class in isolation  for example  the other category rarely had the highest probability of the three
classes  probably due to there being relatively few training examples of this class in the data set   so our
algorithms superficially appeared to do poorly at classifying objects in other category  however  we found
that other objects could be more reliably identified if we chose a low threshold for determining whether an
object might be in the other category  we found that p other        was the optimal threshold that evenly
traded off false positives and false negatives in this class for the training data  optimal thresholds for the
elliptical and spiral probabilities were found to be around     and     respectively  it should be noted 
however  that setting thresholds in this manner allows an object to be placed into more than one category
 or even into none at all   this may or may not be desirable depending on the application  but we chose
to analyze our results in this fashion here so that our comparison to banerjis study could be made as
accurately as possible 

michael broxton  cs    final report

fi   conclusions   discussion
techniques using spectral signatures outperformed hand tuned features in all tests  although slightly
better results were obtained by training a sparse network using a concatenated vector containing of both
of these feature types  the sparse network techniques outperformed others  with additional hidden layers
yielding a modest increases in classification performance  overall  we demonstrate a    improvement
over banerji et  al s classification rates using our sparse network approach  this is significant  especially
when considering that we achieved this performance using the same color images that served as input
for the human classifiers  and demonstrated that one need not rely on hand tuned features to achieve
good classification performance 
of the two sparse learning techniques presented here  the sparse network seems to be the better
performing and more flexible of the two  additional hidden layers can be added to increase performance
somewhat  although we did notice that additional layers do increase the likelihood of over fitting to the
training data  we also found that the sparse network was better at learning an over complete basis set
that the ica svm method  finally  the soft classifications provided by the softmax output layer of the
sparse network provide an intuitive and easily justified way to filter out inconclusive classifications  this
guarantees better classification rates if you can afford to throw out some galaxies that are difficult to
classify 
in the end  we have demonstrated a modest but meaningful improvement over existing techniques  with
classification rates of     for clean galaxies that are easy for humans to classify  for the full data set
we have demonstrated classification rates for elliptical and spiral galaxies of         and this number
could be increased even higher by raising the threshold and rejecting even more inconclusive galaxies 
considering that human agreement with the full data set is sometimes less than     and often less than
     this may be approaching the best performance achievable using galaxy zoo data 
bibliography
m  banerji et  al  galaxy zoo  reproducing galaxy morphologies via machine learning  monthly notices of the royal astronomical
society  vol       pp               
n  m  ball  et  al  robust machine learning applied to astronomical data sets  i  star galaxy classificiation of the sloan digital sky
survey dr  using decision trees  the astrophysical journal  vol       pp                 
s  v  david and j  l  gallant  predicting neuronal responses during natural vision  network  computations in neural systems  vol 
         pp                 
c  elting  c  a  l  bailer jones  k  w  smith  photometric classification of stars  galaxies and quasars in the sloan digital sky
survey dr  using support vector machines  american institute of physics conference series  vol        pp             
o  lahav  et  al  galaxies  human eyes and artifical neural networks  science  pp                 
y  lecun  et  al  gradient based learning applied to document recognition  proceedings of the ieee  vol      no      pp 
                
c  lintott  et  al  galaxy zoo  morphologies derived from visual inspection of galaxies from the sloan digital sky survey  monthly
notices of the royal astronomical society  vol       pp                 
c  lintott  et  al  galaxy zoo     data release of morphological classifications for nearly         galaxies  monthly notices of the
royal astronomical society  pp            
a  ng  cs   a lecture notes  sparse autoencoder  retrieved nov    th       from http   www stanford edu class archive cs 
cs   a cs   a      sparseautoencoder pdf
s c  odewahn  m l  nielsen  star galaxy separation using neural networks  vistas in astronomy  vol      pp                 
m  a  nieto santisteban  a  s  szalay  and j  gray  imgcutout  an engine of instantaneous astronomical discovery  adass xiii
asp conference series  vol  xxx       
sloan digital sky survey  skyserver retrieved nov    th       from http   cas sdss org astro en tools search sql asp
d  j  york  et  al the sloan digital sky survey  technical summary  the astronomical journal  volume      issue    pp            
      

michael broxton  cs    final report

fi