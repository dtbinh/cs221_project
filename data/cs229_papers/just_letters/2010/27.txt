                                                                                             

a novel machine learning based prediction model for energy expenditure in
relation to varying load  incline  and body composition
                                                                                             
katherine swanson
aubrey gress
vlad andrei

k  cs stanford edu
adgress cs stanford edu
vlad andrei cs stanford edu

abstract
in this paper we use machine learning techniques to
develop a model for the prediction of the energetic cost
of walking on a positive incline while carrying a load
given the subjects body composition  previous studies
on prediction of energy cost have failed to incorporate
load  incline and body composition simultaneously in
their predictive models  by leveraging a more robust set
of features including mass carried  incline and body
composition we provide a more accurate model for
predicting energy expenditure and demonstrate novel
relationships between body composition and energy
expenditure 
i  introduction
the standard method of reporting the energetic cost of
performing a task is to report the energetic cost in
watts  normalized to body mass  differences in resting
energy and energy expenditure have been examined in
conjunction with differences in body composition in
men and women  there is a relationship between
resting energy expenditure and fat free mass and the
fat mass      during walking and running  equations
have been proposed relating the factors of mass 
incline  and speed      however  these studies have yet
to investigate any potential relationship between body
composition and locomotor efficiency  thus  the goal of
our project is to perform a comprehensive assessment
between the variables of load carriage  incline and
body composition 

the ultimate goal of our discoveries is to allow optimal
distribution of loads among subjects carrying gear and
other equipment  we are working with the human
performance lab at stanford under dr  thor bezier in
indirectly supplying this data to the department of
defense 
the energetic cost of an action is linearly related to
vo   oxygen consumed per unit time  milliliters per
minute within this paper  

 
vo  can be measured by using a breathing apparatus
which measures the amount of oxygen being
consumed during a task  the model we present in this
paper outputs predictions on vo  directly 
our research has uncovered two important results 
first  we show that body composition is an important
factor in predicting vo  for a given load and incline and
we present a small set of biometric features that can be
used to predict vo   second  we demonstrate that
svmr with a quadratic kernel can accurately predict
vo  given body composition  incline and load 
ii  previous work
the pandolf equation        is the most current model
relating energetic cost to load and incline and speed
    

this model proposes a quadratic relationship between

fienergetic cost and speed  and a linear relationship
between energetic cost and incline  while this is the
current standard used to predict energy expenditure in
research and in the field  the model is insufficient  the
data used to build this model did not normalize subject
vo  output to body weight      more importantly  the
pandolf model does not attempt to incorporate data on
body composition     which we show in this paper is
necessary for an accurate model  we have attempted
to accurately predict vo  using the pandolf model with
collected data but have been unable to do so  the
pandolf model performs very poorly on the given data
with greater than     relative error 

measured during each of the    intervals by collecting
a datapoint every time the subject exhaled  the order
in which load was tested across subjects was
randomized to minimize artifacts 
there is a large amount of noise in vo  values captured
during incline changes  vo  becomes more stable
within approximately one minute intervals around
incline changes  therefore the first and last minute of
vo  data for each incline load test is discarded  the
remaining data is averaged to give that participants
vo  value for a given load and incline 

iii  preprocessing
the training set for our model consists of nine subjects 
both male and female  in good physical shape within
the age range of    to     the data we used was
provided by the human performance lab at stanford 
each subject requires two approximately three hour
tests separated by a week interval over which weight
and cardiovascular fitness level is required to remain
constant   

figure    data capture for varying load and incline 
iv  predictive methods

for each subject we captured body composition data
using a dual energy x ray absorptiometry  dexa 
scanner  data included measurements of bone mineral
content  hereafter bmc   lbs   fat to muscle ratio  fmr 
 lbs   lean muscle mass  lbs   and total tissue weight
 lbs  for each of five discrete areas of the body  legs 
arms  trunk  gynoid region  visceral fat in the chest  and
android region  subcutaneous fat located around the
hips   the body composition data represents a total of
   features per subject 
we then collected data for each subject for each of
twelve conditions varying load and incline  each
participant walked on a treadmill carrying loads of    
         and     total body mass and at inclines of
       and     for   minutes each  vo  was
 

while this training set it small  the previous models
discussed in this paper used training sets on the same order
of magnitude  we are continuing to collect training data to
improve our model and predict approx  we expect    more
subjects within the next three months 

we hypothesized that including biometric data in our
model will improve the accuracy predicting vo 
significantly  furthermore  we are working in a very
high feature space     features per subject  relative to
the small number of training examples  features are
not necessarily independent  for example  the feature
set includes measurements of arm fmr as well as total
limb fmr  due to the small training set and large
amount of features per subject  we hypothesized that
models will overfit the data unless we reduce the
feature set  reducing the feature set will also allow us
to examine relevant relationships with vo  output
without distributing weight across non independent
features  finally  we must normalize features so that
computed weights have significance for analysis 

filinear regression svmr with linear kernel
feature reduction
we initially model the relationship between energy
expenditure  load  incline  and biometric data using
linear regression and svmr with a linear kernel  error
was calculated using leave on out cross validation
 loocv   both models performes reasonably well with
rms error of       and      ml second and root
relative squared test errors of        and       
body composition
we used linear regression to examine whether
inclusion of body composition information significantly
impacts prediction of vo   these preliminary results
show that models trained on features including body
composition consistently outperform models which
include only load and incline information  see figures  
and     this result indicates that body composition
plays a significant role in determining vo  

training
error
rms

lr all

lr li
      

svmr
lk all
      

svmr
qk all
     

svmr
qk li
      

svmr
qk r
     

     

relative

      

     

      

      

      

      

figure    training error comparison
lr   linear regression
lk   linear kernel
qk   quadratic
all   the full feature set was used
li   only load and incline were used
r   reduced feature set from backwards search used

we have thus far shown an improved model for vo 
prediction by incorporating body composition data 
however  as explained above  using this improved
model on a    dimensional feature set is prone to
overfitting  reducing the set of features should
therefore decrease error computed by loocv 
furthermore  we would like to determine specifically
which features of the body are statistically relevant to
the model  in the non reduced model  weights
computed for any relevant set of features are not
observable as they are distributed across many
dependent biometric features  therefore  load and
incline dominate the feature set in non reduced
feature space 

test
error
rms

lr all
     

lr
li
      

svmr
lk all
     

svmr
qk all
    

svmr
qk li
      

svmr
qk r
    

relative

      

      

     

     

      

     

figure    test error comparison

we computed a reduced set of features using
backwards search  figure   shows these relative
weights of the reduced feature    as hypothesized 
using svmr with a quadratic kernel on the reduced
feature set improves rms error calculated by loocv by
    and relative error reduces from       to       

svmr with quadratic kernel
biometric research has indicated that biometric
measurements including fmr have a statistically
relevant quadratic relationship with energy
expenditure      as our preliminary results indicate
that biometric data is relevant to the model  we
hypothesized that a quadratic kernel may be a better fit
when including these additional features  running
svmr with a quadratic kernel improved rms error
computed with loocv by      ml sec  figures      and
    experimentation with other non linear models did
not produce better results than those given by the
quadratic kernel 

in the reduced feature set we can now examine the
relative weights of relevant features  figure     a
preliminary look at the weights indicates that a high
bmc in the arms is highly related to energy
expenditure  in the reduced feature set arm bmc has a
stronger relationship with vo  than either load or
incline 
to determine how these results compare to chance we
apply permutation analysis  the process is as follows 
    create a new feature for the training set by
 

for visualization purposes  weights shows are calculated
using svmr with a linear kernel 

firandomly sampling arm bmc with replacement     
replace arm bmc with the new feature and
recomputed the weights of the features  we repeat
this process to create a gaussian distribution with
mean  and variance   by computing the value of the
cumulative distribution function for the weight of arm
bmc we obtain p value         e      the accepted
threshold for discarding a null hypothesis is p        
therefore  we show that with high probability that the
significance of arm bmc in predicting vo  is not a
result of chance  this result is supported by griffin
       who showed that density of the arm region has
a large impact on energy expenditure while walking 

figure    bootstrapping and permutation analysis
distribution

vi  conclusion

figure    actual vs predicted energy expendiure

figure    weights of features selected by backward search

by applying machine learning to the prediction of
energy expenditure we demonstrate two novel results 
first  that the relationship of a feature set including
body composition features as well as load and incline is
best modeled using svmr with a quadratic kernel 
second  we have shown that arm bmc has a strong
relationship with energy expenditure  this result is
supported by biometric research     which
demonstrates that the motion of arms while walking
has a strong impact on energy expenditure  it is likely
that these two breakthroughs are interrelated  the high
relative weights of the reduced features relative to
incline and load in our improved model may help
explain the need for a quadratic model  overall  these
findings suggest that biometric data is highly relevant in
developing predictive models for energy expenditure 
given the small size of our current training set  more
exploration should be done to determine precise
relationships to allow for better prediction for vo  

viii  acknowledgements
this project was undertaken with the guidance of amy
slider and thor bezier of the stanford human
performance lab  they provided us with data as well
as given us guidance throughout the project  we look
forward to continuing research with them on this
project 

fibibliography
    cunningham  jj   body composition as a
determinant of energy expenditure  a synthetic
review and a proposed general prediction
equation         
    pandolf kb et al    predicting energy
expenditure with loads while standing or walking
very slowly        
    goldman  energy cost of load carriage
       
    kramer  the effect on energy expenditure of
walking on gradients or carrying burdens       
    weir  j b  de v  new methods for calculating
metabolic rate with special reference to
protein metabolism        
    griffin  metabolic cost of generating
muscular force in human walking  insights from
load carrying and speed experiments       

fi