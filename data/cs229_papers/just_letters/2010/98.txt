epic  earthquake prediction in california
caroline suen

david lo

frank li

december         

 

 

introduction

methodology

   

earthquake prediction has long been the holy grail for
seismologists around the world  the various factors
affecting earthquakes are far from being understood 
and there exist no known correlations between largescale earthquake activity and periodic geological events 
nonetheless  we hope that machine learning will give us
greater insight into the patterns underlying earthquake
activity  even if we cannot predict the time  location 
and strength of the earthquakes accurately 

data

for data quality purposes  we decided to focus on earthquakes in california  which is heavily monitored for
earthquake activity  we scraped  parsed  and removed
duplicates from the following data sources 
 national geophysical data center       
 northern california earthquake data center    
 southern california earthquake data center     

 

background

each of these data sources is freely available and contains magnitude  epicenter location  and time of occurrence information for earthquakes dating back to      
the data set is not well populated before       and the
number of earthquakes records increases rapidly thereafter  this is partly due to advances in measurement
technology and roughly corresponds to the northern
california seismic network being brought online 

with the exception of a brief period in the     s  earthquake prediction was generally considered to be infeasible by seismologists  then  in       chinese officials
ordered the evacuation of haicheng one day before a
magnitude     earthquake struck       this led to a
flurry of optimism toward earthquake prediction         
which was subsequently checked by the failed prediction of the magnitude     tangshan earthquake of      
another failure occurred in parkfield  california in the
early     s  up to then  magnitude     earthquakes had
occurred at fairly regular    year intervals  this led researchers to predict that an earthquake would strike by
      no such earthquake arrived until       to this
day  the haicheng earthquake remains the only successful earthquake prediction in history  critically reviewing earlier reports of successful earthquake predictions 
an international panel of geologists famously concluded
in      that earthquakes cannot be predicted     
more recently  researchers in china have suggested
that neural networks ensembles and support vector machines could be used to predict the magnitudes of strong
earthquakes          but more research needs to be done
to corroborate their findings  for now the best earthquake forecast is vague at best  the usgs predicts a    
probability of one or more magnitude     earthquakes in
the san francisco bay area between      and          
rather than attempt to issue earthquake predictions  we
hope to analyze past data for periodic patterns that may
advance our understanding of earthquake dynamics 

   
     

poisson model
overview

our initial model sought to estimate the number of
earthquakes at a particular location in the next year  in
developing the model we had several relevant features to
consider  including magnitude  latitude and longitude of
the epicenter  depth of the epicenter  and starting time
of each earthquake  for our initial model  we made two
simplifications 
 time invariance  that the frequency of earthquakes at a particular location did not change over
time
 magnitude insensitivity  that all earthquakes
above a specified magnitude threshold c were considered equally
by not differentiating time and magnitude  we could
model the number of earthquakes per year at a specified location as a poisson distribution  that is 
f  loc  t    f  loc   p oisson  loc   
 

fiwhere f is the observed frequency of earthquakes above with an extension of the poisson distribution to allow
magnitude c at location loc in year t  and  is the true for nonintegral values of k loc  y  
taking derivatives and maximizing yields
 time invariant  frequency of earthquakes above magni 
tude c at location loc 
m
 i    
x
 
d loc 
loc
however  earthquakes are extremely unlikely to have
 loc   
exp
yend  ystart    
   
occurred at exactly the location of interest  so we decided
i  
to weight all earthquakes based on their distance from
loc  we chose poisson like scaling factors similar to the     fourier model
standard used in locally weighted linear regression 
      overview
     

our second model was motivated by periodic patterns
observed in the data obtained using the poisson model
 see section   for more details   this model entails performing a discrete fourier transform  dft      on the
input data and then examining the frequency spectrum
for dominant frequencies  if the input data is strongly
periodic  we would expect to see several frequency peaks 
conversely  if the input data is truly random  we would
expect to see no discernible pattern  therefore  to fit
the input data to a fourier model  we simply compute
the dft for the input data and pick proper coefficients
for the frequencies that have the highest power  the
fourier model can be parametrized by the number of
frequencies that are used 

definitions

given a training set of m earthquakes  let t i   r 
loc i   r    mag  i   c denote the time  in years ad  
location  in degrees latitude and longitude   and magnitude  in richter units  of the ith earthquake  for
notational convenience  we will rewrite location loc  
 lat  lon  in terms of its latitude and longitude components where appropriate 
we define the weighting function between two locations as


d loca   locb   
w loca   locb     exp
 
   

where d is the geodesic  great circle  distance between
the two input locations and  is a bandwidth parameter       definitions
controlling the rate of dropoff of the weights 
it is easy to show that a numerically stable expression we used the fourier model to analyze which region in
california would have more earthquakes year to year 
for d loca   locb   is
we define the north region as bounded by latitudes    n
s




lat
lon
and    n and longitudes     w and     w  the south
 r arcsin sin 
  cos  lata   cos  latb   sin 
 
 
 
region is defined as bounded by latitudes    n and    n
with the same longitude range 
where lat   lata  latb   lon   lona  lonb   r  
recall that  loc  estimates number of earthquakes at
radius of the earth  and all latitudes and longitudes are loc  therefore  to count the number of earthquakes in a
in radians 
region  we simply sum up the  values for all locations
we now define
in the region  discretized to a grid of     by      
m
x
k loc  y   
  t i    y w loc  loc i   
      mathematical derivation
i  

we define the dominant frequencies chosen by the fitting
to be the weighted count of earthquakes at location loc process as             and the dft coefficient of each
 
n
in year y 
value as y  j             y  jn    since we will be using a
single sided dft  we define the amplitude component
      mathematical derivation
a   for every frequency i as   y  ji    for i       n 
for each loc of interest  we wish to find the  loc  that similarly  we define the phase p    for every frequency
maximizes the likelihood of our training set  time in  i as y  ji    for simplicity  we assume that the input
variance implies that each years earthquakes are inde  data has been normalized so that the mean is    e g 
pendent samples  for a training set spanning the years y           putting this together yields
ystart and yend   this yields
 loc    arg max


yy
end
y ystart

y t   
k loc y  e
 
k loc  y  

n
x

a i  re exp j i t   p  i    

i  

where re denotes the real component 
 

fi 

results and analysis

   
     

power  then we expect the magnitude of the error to be
small all around 
certain regions have a significantly higher earthquake
density in the test set  red regions   while other regions
have a significantly lower earthquake density  dark blue
regions   from this  we immediately see that the poisson
model has extremely high error rates for some seismically active regions  indeed  we see that regions that are
seismically active in           are not what the model
predicted  thankfully  regions that are not seismically
active tend to have low error rates  as expected  however  when we compare two different test sets           
vs             we see that the distribution is quite different 
as seen above  our analysis regrettably suggests that
one of the central assumptions to our poisson model 
namely time invariance  is likely not valid  on further
inspection  we concluded that time invariance on the frequency of earthquakes may not always be a reasonable
assumption  for example  a large earthquake frequently
causes numerous aftershocks of considerable magnitude
afterwards  all localized in a small region in a short period of time  when a poisson model is fitted to this
type of data  it erroneously predicts an extremely high
frequency of earthquakes for that region  however  even
though our poisson model may not be the optimal model
for predicting the number of earthquakes for seismically
active regions  it still provides a fairly accurate indication of what regions are seismically active  we expand
on this idea in our fourier model 

poisson model
results

we implemented our poisson model fitting in matlab to
both train and predict earthquake frequency  for our
initial run  we trained the poisson model on all earthquakes after       with magnitude greater than      and
after some experimentation  with      km  we evaluated our model at each location on a grid of      degrees
latitude and longitude  plotted the predicted earthquake
frequency  and overlaid it onto google earth  see table
        red areas are predicted to have relatively frequent
earthquakes  whereas blue areas are predicted to have
little earthquake activity  our data resulted in more red
areas in regions known to be earthquake prone  such as
the san francisco bay area and los angeles  providing
a good first validation of our model  as the predictions
appeared reasonable 
we also performed further quantification of the general accuracy of our model  we overlaid the predicted
earthquake density on a map of known fault lines and a
map of earthquakes recorded in the past week  see table     as expected  earthquake dense areas correspond
with known fault locations  while areas that dont experience much earthquake activity do not have many
nearby faults  turning to real recorded earthquakes  we
similarly observe that earthquakes tend to occur more
frequently in areas marked as hot  however  we do see
that the hot region near los angeles did not seem to
have many quakes  while a not so hot region near san
diego is extremely earthquake dense  because the recent
data only includes one weeks worth of earthquakes  we
concluded that the lack of earthquakes near los angeles could be coincidence  or it could also point at flaws
in our model  we investigate this further in the next
section 
     

   
     

fourier model
results

because of the differing seismically active hot spots
present between           and            we hypothesized that the location of the hot spots might be periodic over time  to test our hypothesis we split california into northern and southern regions  and performed
fourier analysis with differing numbers of coefficients
in order to predict  for each year  whether the northern or southern region would have more earthquakes 
we used a two way split because fourier analysis works
best on continuous valued functions  and mapping from
two regions to two values that give an approximately
continuous function can be done  our dataset spanned
from      to       for each year n years after       we
computed the fourier coefficients based on the previous
n years  then computed which region was expected to
have a higher weight of earthquakes based on the approximation at year n 

validation

we performed validation on the predictive power of our
poisson model  to do so  we used cross validation where
we trained the predictor on earthquakes after      and
with magnitude larger than      with   years of data
withheld to use as a test set  we then compared the
number of earthquakes predicted by the model versus
the number of earthquakes that actually occurred  for
each location  for this particular example  our test set
is on the years      to       table   shows earthquake
density predicted by the model  earthquake density for
the test set  and the error between the test density and
the predicted density  if our model has high predictive
 

fidensity of earthquakes

density with fault lines

density with recent quakes

table    densities

density of earthquakes
on training set            excluding          

density of earthquakes
on testing set            

error between testing set
and training set

density of earthquakes
on testing set            

table    model and test densities
     

validation

coefficients yields a test accuracy of      these facts
suggest that the top three fourier frequencies achieve
better than random predictive performance  as the distribution of frequent earthquake regions is split evenly
between north and south  these top three frequences
   years       years  and    years  may be of geological
significance 

to perform testing  we compared the predicted region
with the actual region from the data  we were unable to
use leave one out cross validation  as performing fourier
analysis requires the data to not contain any gaps from
year to year  the graphs below show the accuracies
of the predictions for every coefficient choice between
one and eight and a graph of the predictions using the
optimal number of coefficients  three  overlaid with the
test data results  see table     test error is defined as
the number of mispredicted regions divided by the total
number of predictions  we slightly redefine training error  due to the sequential training process of training on
year n  n      etc  instead  we define training error as
the total number of training errors over all years divided
by the total number of training points over all years 

 

conclusions and next steps

in our project we mathematically derived a weighted
poisson model that estimates the frequency of earthquakes by year for a given location  our fourier model
extended the poisson model to predict whether north or
south california will have more earthquakes each year
 in       its projected to be the northern region  
while the poisson model has very little predictive
power between years  it provides a good indicator of seismically active regions  based on this  our fourier model
detects three major frequencies that should be investigated for geological significance  our models accurate
and immediate predictions suggest that high level earthquake prediction may be feasible 
it should also be possible to extend the fourier model
to be able to predict more than a binary result  for ex 

as seen by the graph  three coefficients is the optimal
number of coefficients to use  as it yields the highest test
accuracy  beyond three coefficients we see that overfitting becomes an issue  as training accuracy increases to
nearly      while testing accuracy drops significantly 
at three coefficients our model has approximately    
test accuracy  when we filter our data to consider only
earthquakes of magnitude     or greater  using three
 

ficomparison of actual and predicted

learning curve for fourier model

table    fourier model results
ample  california can be split into n non overlapping
bands  to perform a prediction  we would need to
first do a pairwise fourier prediction  using our existing
model  between regions   and    the winner of this comparison would then be compared with region               n  
this approach would give a more specific prediction and
could also lead to more interesting results 
as mentioned earlier  earthquake prediction has long
been scoffed at as an infeasible hope  we hope that our
insights into earthquake dynamics show that while today
earthquake prediction might be a lofty and far fetched
goal  perhaps one day  there will be data  resources  and
perhaps even machine learning algorithms available for
us to understand and predict patterns of earthquakes
activity 

tion by rbf neural network ensemble  advances in
neural networks   isnn                  
    ncedc  ncsn earthquake catalog  available 
http   www ncedc org ncedc catalog search html
    noaa  the seismicity catalog cd rom collection 
      available 
http   www ngdc noaa gov hazard fliers se      shtml
    noaa  significant earthquake database  available 
http   ngdc noaa gov nndc struts 
form t        s   d  
    press  frank         earthquake prediction  scientific
american           
     scec  southern california earthquake catalog  available  http   data scec org ftp catalogs scec dc 
     scholz  christopher h   sykes  lynn r   aggarwal  yash
p          earthquake prediction  a physical bases  science               

references
         working group on california earthquake
probabilities         the uniform california earthquake rupture forecast  version    available 
http   pubs usgs gov of           
of          text pdf

     stark  p  b          earthquake prediction  the null
hypothesis  geophysical journal international      
        doi          j         x      tb      x
     usgs 
google
earth kml
files 
http   earthquake usgs gov learn kml php

    discrete fourier transform  wolfram mathworld  available  http   mathworld wolfram com 
discretefouriertransform html

available 

     usgs  quaternary faults in google earth  available 
http   earthquake usgs gov hazards qfaults google php
     wang  kelin and chen  qi fu and sun  shihong and
wang  andong         predicting the      haicheng
earthquake  bulletin of the seismological society of
america                doi                   

    google  kml documentation  available 
https   code google com apis kml documentation 
    geller  robert j  and jackson  david d  and kagan  yan y  and mulargia  francesco         earthquakes cannot be predicted  science             doi 
        science              

     wang  wei and liu  yue and li  guo zheng and wu 
geng feng and ma  qin zhong and zhao  li fei and lin 
ming zhou         support vector machine method for
forecasting future strong earthquakes in chinese mainland  acta seismologica sinica            

    liu  yue and wang  yuan and li  yuan and zhang 
bofeng and wu  gengfeng         earthquake predic 

 

fi