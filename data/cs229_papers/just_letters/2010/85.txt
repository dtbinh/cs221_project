audio source separation by probabilistic latent component analysis
yinyi guo  mofei zhu
center for computer research in music and acoustics
stanford university
abstract
the problem of audio source separation from a monophonic
sound mixture having known instrument types but unknown
timbres is presented  an improvement to the probabilistic latent component analysis  plca  source separation method
is proposed  the technique uses a basis function dictionary
to produce a first round plca source separation  the plca
weights are then refined by incorporating note onset information  the source separation is then performed using a second round plca in which the refined weights are held fixed 
and the basis functions are updated  preliminary experimental results on mixtures of two instruments are quite promising 
showing a   db improvement in sir over standard plca 
index terms audio source separation  probabilistic
latent component analysis  basis function adaptation  onset detection





































fig     system overview flowchart
   introduction
   proposed method
source separation of audio has been an active research topic
in audio signal processing  in recent years  a great deal of the
work in this area is based on spectral decomposition methods  probabilistic latent component analysis  plca      is
one such method  to achieve good separation with few artifacts  it has a high demand of the prior knowledge of the
target sound in the mixture  not only do the sound types need
to be known  but precise basis functions of the target timbres
should be pre trained as well     
in this paper  we extend the plca based supervised separation method described in      we use pre trained spectral
basis of general instruments as the spectral prior knowledge
to lead the algorithm to give preliminary temporal results 
which can be optimized further  we then perform onset detection based post processing to adjust the temporal information given by the previous stage decomposition  eventually 
the source separation is performed and the basis functions
of target sources in the mixture are updated with the refined
temporal weights held fixed using a second round plca  an
overview of the proposed approach is shown in fig    

     plca model
the probabilistic latent component analysis  plca  algorithm is the most important element of our system  which performs the source separation  plca is a probabilistic model 
whose components are all non negative  it interprets the spectrogram as a histogram and the spectral and temporal components as distributions along time and frequency  numerically 
this probabilistic latent spectrogram factorization method is
similar to the non negative matrix factorization  nmf  approach         the magnitude spectrogram of audio signals
can be treated as a  d distribution of sound quanta over
time and frequency  in this respect  the non negative factorization is used to model the spectrogram as a linear combination of spectral basis vectors  which are regarded as the latent
variables  the model is defined as follows 
   p  f   z  is defined as a multinomial probability distribution of frequency f given certain latent variable z  
each distribution is actually a spectral basis vector of

fi e step   estimate the posterior given spectral basis vectors and weights vectors
pt  z   f    

p  f   z  p  z 
  t
z pt  f   z  p  z 

   

 m step   estimate spectral basis vectors and weights
vectors given the posterior
 
f pt  f   pt  z   f  
 
 
pt  z   
   
z
f pt  f   pt  z   f  
 
t pt  f   pt  z   f  
p  f   z       
   
t
f pt  f   pt  z   f  
fig     an illustration of applying plca to a spectrogram of
eight notes that are by a piano 

the source separation applying the standard plca model is
conducted as follows        
 calculate the spectrogram st  f   of a sound mixture 

sound component 
   pt  z  is defined as a multinomial probability distribution of weights for each latent component z at time t
 
   p  t  is a distribution of the relative magnitudes at different time frame t 
   pt  f   is defined as normalized spectrogram vector at
time frame t
   st  f   is defined the original spectrogram vector at time
frame t

st  f     p  t  pt  f  
 
pt  f    
p  f   z  pt  z 

   
   

z

equation   is to normalize st into pt  f    equation   is
the magnitude decomposition of the spectrogram into spectral
basis vectors and weights vectors  an example of applying
this decomposition is shown in fig   
we can see five distinct notes in fig    each of the notes is
represented by a latent variable z  the spectral basis p  f   z 
of each component z can be seen as the harmonic series of
each note 
the expectation maximization  em  algorithm can be
used to decompose the spectrogram pt  f   into spectral basis
vectors p  f   z  and corresponding weights pt  z   given
the mixture spectrogram  we randomly initialize all the unknown parameters  and estimate the model parameters by
iterating between e step and m step until convergence 

 learn the basis function p  f   zm   of the sources zm
in the mixture using plca 
 initialize the prior based plca algorithm with the
learned basis functions of the active components  and
estimate the model parameters p  f   zm   and pt  z  
 reconstruct each instrument in the mixture by only using their corresponding optimized p  zm    p  f   zm  
the complete process of our proposed approach is described in the following sections 
     fixed basis plca
we start with a fixed basis plca which is first performed to
get weights of individual sources  given that the types of instrument in the mixture are known  we choose accordingly
the basis function of target sources from the pre trained typical spectral basis dictionary and fix them as spectral prior
information for the plca algorithm  since the timbre characteristics are very similar among the same type of instrument  this fixed basis plca gives us more robust weights estimation comparing with using the traditional plca  in which
the spectral basis and weights are not fixed  in order to separate the target sources in the mixture precisely  the spectral basis should be updated for reconstruction  to achieve
this  more reliable temporal prior knowledge has to be prepared for the next stage plca  first  we need to further refine the current weight coefficients that may contain unwanted
crossover between notes or instruments  second  the right
timing when should update the spectral basis function has to
be found based on the refined weights  we therefore perform
an onset detection based post processing on the weights as a
preparation for the second stage plca 

fi     onset detection
an amplitude envelope function is calculated from the short
time fourier transformation of the input mixture signal 
based on algorithms from previous literature         the wellknown first order difference function of the spectral energy
envelopes is computed  which gives prominent peaks from
which onsets can be located  a threshold was generated in
order to determine if a peak is an onset candidate      every value above this threshold in the first order difference
function of the energy envelope should be a potential onset
peak 
     post processing on weight coefficients
an onset implies something new happened in a signal  in the
case of a musical signal  this could be a change in pitch or instrument  i e  the precise time when a new note is produced by
an instrument  knowing the location of the onsets allows us
to easily determine which instruments are playing  this can
be accomplished by comparing the intensities of their weights
envelopes in the frames following the onset frame  since the
weights envelopes could be considered as activation indicators of sources  thus it is more reliable to make decisions
to remove residual cross talk components right after onset
frames  after we detect each onset  the weight coefficients
of different notes are compared against their sums of magnitude during the following      seconds  for each instrument 
the note that has the maximum weight  coefficient among all
the weights is taken as an active note  while the weights of
the other notes are removed  this refinement on the weights
is operated after each onset  eventually  the weights coefficients of active notes and their corresponding basis functions
are restored for the further processing 
     update basis function
we record those appropriate time frames in which the weights
coefficients after post processing are relatively reliable to update corresponding basis functions of certain source  if the
sum of the weights of active notes are dominant in some
time frames between two successive onsets  another modified
plca algorithm based on em learning rule is performed to
update the basis functions of the active notes  as follows 
 for the initialization of the em algorithm  the basis
functions p  f   z  are constructed as the basis functions of active notes p  f   za   cascaded with a set
of randomly distributed basis functions p  f   zr   for
modeling residual sources other than the dominant active notes  the new weight vector pt  z  consists of
weights of active notes pt  za   as well as the weights of
random basis pt  zr   that share the rest of the weights 
  in this project we work on cases of single note concurrently for each
instrument

 the expectation step remains the same as equation   
 the maximization step equations are given by the following update equations 

pt  zr  

 

p  f   z   

 

f pt  f   pt  zr   f  
   
z
f pt  f   pt  zr   f  
 
t pt  f   pt  z   f  
   
t
f pt  f   pt  z   f  

   
   

the above equations are iterated until convergence  we
only update the weights for random sources pt  zr   while the
weights for active latent variables pt  za   are fixed in the mstep in that they are ensured to be reliable temporal prior information given by the first round plca and post processing 
the chosen of the number of random basis depends mainly on
the number of sources in the mixture  since those extra randomly initialized basis functions p  f   zr   are supposed to
explain the artifacts introduced by the algorithm as well as
the sustain or release potions of any source before  the basis
functions of dominant components p  f   za   will therefore
be biased to update towards the target source timbres eventually based on the fixed weight coefficients 

   experiments and results
our algorithm has been tested on synthetic examples of   
distinct data sets  mixture of two instruments per set   which
include   distinct instruments  piano  flute  strings  saxophone
and guitar   all the examples are generated from logic pro 
the source timbres of the mixture are different from those in
the pre trained basis functions in the inventory  for example  in the basis functions inventory an octave of piano basis
functions from c  to c  are trained from piano sound source
of steinway  an octave of flute basis functions from c  to c 
are trained from super air flute   the corresponding test data
is mixture sound sources of yamaha piano and thin flute  in
all these experiments we measured the signal to distortion
ratio  sdr   the signal to interference ratio  sir   and the
signal to artifacts ratio  sar  as defined in      the results are shown in table      we can see the proposed algorithm enjoys around  db improvement in sir over traditional
plca 
in these experiments  we used   basis functions per note 
ran    times of    distinct experiments  each spectral basis
and spectrogram of      point fft with     overlap    
iterations of the plca algorithm  the approach works on
magnitude spectrograms  for the phase we copy the phase of
the original mixture to each of the separated sources  the resulting separated spectrograms of the piano flute mixture can
be seen in fig   

fipiano
traditional plca
proposed algorithm
flute
traditional plca
proposed algorithm

sir db 
     
     
sir db 
     
     

sar db 
    
    
sar db 
     
     

sdr db 
    
    
sdr db 
    
     

table    performance metrics for synthetic mixture example
of piano flute

improvement

sir db 
    

sar db 
    

sdr db 
    

table    averaged metric improvement over traditional
plca for all the    experimental datasets
original mixture

   conclusion
we have presented a learning scheme based on plca algorithm that is used for the source separation of multiple concurrent instruments knowing the type of instruments in the mixture but without a prior knowledge of the precise basis functions of target sources beforehand  the proposed algorithm
has been demonstrated on mixtures of two instruments  the
use of prior generic basis functions inventory  post processing
on weight coefficients as well as the basis function adaptation
have been shown to improve the performance of the original
plca algorithm  this method shows promising results and
in future work  we plan to improve the performance by studying perceptual auditory model 
   references
    m  shashanka p  smaragdis  b  raj  a probabilistic latent variable model for acoustic modeling  advances in
models for acoustic processing  nips       

   
   
   
   

    m  shashanka p  smaragdis  b  raj 
supervised
and semi supervised separation of sounds from singlechannel mixtures  international conference on independent component analysis and signal separation       

   
   
   
   
   
  
 

   

   

   

   

    

    

    

    

separated piano

    h  seung d  lee  algorithms for non negative matrix
factorization  nips       

   

    m  shashanka  b  raj  and p  smaragdis  probabilistic latent variable models as non negative factorizations 
computational intelligence and neuoscience journal 
special issue on advances in non negative matrix and
tensor factorization       

   
   
   
   
   
   
   
   
  
 

   

   

   

   

    

    

    

    

separated flute

    p  smaragdis and g  j  mysore  separation by humming  user guided sound extraction from monophonic
mixtures  proc  of ieee workshop on applications signal processing to audio and acoustics       

   

    e  d  scheirer  tempo and beat analysis of acoustic musical signals  j  acoust  soc  am   vol       pp         
     

   
   
   
   

    m  goto and y  muraoka  beat tracking based on
multiple agent architecture   a real time beat tracking
system for audio signals  proceedings of the second international conference on multiagent systems  pp    
           

   
   
   
   
  
 

   

   

   

   

    

    

    

    

fig     example result of separated piano and flute spectrograms from a mixture  the top plot shows the input mixture
spectrogram  the middle one shows the separated piano spectrogram  the bottom one shows the separated flute spectrogram  x axis is the time frames  y axis is the frequency bins
using      point fft with     overlap

    c  duxbury  m  sandler  and m  davies  a hybrid approach to musical note onset detection  proceedings of
the digital audio effects conference  hamburg       
    c  fevotte  r  gribonval  and e  vincent   bss eval toolbox user guide  irisa technical report       rennes 
france       

fi