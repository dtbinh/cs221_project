identifying morphological markers for differential diagnosis of liver lesion
francisco gimenez  ting liu  yi liu
biomedical informatics  stanford university
   introduction
liver lesions stem from a variety of
causes ranging from benign to malignant 
the ability to efficiently and accurately
differentiate these lesions as malignant or
benign using non invasive medical imaging
is important to patient treatment and
outcome  contrast enhanced computed
tomography  ct  imaging is the dominant
technology used for liver lesion diagnosis
     this modality takes advantage of the
fact that the liver receives blood from two
main sources  the portal vein and the hepatic
artery  about     of blood in the liver
comes from portal vein and the other    
comes from the hepatic artery  whereas liver
cancer receive all their blood from the
hepatic artery         injecting contrast
enhancing agents into the portal vein and
performing a liver ct scan shortly thereafter
will cause the liver to appear brighter than
the cancer because it receives the entire
dosage of contrast agent  this technique is
called portal venous phase  pvp  imaging 
unfortunately the specificity of this method
is a function of the size of the tumor and
prone to a high false positive rate because
other types of benign liver lesions have
similar manifestation on ct images     
human variability has been shown to be an
issue regarding lesion differential diagnosis 
and automated methods are being
investigated to facilitate the diagnosis of
these lesions     
recent research has investigated
computer aided methods to facilitate
diagnosis by providing a database of
annotated images that can be retrieved by
similarity      it suggests that using semantic
annotations and computational imaging
features can lead to highly accurate
diagnosis  semantic annotations are a

  

controlled terminology used by radiologists
to convey image content  called semantic
features  computational features are
quantitative markers derived using imageprocessing algorithm that are independent of
the semantic features  machine learning
methods have been used to explore different
feature combinations that produce the best
diagnosis results  however  investigation of
different methods is still in preliminary
stages 
in this study we will compare the
performance of an array of widely used
machine learning methods to examine the
imaging feature space comprising semantic
and computational features  in addition  we
will apply feature selection to identify the
most predictive semantic and computational
imaging features for diagnosis 
   methods
    dataset
we have obtained    ct images of
liver lesions  which consist of eight types of
lesion diagnoses  metastasis  hemangioma
 abnormal buildup of blood vessels in the
liver   hepatocellular carcinoma  hcc  
focal nodule  unknown cause   abscess
 inflammation   laceration  injury or tear  
fat deposition and cyst  figure     among
these  hcc and metastasis are malignant
and cancerous 
      semantic features
for each scan  the axial slice with the
largest lesion volume was selected for
analysis  two radiologists drew a region of
interest  roi  around the lesion on these
images  radiologists then made annotations
on these images with the imaging
physicians annotation device  ipad      

   

fithe ipad system uses a controlled
radiological vocabulary called radlex to
define observations      a binary semantic
feature vector was created from these
annotations to indicate presence or absence
of a specific observation 

     cancer classification
lesions
were
predicted
as
malignant benign using a variety of
classifiers over three different sets of
features  computational  semantic  and both 
results were evaluated using leave one out
cross validation  loocv   the classifiers
we used included majority rule  mr  
nave bayes  nb   k nearest neighbor
 knn   gaussian discriminant analysis
 gda   and support vector machines
 svm   as our feature space far exceeds the
number of patient samples available  gda
and svm did not converge using the full
feature sets  thus  we selected the first   
principal component vectors of the feature
sets that account for     of the variance and
trained gda and svm classifiers 

figure    an example of an axial spiral ct slice of the
liver with a delineated cystic lesion 

      computational features
the segmented liver lesions were
processed using a variety of computer vision
algorithms to quantify texture  lesion
boundary  lesion shape  and contrast
 table     the extracted computational
features were concatenated into a feature
matrix and normalized to have means zero
and standard deviations one 
table    twelve groups of computational features

computational feature group
description
proportion of pixels with
intensity larger than     
entropy of histogram
peak position
histogram
difference in and out
variance
gabor
edge sharpness
haar on histogram
daube on histogram
histogram on edge
shape

  

feature group
dimension
 
 
 
 
 
 
  
  
 
   
 
  




     semantic feature selection
we used feature selection to
determine the most descriptive semantic
features for predicting cancer  the
sequential forward search  fs  algorithm
was used over several classifiers with   fold cross validation as the optimization
function      classifiers we used were knn 
svm  and general linear models  glm   for
each classifier  we selected a series of
different parameters for both the forward
search criterion and the prediction
evaluation 
knn was parameterized with odd
integer k        as the neighbor count 
svms were trained using varying values of
in
the
gaussian
kernel
      
 
   x  y   
    glm was run
 k x  y    exp 

with normal  binomial  and poisson
distribution models with identity  logit  and
probit link functions in matlab  the results
of classification using these subsets were
evaluated using loocv  frequencies of
being selected were tracked for each
semantic feature  features with higher
frequencies were considered to have more

   

fipredicative power  the top six semantic
features were then used to examine
correlation between semantic features and
computational features 

on the liver ct images  the accuracy table
with different classifiers consistently shows
that
semantic
features
outperform
computational ones  table     this suggests
that the computational features may contain
redundant information when given semantic
features 

    predicting semantic features
prediction of top six semantic
imaging features was performed using gda
over the first k       principal
component vectors of the computational
features  this allows us to investigate
whether
automatically
generated
computational features can be used to
predict semantic features that require much
more time and effort  evaluation was
performed using loocv 

table    accuracy for predicting diagnosis

   results

loocv accuracy

computational

semantic

all features

majority rule
nave bayes
k nn  k   
k nn  k   
k nn  k   
k nn  k   
k nn  k   
gda     pcvs 

      
      
      
      
      
      
      
      

      
      
      
      
      
      
      
      

      
      
      
      
      
      
      
      

svm     pcvs 

      

      

      

    different types of lesions identified by
different imaging features
pca using the first two major
components shows most groups of patients
with the same lesion causes are clustered
together  figure     the first two principal
components account for       variance 
thus  different types of lesions are generally
separable  in particular  cyst lesions are well
separated from other types of lesions 

    predictive semantic features
we applied forward search to
generate a list of most predictive features for
differential diagnosis of liver lesions  we
empirically searched for the minimization of
error in the    fold cross validation of
knn  svm and glm 
the subsequent figure lists the most
common semantic features across our
forward search feature selection iterations
 figure     we identified the top six
features  homogeneous retention  soft tissue
density  necrosis  centripetal fill in  central
scar  and cluster of grapes  furthermore 
four of these have been independently
validated in the literature as being
anatomical imaging markers in differential
diagnosis         

figure   visualization of    liver lesions using first
two principal components in pca  circles correspond
to cancerous diagnoses 

    using computational features to predict
semantics features
as
discussed
above
that
computational features may be redundant to
semantic features in predicting diagnosis 
thus  we were interested in evaluating
whether semantic features can be predicted 
if given automated computational features 

    comparison of computational and
semantic features in diagnosis
our primary goal is to accurately
differentiate cancerous lesions from benign
ones using different sets of imaging features
  

   

fi   

    

for svms with each radial width
from   to    we performed fs to select
semantic
features
based
on
their
performances in predicting diagnosis  we
then validated each selected feature set using
svms with each radial widths ranging from
  to    
for example  let svm   denote a
svm learning instance with a gaussian
kernel radial width of   and knn k  denote
a knn learning instance that takes the
majority vote of k neighbors  svm   
classifies with       accuracy when using
features selected by an svm     table  a  
in contrast  suppose we minimize the
empirical error of knn    in our feature
selection process  yet  knn    would
achieve only       accuracy when using
only the selected features  table  b  
this pattern suggests that svms are
more robust in comparison to knn when
used in forward feature selection  table    

    

  homogeneous  retention    
  soft  tissue  density    
  necrosis    
  centripetal   ill in    
  central  scar    
  cluster  of  grapes    
  heterogeneous  
enhancement  
  bulges  capsule  
of  liver      
  homogeneous  fade    
  irregular  margin    
  mixed    
  target  enhancement    
figure   semantic feature frequencies

we applied gda on different
numbers of principal components of the
computational features  features such as
homogeneous retention  blue  and central
scar  purple  achieve particularly low error
rates  figure    

table     a  accuracy of classification using svm with
forward feature selection  b  accuracy of classification
using knn with forward feature selection

figure   top six semantic features prediction
accuracy  y axis  using principal components  x axis 
of computational features

kernel radial width used in
forward search

loocv
accuracy

  

    evaluation of forward search in
semantic feature selection
when selecting predictive semantic
features for diagnosis  section       we
applied sequential forward search  a
heuristic for feature selection algorithm  we
are interested in evaluating the relative
degree to which over fitting may occur
when we apply different machine learning
algorithms inside the forward search errorminimization criterion 
  

k used in forward search

 

 

 

  

  

 

     

     

     

     

     

     

 

      

      

     

     

     

     

 

     

     

     

     

     

     

 

      

      

     

     

     

     

 

      

      

     

     

     

     

 

     

     

     

     

     

     

 

     

     

     

     

     

     

 

     

     

     

     

     

     

loocv
accuracy
 
 
 
 
 
  
  
  

   

kernel radial width for classification
 

k  neighbor counts in knn  for classification
 

 

 

 

 

  

     
     
     
     
     
     
     
     

     
     
     
     
     
     
     
     

     
     
     
     
     
     
     
     

     
     
     
     
     
     
     
     

     
     
     
     
     
     
     
     

     
     
     
     
     
     
     
     

fi   discussion
we have shown that diagnosis of
malignant cancer using a rich  controlled
radiological vocabulary  semantic features 
outperforms general computational features 
this finding should be of little surprise
given than these radiological observations
are optimized for such diagnostics 
subsequent analysis of semantic
features revealed six semantic features with
high predictive power for differential
diagnosis  homogeneous retention  soft
tissue density  centripetal fill  necrosis 
central scar  and circumscribed margin 
these findings are consistent with published
literature as being indicative of either
malignant or benign lesions 
moreover  we showed that these
highly descriptive semantic features could
be accurately classified with automatically
extracted computational features  this result
can be applied to computer aided
diagnostic  cad  systems by providing
suggestions of semantic features to
radiologists 

in addition  we investigated overfitting problem in forward feature selection
for diagnosis with different classifiers  svm
appears more robust than knn 
finally  representative roc curves
show that we achieved excellent sensitivities
and specificities simultaneously when
predicting diagnoses with semantic features
 figure    

figure    roc curves of different classifiers for
predicting diagnosis

references
  

  

  

  

  

  

  

  

                     
langlotz  c p  radlex  a new method for
indexing
online
educational
materials 
radiographics                      
   kohavi  r    john  g h  wrappers for feature
subset selection  artificial intelligence                   
    youk  j h   kim  c s    lee  j m  contrastenhanced agent detection imaging  value in the
characterization of focal hepatic lesions  j
ultrasound med                    
    el serag  h b   marrero  j a   rudolph  l   
reddy  k r  diagnosis and treatment of
hepatocellular carcinoma  gastroenterology     
                 

baron  r  understanding and optimizing use of
contrast material for ct of the liver  am  j 
roentgenol                      
lautt  w w    greenway  c v  conceptual
review of the hepatic vascular bed  hepatology
                  
matsui  o  et al  benign and malignant nodules
in cirrhotic livers  distinction based on blood
supply  radiology                     
lencioni  r   cioni  d   della pina  c   crocetti 
l    bartolozzi  c  imaging diagnosis  semin 
liver dis                    
armato  s g  et al  the lung image database
consortium  lidc   an evaluation of radiologist
variability in the identification of lung nodules
on ct scans  acad radiol                      
napel  s  a  et al  automated retrieval of ct
images of liver lesions on the basis of image
similarity  method and preliminary results 
radiology                 
rubin  d l   rodriguez  c   shah  p    beaulieu 
c  ipad  semantic annotation and markup of
radiological images  amia annu symp proc

  

acknowledgements
we would like to thank sandy napel and
daniel rubin for providing data sets  and
jiajing xu for his work in extracting
computational feature 

   

fi