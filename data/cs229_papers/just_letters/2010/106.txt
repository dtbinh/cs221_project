caloric and nutritional information using image classification
of restaurant food
arne bech
          

abstract

previous research has been done that could
be useful in this area such as image based food
classification and estimation of caloric content
directly from an image          problems with
these approaches have been both complexity
and low accuracy  another approach is the
remote food photography method  rfpm  
it involves users uploading pictures of their
meals  and then having professionals estimate
the calorie content  the professionally estimated calorie values were shown to be significantly more accurate than self reported values
     one problem with this approach might
be the expense of having to hire professionals
to do the estimations  particular compared to
self reporting 
with this project we seek to look into the
intersection between these two dierent areas
of research  machine learning and rfpm  to
come up with a solution that improves accuracy and lowers cost of calorie estimation
compared to machine learning and rfpm respectively  since this is an assignment for a
machine learning class  we will look at how
we can use machine learning in this new integrated approach  in particular we will look
at using machine learning to classify fast food
based on images and geolocations 

self reported calorie estimation tends to be inaccurate and unreliable  while accurate automated estimation is expensive  close to half
of all americans are trying to loose weight 
and a significant number therefore try to track
their calorie intake  self monitored or with
professionals  the smart remote food photography method  srfpm  archives significant accuracy of classification of fast food using svms  this will allow the cost of accurate automated estimation to go down by
reducing the amount of work the operators at
the estimation facility has to do 

 

introduction

over the last decade in the us the percentage
of obese americans have increased by         
it is an alarming trend that can cause significant decrease of life quality for the aected
as well as increased health cost  this is one
of the reasons weight loss is a common topic
with close to half of all americans trying to
loose weight     
regardless if a person trying to loose weight
is on a self monitored program or working
with professionals  e g  dietician   they will
often track their calorie intake for use as a
motivation factor to eat less as well as for analyzing their current eating habits  however 
there are several problems with self reported
calorie intake  research has shown that people tend to underreport the number of calories
they are consuming     and the hassle of calculating and reporting the caloric content of
every meal often results in unreported meals 

 

the problem

the approach we will take is to use machine
learning to assist the human operator that is
responsible for estimating calories  an use
case would be an operator that receives a picture of a meal  in regular rfpm he or she
would have to figure out the food type and nutritional values using reference material and
 

fithen determine the amount of food  with
our approach the same use case would be an
operator that receives the food image with a
description of what it is e g  the description
could be chicken nuggets from kfc      
calories a piece  then all the operator needs
to do is to count the chicken nuggets  however  in more dicult cases  such as homecocked meals the operator would only receive
the image  one way of understanding this
approach is to consider that machine learning can deal with the low hanging fruit  e g 
more easily classifiable  
 a  pizza
i call this new combined approach
smart remote food photography method
 srfpm  
if we limit ourselves to restaurant foods
 which would be significant share of all meals  
we can easily see that we have a new and very
important feature we can use   location  the
location can be used to reverse lookup the
restaurant name  e g  through google maps
api    we can justify this by realizing that
 b  mask
user submitting pictures of their meals will
very likely use a smartphone  which in most
figure    background is set to black  a   mask
cases have a gps support built in 
through the rest of this paper well set up used in  b 
and evaluate the accuracy of machine learning
classification given location and a image 

 

method

   

data

training and testing data is taken from the
pittsburgh fast food image dataset     which
consist of over      images of fast food  with
corresponding labels and names of the restaurant they belong to  the data we selected for
this project is described in table   
to limit the scope of this project  all backgrounds have been removed from the pictures
 e g  figure    

restaurant
aarbys
kfc
mcdonalds
pizza hut
quiznos
subway

  dierent foods
  
  
  
  
 
  

total images
   
   
   
   
   
   

table    dataset used for this project

   
     

extracted features
location

this is used to lookup the restaurant in which
the picture was taken  for this project the
 

fi a  histogram  

 a  pizza type  

 b  histogram  

 b  pizza type  

 c  histogram  

figure    visualization of rgb bins for two figure    averaged intensity histograms from
dierent pizza types for n    
three dierent pizza types with n     
restaurant is known  so the lookup process it        bag of features  sift 
self is not directly implemented 
a set of sift descriptors are extracted from
each image using vlfeat library      for each
restaurant all descriptors are combined into a
      rgb bins
large matrix and put through a k means algosampling the  d rgb space into a n  n  n rithm to extract k centroids 
the final feature vector for each image is
matrix where each element is the normalized
count of colors of that type  figure     this is a binary vector of size k where each element
then converted to a vector by appending each corresponds to a centroid  if one or more descriptors are mapped to a particular centroid
element of the  d matrix 
then the respective element in the feature vector is set to one 
      average color

   

the average color of the image 

algorithm

to classify the dierent foods  this project relies on svm through the libsvm library      in
order to evaluate the dierent features we con      intensity histogram
struct a set of feature vectors for each image 
using n coecients  this describes the nor  the feature vectors are described in table   
malized grayscale histogram for the image  see
to clarify further notation we define a
figure     
dataset to be the all the feature vectors of one
 

fiv
 
 
 
 
 
 
 

length
   
 
  
  
   
    
    

kernel
linear
rbf
rbf
rbf
linear
linear
linear

description
rgb bins
avg  color
intensities
avg  color   intensity
rgb bins   avg  color   intensity
sift
rgb bins   avg  color   intensity   sift

table    the dierent feature vectors used
v
 
 
 
 
 
 
 

arbys
     
     
     
     
     
     
     

kfc
     
     
     
     
     
     
     

mcdonalds
     
     
     
     
     
     
     

pizza hut
     
     
     
     
     
     
     

quiznos
     
     
     
     
     
     
     

subway
     
     
     
     
     
     
     

table    accuracies for dierent fast foods for dierent feature vectors using   fold cross
validation

type for one restaurant 
to preprocess the data  we scale it so that it
is between   and    we then run a mutual information algorithm  sorting the dataset such
that the first elements of feature vectors is
where we expect there to be the most useful
information 
linear kernels have a cost parameter  rbf
kernels also have an additional  parameter 
on top of that we need to know if we should
reduce the size of the feature vectors  e g  disregarding elements with lowest mutual information   to find the good values for these
parameters we run a  d grid search   d with
linear kernels  over a range of parameters 
all accuracies are computed using   fold
cross validation 

 

ing that the best vectors are pruned from over
     elements per image to only     and    
respectively after being sorted by mutual information value to get the best accuracy from
the svms 

 

discussion

this svm based system shows that we get significant accuracy in image classification when
supplemented with location information  and
in this case it would do very well classifying fast food before sending it o to an operator  with kfc and pizza hut  we were
able to archive over      accuracy combining
all of the features  in general the increased
accuracy can probably be attributed to two
main factors  the dataset is smaller and the
svms are optimized for the particular food at
a restaurant  the accuracy could also be potentially improved  if images were taken from
a certain angle  e g  from the top   images
in these datasets are taken from a variety of
angles 
this algorithm could be straightforwardly
implemented in a current rfpm system  dy 

results

the accuracies for the dierent feature vectors
for dierent restaurants are reported in table
  
parmeter selections are shown for kfc and
pizza hut for feature vector    i e  all features
combined  in table   and table    its interest 

fiparameter
cost
pruned feature length
accuracy

value
     
   
     

    mei chen  kapil dhingra  wen wu  lei
yang  rahul sukthankar  and jie yang 
pfid  pittsburgh fast food image dataset 
     

table    pizza hut  feature vector  
parameter
cost
pruned feature length
accuracy

    eric a finkelstein  ian c fiebelkorn  and
guijing wang  national medical spending attributable to overweight and obesity 
how much  and whos paying  health affairs web exclusive  may      

value
     
   
     

    king shy goh  edward chang  and
kwang ting cheng  svm binary classifier
table    kfc  feature vector  
ensembles for image classification  in proceedings of the tenth international conference on information and knowledge mannamically training on new classified images as
agement  cikm     pages         new
they are processed by the operators 
york  ny  usa        acm 
while the results are good  it is important
to realize the limitations of the accuracy re      michael e  holmstrup  kay stearnsbruening  and timothy j  fairchild 
ported in this project  there are several faccaloric estimation bias of realistic meal
tors that favors higher accuracy that might be
and beverage preparations       
removed in a real world scenario  in particular the datasets contains only images taken in
    c k  martin  s  kaya  and b k  gunthe laboratory which means that the lighting
turk  quantification of food intake usis somewhat consistent in all images  and bad
ing food image analysis  in engineering
images  blurry  wrong exposure etc   have
in medicine and biology society       
been removed  the dataset also contains only
embc       annual international cona subset of the foods oered at the restauference of the ieee  pages           
rants  which will to some degree inflate the
     
accuracy scores since we have fewer objects
to match between 
    corby k  martin  hongmei han  sanother interesting areas to explore in this
dra m  coulon  h  raymond allen 
area would be a similar project  but based o
catherine m  champagne  and stephen d 
sit down restaurants  not fast food  as well as
anton  a novel method to remotely mealearning the typical meal choices of users and
sure food intake of free living individuals
further narrow the dataset by applying a prior
in real time  the remote food photograprobability distribution 
phy method  british journal of nutrition 
                     

references

    a  vedaldi and b  fulkerson  vlfeat  an
open and portable library of computer vi    cl bish  hm blanck  mk serdula 
sion algorithms  http   www vlfeat org  
m marcus  hw kohl  and lk khan  diet
     
and physical activity behaviors among
americans trying to lose weight       behavioral risk factor surveillance system 
obes res                  
    chih chung chang and chih jen lin 
libsvm  a library for support vector machines       
 

fi