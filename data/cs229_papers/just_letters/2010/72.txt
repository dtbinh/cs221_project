machine learning final  learning the structures and predicting
behavoir of potential function based multi agent formations
doug beck
aeronautics and astronautics
stanford univeristy

tzong han lee
electrical engineering
  materials science by courtesy 
stanford univeristy

chun yeon lin
mechanical engineering
stanford university
december         

abstract
k eeping formation is a technique used to maintain order in multi agent dynamical systems  understanding formations has implications for military applications     as well as better understanding group behavior        in past work  potential
functions involving the distances between agents are
used to maintain formation for both centralized and
decentralized systems        in      formations are
defined rigorously using sets and the notion of formation rigidity is explained  in      virtual leaders
are established as a means to move formations held
together by artificial potentials  artificial potentials are also used in robotics research  like in     

satellites which were all maintaining position based
on a central comm satellite  destroying the comm
satellite would render the entire group useless  finally  better predicting an area in which some targeted group will be after a delay while avoiding untargeted groups is important for military scenarios
in which innocent groups are involved  being able to
accurately predict such an area would have tremendous application in todays wars  which are more
and more waged amongst civilian parties  the development of an accurate algorithm which can identify such an area with great confidence would help
one predict whether to hold off on an area focused
attack strategy until there is greater chance of targetted parties being affected without injuring innocent parties 

i n this project  we developed a series of tools
in order to classify groups and their structures  as
well as predict a region which encompasses as many
agents in a targeted group as possible  without encompassing any members from untargeted groups 
classifying groups by observing the dynamics of
multi agent groups could help distinguish between
friendly and unfriendly forces in a military scenario
in which it is difficult to determine the intent of
certain agents  in determining the overall structure
of a group  the links that define a formation   one
understands which agents are maintaining distance
with which other agents in order to create global  coordinated behavior the formation is predicated on 
it then becomes easier to identify agents pivitol to
holding the structure together and destroy it more
efficiently  for instance  if the group was a cluster of

we use an algorithm highly motivated by kmeans in order to distinguish each of the multi agent
groups from other groups that are operating in the
same region  we also classify the structure of the
multi agent system by using logistic regression  using forward search in order to determine the best
two features to use  where a groups structure is
defined by the set of links between its agents  a
link implies that two agents are trying to maintain
the distance between them  we model this communication as internal linear springs which push the
agents apart when the agents are less than some
constant chosen distance apart and pull the agents
together when they are more than some fixed distance apart  the motion of each agent is damped 
it is important to note that similar potential functions are commonly used in order to maintain forma 

fition in decentralized systems            finally  we
predict a circular area in which an entire targeted
 p
group will be  and which no untargetted agents will

i j   kij      bij   dij
be  using an algorithm which relies heavily on linear a    m       n    
if i    j

regression 
   i j

 

the chosen
model

kij  the virtual spring rate between agent i and j
bij  the natural length between agent i and j

multi agent

 
x 
w e created our own simulation specifically for
 
 x 
 
fc
this project using the following model in order to
 
 
 y  
test the algorithms we developed  we draw from
 
 
fc 
 y 
 
a chosen uniform distrubution of the constants the
 
 
 


  
model depends on in order to train and test our


x     b   
 
methods on multi agent systems of varying size and
 
   
 
xn
performance  we discretized our continuous model
 
 


 
 
by integrating forward in time with runge kutta  
xn


 
yn
 rk   we consider there are m groups  and each
yn

group has n agents  it is assumed that each agent
only knows the distance between it and other agents
it is linked to and that the motion of all agents  ex  it should be noted that this state matrix is equivacept for the leader  is governed by applying a force lent to applying the following force to the agents 
to themselves proportional in to the difference be


p
tween the current and desired distance between it  
xj  xi 
 
 
and each of the agents it is linked to  like a first fij   yj  yi kij     dij    xi  xj      yi  yj    
order spring relationship with spring kxi xj   

where kij   kji and dij   dji by definition 
k  if xi and xj have connection
k xi   xj    
   if xi and xj have no connection
n
p
f ij
there is one leader in each group  who pulls the
j  
x i  
rest of the group with a control force 
m

some signal  if xi is the leader
f c xi    
the fact that dij is a function of the state  makes
  
otherwise
this a nonlinear problem  we add damping to the
the following picture helps illustrate the model system by subtracting a damping term  bi xi from
the acceleration of agent i  xi   this causes the
we chose 
agents to converge asymptotically to a final state
with no velocity or acceleration in the absense of
external forces as proven in     

 

group classification

t he first tool was developed to determine which
group each agent corresponded to by observing the
position component of each of the agents state over
time alone  wouldnt know the original group assothe state space of each group can be described as ciation in the field   in order to do this  we used a
follows 
modified version of k means with a range of k  the
x   ax   b
number of cluster centroids  that matched the range
 

fiof possible multi agent groups in the set 

   select a k value




   initialize k cluster points randomly




   repeat unitil all cluster centroids w in   





 i  perform k means


 ii  update the initial cluster points from  i 
iii  increment state of all agents by one


time step




 




   agents associated with the same cluster point




are said to be in the same group at simulation



end

of agents who are associated with a cluster point
which contains more agents in their original group
than any other group divided by the total number
of agents  this approaches  and reaches    as k approaches the number of total agents because when
there are as many cluster points as agents  every
agent must be associated with a cluster point which
contains more of its group than any other 
while these error metrics were used in order to
validate the use of total distance as a way to choose
the best k  one would not be able to calculate
them without knowing the original group association  the number of cluster centroids is selected
at the beginning of each training run and then the
k for which the total distance stops improving as
dramatically is selected  most likely by a human  
this value of k typically corresponds with both high
original accuracy and high classified group accuracy
 even when the value of k chosen isnt exactly true
to the original number of groups being simulated  
one can see from the total distance vs  k curve
 above green   that   is the value for k after which
there are only marginal improvements  this makes
sense since we would assume that the agents in a
group are clustered together closer than agents from
other groups  the rationale is that there shouldnt
be very much improvement after ensuring that there
are at least as many cluster points as there are relhow k value chosen for group classification
atively tightly bound groups on average over time 
the group of agents on right of the below graph
at each simulation time step  the number of
represents a time step at which the agents were all
time increments that the ith agent was associated
correctly identified and the value of k corresponds
with the jth centroid cluster is updated in the maexactly to the number of groups being simulated  in
trix  sij   at the end of the algorithm  each agent
our graphical notation  circles represent agents  and
is put in a group for which maxj  sij    agents
same colored lines represent links between agents in
i  the maximum distance between any cluster
the real world model  the algorithm doesnt know
centroid and any of the agents summed over all the
which are related in a model sense   agents with the
simulation time steps and normalized by the largest
same color circle have been classified in the same
value for any k is plotted in green against k in the
group by the algorithm for the displayed time step 
above figure  we call this total distance  also 
the original group error and classified group error
are plotted against k in blue and red respectively
in the above figure 
the original group error is the number of agents
across all of the original groups which were associated with the same cluster point that the majority
of the agents in their same original group were divided by the total number of agents  this error
approaches  and reaches    as k approaches   because when all of the agents are associated with the
simulation of   groups of agents classified by
same cluster point  all of the agents in each agents k means algoritm at time      and time      
original group are associated with that same cluster
point  the classified group accuracy is the number the above left figure demonstrates a case when the
 

fim
x
groups happen to be fairly close to one another 
l    
y  i  log h x i          y  i    log    h x i    
this causes a mislabeling at this specific time step 
i  
the algorithm only works if the agents are watched
long enough that these anomolies represent a small
percentage of the cases and on average  agents
      h     l  
associated with the same cluster point are all
associated with the same original group 
h is the hessian matrix
although we dont have hard proof based on a series of humans choosing the values of k at which they
think total distance stops decreasing significantly 
the correlation between what we believed this value
of k was and high original and classified group accuracy led us to believe that this algorithm is a useful
candidate for dynamic group classification 

 

link classification

n ext  we developed a tool for link classification 
we use logistic regression to classify link or non link
for any two agents in a group  y  i     or   respectively   we used the mean and variance of distance 
velocity  and acceleration over a set number of simulation time steps as features for all links spanning
two agents in the same group  each state was observed over a series of time steps and at the end
of the simulation the candidate feature vector  x 
 in the sense of the below equations  was generated  we then stored the feature vector  x  and
whether there was a link between two agents or not
and restarted the simulation with another randomly
generated group we used logistic regression to classify the data with newtons method to optimize for
l   as outlined below  we obtained a   and used
that  to classify the test data  we repeated this
method for    groups whose size ranged from     
agents and reported the average error for each feature  below are the average errors  per simulation
run  when various features were used  although
this data is biased since there are about      links
to not links  logistic regression proved useful as a
link prediction tool as our end accuracy was greater
than        we found that it performed better than
gda since the data was not gaussian  as displayed
in the below tables  we used forward search  to find
that the best two features are variance of the distance and mean of the acceleration  also below is
an example of training and test data for our chosen
best features 
h  x    g t x   g z   

above is a one of the train test runs we used in
order to determine an average error  the above
case corresponds to a       accurate run 

 

group behavior prediction for area based attack
strategies

f inally  we developed a tool for predicting an
area in which all agents of a targeted group could
be attacked after some time delay without affecting
other groups  linear regression on the time history
of each groups centroid and the average distance
traveled along the line per time step were used to
extrapolate the position of the group centroid after
a time delay  the radius in which it could be expected all agents would fall within  was picked to be
the max distance from centroid to any agent in any
time step in the same training set  finally  a radius
about the targeted group  is  expected centroid
is calculated via the below equations where j the
group whose calculated radius comes closest to is 

 
    ez
 

fireferences
   
balch 
tucker
and
ronald
c 
arkin behavior based formation control
for multirobot teams  ieee transactions on
robotics and automation  vol           
    leonard  naomi ehrich  and edward
fiorelli virtual leaders  artificial potentials
and coordinated control of groups  proceedings of the   th ieee conference on decision
and control       
    fiorelli  edward and naomi ehrich leonard 
 cooperative control of mobile sensing
networks  adaptive gradient climbing in a
distributed environment  ieee transactions
on automatic control  vol     no          
    murray  richard m   and reza olfati saber 
distributed cooperative control of multiple
vehicle formations using structural potential
functions  ifac world conference       
    raffard  robin l   claire j  tomlin  and
stephen p  boyd optimization for cooperative
agents application to formation flight    rd
ieee conference on decision and control 
     
    murray  richard m   and reza olfati saber 
graph rigidity and distributed formation
stabilization of multi vehicle systems  proceedings of the   st ieee conference on
decision and control       
    o  khatib real time obstacle avoidance
for manipulators and mobile robots  int  j 
robotics research             

the below figure shows the percentage time that
the entire targeted group was located within the target area without any untargeted agents vs  time delay  as one might predict  the larger the time delay
is  the worst the algorithm is at predicting a circular
area which meets the criteria 

 

conclusion

in this project  we develop tools to classify groups 
classify links  and predict an area in which one can
attack a target group after some delay  such as the
delay after a bomb is launched  with as little collateral damage as possible 
we believe that these or similar tools  which use
machine learning techniques  show promise in military applications and could be used in order to more
quickly determine the nature of third party multiagent systems  the tools could help to distinguish
agents in one group from another  understand the
rules under which a given group operates to destroy
it faster  and determine the best time to launch an
area based attack without affecting innocent parties 
 

fi