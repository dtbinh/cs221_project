feature selection and dimensionality reduction of neural data to model
adaptation in the retina
neda nategh
electrical engineering department  stanford university
stanford  ca      
nnategh stanford edu

abstract
retinal ganglion cells are most sensitive to the visual
feature defined by the linear spatio temporal receptive
field  they encode this feature according to a nonlinear
sensitivity curve that often has a threshold and saturation 
both the linear receptive field and nonlinearity are
adaptive  in that these parameters change depending on
the recent statistics of the stimulus 
in the context of motion processing  changes in gain
are important for a cell to detect textures of low contrast
or luminance  but not be saturated by high contrast or fast
motion  in order to make the comparison of trajectory in
the center and background regions  both sites should
avoid saturation  yet detect all available weak motion
signals 
one potentially rich source to generate adaptation is
the diverse population of inhibitory amacrine cells  which
comprise about thirty types  amacrine transmission is
thought to play a role in retinal adaptation to more
complex stimulus statistics  hosoya et al          but not
for simple statistics such as luminance and contrast 
to understand how the circuit transforms the visual
scene  we will identify components of retinal image
processing using a novel combined experimental and
theoretical approach that includes intracellular recording 
simultaneous current injection and multielectrode
recording  and computational modeling  here  we carry
this analysis further and divide the population of ganglion
cells into functional classes using quantitative clustering
algorithms that combine several response characteristics 
we first used the dimensionality reduction methods to
extract the visual features encoded by the amacrine and
ganglion cells that best describe their response properties 
using these features to classify the interactions between
these two cells revealed seven types of transmissions  in
agreement with the types of modulations in the response
properties of ganglion cells derived by the amacrine cells
output 

   introduction

object motion sensitivity in the retina
one of the important circuitries in the retina that
contains multiple sites of adaptation is the object motion
sensitivity circuitry  in which amacrine cells play an
important role 
recently  it was discovered that segmentation of
moving objects  and rejection of background motion
begins in the retina      a subset of retinal ganglion cells
responds to motion in the receptive field center  but only if
the motion trajectory is different from that of the
surrounding region  figure    

figure    objection motion sensitivity in a retina ganglion cell 
electrical activity in oms ganglion cells was recorded from the
isolated retina of a salamander  a video monitor was projected
onto the retina  and extracellular electrical impulses were
recorded with an array of electrodes  a  diagram of object and
background regions in the stimulus display  b c  first row 
spacetime plot of a vertical cross section through the center of
the stimulus  line in a   showing trajectories for global motion
and differential motion  global motion represents fixational eye
movements with no object motion  differential motion
represents object motion in the presence of eye movements 
motion in the object region is identical in both cases  second
row  average firing rate of an oms ganglion cell in response to
   repeats of each stimulus sequence  the cell is nearly silent in
global motion  but fires precise bursts of activity during
differential motion   from baccus et al         

these cells are termed object motion sensitive
 oms  cells  like many retinal ganglion cells  the

firesponses of oms neurons are highly precise      when
the same visual stimulus is repeated  the action potentials
are highly reproducible in time  in some cases to within
less than a millisecond  this has enabled mathematical
models to capture the responses of oms cells  involving
the interaction of oms cells and other interneurons in the
retinal circuitry  figure    

figure    model and neural circuit for object motion sensitivity 
 top   the visual stimulus is first processed by linear subunits
with a small receptive field and transient dynamics  an oms
ganglion cell  g  receives excitatory input in the object region
from multiple small subunits  each subunit applies a linear
spatiotemporal filter to the stimulus in its receptive field 
amacrine and ganglion cells each sum the rectified output of
many linear bipolar cells  to predict the response of an oms
ganglion cell to differential motion  amacrine inhibition from the
background was combined with bipolar input from the object
region before the stage of rectification   bottom  the neural
circuit that produces object motion sensitivity  bipolar cells
perform the spatio temporal linear filtering  rectification is at
the output synapse of bipolar cells  a specific subtype of
amacrine cell with long axons produces background suppression 
 from baccus et al         

although this block diagram describes the response of
the oms ganglion cell accurately  it does not specify what

neural circuit and what algorithm implements the
computation  to flesh out the schematic with actual
processing units and building blocks of an object motion
algorithm  one needs to answer the following questions 
    what is the identity and properties of the subunits and
inhibitory cell      how is the output of these subunits
integrated      at what level is the signal from background
motion combined with that from the object region 
in our quest to answer these questions  we measured
how the signals transmitted through individual amacrine
cells contribute to the ganglion cell response by recording
intracellularly from single amacrine cells while
simultaneously recording spiking activity from the
ganglion cell population using a multielectrode array  we
presented a randomly flickering visual stimulus drawn
from a gaussian distribution while injecting gaussian
white noise current into the amacrine cell  by this direct
perturbation of the circuit we measured how the
interneuron generates adaptation of the ganglion cell
visual response 
to model the contribution of each amacrine cell to
each ganglion cells visual response  we combined
elements of a linear nonlinear  ln  model  consisting of a
linear temporal or spatio temporal filter followed by a
static nonlinearity  the model consisted of the linear
receptive field and nonlinearity of the ganglion cell  a
modulatory pathway containing the ln model of the
amacrine cell  and a transmission filter linking the two
pathways 
we found that amacrine transmission scales the
ganglion cell nonlinear response function by a gain factor 
and in some cases  also modulates the linear receptive
field of the ganglion cell  changing it from being more
integrating to more differentiating  this modulation is
driven by the preferred feature of the amacrine cell  even
if this feature is different from that of the ganglion cell 
even at a fixed luminance and contrast  retinal
ganglion cells adapt at a fast timescale  for this type of
adaptation  an amacrine cell provides contextual
information that modulates the ganglion cell visual
response  thus  the space of visual features encoded by
the diverse population of amacrine cells defines a
multidimensional context that gates and modifies a
different space of visual feature encoded by the population
of ganglion cells 
these modulations vary in their selected features 
patterns  model parameters  and strength  this project
studies the diversity of these modulations  potential
sources of this variability  and their possible functional
contributions to the retinal processing  to understand the
contribution of amacrine transmission to fast adaptation of
retinal ganglion cells  we will identify and characterize the
functional role of an amacrine cell using the following
procedure 
first we divide the population of ganglion cells and

fiamacrine cells into functional classes using quantitative
clustering algorithms that combine several response
characteristics  since the response characteristics of the
neurons occupy a high dimensional space of features  we
use the dimensionality reduction techniques to find a low
dimensional representation of the feature space that is
being used for clustering the neurons  then we divide the
modulations into functional classes using clustering
algorithms  based on changes in the response variables
that are reflected in our models parameters 
finally we explore the correspondences of these two
clustering schemes  if members of each modulation cluster
corresponded to the distinct functional clusters of neurons 
we could understand which properties or components of
ganglion cells or amacrine cells response are
contributing to or shaping the adaptation components 

analysis  modeling

   methods

to capture the effect of the amacrine cell  we have
modified the direct  single pathway ln model of the
ganglion cells firing rate by adding an indirect parallel
pathway that includes the effect of amacrine cell on the
direct visual pathway  figure     our modified model
consists of the following components  all computed from a
single experiment 
  direct input  a spatio temporal ln model of each
ganglion cells firing rate is computed  this pathway
represents inputs to the ganglion cell other than the
amacrine cell 
  amacrine input  a spatio temporal ln model of
the amacrine cells membrane potential is computed by
correlating the visual stimulus with the cells response
 figure    
  amacrine transmission kinetics  by correlating the
gaussian white noise current injected into the amacrine
cell with each ganglion cells firing rate  a linear temporal
filter is computed representing the average kinetics of
transmission for each cell pair  figure    
  amacrine effect on the ganglion cell nonlinearity 
we characterize the transmission of the cell by computing
a two dimensional nonlinear function that combines the
amacrine transmission with the direct pathway  we found
that the amacrine transmission changes ganglion cells
nonlinear characteristics by scaling its nonlinear response
function by a gain factor  figure    
  amacrine effect on ganglion cell temporal
processing  we have found that this amacrine cell strongly
modulates the temporal response of ganglion cells  when
the amacrine cell is more hyperpolarized  the ganglion cell
speeds up and becomes more differentiating  thus
encoding changes in light intensity more than the absolute
light intensity  figure    

stimulation
a uniform field randomly flickering visual stimulus 
drawn from a gaussian distribution  is projected from a
video monitor onto the intact  isolated salamander retina
and an array of extracellular electrodes is used to record
the light responses of many ganglion cells at once 
simultaneously  an intracellular recording monitors the
visual responses of an amacrine cell  then  white noise
current is injected into the amacrine cell to measure the
kinetics and nonlinear properties of how the cells output
modifies the circuits behavior  thus  many simultaneous
paired recordings are performed  figure    

figure    schematic diagram of simultaneous intracellular and
multielectrode recording preparation 

a simple model that has been used to approximate
the behavior of amacrine and ganglion cells is a linearnonlinear  ln  model  figure         the ln model
describes the average behavior of the circuit  but does not
account for many of the nonlinear contributions of
individual amacrine circuits 

figure    linear nonlinear  ln  model  the ln model consists
of the stimulus intensity weighted over time by a linear temporal
filter or spatio temporal filter  followed by a static nonlinearity 

fifigure    model of amacrine cell transmission acting on a
ganglion cell  the visual stimulus s t  passes through fa t  and
na a   the linear filter and nonlinearity of the amacrine cell 
followed by ft t   the amacrine transmission filter  the amacrine
pathway modulates both the kinetics and the nonlinearity of the
ganglion cell  the ganglion cell visual linear filter  fg t   was
calculated by averaging visual stimuli preceding the time of a
ganglion cell spike 

analysis  classification
we used a broad parameter ensemble linear temporal
filters  and nonlinearity functions of the two pathway ln
model to classify cells or cell pairs into types having
systematically different temporal responses and nonlinear
sensitivities  each linear temporal filter is characterized by
a high dimensional visual response vector as a function of
time  with the size in the order of hundreds of
milliseconds  a nonlinearity function is characterized by
three parameters a   a    a   of its exponential fit of the



a erf   x  a

table    multidimensional scaling
given high dimensional points x i   recovers the low dimensional
coordinates of the data that describe where the points lie on the
manifold  in other words  find an embedding of the data in a low
dimensional space  that preserves its essential regularities



     

  a   
the functional similarity between two cells or two
cell pairs is initially quantified by computing the meansquared difference between their temporal dynamics and

nonlinearity
parameters  however  since we have
hundreds of cells and cell pairs  each characterized by a
high dimensional feature vector consisting of its temporal
dynamics and static nonlinearities  we need to construct a
low dimensional representation of the response
characteristics to find a reasonable quantitative measure of
functional similarity used to feed our clustering
algorithms 
because there exists no a priori method of functional
classification  we have made several choices of
dimensionality reduction and clustering methods to divide
the ganglion cells  amacrine cells  and ganglion amacrine
cell pairs into broader or finer groupings 
we initially used the temporal dynamics of the
receptive field to classify ganglion cells into functional
types  we used linear dimensionality reduction methods
including principal component analysis  pca   and
multidimensional scaling  mds   table        to find a
form

low dimensional representation of the high dimensional
visual response vectors  namely the linear temporal filters
and static nonlinearity functions of ganglion and amacrine
cells 
combining all these linear and nonlinear receptive
fields characteristics results in a nonlinear feature space 
however  linear dimensionality reduction methods will
fail to find any lower dimensional space that is embedded
non linearly in a higher dimension  for euclidean
manifolds  isomap  table        and locally linear
embedding  lle   table           avoid this shortcoming
of linear projection  the idea is that for a given point in a
well sampled space  the points nearest neighbors will lie
only in that low dimensional  then  if we preserve the
local geometry and dimension of each neighborhood  we
should be able reconstruct the manifold using only the
dimension of those neighborhoods 

table    isomap
the isomap algorithm takes as input the distances dx i j  between
all pairs i j from n data points in the high dimensional input
space x  measured either in the standard euclidean metric or in
some domain specific metric  the algorithm outputs coordinate
vectors yi in a d dimensional euclidean space y that best
represent the intrinsic geometry of the data 

table   locally linear embedding
lle maps a data set x  globally to a data set y  assuming the
data lies on a nonlinear manifold which locally can be

fiapproximated linearly  it uses two stages   i  locally fitting
hyper planes around each sample xi  based on its k nearest
neighbors  and calculating reconstruction weights  and  ii 
finding lower dimensional co ordinates yi for each xi  by
minimizing a mapping function based on these weights 

be biased toward forming extra clusters when used on data
with relatively few examples     
in k means clustering  we first decide how many
clusters the data will be divided into and randomly assign
one cell to each cluster  all remaining cells are assigned to
the nearest cluster  based on the  normalized  meansquared difference between cell i and cluster k  aik  for this
analysis  we used the visual features extracted by our
dimensionality reduction algorithms  next  the cluster
waveform is computed by averaging the features of all
members  at this point  a goodness of fit measure is
obtained by calculating the total mean squared difference
between all cells and their respective clusters  a    a ik  
i

finding a low dimensional representation of the
linear dynamics and nonlinear sensitivity characteristics
for the cells or cell pairs  we formalize classification using
k means clustering and hierarchical clustering algorithms 

broad classification
functional classification was carried out using the
method of agglomerative clustering      an iterative
algorithm  that at each step merges the most functionally
similar cells into the same cluster and averages all of their
properties together  weighted by the number of cells in
each cluster  by examining the similarity of the clusters
that are merged at each step of this algorithm  we can
assess the significance of the merger  which is the
functional difference between the two clusters that were
merged together  by looking at the merger score as fewer
and fewer clusters remain  we can find that the differences
between clusters suddenly become large  which indicates
that these clusters are significant 
an alternative way to set the significance threshold is
by looking at the histogram of the merger score  in this
manner  one can identify all of the outlier values of the
merger score and set the number of clusters as the
maximal number that includes all these outliers  figure
 a  
further discussion of the issue of choosing the
number of significant clusters in a data set can be found in
several interesting books and articles      for broad
functional types  the algorithm was applied to all of the
cells recorded from multiple retinas 

the algorithm iterates by starting with the new
cluster waveforms and reassigning all cells to the nearest
cluster  this iteration is continued until the total difference
between cells and clusters    
no longer decreases 
because the resulting cluster structure depends on the
choice of initial clusters  we repeated this algorithm with
     different random choices of initial cluster definitions
for each value of k and selected the final cluster partition
that had the smallest total difference       
the number of clusters k is a parameter of this
algorithm  and as more clusters are used to describe the
population  the total difference  k  must decrease  to
determine what value of k resolves significant clusters  we
plotted the decrease in the total difference as new clusters
 k  

 k  

  k   

 a a
were added  
  when this decrease
is large  clusters are significant  and when the decrease is
small  the new clusters resolve only minor details in the
ganglion cell population  figure  a  

   results
to understand the manner in which ganglion cells
and amacrine cells collectively represent a visual scene 
we calculated the temporal amacrine transmission filter of
every recorded ganglion cell in a small patch of the retina 
by reducing the dimensionality of the feature space
characterizing the interaction between response
characteristics of the visual pathway consisting of a
ganglion cells ln model and response characteristics of
the modulatory pathway containing the ln model of the
amacrine cell  we could quantitatively cluster the
interactions namely the transmission filters linking the two
pathways  such computation will elucidate how these
clusters of interactions distribute their responses to a
dynamic input variable 

fine classification
to split the ganglion cell population or ganglionamacrine cell pair interactions into as many types as could
be justified by the data  we used k means clustering to
define cluster boundaries  because this method is known to

classification of ganglion cells

fi 

merger score norm  

our objective here was to use quantitative clustering
techniques along with a very descriptive set of features  so
that our results better reflect the information encoded
collaboratively by ganglion cells and amacrine cells about
the visual scene  because there exists no a priori method
of functional classification  we made several choices of
feature space and clustering method to divide the cells into
broader or finer groupings  we found that the feature
dimensions found by the pca and mds methods were not
descriptive enough to cover all types of the observed
modulations  however  we found that lle performed as
well as isomap and both better than the linear
dimensionality reduction methods 
code from the authors of lle and isomap was
downloaded and run over the data structures used  code
for pca  mds  clustering  and modeling was written by
neda 

   

   

 

 

  

  

  

  

  

  
  
  
number of clusters

  

   

   

   

   

   

b

broad types

    
              
            
             
           
                
             
             
           a
           

we used the dimensions computed by the isomap
algorithm to classify interactions into functional types  we
formalized classification using an iterative algorithm that
at each step merged the most functionally similar
interactions into the same cluster and averaged their
corresponding transmission filters together  by examining
the similarity of the clusters that are merged at each step
of this algorithm  we can assess the significance of the
merger  when two clusters are very similar  their merger
score will be close to zero  and when two clusters are very
different  their score will be greater than one 
figure  a shows the results of this clustering
algorithm when applied to     ganglion cells recorded
from eleven retinas in the salamander  whose amacrine
transmission profiles are shown in figure  b  there was a
clear break in the similarity of cell clusters  shown by a
dashed line  at this point  there were seven distinct
clusters with multiple membersmonophasic on 
biphasic on  biphasic off  monophasic off  biphasic
weak on  fast biphasic  and slow biphasic  shown in
colors as well as eight cells that belonged to their own
cluster  shown in gray  
the distinct clusters had members recorded from at
least half of the eleven retinas used in this study and were
routinely observed in other experiments  so we treated
them as broad types  unique cells were observed in a
single retinal patch and were not commonly seen in other
experiments  so we treated them as unclassified  the
classification of cells into seven broad types is a robust
property of the temporal dynamics of the transmission
filters 

significance threshold 
  broad types
  unclassified filters
 

 

 

       
 

   

   

   

          

figure    a  merger score as function of number of clusters 
significance threshold  red dashed line  identifies   broad types
and   unique cells  b  amacrine transmission filters  of    
ganglion cells measured from    retinas with broad type
indicated by color

fine types
because agglomerative clustering algorithms lump
the transmission population into no more than seven broad
functional types  we wanted to explore other clustering
schemes that might resolve more types  our approach was
motivated by the observation that for data recorded from a
single patch of the retina  where ganglion cells presumably
shared inputs from some of the same amacrine
interneurons and also both amacrine and ganglion cells see
the same visual stimulus  we often found several
transmissions with exceptionally similar functional
properties  building on this observation  we used a fine
classification scheme  where we considered only cells
from a single retinal patch  to divide the population into

fithe maximal number of cell types allowed by the data  we
used k means clustering to define cluster boundaries 
figure   shows examples of fine types formed from
ganglion cells recorded in three different retinal patches 
as more clusters were formed  the total difference
between the transmission profile of individual ganglion
cells and cluster averages decreased  figure  a   for the
first retinal patch  top row   this decrease  k  was large
when the number of clusters was   or less  and dropped
significantly when    clusters were formed  as a result 
 

we divided this group of transmissions into   fine types
 figure  b   for the second and third retinal patches  a
transition in the clustering score  k  was found after six
clusters  consistent results were found for other retinal
patches  with a total number of fine types ranging   
depending in part on how many cells were recorded in a
single patch  our fine classification scheme was consistent
with the broad scheme  fine functional types were either
the same as a broad type or they were subtypes within a
single broad type  the fine types never combined cells
from different broad types 

a

b

    

 

filter s   

change in mse   

 

 

 

 

 

 

 

  
number of clusters formed

  

  
     
 

   

   

   

   

   

time msec 

 

    

 

filter s   

change in mse   

 

 

 

 

 

 

 

  
number of clusters formed

  

  

     
 

 

   
time msec 

    

 

filter s   

change in mse   

 

 

 

 

 

 

 

  
number of clusters formed

  

  
     
 

   

   
time msec 

   

fifigure    a  change in the mean squared difference between
cluster centers and individual cells  k  plotted as a function of
the number of clusters k for three retinal patches  clusters were
defined using k means clustering  the decrease in mean squared
difference dropped sharply after         clusters were defined
 top middle bottom  and reached a similar small value  indicating
that these subsequent distinctions were not significant  dashed
red line   b  transmission filters of cells simultaneously recorded
from three retinal patches  cells are divided into fine types 
shown by their color 

   conclusion
we relied on quantitative methods of functional
classification  involving several choices of clustering
algorithm as well as several choices of response
characteristic  using dimensionality reduction   one issue
that should be addressed is how we can compare the
performance of different dimensionality reduction
methods  e g  lle versus isomap  moreover  because any
method of functional classification requires some arbitrary
choices  we should supplement this approach by some
other measures of functional similarity such as analyzing
the shared information between ganglion cells that can be
calculated during stimulation with natural scenes and
makes minimal assumptions about how ganglion cell spike
trains encode the visual world 

   acknowledgements
i thank professor stephen baccus for valuable and
critical discussions  and mihai manu for help with data
collection 

references
    olveczky bp  baccus sa  meister m        segregation of
object and background motion in the retina  nature          
    baccus sa        timing and computation in inner retinal
circuitry  annu  rev  physiol          
    chichilnisky ej        a simple white noise analysis of
neuronal light responses  network            
area mt  j  neurophysiol               
    cox tf and cox ma  multidimensional scaling  second
edition      
    tenenbaum jb  de silva v  langford jc        a global
geometric framework for nonlinear dimensionality reduction 
science                     proc  ieee conf  comput  vision
pattern recog           
    roweis s and saul l        nonlinear dimensionality
reduction by locally linear embedding  science                   
    ridder dd and duin rpw        locally linear embedding
for classification  ieee trans  on pattern analysis and machine
intelligence  number ph        
    segev r  puchalla j  and berry mj        functional
organization of ganglion cells in the salamander retina  j
neurophysiol              
    duda ro  hart pe  and stork dg  pattern classification 
new york  wiley interscience      

fi