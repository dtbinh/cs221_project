a spam classifier for biology  removing noise from small rna datasets
diane wu  cs    fall     
background and motivation
originally discovered as an antiviral mechanism  rna interference  rnai  has since then been
shown to play a large role in the natural cellular regulation of endogenous transcripts  the products of
the rnai pathway and the effectors of transcript regulation are small       nucleotide  nt  small rnas
that are homologous in sequence to their target transcripts  consequently  discovery of small rnas that
are identical in sequence to an endogenous transcript implies possible role of the rnai pathway in the
regulation of said transcript 
many groups of small rnas exist in the cell are encoded by the host genome naturally  most of
the well characterized groups of small rnas are typically oriented antisense to the target transcripts
and are believed to be produced by templating off the endogenous transcript  in the nematode c 
elegans  this includes a class of      nt small rnas that have been largely implicated in transcriptional
silencing  two other classes of less well characterized small rnas of sizes of      nt and   nt 
respectively  also appear to have silencing effect  while we will not
discuss the mechanistic details regarding the generation of these
direction of transcription
small rnas here  we will note that these small rnas are believed
to be produced by templating off the endogenous transcript  hence
resulting in an antisense orientation of the small rnas relative to
the transcript  figure    
but what about small rnas that align to the sense strand
of the transcript  do these exist  and if so  do have any function 
unfortunately  many confounding factors thwart any ventures to
answer this question  while i will not take time here to survey
direction of
those difficulties  i focus on the problem that small rna
small rnas
sequencing libraries are often plagued with mrna degradation 
making small rna datasets hard to evaluate  this problem arises
from the fact that small rnas are extracted using a size selection
small rnas are colored by size
yellow    nt  orange     nt  red 
method which selects for rnas of       nucleotides in length 
  nt  purple    nt  blue     nt 
hence  any larger transcripts that degrade naturally into this size
cyan     nt  green    nt
range by chance  e g  through random shearing of longer
transcripts during the rna extraction procedure  will also be
captured by sequencing  as a result  researchers often ignore
figure    notice size enrichment
looking at small rnas that align to sense strands of transcripts
of      nt rnas
because they are mostly plagued with contamination  while this is
true in many case by case analyses  this is a poor assumption to make and may drastically limit our
ability to detect novel signals 
the goal of this project is two fold  first  i aim to characterize distinct small rna signals over
loci throughout the genome  using two unsupervised algorithms  k means clustering and principal
component analysis  i expect to be able to both quantify the representation of known signals throughout
the transcriptome as well as potentially identify new small rna signals  as a second goal  i aim to
develop an algorithm to categorize small rna distributions as degradation or as a specific type of
signal  in particular  i will build an svm classifier for this task and experiment with values for the
parameters  training sets will be picked from a combination of exemplary examples from the
unsupervised clustering performed previously  in combination  these two goals would allow
enhancement of the signal to noise ratio in small rna datasets and provide the potential for discovery
of novel small rna signals from biological datasets 

fimethods
data set

a collection of    small rna datasets were obtained from the nematode c elegans using whole
animals  in brief  small rnas were sequenced using the solexa platform  and sequences were aligned to
the c  elegans transcriptome  rna counts of each length for each gene were added up  each dataset was
aligned to the genome using the bowtie short read aligner 
in order to select training points that offer high information content  the total of      
transcripts were filtered  for each sample  to include only transcripts that contain at least    small rna
read alignments and at least    unique sequences 
feature selection
the high dimensionality of biological datasets  the limited evidence for making assumptions of
independence  and the stochastic process of generating these datasets makes feature selection both a
challenging and critical aspect for the success of applying any machine learning algorithm on such
datasets  the initial set of features selected for this analysis was based on personal experience with
small rna datasets as well as characterizations of small rna biogenesis as revealed in the literature 
for each gene  i calculated the following possible features 
   total number of rnas aligned
   median redundancy of rnas aligned  i e  number of aligned rnas per unique sequence 
   proportion of number of rnas of each length    bp to   bp  aligned
   proportion of number of rnas over each  nt range  eg       nt       nt 
features were evaluated the ability of these features to separate the data using k means  see below   in
particular  i found that simply including     seemed to provide the best results  clusters of genes could
be separated and identified as possible degradation products based on visual inspection of the small
rnas  using ucsc genome browser  alignment visualization tool   including     and     expectedly
resulted in features that distinguished the data based on expression level and genomic structure 
respectively  surprisingly  including     actually reduced the separation of the features without
improving robustness of classification 
unsupervised learning 
principal component analysis and k means clustering

for each sample  highly expressed genes were subject to principal component analysis using the
set of features selected from alignment to the sense orientation  results from each sample was
consistent  principal component analysis of sense oriented small rna size distributions reveal distinct
separation of data points  the first two principal components explained an average of     and     of
the variance  respectively  analysis of the feature loadings for first two components reveal that these
correspond to distributions with high proportions of      nt rnas and larger       nt  rnas 
respectively  further  we performed k means clustering on these features and compared the results
with those from pca  figure     revealing clusters with centroid positions reminiscent of sirna size
distributions  purple  blue  and orange clusters  as well as degradation  green and red clusters   the
choice of k was selected between values of   to   based on robustness of the clustering for producing
similar cluster centroids 
figure     left 
pca of senseoriented small rna
size distributions 
each data point is a
transcript  colored
by cluster
assignment using kmeans clustering
with k     right 
centroid
distributions of
clusters 

fito test that our method for detecting mrna degradation is unlikely to misclassify real small
rna signals  based on inherent noise in the small rna population   we performed the same procedures
on a sample of small rna sequences from a different chemical preparation that is known to select for
one class of      nt sirnas  this reveals that aggregate small rna profiles for large sets of genes
indeed exhibit a strong characteristic and contain very little noise  supplemental figure     these
distributions are consistent regardless of the k used in k means analysis  data not shown  
since the populations of small rnas that we have termed mrna degradation have not been
previously characterized as a class of functional small rnas  nor has specifically studying mrna
degradation signals been of any interest to the small rna scientific community   we have no convincing
evidence from this analysis that these are indeed non functional or result from degraded mrnas 
however  we do find an indication for this suggestion  genes which exhibit small rna distributions
with the degradation characteristic also exhibit high mrna levels  supplemental figure    
suggesting that they are likely degradation products from these very abundant sources 
supervised learning  support vector machines
principal component analysis and k means clustering are useful for discovery of unanticipated
relationships in the features without bias of prior knowledge regarding the data  however  this
approach requires supervision to ensure the right choice of k in k means clustering  furthermore  kmeans clustering is a heuristic algorithm and results may vary largely between replications  both pca
and k means also relies on the significant representation of each type of data in the dataseta signal
that is not represented at a high level would be merged into an adjacent cluster in k means and would
not contribute to a significant proportion of the variance in pca  these above assumptions made by the
unsupervised algorithms make them poor candidates for general detection of mrna degradation
signals in novel datasets  particularly datasets from various genetic backgrounds that could drastically
perturb the landscape of small rnas  hence  we use the insight gained from these techniques to build a
support vector machine classifier for detection of mrna degradation signals 
since no labeling of positive or negative training sets exist  we define our training set using training
points with exemplary traits as defined from our previous analysis 
selection of negative training examples
to generate negative examples  i took the genes falling into the degradation clusters  in green
and red from figure     and selected for those genes which exhibit exemplary characteristics to those we
have identified as degradation  in particular  we chose genes whose small rna distributions on the
sense strand are  a  close to the centroid  sum of squared differences       maximum squared
difference of any length        and  b  have high mrna levels       mrna counts   justification for
the choice of cutoff for the first criteria is shown by examining a distribution of the squared differences
 supplemental figure     while justification for the second criteria was noted previously  supplemental
figure    
selection of positive training examples
positive training examples were generated using
distributions of small rnas mapping to the antisense strand 
since these are the canonical sirnas  even when k is set to a
large number  no centroid with a characteristic degradation
signal is observed  figure    k     hence  all genes close to
centroids in the antisense strand were used as positive training
examples  evaluated based on squared differences of
proportions as per negative training sets  
evaluation

figure    k means centroids of
antisense small rnas  k  

the goal of our classifier is to be able to take any dataset and label each loci as degradation or
sirna signal  as such  we are interested in the generalization error of a classifier for labeling the loci in
at least one whole small rna library  hence  we perform   fold cross validation on the    samples to

fiselect for optimal parameters for the model  i e  train on points form    samples  test on points from  
samples   an alternative method for evaluation is k fold cross validation of all data points without
grouping by sample  however  this provides an underestimation of generalization error  this
underestimation is due to the fact that the largest source of variance in small rna datasets is that
between different technical preparations of the rna libraries  revealing a proportion of points from any
library provides indications as to where the remaining points in that library might lie 
svms were built for each training set  positive training examples were labeled as   and
negative training examples  i e  degradation  were labeled as    different kernels were explored for
their performance in the svm in conjunction with varying parameter values such as those for c  gamma 
or degree of polynomial  as pertained to the particular kernel  the polynomial and linear kernels
performed worse than the radial kernel for all parameters tested  not shown   the logistic kernel
exhibited the worst performance  for the radial kernel  increasing c  the cost value for outliers  resulted
in better training and test errors if  is kept low  table     if  and c are increased simultaneously  the
model overfits the data  resulting in extremely low training error and high test error  in particular  such
values biased towards an unacceptably high false positive rate  labeling all points    optimal values for
test error  training error  and a balance of false positive and false negative rates can be achieved with c
taking values between   to   and  taking values between      and     
table    average test and training errors    fold validation  using the radial kernel for varying values of c and 
c
     
     
     
     
     
     
    
    
    
    
    
    
   
   
   
   
   
   
 
 
 
 
 
 
 
 
 
 
 
 

gamma
      
      
      
     
    
   
      
      
      
     
    
   
      
      
      
     
    
   
      
      
      
     
    
   
      
      
      
     
    
   

avg   error
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

training error
avg  fp
     
     
     
     
      
      
     
     
     
     
     
     
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

avg  fn
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

avg  error
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

test error
avg fp
     
     
     
     
      
      
     
     
     
     
     
      
     
     
    
     
     
     
    
    
    
    
    
     
    
    
    
    
    
     

avg fn
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

conclusions and future directions
by building a model to filter mrna degradation signals from sense oriented small rna profiles  we
provide an opportunity for further exploration novel pathways and functions of small rna regulation 
comparisons of small rna profiles of particular genes between samples in various genetic backgrounds
would be the logical next step in deciphering the function and regulation of these sense oriented small
rnas  characteristic differences may exist between sense oriented small rnas and antisense oriented
small rnas that we have not explored in this work  nevertheless  the results from this study illuminate
the large class of sense oriented small rnas that have previously been ignored 

fisupplemental figures
supplemental figure    k means and
pca of small rna distributions from
different rna cloning procedure that
selects for canonical sirnas 

supplemental figure    mrna seq data from same sample
was used to compare to small rna data  higher counts
indicate higher expression level  genes from degradation
cluster  colored as in figure    are highly expressed in mrna 
confirming implications of degradation in sirna signal 

supplemental figure   
 left  distribution of sumof squared differences
between genes in the
orange degradation
cluster  figure    and their
centroid  alternatively  we
can calculate the
maximum squared
differences of any rna
length between each gene
and its centroid  right  

references
karatzoglou a  meyer d  and hornik k  support vector machines in r  journal of statistical software  april
      volume     issue   
chang cc  lin cj         libsvm  a library for support vector machines  url
http   www csie ntu edu tw  cjlin libsvm
pak j and fire a  distinct populations of primary and secondary effectors during rnai in c  elegans 
science      jan             
han t  manoharan ap  harkins tt  bouffard p  fitzpatrick c  chu ds  thierry mieg d  thierry mieg j  kim
jk    g endo sirnas regulate spermatogenic and zygotic gene expression in caenorhabditis elegans  proc
natl acad sci u s a       nov          

fi