 

localizing a guidewire in three dimensions during endovascular
interventions using single view fluoroscopy and a stereo
roadmap  method and feasibility study
gennadiy chuyeshov

 

introduction

interventional radiology is the medical specialty where instruments such as guide wires and
catheters are inserted into a patient s vasculature under image guidance  during a procedure 
x ray source detector pair delivers live images of the anatomy and instruments based on x ray
attenuation 
in this context i want to introduce an algorithm which makes it possible to localize a
monoscopically visualized guidewire within a stereo roadmap or a  d reconstruction of the
vessel tree  besides the algorithm itself i will introduce its validation and implementation
within our application 
this application is intended to run in an interventional room  equipped with a siemens x ray
system  fig      diagnostic imaging capabilities of this system include  d projections  fig   
left  and  d reconstruction  fig     right  of the vasculature  however  during the intervention
when the instruments are being guided by a physician this system is capable to produce only
 d fluoroscopic images  fig     the goal is to display  d fluoroscopic images within a precomputed stereo roadmap or a  d reconstruction 

figure    siemens axiom artis dba 

figure     d projection and  d reconstruction 

having  d data you might want to use some existing product which is capable to fade between
 d fluoroscopic image and a reconstructed  d volume  e g  syngo ipilot  fig     another
possibility is to use roro  rotational roadmapping   this application uses a rotational
acquisition and proposes to do roadmapping directly on the  d projections  alternatively it
can fade between  d fluoro image and a stereo pair  here we define a stereo pair as two dsa
 digital subtraction angiography  images acquired at slightly different angles  fig      the key
feature of this approach is that it does not require  d reconstruction  which sometimes could

fi 

be challenging due to the cardiac or respiratory motion or due to the presence of the metal
objects inside the field of view
view 

figure    guidewire on a fluoroscopic
image 

 

figure    syngo ipilot output 
courtesy of dr  masaryk
 cleveland clinic foundation  

figure    blended stereo
pair 

problem statement

we are given two dsa images of a stereo pair  let us denote them as left
left eye and right eye
images  also we are given a single  d fluoroscopic image which corresponds to the left eye
left
image of the stereo pair  let us denote it as a left eye
left
fluoroscopic image  our goal is to find the
right eye
eye fluoroscopic image in order to display a guidewire within a stereo roadmap  once we
have found the right eye
eye fluoro image we can produce a stereoscopic image of the guidewire
by blending left  and rightt eye fluoro images 

figure    a point and two profiles  acquired along the same line segments 

 

algorithm

first  select a point on the left eye
left eye image of the stereo pair  and then acquire an intensity
profile along a horizontal line segment which goes through this point  see fig     left   after
that we acquire an intensity profile
profile along the same horizontal line segment  but on the rightright
eye image of the stereo pair  see fig     right   the goal is to determine the distance between
two peaks  i e  we need to match these two profiles  fig      lets denote this distance as a
stereo shift  before matching the profiles we apply window function  fig     in order to
remove other peaks caused by the nearby vessels  we determine the stereo shift using the two

fi 

following techniques  in the first one  referred as maximum difference  md  we find such s
which minimizes the maximum difference between two profiles  i e 
  argmin max      
ff



in the second one  referred as cross correlation  cc       we find such s which minimizes the
following expression 
  argminff   

figure    left   red  and right eye  blue  profiles
together 

                ff 
   
       

 

figure    window function 

on figure   green and magenta curves correspond to the md and cc algorithms respectively 
these functions both depend on the shift value  easy to see that the shift value which
minimizes both functions corresponds to the number we need to shift the right profile in order
to match it to the left one 

figure    sample output 

 

figure     examples of displacement maps  md  left  and
cc  right   shift value is marked by color 

implementation

after physician selected a working view we pre compute all the possible shift values for the
corresponding stereo pair  and then we compute a displacement map  fig       i e  for every
pixel of the left eye image we extract left and right intensity profiles  and then determine the
shift value and save the result into the look up table  having selected an appropriate working
angle physician acquires live fluoro sequence  consider a single frame from this sequence  we
apply fluoro mask to this image and binarize it  and perform noise filtering  next  every nonblack pixel of the left eye fluoro image is shifted according to the displacement map  now we
can display a guidewire within a stereoscopic image of the corresponding vessel tree  fig      

fi 

figure     stereo guidewire 

 

figure     six paths on an
skeletonized image 

figure     computed guidewire  blue 
and the ground truth  green  

validation

to test this concept we need to compare our results to the ground truth  however  we do not
have the ground truth in this case  since we cannot acquire two live fluoro sequences from two
slightly different angles simultaneously  however  we can get around it by employing the
following idea  consider a stereo pair  lets skeletonize both images and label skeletonized
right eye image as the ground truth  from the left image we extract six central paths which
go through the major vessels  fig          

figure     simulated  red  and computed  blue  guidewire visualized within a stereo roadmap 

fi 

here is how we perform the validation process  we use this path and the corresponding stereo
pair to compute its location in the right eye image  then we compare the computed image to
the ground truth  fig      we calculate the score for every path as a number of points which
overlap the corresponding skeletonized path in the right eye image  considered as the
ground truth   we should mention that two points are considered overlapping if their
centers are within     mm from each other  this number is specific to the dataset and depends
on the pixel thickness   on table   you can see how both algorithms performed on one of our
datasets 
 
 
 
 
 
 
 

maximum difference
           
           
             
           
             
           

cross correlation
           
           
             
           
             
           

table    comparison of md and cc algorithms 

 

conclusion

first of all  we think that it is feasible to find the location of a guidewire in the right eye image
of a stereo roadmap  given its location in the left eye image  secondly  stereoscopic
visualization of the vessel tree and the guidewire looks convincing and  finally  we can
process live fluoroscopic image sequence in real time 

 

acknowledgements

we gratefully acknowledge support from siemens medical solutions 

 

references

   

d  ballard  c  brown  computer vision  prentice hall  inc   englewood cliffs  nj       

fi