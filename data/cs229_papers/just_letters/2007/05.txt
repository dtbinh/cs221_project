wall  floor  ceiling  object region identification from
single image
zhong ju zhang
stanford university
junez stanford edu

abstract
it is often helpful to identify large  relevant regions in an image  this can help to facilitate applications such as
object recognition  object tracking  and  d reconstruction  we explored a simple algorithm of using k means to
cluster images of indoor scenes into   regions roughly corresponding to    ceiling     wall     floor  and   
objects  non ceiling  wall  floor  regions  then we used logistic regression to identify the segmented clusters to
the corresponding regions  k means segmentation performs well for uncluttered scene with large and
uninterrupted wall and floor areas  ceiling and object regions are harder to segment  identification of segmented
region is poor  achieving only     accuracy using logistic regression 

keywords  image segmentation  region identification  k means
 

introduction

   

features

in image processing  it is often useful to be able to
separate and classify large regions in an image 
identifying image regions as ground or sky was useful
for hoiem et al  in learning  d geometric context
from a single image      identifying large regions can
also improve image tracking by allowing the
algorithm to focus more effectively on objects of
interest 

we tried to choose a feature space that is descriptive
of the image by incorporating colour  spatial  and
texture descriptors 

hoiem et al  used supervised learning algorithm with
  d feature vector to segment and identify regions in
outdoor scenes  in this paper  we choose to analyze
indoor scenes in order to identify regions
corresponding to    ceiling     wall     floor  and   
objects  non ceiling  wall  floor regions  by
employing fast k means clustering algorithm for
segmentation and logistics regression for region
identification 

l  level                
e   edge                       

 
   

segmentation
k means algorithm

k means clustering algorithm does not make any
probabilistic assumptions on the data  one
disadvantage of k means is that users have to guess
the total number of clusters  k  in the image before
segmentation  its performance is not as good as more
sophisticated clustering algorithms such as mean shift
     however  for our purpose of identifying large
regions  e g  wall  floor   we argue that a sophisticated
clustering algorithm is unnecessary as individual
objects in the scene all belong to one region object 
we applied k means clustering  k    over feature
space to find the ceiling  wall  floor  and object region
in indoor scenes 

     

texture energy

we used laws texture energy algorithm to compute
the texture energy of each pixel  the  d texture
masks are 

s    spot                    
r  ripple                   
nine  x   d texture masks can then be constructed
by combining the  d masks  l e   l r   e s  
s s   r r   l s   e e   e r   s r      
we convolved the blue intensity channel of the image
with the   different  x  laws texture matrix  the
texture energy of a pixel is the sum of the absolute
value of the convolution result of its   nearest
neighbours 
experimentally  incorporating the l e  and l r 
laws texture energy gave the best segmentation
result as shown in figure    figure    figure   

a 

b 

figure    a  test image    b  k means clustering

fiin figure    to use as region labels for training test
image   

a 

b 

figure    a  test image    b  k means clustering

figure    hand labelled regions for test image  
we

created

 

training
labels 
yceiling   y floor   ywall   yobject   the label is   if the pixel

belongs to that region    if it does not  we use the
following notation for describing a feature point 

x ij         i       mn  j          i corresponds to the
a 

b 

figure    a  test image    b  k means clustering

mn

table    features for each pixel
feature descriptors

num

colours

 

 

  floor    arg max log   p  y ifloor   x i    floor  

 

 

i   

mn

 

the colour  spatial  and texture values are scaled by
weights so that r  g  b  x  y  and the l e  texture
value are approximately on the same scale  the l r 
value is scaled to be     the l e  value 

region labelling

major regions in the image can be found using
segmentation  however  clustering assignment is
meaningless  with every run  different clusters are
found in difference sequences  for instance  the  rd
cluster corresponds to floor pixel  while in another
clustering iteration  the  rd cluster may correspond to
wall pixels  we tried using logistic regression to
identify the segmented clusters as    ceiling     wall 
   floor  and    objects  non ceiling  wall  floor
regions  by solving for parameters that maximize the
likelihood a given set of features belongs to one of the
  major regions  we choose a discriminative learning
algorithm as opposed to a generative algorithm  e g 
gaussian discriminant analysis  because we did not
want to make any probabilistic assumption on the
distribution of the feature descriptors 

   

i   

i
  wall    arg max log   p  y wall
  x i    wall  
i
  object    arg max log   p  y object
  x i    object  

 

l e   l r   scaled 

 

i   

mn

mn

x  y values  scaled 
texture

i
  ceiling    arg max log   p  y ceiling
  x i    ceiling  

 

rgb values  scaled 
spatial

total number of pixels in an image that is mxn  j
corresponds to the   segmented clusters  using
logistic regression  we find   sets of parameters 

training using pre labelled image

to test the performance of logistic regression for
identification  we hand labelled the test image  shown

     

i   

labelling

after obtaining the parameters  for each region  we
then compute 
centroid
p   ywall   xcluster
     wall  
centroid
p   ywall   xcluster
     wall  
centroid
p   ywall   xcluster
     wall  
centroid
p   ywall   xcluster
     wall  

where

centroid
xcluster
    is the centroid point identified by k 

means for cluster    we do this separately for all four
regions  ceiling  wall  floor  and objects  we assigned
the region label to the cluster with the highest
probability  a secondary condition is that the
probability need to be larger than      to avoid false
positives  figure   shows the result of the
identification for test image   

fifigure    region labelling of test image  

   

training using structure labelled
image

instead of using pre labelled image to train the
identifier  we used an artificial region label  shown in
figure    based on the assumption that the ceiling is
above the wall  and the floor is below the wall in the
image 

figure    region labelling of test image    white
region are clusters that is assigned the corresponding
class label 
even for a trivial case  logistic regression result is
quiet poor  despite the fact that the segmentation
results were quiet good for the major regions of the
image  see figure    
using the parameters obtained by using the label
shown in figure    we then tried to cluster the
different but similar looking test image    see figure
  

figure    assumed structure label 
since the assumed region label does not contain any
information regarding object region  we can only find
parameters corresponding to ceiling  floor  and wall
using logistic regression 
for identification  we assign label ceiling  floor  and
wall to clusters that have the maximum probabilities
of being these regions  for identifying the object
cluster  we choose the cluster that has the minimum
probability of being ceiling  floor  and wall region 
figure     shows the result of identification using the
assumed structure region label 

fi 

future work

it is apparent that conventional logistic regression is
not a good identifier  it would be useful to try
generative learning algorithms  e g  nave bayes  for
identification  a more descriptive feature vector can
also help 
figure    region labelling of test image   using
structure labelled image

 

references

    d  hoiem  a  efros  m  herbert  geometric
context from a single image 
www cs cmu edu  dhoiem publications hoiem 
geometric pdf
    http   www caip rutgers edu riul research code ht
ml
    http   www cse msu edu  stockman cv f  lect
ures weeks    week   texture ls ppt

figure    region labelling of test image   using
structure labelled image

 

result

k means segmentation performs well for a wellbehaved image with large wall and floor area  for all
the test images we tried  the ceiling was clustered
together with the wall because it has the same texture
and colour as the wall  without geometric cues  it is
unlikely that any clustering algorithm will be able to
separately cluster ceiling from wall region  the object
regions are clustered with varying success 
depending on the amount of objects in a space  they
could be clustered as one or more clusters 
the region labelling results are quiet poor even for
images with good segmentation results  ceiling and
floor region are usually never identified because many
probability values end up being zero  clusters are
usually identified correctly as wall regions with high
probability  object region identification success can
vary  the accuracy of object region identification is
dependent on how well k means segmentation
separated objects from floor  wall clusters  in most
cases  object regions can also partially contain wall
and or floor regions as well 

fi