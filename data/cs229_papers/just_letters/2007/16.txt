a travel time prediciton with machine learning
algorithms
younggeun cho and jungsuk kwac
department of electrical engineering
stanford university
stanford  ca         usa
e mail  ygcho stanford edu kwjusu  stanford edu 
i  i ntroduction
it is friday afternoon  you have a blind date at san
francisco at     pm  since you dont want to give a bad first
impression  you plan to leave early enough not to be late for
the appointment  however  the traffic on    north on every
friday is real heavy and unpredictable  although it takes only
   minutes to get there on other weekdays  it might take from
    hours to   hours  so  when should you leave for sf to
minimize the wasted time and meet the appointment schedule 
this question above is commonly encountered by travelers 
so they want an accurate travel time prediction  adding to
this case  accurate travel time prediction is also essential
for traffic information and transportation systems such as
vehicular navigation systems in cars or traffic boards on the
roads to provide efficient route information  furthermore  with
this information  we can prevent unnecessary traffic jams with
such a scheme as load balancing  in this project  we try to
predict a travel time from one place to another in a freeway
using machine learning algorithms 
there are several research papers dealing with this topic 
especially  j  m  kwon et al     and x  zhang et al     form
a good starting point  these previous works provide several
travel time prediction algorithms using linear regression  for
these algorithms  inputs for linear regression are historical data
of traveling times and current states of highways  however 
the authors for these papers did not consider other important
factors such as what day of the week and which season
of the year  by considering additional important factors  we
expect to improve the accuracy of prediction  the purposes of
this project are twofold  first  we evaluate existing algorithms
presented in relevant research papers  second  we develop new
algorithms to enhance the accuracy of prediction 
for evaluation and development of travel time prediction
algorithms  we need several types of data including an average
speed of each freeway for different times  days  and months 
these data are available to public at freeway performance
measurement system website      this website provides historical and real time freeway data from freeways in the state
of california collected by sensors installed on major highways 

freeway with length s         sl   in each segment  there is a
sensor for measuring the average speed of bypassing vehicles 
v l  i    where i is the time for measurement  it is assumed
that for the prediction at time t  the speed data  v l  i    are
available for i   t    where  is a fixed positive time lag 
the objective of this project is to predict the travel time of this
route with this information  more formally  we should find a
function g such that
t  t    g v  t     

where t  t  is a time predict for travel that starts at time t
and v  t       v i  i    l           l  i  t    denotes the
collection of data available for predicting t  t   the real travel
time  the performance metric for prediction is the percentage
prediction error defined as
 t   

 t  t    t   t  
 
t  t 

   

iii  p rediction m ethods
travel time algorithms differ in choosing the predictor
function g v  t     in      in this project  several prediction
methods are evaluated including the time varying coefficient
linear model of     
a  historical means hm 
historical mean  hm  uses the mean of the training set at
time t as the predictor for travel time  formally 
thm  t   

  x
td  t  
 d 
dd

b  current time predictor ct 
for current time predictor ct  method  the travel predictor
is obtained by assuming the speeds of all segments at time t
remain the same as the speeds at t   throughout the entire
travel  formally 

ii  p roblem s tatements
as in     the travel time prediction problem is defined as
follows  the route for traveling comprises l segments of

   

tct  t   

l
x
l  

sl
 
v l  t   

   

fi 

c  time varying linear regression tvlr 

iv  data acquisition and p reprocessing

in this method  the travel time predictor is expressed as
tt v lr    t       t   tct  t  

a  data acquisition
   

where alpha t    and beta t    are time varying constant 
and tct  t  is the current travel time predictor of the previous
segment 
d  time varying linear regression per segment tvps 
in tvlr  the predictor is obtained by considering the
current time predictor of the entire route as the key feature  for
time varying linear regression per segment tvps   the current
time predictor of each segment plays a role as a feature  so 
linear regression coefficients  alpha and beta  are calculated
for each segment separately so that travel time prediction is
conducted on each segment  then  predictors for all segments
are summed up to form the whole predictor as
tt v p s  t   

l
x

tt v lr  t  l 

l  

l
x

 t  l     t  l tct  t  l  

l  

e  algorithm considering days in a week
in the previous papers     and      the authors obtained
 t    and  t     and predicted t  t  assuming the traveling
time characteristics of fridays are the same as those of mondays  for example  however  as shown in fig     the statistical
characteristics for each day in a week differ significantly 
  sun   mon   tue   wed   thu   fri   sat
  

  sun   mon   tue   wed   thu   fri   sat
  

before training our model  preprocessing the travel time
from the data is necessary  to calculate the whole travel time
taken from university ave to san francisco  the travel time
is summed over all small segments between vdss  however 
two problems should be addressed before getting the travel
time  first  the entire route should be re segmented to reflect
the real speed of the vehicles  second  the fact that the time
is also discretized should be considered 
for the first problem  re segmentation  consider the segmented route in fig     x         xl are the locations of sensors e g  vds in pems  that measure the vehicle speed  the
issue here is to decide how v l  t   the speed measured at
xl   can be used  it is reasonable to assume that the speed
measure at xl represents the average speed of segment from
 xl    xl     to  xl   xl       as shown in fig     so 
the segment lengths sl   l           l associated with speeds
v t  l   l           l  should be calculated as
s     x    x       x   
xl   xl  
xl    xl
sl  

  for l           l    
 
 
sl   xl   xl    xl    
 

 

variace of travel time min 

  

mean travel time min 

b  preprocessing

 

  

  
  
  
  
  

 
 
 

then  by assuming that v t  l  remains the same when the
vehicle is in the segment l  we can calculate the travel time
for this segment 

 
 
 

 
 

we get the data from the freeway performance measurement system website     for this milestone report  trip starts at
university ave to san francisco on highway    n  there are
   vdss vehicle detection system  in the route  the speed
data measured by vdss for every   minutes  that website
supports exporting data as excel or text file  and we used unix
command in matlab and wget command in unix to get data 

 
 

 

 

 
 
date

 

 

 

 

 

 

 
 
date

 

 

fig     means and variances of travel time for a trip from university avenue
to san francisco with highway    n 

x 

  x   x       

v    t  

x 

  x   x       

v    t  

s  d  t     d  t    
xd
 
t  t  sn     t      t     
 
sn s

where d   su n  m on  t u e  w ed  t hu  f ri  sat  
and sd    si  s  sn collected on d day in a week   once
obtained  d  t    and d t   is used to predict the travel
times only for d days 

  x   x       

v    t  

fig    

the new algorithm exploits this difference in such a way
that the coefficient for each day is obtained by training on a
subset of s that contains only the same days in a week  more
formally  d  t    and d t   minimize

x 

  xl     xl        

xl  

  xl    xl      

v  l     t  

xl

v   l  t  

re segmentation of the route

once  re segmentation is done  there remains the problem of
discretized time  this problem stems from the fact that sensors
measure the speeds with some time interval  t  t     minutes
for pems  so  if a car enters segment l at time t and stays at
the same segment more than t  it speeds should be changed
to be v t   t  l   figure   illustrates this issue  the horizontal
axis and the vertical axis are discretized so that the space time
is divided into small grids  the blue line represents the path
of a vehicle  in each grid  the speed remains constant so the
slope of the line is constant  the travel time can be computed
the time when the path reaches the end of the last segment 

fi 

  

t    t

v l     t   t  

t   t

v l     t  

v l   t  
t
segment

fig    

l

segment

l  

average relative prediction error    

sample path

v l   t   t  

calculation of travel time for discretized time

as the authors in     argue  the travel times computed with
this preprocessing is not significantly differ from the real travel
times  so  we use the outputs of this preprocessing for training
and testing of the prediction methods 

hm
tvlr
ct
tvps

  
  
  
  
  
  
 
 

fig    

sun

mon

tue
wed
thu
days in a week

fri

sat

results without considering days in a week effect       min 

v  n umerical r esults

a  test environments
as mentioned in the previous section  for numerical results
the trip starts at university ave and ends at san francisco on
highway    n  the training set consists of the trips of    
days from april  st to october   th  for each day  there are  
trips  the starting time of which is in every   minutes between
     pm to      pm  we set the training and test time like
this because this time slot shows the most dynamic traffics due
to commuter traffic  for this trip there are    vdss  which
means l       the data in pems shows the speeds for each
lane in the highways  we assume that the speeds for the second
lane represent the average speeds of vehicles  the test set of
the prediction methods consists of    days 
b  test result
figure   shows the relative error averaged over test set with
      minutes for different days in a week  as seen in
the figure  we have two different results for weekdays and
weekend  for weekdays  tvps outperforms other methods 
and ct follows  the performances of hm can be considered as
lower bounds due to its simplicity  for weekend  ct performs
better than tvps  which is the reverse of the results for
weekdays  recall that ct perform well when the traffic patter
varies slowly  hence  for weekends  when no commuter traffic
exists  ct outperforms other methods 
although tvps performs well in weekdays  its performance
is problematic for weekend  for tvlr  the performance
is worse with relative errors more than      this issue
can be addressed by using methods considering days in aweek effect  in fig    the performances of tvps and tvlr
considering days in a week effect  denoted by tvps d  and
tvlr d   are added to fig     as shown in the figure after considering days in a week effect  both tvps d  and tvlr d 

outperform ct  here  the relative error of ct remains the
same since days in a week effect is inherently reflected in ct 
as the figure shows  the average relative error is below    
for tvps d  and tvlr d   it should be noted that tvps
involves more computational complexity than tvlr by factor
of l  therefore  it is desirable to use tvlr d  since with less
computational complexity it shows comparable performance
to that of tvps d  which has the best prediction power 

  
ct
tvlr
tvlr d 
tvps
tvps d 

  

average relative prediction error    

in this section  we compare the four prediction methods in
iii  and apply the method considering days in a week effect 

  
  
  
  
  
 
 

fig    

sun

mon

tue
wed
thu
days in a week

fri

sat

results with considering days in a week effect       min 

figure   shows the effect of different values of  to the
average relative errors of three scheme  two things can be
observed from the plot  fist  the average relative errors of ct 
tvlr d   and tvps d  increase as  increases  second  the
performances of three methods get closer to all another as 
increases 

fi 

  

average relative erorr    

  

 

 

 
ct
tvlr d 
tvps d 

 

 
  

  

  

fig    

  


  

  

  

relative error vs  delta 

vi  c onclusion
in this project  the problem of predicting travel time is
addressed  as predictors  four methods are presented and
one suggestion  days in a week effect  for improving the
performance is made  as shown in the evaluation results with
the route from univ  avenue to san francisco on highway    
north  considering days in a week reduces prediction error
significantly  furthermore  tvlr d  is suggested as a useful
method with its good performance and simplicity 
to further improve the accuracy of prediction  it can be
considered using other models such as the linear model using
link flow and occupancy  we can also try to consider other
factors that affect travel time such as the traffic information
for the crossing highways 
r eferences
    freeway
performance
measurement
system
 pems  
http   pems eecs berkeley edu 
    x  zhang and j  rice  short term travel time prediction  transportation research part c  vol            pp          
    j  m  kwon and k  petty  a travel time prediction algorithm scalable
to freeway networks with many nodes with arbitrary travel routes 
trasportation research record       
    j  m  kwon and p  varaiya  components of congestion  delay from
incidents  special events  lane closures  weather  potential ramp
metering gain  and excess demand  transportation research record 
     

fi