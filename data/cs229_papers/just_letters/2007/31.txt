face detection using independent component analysis
aditya rajgarhia
cs     final project report
december         

 

introduction

 

robust real time face detection

from a very large set of potential features  the third contribution is a method for combining classifiers in a cascade
a commonly used approach for detecting faces is based on which allows background regions of the image to be quickly
the techniques of boosting and cascading  which allow discarded while spending more computation on promising
for real time face detection  however  systems based on face like regions 
boosted cascades have been shown to suffer from low detection rates in the later stages of the cascade  yet  such
    features
face detectors are preferable to other methods due to their
extreme computational efficiency 
the detection procedure classifies images based on the value
a given natural image typically contains many more back  of simple features  as opposed to using the image pixels diground patterns than face patterns  in fact  the number of rectly  the most common reason for doing so is that features
background patterns may be       to         times larger can act to encode ad hoc domain knowledge that is difficult
than the number of face patterns  this means that if one de  to learn using a finite quantity of training data  for this
sires a high face detection rate  combined with a low number system  there is also a second critical motivation for feaof false detections in an image  one needs a very specific clas  tures  the feature based system operates much faster than
sifier  publications in the field often use the rough guideline a pixel based system  the task is to find suitable features
that a classifier should yield a     detection rate  combined for detecting objects in images 
with a false positive rate in the order of      
viola and jones use three kinds of features  the value of a
in this project we introduce a novel variation of the boost  two rectangle feature is the difference between the sum of the
ing process that uses features extracted by independent pixels within the two rectangular regions  a three rectangle
component analysis  ica   which is a statistical technique feature computes the sum within two outside rectangles subthat reveals the hidden factors that underlie sets of ran  tracted from the sum in a center rectangle  finally  a fourdom variables or signals  the information describing a face rectangle feature computes the difference between diagonal
may be contained in both linear as well as high order de  pairs of rectangles 
pendencies among the image pixels  these high order dependencies can be captured effectively by representation in     integral image
ica space  barlow         moreover  it has been argued
in  bartlett and movellan        that the metric induced by rectangle features can be computed very rapidly using an
ica is superior to other methods in the sense that it may intermediate representation for the image that is called the
provide a representation that is more robust to the effect of integral image  the integral image at location x  y contains
noise such as variations in lightening  we propose that fea  the sum of the pixels above and to the left of x  y inclusive 
tures extracted from such a representation may be boosted
x
ii x  y   
i x    y     
better in the later stages of the cascade  thus leading to imx  x y   y
proved detection rates while maintaining comparable speed 
where ii x  y  is the integral image and i x  y  is the original
image  using the following pair of recurrences 
s x  y    s x  y       i x  y 

 viola and jones        described a face detection framework that is capable of processing images extremely rapidly
while achieving high detection rates  there are three key
contributions of this detection framework  the first is the
introduction of a new image representation called the integral image which allows the features used by the detector
to be computed very quickly  the second is a simple and
efficient classifier which is built using the adaboost learning
algorithm to select a small number of critical visual features

ii x  y    ii x     y    s x  y 
 where s x  y  is the cumulative row sum  s x          and
ii    y       the integral image can be computed in one
pass over the original image  using the integral image  any
rectangular sum can be calculated in four array references 
clearly the difference between two rectangular sums can be
calculated in eight references  since the two rectangle features defined above involve adjacent rectangular sums they
 

fithat within any single image  an overwhelming majority of
sub windows are negative 

can be computed in six array references  and eight and nine
references in the cases of three and four rectangle features
respectively 

   

learning classification functions

there are         rectangle features associated with each
image sub window of    x    pixels  a number far larger
than the number of pixels  even though each feature can
be computed efficiently  computing the complete set is prohibitively expensive  the hypothesis is that a very small
number of these features can be combined to form an effective classifier  the main challenge  then  is to find these features  in this system  a variant of adaboost is used to select
the features and to train the classifier  the formal guarantees provided by the adaboost learning procedure are quite
strong  it has been proved in  freund and schapire       
that the training error of the strong classifier approaches
zero exponentially in the number of rounds  more importantly  a number of results were later proved about generalization performance 
drawing an analogy between weak classifiers and features 
adaboost is an effective procedure for searching out a small
number of good features which nevertheless have significant variety  in support of this goal  the weak learning algorithm is designed to select the single rectangle feature which
best separates the positive and negative examples  for each
feature  the weak learner describes the optimal threshold
classification function  such that the minimum number of examples are misclassified  a weak classifier h x  f  p    thus
consists of a feature  f    a    x    pixel sub window of the
image  x   a threshold    and a polarity  p  indicating the
direction of the inequality 

figure    schematic depiction of the attention cascade 

 

boosting in ica feature space

in sec       we described the boosting process in haar like
feature space  the classification power of the described system is limited when the weak classifiers derived from simple
local features become too weak to be boosted  especially
in the later stages of the cascade training  empirically 
it has been observed in  zhang  li and gatica perez       
that when the discriminating power of a strong classifier
reaches a certain point  e g  a detection rate of     and
a false alarm rate of       non face examples become very
similar to the face examples in terms of the haar like features  the histograms of the face and non face examples for
any feature can barely be differentiated  and the empirical
probability of misclassification for the weak classifiers approaches      at this stage  boosting becomes ineffective
because the weak learners are too weak to be boosted  this
issue has been discussed in the past in  valiant         one
way to address this problem is to use better weaker clas 
sifiers in a different feature space  which is more powerful 
  if pf  x    p
we propose to boost in ica coefficient space  as we show 
h x  f  p     
  otherwise
weak classifiers in this global feature space have sufficient
classification power for boosting to be effective in the later
the weak classifiers used  thresholded single features  can stages of the cascade 
thus be viewed as single node decision trees  and the final
first  we shall explicate the two architectures for performstrong classifier takes the form of a perceptron  a weighted ing ica for representing faces 
combination of weak classifiers followed by a threshold  

   
   

the attentional cascade

a cascade of classifiers is used  which achieves increased
detection performance while radically reducing computation
time  simpler classifiers are used to reject the majority of
sub windows before more complex classifiers are called upon
to achieve low false positive rates 
stages in the cascade are constructed by training classifiers using adaboost  the overall form of the detection
process is that of a degenerate decision tree  or cascade  a
positive result from the first classifier triggers the evaluation
of a second classifier which has also been adjusted to achieve
very high detection rates  a positive result from the second
classifier triggers a third classifier  and so on  a negative
outcome at any point leads to immediate rejection of the
sub window  the structure of the cascade reflects the fact

architecture    statistically independent basis images

the goal here is to find a set of statistically independent
basis images  we organize the face mixtures in matrix x so
that the images are in rows and the pixels are in columns 
in this approach  ica finds a matrix w such that the rows
of u   wx are as statistically independent as possible  the
source images estimated by the rows of u are then used as
basis images to represent faces  face image representation
consists of the coordinates of these images with respect to
the image basis defined by the rows of u  as shown in fig 
   these coordinates are contained in the mixing matrix
a  w   
the number of ics found by the fastica algorithm  describe in  hyvarinen         corresponds to the dimensionality of the input  in order to have control over the number
 

fifigure    the factorial code representation consisted of the
independent coefficients  u  for the linear combination of
basis images in a that comprised each face image x 
codes for encoding complex objects that are characterized
by high order combinations of features 
we organize the data matrix x such that rows represent
different pixels and columns represent different images  this
corresponds to treating the columns of a  w  as a set of
basis images  see fig      the ica representations are then
in the columns of u   wx  each column of u contains the
coefficients of the basis images in a for reconstructing each
image in x  see fig      ica attempts to make the outputs 
u  as independent as possible 

figure    image synthesis model for architecture i 

figure    the independent basis image representation consists of the coefficients  b  for the linear combination of independent basis images  u  that comprised each face image
x 

 

in adaboost learning  each weak classifier is constructed
based on the histogram of a single feature derived from ica
coefficients  b    b         bm    at each round of boosting  one
ica coefficient  the one which is most effective for discriminating between face and non face classes  is selected by adaboost 
as stated earlier  the distributions of the two classes in
the haar like feature space almost completely overlap in the
later stages of the cascade training  in that case  we propose to switch feature spaces and construct weak features in
the ica space  we do need to address the question of which
stage in the cascade we should switch from the haar like features to the ica features  it is quite evident that ica features are much more computationally expensive than haarlike features  now  if we used ica features in early stages
of boosting  we would have to extract ica features from
a very large number of sub windows  and the speed of the
face detection system would be too slow for real time performance  on the other hand  if we used ica features in
very late stages of boosting  the performance improvement
gained from their superiority would be limited  therefore 
we shall determine the switching stage based on the trade
off between speed and performance improvement 

of ics extracted  instead of performing ica directly on the
nr original images  we perform ica on first m pc eigenvectors of the images set  where m   nr   recall that the ica
model assumes that the images in x are a linear combination of a set of unknown statistically independent sources 
thus  the ica model is unaffected by replacing the original
images with a linear combination of those images 

   

boosting ica features

architecture ii  a factorial face code

the goal in architecture   was to find a set of spatially independent basis images  now  although the basis images obtained in that architecture are approximately independent 
the coefficients that code each feature are not necessarily independent  architecture ii uses ica to find a representation
in which the coefficients used to code images are statistically independent  i e   a factorial face code   barlow       
and  atick        have discussed the advantages of factorial

 

experimental results

first  we provide the implementation details for our system 
the discussion includes details on the structure and training
of the detector  as well as results on large real world testing
sets  we also consider the importance the size and quality of
the training data set towards creating an accurate classifier 
and present results for two training sets of different sizes 
due to time limitations  we were unable to train a cascade of

figure    image synthesis model for architecture ii 
 

fifigure    example face images from the testing set 
figure    example face images from the training set 
classifiers  however  we did implement separate adaboost
classifiers based on haar and ica features 

   

training datasets

figure    example non face images from the testing set 

the training data set we used is the the publicly available
mit cbcl face database  this data set is not ideal for the
purpose of training a classifier due a low resolution of   
x    pixels  in fact   viola and jones        report that an
increased resolution of    x    pixels results in much higher
accuracy of the face detector  however  the data set will
serve our purpose of comparing our detection system with
their original system  which we shall train using the same
training set 
the original mit cbcl training set contains       face
images and       non face images in    x    grayscale pgm
format images  the training faces are only roughly aligned 
i e   they were cropped manually around each face just above
the eyebrows and about half way between the mouth and
the chin 
we also created an extended version of the mit cbcl
data set by randomly mirroring  rotating  translating and
scaling the original images by small amounts to obtain a
set of        faces and         non face images  although
the additional images are just variants of the original ones 
the performance of the classifier is affected significantly  as
shown subsequently 
all face and non face images in the training set were histogram equalized to increase the local contrasts of the images  this allows for areas of lower local contrast to gain a
higher contrast without affecting the global contrast 

extended training set of        faces and         non faces
was similarly projected onto the ica basis extracted from
the       face images to produce another strong classifier 
while experimenting with different numbers of faces from
which we extract the ica features  we found that larger
numbers of faces result in better performance of the detector  however  extracting the independent components is
a very memory intensive task  and our memory limitations
did not allow us to use more than       images  in the future  we would like to use the        face images from the
extended training set to extract the ica features as opposed
to just projecting them onto the basis extracted using less
features 
during testing  a given image is similarly projected on the
above mentioned ica features to obtain the ica coefficients
for that image  the adaboost classifier then uses these
coefficients to predict the class of the test image 
for training the h boost system  we first created the integral image representation for the training set  and then
performed adaboost on the haar like features that are obtained using this integral image  we were unable to train
the haar classifier on the extended data set due to memory
limitations 

   

   

ica and haar features

experiments on real world test sets

a number of experiments were performed to evaluate the
system  we tested our system on the mit cbcl face test
set  which consists of     faces and        non faces  the
testing images are of the same size as the training images 
and are also cropped similarly  considerable pose and lightning variations are represented by the test set  as can be
seen in fig     the test face images are clearly more challenging to identify as compared to the training ones seen in
fig     even for a human 
fig    shows the performance of our detection system
 i boost  as well as that of a detector based on haar like
features  h boost   note that the h boost detector used
is not the same as the viola jones detector  since it is not
cascaded  clearly  the i boost detector performs better than
h boost for all false positive rates  moreover  using the
extended training set significantly improves the accuracy 

two face detection systems were trained  one using haar
features  we call this h boost  and the other using architecture i ica features  we call this i boost   we trained
both types of classifiers with several different numbers of
features ranging from    features to     features  in the
following sections  we shall present the results for h boost
and i boost classifiers trained using     haar like and ica
features respectively  since this choice resulted in the highest
detection rates 
for training the i boost system  we first extracted the
ica features from the       face images in the mit cbcl
training set  next  all the       face images and the      
non face images from the training set were projected onto
the set of ica features to obtain the ica coefficients of these
images  adaboost was performed on the coefficients of these
      training images to produce the strong classifier  the
 

fifigure    detection rates for various numbers of false positives on the mit cbcl test set containing     faces and       
non faces 

 

conclusions

implementing the cascade is required in order to achieve
the ultimate aim of our work  i e   to improve the accuracy
in this project we introduced a novel algorithm for detecting of the viola jones detector while maintaining real time defaces  based on features derived from independent compo  tection speed  we would also like to compare our system
nent analysis  motivated by the fact that the weak learners with other state of the art detection systems such as those
based on the simple haar like features are too weak in the based on neural networks and support vector machines 
later stages of the cascade  we propose to boost ica feait was mentioned in sec      that we have used the artures in the later stages  the global ica feature space com  chitecture i ica features in the i boost classifier  another
plements the local haar like feature space  the algorithm task in the future would be to implement architecture ii
selects the most effective features from ica features using features as described in sec      and to compare the results 
adaboost 
various experiments were performed to show the advantage of using ica features for face detection  the results references
can be stated as follows 
p  viola and m  jones  robust real time object detection 
in international journal of computer vision  pages     ica features are better at discriminating between face
and non face images as compared to haar like features            
h b  barlow  unsupervised learning  in neural computation  page               

 increasing the size of the training set as well as the
size of images for ica feature extraction significantly
improves the detection rate for a given false positive
rate 

m s  bartlett  j r  movellan  t j  sejnowski  face recognition by independent component analysis  in ieee
trans  on neural networks  pages            november
     

although we have not yet implemented the cascaded detector  the results from the adaboost classifier show that
our system achieves high accuracy on the mit cbcl test
set  most importantly  though  we have showed that ica
features are  in fact  better than haar like features at discriminating between faces and non faces  hence  we are
optimistic that a cascaded detections system which combines haar like and ica features would demonstrate higher
accuracy than a detector based only on haar like features 
the computational efficiency of fastica  coupled with the
fact that the majority of images are rejected in the early
stages of the cascade  should ensure that performance is not
affected ostensibly 

 

y  freund and r  e  schapire  experiments with a new
boosting algorithm  in machine learning  proceedings of
the thirteenth international conference  pages         
     
a  hyvarinen  fast and robust fixed point algorithms for
independent component analysis  in ieee transactions
on neural networks  pages               
d  zhang  s  z  li  and d  gatica perez  real time face
detection using boosting learning in hierarchical feature
spaces  in proceedings of international conference on pattern recognition  cambridge  august      

future work

l  valiant  a theory of the learnable  in communications
of acm       

a larger training set would be essential for the detector to
be of practical use  in particular  the number of non face
images would have to be drastically increased in order to
decrease false positives  moreover  as mentioned earlier  using a larger number of face images to extract ica features
would also improve the accuracy 

j j  atick  could information theory provide an ecological
theory of sensory processing  in network  page         
     

 

fi