volatility forecasting using svm
project for cs    machine learning

jeremy andre

alfred wechselberger

shanbin zhao

finmath

ee

mse

introduction
financial time series forecasting is one of the most challenging applications of modern time series analysis  financial
time series are inherently noisy  nonstationary and deterministically chaotic  these characteristics suggest that there
is no complete information that could be obtained from the past behavior of financial markets to fully capture the
dependency between the future price and that of the past 
there are two main categories in financial time series forecasting  univariate analysis and multivariate analysis 
in multivariate analysis  any indicator  whether it is related to the output directly or not  can be incorporated as
the input variable  while in univariate analysis  the input variables are restricted to the time series being forecasted 
a general univariate model that is commonly used is based on the autoregressive integrated moving average
 arima  method  compared to other multivariate models  the performance of arima is not satisfactory because
this model is parametric  and additionally  it is developed on the assumption that the time series being forecasted
are linear and stationary  these constraints are not consistent with the characteristics of financial time series 
therefore  artificial neural network  ann  assisted multivariate analysis has become a dominant and popular
tool in recent years  the prediction performance is greatly improved by the use of a neural network  a neural
network is more effective in describing the dynamics of non stationary time series due to its unique non parametric 
nonassumable  noise tolerant and adaptive properties 
however  a critical issue concerning neural networks is the over fitting problem  it can be attributed to the fact
that a neural network captures not only useful information contained in the given data  but also unwanted noise 
this usually leads to a large generalization error  unlike most of the traditional learning machines that adopt the
empirical risk minimization principle  svms implement the structural risk minimization principle  which seeks
to minimize an upper bound of the generalization error rather than minimize the training error  this will result in
better generalization than conventional techniques 
different market volatilities
here is a brief description of the differents types of volatilities 
realized volatility this is a statistical measure of the noise in the markets on n days  if we denote the price
times series of a stock as s    s    s            sn   realized volatility is given by 
v


up
si
u n
t i   ln si   
    
r  
n
implied volatility this is the key parameter used to price vanilla options  call and put  using the blackscholes formula  it reflects the market expectations about the realized volatility  at the end of the life of
the option  since both sides are usually neutral w r t  the stock price  delta hedged    the comparison of the
realized vol vs the initial implied vol will determine if the option was exchanged at a too expensive or too
cheap price 
our idea is to forecast implied volatility  since it is a human factor and therefore more likely to show patterns
that a svm based algorithm would capture 
classification approach
to simplify our first approach and still keep it useful for a trader  we turn the forecasting into a simpler classification
problem         output   based on the last daily observations of implied volatility t   and the time left to expiry 
we build a simple binary output 
 

fiyt  



   if t     t
  if t     t

after downloading data from option metrics  and implementing an smo algorithm from     we run the following
algorithm 
   to find the best parameters  and c  we use optimization function fminbnd and fminsearch  to optimize
short cycle smo optimization  we also implemented an optimization step for the kernel parameter  but did
not have enough time to use it 
   then we run a new smo with more iterations to get the coefficients   the intercept b and the prediction f  
   finally  we compute the error rate as 
error  

  of differences between f and y
  of observations

the results were quite poor  and this method couldnt really anticipate changes in volatility  our error rates
were around      so we decided to use svm regression  with the modified smo for regression from     
svm regression
suppose we are given a training set   x    y              xm   ym     rd  r  where xi s are the regressors and yi s are the
observations  in   insensitive measure  our goal is find a function f  x  that has at most  deviation from the
actually obtained target yi s for all the training data  and at the same time  is as flat as possible  in other words  we
do not care about errors as long as they are less than   but will penalize it otherwise  consider the linear function
f  x     w  x    b

   

with w  rd   b  r  flatness in the case of     means that one seeks small kwk     formally we can write this
problem as a convex optimization problem by requiring 
 
min kwk 
 
s t 



yi    w  xi   b
  w  xi    b  yi




   

the tacit assumption in     was that such a function f actually exists that approximates all pairs  xi   yi   with
 precision  or in other words  that the convex optimization problem is feasible  sometimes  however  this may
not be the case  or we also may want to allow for some errors in order to gain flatness  analogously to the soft
margin loss function  one can introduce slack variables i   i to cope with otherwise infeasible constraints of the
optimization problem  hence we arrive at the formulation
m

x
 
min kwk    c
 i   i  
 
i  

 yi    w  xi   b
  w  xi    b  yi
s t 

i   i

    i
    i
 

   

the constant c     determines the tradeoff between the flatness of f and the amount up to which deviations larger
than  are tolerated  the formulation above corresponds to dealing with a so called  insensitive loss function   
described by

 
if     
   
     otherwise

 

fivolatility forecasting using implied volatilities
the problem where we apply the svm regression algorithm is autoregressive time series  therefore the formula looks
like
l
x
j ij   i
   
i  
j  

where the i s are the implied volatility data and i s are the noises  we use apple inc  option data  and set l     
the daily implied volatility is downloaded from bloomberg  and the training set is     points  in the simulation 
we add in the time to maturity parameter as an additional feature  therefore the formula changes slightly
i  

l
x

j ij      t  ti     i

   

j  

the following figure shows the results obtained with a training sets of     dates and a test of    remaining
dates  prediction f is unfortunately often late compared to the actual value y   but it can sometimes anticipate an
upside or downside move 
correlation between f and y looks good for small values  but spreads out with larger volatilities 

ytrain ftrain
   

   
ytrain
ftrain

   

   

   

 

 
   
   
   
   
   
   
   

   
   

 

  

   

   

   

   
   

   

   

   

 

   

   

   

   

   

   

   

ytest  ftest
   

   

    

ytest
ftest

   

    
   

    
   

    

    
   

   
    

    

   
   
    
   
   

   

   

   

   

   

    
   

   

 

fivolatility forecasting using online learning
an online version of the svm regression model has been put forth by several researchers             the online
version differs from the standard  batch  version in that adding one more point to the training set does not require
retraining the entire model  due to the non stationary nature of financial time series  the most recent training data
gives the most information about future values         the online version of the svm reduces the computational
burden of updating the regression model as each new data point is revealed 
volatility clustering is a well known phenomenan in financial time series and it is the basis of our regression
approach  the time scales over which this autocorrelation exists  however  tend to be smaller than one day       
figure below shows the spectrum of the dm     minute volatilities      most of the information about the time
signal exists at frequencies within a day  this shows that prediction for times within the same day might be more
accurate than predication for times in another day  an online implementation of svm regression is required to
lessen the burden of updating the model for each new point 

figure    spectrum for the five minute absolute returns on an open position of the deutschemark u s  dollar spot
exchange rate market from october         through september         

online learning algorithm
briefly  the online learning algorithm for svm regression works by incrementing the weight of the new point
iteratively until the kkt conditions are satisfied for the new point  while ensuring that the kkt conditions remain
satisfied for all other points in the training set  the training data can be partitioned into three  non overlapping
sets  the support set  the error set  and the remaining set  s set  e set  and r set  respectively   eq        and  
show the definitions of the s  e  and r sets  where i is the weighting of the ith point in the training set       on
each iteration  the online learning algorithm keeps track of the movements of the training samples between these
sets 
e     i   abs i     c  

   

s     i       abs i     c  

   

r     i   i      

   

we were able to obatin a matlab v   implementation of an online svm regression model from f  parrellas
personal website  the table below shows the results of an svm regression model for two different values of   as
can be seen  there are very few e set samples  which leads us to believe that changing c will have little effect on the
generalization accuracy of the model  the table below also shows that changing  has little effect on the rms error
of the model  note the difference in online training time  i e  the training of the points was done consecutively 
however each point was individually learned  
num points
   
   


    
    

c
  
  

num e set
 
 

num s set
  
   

 

error  rms 
     
     

time
   min
  hr

fiimprovements on svm regression for financial time series
there have been several articles on svm regression using point specific c and or  parameters      in the traditional
svm regression problem we assign a constant model complexity term    and constant trade off between minimizing
model complexity and generalization error  c   by having point specific c and  values  the contribution of a point
to the generalization error and model complexity can be changed on a point by point basis  i e  more distant points
might have a lower c   the online learning alogrithm can easily be extended to implement this feature in an efficient
way 
conclusion
the recent rise of quantitative funds using automatic trading algorithms has developed an intensive research of
typical patterns in the market  that would reduce risk and increase profits  some of them are based on cutting edge
machine learning techniques 
even if we did not reach a satisfying level of confidence in our predictions  wether binary or exact  we have
reviewed many different aspects of machine learning that will certainly help us in our future jobs 
reference
    lijuan cao and francis e h  tay  neural comput   applic             c   
   alex j  smola and bernhard scholkopf  neurocolt technical report series  nc  tr         
    learning with kernels  bernhard schlkopf and alex smola  mit press  cambridge  ma       
    mario matrin  on line support vector machines for function approximation  technical report  software
department  university politecnica de catalunya       
    francisco parrella  online support vector regression  thesis  university of genoa  italy       
    torden anderson and tim bollerslev  intraday periodicity and volatility persistence in financial markets 
journal of empirical finance                 
    torden anderson and tim bollerslev  heterogeneous information arrivals and return volatility dynamics 
uncovering the long run in high frequency returns  the journal of finance  vol  lii  no           
    lijuan cao and francis e h  tay  support vector machine with adaptive parameters in financial time
series forecasting  ieee transactions on neural network  vol      no           
    online support vector regression  personal website  created by francisco parella  viewed on december
          http   onlinesvr altervista org  
     junshui ma  james theiler  and simon perkins  accurate on line support vector regression

 

fi