morphologicalgalaxyclassificationusingmachinelearning
siddharthakasivajhula narenraghavan andhemalshah

abstract
we compare the classification performance of three machine learning algorithms  support
vector machines  svm   random forests  rf        and nave bayes  nb  as applied to
morphological galaxy classification  using both a set of morphic features derived from image
analysis and the direct image pixel data compressed through pca  principal component
analysis  into pca features  we compare the performance of the different ml algorithms on
eachfeaturerepresentationofagalaxy ourexperimentsshowthatrfperformedbetterthan
svmandnb also morphicfeaturesweremoreeffectivethanourpcafeatures 

 
error butwillalsoallowastronomerstopursue
introduction
morestimulatingtasks 
other attempts have been made to apply
galaxies are gravitationally bound celestial
neuralnetworks    locallyweightedregression
entities composed of gas  dust  and billions of
using principal component analysis      and
stars  and also dark matter as we now know 
navebayes   classificationtechniquestothis
though this is irrelevant to our investigation  
problem with varying success  calleja and
galaxies form over billions of years  and their
fuentes     have achieved a     success rate
morphology  essentially their shape and
fortwoclassifications spiralandelliptical using
general visual appearance  gives astronomers
locally weighted regression and     training
much information about their composition and
examples goderyaandlolling   achieved   
their evolution  galaxy classification is
success on     training examples using neural
important because astrophysicists frequently
networks  but only     success on test data 
makeuseof largecataloguesofinformationto
other attempts at using neural networks have
test existing theories against  or to form new
usedfeaturesextractedfromtheimagesaswell
conjectures to explain the physical processes
as raw pixel data as inputs to the neural
governing galaxies  starformation  and the
networks 
nature of the universe  currently  astronomers
we explore the effectiveness of various
manually classify galaxies based on visual
featuresextractedfromgalaxyimagedata and
inspectionofphotographs thismethodisslow 
the performance of different machine learning
and is certainly not a worthy activity for an
algorithms 
the paper is structured in the
astronomer to be engaged in  this method is
followingway section introducesthehubble
also prone to human error  and thus accounts
tuning fork scheme for classifying galaxies 
forsomeinaccuraciesandmisclassifications 
section   discusses the system architecture in
astronomy has recently seen an explosion
detail  including image preprocessing  feature
of data  as programs like the sloan digital sky
extraction  and the machine learning
survey  sdss  will generate nearly    million
techniques we used  section   presents
images of galaxies alone  since access to this
experimentalresults andourconclusionsarein
amountofdatahasonlybecomepossibleinthe
section  
past decade  computer aided celestial
classification is a very young area  with much
scope for machine learning and image
  galaxyclassification
processing application  our goal is to apply
machine learning algorithms to the repetitive
morphological galaxy classification is a system
task of galaxy classification on a massive data
used by astronomers to classify galaxies based
set  this will not only decrease classification
on their structure and appearance  the most

ficommon classification scheme is the system
devised by sir edwin hubble in       he
proposedthefollowingclassifications 



elliptical e  e  e  e 
spiral s  sa sb sc
barredspiral sba sbb sbc
irregular im ibm
this scheme is commonly referred to as the
 hubble tuning fork  and is traditionally
depicted as shown in the figure below  the
motivationbehindthisdepictionisactuallynow
known to be fallacious  but that is another
story  



in classifying galaxies  we proceeded in the
following manner  first  we used  
classificationselliptical spiral irregular then 
we used   classifications  e   e   sa  sc  sba 
sbc i 
 

figure  systemarchitecture




image preprocessing  we first applied a
predeterminedthresholdtopixelintensitiesto
removefaint extraneousnoise abinaryimage
wasthenformedfromtheremainingpixels we
calculated the center of brightness using a
simple centroiding technique  using the  x  y 
coordinate of each remaining pixel  we
calculatedthetwoprincipalcomponentsofthe
image using the svd technique  the angle of
thelargestpcwasusedtorotatethemainaxis
of the galaxy  we then projected the image
pixels onto the pc vector basis and removed
any pixels with locations outside of   standard
deviations of the mean  effectively removing
brightstarsandotherextraneousobjectswithin
theimage afterwards wescaledtheimagesto
auniformsizeof   x    

systemarchitecture

the architecture of our system is divided into
three main phases as shown below and is
implemented in matlab  in the image
preprocessingphase eachgalaxyisindividually
scaled  rotated  cropped  and centered to
appear uniform for more accurate feature
extraction  then  in feature extraction  we
measured   quantities which we call morphic
features for each image  we also compressed
our images using principal component analysis
 pca  to derive pca features      finally  in the
classification stage  we trained and predicted
classificationswiththesefeaturesusingsupport
vector machines  svm   random forest  rf  
and nave bayes  nb  machine learning
classifiers 

figure  imagepreprocessing



feature extraction  the preprocessed
images are then sent to the feature extraction
phase where we calculated   morphic features
from each image and generated pca features 
the morphic features are based on the
perceived visual characteristics of the galaxy 
elongation  formfactor  convexity  bounding
rectangletofillfactor  boundingrectangleto
perimeter      and asymmetry index       we
used canny edge detection with   standard
deviations for the applied gaussian filter and a
thresholdvalueof   toeliminatefaintobjects
in the image  then  we fitted an ellipse to the
convexhulloftheremainingpixelstocalculate

fimost of our morphic features  elongation is
defined as  a  b     b   a   where a and b are
the major and minor axes ofour ellipse  form
factor is the ratio of the area of the galaxy
 numberofpixelsinthegalaxy toitsperimeter
 number of pixels in canny edge detection  
convexityistheratioofthegalaxyperimeterto
the perimeter of the minimum bounding
rectangle 
boundingrectangletofillfactor
 bff  is the area of the bounding rectangle to
the number of galaxy pixels within the
rectangle theasymmetryindexiscalculatedby
rotating theimage    degreesandcomparing
its pixel intensities with those of the original 
which has shown to be effective at
differentiating spiral  high asymmetry  from
elliptical lowasymmetry galaxies 
the pca features     were also calculated
for each image  we calculated the principal
component vector basis of the entire training
setwhereeachimagewasrepresentedasarow
vector  then  we used the coefficients of each
imageprojected compressed intothisbasisas
asetoffeatures          wecompressedthe
images using pc vector bases of   and   
elements  preserving     and     of the
originalimage respectively    
classification  we then trained svm  rf 
and nb classifiers on training subsets and
measured their classification accuracy on test
subsets  we used libsvm       weka random
forest       and dr  saeed hashemi s naive
bayes      classifier  we also explored using
adaboost through the matlabarsenal     
packageusingeachofthealgorithmsasaweak
classifier 
 
experimentalresults

our data set is comprised of     images along
with their classification labels  obtained from
zsolt freis galaxy catalog       the catalog
contains highresolution images with minimal
backgroundnoise 

after extracting features from the images 
we evaluated the performance of the
classification algorithms using various
combinations of input features  we used  
learning algorithms  svm with rbf kernel  rf
with    trees  nb  and their respective
adaboosted versions  for each of these
algorithms  we classified galaxies into   and  
classes using only morphic features  only pca
features  and both morphic and pca features
combined  in addition  we used both   and   
principalcomponents 
in order to maximize the information
provided by our data set  we implemented   
fold cross validation with the holdout images
randomlyselectedfromtheoveralltrainingset
 without replacement  at each iteration  since
the training set differs at each iteration  we
recalculatedthepcvectorbasiseachtime we
ran cross validation   times and reported the
average of these runs as our overall accuracy
and standard deviation for each algorithm to
normalize resulting random variations due to
thedatadistributioninthefolds wecalculated
themeanaccuracyandstandarddeviationsfor
boththetrainingandtestingsets 
table   below shows the mean accuracies
and standard deviations we obtained for each
of the classifiers  ind denotes individual
classifiers  std denotes standard deviation  m
denotes using only morphic features  npc
denotesusingonlynprincipalcomponents and
m npc denotes using both morphic features
andnprincipalcomponents 
from our results  rf with only morphic
features performed best  svm performed
betterthannbinmostcases also classification
using morphic features alone was more
effective than using pca features  and the
optimal number of pca features was found to
bebetween and   



fisvm


 class

features
m
 pc
  pc
m  pc
m   pc

indmean
     
     
     
     
     

indstd
     
     
     
     
     

adaboost
mean
     
     
     
    
     

 class
adabooststd
     
     
     
     
     

indmean
     
     
     
     
     

indstd
     
     
     
     
    

adaboost
mean
    
    
     
    
   

adabooststd
    
    
    
    
    

randomforest


 class

features
m
 pc
  pc
m  pc
m   pc

indmean
     
     
     
     
    

indstd
    
    
     
    
     

adaboost
mean
     
     
     
    
     

 class
adabooststd
     
     
    
     
     

indmean
     
     
    
     
     

indstd
    
     
     
    
     

adaboost
mean
     
    
    
     
     

adabooststd
     
    
    
    
     

navebayes


 class

features
m
 pc
  pc
m  pc
m   pc

indmean
     
     
     
    
     

indstd
     
     
     
     
     

adaboost
mean
     
     
     
     
     

 class
adabooststd
     
     
     
     
     

indmean
    
     
     
    
   

indstd
    
     
     
    
    

adaboost
mean
    
     
     
    
    

adabooststd
    
     
     
    
    

table  classificationtestaccuracy


 



conclusionsandfuturework

webelievethatrfperformedbetterthansvm
in general because our features were not
linearly separable even when projected to
higherdimensionswiththerbfkernel rf with
overfitted decision trees  seemed more robust
withsuchnonlineardata ouradaboostresults
are intriguing because we expected that
adaboostingwouldhaveimprovedclassification
accuracy 
we believe that morphic features were
moreeffectivethanpcafeaturesbecausethey
arelesssusceptibletomorphologicalvariations
of galaxies in the same category  pca features
depend on raw pixel data  which is more
susceptible to these same morphological
variations  this is consistent with the results 
which showed that too many pcs in our pca
feature set  preserving more raw data 
degradedclassificationperformance 
the accuracy of our calculated morphic
features was affected by several factors  the
cloudofstarsanddustsurroundingthegalactic
core resulted in spurious edges  making it
difficult to determine the perimeter of the
galaxy theboundingellipsemaybedistorted

by bright background stars that impact the
calculation of the convex hull  faint spiral arms
thataremissingduetothresholding andedge
ongalaxyimages 
future work to improve classification
accuracy includes incorporating more training
data and integrating photometric features
measuredin differentspectra   with morphic
features  implementing the bartobulge ratio
and the integrated curvature morphic features
    may also boost the accuracy on  category
classification  additionally  we can classify
galaxies in stages  first weakly classify a large
number of galaxies into   categories  and then
furtherclassifytheseinto categoriesusingthis
aprioriknowledge 
 
references

   goderya s n  lolling s m  morphological
classification of galaxies using computer
vision and artificial neural networks  a
computational scheme  astrophysics and
space science  vol       no     pp      
    
   calleja  j   fuentes  o   machine learning
and image analysis for morphological

fi  

  

  

  
  

  

  
   

   
   
   
   

   

   

   

galaxy classification  monthly notices of
the royal astronomical society  vol     
     pp      
calleja  j   fuentes  o   automated
classification of galaxy images  lecture
notes in computer science  vol       
     pp        
bazell d  aha d  ensemblesofclassifiers
for morphological galaxy classification 
     
au k  genovese c connolly a  inferring
galaxy morphology through texture
analysis      
calleja  j   fuentes  o   automated
classificationofgalaxyimages      
goderya  s   andreasen  j    philip  n s  
advances in automated algorithms for
morphological classification of galaxies
basedonshapefeatures      
lekshmi  s   revathy  k   nayar  s r p 
galaxy classification using fractal
signature      
oferlahav galaxyclassificationbyhuman
eyeandbyautomatedalgorithms      
zhang  y   zhao  y   classification in
multidimensional
parameter
space 
methodsandexamples      
odewahn  s   galaxy classification using
artificialneuralnetworks 
odewahn  s c   automated galaxy
classificationinlargeskysurveys      
turk  m   pentland  a   face recognition
usingeigenfaces      
n m ball j loveday et all galaxytypes
in the sloan digital sky survey using
supervised artificial neural networks 
mon not r astron soc     p          
     
abraham  r  g   tanvir  n  r   galaxy
morphologytoi   maginthehubbledeep
field 
bazell  d   feature relevance in
morphological galaxy classification  mon 
not r astron soc                 
turk  m   pentland  a  eigenfaces for
recognition  journal of cognitive
neuroscience vol   no   pp           

    brieman  l   random forests   machine
learning                
    chihchung chang and chihjen lin 
libsvm  a library for support vector
machines        software available at
http   www csie ntu edu tw  cjlin libsvm
    heshami  saeed  nave bayes classifier 
homepageathttp   torch cs dal ca  saeed
    yan  rong  matlabarsenal  software
available
at
http   finalfantasyxi inf cs cmu edu matla
barsenal matlabarsenal htm
    ian h  witten and eibe frank         data
mining  practical machine learning tools
and techniques    nd edition  morgan
kaufmann sanfrancisco      
    frei  z   and gunn  j   available at
http   www astro princeton edu  frei
 catalog htm
 
note weconsultedwithseveralastronomers 
manyofwhomaredirectlyinvolvedinthesloan
digital sky survey  we have chosen to do
morphologicalgalaxyclassificationbasedonthe
advice that we received from them  they
identified thisasoneofthemost cumbersome
areasincelestialclassification andtheonethat
has proven the most difficult to automate 
following is a list of some of the astronomers
whoareadvisingusinthisproject 

david weinberg  scientific spokesperson for
thesloandigitalskysurvey 
dr  cecilia barnbaum  professor of astronomy 
valdostastateuniversity 
dr kennethrumstay professorofastronomy 
valdostastateuniversity 
robert brunner  asst  professor of astronomy 
university of illinois at urbanachampaign
 who has employed machine learning
algorithmsforcelestialclassificationbefore and
is intimately familiar with the research in this
area  
chris lintott  presenter for the bbc s sky at
night tv program  and maintainer of
galaxyzoo com 

fi