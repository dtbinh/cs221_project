cs    final project report

whos in charge here    using clustering algorithms to
infer association of putative regulatory elements and
genes
ari officer  fah sathirapongsasuti  te thamrongra ttanarit

background
after the release of the human genome and many other genomes  new insights have emerged about the
complexity of the human genome  while only about      of the genome code for proteins        evidence from
sequence conservation and expression data suggest that at least    of the genome is functional        given that
these conserved non coding elements are not genes but reside among genes  they are therefore believed to
comprise the regulatory machinery that governs temporal expression of the genes  these non gene functional
genomic regions are then called putative cis regulatory elements  cres   although many biological experiments
confirmed that cres do perform such task in the genome  the question remains  which genes do these putative
cis regulatory elements regulate 
while the most accurate way to make associations between cres and genes that they regulate 
conducting a biological experiment can be costly in terms of time and effort and is not guaranteed to yield
meaningful results  furthermore  most experiments were motivated by the heuristic that each cre should regulate
the gene most proximal to it  even though biologists are able to discover some gene cre associations based on
this heuristic  the frontier is currently limited to the genes closest to the cres  on the other hand  a handful set of
experiments       have shown that cres tend to cluster around genes transcription start sites  tss  and coregulate target genes not necessarily closest to it but goes as far as one million base pairs away  figure     thus 
machine learning algorithms  particularly clustering algorithms  can help exploring such cases  thus surpassing the
frontier that impedes advancement in biological study  in this project  we would like to apply various clustering
algorithms to provide alternative guidelines for further biological experiments that will identify the associations
between putative cres and the genes that they regulate  which will lead to discovery of biological basis of genetic
diseases and subsequently the cures for them 

figure     the yellow histogram shows the distribution of cres over the genomic regions centered at the reference sequence of gene 
 human march      assembly  chr                        

preliminary stage
methods
the genomic locations of cres and genes were extracted from ucsc genome browser  with courtesy to
prof  gill bejeranos lab  department of developmental biology and department of computer science  stanford
university  since biological findings show that cres that are proximally located tend to co regulate the same
genes  it is rational to cluster cres together and then assign each of them to a gene  based on this heuristic  we
chose k means clustering algorithm to be one of our preliminary algorithms  the k means algorithm was run to
associate regulatory elements with genes based on their transcription starting sites  tss   since there are       
gene loci over all chromosomes in our extracted dataset  every cre would be assigned to one of the       

ficentroids  for each chromosome  the centroids were initialized to the starting position of the genes  each cre
was assigned to the closest centroid  and then centroids were updated  after the convergence  we assigned each
cluster to the gene closest to its centroid 
moreover  it is observed that cres are roughly normally distributed around a sequence of gene  figure
    given this particular distribution of the cres  another reasonable choice of clustering algorithm is e m with
mixture of gaussians  by fitting multiple gaussians over genomic regions  we should be able to cluster cres and
assign them to the gene within that region  since this algorithm requires a lot of computational power  we could
not run this algorithm on the chromosomes with a large number of genes  we only selected chromosome        
    and    because of their smaller sizes but relative abundance of known associations and insulators  table   
and their ratios between number of known associations and number of all cres are the highest 

evaluatio n
in every stage of improving the clustering algorithms  we evaluate the performances of the algorithms
and compare them against some baseline in the following ways 
  

  

  

known association test    the result and the baseline will be verified with    experimentally
confirmed associations hand curated by t h  cheung et al       and the error rates will be calculated 
this source of associations is the most reliable because each association is supported by specific
biological literature  nevertheless  a subset of genes is more heavily studied than others  so the data
from this source does not represent randomly sampled associations  this test  which relies on this set
of data  might not reflect the true performance of the algorithm in question 
known association test    there are a few thousand known associations in oreganno  open
regulatory annotation database          but the set contains some indirect association between
cres and genes  after incomplete entries and indirect associations were screened out  we managed
to extract     associations and would use these known associations to verify the output from the
algorithms  note that we do not combine known associations with the ones from t h  cheung et al 
because the curation method of this second set of data appears less reliable than the first 
insulator test  evidence from biological experiments      shows that a protein called ccctc binding
factor  ctcf  acts as an insulator and blocks regulation of a gene by cres on the opposite side of the
ctcf binding site  in other words  an association cannot be correct if the genes and the cres are
not in between the same pair of insulators  we define the insulator test errors as the proportion of
insulators intersecting the clusters  monte carlo simulation was performed over random partitioning
of the genomic regions with number of partitions  hence  clusters  equal to the number of genes 
using this data  we estimated the mean and variance of the insulator test error from a random
partition over genomic regions and could then produce     confidence intervals for random
partitions  since our clustering algorithms do not take the ctcfs into account  testing their insulator
test error against the random error is used to support the sensitivity of the algorithm  the null
hypothesis is that the clustering algorithm functions independently from the insulators and  thus 
should have random error  a low p value  then  supports the algorithm as capturing real information 

results
for the k means algorithm  the known association test   accuracy  known association test   accuracy 
and insulator test error are           and      respectively  table     our k means algorithm did significantly
better than our baseline of random partitions in every test but one  p         although the accuracy rate is not
perfect  k means algorithm proves to be a good antecedent algorithm upon which we can improve 
the error rate of the e m algorithm with mixtures of gaussian from the insulator test is       which is
significantly worse than k means  moreover  the accuracy rates from known associate test   and known
association test   are zero  this results because e m is inherently a clustering algorithm  but the clusters stray
from one to one correspondence with the genes themselves  therefore  we disregarded this algorithm from our
further consideration 

fitable   test results of simple k means algorithm
known association test  

chr

known association test  

insulator test

 known associations

accuracy rate

 known associations

accuracy rate

error rate

 
 
 
 
 
 
 
 
 
  
  
  
  
  
  
  
  
  
  
  
  
  
y
x

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

    
    
    
    
    
    
    
    
    
    
    
    
n a
    
    
    
    
    
    
    
n a
    
n a
    

 
  
 
 
  
  
  
 
  
 
  
 
 
 
 
 
 
 
  
 
  
  
 
  

    
    
n a
n a
    
    
    
    
    
n a
    
    
    
n a
    
    
n a
    
    
    
    
    
n a
    

     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

overall

  

    

   

    

     

improvements upon k means algorithm  weighted k means
methods
according to the closest gene heuristic that biologists in this field rely on  each cre tends to regulate the
gene closest to it  our simple k means algorithm is oblivious of gene locations and thus fails to capture this effect 
in this stage  we would like to combine the advantage of closest gene heuristic and the advantage of k means
algorithm by implementing a weighted k means algorithm  in this algorithm  we place actual weights at the gene
locations  which are then used in the k means algorithm as data points themselves  the only difference is that the
centroid update step occurs over weighted data  with the genes now included   so rather than summing the
distances  we sum the products of distance and weight  we kept the weights at   for all of the cres  then
arbitrarily assigned weights of powers of    to the genes themselves  the assignment of the genes was returned
after convergence  and then we processed the clusters into assignments in the same way as with the standard kmeans algorithm  the greater the weight at the gene  the more likely that cres around that gene will cluster
together around a centroid near the gene  because our algorithms have been applied to a chromosome in its
entirety  this weighting helps keep the clusters local  rather than being free to roam around the entire
chromosome 

results
table   comparison of the accuracy rate in predicting gene cre association between unweighted k means and weighted k means

known association test  

known association test  

chr
 
 
 
 
 
 
 
 
 
  
  
  
  
  
  
  
  
  
  

 

unweighted

weighted   

 
  
 
 
  
  
  
 
  
 
  
 
 
 
 
 
 
 
  

    
    
n a
n a
    
    
    
    
    
n a
    
    
    
n a
    
    
n a
    
    

    
    
n a
n a
    
    
    
    
    
n a
    
    
    
n a
    
    
n a
    
    

 

weighted  

    
    
n a
n a
    
    
    
    
    
n a
    
    
    
n a
    
    
n a
    
    

 

weighted  

    
    
n a
n a
    
    
    
    
    
n a
    
    
    
n a
    
    
n a
    
    

 

 

unweighted

weighted   

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

    
    
    
    
    
    
    
    
    
    
    
    
n a
    
    
    
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
n a
    
    
    
    
    
    

 

weighted  

    
    
    
    
    
    
    
    
    
    
    
    
n a
    
    
    
    
    
    

 

weighted  

    
    
    
    
    
    
    
    
    
    
    
    
n a
    
    
    
    
    
    

 

fi  
  
  
y
x

 
  
  
 
  

    
    
    
n a
    

    
    
    
n a
    

    
    
    
n a
    

    
    
    
n a
    

 
 
 
 
 

    
n a
    
n a
    

    
n a
    
n a
    

    
n a
    
n a
    

    
n a
    
n a
    

from table    weighted k means algorithm performed better than unweighted k means algorithm  we
observed that the accuracy rate rises as we increase the weight  as mentioned in the evaluation section  the
experiments that comprise the data set for known association test are suggested by the closest gene heuristic 
the increase in the accuracy rate can be misleading because the data sets that the two tests depend on bias
towards the closest gene heuristic  therefore  if we put too much weight to k means algorithm  the algorithm will
turn into the closest gene heuristic and will miss the goal to explore the associations left uncaptured by the
heuristic  by the results from insulator test  figure     we selected     weighted k means to be our optimal
algorithm in clustering cres and assigning the genes  as it improves upon unweighted k mean in terms of
insulator test errors yet maintains the ability to discover novel associations 

insulator test errors and p values
 

   

insulator test error or p value

   

   

   

   

   

   

    confidence interval for randomly partitioned clusters
p values for unweighted k means against random
unweighted k means errors
weighted k means errors  weight      
weighted k means errors  weight       
weighted k means errors  weight        
mixture of guassians e m error  selected chromosomes

   

   

 

 

 

  

  

  

  

chromosome

figure   summary of insulator test errors for the various algorithms  the errors for k means algorithms are significantly below the
errors from random partitioning  and we find the p values for the unweighted k means algorithm to be near   

contribution of weighted k means
we found    cases where weighted k means algorithm made correct associations but the closest gene
heuristic made incorrect associations  for instance  at chr                         the closest gene heuristic
wrongly assigns the cre to the gene nr         which is the closest gene  on the other hand  the weighted kmeans algorithm correctly assigns it to gene hoxa   because the assignment takes into account the surrounding
cres  which turn out to be clustered near hoxa    figure     the one of most exceptional cases that we have
found is that our weighted k means algorithm correctly associates the gene and the cre that are         bases
apart  because the weighted k means algorithm does not depend solely on the distance  cres that are remotely
located can be associated with the genes  an example of such case is chr                          the cre
was inaccurately assigned to slc  a   by the closest gene heuristic  but the weighted k means algorithm makes
the correct association  figure    

fifigure   the closest heuristic assigns the cre to the gene nr         red arrow   but k means algorithm correctly assigns it to hoxa  
 tan arrow   ucsc human march      assembly  chr                         

figure   the closest heuristic assigns the cre to the gene slc  a    red arrow   but k means correctly assigns it to nrxn   tan arrow 
 ucsc human march      assembly  chr                          

however  because of the low accuracy rate in known association tests  doubt can be cast on the validity
of the result from our algorithm  as mentioned earlier  the data sets used by known association tests are based
on the heuristic and therefore do not represent random samples of all genes  in order to verify that our weighted
k means algorithm is a valid algorithm in clustering and assigning cres to the genes that they regulate  we
implemented a statistical tool for this purpose  this tool is called enrichment test of association  eta   eta is
based on a study by bejerano et al              that a subset of cres known as the ultraconserved elements
involve in some key transcriptional and developmental functions  since the ultraconserved elements regulate
genes that share some common functions  we expect to observe overrepresentation of genes with those functions
being regulated  i e  associated  by the ultraconserved elements  therefore  a clustering and gene cre
associating algorithm is valid if the algorithm associates the ultraconserved elements to the genes that share these
key transcriptional and developmental functions  eta uses hypergeometric test to assess this enrichment and
report bonferroni corrected p value for each annotation term  if the p value is less than     for some key functions
of the ultraconserved elements  then the algorithm is valid  we ran eta on the weighted k means algorithm that
we invented  and it turns out that the algorithm is able to capture some key features of the ultraconserved

fielements  table     as a result  the algorithm can be used to predict gene cre association especially in the case
where the cre and the gene that it regulates are very far apart 
to explore the full advantage of eta  we then traced back the list of gene cre associations that yields the
enrichment  we found a list of ultraconserved elements that are not previously known to be involved in some
functions  for example sequence specific dna binding and rna binding  these predicted associations can then be
tested further in experiments 
table   gene ontology terms that are enriched in ultraconserved elements

gene ontology id
go        
go        
go        
go        
go        
go        
go        
go        
go        
go        
go        
go        
go        
go        
go        

description
enrichment in exonic  ultraconserved elements
rna binding
nucleic acid binding
transcription regulator activity
transcription factor activity
rna splicing
rna metabolism
mrna processing
sequence specific dna binding
mrna metabolism
dna binding
nucleobase  nucleoside  nucleotide and nucleic acid metabolism
enrichment in intergenic  ultraconserved elements
sequence specific dna binding
transcription
regulation of transcription
frizzled signaling pathway

p value
        e   
        e   
        e   
        e   
        e   
        e   
        e   
        e   
        e   
        e   
        e   
        e   
        e   
        e   
        e   

conclusion and future direction
our weighted k means algorithm successfully expands the boundary of exploration  even though the
accuracy rate of this algorithm is not affirmingly high  biologists can combine facts from previous biological
experiments and the prediction that the weighted k means algorithm has made in order to guide further research 
if the prediction and the biological facts seem to be consistent  then researchers can make a rational attempt to
confirm the association by conducting biological experiments  the genomic regions that researchers afford to
explore will be less restrained with the combined guidelines from biology and machine learning algorithm 
researchers can be more confident in their endeavor to dig through the fortress of cres that is far away from the
comfort zone of the closest heuristic 
in addition to escalating the possibilities of exploring the unexplored  results from the algorithm will lead
to experiments that will potentially provide more data on known association and give a good foundation for
developing the algorithm  the known association tests that we used were not quite reliable because most of the
known associations were discovered based on the heuristics  if the data sets contained more associations where
the gene and cres are more than         bases apart  the known association tests would become more reliable
and would facilitate further development of algorithms 

reference
  
  
  
  
  
  
  
  
  
   
   
   
   

e  s  lander et al   nature                 
j  c  venter et al   science                  
human genome sequencing consortium  in preparation 
r  h  waterston et al   nature                 
k  m  roskin  m  diekhans  d  haussler  in proceedings of the  th annual international conference on
research in computational molecular biology  acm  new york  ny         pp         
f  chiaromonte et al   cold spring harbor symp  quant  biol                 
t  vavouri and g  elgar  curr  opin  genet  dev                 
c  b  lowe  g bejerano  d  haussler  pnas                   
t  h  cheung  k  k  b  barthel  y  l  kwan  x  lin  pnas                    
s  b  montgomery et al   bioinformatics                 
o  l  griffith et al   nucleic acid res   nov           
t  h  kim et al   cell                   
g  bejerano et al   science                   

 

exonic ultraconserved elements are ultraconserved elements that overlaps protein coding portion of genes

 

intergenic ultraconserved elements are ultraconserved elements that locate between genes

fi