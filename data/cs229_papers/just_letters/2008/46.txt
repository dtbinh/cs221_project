stanford university cs    machine learning autumn       course project

machine learning methods application in
variable moving average trading rules
zhiyu ma  chen hu  hai wei
   project outline
    general scheme of technical trading analysis with machine learning
 step    forecast prices of certain financial instruments by studying past prices 
 step    practiced certain technical trading rules based on the forecast results 
 step    complete related summary statistics concerning security trading 
    our approach
 construct forecasting based on statistical learning methods  boosting  bayesian  and committee to
reduce the data snooping bias introduced by the arbitrary selection of the parameters in technical
trading rules  and to avoid the element of subjectivity that the procedure involves  and then
compute the returns of the trading strategies generated by the above methods 
 set up a filter to reduce trading frequency  construct statistical learning methods  filtered
boosting bayesian committee  and then compute the returns of the generated strategies again 

   machine learning methods applied in studying securities prices
    boosting approach
boosting is a learning algorithm that combines the outputs of many weak classifiers to produce a
powerful committee  a weak classifier is one which performs just slightly better than random guessing 
boosting refers to the general problem of producing an accurate classifier by combining rough and
moderately inaccurate weak classifiers  the most popular one is proposed by freund and schapire       
called adaboost m   a classifier ht   x  is a function that produces a prediction taking one of the two
values          where x is a set of predictor variables  the predictions are then combined through a
weighted majority vote to produce the final prediction  more specifically  the algorithm takes as an input a
training observation set z      x    y           xm   ym     where xi  x   yi            as freund and schapire
       show  the adaboost m  algorithm is as follows 
 
first  initialize w   i       i             m   and then for t          t   follow the algorithm 
m
 step   fit a classifier ht   x  to the training data using a weight wt  i    



m

step    compute  t    wi i   yi  ht   xi   
i   




m

w  
i

i   

  t
 
 
step    compute  t   log
 
t
step    update wt     i     wt  i   exp  t yi ht   xi    z t   i             m  

 t

here  z t is a normalization factor  the final result is  h   x    sign    t ht   xi     
 t   

    the bayesian model averaging approach
given a set of candidate models ht   t          t   bayesian model averaging consists of taking a weighted
average of the individual predictions  with weights proportional to the posterior probability of each model 
 

fit

the weights are the rates of success st

s
j   

j

of the model ht   t          t on the training set
m

z      x    y           xm   ym     where xi  x   yi            and st    i   yi  ht   xi     
i   

    committee approach
the committee method considers a simple arithmetic average of the predictions from each model  giving
equal probability to each model 

   variable moving average  vma  rules
vma rules are based on the comparison of a short term moving average of prices to a long term moving
average  a vma  s  l  b  rule emits buy  sell  signals when the s day moving average of prices exceeds
 is less than  the l day moving average of prices by at least b   the choice of a band around the moving
average can help reduce the number of trades when the short term and long term moving averages get
close to each other  see brock et al         in this project  we choose s           or     l equals from   
to     by a step of    and b equals from   to     by a step of     then we have     vma rules in total 
and apply various methods to combine these rules 

   signal filtering
in real transaction  the high frequency of trades is expensive and inefficient  thus  we need to construct an
additional filter in the signals provided by all the learning methods shown above  the success of the
filters would justify the existence of some systematic trends in the prices which are not explained by the
random walk model  in this project  the filters for boosting  bayesian  and committee all have the same
form  i e   for a given a number       


t

     t ht   xi     if we are out of the market  a buy signal is generated  if we are in the market  the
t   

trading rule suggests we should continue holding the market 


t

  h   x       if we are in the market  a sell signal is generated  if we are out of the market  we
t   

t t

i

continue holding the risk free security 


t

if      t ht   xi        no signal is generated and we maintain the previous position 
t   

here  in our project   is set as the      quintile of previous     signals 

   trading action set
we consider a simple trading action set  if our methods give a forecasting that the next days index will
increase  we invest all of our money holding the index  on the contrary  we invest all of other money in
the u s    month treasury bond market  the one sided transaction costs are       which can be achieved
by large institutions nowadays 

   empirical result
the main result we get is that in the bullish market  the  filtered  committee bayesian methods give good
results and are similar to b h strategy  and all of them are better than  filtered  boosting methods 
however  in bearish market filtered boosting method performs best and the performance is much better
than all other strategies  we will show our conclusion from the next three results 
result    we first calculate the forecasting error rates of all trading strategies  see exhibit    
 

fiexhibit    forecasting error rates
forecasting error rates forecasting error rates
                                             
committee
      
      
filtered committee
      
      
bayesian
      
      
filtered bayesian
      
      
boosting
      
      
filtered boosting
      
      

methods

we find that in general the  filtered  boosting does not give a better forecasting accuracy compared with
other methods  however  in volatile market  they can still give a reasonable forecasting accuracy       
while other forecasting methods performs very poor          
result    to analyze the efficiency of our approaches  we use sharpe ration  see exhibit     from exhibit
   we can see that b h dow jones index has the highest average sharpe ratio from            however 
our filtered boosting algorithm works much better than all other strategies including b h in bearish
market            when we consider the time interval from            filtered boosting algorithm gives
        much larger than those given by all other methods 
exhibit    sharpe ratios
year
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
average
average       

dj index
      
      
       
      
      
       
      
      
       
      
      
      
       
      
      
      
      
      
       
       
       
      
      
      
      
       
      
      

committee
      
      
       
      
      
       
       
      
       
      
      
      
       
      
      
      
       
       
       
       
       
      
      
      
      
       
      
       

f  commit
      
      
       
      
      
       
       
      
       
      
      
      
       
      
      
      
       
      
       
       
       
      
      
      
      
       
      
       

bayesian
      
      
       
      
      
       
       
      
       
      
      
      
       
      
      
      
       
       
       
       
       
      
      
      
      
       
      
       

f  bayesian
      
      
       
      
      
       
       
      
       
      
      
      
       
      
      
      
       
      
       
       
       
      
      
      
      
       
      
       

boosting
       
      
       
      
      
      
       
      
       
       
       
      
       
      
      
       
      
      
      
       
       
      
      
      
      
       
      
      

f  boost
       
      
       
      
      
       
       
      
       
       
       
      
       
      
      
      
      
      
      
       
      
      
      
      
      
       
      
      

result    in exhibit      we show the plots of how our various trading strategies work  exhibit   shows
that all of the committee and bayesian methods performs similar in bullish market compared with b h
 

fistrategy  among them filtered bayesian performs best  however  none of them performs well in
volatile bearish market  exhibit   shows that boosting methods gives worse performance than buy   hold
strategy in the bullish market  however  when we observe the plots in exhibit    we find that  filtered 
boosting methods perform much better than buy   hold strategy  and buy   hold actually works much
better than all other methods  in the volatile bearish market 
exhibit     filtered  bayesian committee performance
    
  month treasury bond
committee
dj index
filtered committee
baysian
filtered baysian

    

    

    

    

    

    

    

    

   

 

 

    

    

    
    
                      

    

    

    

    

    

exhibit     filtered  boosting performance
    
  month treasury bond
filtered boosting
dj index
boosting

    

    

    

    

    

    

    

    

   

 

 

    

    

    
    
                      

 

    

fiexhibit     filtered  boosting performance in bearish markets
    
  month treasury bond
boosting
dj index
filtered boosting

    

    

    

    

    

    

    

    

 

   

    
    
                      

    

    

   conclusion
beating the market is a very difficult task  in this project we use different methods to combine a number
of variable moving average trading rules to try to forecast the dow jones composite index move  and use
a simple trading action set  hold the index or hold the   month treasury bond  our empirical study shows
that although in general no one method can beat the market from a long time interval                in
bearish market the filtered boosting method can give a much better result compared with buy   hold
index or any other strategy in terms of absolute return and sharpe ratio  this result may illustrate other
researchers to find a profitable trading strategy based on this boosting method in the future 

references
andrada felix j  fernandez rodriguez f        improving moving average trading rules with boosting
and statistical learning methods  journal of forecasting 
bessembinder h   chan k        market efficiency and the returns to technical analysis  financial
management 
brock w  lakonish j  lebaron b        simple technical rules and the stochastic properties of stock
returns  journal of finance 
freund y  schapire re        a decision theoretic generation of on line learning and application to
boosting  journal of computer and system sciences 
freund y  schapire re        a short introduction to boosting  journal of the japanese society for
artificial intelligence 
hastie t  tibshirani r  friedman j        the elements of statistical learning  data mining  inference
and prediction  springer  new york 
luenberger d       investment science oxford university press 

 

fi