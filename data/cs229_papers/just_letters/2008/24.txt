time series prediction of us swap rates
roland burton

shandor dektor

dawn wheeler

rolandb stanford edu

sgd stanford edu

dawnw stanford edu

abstract
in this project machine learning techniques were used
to generate technical trading strategies in the us interest
rate swap markets  leela  a correlation algorithm that
is closely related to autoregression  was developed to detect short term repeating patterns to predict future market
moves  this algorithm exhibited a sharpe ratio of   when
applied to a single swap  when additional swaps were used
the sharpe ratio increased to      finally  when pca decomposition was employed  the time series of residuals exhibited a sharpe ratio in excess of   

introduction
an interest rate swap is a contract between two parties 
who agree to exchange fixed interest rate payments for floating rate payments    the fixed interest rate is the quoted rate
of a swap  and this rate primarily depends upon the duration
or maturity of the contract  the fixed rate is the expected
value of short term interest rates over the contract duration  and is often treated as a proxy for the borrowing costs
of large corporations  the swap rate is measured in percent  and daily changes are measured in basis points  where
one basis point is equal to        consequently profit and
loss from holding a swap is most commonly quoted in basis
points  a convention we adopt in this paper 
one of the uses of interest rate swaps is to hedge mortgage interest rate risk  when interest rates increase  mortgage servicers need to pay on a swap  further raising interest
rates  similarly  when interest rates decrease  servicers need
to receive further decreasing rates  as the mortgage market
is so large  the activities of servicers create temporary interest rate dislocations  it can take several days for the market
to redistribute the new duration risk among other participants  it is hoped that the initial change in duration risk 
followed by the subsequent redistribution of risk will create
recognizable short term patterns in the data that can form
the basis of a profitable technical trading strategy 
  tuckman  b        fixed income securities  tools for todays markets   nd ed  wiley finance

the performance of technical trading strategies is most
frequently judged by looking at the sharpe ratio  a method
originally devised for measuring the performance of mutual
funds  the metric was further revised in       and it is this
version that will be used to measure trade performance 
e r  rf  
p
var r  rf  
where r denotes the annualized return and rt denotes the
annualized risk free rate  as swaps are derivative instruments requiring no capital  they can be fully cash collaterized  eliminating the need to incude the rt term  although
quoted in annualized terms  the sharpe ratio is normally
calculated using daily data  there are     trading days in
the year  so for our purposes  the formula reduces to
e r  
p
   
var r 
and the daily return r is expressed in basis points  trading strategies which achieve a sharpe ratio of over     are
qualified as good  a sharpe ratio of over     is considered
very good and sharpe ratios above     are outstanding   

   data
barclays capital provided daily interest rate swap quotes
for swap contracts maturing in         and    years  figure    shows a history of swap rates over the whole period 
as can be seen interest rates have generally decreased over
this whole period  a simple buy and hold strategy using
ten year swaps returned a sharpe ratio of       however
in reality a trader scales the size of his position based upon
recently observed volatility  such a strategy increases the
sharpe ratio marginally to      

   preliminary analysis
initially each swap maturity was treated individually 
the first algorithm to be tried was ordinary least squares
  sharpe  w  f          the sharpe ratio  journal of portfolio management             
  masteika  simutis         stock trading system based on formalized technical analysis and ranking technique  computational science
iccs     

fifigure    history of us swap rates from july      to the present

 ols  linear regression  the feature vector at time t is
xt    dt  dt        dtp  t   and the observation at time t
is yt   dt where dt denotes the change in swap rate in basis
points on day t  p is an integer that denotes how many days
are considered for pattern matching  the coefficients    are
chosen such that yt  t xt for all t  the trading signal
for day t     is given by sgn t xt     and the return on the
t     day is given by rt     dt   sgn t xt      the data
is heteroskedastic  and it is unreasonable to assume that  is
the same over all history  so  is computed over a window
of n days of recent data 
t    xtt xt    xtt yt
where x   np and the ith row of x is xtti     and
y    yt yt        ytn    t   reasonable values for n are
from    to       corresponding to ninety calendar days to
six years  recalling the motivation in the introduction  the
idea is to detect short term patterns caused by temporary
liquidity imbalances so reasonable values for p are      or  
 up to a full trading week  
an alternative approach to dealing with heteroskedasticity is to redefine the data based on local norms  so that
xt   xt    xt    and yt   yt    xt     and then repeat the analysis as described as above  the  used to compute rt   is
based only on previously observed data  so the performance
is out of sample  for the    year swap  after scaling the data
to attempt to combat the heteroskedasticity  a sharpe ratio
of      attained with p     and n        no better than a
buy and hold  without scaling  the sharpe ratio was zero 
autoregressive  ar  methods were briefly investigated 
computation relied upon the built in matlab function
arburg which estimates parameters via the burg method 
in a similar manner to linear regression  there are two parameters that can be chosen for the model  n and p  p is
the order of the model and n is the window size used  the

figure    linear regression and autoregression  autoregression
outperforms ols both in return and in sharpe ratio  visually 
sharpe ratio is a measure of slope vs  stability of return 

ar methods are very closely related to ols  but they act
upon correlation coefficients rather than on the data itself 
looking at the    year swap rate with n       and p     
a sharpe ratio of     was attained  which is a much improved performance over ols  figure    compares the performance of the burg ar algorithm and ols regression 

   the leela algorithm
although the ar algorithm improved performance  it
was unable to break through the barrier of a sharpe ratio
of    a new correlation algorithm was proposed that is very
closely related to the ar algorithm  which the authors have
called leela    the return on day t     is given by 
rt     dt   sgn 

t
x

i t yi  

i tn  

where i t   xtt xti   and xt and yt are as previously defined  xt is the feature vector  and yt is trade selection  in
words  the algorithm takes the last p days moves in the instrument  and then correlates this vector with all the previous p day moves in the past n days  giving n correlations 
  the trading signal           is the sign of the sum
of all these correlations multiplied by the following days
normalized move  the return is simply the trading signal
based on data from day t and earlier  multiplied by the actual move on day t      by computing correlations  via normalized vectors   problems associated with heteroskedasticity are reduced  another assumption in this algorithm is
that patterns are symmetric  with respect to liquidity  symmetry assumes that a large seller in the market has the same
  the

one eyed captain from futurama

fieffect only reversed as a large buyer in the market  for equity markets this assumption is tenuous  but in fixed income
markets sharp rallies and sell offs are much more similar  in
the following section two methods are examined to expand
the feature vector and trade selection past a single swap 

   feature vector and trade selection for leela
we tested three main variants on the leela algorithm to
determine what feature vector and trading strategy held the
most promise  each of these algorithms inputs a different
feature vector to the algorithm  the output from leela was
used to choose the best trade for each day 

     ten year feature vector and correlation
the   y is the basic leela algorithm  the feature vector
    
is simply dt   dt   the remainder of the algorithm is
identical to that described in section   

     multi instrument feature vectors
this variant is based on correlation using the three day
performance of the overall market  this allows the algorithm to assess the recent trading environment more accurately  the feature vector for multi correlation consists of
the normalized three day history for each swap 
   

   

   

    

    

    

x t     dt  dt  dt        dt  dt  dt   
xt   xt    xt   
   

    

yt    dt       dt

    xt   

this algorithm selects the swap with the largest trading signal  as defined by 
 
t
x
arg max abs
i t yi s
s

i tn  

where i t is modified with 

x t t x i  if x t t x i       
i t  
 
otherwise
the algorithm considers how each swap performs given
market conditions  choosing the largest trading signal reduces the risk of making a poor decision  using a  cutoff increases the similarity between current and past market
conditions  but the bound must not be so strict that it eliminates relevant data 

     principal component decomposition
pca was used to prefilter the data before passing it to
the leela algorithm  as was shown at the beginning of
this project  the five different swap maturities appeared to

show strong cross correlation  this was confirmed when
 k 
the pca decomposition was computed  let dt denote the
daily change  in basis points  of the k year maturity swap
on day t  then define


   
    
dtn                     dtn  
  
  
  
  
   
  

 
 
 
  
  
d 

  
  
  
    
     
 
 
 
dt  
 dt 
   
   
   
   
    
dt
dt
dt
dt
dt
to compute the pca factors we can use svd  so
d   u v t   market convention is to set n     such
that the pca factors are computed over ninety calendar
days  the singular values for a recent period are   
                         showing how the first two factors
dominate the decomposition  most market practitioners use
only the first two components  and it is this convention that
is adopted in this project  it is also common to scale the two
component vectors by their associated volatility  so define



        
f   u  u 
   
on the t     day  the least squares solution of dt     f w 
can be computed as w    f t f    f t dt   giving the
weights of the first two components  w        due to
the scaling applied to f and orthogonality of u we expect
w  n     i  
having computed the weights on each day  this time series can be input to the previous leela algorithm  the performance with n       and p     returned sharpe ratios
of around      a deterioration in performance 
rather than looking at factors  component residuals can
also be examined  the residuals are simply dt    dt    
these residual time series  one for each swap maturity  can
then be input to the leela algorithm  with n       and
p      the results are plotted in figure     and summarized
in the table below 
year
 
 
 
 
  

sharpe ratio
   
   
   
   
   

while the  y swap shows promise  the residual itself is
not a trade able instrument  trading the  y swap outright
returns a sharpe ratio of close to zero  the best way to
trade a residual is using a butterfly trade  if the algorithm
signals to buy the  y swap  the trader actually buys the  y
swap and sells the  y and   y swaps  with the amount of
each swap dependent on the nullspace of f  so that the exposure to the first two factors is zero 

fifigure    trade performance based upon pca residuals  again 
the sharpe ratio is the most important metric rather than largest
absolute return  the sharp spikes at the end of the time series are
associated with the very recent market turbulence associated with
bank insolvencies 

figure    training results for   y swap trade  return and sharpe
ratio vs  correlation window 

the strong performance of the  y may not be a fluke
of the data  one of the motivations for this report was the
action of mortgage servicers hedging risk  the traditional
duration of us mortgages is between five and ten years and
many servicers use seven year instruments to hedge their
duration exposure  the market is not deep enough to fully
absorb the supply and demand  creating a dislocation  this
dislocation is characterized by a high residual in the  y
point  which was shown to mean revert over a short period 

   results
the proposed algorithms were trained on the same market period  from approximately      to late       this was
to ensure that all algorithms are exposed to the same market conditions making the results directly comparable  the
year from late      to late      was used as test data to
verify algorithm performance  the algorithms were trained
for correlation window as this was the fuzziest parameter to
determine  initial tests showed that the three day correlation window was superior for our algorithms  varying the
correlation window produced less convex results  testing
the data with a wide range of windows ensures we did not
optimize for a random local maximum 
the algorithms were therefore compared with two goals 
first  to find the correlation window with the largest sharpe
ratio  and second to compare the yearly variation in ir   
  this project focused on empirical maximization of sharpe ratio  an
excellent theoretical treatment can be found in choey  m   weigend  a
  nonlinear trading models through sharpe ratio maximization international journal of neural systems                     

figure    best single and multi swap trade return and yearly ir
     day correlation window 

     correlation solely with   y swap
for the   y swap  figure    shows that as the correlation window increases the performance tends to increase 
but with a sharpe ratio typically below      this is a decent result  and can be attributed to the character of the data 
using solely the   y data  noise is likely to be a greater factor  our data can be thought of as pseudo random vectors of
length    correlation between random unit vectors increases
with decreasing length  thus a longer correlation window
allows us to average out the noise incipient to a short feature vector  this still does not provide a great sharpe ratio  however  and figure    shows that the sharp ratio is
fairly variable with time  though these sample location do
not show any losses 

fifigure    training results for multi swap trade  return and
sharpe ratio vs  correlation window

figure    training results for pca trading  return and sharpe
ratio vs  correlation window

     correlation on  y to   y swaps
for the multi swap algorithm  figure    shows that performance peaks at a correlation window of around     days 
with a sharpe ratio of more than      this is a good and
interesting result  as it indicates that the relation between
the swaps changes with time  the algorithm weakens when
correlated for much more than one and a half years  and the
trade performs well over subperiods 

     correlation using pca
pca analysis has the strongest and most consistent correlation between performance and correlation window  with
a peak at a sharpe ratio greater than    figure      this
is an excellent result for an automated program  this performance characteristic is likely due to the change in pca
components with time  as shown with multi swap correlation  the market character changes with a characteristic time
on the order of a couple years  therefore  pca components are likely to change enough that comparison of residuals will no longer be apples to apples  figure    shows
that the yearly sharpe ratio performs at a consistently high
level  with only one outlier with negative returns 

conclusion
this project has shown that machine learning algorithms
are able to generate trading rules that exhibit high ex post
sharpe ratios  while the simplest linear methods produced
poor results  a correlation algorithm closely related to autoregression was shown to produce very strong returns  furthermore when the data was preprocessed using principle
components analysis  the performance moved into a level
warranting serious attention by technical traders 

figure    best peforming pca trading  return and yearly ir     
day correlation window 

future work
the algorithms presented in this paper are not tied to interest rate swaps  and are transferrable to other classes of
financial instruments that exhibit similar properties  specifically  the collection of instruments must be highly correlated but still exhibit temporary departures which create the
trading opportunities  the most obvious extension is to
similar fixed income classes  such as treasury  corporate  or
mortgage debt  however in building a well balanced book 
the portfolio manager would like to be active in as many uncorrelated markets as possible  one of the most natural markets to examine would be the g   currency markets  like
rate swaps  currency markets offer liquidity and low margin
requirements allowing for easy trading  other applications
would lie in a basket of energy futures or precious metals 

fi