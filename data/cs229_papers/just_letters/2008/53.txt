uncertainties estimation and compensation on a robotic manipulator 
application on barrett arm
duong dang
december         

abstract

the control term is given from the traditional pd
controller

in this project  two different regression methods
u   qd   kv  qd  q    kp  qd  q 
   
have been used to estimate the joint friction and
gravity  inertia estimation error on a   degree of
where qd is the desired trajectory  if there is no
freedom barrett robotic arm  using these estimations  appropriate compensation terms have been friction and all the terms are estimated precisely
added to the servo loop to achieve an improvement  i e  a   a  b   b  g   g   from            and
     we will have
of a factor of    in tracking error 
e   kv e   kp e    

acknowledgement

therefore the error e   qd q will be asymptotically zero  in the real world however  it is difficult
to estimate all the dynamic parameters precisely 
a frictional term f must be added to the right
hand side of       we then have

i would like to thank quoc le for his advice and
a number of discussions on this problem and on
machine learning in general during the quarter  i
also would like to thank the ai lab for providing
the barrett arm for this project 

 

e kv e kp e   f  q  q  q    a   aq b g ff  
   
where a  b and g are estimation errors of
dynamic parameters a  b  g 
to learn the function f  q  q  q   we can give the
robot a desired trajectory  at each time stamp
t i    we record  q  i    q  i    q  i    and compute f  i  by
formula       we then run a non parametric regression on the training data  the output will be
the prediction f  at any state  q    q    q   

problem statement

the objective of this project is using learning to
estimate the friction and uncertainties in dynamic
parameter of the robot  this estimation will be
used as a compensation term to be added to the
pd controller 
the equation of motion of a manipulators consisting of n links is given by    
   a q q   g q    b q  q 

   

 

where q  q and q are a n dimension vector representing the joint angles velocities and accelerations  a  g  b represent the inertia matrix  gravity term and centrifugal and coriolis terms  the
torque  is computed based on a control signal u
and the estimations of a   g and b
   a q u   g q    b q  q 

   

uncertainty characteristics

friction is a non linear  discontinuous function
of q  several frictional models exist in the literature      the simplest way is a constant force
 coulomb friction  always against the movement 
a more complicated model of the friction     include coulomb friction  viscous and stribeck effect
     figure      one thing to be noted is that all the
 

fifrictional model shares a same propety  that is     choice of trajectory
friction force  and therefore torque  is a asymetric
in this project  the goal is to learn the function
function of q
f in equation      and extract individual uncertainty terms to find the joint friction profile and
mass offsets  in general  f is fairly complicated 
especially  the first uncertainty term depends on
both q and q  that would make it difficult to extract separate uncertainty terms in the end 
the trick here is to choose a sinusoidal function
qd   c    c  sin t  as desired trajectory  with
this setup we have qd   c     sin t   we then
can approximate q       q  c     the uncertainty term aq now only depends on q 
for the sake of simplicity in the problem we asfigure    a complex model friction
sume that b is negligible compare to other uncertainties  this is not a bad assumption since b
itself is usually small compared to other terms 
gravity and inertia estimation error come
with the choice of trajectory and assumption
from incorrect estimate of joint masses and po  above  equation      can be written as
sitions of center of mass  g and a are only
function of q
a e   kv e   kp e    f  q  q    ff  q    fm  q     
coriolis and centrifugal forces estimation
error depend upon both q and q  

 
   

where both ff and fm are non linear function 
non parametric of q and fm   ff is a asymmetric
function of q  this fact help us to separate the
terms in the right hand side of      after doing
regression 

experiment setup
barrett arm

 

results

   

gaussian process regression

given noisy observations
d    x  y  

   

gaussian process regression     predicts the mean
 and covariance  at patterns x  as follow


   k x  x    k x  x       i y and


   



   k x   x  

 
 k x  x     k x  x       i
k x  x   
   

figure    sources of uncertainties on barrett arm

two main sources of uncertainties on the barrett arm in this experiment are several sensors
with unknown mass mounted at the hand and joint in our problem  x and x  are  n  m and  n  k
matrices represent the training set and the query
frictions 
 

fipoints 
x    x          x m    
    



x    x

x    q        qn q        qn  t

  m 

   x

  



x  

 q        qn q         q n  t

training examples
gaussian proccess prediction

 

 

the label vector y is the column vector of the value
found in      
f

 

y    y           y  m   t  

y   f   where    n        i 

 

 

 

k x  x   k x  x    and k x    x    are respectively m  m  k  m and k  k matrices corresponding to a gaussian kernel 

   
 

 
   

   
 

   

 

   
   

 

   

   

q

dq

k x  x ij   exp  x i   x j   t  x i   x j    

figure    regression after detecting and removing
k x  x   ij   exp  x   i   x j   t  x  i   x j     outliers       training examples 
k x    x   ij   exp  x  i   x  j   t  x  i   x  j    
kernel covariance matrix  is a diagonal matrix error   i   f  i   at all points  all the outliers
should have a large error  we can then discard the
that we choose 
training examples with highest error  say      of
      robust regression  outliers detection the total data set  figure    show the improvement after removing outliers 
training examples
gaussian proccess prediction

     

hyperparameters selection

to optimize the hyperparameters  the leave oneout cross validation technique has been used     
 
in this experiment  only joint   is chosen to move 
 
all other joints are fixed  x    q  q   t    we need
to optimize three hyperparametters  the noise
 
level   and the bandwidths   and     for each
 
set             the data is randomly divided into
 
   trunks then choose each of those trunks as test   
 
ing points with the other nine as training data
   
 
   
   
 
   
set  the total error is computed with  rang 
   
   
 
   
q
ing from      to     and      ranging from     
dq
to      the approximate optimal parameters are
figure    naive gaussian process regression on                  and        
initial data set       training examples 
f

 

   

apply the naive gaussian process regression
does not provide a good prediction of uncertainty
f   figure      the reason is outliers affect
greatly gaussian process  as a result  we need
to clean up the data before doing regression  to
detect outliers  we set x    x and do regression
with large bandwidth  after that we compute the

support vector regression

the technique in section    does a decent job removing outliers in our particular data set  however  in general we do not know a priori the portion of outliers  therefore  in fixing the portion of
data to be removed  we might not remove all the
outliers in some cases or discard too much useful
 

fidata in others  instead of gaussian process  a support vector regression can be used to reduce the
influence of outliers 

training examples
gaussian proccess
support vector regression

 
 
 

f

 
 
 
 
 
 
   

   
   

figure    the soft margin loss setting for a linear
svm  from     

   

 

 
   

   

   
   
 

dq

the key idea is finding the optimal line  in feature space  through the data set  with a loss function define in figure    writing the optimization
problem and using the kernel trick  the dual problem can be written as
 
p
    li j    i  i   j  j k xi   xj  
maximize
p
p
 li    i   i     li   yi  i  i  
    
subject to

l
x

   

q

figure    comparison between gaussian process
regression and support vector regression on a noisy
data set 
ff is an asymmetric function of q  therefore
 
 f  q  q    f  q  q  
 
ff  q    f  q  q   fm  q 

fm  q   

 i  i       and i   i      c 

    
    

i  

use equations      and      to the prediction
where x and
are training examples and testing in section    and     we obtain figure    and    
points k is a gaussian kernel as in section     each line in figure     correspond to a fix value
and c is the parametters of our choice  the pre  of q in equation      
dictions are
x

   

f  x   

l
x

gravity and inertia estimation error

 i 

i  k xi   x 

 b

   

    

   
delta g  n m 

i  

where b is determined by the support vectors     
to solve problem      i used cvx  a package for
specifying and solving convex programs        
figure    shows that support vector regression
 red line  is much less sensitive to noise than gaussian process regression  green line  

   
   
   
 
   

   

   

   
q  rad 

 

   

figure    gravity and inertia estimation error

   

friction profile and gravity  inertial
estimation error

one should note that if the friction profile found
in figure    is inherent to this particular joint
to extract the contribution of ff and fm to the and will not depend on trajectory  the gravity total uncertainty in       we can use the fact that inertia estimation error found here is it is based
 

fi 

    
 
position error  rad 

delta g  n m 

   

 

friction profile
   

 
 

   

 
dq  rad s 

   

    
    
    
    
   

 

    

figure    friction profile

without compensation
with compensation terms
 

  
t  s 

  

  

figure    tracking error with compensation terms
on assumption of sinusoidal trajectory and is valid
only for this class of trajectory 
references
in our particular case  it is possible to make
these estimations trajectory independent  we     andrew ng  machine learning cs    lecture
notes 
know that the g and a come mainly from the
mass of various sensors mounted on the robots
hand  we can then estimated thisfimass by the pre      alex j  smola  bernhard scholkopf a tutorial
on support vector regression statistics and
diction of fm at q      fm  q  q fiq     g q   
p
computing       
mgl  where m    msensor and l is the
moment arm from the gravity force to joint   at     oussama khatib  introduction to robotics 
the given point  the resulting offset is m  
cs   a course reader 
             kg 
    c  e  rasmussen   c  k  i  williams  gaussian processes for machine learning the mit
    validation
press      
having found the friction profile and the mass off      h  olsson k j  astrom c  canudas de wit m 
set of the arm  we can run a trajectory with the
gafvert p  lischinsk friction models and fricappropriate compensation terms  figure    show
tion compensation eur  j  control  vol     no 
the improvement made by the compensation term 
   pp                
a sinusoidal trajectory at different a frequency
     rad s  has been used for validation  the     m  grant and s  boyd  cvx  matlab software
for disciplined convex programming  web page
maximum tracking error has been reduced from
and software   http   stanford edu  boyd cvx 
     rad to       rad  or a factor of    
december      
    m  grant and s  boyd  graph implementations
for nonsmooth convex programs  recent advances in learning and control  a tribute to
both regression methods work well with the probm  vidyasagar 
lem  support vector regression is not sensitive to
noise so does not requires preprocessing data  the
    v  blondel  s  boyd  and h  kimura  edcompensation terms reduces significant tracking
itors  pages         lecture notes in conerror  the next steps will be estimating frictions
trol and information sciences  springer       
and mass error for all joints and use the compensahttp   stanford edu  boyd graph dcp html 
tion terms in the next version of the barrett arm
controller that i am helping develop 

 

future works

 

fi