a predictive model of gene expression in e  coli
brendan odonoghue  evan rosenfeld
advised by profs  markus covert and daphne koller
project for cs      stanford university  fall        
december         

 

introduction

anomalies which could confound our findings  a php
script was written to correct for common data entry mistakes such as frame shift errors and to prepare the data to
be imported into matlab  e  coli transcription factors
were identified from a separate database  the transcription factors were removed from the dataset and placed in
a separate matrix  experiments or genes that were missing more than     of their total data were removed from
the dataset so that they would not bias the biclusters  it
was necessary to normalize the data along the experiment
dimension because different technicians and different labs
introduce significant variation into the collected data  normalization is an attempt to remove some of this variation 

the transcription and expression of genes in organisms are
primarily moderated by transcription factors  a wealth of
gene expression data on e  coli  recorded under various
experimental conditions  have been collected by the scientific community  using this data  a model was trained
to learn the relationship between transcription factors and
gene expression  bonneau et  al  demonstrated that this
type of analysis was possible using a smaller subset of genes
on h  salinarum nrc        in this paper we show that
their method is generalizable to other organisms and can be
extended to a nearly complete genome  their work was further extended by using novel machine learning techniques 

 

   

motivation

initially  hierarchical k means clustering was run on the
dataset to identify co expressed genes along a subset of
experimental conditions  it was later decided that coexpressed genes are not necessarily co regulated  as this
paper seeks to explore transcription factor regulation of
genes  a more advanced technique was required to identify
co regulated genes 
biclustering is a method for simultaneously clustering
along the rows and columns of a matrix to find highly correlated subsets of rows and columns within a dataset  church
and cheng have proposed that biclustering is a more biologically relevant form of clustering     for co regulated network discovery  the variation of biclustering employed in
this paper worked as follows 

covert et  al  demonstrated that the steady state concentrations of metabolites in a cell can be predicted to a reasonable level of accuracy using a computational metabolic
network with boolean constraints      accuracy of the predictions may be improved by removing the inflexibility of
boolean constraints and replacing them with functional
constraints from our predictive model  furthermore  the
boolean constraints were developed by hand from gene expression and literature data  the method presented in this
paper automates discovery of relationships between gene
expression and transcription factors  these relationships
can be used to replace or augment boolean constraints 

 

methods

   a random subset of genes and experimental conditions
is chosen as a seed bicluster

gene expression data was collected for approximately     
genes across approximately      experimental conditions
from the university of oklahoma e  coli gene expression
database     

   

biclustering

   let b be the set of rows in the bicluster  the
variances of all columns in the dataset and the means
of all columns using only the rows in b are found 

data preprocessing
j  

data preprocessing is an important step which aggregates
the data into a standard format and corrects for data
 

i
 x
mij
i i  

fiattach to it a smaller coefficient  therefore  we would not
identify a relationship between the smaller scaled gene and
the signal  by using the pearson correlation coefficient distance metric  we have a higher probability of identifying
correlated but scaled genes as important regressors of the
signal 
the transcription factor signals in the clusters are then
averaged 
next pairwise minimums of all of the cluster traces were
generated  the minimum of two continuous functions is
the continuous analog of the boolean and of two binary
signals  by incorporating the ands and the signals themselves  the continuous analogs of or and xor can also be
generated as shown in the table below     

i
 x

j   

i

 mij  j   

i  

j    

 x
mij
b ib

   a z score is calculated for every element in the
 

dataset  zij  

mij j
 
j

   z scores are transformed into probabilities p xij  b  by
integrating the two tails above and below  zij   of a
standard normal distribution  the values represent
the probability of each element being in the bicluster
given the current bicluster composition 

min a b 
a
b

   elementwise products are taken across rows and
columns to generate the probabilities of the rows and
columns being in the bicluster 

p xj  b   

y

y

p xij  b 

j

   these probabilities are compared to a random number
to select rows and columns to be included into the
bicluster based on an annealing schedule 

   

xor
  
 
 

regression

in order to test our regression models  holdout cross validation was employed  regression was performed on    
of the bicluster averages  and the remaining     was used
to test the regression model  regressions were performed
in two steps 

   steps   to   are repeated until convergence  when the
rows and columns of the bicluster do not change 
the biclustered genes traces are then averaged to produce
one signal to be regressed on  this reduces the noise of the
signal to be regressed  as co regulated genes should have the
same expression level under their co regulation conditions 

   

or
  
 
 

there is a problem that arises from this table  because
the    regularization penalizes each coefficient  xors and
ors are more expensive to include than ands  an attempt was made to incorporate ands  ors and xors as
their own variables in order to solve this problem  but this
process was too computationally intensive 

p xij  b 

i

p xi  b   

and
 
 
 

   a standard least squares regression was performed to
identify a parameter vector unc
minimize krunc  sk   

generating regressors

in order to reduce the dimensionality of the problem the
transcription factors were clustered using k means clustering  within k means  the pearson correlation coefficient
distance metric was used instead of the more common   
norm  this is because the goal is to cluster correlated
genes  two genes that are perfectly correlated but scaled
may have a larger    distance than two genes that are not
as well correlated but of similar range 
it was desirable to cluster highly correlated genes because the regressors generated from this process were used
in an    regularized regression  if two genes are perfectly
correlated but scaled versions of each other  the    regularization will pick out only the larger one because it can

where s is the training subset of the bicluster average
and r is the training subset of the matrix of regressors 
   a least squares regression with     regularization is
performed 
minimize krc  sk 
subject to kc k   tkunc k 
these objectives are all convex and as such can be easily
solved with a standard convex solver         at the end
of this process  with the appropriate value for t   only the
regressors that best explain the data will be active  it is
 

fipossible to perform a third regression on these active regressors without a constraint term to find the optimal values
for the active regressors  this is called polishing  however 
polishing was not found to significantly improve the results 
thus rc   s becomes our best fit estimate of the signal 
s 

 
gene expression level log ratio

   

bliclustered genes and conditions
   

measures of goodness

three measures of goodness were used to evaluate the accuracy of the regressions on the test set 

   

 

   

 

ks  sk  
  a normalized squared error ratio 
ksk  
when          the regression predicts the signal
to some degree 

   

     

 

  

  
  
experimental condition number

  

   

bicluster heat map
 
 

    s s   the standard cross correlation between s and
s 

 
 

 
n ks

   m se  
regression 



sk    

the mean squared error of the

 
 
 

 

 

results

 

after preprocessing  the dataset comprised of      genes
across     experimental conditions and     transcription
factors  k means clustering resulted in approximately    
clusters of transcription factors  depending on the particular bicluster  these were converted into approximately
       regressors  including a constant regressor  which was
not subject to the    regularization 
an example bicluster with    genes across     conditions is shown in figure    as you can see  the biclustering
algorithm has selected a highly correlated subset of genes
across a subset of conditions  the genes selected by this
bicluster were yeim  hyfe  hyfg  pbpc  ygdb  ygex  hofq 
sgbh  ulag  and ulaa  these genes show an enrichment
in e  coli  energy metabolism and transport  although
many were not yet classified  the results of the regression
selected several transcription factors that were suspected
regulators of many of the biclustered genes  as well as new
ones that may play an active role not yet discovered experimentally 
it was noted that many biclusters were similar  even with
different random starting conditions  this is due to the fact
that many genes and conditions are quite dominant and are
repeatedly selected by the algorithm 

  
  

  

  

  

  

  

  

  

  

   

figure    example bicluster with    genes across     conditions 
figure   shows the results of the regressions on the training and testing signals of the bicluster in figure   with
less than      of the regressors active  in the top subfigure  samples to the left of the green line are the training
set  samples to the right are the test set  the regression
typically produced excellent results  for this regression in
particular                     and mse          
overfitting of the training data is always a concern in
learning applications  figure   shows the bias variance
trade off as a function of the regularization constant  t  as
t increases  the training error decreases to zero as the variance of the regression predictions overfit the training signal 
at the same time  the testing error initially decreases as
the regression learns the underlying relationships between
the regressors and the training signal  but then the testing
error increases as the high variance of the prediction de 

fitradeoff curve
    
training error
testing error

    
    

error

    
   
    

signal and prediction traces
   
   
gene expression level log ratio

    

signal
predicted output

    

   
    
   
 
 

   

   
   
tvalue for l  norm constraint

   

 

   

figure    bias variance trade off curve

   
   

creases the ability to generalize  there is an optimal point
where the training data is neither overfit nor underfit  and
the testing error is minimized  this occurs around      for
this bicluster 
figure   shows some other bicluster signal and predicted
outputs  by comparing to figure   we observe the dominance of certain genes and conditions that appear in many
independent biclusters 

   
 
   

 

  

  
  
experimental condition number

  

   

signal and prediction traces for test set
signal
predicted output

   

gene expression level log ratio

 

   

 

   
 

in this paper  we have demonstrated that it is possible to
take freely available data and to generate an accurate predictive model of gene expression using only transcription
factor data  many of the genes in e  coli   and other
organisms  have not yet been classified  the methods presented in this paper can provide clues for gene function
classification both by the bicluster a gene belongs to and
the predicted output of expression data under various conditions 
on top of this  the functional relationships that we have
discovered between gene expression data and transcription
factors can potentially be used to replace the boolean constraints in the e  coli metabolic network of covert et  al    
we have also shown that bonneaus work on h  salinarum
nrc   can be performed on nearly complete genomes of
other organisms 

   
   
   
   
 
  

  

  

  
  
  
  
experimental condition number

  

conclusions

   

figure    regression onto training  left  and testing signal  above   close up of testing signal  below 

 

further work

the methods presented in this paper are a good first step
to explain expression data  there are several other consid 

fierations that would extend this work 
in order to improve the accuracy of the biclustering algorithm  transcription factor binding motif data and priors based on other network connectivity models could be
incorporated  a penalty factor could also be incorporated
to prevent dominant genes and conditions from repeatedly
entering biclusters 
the and  xor  and or signals could be represented as
single regressors to remove the    bias that makes xor and
or more expensive to incorporate into regression models
than and 
it is important to consider what factors are regulating
the transcription factors  it is possible that one transcription factor is regulating another  or both are being
co regulated by a third  confounding transcription factor 
due to these uncertainties  the causality of predictions generated using the model in this paper should be examined
further 
transcription factors are not the sole regulators of gene
expression  environmental factors play a strong role too 
any full predictive model would have to incorporate these
data to be accurate and robust 
finally  it is important to experimentally validate any
predictions generated by this model 

signal and prediction traces

gene expression level log ratio

   

 

   

 

   

 

 

  

  
  
experimental condition number

  

   

  

   

signal and prediction traces

gene expression level log ratio

 

   

 

   

 

   

 

  

  
  
experimental condition number
signal and prediction traces

   

references

gene expression level log ratio

   
   

    r  bonneau  et  al         a predictive model for transcriptional control of physiology in a free living cell 
cell      pp            

 
   

    m  covert et  al  regulation of gene expression in flux
balance models of metabolism  journal of theoretical
biology                  

   
   
   
 

 

  

  
  
experimental condition number

  

    oklahoma university e  coli gene expression
database  available  http   genexpdb ou edu  

   

signal and prediction traces

gene expression level log ratio

   

    cheng y  church gm         biclustering of expression
data  proceedings of the  th international conference
on intelligent systems for molecular biology        

 

   

    r  bonneau  et  al         the inferelator  an algorithm for learning parsimonious regulatory networks
from systems biology data sets de novo  genome biology   r  

 

   

 

 

  

  
  
experimental condition number

  

    s  boyd  l  vandenberghe  convex optimization  cambridge univ  press        

   

    m  grant and s  boyd  cvx  matlab software for disciplined convex programming  web page and software  
http   stanford edu  boyd cvx  may      

figure    signal and prediction traces for various biclusters  the blue trace is the signal and the red trace is the
prediction  samples to the right of the green line are the
validation set 
 

fi