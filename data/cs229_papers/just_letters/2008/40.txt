predicting dgeometricshapesofobjectsfromasingleimage

tamerahmeddeif  savilsrivastava



cs   finalreport

introduction

automaticallyreconstructingasolid dmodelfromasingleimageisanopen
computer vision problem  fully automatic solutions such as make d     and
photopopup   areonlyabletomake   dmodelsfromimages ontheotherhand 
   areabletousemanualintervention namely drawingedgesoftheobject and
symmetrytoreconstructthe dshape thisworkattemptstousemachinelearning
to learn the solid  d structure of an object in an image  it assumes objects can be
brokenintobuildingblocksofcuboids pyramids etc wewereonlyabletomanage
toinvestigateforthecaseofcuboidalonlyobjects 
ourapproachisasfollows weposethelearningofedgesoftheobjectinthe
imageasalinearregressionproblem weusetheseedgestopredictwhatkindof
 d cuboidal shape could have given the object its particular  d projection in the
image  this is defined as an energy optimization problem  which is solved by
gradientdescent 

dataset 
ourdatasourceisgoogle dwarehousesketchupmodels thereareseveral
motivationsforthatchoice amongstwhichare 
thefreeandabundantavailabilityofdata 
themodelsrepresentactualbuildingsandtheyareratedbytheirquality so
realisticmodelscanbechosen 
 themodelsallowfutureextensionoftheprojectformorecomplex aswellas
noncuboidbodies 
 modelshadtexture whichcanbeusedtogivethe dmodelamorerealistic
look 
 googlesketchupallowstomanipulatethosemodelsandlookatthemfrom
differentangles aswellas takesnapshotsfromdifferentviewangles which
translatesinto dinputimagesforthealgorithm 

in order to prepare our data set  we downloaded    models of different buildings
fromgoogle dwarehouse wealsowrotearubyscriptthattakes differentsnap
shotsofthemodelfrom differentviewingangles intotalwehad    different d
images eachofsize   x   pixels  sketchupallowsitsuserstoremovetexture
andshadowsfromthemodel soweexploitedthesefeaturestotakeanadditional
snapshotateachofthe positionswithonlytheedgesofthemodel referfig    
theseextraimagesrepresentthegroundtruthdatafortheedgedetectionlearning
algorithm 



fi



fig  showsthetexturedimageofthe dmodel theedgemapthatwegeneratefromsketchuptouseas
groundtruthdata andtheedgemapwedetectafterlinearregression

methodandresults 
part  significantedgedetection
wedesignedfeaturesandperformedlinearregressiontodeterminethegeometrical
shapeedgesoftheobjectintheimage inparticular foranypixelwewanttoclassify
itaseitheredgeornonedge 
weselectivelysamplewhichpixelstotrainon sinceconsideringallwouldresultin
alargefeaturematrixwithwhichmatlabwouldrunoutofmemory currently we
are sampling     edgepixels and    of nonedge pixels  our final sample has a
ratioofedge nonedgepixelsof    
last theresultofthelinearregressiongivesuspredictionsonwhetherthepixelis
edgeornotasarealnumberintherange      foreachimage weadaptivelyselect
whatthresholdtouse forclassifyingasedgeornonedge bychoosingthethreshold
thatminimizestheerror 
the following table summarizes the average overall error for training  cross
validationandtesting 
features error 
y cb cr
y cb cr hough
y cb cr hough 
percentage


training
    
    
    

crossvalidation
    
    
    

testing
     
   
   

fifeaturesandresults
we consider     features for any given pixel  first  we consider a  x  pixel
neighborhoodpatchinycbcrcolorspace thisistheabletocapturethedifference
in luminance  and blue red color space  for luminance  we consider a  x  patch
andforthecolorcomponentsa x patch thissmallerpatchwasconsideredsince
matlabwouldrunintomemoryissueswhiletrainingonthisdata thetrainingand
testerrorforthisisshowninfigure  

fig  falseandpositiveclassificationserrorfortraining totheleft andtesting tothe
right datawhenusingy cb crfeatures

wethenconsideredaddingtwomorefeatures whichhadamoreexplicit
relationshipwithedges 
  considerwhetherthepixelliesonahoughline forthis ahoughtransformwas
doneoneachinputimageandthe mostlikelytobelineswereselected pixels
lyingtheselinesweretaggedwiththisfeature 
  percentageofedgepixelsinthe x neighborhoodpatch 
theresultsfromthiscanbeseeninfig  andfig   


fig  falseandpositiveclassificationserrorfortrainingandtestingdatawhenusingy cb crand
houghlinesfeatures

fi
fig  falseandpositiveclassificationserrorfortrainingandtestingdatawhenusingy cb cr hough
linesandedgepixelspercentageastheinputfeatures

we note that we are most interested in lowering the false positive rate  the false
negativeratecanbetoleratedtobehighbecause   thegroundtruthlabelshave
thickedges   losingafewoftheedgepixelsdoesnotaffecttheenergyfunctionin
part asmuchashavingnoisypixels 

methodpart  cuboidfitting

inthisstep wepredictwhat dcuboidcouldhavebeenprojectedontotheimageto
give the object shape  as determined by the edges predicted in method part     a
parameterized  d cuboid is projected onto the image plane with correct
perspective  and we calculate an energy function based on this projection  we
generatethisenergyfunctionbyblurringtheedgeimagegeneratedinpart such
the maximum energy lies on the actual edge pixels  then we perform gradient
descentonthefollowingfunction 


the problem of optimizing this function suffers from a lot of local minima  hence
whatweinitializetheparametersourcubetoiscrucialtosuccess tomitigatethis
problem  we run gradient descent initially on    different sets of initialization
parameters for   iterations  we then pick the    best models  and perform more
iterations  we repeat this funnelselection method till we get the most optimal
model from our    initializations  as seen in fig    below  where the initialization
wasdoneautomatically theoptimizationfallsintolocalminima 


fi

fig  fittingstuckatalocalminimum



however insomecases theoptimizationisabletosnaptheinitializedpredicted
modelontothepredictededges fig    








fig  wheninitializedclosetotherightpositionofthebuildingitsnapsinandfitsaccurately


we also tried adding an extra energy term  proportional to the number of edge
pixels the cuboid was on  however  in our tests this resulted in less optimal
solutions 

limitationsandfuturework


thecuboidfittingstepfailsforanumberofreasons 
  theenergyfunctionhasalotoflocalminima 
a  currently  when we project the cube onto the image  we draw all
the edges of the cube  however  by calculating which side of the
cuboidisvisibleandonlyprojectingtheedgesofthosesides wecould
haveabetterenergyfunction 

b oncewehaveafinalresult thenonecantryperturbingitandsee
whetheritsnapsbacktowhereitwasoriginally 


fi   while the algorithm can predict edges from the input well  it has a false
positive rate that can results in quite a few nonedges being classified as
edges  this noise affects the energy function and even when the cube is
initializedsuchthatitshouldreasonablysnapintoplace 


furthermore  in the edgelearning phase  the artificial   sketchup model  images
that we test on have only one object of prominence in the image  for real images 
there may be more peripheral objects whose edges also get detected  one would
havetodesignauiwhereausercanindicateregionofinterest roi andconsider
edgesonlywithinthisroi 


acknowledgments
wethankashutoshsaxena christiantheobaltandsiddharthbatrafortheir
guidanceandhelpfuldiscussionswhileplanningtheproject 

references
  asaxena msun aynglearning dstructurefromasinglestillimage 
computervision      iccv     ieee  thinternational     
  dhoiem aaefros mhebert automaticphotopopup proceedingsofacm
siggraph         
  pedebevec cjtaylor jmalikmodellingandrenderingarchitecturefrom
photographs ahybridgeometryandimaproceedingsofthe  rdannualconference
oncomputer     


fi