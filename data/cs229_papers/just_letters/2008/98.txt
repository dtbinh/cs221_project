cs     final projet
ocr using an unsupervised hidden layer
kevin shan
          

 

bakground

optial charater reognition  ocr  is a supervised learning problem in whih we wish
to ategorize letters based on similarity to a training set  ideally  this measure of similarity should be invariant to  allowed  distortions with onstraints suh as ontinuity or
monotoniity 
one partiularly interesting approah that is the subjet of ongoing researh is elasti
mathing  whih does exatly that  in a typial appliation  the sample image is warped to
math a referene image  and either a ost funtion of the warping funtion or a onventional
distane metri applied to residual error is used to measure the similarity between sample
and referene images 
however  it has been shown  that elasti mathing is an algorithmially hard problem
with exponential time solutions 
 

motivation

one alternative to true elasti mathing is shape normalization and gaussian blurring 
in our ase  shape normalization involved finding the smallest bounding box and reshaping it to square proportions  this yields normalized images that are invariant to translation
and saling on the oordinate axes  and also in funny artifats on sans serif  i s  whih are
strethed into squares  
gaussian blurring is a simple and nonspeifi way to inrease generalizability  to make
our training feasible  we also redued the size of the normalized image to        pixels 
yielding a     length feature vetor 
our training sets omprise    omputer fonts in    different rotations     haraters
per set  and    sets of handwriting samples from   different people using various pens    
 

ficlassifier
base fonts unrotated all fonts handwriting
linear svm trained on base fonts
   
    
    
    
lms trained on base fonts
   
    
    
    
lms trained on unrotated fonts
   
   
    
    
lms trained on all fonts
    
    
    
    
lms trained on handwriting
    
    
    
    
table    error rates     of various lassifiers on various test sets  note that our feature
spae is a     element vetor and the test sets are                     and       haraters
long  respetively 
haraters per set   subsets of the omputer fonts inlude  base fonts   whih is a seletion
of    very popular fonts  and  unrotated fonts   whih is the    fonts without rotation 
we tested on many ombinations of training and test data to get an idea of the generalization error of this approah  unfortunately our ability to train svms was limited
the availability of cpu yles  so we were only able to train one very limited linear svm 
though ideally we would have liked to train an svm with a gaussian kernel 
table   lists the results from our testing  while the shape normalization artifats with
the sans serif  i s surely aount for some of the error  that effet is limited to             
nor is it an issue of training set size  as we an see from inreasing the training set 
so it seems that linear lassifiers operating on shape normalized data just aren t very
good at the ocr problem  motivating us to look more losely at elasti mathing 
 

approah   density estimation

although there are numerous approximations to the elasti mathing problem that utilize
dynami programming to make the problem feasible      we will approah this in a different
way 
we will treat the image as a probability density funtion where the relative intensity of
eah pixel  x  y   is the relative probability of that  x  y    then fit a mixture of gaussians
to this density distribution  the parameters  of that gaussian fit onstitute our  density
estimate  
figure   shows a summary of this proess ow  in this example  we have taken an
unproessed     x     greysale image  note that we haven t even ropped out the exess
whitespae  a task that is not trivial in pratial handwritten harater reognition   approximated it using a mixture of    gaussians  and then reonstruted from the density
estimate to verify that the method works 
one minor hange to the mixture of gaussians distribution that we tried was foring
all gaussians to have the same radius of minor axis  this ould be interpreted as a global
 

 

fifigure    density estimation proess  we start with the original image    a    fit a mixture of gaussians to the pixel intensity distribution using an expetation maximization
algorithm    b    and finally we an verify the result by inspeting the reonstrution of
the original image using the density estimation parameters      
line width parameter  unfortunately  this algorithm did not onverge well for serif fonts 
whih typially use a variety of line widths per harater  so we abandoned it in favor of
the less onstrained mixture of gaussians model 
to evaluate the reliability of these reonstrutions we ran the density estimation algorithm on our    fonts and    handwriting samples and ompared the reonstruted images
to the original samples  figure   shows the result of this analysis on an alphabet byalphabet basis  rather than a harater by harater basis  
visual inspetion of the failed ases shows that the issue is not typially failure to
onverge but rather utuations in density due to the unevenness of gaussians ompared
to the at zero one pixel intensities found in the font samples 
 

disussion

we an tell  at least qualitatively  that the density estimation parameters apture muh of
the relevant information in the original image 
however  we have redued the dimensionality of the image signifiantly  from a         
greysale image to k      sets of density estimation parameters in r     eah desribing a
gaussian distribution 
seond  we vetorized a raster image  now saling rotation translation transformations are all ane operations  these operations would otherwise require resampling with
interpolation  
these two effets make subsequent operations muh faster  allowing for a wider range
of iterative lassifiation algorithms  inluding elasti mathing 
 

fihistogram of deoriginal correlations
  

  

frequency

  

  

  

  

 

 
   

 

   

   

   

   
   
correlation

   

   

   

figure    histogram of orrelations between original alphabet and alphabet reonstruted
from density estimation
for the ocr problem  it would be ideal to use elasti mathing as a determinant
funtion and an svm for the top layer lassifier  for example  we ould use the warping
ost funtion or post warp distane as a kernel funtion for an svm kernel 
although we inur a overhead due to the expetation maximization algorithm  it transforms our data into a form that is muh easier to work with  for example  in a regularized
svm operating in a high dimensional feature spae  we expet to have many nonzero ff  
for eah test sample  the kernel funtion needs to be alulated for every nonzero ff   so operating in the density estimation spae an still offer a signifiant performane improvement
despite the overhead of the mixture of gaussians fit 
i

i

 

diretions for further researh

the next step would be to atually kernelize an elasti mathing distane metri to operate
in density estimation spae using something a variant of something like uhida and sakoe s
quadrati disrimination tehnique   
finally  in instanes where we are interested in warping of more omplex images  rather
than line art like type and handwriting   this tehnique of density estimation for elasti
mathing an be used in onjuntion with onventional elasti mathing at the pixel level 
 

fifor example  it an be used to guide a fast routine suh as pieewise linear elasti mathing 
whih is a relatively fast algorithm but requires areful seletion of pivot points   
notes
  d  keysers and w  unger  elasti image mathing is np complete 

pattern reognit  lett          

              
  s  uhida and h  sakoe  a survey of elasti mathing tehniques for handwritten charater reog 

ieice trans  inf    syst 

nition 
e   d        august      
  d  keysers  t  deselaers  c  gollan  and h  ney  deformation models for image reognition 

trans  on pattern analysis and mahine intelligene                   august      

ieee

  h  mitoma  s  uhida  and h  sakoe  online charater reognition based on elasti mathing and

pro  icdar    

quadrati disrimination 
      
  s  uhida and h  sakoe  pieewise linear two dimensional warping 
                  

 

systems and computers in japan

fi