 

face detection using lbp features
jo chang yeon
cs     final project report
december         

i  introduction

f

ace detection is a fundamental task for applications
such as face tracking  red eye removal  face recognition and
face expression recognition     to build flexible systems which
can be executed on mobile products  like handheld pcs and
mobile phones  efficient and robust face detection algorithms
are required 
most of existing face detection algorithms consider a face
detection as binary  two class  classification problem  even
though it looks a simple classification problem  it is very
complex to build a good face classifier 
therefore 
learning based approaches  such as neural network based
methods or supports vector machine  svm  methods  have been
proposed to find a good classifiers               most of
proposed algorithms use pixel values as features  however 
they are very sensitive to illumination conditions and noises     
papageorgiou et al      used new feature  it is called haar like
features  these features encode differences in average
intensities between two rectangular regions  and they are able to
extract texture without depending on absolute intensities 
recently  viola and jones proposed an efficient system for
evaluating these features which is called an integral image     
and  they also introduced an efficient scheme for constructing a
strong classifier by cascading a small number of distinctive
features using adaboost  its result is more robustness and
computationally efficient 
base on viola and jones work  many improvements or
extensions have been proposed  mainly  there are two
approaches to enhance their scheme  the first approach is an
enhancement of the boosting algorithms  boosting     is one of
the most important recent developments in classification
methodology and  therefore  many variant of adaboost such as
real adaboost  logitboost  gentle adaboost  klboosting 
etc      have been proposed  the second approach is an
enhancement of used features  base on original propose of
haar like features   a   viola and jones extend feature set as
shown in figure   

figure    example of harr like feature sets

 b    c  and  d  in different size are used in         to extract
features  and  lienhart et al       introduced an efficient
scheme for calculating    rotated features  and  mita and
kaneko introduced a new scheme which makes haar like
features be more discriminative      though haar like feature
provides good performance in extracting textures and cascading
architecture and integral image representation make it
computationally efficient  it is still not feasible on mobile
products 
t  ojala et el       a new rotation invariant and
computationally lighter feature sets  it should be noted that the
basic lbp features have performed very well in various
applications  including texture classification and segmentation 
image retrieval and surface inspection      
ii  local binary pattern
local binary pattern  lbp  features have performed very
well in various applications  including texture classification and
segmentation  image retrieval and surface inspection 
the original lbp operator labels the pixels of an image by
thresholding the   by   neighborhood of each pixel with the
center pixel value and considering the result as a binary number 
figure   shows an example of lbp calculation 

figure    example of lbp calculation
the     bin histogram of the labels computed over an image
can be used as a texture descriptor  each bin of histogram  lbp
code  can be regarded as a micro texton  local primitives
which are codified by these bins include different types of
curved edges  spots  flat areas  etc  figure   shows some
examples

fi 

figure    examples of texture primitives
the lbp operator has been extended to consider different
neighbor sizes  for example  the operator lbp     uses  
neighbors while lbp      considers the    neighbors on a circle
of radius    in general  the operator lbpp  r refers to a
neighborhood size of p equally spaced pixels on a circle of
radius r that form a circularly symmetric neighbor set  lbpp  r
produces  p different output values  corresponding to the  p
different binary patterns that can be formed by the p pixels in
the neighbor set  it has been shown that certain bins contain
more information than others  therefore  it is possible to use
only a subset of the  p lbps to describe the textured images 
ojala et al  defined these fundamental patterns as those with a
small number of bitwise transitions from   to   and vice versa 
for example           and          contain   transition
while          and          contain   transitions and so on 
accumulating the patterns which have more than   transitions
into a single bin yields an lbp descriptor 
the most important properties of lbp features are their
tolerance against monotonic illumination changes and their
computational simplicity 
a  lbp based facial representation
each face image can be considered as a composition of
micro patterns which can be effectively detected by the lbp
operator  ahonen et al  introduced a lbp based face
representation for face recognition  to consider the shape
information of faces  they divided face images into m small
non overlapping regions r   r        rm  as shown in figure    
the lbp histograms extracted from each sub region are then
concatenated into a single  spatially enhanced feature histogram
defined as 

where i            l    j           m    the extracted feature
histogram describes the local texture and global shape of face
images 

figure    lbp based facial representation
iii  learning classification functions
in this system  a variant of adaboost  gentle adaboost is

used to select the features and to train the classifier  the formal
guarantees provided by the adaboost learning procedure are
quite strong  it has been proved in      that the training error of
the strong classifier approaches zero exponentially in the
number of rounds  gentle adaboost takes a newton steps for
optimization 

figure    gentle adaboost
the weak classifier is designed to select the single lbp
histogram bin which best separates the positive and negative
examples  similar to      a weak classifier hj x  consists of a
feature fj which corresponds to each lbp histogram bin  a
threshold  j and a parity pj indicating the direction of the
inequality sign 

found weak classifiers are used to compose a strong
classifier 
iv  the attentional cascade
a cascade of classifiers is used  which achieves increased
detection performance while obviously reducing computation
amount  simpler classifiers are used to reject the majority of
sub windows before more complex classifiers are used to
achieve low false alarm rates 
stages in the cascade are constructed by training classifiers
using gentle adaboost  a positive result from earlier strong
classifier triggers next strong classifier which has also been
adjusted to achieve higher detection rate than previous one  a
negative result is immediately rejected at any stage of cascade
structure 

figure    schematic depiction of the detection cascade 
because an overwhelming majority of input sub window is
negative  this method can significantly reduce the number of
sub windows which is processed with more complex classifier 

fi 
v  training datasets
because i am building an appearance based detection scheme 
large training sets of images are needed in order to capture the
variability of facial appearances  some training examples are
shown in figure   

figure    example face images from the training set with
rotation 
as shown in above figure  my training set also includes
rotated face training examples to enable to detect rotated faces 
because rotated face in every    can be detected by rotating
lbp operator  only         and   rotated face examples
are added to training set 
with above training set  face detection works well  it can
detect faces in images with low false alarm rate  but  it can not
detect faces in low light condition and dark skin faces  to solve
this problem  there are two approaches  one is image
preprocessing and another is enhancing training set  lizuo jin
and shinich satoh introduced a good method to estimate an
illumination condition of image and enhance its quality      
but their method is computationally  it is not feasible on mobile
product 
therefore  to enable the system to detect faces in low light
conditions  faces in various illuminations and dark skin faces
are also added to my training set 

figure    negative examples from printed charaters 
by this method  i obtained         nonface patterns as
negative training examples 
vi  experiment results
from the collected training sets  i built lbp histograms 
then i used these histograms as inputs to the learning
application and trained the face classifier 

figure    example face images from the training set with
various illumination conditions 
i collected        face images and used it as a positive
training set 
to collect nonface patterns  i used the boostrap strategy in
five iterations      first  my system extracts     patterns per an
image from a set of false alarm causing image set which do not
contain faces  because most of false alarms are come from trees 
characters  handwritings and fabrics  i used these kinds of
images as a false alarm causing image set  some examples are
shown in figure   
then  at the end of each training iterations  i run the face
detector and collected all those nonface patterns that were
wrongly classified as faces and used them for training  and 
extract negative training examples on false alarm causing
image set again  to get more efficient negative examples  i
used classifiers which were found in previous iteration and
chose negative examples which were mis classified as a face 
figure     face detection results
some of face detection results are shown in figure     even
though trained classifier still suffers from dark skin faces  its

fi 
detection result was quite good 
finally  i implement a face detector which uses trained face
classifier as a s   symbian application  on vga input  a face
detection which use lbp based classifier took     second to
process whole image while haar like feature based classifier
took     seconds to process image 
vii  conclusions
in this project  i introduced and implemented a face detection
algorithm  based on lbp features  motivated by the fact that
computing haar like features are too computationally heavy to
work on mobile product  i utilize another feature which is
computationally simpler than haar like feature 
although lbp feature is simpler  my implementation shows
that it is enough to discriminate faces and non faces faster 
references
   
   
   
   
   
   
   
   
   
    

    
    

    
    
    

m  h  yang  d  j  kriegman  and n  ahuja  detecting faces in images  a
survey  ieee trans  on pami                   
k  k  sung and t  poggio  example based learning for view based
human face detection  ieee trans  on pami                     
h  a  rowley  s  baluja  and t  kanade  neural network based face
detection  ieee trans  on pami                    
e  osuna  r  freund  and f  girosi  training support vector machines  an
application to face detection  proc  of cvpr  pages               
b  heisele  t  poggio  and m  pontil  face detection in still gray images 
a i  memo              
t mita  t  kaneko  and o  hori  joint haar like features for face
detection  in iccv       
c  p  papageorgiou  m  oren  and t  poggio  a general framework for
object detection  proc  of iccv  pages               
p  viola and m  jones  rapid object detection using a boosted cascade of
simple features  proc  of cvpr  pages               
j  friedman  t hastie and r  tibshirani  additive logistic regression  a
statistical view of boosting 
b  wu  h  ai  c  huang  and s  lao  fast rotation invariant multi view
face detection based on real adaboost  proc  of ieee conf  on
automatic face and gesture recognition  pages             
r  lienhart and j  maydt  an extended set of haar like features for rapid
object detection  proc  of icip                   
t  ojala and m  pietikainen  multiresolution gray scale and rotation
invariant texture classification with local binary patterns  ieee trans
on pattern analysis and machine intelligence  vol      no    july       
a  hadid  m  pietikainen and t  ahonen  a discriminative feature
space for detecting and recognizing faces  proc of cvpr      
l  jin  s  satoh and m  sakauchi  a novel adaptive image enhancement
algorithm for face detection  proc of icpr      
y  freund and r  e  schapire  experiments with a new boosting
algorithm  in machine learning  proc of the   th international conf 

fi