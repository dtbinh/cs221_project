door handle detection for the stanford
ai robot  stair 

benjamin j sapp
jingshen jimmy zhang
department of computer science
stanford university
stanford  ca      
 bensapp jimmy zhang  stanford edu

abstract
we adapted a visual object detection framework  originally
applied to face recognition  to perform fast and robust door
handle detection  we detect objects in real time using a cascade
of weak classifiers  the framework rejects most image subwindows early on in the cascade and a very small minority ever
reaches the later nodes  our system achieves a high detection
rate  approximately      while maintaining a very low
number of false positives  even though door handles are
intrinsically less feature rich than faces 

  i nt rodu ct ion
the stanford ai robot is designed to perform a variety of tasks  including
navigating through doorways  this requires real time door handle detection for
different environments and many types of handles 
finding door handles is a rare event detection problem  in practice  millions of
windows must be examined of which only a few are door handles  performance of
rare event detection systems can be evaluated by the event detection  true positive 
rate d  and false positive rate  f 
we adapted an object detection frame work implemented by wu et al       the
original cascade architecture was developed by viola and jones      in which a
cascade of weak classifiers is constructed 
each classifier itself is chosen to
achieve a very high detection rate while allowing a moderate false positives rate 
upon evaluating an image  sub windows must avoid rejection in each classifier of
the cascade sequentially  thus  the overall false positive rate would be the product
of all the individual rates  similarly  the overall detection rate would be the product
of all the individual detection rates  consider a cascade with    classifiers  where
each individual classifier has detection rate     and false positive rate      the
overall detection rate is               and corresponding false positive rate is        
    e   
viola and jones used this approach for face detection  wu et al improved upon the
algorithm by making the training phase two orders of magnitude more efficient by
modifying the feature selection algorithm for each classifier in the cascade 

fithis paper discusses our application of wu et als implementation to door handle
detection  we show that though door handles themselves are not as feature rich as
faces  the same framework performs as well on handles as faces  this work gives
insight into the tradeoff between detection and false positive rates in our problem 
shows the effectiveness of simple rectangular features  and compares our results to
previous work in face detection 

  t he casc ad e c lass ifie r a rc hit ec tu re
a short discussion of the cascade architecture follows 
description  refer to     

for a more in depth

each node in the cascade is an ensemble classifier  the classifiers are composed of
      simple continuous features combined with a threshold  adaboost is used to
select classifiers  or features  during every iteration to lower the ensembles error
rate  direct feature selection is an alternative to adaboost  which adds a classifier
to the ensemble at each iteration that either improves the detection rate  or lowers
the false positive rate  the final classification from direct feature selection is a
majority vote of all classifiers 
rectangular features are used to compute the difference between the sum of
intensities in adjacent rectangles of equal size in the image  the rectangles can vary
in size and number  yielding an over omplete set of features for each image  for
our setting  we chose the same   types of rectangle features as viola jones  these
features can be computed extremely quickly using integral images 
 

  

classification using this cascade is
fast since test windows are applied
sequentially  and at least     of test
windows are rejected at each node 
figure   shows the number of
rejections by node in empirical tests
of nearly   billion rejections 

nonhandle rejection by node

x   

 

number of subwindows rejected

 

 

 

 

  t ra in ing

 

 

our dataset consists of     images of
exterior and interior door handles
from approximately    buildings at
stanford  we chose a diverse set of
door handles and backgrounds
figure  
consisting of the door itself and nearby
objects  interesting extraneous objects in this dataset include door frames  separate
locks  keyholes  thermostats  trash cans  and bookshelves  several images even
feature glass doors or metal mesh  adding to the background noise  handle and door
color also vary  pictures were taken from different vantage points to allow
detection at slightly different approaches 
 

 

 

 

 

  

  
node  

  

  

  

we train using   x   pixel grayscale images  formatting raw data into positive
training examples took trial and error to achieve good results  we found that the
best technique was to crop the door handle as tightly as possible and maintain the
same aspect ratio  attempts to include more visual cues from the handle
surroundings into the data failed  for example  we thought it would be intuitive to
add the doors edge in the image  which is always close to the door handle and most
often shown as a strong dark vertical line in an image  however  because of
inconsistent cropping  alignment and the distances between the handle and door

fiedge  it was difficult to capture this visual cue consistently in our feature set  the
result was inconsistent and arbitrary classification 
for all handles  we attempted to align the axis of rotation of the handle with the
center of the image patch  this allowed features that were consistent across all door
handles  for the majority of door handles  this axis of rotation is the center of a
circular disk component of the handle  and thus a very helpful indicator of a door
handle  to also maintain consistency across different doors  intensity variance was
normalized to minimize lighting discrepancies 
the cascade architecture is only effective at achieving a low false positive rate if
each node in the cascade rejects unique sets of features  i e   makes errors
independent of other nodes  thus  each node is trained on negative examples that
were not rejected by any of the previous nodes  a large bootstrap database of
negative examples is searched after every node is added to the cascade  and a subset
of the database becomes the set of negative examples for the next node  the
bootstrap database is a collection of arbitrary images found by crawling the internet 
making sure no door handles were present 

  c lass ificat ion
an image to be classified is iteratively scanned at multiple scales and locations by a
moving detector window  for    x    images  this classification process runs at
approximately three frames per second 
it is often the case that sub windows adjacent in scaling and location will all be
classified as door handles as a result  classification often produces many
overlapping detections  to obtain a more coherent classification  post processing is
done  in viola and jones work  each set of overlapping detections  represented as
bounding boxes in the image  is averaged together to make one final detection  we
attained best results by taking the smallest bounding box that enclosed any set of
overlapping detections 
post processing has some interesting effects on result analysis  as noted in viola
and jones work  in our case  while it does a good job in giving an accurate
bounding box around door handles  it also reduces the number of false positives  in
extreme cases  this has the effect of saturating the number of false positives  as the
number of false positives in an image increases  more of them are likely to overlap 
and become clustered into one giant false positive 

  r es ult s
our full data set for testing contained      images of door handles  and      initial
negative examples  combined with a bootstrap set of           additional images 
we performed cross validation on this data  training     of the examples and
reserving     for for testing  this was done three times with random dataset
partitions and results were subsequently averaged 
the resulting cascade consists of    nodes  with a total of      features derived
from a pool of       total features  testing was performed manually for counts of
false positives and handle detection rates 
the number of false positives  rather than the false positive rate  was plotted for two
reasons  first  it allows us to compare our results to those of face recognition
papers  second  because of post processing  it is difficult to relate the final number
of false positives with the total number of sub windows examined  in classifying a

fitypical test set  approximately     million sub windows are examined  and the final
number of false positives is six orders of magnitude smaller 
a receiver operating characteristic  roc  curve is shown in figure    points were
generated by removing nodes from the end of the    node cascade to show the
relationship between edge detection rate and false positives  the justification for
this is that removing a node from the cascade is the same as setting its false positive
rate and its detection rate to one 
roc curve
 
   nodes
     
   nodes
   nodes

    

     
handle detection rate

our full    node cascade  when
tested on a set of     full size
images
of
handles
with
background  had a detection rate
of       with an average of
       false positives  in the
roc curve  our detection rate was
higher and our false positive
number lower than any cascade
found in     and     used for face
recognition 
furthermore  the
face test set     consisted of only
    images  giving them an even
higher number of false positives
per image 

   nodes

    

     

    

   nodes

     

    

     

    
   

   nodes

   

   

   

   

   

   

   

   

number of false positives  out of     pictures 

many attempts were made to
figure  
further lower the number of false
positives by adding in more relevant examples into the bootstrap database 
replacing images from the web with objects known to give our current classifier
difficulties  in particular shiny and circular objects  these attempts failed to
achieve any significant benefits  this may indicate that the set of features used is
not rich enough to make any finer distinctions  this is also confirmed upon running
tests on a much larger database of bootstrap images from the internet  using some
     images  the cascade was approximately the same number of nodes  and
performed comparably to our original cascade 

  con clusion s
we have demonstrated that we can apply rare event detection to door handle
recognition with results comparable to previous applications to face recognition  in
real time tests  door handle detection performs well  but with a mediocre false
positive rate 
there are many possibilities for future work focusing on how individual nodes are
constructed  wu et al  in     explore better ways to combine the weak classifiers in
a single node  rather than using adaboosts weight setting algorithm  they develop
a constrained optimization problem to directly minimize the false positive error of a
node with respect to a set of weights  and show empirically that it outperforms
adaboosts weights 
on a larger scale  using a less primitive set of features may further improve
accuracy  one of the major benefits of rectangle features is their ease of
computation  which allows training a cascade to take only a matter of hours  a new
class of features should try to maintain this efficiency  we have discussd the
possibility of applying sobel operators for finer intensity gradient information 
triangle features  a variant of rectangle features but lines are diagonal instead of
axis aligned  and scale invariant feature transform  sift  

fisubstituting random forests for ensemble classifiers to construct a node is another
possibility  random forests is similar in spirit to the current architecture  in that it
takes an ensemble of decision trees as weak classifiers  and takes a majority vote to
make a decision  random forests has had favorable performance over other
algorithms in problems with imbalanced data 
we have established that the cascade architecture not only excels at face detection 
but can also be applied to a type of object that is not as rich in visual features 
ultimately  we hope to use this rare detection framework to train cascades for a host
of other objects  which would provide robots like stair an efficient method for
real time visual object detection 

  a ck nowledge me nt s
we are very grateful for jianxin wu for providing his rare event detection code 
help with debugging  and insight into our specific problem  we would also like to
thank gary bradski and prof  andrew ng for invaluable discussion and guidance 
references
    rowley  h a   baluja  s    kanade  t         neural network based face detection  ieee
trans  onpattern analysis and machine intelligence             
    viola  p    jones  m         rapid object detection using a boosted cascade of simple features 
in proc  cvpr  pages        
    viola  p     jones  m          robust real time face detection  ijcv             
    wu  j   regh  j m     mullin  m d         linear asymmetric classifier for cascade
detectors  icml 
    wu  j   regh  j m     mullin  m d         learning a rare event detection cascade by direct
feature selection  nips 

fi