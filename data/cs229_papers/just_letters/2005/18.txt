learning techniques for computer aided diagnosis in chest
radiography
course cs     final write up

arpit aggarwal  su            

introduction
lung nodule detection in chest radiographs is an important area for computer aided diagnosis  cad 
primarily because lung cancer still claims over one million deaths every year  early detection of the disease
is critical but the fact remains that only         of cases are detected in the first phase 
radiologists can miss up to     of lung nodules  which may develop into cancer  in chest radiographs due
to the background anatomy of the lungs which can camouflage the nodules  cad helps radiologists by
performing preprocessing of the images and suggesting the most likely locations for nodules  detection of
lung nodules proceeds through techniques for suppressing the background structures in lungs which include
the blood vessels  ribs and the bronchi  the resulting images provide chest structures which make good
candidates for nodules and can be further classified on the basis of features like size  contrast and shapes 
simple rule based classifications on such features tend to produce a lot of false positives  in this project i
investigate a supervised learning technique to come up with non trivial secondary classifiers for separating
nodules from vessels  bifurcations  crossings and other background structures 

input data
the input data is a series of axial radiographs from different patients  the radiographs are     x    
grayscale images with intensities in hounsfield units  hu   the data from these slices can be concatenated
in an array to get a  d array of voxels  i have used a set of     radiographs from a single patient for
training  the size of the voxels in the dataset is          x          x     mm  

figure    shows a single input axial radiograph of a lung with an actual nodule  labeled true positive green circle  and one false positive  red circle  
also a set of candidate locations for nodules  rough center points of the structures  found by the preprocessing  using the first classifier  of the images is provided  these have been correctly labeled as either

fia nodule  true positive of the first classifier  or not  a false positive of the same classifier   they are used to
train the secondary classifier  the single patient data set had      such locations  out of which    were
labeled as true positive and the rest as false positives 

features
given the candidate location  a trivial set of features would be to take the intensities of the voxels or the
average intensity of a block of voxels about the point of interest  but this would result in a high
dimensional feature space and also not exploit the knowledge that one already possesses about the nodules 
at the same time such features would be susceptible to rotation and scale variance 
one important heuristic which can be used to distinguish nodules from other structures is that they are
essentially spherical where as other structures like vessels  ribs or bronchi are tubular  following are the set
of features that i analyzed to model this distinction 
marching cubes with visibility test

figure    surface rendering of a bifurcation
using marching cubes 

figure    surface rendering of a lung nodule using
marching cubes 

to represent the shape of the structure through the features  i used the distances of points on the surface of
the structures from their center points  provided as input   to find the surface i ran the marching cubes
algorithm to determine the triangles making up iso surface  details of the algorithm can be found in     

fifor each triangle visible from the center point the distance to its centroid is calculated  a histogram of all
the distances normalized by their mean is found out  each bin in the histogram is taken as a feature for the
classifier  different numbers of features were tried out as a trade off between high bias and computational
complexity  finally    such features were used to define the classifier 
this set of features resulted in average performance on the training set  high bias  indicating that a better
set of features was required 
lantern transform with rays in a single direction
the marching cubes algorithm had the problem of carrying over into surrounding structures while
calculating the surface of a particular structure  this skewed the distance histograms  thus  i decided to
sample the surface directly  for this  d rays were cast out from the center point over equally spaced
directions  calculated by distributing a set of points uniformly over a unit sphere  and their length when
they hit a surface  sudden drop in intensities  was calculated  a histogram of the various distances was then
plotted  each bin in this histogram represented a feature 
lantern transform with a pair of anti parallel rays

figure    sampled surface of a
bifurcation

figure    sampled surface of a
nodule

further  i employed the correlation between rays that are anti parallel to each other  so rays were cast out
in opposite directions and the pairs of distances were used for the histograms  these gave a better
indication of the symmetric nature of the structure  the resulting  d histogram had n  bins  n bins
corresponding to distance in   direction  and since the histograms formed a symmetric matrix only half the
bin counts  n     were used as features  i chose a set of     features for classification 

fithe above features were made scale invariant by normalizing the distances  normalization was done with
the mean of the distances for each histogram 

classifier   results
since this is a binary classification problem  logistic linear regression was used to learn a linear classifier
with a bias  the classifier had    parameters for the first feature set and     when training using the
second  batch gradient ascent was used to maximize the log likelihood and the learning rate was kept at a
constant value of     because convergence can be achieved for a fixed value for alpha 
following are the classification results achieved on the test and training set for both classifiers 
lantern transform

sensitivity
 true positive
ratio 

marching cubes

training set

test set

     

     

training set

test set

sensitivity
 true positive
ratio 

     

     

     

     

     

     

specificity
 true
negative
ratio 

     

     

specificity
 true
negative
ratio 

overall
accuracy

     

     

overall
accuracy

even though the overall accuracy was found to be pretty good  binary classifiers which have a varied
distribution in the two classes of the training data are better evaluated using roc curves 

figure    shows the roc curves for the two feature sets plotted by varying the threshold value of the
classifier

fifrom the figure  one realizes that lantern transform results in a better classifier as it has a larger area
under the roc  depending on the context and the cost associated with the two classes  nodule and nonnodule  one can choose a threshold value along the curve  for certain values the visibility march
outperforms the lantern transform and is thus used in that context  the combined performance is then the
convex hull of the two curves  in our case since high sensitivity is critical as we dont want to drop any
actual nodules  the lantern transform with a threshold value of      can be chosen  this ensures a sensitivity
value of   and at the same time cuts down     of the false positives 
bayesian logistic regression with map estimate was also tried as a classifier but expectedly did not offer
significantly better performance as the earlier classifier did not suffer from the problem of over fitting 

testing
testing was done on a set of     candidate locations which had    nodules and    other structures  these
radiographs belonged to a patient different from the one on which the training was performed  since the
real test of the classifier is to correctly identify nodules in different patients  cross validation was not used
while learning evaluating the classifier on the two sets of radiographs 

future work
features could be further improved to get better classification  in particular in the marching cubes feature 
the distances could be weighted by the area of the triangles  also the angle at which the  d ray is incident
on to the surface of the structure could be considered to form a feature 
a better classifier could be built by using a combination of some of the above features instead of using
them alone  also ensemble learning could be used to get better results 

acknowledgement
i want to acknowledge the valuable inputs given by asst  prof  david paik  radiology department 
stanford school of medicine  during the course of this project  he also provided the training and test
radiographs that were essential for the viability of the project 

references 
  
  
  

ellis j  r  c   gleeson f  v   lung cancer screening  the british journal of radiology                   
lorensen w  e   cline h  e  marching cubes  a high resolution  d surface construction algorithm 
computer graphics  volume     number    july      
doi k   et al   computer aided diagnosis in radiology  potential and pitfalls  european journal of radiology
               

fi