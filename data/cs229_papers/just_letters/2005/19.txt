prostate detection using principal component analysis
aamir virani  avirani stanford edu 
cs      machine learning  stanford university     december     

introduction
during the past two decades  computed tomography  ct  has become a large
component of diagnosis and treatment facilities around the country  initially used
to scan the brain  ct is now used to learn more about patients internal systems
when dealing with many pathologies  including cancer 
a ct scan produces a three dimensional view of the inside of a body  a single
scan produces a set of two dimensional slices over the region of interest  thus  a
single measurement contains many data points that can be put together to
generate a  d model of the body  visible organs  tissues  and other features     
doctors who work with cancer now use ct scans to plan radiation therapies so
that treatment is localized to diseased tissue and minimally hurts the
surrounding  healthy organs  however  hospital staff currently goes through each
slice of a ct by hand to annotate the scan with location of organs like the heart 
liver  kidneys  prostate  and more  this process takes a long time and is
susceptible to variation between doctors     
recent work in computer vision and medical instrumentation has attempted to
deal with this problem  image segmentation of the  d slices groups similar
tissues together using region growing or seeding      others have incorporated
machine learning techniques to pick out interesting regions  zwiggelaar and zhu
have worked with active shape modeling      while august and kanade have
attempted some weakly supervised training to accomplish similar goals     
in this paper  i will attempt to detect the prostate in the two dimensional slices of
a ct scan by using principal component analysis and a supervised learning
classification scheme  by training on a set of slices and human drawn contours
identifying the prostate  i hope to produce a classifier that can then take a new
slice from either the same patient or another and highlight the prostate on it 

approach
a single ct scan contains over     slices  and each consists of    x   
integers  where each is a value in hounsfield units  a normalized measure of xray attenuation      to work with system memory limitations  i decided to focus
on only those slices containing a prostate contour  this dropped the number of
usable slices per scan to around forty 
each slice must be preprocessed  instead of working with a huge      sized
vector  i broke the slice into blocks of size   x    the blocks do not overlap 
though this is a changeable parameter for future research  other block sizes

fiwere later attempted  like  x   these blocks were arranged into a vector format 
and so the setup for machine learning algorithms was complete  a set of    length vectors capture the features of each block in a slice  training slices were
then concatenated to generate the full training set 

figure     d slice preprocessing   go from slice to blocks to vectors
concurrently  the related contour drawn by a doctor or other staff is processed in
the same way  the resulting vectors are then compared to some threshold
value  if the vector contains a certain percentage of the contour  the related slice
vector is marked   for containing prostate  otherwise  it is marked with a   
to find a generalizable algorithm for prostate detection  principal component
analysis  pca  makes sense  using this method should remove overfitting to our
training set and the subtle effects of noise in our data  i hoped to find that organ
samples clustered when projected into these lower dimensions as well  if this
occurs  perhaps more can be learned about the features that differentiate organs 
in principal component analysis  one first creates the training datas covariance
matrix  the eigenvectors that maximize this matrix are then used as a lowerdimensional orthogonal basis      thus  we discard the smaller variance that
may be attributable to noise  differences between equipment  and changes in
anatomy 
the slices in a ct scan are not independent  however  the adjacent regions in
two different slices likely carry similar information and map to the same organ 
to account for this  i also grouped slices and broke this into voxels that were
then used in the same way as above  this three dimensional pca classifier was
compared to the two dimensional one 

observations
training a pca based classifier on the training set produces a set of components
which most capture the variance in the signal  in the two dimensional   x  
block setup  the first principal component captured nearly ninety percent of the
variance  while the first fifty included over ninety nine percent 

fifigure     d pca    x      variance by principal components and prostate
locations
the right figure above shows how the training set condenses into a onedimensional space defined by the first principal component  here  one can see
that the prostate lies in one general region  while this may be a good sign 
additional data points are plotted showing the surrounding organs often confused
with the prostate  like the bladder and seminal vesicles  unfortunately  those
organs are also in the same subset of the space 
i had hoped to see soft tissue organs separate in these lower dimensions  but
this did not occur  the two dimensional mappings below show that the pca
projections did not capture such differences  while the prostate samples did
group in one region  so did the bladder and seminal vesicles  there seems to be
no way to separate these three organs because they overlap in the defined
space 

figure    clustering observations   dimensions a    and   and b    and  

results
training on half of one persons dataset yielded    training examples  the
remaining samples of the single person were then classified  and the classifier
was also run on two other patient datasets 

fipca type
 d    x   
 d    x   

prostate
correct    
  
  

prostate
correct    
  

table    correct prostate detection results using pca
unfortunately  the system does not work as well as hoped  however  the above
results are for correct prostate detection  that is  the success rate is based on
the number of prostate detections per total number of prostate blocks  this does
not take into account the successful classification of non prostate  it also does
not include nearby detected blocks  such as those adjacent to the desired
contour or those in between contour lobes  in other words  a few of the classifier
errors may have been correct given a different doctors contour for comparison 
the next table shows that the results are quite good if all of the data is included 
but note that this is not surprising  organs  bone  and other portions of the body
have a very different makeup  so their images look quite different  furthermore 
the prostate is a very small part of the body  so classifying all blocks as nonprostate would return a very high success rate as well 
pca type
 d    x   
 d    x   

overall correct    
    
    

table    overall classification results using pca classifier
the difficulty of this problem is when dealing with soft tissue and the lower
abdomen  by looking at individual results  though  one can see that the
machine learning algorithm has correctly deduced that soft tissue is the most
likely type of block containing a prostate  the classifier rarely moves out of the
central portion of a slice  no edges of the body were classified as prostate  and
very rarely was the inside of another organ  like a kidney  falsely classified 

figure    sample results from pca classifier
in the above figure  the left image shows a typical prostate contour near the
middle of the organ  it is round and centered in the body  the resulting
classification performs decently  while it does not map the contour region  it
does detect the surrounding area of soft tissue 

fion the other hand  the right image shows the troubles of detecting a prostate
shape that is not part of the original training set  when processed  one of the
end lobes is detected  but the thin middle portion is missed  note that this
instance also produces a scattering of detections as well 

future work
such results indicate that this is a promising direction in detection  with a larger
training set that encompasses all slices of a prostate and tens or hundreds of
patients  the principal vectors may generalize and produce better detection on
test patients  if there were a way to selectively choose slices within in a scan  we
might find that a subset of representative shapes and slices work as a better 
faster training set than just using a whole chunk 
because each ct slice was broken into equal sized blocks  using computer
vision techniques to segment the human into interesting regions before
attempting to find identifiable features or components may work better  again 
current prostate segmentation techniques rely on segmentation  but incorporating
machine learning to better divide soft tissue remains a nascent area of research 

acknowledgements
i would like to thank brian thorndyke and the stanford medical school radiation
oncology department for their help in understanding and gathering data for this
project 

references
    computed tomography  wikipedia  the free encyclopedia     nov      
      cst     nov       http   en wikipedia org wiki computed tomography  
    thorndyke  brian  interview     oct      
    mazonakis  m   et  al  image segmentation in treatment planning for prostate
cancer using the region growing technique  british journal of radiology   
                
    zhu  y   williams  s   zwiggelaar  r  segmentation of volumetric prostate
mri data using hybrid  d  d shape modeling  proceedings of medical image
understanding and analysis               
    august  jonas and kanade  takeo  weakly supervised segmentation of
non gaussian images via histogram adaptation  proceedings       medical
image computing and computer assisted intervention  miccai                 
    ng  andrew  cs    lecture notes  part    principal components analysis 
   nov      

fi