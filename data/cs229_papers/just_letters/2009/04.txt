automatic fatigue detection system
t  tinoco de rubira  stanford university
december         

 

introduction

 frequent yawning or rubbing eyes 
 drifting from lane or tailgating 

fatigue is the cause of a large number of car accidents in the united states  studies done by the national highway traffic safety administration  estimate that about       deaths         injuries  and
     billion dollars in monetary losses are the cost
of fatigue related car accidents each year  to prevent these accidents  there are a number of devices
available in the market  many of these products are
small devices worn by drivers on their ear that generate an alarm when the drivers head falls forward 
however  these devices produce the alarm after the
driver is no longer in conditions to be driving  the
alarm essentially makes the driver wake up and can
itself be the cause of an abrupt reaction that can
lead to an accident 
an alternative and better approach is proposed
by      here  a computer vision based system is
described that keeps track of the eyes and detects
the sleep onset of fatigued drivers  the proposed
system uses template matching for detecting the
state of the eyes  this approach however  is computationally intensive  it is subject dependent and
requires calibration routines for adjusting for light
conditions  in this paper  we present a more robust
alternative based on machine learning for detecting
and tracking the fatigue level of a driver 

 

 trouble keeping head up 
from this list  we decided to focus on the detection of frequent blinking  heavy eyelids and frequent yawning for determining the fatigue level of
a driver  we propose the following approach for
performing this task  first  a video camera records
data of a person while driving and sends the data in
real time to a computer vision system that detects
the drivers face within the video frames  once a
face image is extracted  a support vector machine
 svm  classifies the image as being fatigued or not
fatigued  the representation of the classification
output is either a    or    and this number is used
by a system that monitors the driver status  specifically  the classification output is the input of a
weighted running sum that increases rapidly when
the classification output is    and decreases slowly
with the presence of    outputs  the frequency at
which the sum goes above a specified threshold can
be used to track the fatigue level of a driver and
detect the sleep onset with a safe margin  the details of the subsystems and the experiments carried
in this research are presented in the next sections 

 

approach

system overview

the proposed system is divided into four subsystems  these are the video capture unit  face detection unit  fatigue detection unit and alert unit  the
video capture unit is a module that records video
data in real time of the drivers face  the video is
sampled with a constant period and the sampled
 difficulty focusing and daydreaming 
frames are sent to the face detection unit  for the
 frequent blinking and heavy eyelids 
purpose of this research  we used a camera to man trouble remembering the last few miles driven  ually collect videos and converted these videos to

the national sleep foundation suggests a list of
signs that can be used for determining when a
driver is no longer in conditions for being driving 
these signs are the following 

 

fioptimization problem 

sequences of images that consisted of the frames
sampled every second 

x
  t
i
w w c
 
i  
m

min

w b 

s t 

y  i   wt x i    b      i   i           m
i     i           m

in this expression  the set   x i    y  i      i  
              m  represents the training examples with
the corresponding labels 
to construct the training set  we first collected
videos of    persons  in each of these videos  the
persons being recorded were asked to perform three
actions  first look at the camera with the eyes
open  then pose for a few seconds with the eyes
closed and then yawn  from each of these videos
we extracted a sequence of    x    grayscale images sampled once every second  the total number
of images obtained were      a subset of these is
shown in figure    we then used the face detection
unit to extract the faces from the images and used
these to form the training set  a sample of the extracted faces can be seen in figure    an important
result from using the face detection unit to extract
the faces was that the images obtained had the eyes
at the same level  this facilitated the subsequent
steps of image filtering and feature selection since
it allowed us to focus on fixed subregions of the
images 
for testing the prediction performance of the
svm  we constructed a test set by separating a set
of images that corresponded to a particular person
that was completely removed from the training set 
we decided to use this scheme  as opposed to selecting a random subset of the training set  because
we wanted to make sure that the svm was tested
on faces of persons that it had not seen before  we
believe that this scheme gives a better estimate of
the generalization performance of the svm 

figure    images extracted from the videos 

the face detection unit is a module that receives
a video frame from the video capture unit and uses
a cascade of classifiers that work with haar like features to detect the face within the video frame 
once the face is detected by the classifier  it is
scaled to a size of    x    pixels and then sent
to the fatigue detection unit  this system was implemented using intels open source computer vision library  opencv  with decision tree classifiers
that were trained with human faces 
the fatigue detection unit is a module that consists of an svm that classifies the face images in the
categories of fatigued and not fatigued  the decision for implementing this module using an svm
was due to the binary nature of the posed classification problem  the efficiency of svms in working with high dimensional feature vectors and their
flexibility in handling both linearly and nonlinearly
separable data sets  this system was implemented
using the libsvm library     
the alert unit is a module that consists of a
weighted running sum that adds every output of
the svm  the idea is that this sum can be configured so that it rapidly increases when the svm outputs     and slowly decreases towards zero when
the svm outputs     one can then compute the
number of times in a fixed time window that the
value of the sum goes above a specified threshold
and use this to estimate the fatigue level of a driver 

 

training the svm

figure    output images from the face detection
unit 

the formulation of the svm used in this research
the features that we used for training the svm
is the one that is based on the following primal were the pixel values of the image  however  since
 

fiwe were able to rely on the consistency of the face
detection unit  resulting in the eyes being at the
same level in all images  we used the pixels from
only two fixed subregions of the images  these were
an   x   subregion and a   x   subregion located
to contain the eyes and the mouth of the person 
by using only the pixel values of these regions  we
decreased the size of the feature vectors from       
to       without any penalty on performance 
to try to simplify the classification task  we processed the eye and mouth images in the following
way  for the eyes  we first enhanced the edges
and then filtered the images using a median filter
twice  the first time using an environment of size
  and the second using an environment of size   
for the mouth images  we only processed them using a blur filter  we chose this procedure experimentally by executing the training algorithm with
the processed images and looking at the number
of support vectors  we found  among the processing schemes tried  that the one mentioned above
resulted in the smallest number of support vectors 
we concluded from this that the image processing
scheme mentioned above performed better in separating the positive  fatigued  and negative  not
fatigued  examples  figure   shows the subregions
used for creating the feature vectors and the effects
of the image processing algorithm 

found that the projection of the data onto the three
dimensional space spanned by the fourth  fifth and
sixth principal eigenvectors showed a separation between fatigued and not fatigued faces  this can be
seen in figure    we concluded from this analysis
that the features and image processing scheme chosen provide enough information for performing the
classification 

figure    projection of the data onto the three dimensional subspace spanned by the fourth  fifth
and sixth principal components of the data  the
red points correspond to fatigued faces  the blue
points correspond to not fatigued faces and the
black dots are the support vectors found after running the training algorithm 
figure   shows the results of an experiment we
carried to evaluate the effects of feature selection
and image processing on the performance of the
svm  for this experiment  feature sets a and b
correspond to all the pixel values of the eye and
mouth images before and after applying the image
processing algorithm  feature sets c and d correspond to the histograms of the eye and mouth images before and after applying the image processing
algorithm  to generate this data  we gradually incremented the training set size by adding a new person at a time  and then trained the svm using each
of the different feature sets  we see from the plot
that the number of support vectors obtained when
using feature set b is slightly lower than when using
feature set a  as mentioned before  we concluded
from this that the image processing algorithm implemented was in fact contributing to the separation of the data  we also see from the plot that
the number of support vectors obtained when using the histogram values as features is much higher
than when using all the pixel values  the histogram
values were among some of the alternatives we ex 

figure    subregions used for creating feature vectors and effects of image processing algorithm 
to visualize how the distribution of fatigued and
not fatigued face images looked like  we used principal component analysis  pca  to project the
data onto a three dimensional subspace  that is 
from our training examples p
 x      x              x m    
m
 
we constructed the matrix m i    x i     x i  
 t   where  is the mean of the x i    and computed
the first six principal components of the data  we
 

fiperimented with in trying to find lower dimensional
feature sets that could separate the data  other
features tried were the sums of the columns and
rows of the images  but we also found that these
did not provide any useful information that could
help classification 

figure    prediction accuracy on test set as a function of training set size 
that the performance of the svm on the test set improved significantly with the inclusion of a particular person to the training set  to understand this
better  we evaluated the prediction performance of
the svm by using a customized cross validation
scheme  specifically  we tested the prediction performance of the svm on each of the ten persons 
for each trial  we picked one of the ten persons to
form the test set and used the remaining nine to
train the svm  once we did this for all ten persons  we averaged the percent accuracy obtained
from each trial  table   shows the results obtained 

figure    number of support vectors as a function
of training set size 
figure   shows a similar experiment carried to
evaluate the performance of the svm using the feature sets described above  this data was generated
by executing the learned hypothesis on the test set
for various training set sizes and for each of the different feature sets  we see from the plot that  for
the particular test set used  the image processing
algorithm improved the performance of the svm 
a sample of the predicted labels of the test set is
shown in figure    we also notice that there is
a significant increase in prediction accuracy when
the training set reaches a size of     approximately 
an explanation for this could that at that point  the
new person added to the training set looked similar to the person present in the test set  after this
particular result  we decided to investigate the performance of the svm on other test sets  namely 
on the test sets formed with each of the other nine
persons 

test set
person  
person  
person  
person  
person  
person  
person  
person  
person  
person   
average
std dev

prediction accuracy    
features a features b
    
     
    
    
    
    
    
     
    
    
     
     
     
    
    
    
     
     
    
     
    
    
   
    

table    results of cross validation 
the data shows that for two test sets  the image
processing algorithm actually lowered the prediction accuracy of the svm  we see however that
as explained in the previous paragraph  we found for all test sets  at least one of the feature sets

figure    example of labels predicted by svm 

 

firesulted in a performance of above      we concluded from this that the system performed reasonable well in predicting the labels  and we discarded
the possibility that the results obtained in the previous experiment  in which the prediction accuracy
was very high  were a special case  the fact that
at least one feature set performed very well suggests that perhaps an image processing algorithm
that enhanced the edges less and did less smoothing could still achieve high prediction accuracy on
average but with a smaller variance 

 

conclusions

in this paper  we have proposed a system that uses
machine learning for detecting the fatigue level of
a driver  we saw from the experiments that with
simple features and a simple image processing algorithm  we were able to obtain an average prediction
accuracy of       by training the svm only with
nine persons  the data obtained also showed that
there is room for improvement for obtaining high
prediction accuracy with a smaller variance  that
is  for obtaining a more robust system that performs well for a wide variety of faces  the next
step in this research would be to try different image processing algorithms  increase the training set
size  and execute the overall system in real time to
investigate the performance of the proposed alert
unit 

references
    a  b  albu  b  widsten  t  wang  j  lan 
and j  mah a computer vision based system for real time detection of sleep onset in
fatigued drivers       ieee intelligent vehicles symposium 
    chih chung chang and chih jen lin
libsvm  a library for support vector machines        software available at
http   www csie ntu edu tw cjlin libsvm 
    c  m  bishop pattern recognition and machine learning        springer 

 

fi