identificationofneuroimagingbiomarkers
dangoodwin tombleymaier shiprabhal
advisor dr amitetkinm d  phd stanfordpsychiatrydepartment

abstract
wepresentasupervisedlearningapproachtoidentifybiomarkersforfourdistinctpsychological
disorders wediscussourusageofmulticlassclassificationusingsvms andexperimentationwithusing
a classsvmasafeaturereductiontechnique althoughtherfemethodultimatelyhadlimitedability
inprediction itgavegoodresultsinidentifyingneuroanatomicalfeaturesofinterest 


  introduction
psychiatricdisordersarecurrentlydiagnosedthroughbehavioralanalysis anoutdatedmechanism
consideringtheresolutionandavailabilityofmodernneuroimagingtechnology thispaperpresentsa
supervisedlearningapproachtostudyingpsychiatricdisordersbasedonfunctionalmri fmri data 
withtheintentofimprovingtheirdiagnosisandtreatment 

theintentofthisprojectistosupportdr etkinsresearchonunderstandingtheunderlyingneuro
anatomicalbasisofpsychiatricdisorders heandhisresearchteamhavedevelopedanovelmechanism
ofimpartingemotionalstimuliintopatientsandmeasuringthecorrespondingbrainactivationonan
fmri attheonsetofourinvolvement dr etkinwasabletosuccessfullyapplybinaryclassifications but
wasinneedtoamulticlassapproachtohelptakehisresearchinthenextsteptowardsclinical
practicality inthispaperwepresentpatternmatchingdataanalyticapproachestounderstandthe
underlyingneuralbasesofthesedisordersanddevelopneurobiologicalbiomarkerswhichaddressthe
similaritiesanddifferencesbetweenthem 


  thedata
dr etkinprovideduswithahighqualitydatasetof  patientswhichhehadclinicallydiagnosed
himself thedatasetisidealbecausethemeasurementsweretakenonthesamefmriandthe
participantshadstoppedtakingtheirrespectivemedicationpriortothescan givingtheclearestsignal
possible thetrainingdatasethadthefollowingcomponents 
   gad generalizedanxietydisorder 
   comorbid combinationofgadandmajordepressivedisorder 
   chronicpain
   controlsubjects

thefmriscansweretakenwhilepatientsperformedataskdesignedtomeasureemotionalreactivity
andregulation specifically subjectswereshownasequenceofimagessimilartothoseinfigure  and
wereaskedtoidentifywhetherthefacialexpressionwashappyorfearfulwhileignoringtheoverlying
word    

 


fi





figure  examplesoftheemotionalstimuliimpartedonthestudyparticipants




measuringreactiontimesovervaryingsequencesofcongruentandincongruentimagesleadstoa
quantitativemeasureofasubjectsimplicitemotionalregulation whichistheunconsciousregulation
thatoccursduringemotionalstimuli  anxietyanddepressivedisordersaremarkedbyabnormalitiesin
negativeemotionprocessing andbyexaminingtheneuralactivationduringthistestwecanfindlook
forthedifferent aswellassimilar activationpatternsacrossthegivensubjectgroups 

the dfmribrainimageswereconvertedtomatrixformusingaprogramcalled statisticalparametric
mapping   spm normalizesthevoxelsintostandardspace andsmoothesthe dbrainimagesto
accountforunavoidablemotionofthepatient asaresult foreachpatientweobtainavectorof
       voxels thesevoxelsrepresenttheareasofthebrainwherecellbodiesarepresent gray
matter  showninredintheimagesbelow 

figure   dmodelofthe   kvoxelsinitiallyofinterest



theresultingdatasetisan  x       matrixwhererowsrepresentpatientsandcolumnsrepresent
featurevoxels toaccountforscalingdifferencesamongpatientsandgroupswenormalizedthedata
withineachrowandthenacrossallcolumns theoveralldataflowinoursystemismappedbelowinin
figure  




figure  flowchartfordataprocessingscheme

 




fi  recursivefeatureelimination rfe basedononeclasssvm
asthedatahassignificantlymorefeaturesthantrainingsamples reducingthefeaturessetisan
essentialsteptoproducingarobustclassifier inbinaryclassification astandardmethodologyfor
reducingfeaturesizeistotrainasupportvectormachineonthegivendataandrecursivelyremovethe
featureswiththesmallestweightsoftheprimarylagrangian however ourliteraturesurveyshowed
thatthereisnotaclearoptimalmethodtofeaturereductioninmulticlassscenarios 

mostmulticlassrfesolutionsareadirectextensionofthebinaryproblem concernedbypoorresultsin
variousbinaryclassifications weinsteadexperimentedwithalesscommonmethodofasingleclass
svm thesingleclasssvmisusedtofindinformationaboutadistribution andgivesasimilarsetof
weightstothebinarysvm however insteadofdeterminingahyperplanethatseparatestwodatasets 
theresultscanbeusedtodifferentiatesignalvoxelsfromnoise simulationswithsyntheticdata
demonstratedarobustbehaviorinlowsignaltonoiseratioenvironment     identificationof
markersina   snr  indicatingpotentialforamethodofindependentlyrefiningthefeaturesetfor
eachcategoryofpatient 

oncethelargestweightedvoxelsareidentifiedforeachclass theyarethenrecombinedintoatotal
regionofinterest specifically theregionsofthebrainwhichareactivatedbytwoormorepsychiatric
conditionsaremostvaluablenotonlyonanatomicallevel butalsotoidentifytheminimumnumberof
voxelsthatcanidentifyallfourclasses wethereforeexperimentedwiththreecombinationschemes a
unionofeachclasssfeatureset anintersectionofeachclasssfeatureset andthevoxelsthathaveat
leasttwoclassesincommon toverifytheseresults thesenewfeaturesetswerereformedbackinto 
dbrainspaceinordertoseeiftheactivatedareasofthebrainwereasexpected 


  multiclassclassification
usingthelibsvmmatlablibrary weimplementedtheonevs oneapproachfor classsvm
classification    thismethodfindsansvmclassifierforeachpossiblepairofthefourgroupswhich
resultsin classifiers then weusethemaxwinsstrategytoclassifyatestpatientintooneofthefour
categories foreachofthe decisionfunctions wecounthowmanytimestestpointxisclassifiedinto
eachclass andassignxtotheclasswiththemaximumnumberofvotes 




figure  briefcomparisonofthetwomulticlasssvmapproaches notethat inthisexample theonevsallapproachwill
requirethreemoresvmcomparisons

totrainthemulticlassclassifierwerandomlyselected  patientsfromeachofthefourgroups this
wasdonetoavoidusingunbalancedtrainingdataandbiastheclassificationalgorithm thesmallest
 


figroupwaspain at  patients whichledtotheselectionof  fromeachgroup initialstudiesincluded
thetestsampleforthefeatureselection leaveoneoutcrossvalidation loocv withthelinearkernel
onthereducedfeaturesetyieldedthebestresultsat     accuracy whilealltheotherkernels
returnedasteady  accuracy however whenweremovedthetestdatapointfromtherfe
calculation accuracyofthesystemplummetedbelow    

itwasaninitialsurprisetoseethatoneoutof  patientscouldhavesuchanimpactonthesvm
trainingdata toanalyzethisresult weexploredthedifferenceinthefeaturesetsofthegadcategory 
wefirstparedtheinitial       voxelsdowntoasetof    usingalleighteensamples thegolden
set  then weranidenticalrfesontheseventeenofthegadpatients leavingoutadifferentpatient
eachtime wecalculatedthepercentageofoverlapbetweenthegoldensetandthesetwithithelement
removed infigure  weseethatthechangeofonepatientchangestheentirefeaturesetby    
whichindicatesthatthevarianceinherentinthesingleclasssvmwillpreventitfrombeingastand
alonesolutionforfeaturereductioninanonlinepredictivesystem 

percent overlap of features with the golden feature set

   
  
  
  
  
  
  
  
  
  
 
 

 

 

 

 
  
ith patient left out

  

  

  

  

figure  impactofonemissingtrainingsampleinthecalcuationoftherfe



asafinaltesttoconfirmtheoverfittingbehavior werandomlyassignedour  patientsaclass then
ranthebogussetthroughthe classrfe usingthetestpointaswell andthentestedtheaccuracyof
thesystemthroughaonevs onesvm ratherunsurprisingly weobtained     accuracyin
categorizingthepatientstotheirbogusclass despitetheabsenceofanyactualunderlyinggiven
theseresults itwouldnotbeappropriatetoclaimhighaccuracyforthemulticlassclassification 
howeverwhatcameoutofthe classsvm arethebiomarkersforthevariousdisorders 


  identificationofbiomarkers

whilethevarianceinourrfemethodologypreventedouralgorithmfrombeingasuccessful
predictor thesystemshowedexcellentresultsinidentifyingregionsofthebrainthatareactivated
duringtheemotionalstimuli suchinformationhasvalueindesigningfuturefeaturereductionmethods 
asthegeneralareasarenowknown figure showstwoexampleoffeaturereductiondoneoneach
class thenplottedtogethertoshowcomparativeareasofactivation 

 


fi



figure  clusterofactivationintheinferiorfrontalgyrusinthecontrolgroup b areaofcommonactivationinthemedial
frontalgyrus

  summary

ultimately oursystemidentifiedthefollowingneuroanatomicalfeaturesthatwereactivatedin
patientsofdifferentpsychiatricconditions 
area
gad cmbd ctrl pain
function
par subl

x


somaticperception
sup f gyrus

x


selfawareness
med fgyrus
x



highlevelexecutivefunction
cingulategyrus
x

x
x
emotionformation processing
subgyral
x



respondstovisualsadnessstimuli
phgyrus

x


memoryencoding retrieval
inf parietal

x
x
x
visualprocessing
p c gyrus
x

x
x
touchsensation
acknowledgements
wewouldliketoacknowledgeandthankdr amitetkinanddr fumikohoeftofthedepartmentof
psychiatryatstanford theyprovideduswiththedatasetof  patientsandsharedwithusthe
knowledgeandcomputationalprogresstheyhadpreviouslymadeinthisfieldofstudy 

references

   c c changandc j lin      libsvm alibraryforsupportvectormachines 
http   www csie ntu edu tw  cjlin libsvm 
   f demartino etal      combiningmultivariatevoxelselectionandsupportvectormachines
formappingandclassificationoffmrispatialpatterns neuroimage v    pp      
www elsevier com locate ynimg 
   a etkin etal      resolvingemotionalconflict arolefortherostralanteriorcingulate
cortexinmodulatingactivityintheamygdala neuron v    pp        
   a etkin etal      failureofanteriorcingulatedactivationandconnectivitywiththeamygdala
duringimplicitregulationofemotionalprocessingingeneralizedanxietydisorder humanbrain
mappingannualconference sanfrancisco ca         
   a schatzberg a etkin a reiss m greicius      identificationofneuroimagingbiomarkers
duringemotionalprocessingandregulationinanxietyanddepressivedisorders unpublished
challengegrant 
   h zouandt hastie      regularizationandvariableselectionviatheelasticnet journalof
theroyalstatisticalsocietyseriesb v    pp        
 


fi