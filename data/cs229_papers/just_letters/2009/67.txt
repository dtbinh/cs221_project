does this shirt go with this tie 
monique ryan  dave willis  pranav khaitan

abstract
the aim of this project is a proof of concept for an internet apparel shopping assistant  we prove the concept by applying
supervised learning algorithms to automatically classify shirt and tie combinations as good matches or bad matches based on their
color and pattern features  since it is more important for the system to have a low false positive rate than a low classification
error the algorithms are tuned for high precision at the expense of classification error  this resulted in a precision of        with
       classification error  before precision tuning our best classification error is      our best results were achieved using
features of top   essential colors and a custom pattern complexity metric and svm with a quadratic kernel implemented as an
ensemble  investigations into other features and supervised learning algorithms are summarized 

  introduction
when shopping for clothes on internet shopping sites  the customer is commonly presented with tens to hundreds of images of
items available for purchase and no easy way to filter the images based on the suitability of the items in relation to items they
already own and other items they intend to purchase 
the aim of this project is to apply machine learning algorithms to data from images of pairings of clothing items to attempt to
classify them as matches or mismatches  we choose classification of shirt and tie combinations as matches or mismatches as a
starting point because the range of features relevant to matching shirts with ties is limited to color  texture and patterns in the
shirts and ties 
automation of the process of classifying combinations of clothing items as matches or mismatches would allow internet
shopping websites to filter the items displayed based on items the customer has purchased previously or already selected for
purchase 

  training data
the training data consists of pairs of images of shirts and ties  the class of positive training examples consists of a collection of
    expertly selected shirt and tie combinations culled from internet shopping sites  refer to figure   for examples 
the positive training data was generated by cropping a   x   image from each shirt and a   x   image from each tie 
the negative class was generated by combining cropped images of shirts and ties  initially the class of negative training examples
was generated by randomly selecting images of shirts from the collection and pairing them with randomly selected images of ties 
however  a visual inspection of the resulting shirt tie combinations revealed that over     of this set of shirt tie combinations
were considered to be good matches by all three team members  this is probably due to the high proportion of ties in the
collection that by design go with a high number of the shirts in the collection  for example there were a high number of pale blue
shirts and dark blue ties 
a second set of negative training examples was generated by pairing randomly selected shirts and ties from the raw images and
displaying them to users who classified each of the pairings as matches or mismatches  a shirt and tie pair was added to the
negative class if two users independently classified the combination as a mismatch  this approach aimed to minimize the effect
of personal preference on the classification of combinations as matches or mismatches      negative training examples were
generated this way and used in all subsequent evaluation of the system 
the negative training set used in this project is somewhat limited since it only includes obvious mismatches  a number of
shirt tie combinations that could be described as mild mismatches were excluded from the dataset  however  the dataset used in
this project is considered adequate for a proof of concept study 
if it were available  we believe that the ideal data set for training a system like this would be a set of graded preference data
averaged over a range of people  this could be gathered by asking a number of people of rate how much they liked particular
shirt tie combinations on a scale eg      

   feature selection
the features considered were primarily color and pattern of the shirts and ties  a combination of color and pattern features is
used to train the classifier in the final solution  all feature generation was performed using matlab 

    color features
the color features used in the final solution consisted of the top two rgb values of the shirt and tie 
a custom function was developed to extract the top n colors from an image by percentage of pixels  when passed the parameter
n  number of colors to consider  the function returns a feature matrix whose rows consist of the rgb values of the top n shirt
colors  followed by the top n tie colors  when passed a flag  the function would also include the percentage of each color in the
feature matrix returned  this function is implemented as follows 
  
  
  

use k means clustering to group the colors into n clusters 
combine very similar colors until only the essential colors remain 
an empty color is filled in with the top color at   percent 

fithe output of this algorithm for two cropped images and n     is shown in figure    each cropped image has two versions  the
original on the left and the output of this algorithm on the right  the numbers are the rgb colors and percentage 

figure    output of color extraction function with n      percentages flag true 
a number of feature matrices were generated using this function with varying values of n and with and without color
percentages  the best results were achieved with n   without color percentages  the resulting feature matrix was therefore an
m by   matrix where m is the number of training samples  consisting of the three rgb values for each of the top two colors in
the shirt and the tie 
a number of options were considered as possible color features  each of the options was evaluated by training an svm classifier
on the resulting feature matrix and evaluating the classifier using     holdout cross validation  a comparison of the different
feature options is in the results section 
average shirt color and average tie color  initially average rgb colors were calculated over all the pixels in the shirt and
all the pixels in the tie resulting in a feature matrix with   columns  this method of generating color features would be expected
to perform poorly on shirts and ties with multiple colors 
rgb vs  hsv color model  both average rgb color and average hsv color features were generated for comparison 
because hsv  hue  saturation and value   brightness  is used in color theory literature     to define color harmony and contrast
we posited representing color using the hsv numbers would produce better results  however comparative results for average
rgb were superior 
color histogram  a color histogram specifies n color buckets and records the number of pixels in an image that fall into each
the n buckets  initial experiments using the color histogram as input features for the classifier were not promising  intuitively
this is to be expected as it involves grouping a range of colors together  which can lose subtle distinctions  it is often the case that
two similar colors  eg two similar shades of blue  go together well while a different set of similar blues will not 
color distance measurement  color theory literature               defines a number of traditional color palettes that work well
and appear harmonious  these color schemes can be defined in terms of the relative position of the colors on the color wheel 
examples include monochromatic color scheme  analogous color scheme and complementary colors  a measurement of the
distance between two sets of colors was attempted where a small difference indicates the two sets of colors are harmonious and a
large distance indicates they are not  the results were inferior to average rgb color  with this experience we agree with
professor bokor  department of psychology  university of virginia who wrote 
a uniform metric for the perception of color has remained something of a mirage  at once seeming to be easily attainable and
yet always just out of reach

    pattern features
the pattern features used in the final solution are based on a metric related to the discrete cosine transforms  dct  of the shirt
and tie images  this metric is a measure of the visual boldness or complexity of the image  we observed that in the class of
matching shirts and ties  there is an inverse correlation between the visual boldness of the shirt and the visual boldness of the tie 
that is  a bold complex tie should be paired with a plain shirt and vice versa 
the boldness metric was calculated as follows 
  
  

calculate the dct of each row and column of the image and store the dct coefficients 
calculate the weighted average of the dct coefficients of the image  over all rows  columns and rgb components 
using an exponentially decreasing weight for higher frequency components and a weight of   for the  hz component 

examples of patterns and the values of the complexity metric for the images follow in figure   

     
      
     
     
figure    examples of patterns and their corresponding complexity values

fitwo broad approaches were considered for specifying the pattern features observed in shirts and ties 
detecting edges within patterns  this approach involves converting the image to grayscale and detecting edges in the pattern to
determine characteristics of the pattern  for example  does the pattern contain stripes or spots and how wide are the stripes or
spots  this approach could also be used to define and average boldness complexity metric by summing the number of pixels that
correspond to edges in the image  the limitation of this approach is that it fails to account for the interaction between the
magnitude of changes in color and the visual complexity or boldness of the image 
discrete cosine transform components  this approach involves extracting features from the dct coefficients of the image 
when considering dct components to define a complexity boldness metric the two primary variables that were considered were
which frequency components are most significant and how to combine the results over all the rows and columns of the image and
the rgb components of the image 

  supervised learning algorithms
the final implementation used an svm classifier with a quadratic kernel implemented using matlabs biometrics toolbox  the
svm classifier was run separately on the color and pattern features and the resulting classifications were combined using an
ensemble method that classified a shirt and tie combination as a match if both the color and pattern features were classified as
matches and a mismatch otherwise  this approach was taken to increase the precision of the classifier at the expense of a higher
classification error since intuitively  a shirt and tie combination will only match if both the colors and the patterns are a match 
the features described above produced data that is non gaussian and inter dependent leading us to chose logistic regression
and svm as our supervised learning algorithms  the ensemble method was chosen to reduce the number of false positives 
these classifiers were evaluated using a range of different input features and using     holdout cross validation  refer to the
results section for a comparison of the results of the svm classifier and the logistic regression classifier 

  results
the system was evaluated using     holdout cross validation with a dataset containing     positive training examples and    
negative training examples  the table below shows the comparative error and precision results obtained using the features and
supervised learning algorithms described above  for these experiments we held the decision boundary constant at     

features
average rgb color

error

logistic regression

svm  linear
kernel

svm  quadratic
kernel

classification
     
     
     
error
precision
     
     
     
average hsv color
classification
     
     
     
error
precision
     
     
     
patterns only
classification
     
     
     
error
precision
     
     
     
top three colors only classification
     
     
     
error
precision
     
     
     
top two colors only
classification
     
     
     
error
precision
     
     
     
top two colors  
classification
     
     
     
patterns
error
precision
     
     
     
top two colors  
classification
     
     
     
pattern   ensemble
error
precision
     
     
     
the svm classifier using the quadratic kernel and ensemble method for color and pattern features with top two colors and the
pattern complexity metric used as input features gave the highest precision           
since it is considered more important for the system to have a low false positive rate than a low overall classification error  based
on the roc curve  the svm soft margin classifiers  c   c   were tuned to increase the precision at the expense of increasing the
overall classification error 

firoc curve   varying costs
 

         
                   
         

   

         
         
         
         

   

true positive rate

   

         
         

   
   
   
   
   

         
         
         
         

         

   
         
           
 
   

figure   precision learning curve  c       c     

figure    classification error learning curve
c       c         tuned for high precision 

   

   

   
   
   
false positive rate

   

   

   

 

figure    roc curve

figure    precision learning curve
c       c         tuned for high precision 

this resulted in a final solution with        precision and        overall classification error with soft margin classifiers at    
and     

 

conclusions and future work

we believe that this implementation has proved that the concept of designing a classifier for matching or non matching shirt and
tie combinations with high precision is feasible using machine learning algorithms 
the high precision achieved by the final solution comes at the expense of a relatively high overall classification error  around
      however  it was possible to achieve a classification error as low as       using a different set of features and combination
of algorithms 
it is intuitively infeasible for a classifier of this kind using only pass fail data to aim for an overall classification error close to
     due to the variability between individuals in what constitutes a good match and what constitutes a mismatch and the
difficulty of mathematically quantifying features relevant to the overall harmony of the ensemble 
the pattern boldness metric  that was developed to quantify shirt and tie pattern complexity performed relatively well  an
overall classification error of     was recorded when the svm classifier was trained with pattern data alone  however  certain
shirt tie combinations would always be misclassified using this metric  the four images below all appear in the positive training
set  the two images on the left  a  b  are always misclassified as mismatches using our complexity metric and the two images on
the right  c  d  are classified as matches  intuitively  the reason for the misclassification of  a  b  is that both the shirt and tie are
assigned a high complexity value which is unusual  it is possible that a more sophisticated feature set to describe patterns would
lead to improved classification  a possible direction of further inquiry would be to investigate which dct components were
most relevant in pattern classification using principle components analysis 
using graded preference data may also improve results in this area since  a  b  may not be universally accepted as matches 

fifigure    a 

 b 

 c 

 d 

the color features also performed quite well considering the limitations on the available training data  an overall classification
error of     was recorded when the svm classifier was trained with color data alone  two top colors   examination of the false
positives and false negatives returned by this classifier revealed two primary trends  shirt tie combinations where the shirt or tie
is purple or green are likely to be misclassified as mismatches  this suggests that purple and green may be over represented in
the negative training class and under represented in the positive training class  leading the classifier to classify all purple or green
shirts and ties as mismatches 
combinations with more than two significant colors are likely to be misclassified  for example a blue and white shirt containing
fine orange stripes will clash with a maroon colored tie however the classifier will often report a false positive on this
combination  figure   a  b   this is to be expected as the classifier only considers the top two colors 
colors where the mismatch is between two subtly different colors are also often misclassified  figure   c  d  

figure    a 

 b 

 c 

 d 

it is possible that using a larger training set with a more even distribution of colors would improve results in this area  the
training graphs for the classifier when trained on the top   colors and the top two colors are shown below  the training graph for
the top   colors suggests that more data could improve the final precision since the training error is low 

figure     learning curve   colors

figure     learning curve   colors

one of the limitations of this system is variability caused by personal preference in the negative training data  most work in this
area uses graded preference data     which would probably be more appropriate than pass or fail training data 
another possible direction for further work would be to investigate customizing the system to account for personal preferences 

references
    stephen palmer  vision science  photons to phenomenology   bradford books  mit press  cambridge  ma      
    stephen palmer  karen schloss  color aesthetics  the berkeley color project  visual perception and aesthetics lab 
      university of california berkeley   http   socrates berkeley edu  plab color html 
    malane newman  color theory   the color wheel  malanenewman       
 http   www malanenewman com color theory color wheel html 
    igor asselbergs  misc archives  livelygrey com        http   www livelygrey com misc 
    pabini gabriel petit color theory for digital displays  a quick reference  part i uxmatters  jan      
 http   www uxmatters com mt archives         color theory for digital displays a quick reference part i php 

fi