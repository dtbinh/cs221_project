mri based machine learning for identification of novel subtypes in autism
divye khilnani  chris piech  sudarshan thitte
in this study of children with idiopathic autism 
multivariate unsupervised and supervised learning of
structural magnetic resonance images  mri  revealed a
novel subtype of autism that was characterized by
meaningful grey matter anomalies and was predictive of
behavioral outcome  given that previous studies have
failed to identify neurobiological subtypes of autism that
are clinically meaningful  these findings underscore  a 
the importance of utilizing machine learning algorithms
to explore neurobiological motifs  and  b  the potential
utility of brain based machine learning in clinical
practice 

i  introduction
autism is currently the fastest growing developmental
disability      however  despite the increasing prevalence
of autism  little is known about its causes or cures and
exploration into developmental prognosis has been stunted
by the low predictive validity of behavioral measures     
leshner et al  argue that this contemporary lack of
understanding stems from the inability to identify
biologically significant sub populations      using
leshners analysis as inspiration the goal of this paper is to
apply machine learning towards unraveling new
neurological based subtypes 
in this analysis we cluster segmented grey matter from
mri scans of     boys   age        years               
diagnosed with autism     typically developing  td 
controls and    controls with idiopathic developmental
delay  dd   and examine if these clusters are clinically
meaningful  our approach to this problem forms a natural
application for machine learning and can be viewed as an
instance of unsupervised learning on high dimensional 
noisy data  the measure of success that we use is  clusters
that define a subtype of autism must     be robust and
quantitatively distinct      have significant correlation with
measurable behaviors and     reflect plausible
neurobiological patterns which are associated with the
observed behaviors 
previous biologically based analysis of autism has
attempted to categorize the disorder through univariate or
coarse multivariate brain regions and until now has been
unable to determine explicit subtypes  the seminal paper in
this area by hrdlicka et al amalgamated the fine grey
matter mri information into seven coarse brain
measurements based on strong a priori assumptions     
though their results were instrumental in demonstrating
the potential for analyzing structural mri  they were
unable to deduce meaningful patterns  implementing their
methodology on our data set demonstrates subtypes that are

not distinct by general measures and hold no behavioral
correlations  given autism has an intricate neural
foundation  we hypothesize that  a coarse feature reduction
could hide information critical for understanding patterns
in autistic brains  based on this hypothesis we perform a
novel application of unsupervised learning methodology
directly onto carefully preprocessed high dimensional fine
grey matter volume autistic mri scans 
this unique application produces results that
significantly improve on the industry standard of
behavioral prognosis and reveals clusters that meet the
initial subtype criteria 

ii  pre processing
we are provided grey matter data derived from mri
scans that were mapped into a standard  mm voxel brain
space using modulated spatial normalization  additional
preprocessing is performed as follows 
initially  we adjust our data for age  scan site and total
grey matter volume  values are adjusted by performing
linear multiple regression with age  scan site and total gm
volume as independent variables and subtracting the
calculated residuals from the mri data 
then  due to the sparse high dimensional nature of our
data we choose to reduce the number of voxels considered 
we try to eliminate voxels based on  a  recursive feature
elimination using weights from a linear support vector
machine  svm  that separates autistic subjects from
controls   b  regression between each voxel and temporal
change in behavior characteristics and  c  an upper bound
selection of brains areas found to be important for autism
based on research by amaral et al      of the feature
reduction methods considered  the amaral based reduction
produces the best performance improvement 
overall these preprocessing steps result in a higher
degree of uniformity across all subjects and reduce the
level of noise in the data  this preprocessing yields     
improvement in cluster strength  measured as ccc  refer
to section iii  

iii  unsupervised clustering
one of the most crucial steps in this analysis is to
identify robust  quantitatively distinct clusters within the
set of autistic patients  to obtain these clusters we apply
three separate unsupervised techniques commonly used in
the field of structural mri analysis  hierarchical
agglomerative clustering  hac   spectral clustering  sc 
and general mixture models  gmm  

fi   hac clustering
recently  stedman et al demonstrated the use of hac
on grey matter mri data in order to uncover nuanced
neural patterns      given this precedent  we apply hac to
our dataset  to agglomerate clusters  we use a ward linkage
criterion that minimizes the error of sum squares with the
euclidean squared distance dissimilarity metric  in
contemporary structural mri and brain psychology
literature  euclidean distance has been demonstrated to be
an accurate dissimilarity metric     and ward linkage is an
efficient way to obtain clusters with minimized variance 
this method provides two distinct clusters  a larger
cluster of    autistic children  which we refer to as the
alpha cluster  and a smaller cluster of    autistic children 
which we refer to as the beta cluster  to objectively
determine the correctness of hac we apply the hac
specific cophenetic correlation coefficient  ccc  test
scaled from   to   where   represents the ideal ccc and
    is the threshold for considering a cluster to be
significant      the clusters obtain a ccc value of        
which is strong evidence that hac has identified two
natural clusters 
to visually demonstrate these results we project clusters
alpha and beta onto the primary principle components
 pc   see figure     while only     of the entire brain
matrix can be represented on three pcs  the first three pcs
reflect     of the variance between the clusters 
autism clusters graphed on principle components
  

  

principle component  

  

  

 

   

   

   

   

    

    

labels  the results are     similar to those obtained using
hac 
   general mixture models
another clustering method commonly used in the
domain of mri scans is gmm  this method uncovers two
independent component distributions with high peaks 
which implies there are two tight clusters  the labels
obtained through gmm are identical to those obtained
from sc and are highly similar to those found using hac 
these three independent clustering methods obtain
highly similar clusters  this supports the hypothesis that
the dataset of autistic children has two natural clusters and
that the alpha and beta clusters are legitimate 
general clustering validation
even though the clusters appear to be highly distinct  to
consider them to be formal subtypes we must show that 
    these clusters are numerically separate when measured
using general cluster tests and     they give the same
results when the input is perturbed by an appropriate
amount of noise  to test these criteria we use
homogeneity separation  hs   silhouette  and weighted
average discrepant pairs  wadp  general cluster
validation measures  hs measures the ratio of homogeneity
to separation where separation is the average euclidean
distance between clusters weighted by cluster size 
silhouette measures the ratio of homogeneity to separation
where separation for sample i is the max euclidean
distance from i to another sample j normalized to the range
   to    wadp measures how many cluster labels change
when each matrix feature is perturbed by normally
distributed noise with mean   and variance equal to the
log ratio of that feature across all samples       we repeat
each of the tests for different number of clusters  k  to
confirm that the analysis should be performed on two
clusters  hs and silhouette are maximized and wadp
discrepancy is minimized at k     
clustering
hac
gmm   spec

hs ratio
    
    

silhouette
     
     

wadp
     
     

 
  

  

  

 

   

   

   

principle component  

   

    

    
   

principle component  

figure    alpha  red  and beta  blue  clusters

   spectral clustering
as demonstrated by wassermann et al      sc is wellsuited choice for sparse data such as mri scans  the sc
algorithm uses the spectrum of the data point similarity
matrix to retain select features that cause maximum intracluster similarity and minimum inter cluster similarity 
though this method produces slightly different cluster

figure    general validation measures

we observe that hac clustering outperforms both
gmm and sc  thus we continue subtype analysis using
the alpha and beta clusters  moreover  hac performed
well on all three validation tests  the high hs ratio and
silhouette scores quantitatively demonstrate that the
variance between the alpha and beta clusters is more
significant than the variance within each cluster  the
wadp test shows that the clusters give the same results
even with additional noise 
finally  to confirm the validity of the entire process we

fiapply the same pre process and clustering methodology to
a combined set of control and autistic mri scans  this
approach yields three clusters  ccc of          a control
cluster  the alpha cluster and the beta cluster  since the
preprocessing steps used in this paper and the euclidean
hac clustering algorithm successfully separate the control
brains from autistic brains we conclude that our procedure
is applicable to the domain of autistic mri scans 

the adi rs and ados s slope behavior tests  the autistic
children in the beta cluster had positive mean values
 adi rs          while the autistic children in the alpha
cluster had negative mean values  adi rs            this
suggests that the repetitive symptoms of alpha group
improved over time whereas the repetitive symptoms of the
beta group worsened 
stereotypical autism t test

iv  behavior characterization of clusters

univariate analysis
first we run welshs null hypothesis univariate tests
 wnh   a version of the standard t test that accounts for
different sample sizes  on the behavior characteristics of
the alpha and beta subgroups  for each set of scores for a
behavior  b such that but  we split the scores by
their alpha and beta labels  we then run nht to test the
hypothesis that the two sets of scores are samples from the
same gaussian distribution against the hypothesis that they
are samples
from separate gaussians  the general
threshold for discarding the null hypothesis is a p value of
     
of the behavioral tests  the adi repetitive and
stereotyped behavior  adi rs  test and the ados
stereotyped  ados s  test  two distinct measures of a
childs repetitive physical behavior of autism  such as hand
flapping and body rocking  referred to by amaral et al as
repetitive behaviors   pass the nht with significance
measures of p          and p         respectively 
however to take into account the probability of false
positives given multiple tests  we apply the bonferroni
correction       resulting in a stringent p threshold of
        since the significance level of adi rs test is
below the bonferroni threshold  it is exceedingly likely that
the adi rs distinction  figure    is a strong alpha beta

correlation  another interesting observation is that in both

   

   

p

our next step is to determine whether there are
meaningful trends between the alpha and beta clusters and
the behaviors of the corresponding autistic children  for
each child  behavioral data was measured using a set of
quantifiable tests  which are typically used to diagnose or
characterize autism  these tests were performed once at the
time when the structural mri scans were taken  time
initial tests denoted t   and again after two to three years 
our longitudinal tests are performed on the variability
measured as change in score per year  slope tests denoted
  to account for inconsistency in how much time elapsed
between the two tests for each patient  in order to explore
possible trends  we apply univariate  linear multivariate
and kernalized multivariate analysis between the alphabeta group labels and the t  and  tests 

   

   

   

 
    

  

    

  

    

 

   

 

   

 

score

figure    adi rs test showing the alpha distribution  red  and
beta distribution  blue 

this is a highly noteworthy result as it shows that the
two natural clusters uncovered have a strong univariate
longitudinal behavioral trend 
multivariate analysis
in order to determine how well our labels could predict
a collection of behaviors  we perform multivariate analysis
between the discovered groups and the recorded behavior
scores  this experiment was implemented using a svm
classifier with a linear kernel between the alpha beta
cluster labels and both the t  and  behaviors  to measure
how well the svm could separate behavior trends with
respect to each cluster  we use leave one out cross
validation  loocv  to calculate accuracy  acc  
sensitivity  sen   specificity  spe   positive predictive
value  ppv  and negative predictive value  npv  
to understand how our results compare to chance we
apply a permutation analysis  pa  algorithm that
calculates the mean    and standard deviation    of each
metric  under the assumption that the metrics are
distributed normally  and use the resulting distribution to
homogenize our results  in order to evaluate i and  i
such that i  metr ics we repeat the following process
until i and  i converge      assign random cluster labels
in proportion to each subject      evaluate how an svm

performs 
measured by metric i     
update 
i and  i to
incorporate the results 






fimetric slope time initial
acc
    
    
sen
    
    
spe
    
    
ppv
    
    
npv
    
    
figure    behavior svm metric percentiles

using the svm with clusters alpha and beta we obtain
the above loocv results  figure    
since all the loocv metrics are substantially above
chance    th percentile  these results imply that there is a
robust behavioral distinction  both in t  and   between
the alpha and beta subgroups and demonstrates that the
two clusters have behavioral manifestations  moreover 
though the alpha and beta clusters perform well at
separating t   the clusters are substantially better at
distinguishing  measures  meaning that the alpha beta
distinction is more precise at predicting future behavior 
because the behavior matrices are normalized  the
weights used by the svm represent how important each of
the behavior tests are in separating the alpha and beta
clusters 
behavior test
slope weights
adi repetitive and stereotyped
     
ados stereotyped
     
behavior test
adi repetitive and stereotyped
vineland communication

time initial
     
      

figure    behavior svm weights for slope and time initial

the behavior test weights in figure   are important for
three reasons     the most substantial differences in the
weights  especially for   are from tests which measured
repetitive and stereotyped behaviors     the parities for
the repetitive behavior tests are internally consistent in
denoting that autistic children in the beta group have more
severe symptoms and     as expected  the weighted
features agree with the univariate analysis  overall  this
demonstrates a meaningful pattern in behaviors and as a
result provides powerful evidence for the hypothesis that
the alpha and beta clusters represent different subgroups
of autism 
kernalized multivariate analysis
to account for potential non linear relationships
between behavior and the alpha and beta clusters  we
perform multivariate analysis using different kernels  as
figure   demonstrates  the linear kernel out performs other
kernels 
since the non linear kernels have high loocv testing
error with relatively low training error  it seems that the

non linear kernels over fit the data  this conclusion is
reasonable  considering the small training set size relative
to number of features used to train the svm 
metric
acc
sen
spe
ppv
npv

linear
    
    
    
    
    

quadratic
    
    
    
    
    

radial basis
    
    
    
    
    

polynomial
    
    
    
    
    

figure    kernalized svm metrics

v  brain analysis
the final step in our subtype analysis is to examine the
structural mri differences between the alpha and beta
clusters  in order to quantify the grey matter differences we
use three different methods      we calculate the centroids
of the two clusters and find the difference vector between
them      we use the primal eigen brain  since     of the
variance between the two clusters is expressed by the first
principle component  and     we train a svm to label
brains as either alpha or beta and extract the weights used
by this svm  for each of the vectors obtained we
reconstruct average grey matter brain images by reversing
the normalization stages of our preprocessing pipeline 
the brains representative of the difference between the
alpha and beta clusters  figure    show several important
patterns  the most prominent and consistent difference that
emerges from these brains is the grey matter difference in
the thalamus region  the lower lobes of the diencephalon 
in the center of the brain   across all three methods of
viewing the differences between clusters  the beta cluster
has significantly less grey matter in the core of the
thalamus  furthermore  in both the centroid and pc brains
the alpha and beta clusters are distinguished by amount of
grey matter in the orbitofrontal cortex  the large red
activation above the nose  and the medial prefrontal
cortex  the thin red strip in front of the thalamus  
moreover  the alpha and beta clusters also show
substantial grey matter volume differences in the posterior
vermis of the cerebellum  the lower region of the
cerebellum  and in the caudate region 
according to amaral  two of the four most important
regions of the brain for determining repetitive and
stereotypical behavior characteristics of autism are the
thalamus and the frontal cortex      moreover  other
research has hypothesized that repetitive behaviors can
also be attributed to the vermis and the caudate      
finally the alpha and beta clusters also demonstrate
differences in the hippocampus  small blue region behind

fifigure    grey matter differences measured by centroid difference  top   pca  middle  and svm weights  bottom 

the orbitofrontal cortex   though this region has not been
noted as deterministic for repetitive behaviors it is
considered to be highly significant for autism in general 
thus  the regions of the brain with the largest observed
differences between the alpha and beta group correspond
to regions that are thought to cause the behaviors these
clusters predicted  this provides strong reinforcement
towards the hypothesis that the alpha and beta clusters
represent meaningful subtypes of autism  furthermore 
while different regions have been hypothesized
individually to cause repetitive behaviors the differences
between the alpha and beta clusters could lead to further
insight on how their combinations affect repetitive
behaviors in autistic children 

vi  conclusion
in the hopes of facilitating future diagnosis our project
culminated in the development of an autism sub type
classification tool  the classification tool uses svm to
identify whether a patient suffers from beta autism or not
and can make inferences regarding future undesirable
behavioral characteristics that the child may suffer from 
based on this classification 
overall this project provides strong evidence that the
beta cluster is a valid subtype of autism that is
characterized by repetitive behaviors  given the possible
applications of discovering a new autism subtype  this
finding suggests that more exploration should be done to
cement understanding of beta cluster autism 

acknowledgements
this project was undertaken with the guidance of
fumiko hoeft  she made the data available to us  and gave
us support and advice throughout the project  we would
also like to thank catie chang for her valuable suggestions 

finally we worked in collaboration with joseph huang and
anand iyer and we look forward to extending this research
with them 

bibliography
    james rimmer  david braddock  kenneth pitetti 
research on physical activity and disability  an emerging
national priority        
    tony charman  emma taylor  auriol drew  helen
cockerill  jo anne brown  and gillian baird  outcome of
children diagnosed with autism at age    predictive
validity       
    altevogt bm  hanson sl  leshner ai  autism and the
environment  challenges and opportunities for research
       
    hrdlicka m  dudova i  beranova i  lisy j  belsan t 
neuwirth j  komarek v  faladova l  havlovicova m 
sedlacek z  blatny m  urbanek t   subtypes of autism by
cluster analysis based on structural mri data        
    amaral dg  schumann cm  nordahl cw neuroanatomy of autism        
    j d  stedman and n m  spyrou  hierarchical clustering
into groups of human brain regions according to elemental
composition        
    laurent itti  linda chang  and thomas ernst 
automatic scan prescription for brain mri        
    sokal  r  r  and rohlf f  j   the comparison of
dendrograms by objective methods        
    demian wassermann  maxime descoteaux and rachid
deriche  recovering cerebral white matter structures with
spectral clustering of diffusion mri data        
     amy v  kapp and robert tibshirani   are clusters found
in one dataset present in another dataset         
     herv abdi  the bonferonni and idk
corrections for multiple comparisons        
     l  sears  c  vest  s  mohamed  j  bailey and b  ranson an mri study of the basal ganglia in autism        

fi