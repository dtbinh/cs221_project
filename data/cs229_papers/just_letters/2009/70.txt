learning the statistics of wireless links
q learning approach
sina firouzabadi
december         

  introduction
here we will present the problem formulation for our network optimization problem in wireless context  the idea
is to solve this problem using a technique called q learning  this technique is based on stochastic approximation
theory and deals with stochastic optimization problems without prior knowledge on the underlying distributions  the
algorithm tries to learn the statistics by sampling from the channel states and updating the policies accordingly  in
our formulation we deal with an optimization problem where we have some constraints on the expected value of the
optimization variables  we tackle this problem with a tool from reinforcement learning literature called full recurse
optimization with expected constraints  froec  this approach is an online discrete time approach for optimization 
it takes as input a sequence of samples from the randomness of the network and produces as its output estimates of
the optimal policy values  the heart of froec is to use stochastic approximation to learn the statistics of the problem
and update the control variables in order to get closer to the optimal solution in time 
the main premise of this research is to find optimal adaptive policies to manage self interfering networks under
power  rate and reliability constraints  in a distributed fashion  to be realistic  the inherent decentralized nature of
wireless networks mandates that distributed network algorithms be developed to implement our joint optimization 
seeking to find distributed algorithms for specific optimization problems is challenging in general  the main idea
that we have now  is based on the decomposition of the problem in both the primal and the dual domain into simpler
subproblems and trying to combine the results based on the primal dual principle  the decomposition of optimization
problems via primal dual methods has a long history  using such a decomposition  many large scale optimization
problems can be solved via iterative algorithms that can be implemented in a distributed fashion  such as in     
in other cases  primal dual methods allow the decomposition of the original problem into independent and simpler
subproblems that otherwise would have to be solved jointly  this rationale has been widely adopted to obtain viable
design methods and distributed implementation of optimal network paradigms  such as  for instance  in      the
paper     provides a recent overview  including a rich collection of references on the subject of decomposition via
primal dual principles 
in the remainder of this report  i will describe the problem formally for a simple case where we only have one
link and show how one can use q leaning techniques to solve the aforementioned stochastic optimization problem in
a distributed fashion 

  problem formulation
suppose that we have m logical source destination pairs and l links in the network  each source and destination is
associated with an upper layer protocol stack  the flow of information over the network from a logical source to a
logical destination  possibly over multiple links  is termed an information flow  flows from different sources m may
traverse the same link l  the routing of information flows over links is described by the routing matrix a  where
a l  m      if information on flow m traverses link l and is otherwise zero 
for the mth data session  assume rm denotes the rate of information sent into the link encoder  the encoder uses
block convolutional codes  which add additional bits to the information flow to enhance error detection and recovery 
the ratio of the total number of useful information bits to the total number of bits exiting the encoder per unit time is
 

fitermed the code rate    l     encoded bits are removed from the link buffer and transmitted by the wireless link
at rate rl   therefore  he rate at which useful information is transmitted across the link is l rl  
the channel is modeled by a channel state  gain  matrix g  rll   where gij is the power gain from the
transmitter on link j to the receiver on link i  we assume that this channel state matrix g is an stationary and ergodic
random process with some distribution which is unknown to the network  we also assume the channel state is estimated
without error and is known at the set of transmitters  the vector of transmitter powers is given by s  rl    each
transmitter  say at link l  has an average power budget sl   for simplicity  the link rate function is assumed to be of the
form
 
kgll sl
l           l
   
rl  s  g    log p
j  l glj sj   nl

where k is is fixed and scales the received power     and nl is the variance of the noise at the receiver of lth
link  clearly  this rate formulation has an underlying high sinr assumption  note that we could use the general rate
formula in our problem formulation  in other words  the underlying assumption of high signal to noise ratio can be
lifted and the optimization problem would still remain in the realm of convex optimization  this can be done  simply
by adopting exactly the same trick proposed in     for overcoming the non convexity of the capacity formula  with no
assumption on high sinr  however  using this trick makes the equations messy  therefore  for the sake of simplicity 
hereon we will use the high sinr assumption which is also valid for many practical scenarios 
the error probability of bits flowing over the link is defined as x   and is assumed to be an increasing function
of the code rate    explicit expressions for x   are difficult to find and we use the upper bound
  n  r   
 
   
 
where n is the code block length used by the encoder and r  is the cutoff rate      then  the reliability of an
information flow m is defined     by m as follows  
x    

     at x  

   

where at x   is the sum of the error rates on the links traversed by the flow 
the performance of upper layer protocols are modeled as utility functions  each source m has a utility function u  rm   m    utility functions are strictly concave increasing functions of the information rate and information
reliability  in this work  we use the following parameterized family of utility functions 
u  r       log r         log 

   

where        weights the relative importance of information rate and reliability 
the system can adapt to changing channel conditions by estimating g and adapting parameters such as transmit
power s   s g   transmitter link rate r   r s g   g   the information rate r   r g   code rate  g  and
information reliability  g  
the following is the specification of an instance of wnum problem that we will address hereafter 
problem       w num problem  given the above definitions  find adaptive  rate vector r g   reliability vector  g 
and power policies s g  that maximize the average utility of the network  under constraints on information rates  link
rates  reliability and average power transmitted  in the following sense
 
 
x
maximize   e
um  rm  g   m  g  
   
m

subject to  

e  sl  g    sl l            l 

   

e  a r    e   diag  g   r s g   g   




e  g      e at x  g  

   

     g     
     g     
  in

this work we reserved underlined letters for representing variables which are in vector form
respect to changes in the channel state

  with

 

   
   
    

fiwhere e is the expectation operator and optimization variables are s g   r g    g    g  
note that the aforementioned problem is not in the class of convex optimization problems  directly  yet  using a
set of change of variables and reformulating the rate constraints of the links in     we first want to show the above
optimization problem can be casted as a convex optimization problem  in particular if we define s g    log s g   
 g    log  g   and r g    log r g    we can re write our wnum as  

maximize  
subject to  

e

 

x

 

um  rm  g   m  g  

m

    

h
i
e exp sl  g    sl   l            l 

    

e    g     e   r  s g    g  

    

log a l     r    log  l  g     log l  g    
i
h


e  g      e at x   g  

l            l 

    
    

     g     

    

     g     

    

where           is replaced for rate constraints     by introducing auxiliary vector variable  g   we can solve
this problem by utilizing full recurse optimization with expected constraints  froec  this approach is an online
discrete time approach for optimization  it takes as input the sequence of channel states seen by the network and
produces as its output estimates of the optimal policy values  the heart of froec is to use stochastic approximation to
learn the statistics of the problem and update the control variables in order to get closer to the optimal solution in time 
as a byproduct froec produces the optimal lagrange multipliers associated with constraints in            the time
index is t  and we indicate the estimates of optimal lagrange multiplier  by t   policy values are denoted by rt  
r gt   t    s t   s gt   t    and rt   r gt   t    etc  froec does not assume knowledge of p g   the distribution of
channel state matrix  and under suitable conditions adjusts to changes in the channels empirical distribution 
froec solves the dual problem to      where the dual function is defined as
g       max l   r g    s g     g     g     g      

    



where      r g    s g         g             g        and

l      e

 
x
m

um  rm   m   

l
x
l  



l

 x
s l esl  sl 
 l  l  rl  s  g  

l
x

l  

q l  log a l     r    log l    log l   

l  

m
x

m  

 m




l      a    m  x   
t

 

    

we define      s      q      as the vector of lagrange multipliers  now our original problem is equivalent
to solve the following problem in the dual domain 
min g    

  

    

the method proposed in     for solving this problem is to solve this dual problem with a gradient decent method
by updating the lagrange multipliers  gradually  utilizing stochastic approximation  it has been shown in     that
  prices

 

fiby neglecting the expected value at each iteration and solving      for a fixed measured g at each time step  we can
still update the prices and converge to the optimal solution  the whole premise of our work here is to observe that
in each time step  we can have one step further and solve the lagrangian      within an internal loop via another
gradient decent method  the solution we propose is to use the primal dual algorithm  the primal step consists of an
optimization problem that solves      iteratively via a gradient decent method  and the dual step is a simple price 
update  both of these steps calculate the subgradient from the sampled channel gain and update their variables  in this
case it can be seen that in solving      iteratively  each variable needs local information to update itself and converge to
the optimum and in this way the whole optimization problem can be decomposed  in the next section we will illustrate
the performance of this primal dual approach and the learning rate of the algorithm 

  simulations
in this section  we illustrate the performance of the primal dual approach and its convergence via simulations  in
particular  we illustrate the steady state performance of primal dual optimal policies and finally check the convergence
of the algorithm to the global maximum by checking the kkt conditions  here we consider a wireless network with
l      interfering links with m     data sessions and use the utility function described by      in order to illustrate
the distributed implementation  we also assume that the first five links are physically apart from the last five links so
that these two groups of link do no interfere with each other  the channel state matrix g is drawn iid rayleigh with
the diagonal elements scaled to yield an average sinr of   db over all links  the transmitter power limit is s      
for the sake of simplicity  we adopt the link rate based on the high sinr regime  therefore  we use     as the link rate
function 
figure   show the rates of each data session  as we can see  the proposed primal dual approach is adapting the
link rates to changing channel conditions and finally reaches a steady state value  validating the final rates in order to
check whether they are optimal values or not is also tricky  this is mainly due to the fact that finding the numerical
solution of the wnum problem when we have expectation in the constraints is not easy  even if g is drawn from a set
with a finite number of channel states  but  since we already have a candidate for the optimal values from our primaldual algorithm and we only need to validate it  we can check the kkt conditions for the obtained solution  figure
  illustrates one of the kkt conditions associated with one of the rate constraints  this figure shows the difference
between the expected value of the capacity with respect to different scenarios for g and the allocated rate  i e the slack
in constraint      figure   also show some of the lagrange multipliers associated with the rate constraints and their
convergence to a fixed value 

  acknowledgement
i would like to thank prof  andrea goldmith and also dan oneil for helpful discussions we had regarding this work 

references
    d  oneill  boon sim thian  a j  goldsmith  and s p  boyd  wireless num  rate and reliability tradeoffs in
random environments ieee wireless communications and networking conference        budapest hungary
    f  kelly  a  mauloo and d  tan  rate control for communication networks  shadow prices  proportional fairness
and stability  journal of operational research society  vol     no    pp           mar     
    m  chiang  s  h  low  a  r  calderbank  j  c  doyle  layering as optimization decomposition  questions and
answers  proc  ieee milcom  washington d c   october     
    f  paganini  w  wang  j  c  doyle  s  h  low  congestion control for high performance  stability  and fairness
in general networks  ieee acm transactions on networking  volume     issue    feb       page s         
  we

denote the dual variables as prices 

 

fi    

rates on data sessions

   

    

   

    

   

    

 

 

    

     

     

number of iterations
figure    rates on data sessions

    john papandriopoulos  subhrakanti dey and jamie s  evans  distributed cross layer optimization of manets
in composite fading  ieee international conference on communications  istanbul  turkey  jun       
    g  j  foschini and j  salz  digital communications over fading radio channels  bell syst  tech  j   pp         
feb       
    v  borker and s  meyn  the o d e  method for convergence of stochastic approximation and reinforement learning  siam journal of control optimization  vol     
    j  g  proakis  ed   digital communications  new york  mcgraw hill       

 

fi   

slack in one of the rate constraints

    
   
    
   
    
 
    
   
    

 

    

     

number of iterations
figure    slack in one of the rate constraints

 

     

fi 

 


 

lagrange multipliers

   

 
 

 



 



 

 

   



 

 

 



  

   

 
 

    

     

number of iterations
figure    some of the lagrange multipliers

 

     

fi