snprints  defining snp signatures for prediction of onset in complex diseases
linda liu  biomedical informatics  stanford university
daniel newburger  biomedical informatics  stanford university
grace tang  bioengineering  stanford university
emidio capriotti  bioengineering  stanford university  not in cs    

   introduction

learning approaches have been successfully applied
to disease risk prediction using snp data      but
these methods have not yet been applied to onset
prediction 
therefore  we will leverage a multiple snp approach to create a novel predictive model of both
disease risk and age of disease onset  our project
aims to improve performance of disease risk and
age of onset assessment  and to bring us closer to
personalized preventative treatment for complex
diseases 

complex genetic diseases are a major cause of
human morbidity and mortality  and their prevalence and severity place a tremendous burden on
patients and medical facilities        preventive
care studies have shown that identification of patients at risk for disease and prediction of patient
age at disease onset improve patient outcome and
reduce health care costs      however  the development of accurate predictive methods remains in
preliminary stages 
recent research suggests that methods for analyzing combinatorial interactions of single nucleotide polymorphisms  snps  can lead to effective
predictors for disease      snps  which are single
allele mutations in the genomic sequence of an organism  are responsible for about     of all human
dna variation and play an important role in human evolution  drug sensitivity  and disease susceptibility      due to advances in high throughput
experimental techniques for snp identification and
the resulting data explosion  several machine learning methods have been applied to study the relationship between snps and disease        algorithms such as megasnphunter achieve good performance by avoiding the computationally intractable combinatorial search space  but they are limited by the inability to use a large number of snps
in disparate genomic locations      other machine

   methods
    dataset
we have obtained snp data from genomewide association studies  gwas  performed by the
wellcome trust case control consortium
 wtccc   this dataset is comprised of the snp
genotypes for       healthy controls and       
diseased patients  all genotyped at         genomic locations      the patient populations are
equally sized for seven complex genetic diseases
 table     age of disease onset is available for
three of the diseases and is binned by decade 
there is sufficient spread in age of onset to enable
subpopulation studies 

table    wtccc study participant characteristics 
  patients
     
     
     
     
     
     
     
     

cohort
bipolar disorder  bd 
coronary artery disease
 cad 
hypertension  ht 
crohns disease  cd 
rheumatoid arthritis  ra 
type   diabetes  t d 
type   diabetes  t d 
controls

age of onset
   

     

     

     

     

     

     

      unknown

 

 

 

 

 

 

 

 

 

  

  

  

   

   

   

  

  

  

  
  
 

   
  
 

   
  
 

   
   
 

  
   
 

  
   
 

  
   
 

  
  
 

  
  
 

fi    data filtering
we have removed patient data and snp data from
our set for the following reasons     patients missing
more than    of snp data     genotype calls that
disagree between the two calling algorithms used by
the wtccc  and    satisfying other exclusion criteria specified by the wtccc  poor data quality  incorrect genotyping  etc  
    classification
we used the libsvm software package     to
build support vector machine classifiers  all binary
classifiers and multi class classifiers were built using c support vector classification  which solves the
primal problem     with c set to    we used a radial
basis kernel function     with gamma set to       parameter values were optimized for a single binary
classifier using a grid search over a range of values 
due to the computational complexity of this optimization problem  these parameters were not reoptimized for each classifier 
   

   
      disease risk 
for each disease  we trained a binary classifier to
distinguish between disease and control  to balance
training set sizes for disease samples and control
samples  we selected a random sample of patients from the larger group  in each case  the total
training set size averaged around      individuals
 half disease  half control  
      early onset risk 
for the three diseases with onset data  cad  cd 
and t d   we trained a binary classifier to identify
patients at risk for early onset  we partitioned the
dataset into early onset and late onset groups to train
the classifier  to balance training set sizes for early
and late onset groups  we used multiple iterations of
bootstrapping and ensured performance was not
based on the selected individuals 
    feature representation
for each snp  major and minor alleles were defined based on allele frequencies in the control popu 

lation  where the major allele is the more frequently
observed allele   these annotations provided a consistent allele nomenclature for representing all patient snp vectors  representation of each snp required two values  the first of which indicated the
presence absence of genotype information and the
second of which encoded the genotype  presence and absence corresponded to values of     and
  respectively  these values provided a means of
accounting for missing data without disrupting our
genotype representations  genotype information
 minor minor  minor major  major major  corresponded to values of          and   respectively 
this labeling scheme makes the assumption that the
phenotypic effect of a snp is linearly dependent
upon the major  or minor  allele 
    feature selection
our feature space of         snps far exceeds
the number of individuals available for training our
machine learning algorithms  we therefore reduced
our feature dimensionality by filtering snps based
on strength of disease association and on chromosomal proximity  which prevents overrepresentation
of genomic loci  we measured disease association
for each snp by calculating a chi square p value for
the difference between the snp genotype distributions of diseased patients versus that of control individuals  these measures of significance allowed us
to rank snps for feature selection for both disease
risk prediction and early onset risk prediction for individual diseases  to filter by chromosomal proximity  we first clustered our set of top ranked snps
by single linkage clustering using hapmap linkage
disequilibrium r  values as our pair wise distances      we then selected the snps with the most
significant p value within a given cluster and filtered
out all other snps 
      disease risk using binary classifiers
as described above  snps were ranked by chisquare p value for each disease  where snps with
the lowest p value received the highest ranking  the
number of top ranked snps selected from each disease was optimized by empirical testing using multiple iterations of svm training  the top    snps
from t d and the top    snps from all other diseases were selected as our final feature vectors by
the disease association ranking step     snps gave
the best performance for all diseases except t d  in
which case more than    snps did not improve the
performance 

fi      early onset risk using binary classifiers
snps were ranked by chi square p value 
where p values were calculated based on the snp
genotype distributions for  early onset  versus  lateonset  groups  the top    snps were selected as our
preliminary feature vector  the number    was chosen to prevent overfitting  as the smallest training set
had around     patients  the linkage disequilibrium
filtering step was then applied to the preliminary
vectors to obtain final feature vectors 
    validation
we performed    fold cross validation on the disease risk and age of onset classifiers discussed
above  we calculated performance metrics including prediction accuracy  false positive rate  roc
curves  and auc  area under roc curve  to assess classifier performance  we also performed
classification with    random sets of    snps  permutation testing  and compared the performance of
our feature sets with the random sets  this process
allowed us to determine the baseline performance
for our learning method and whether our selected
features outperformed this baseline significantly 
to evaluate the biological significance of our snp
profiles for disease risk and age of onset prediction 
we built a pipeline to identify genes  pathways  and
other biological features associated with our snp
feature vectors  figure     we used ensembl biomart      to generate the list of ensemble gene ids
associated with a given snp vector and then used
the clone gene id converter      to determine the
kegg pathways in which these genes are involved
      finally  we manually examined the retrieved
kegg pathways to look for biological relevance with
respect to the original classification problem 

figure    pipeline for biological validation of snp subsets

   results and discussion
    disease risk

the roc curves for the seven binary disease predictors are shown in figure    the classifier for
type   diabetes has the best performance  while the
other classifiers have only moderate performance 
these results are likely due to the fact that several
genomic regions contribute strongly towards the
t d phenotype  this conjecture is supported by the
fact that t d had a few snps with very significant
p values  on the order of  e      while the other
diseases had less significant snp p values  the
quality of the t d result  which matches or exceeds
the predictive accuracy achieved by prior methods
     justifies our approach of ranking snps by pvalue in order to capture the most discriminating features  the performance of the other disease classifiers suggests that the    k genotyped snps does not
include those that co segregate with highly influential genetic loci 

figure    roc curves for binary svm classifiers for disease risk

    early onset risk
using values from recent literature  which linked
snps and clinical findings to disease onset groups
        we derived medically relevant cutoff ages to
partition the dataset into early onset and late onset
groups  figure     we tested variations in our training data where we shifted the cutoff by one decade
and where we removed training data for patients
within one decade of the cutoff  the reasoning behind this second method is that onset differentiating
snps may present a stronger signal between the extremes of the onset populations  furthermore  because literature definitions for early onset versus late
onset were imprecise  removing the patients in the
age categories adjacent to our cutoffs produced a

fitraining set with higher quality class labels  for all
partitioned datasets  we performed permutation testing and found the random sets of snps to achieve a
mean auc no greater than      with standard deviation       for each disease  we then selected the

best performing onset classifier from the above
variations  highlighted in figure     the large auc
values for these classifiers indicate that the selected
snp subsets have strong predictive power for early
versus late onset 

figure    early and late onset categorization from literature
 a 
disease
partition
nearly onset
nlate onset
auc  auc

cad
cutoff  
   

cutoff  
    

exclude  
   

exclude  
    

exclude    
   

    

   

   

   

   

          

          

          

          

          

disease
partition
nearly onset
nlate onset
auc  auc

cd
cutoff  
   

cutoff  
    

exclude  
   

exclude  
    

exclude    
   

    

   

   

   

   

          

          

          

          

          

disease
partition
nearly onset
nlate onset
auc  auc

t d
cutoff  
   

cutoff  
   

exclude  
   

exclude  
   

exclude    
   

    

   

   

   

   

          

          

          

          

          

 b 

figure     a  auc table for all onset cutoff leave out variations  b  roc curves for the best performing binary svm
classifiers for early onset risk  shaded regions indicate one standard deviation from the mean 

fi    biological validation
for each disease classifier  our biological feature
pipeline described in     yielded biological pathways involved in that disease s mechanism  and for
each onset classifier  the pipeline yielded pathways

implicated in aging and diet  these pathway associations present strong evidence that our snp vectors have biological relevance and are not artifacts of
the learning process  table    

table    pathways associated with snp features for disease classification

conclusion
we have developed a diagnostic tool to predict
both disease risk and risk of early disease onset
given an individuals genetic information  our results indicate a low dimensional patient snp profile
can be used for effective risk assessment for type  
diabetes  and that the wtccc patient data set contains sufficient information for the construction of
disease onset classifiers  further work on onset
classification promises to yield effective early onset
prediction and preventative methods both for clinical
use and for the rapidly expanding field of personalized medicine 

references
   wtccc  genome wide association study of       
cases of seven common diseases and       shared controls  nature                            
   ambady  r   et al  early diagnosis and prevention of
diabetes in developing countries  rev endocr metab disord                    
   wan  x  et al   megasnphunter  a learning approach
to detect disease predisposition snps and high level interactions in genome wide association study  bmc bioinformatics               
   calabrese  r  et al  functional annotations improve the
predictive score of human disease related mutations in
proteins  hum mutat                         
   schaub  m a  et al   a classifier based approach to
identify genetic similarities between diseases  bioinformatics          i             
   chih chung chang and chih jen lin  libsvm   a library for support vector machines        software available at http   www csie ntu edu tw  cjlin libsvm

   the international hapmap consortium  a second generation human haplotype map of over     million
snps  nature                     
   wei  z  et al   from disease association to risk assessment  an optimistic view from genome wide association studies on type   diabetes  plos genetics        
       
   prudente  s  the trib  q  r polymorphism and risk
of early onset type   diabetes  j clin endocrinol metab 
                    
    brant  s r  linkage heterogeneity for the ibd  locus
in crohn s disease pedigrees by disease onset and severity  gastroenterology                          
    a genomewide scan for early onset coronary artery
disease in     families  the genecard study  am j
hum genet                            
    flicek p  et al  ensembl s   th year  nucleic acids
res       nov     epub ahead of print 
    alibs  a  et al  idconverter and idclight  conversion and annotation of gene and protein ids  bmc bioinformatics               
    kanehisa  m  et al  from genomics to chemical genomics  new developments in kegg  nucleic acids
res      d               
acknowledgments
we would like to acknowledge cs foo  marc schaub 
marina sirota  joel dudley  lucile packard childrens
hospital  and simtk for assistance and support 

fi