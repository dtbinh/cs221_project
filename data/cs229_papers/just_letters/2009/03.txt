mapping geometry in heart rate data
gunnar carlsson  jeffrey danciger  jason morton
december         

abstract

tems 
our methodology is built around two processes  the first is the detection of motifs  i e 
recurring patterns of heart rate variation  over
multiple time scales that are differentially expressed in patients with differing disease status  the second is the topological analysis of
the space of frequently occurring motifs  our
novel method exploits the geometry of the data
to produce useful visualizations rather than measurements of mysterious statistics  we note that
on the one hand our method produces visualizations that require interpretation  but that on the
other hand our method is quite general and can
be applied to any time series  as the experiments described here are the first applications of
this method  we are not yet able to speculate on
the range of data for which the method will be
effective 

we introduce a new methodology for the analysis of
heart interbeat interval time series based on the geometric topological analysis of spaces of frequently
occurring motifs  short patterns in the data   we
use these methods to identify interesting differential
features in data from three patient groups  healthy 
congestive heart failure  and atrial fibrillation 

 

introduction

much effort has been dedicated to better understanding physiologic time series  one common
thread in some recent work is the notion that
the complexity of the time series yields information about the health of the patient  costa et 
al     have developed a complexity measure called
multi scale entropy  mse  and have successfully
applied it to differentiate between patients with
three different heart conditions  the fruitful results of this and other complexity measures suggest that there is a great deal of information
about the patient contained in a heart interbeat
interval time series  perhaps even more so than
is thought by the present day medical community  in this article we introduce a new methodology for examining interbeat interval time series that differentiates disease status by identifying specific structural features  the concrete
features identified in this article  and with future applications of this method  could provide a
useful complement to complexity based features
 such as mse   in particular  we claim that our
methodology produces features that may be easier to interpret from a physiologic point of view
and therefore could eventually lead to a better
understanding of the underlying physiologic sys 

 

mapping motifs in interbeat
interval sequences

we examined heart interbeat interval sequences
collected over    hour periods from    healthy
 hl  patients     patients with congestive heart
failure  chf   and   patients with atrial fibrillation  af   about      n  tuples were selected at
random from each time series for varying values
of n from   to     from each such collection  the
high variance high density  hvhd  motifs were
selected and normalized as follows  the density
at each tuple was calculated using a gaussian
kernel  the     highest variance tuples were
selected  from these tuples  the     highest
density tuples were selected  the remaining tuples were then normalized to have zero mean and
 

fivariance equal to one  as we seek features independent of the usual statistical measures   the
resulting collection represents the most densely
occurring high variance motifs of length n in the
time series as a subset of an n    dimensional
sphere centered at the origin in rn   it is useful to imagine that this discrete set of motifs is
sampled from a continuous motif space 

 a  af

 b  chf

  

  

  

  

  

  

  

 a  data set

 b  filter and clus   c 
mapper
ter
output

 c  hl

figure    results from mapper with density as filter on the motifs of length n     from  a  an atrial
fibrillation patient   b  a congestive heart failure patient   c  a healthy patient  note that  c  has two
connected components while  a  and  b  have only
one 

figure    schematic of the mapper algorithm     
the data  a  is filtered into overlapping subsets using the height function as filter  each subset is partitioned into clusters  shown in  b   mapper outputs
a graph  c  capturing geometric features of the data 

we used mapper     to explore the geometry
of the high variance high density  hvhd  motifs  mapper is a tool that produces schematic
graphs of point cloud data  as in the example depicted in figure    mapper filters the data into
overlapping subsets according to a user defined
filter function and then partitions each subset
into clusters  mapper then constructs a graph
representing each cluster as a node and connecting two nodes with an edge if the clusters overlap  we used a gaussian kernel density function
as the filter in mapper to produce graph outputs
for varying values of n   a sample of the results is
shown in figure    these graphs immediately reveal a topological difference between the hvhd
motifs of the healthy patient versus those of the
other two patients  the motifs from the healthy
patient separate into two connected components 
while the motifs from both the chf and af patient form one large connected component 
in the mapper analysis of an hl patient  one
connected component contains motifs exhibiting a increasing trend  corresponding to decreasing heart rate  while the other component contains motifs exhibiting a decreasing trend  corresponding to increasing heart rate   this phe 

nomenon is illustrated by running mapper with
slope as the filter function  see figure    

   

quadratic fit plots

in order to visualize the distribution of motif shapes  we fit each n  tuple to a quadratic
an    bn   c and plot the resulting fit parameters b vs  a with color indicating of quality of
fit  roughly  the y coordinate describes the slope
of the motif and the x coordinate describes the
concavity  a simple calculation shows that all
points of such a quadratic fit plot must lie inside a bounding ellipse  which is given by the fit
parameters of normalized n  tuples that are fit
perfectly by a quadratic 
quadratic fit plots for varying motif length n
were created for each patient  although the results vary substantially from patient to patient
 see section     typical results are shown in figure    these plots demonstrate the varying distribution of motif shapes as we increase the size
n of motifs considered  the plots demonstrate
very different behavior across patient classes 
for small n   the hl motifs separate into two
 

fifigure    output from mapper with slope as the
filter function on the motifs of length n     from
an hl patient  each node depicts the collection of
motifs it represents 

 b  chf n  

 c  hl n  

 d  af n   

 e  chf n   

 f  hl n   

 g  af n   

 h  chf n   

 i  hl n   

figure    plots of slope vs  concavity obtained from
quadratic fits  for motif lengths n              color
represents relative error of fit  the bounding ellipse 
consisting of the motifs fit perfectly by a quadratic 
is depicted in black  for small n   the hl motifs separate into two components  increasing and decreasing   while chf motifs exhibit no such separation 
as n increases the chf motif space gradually develops separation between increasing and decreasing
motifs  quadratic fit plots of the af patient motif
spaces appear similar to that of gaussian noise 

groups  increasing and decreasing   while chf
motifs exhibit no such separation  however 
as n increases the chf motif space gradually
develops separation between increasing and decreasing motifs similar to that seen for the hl
patient for small n   quadratic fit plots of the
af patient motif spaces appear similar to those
of gaussian noise 

   

 a  af n  

non quadratic motifs
space is made up of oscillatory patterns having
similar frequency but having varying phase  on
the other hand  the af patients non quadratic
motif space seems to lack interesting topological
structure 

the quadratic fit plots described in section    
reveal a lot about the motif space of an interbeat
interval time series  in particular  points falling
near the bounding ellipse in these plots are fit
very well by a quadratic and the location of such
points on the plot therefore accurately describes
the shape of the corresponding motif  however 
points close to the center of the ellipse have high
fit error meaning that quadratic functions fail to
fully describe the shape of these motifs  as can
be seen in the quadratic fit plots from figure   
both chf and af patients exhibit many of these
non quadratic motifs  we used mapper to investigate the space of such motifs  figure   displays
mapper outputs from an af patient and a chf
patient  note the appearance of a cycle in the
chf patients mapper output  this indicates
the presence of a nontrivial circle in this patients
non quadratic motif space  further analysis reveals that the chf patients non quadratic motif

 

predicting disease status

the quadratic fit plots described in section    
and figure   depict compelling visual differences
between the three patient types  we converted
some information from these plots into numerical
features as follows  for each of the motif lengths
n                            we calculated the total error of quadratic fit over all of a patients
hvhd motifs  we refer to these   features as
quadratic fit error  qfe   we also calculated the
multi scale entropy  mse   as described in      at
  time scales  as well as the mean and variance
 

fifeatures used
qfe
mse
mv
qfe  mse
qfe  mv
mse  mv
qfe  mse  mv

success rate
     
    
     
    
     
     
     

std error 
    
    
    
    
    
    
    

table    linear classifiers of chf vs hl were
built using various combinations of three feature
sets  quadratic fit error  qfe   multi scale entropy
 mse   and mean and variance  mv   the results of
a cross validation test are shown here 

 a  af

tion of af vs hl or af vs chf  we do note 
however  that a svm built with only our qfe
features distinguished af from hl with success
rate     in a leave one out cross validation test 
a similar success rate was achieved using only
the mean and variance features 

 b  chf

figure    mapper outputs  with density as filter 
from the non quadratic motifs of  a  an af patient 
and  b  a chf patient  the presence of a cycle in
 b  indicates the presence of a non trivial circle in the
non quadratic motif space of the patient  this circle
corresponds to oscillatory motifs of similar frequency
but of varying phases 

references
    g  singh  f  memoli and g  carlsson  topological methods for the analysis of high dimensional data sets and  d object recognition  point based graphics       prague 
september      

 mv  of each time series  in order to test the
significance of our qfe features we used various
combinations of the three feature sets to classify
chf vs  hl  for each combination of feature
sets  we built a simple logistic regression classifier and performed a series of cross validation
tests  the results are shown in table    we
note that it was sometimes necessary to reduce
the number of features using pca because of the
limited number of examples available 
though the qfe features alone do not classify
extremely well  our results show that the qfe
features provide a significant complement to the
mse and mv features  we note that any features produced by our method should automatically be independent of mean and variance due
to our normalization procedure  section     due
to the limited size of our af data set  we did not
run extensive cross validation tests of classifica 

    m  costa  a  goldberger  c  k  peng  multiscale entropy analysis of complex physiologic time series  physics review letters
vol     no     august         
    graph images made using graphviz 

 

fi