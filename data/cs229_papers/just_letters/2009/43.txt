classification of hyperspectral breast images for cancer detection
sander parawira
december        
parawira stanford edu
 

introduction

in      approximately one out of eight women has breast cancer  more than        
women are expected to be diagnosed with breast cancer and more than        women are
expected to die from it  most breast cancer deaths can be prevented if it is detected and treated
early  the most common imaging techniques for breast cancer detection are x ray
mammography and computed tomography  ct   these two methods aim to detect any lumps or
masses in breast tissues that may be cancerous  however  there is an inherent problem associated
with these two methods  they are expensive and involve radiating the breast tissues which may
be dangerous since even small doses of radiation can induce mutation that leads to cancer 
fourier transform infrared  ftir  spectroscopy is a measurement technique in which the
absorbance of a tissue sample for many wavelengths is captured using infrared beams  the
purpose of capturing many distinct wavelengths  in our case we capture      wavelengths
corresponding to     nm to      nm in   nm increments  is so that much more information is
captured  there are three steps involved in performing ftir      identifying sample regions by
manual inspection using optical microscope     applying an opaque mask with an aperture of
controlled size to restrict infrared beam absorption to the area of interest     measuring the
attenuation of the incident infrared beam with a detector
in this paper we present a machine learning approach in hyperspectral image analysis for
breast cancer detection  we consider the scenario where a band sequential image of a breast
tissue specimen is collected using ftir spectroscopy  our goal is to determine which parts of
the image correspond to cancer cells and which parts of the image correspond to non cancer
cells  we first discuss spectrum selection and principal component analysis  pca  to reduce the
dimensionality of the image  we then discuss the implementation of k means   clustering
algorithm for data set represented as points in a high dimensional space  we finally add noise to
the image and discuss the robustness of our approach 
 

dimensionality reduction

   

subset selection

the curse of dimensionality tells us that a linear increase in the number of spectrums
used by an algorithm translates into an exponential increase in the number of samples that need
to be processed by the algorithm  from here  we see that utilizing only a subset of the image will
improve the running time significantly  to be exact  we used only     bands of the image that
contain the most information  corresponding to the range of wavelengths from      nm to     
nm in   nm increments 
   

principal component analysis  pca 

fipca is a vector space transform employed to reduce the dimensionality of high
dimensional data set in order to facilitate analysis  pca is an orthogonal linear transform that
transforms data set into new components such that the greatest variance by any projection of the
data set is in the first component  the second greatest variance by any projection of the data set is
in the second component  and so on 
suppose that we have a data set                
   let the mean and the covariance
matrix of the data set be fffi      and fi       fffi     fffi  
   respectively  we can
determine the eigenvalue  and corresponding eigenvector  of fi by solving the equation
fi      for               if we want  principal components  then we create a matrix a of
size    where the first row of the matrix is the eigenvector corresponding to the greatest
eigenvalue  the second row of the matrix is the eigenvector corresponding to the second greatest
eigenvalue  and so on  the principal components are then given by the equation       fffi  
where the first row is the first principal component  the second row is the second principal
component  and so on 
in our case  we employed pca to reduce the dimensionality of the data set from    
dimensions to only    dimensions  consequently  out of      usable spectrums we only utilized
   bands which are       of the data set  figure     and     show the first two principal
components 

figure      first principal component
 

figure      second principal component

classification  k means   clustering algorithm

the k means   clustering algorithm is an improved variant of k means clustering
algorithm with faster convergence  the difference between k means   clustering algorithm and
k means clustering algorithm is in the choice of the initial centroids  for k means  we choose
the initial centroids randomly  in contrast  for k means    we do the following 
   define the radius of a point      as the shortest distance from  to an already
picked centroid
   randomly pick one point in the set as the initial centroid  for cluster  

fi   for each point  in the set  compute   
   pick point  in the set as the initial centroid  for cluster i with probability
  
          
   repeat step    and    for           
after we specify the initial centroids  the rest of the algorithm is exactly the same 
   compute the distance from each point in the set to each centroid
   classify each point in the set to the cluster with shortest distance
   update the centroid for each cluster
   repeat step         until the centroid for each cluster does not change
in our scenario the number of clusters is k      corresponding to cancer cells  non cancer
cells  and no cell  the accuracy of our k means   classifier is          while the running time
of our k means   classifier is    seconds  figure     and     compare the result of our kmeans   classifier to the result of manual inspection 

figure      our k means classifier

figure      manual inspection

in figure      cancer cells are marked with the color blue  non cancer cells are marked
with the color green  and no cell is marked with the color red  in figure      cancer cells are
marked with the color green  non cancer cells are marked with the color purple  and no cell is
marked with the color black 
 

 oise  additive white gaussian  oise  awg  
gaussian noise is a noise that has probability density function  pdf 

     


     



 

         
    

where ff is the mean of the noise and    is the variance of the noise 

additive white gaussian noise  awgn  satisfies        where  is the clean signal   is the
noise  and  is the noisy signal  signal to noise ratio  snr  is defined as     

   fi       

           

 

fi    
    

where fffi is the mean of the clean signal and  fi  is the variance of the clean signal  in our
   

case  we added an awgn with mean   and variance   to the image  we ran our k means
   
  clustering algorithm on the noisy signal to test the robustness of our approach  figure     and
    show the classification results for two magnitudes of snr  note that       may be
expressed in    as           ab     

figure      snr      db

figure      snr     db

s r accuracy
   db          
  db          
  db          
  db          
  db          
  db          
  db          
  db          
  db          
  db          
table      snr vs accuracy
 

data and simulation

the ftir images used in our experiments were acquired from professor rohit
bhargavas group  chemical imaging and structures laboratory  cisl   the width of the
images is     pixels  the height of the images is     pixels  and the depth of the images is     

fibands  spectrums   all of our experiments were done in matlab r    a running on intel
centrino   t      dual      ghz core  
 

conclusion and comparison with bhargavas method

the accuracy of our machine learning approach is     when there is no noise and the
accuracy decreases linearly as snr decreases  on the other hand  bhargavas method have
slightly better accuracy at     when there is no noise but the accuracy decreases exponentially
as snr decreases  in terms of running time  our machine learning approach is much faster at   
seconds compared to bhargavas method at    hours 
    of our classification errors come from false positives and the remaining    come
from false negatives  this means that in the event of classification error      of the time our
machine learning approach labels non cancer cells or no cell as cancer cells while    of the time
our machine learning approach labels cancer cells as non cancer cells or no cell  if our machine
learning approach does not detect the presence of any cancer cells  then it is safe to say that no
cancer cell exists in the ftir images since in our experiments only       of all cancer cells are
not identified  this is good news because this implies that our machine learning approach can be
used as a first screening criterion before the ftir images are fed into more expensive techniques
with higher accuracy such as bhargavas method 
furthermore  when it is not possible to obtain ftir images with no noise  bhargavas
method cannot be used since it is very sensitive to noise  conversely  our machine learning
approach is still a viable option since it is not very susceptible to noise  in summary  the
advantages of our machine learning approach compared to bhargavas method lie in its faster
running time and more robustness to noise 
 

references

    d  landgrebe  hyperspectral image data analysis as a high dimensional signal processing
problem  ieee signal processing magazine  vol      no     pp        january      
    d c  fernandez  r  bhargava  s m  hewitt  and i w  levin  infrared spectroscopic imaging
for observer invariant hispathology  at  biotechnol   vol      no     pp           april      
    d  arthur and s  vassilvitskii  k means    the advantages of careful seeding  acm siam
symposium on discrete algorithms  january      
    g  srinivasan and r  bhargava   fourier transform infrared spectroscopic imaging  the
emerging evolution from a microscopy tool to a cancer imaging modality  spectroscopy  vol 
    no     pp      july      
    i w  levin and r  bhargava  fourier transform infrared vibrational spectroscopic imaging 
integrating miscroscopy and molecular recognition  annu  rev  phys  chem  vol      pp          january      
    r  bhargava  towards a practical fourier transform infrared chemical imaging protocol for
cancer hispathology  anal  bioanal  chem   vol       no     pp             septermber      

fi