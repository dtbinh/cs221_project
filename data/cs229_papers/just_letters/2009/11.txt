mean variance optimization and beyond  improve optimal portfolio construction with
bayesian regularization
abstract
mean variance optimization algorithm seeks to form portfolios with the maximum trade off
between expected return and risk  investors  however  do not know the true value of expected
return and risk of the investable universe  but use the historical sample to estimate the expected
moments  in the presence of estimation errors  the algorithm has the fundamental limitation of
maximizing the estimation error by overweighing assets with higher returns and lower risks and
underweighing assets with lower returns and higher risks  to illustrate the effect of estimation
error on portfolio weights  we compare two portfolio decision rules based on  maximum
likelihood estimator without accounting for estimation error  and bayesian map estimator with
estimation error modeled by bayesian priors  it is shown that portfolio decision rule with
bayesian regularization reduces the loss of portfolio value from that of the true optimal portfolio
based on true values of expected return and risk  the reduction  however  comes with a price of
efficiency  in the bayesian approach  sharpe ratio of the tangency portfolio shrinks by a factor of

t n  
as compared to that yielded by the maximum likelihood approach 
t   

  introduction
mean variance optimization  mvo   along with capital asset pricing model  capm 
and black sholes formula for option pricing  are considered to be the three major
workhorses of modern finance theory  mvo was first proposed by markowitz        
who applied statistical decision theory to guide portfolio construction and subsequently
won nobel prize in economics in       the objective of mvo is to form a diversified
portfolio of assets so as to maximize expected returns for any risk level or minimize risk
for a given level of return 
while theoretical model focus on ex ante values  practical implementation of mvo calls
for ex post results  in the mvo setting  an investor is given a return history of n assets
and faced with the problem of choosing assets among the investable universe to achieve
the maximum expected return and risk tradeoff  using the historical data  the investor
estimates the expected return and risk  and plugs the sample estimates into the mvo
optimizer and solves for the weights  i e  proportions of investable wealth for each asset 
the resulting set of portfolio weights describe optimal solutions  and the set of optimal
portfolios for all possible levels of risk or return forms the mean variance frontier 
the optimization output  i e  portfolio weights can be viewed as plug in estimator of
the true weights since the inputs are computed using historic data but justified on the
basis of predicted relationships  since investors do not know the true values of the
expected moments  and their sample estimates are inevitably subject to estimation error 
in the presence of estimation error  mvo is often criticized as estimation error
maximizer  to understand the criticism  a simple thought experiment shall suffice 
mvo significantly overweighs those assets that have large estimated returns  small
variances  negative correlations with other assets  and underweighs those with small

fiestimated returns  large variances and positive correlations  these assets are  of course 
most likely to suffer from large estimation errors  a practical and inevitable consequence
of the error maximization procedure is that  any estimates of the statistical properties of
the optimized portfolio may be significantly biased if the statistical properties are the
object of optimization  if the optimal portfolio is solved by minimizing the portfolio risk 
the variance of the output portfolio may be a significant underestimate of the true level of
risk 
estimation error significantly undermines robustness of the optimization output from
mvo procedure  it is necessary  therefore  to look for more robust estimators for the
expected return and risk  this is a well posed regularization problem in machine learning 
a natural candidate is the bayesian map  maximum a posterior  estimator wherein
bayesian priors are introduced to model the uncertainty in parameters  we show that
under the distributional assumption of multivariate normality  the map estimator for the
expected return and variance can be solved from the euler equations in close form  when
there is no diffusion or uncertainty in the prior  map estimator is reduced to maximum
likelihood estimator  maximum likelihood estimator is derived under the distributional
assumption of multivariate normality and it is informationally efficient absent of
estimation errors  bayesian map estimator is motivated to account for estimation error in
the unknown parameters  to demonstrate the difference between the competing
estimators and the resulting portfolio choice rules  we calculate the optimal portfolios
using monthly data on   indices  it is found that portfolio rule based on ml estimation is
more optimal as measured by the maximum sharpe ratio of the efficiency frontier
 sharpe ratio of the tangency portfolio   but suffers bigger loss in portfolio value from
that of the true optimal portfolio 
our paper contributes to the literature by using bayesian regularization to address one of
the fundamental limitations of the mvo approach for portfolio construction  error
maximization  we derive close form solutions for the conditional moments by
maximizing the posterior and solving the euler equations  portfolio rules based on
different estimation methods are compared with a risk function coherent with the
investment objective 
the remainder of the paper is organized as follows  section   sets up the mean variance
optimization problem to solve for optimal portfolio weights  section   proposes two
methods to estimate the inputs  ml estimator and bayesian map estimator  section  
describes the data and presents the empirical results  section   concludes 
  mean variance optimization
let t    ri  t  i         n  t       t denote the sample of return history on n risky assets  consider

an investor with a one period investment horizon who  after observing this sample  must
make an investment decision at the end of period t  it is assumed that the investor finds
the historical evidence useful and assesses the characteristic of potential investment rule
based on conditional distribution p   rt      t     suppose the investors objective is to

fiform a portfolio from one risk free asset and n risky asset to maximize the risk and return
trade off  based on markowitzs modern portfolio choice theory 
let w denote the n vector of weighs or percentage of investable wealth in risky assets 
then the return on the investors overall portfolio is given by

r p  t      r f   w   rt   

   

we can write the mean variance optimization problem as follows



maxw   e  w  vw
w
 
where e   e r p  t      t   is the next period return conditioning on history and

   

v   cov r p  t      r p  t        t   is the next period conditional covariance   is a scalar
parameter measuring the level of risk aversion of the investor 
since the objective function is quadratic  the necessary and sufficient condition for
optimality is to solve the optimal weights from the first order conditions  the solution to
    can be easily verified to be
 
w     ab



v   e
   
   v   e
a  e
and
b 
a  va
where a gives the weights on n risky assets to form the portfolio with maximum sharpe
ratio  i e  the tangency portfolio  and b gives the sharpe ratio of the tangency portfolio 
which measures how much return is required by the investor for per unit of risk 
where

a 

  estimating conditional mean and covariance and plug in estimator of portfolio
choice
     ml estimator and bayesian map estimator
the objective of mean variance optimization can be justified with the assumption that the
returns follow a multivariate normal distribution  intuitively  the first and second
moments are sufficient statistics to summarize the information of normal distribution  in
the framework of multivariate normal distributions  we can estimate the value of e and
v consistently with ml  this is equivalent to having an infinitely long history of returns 
for simplicity  we assume that the t observations of ri  t are independent realizations
from a multivariate normal distribution with unconditional mean e  and unconditional
covariance v    then independence implies that e   e    and v   v   

figiven the sample t    ri  t  i         n  t       t   the likelihood function can be written as

 
 
  v     exp    r  t  e    v     r  t  e    
   
n
 
t         
and the ml estimator of e and v are given by
 
e ml   r t    
   
t
 
and vml     r t   e ml       r t   e ml   
   
t
plugging in     and     into      we can solve for the optimal weights for the tangency
portfolio 
t

p  r         r  t     rn          rn  t       

however the investor does not know the true values of e and v   the maximum
likelihood estimates based on finite sample deviate from the true values  giving rise to
estimation error  consequently  the mvo procedure in fact maximizes the sample
estimates present with estimation errors instead of the true moments in the population 
moreover  in the presence of estimation error  the conditional distribution p   rt       t   is
generally not multivariate normal 
to mitigate the effect of estimation error on portfolio choice  we use bayesian estimator
wherein the uncertainty in the parameters e and v is modeled by the prior density
p   e   v     we use the following standard prior to represent investors belief about the
parameters of multivariate normal distribution 
p   e  v     v



n   
 

the posterior density is given by
p   e   v t    p   e   v   p  t e   v  

   
   

where p  t e   v   is the likelihood function given by     
maximizing the posterior  we can derive the bayesian estimator from solving the euler
equation
 
   
e bay   e ml   r t    
t
t    
vml
    
and vbay  
t n  
t   
since
     the bayesian estimate of the covariance matrix dominates the ml
t n  
estimate in the positive semi definite sense  hence we obtain the shrinkage estimate on e
optimal weights
t n    
 
wbay
 
    
wml
t   
    certainty equivalent loss as a measure for generalization error

fito gauge the out of sample performance of the portfolios constructed with different
decision rules  we need to construct a risk function for different portfolio rules  we
propose certainty equivalent loss as a form of generalization error  which measures the
loss in portfolio value due to estimation error 
let  denote the parameter space  e  v     w be a portfolio decision rule calculated from
    based on true moments  and w p     be the portfolio decision rule p associated with a
given sample    the certainty equivalent loss is given by l    w  w p        c  c p



    
where c p   e  r p  t      t    var  r p  t      t  
 
c p is called certainty equivalent is because portfolio p achieves the same value for the
objective function as does a portfolio providing a riskless return of c p   similarly c is the
value of the objective function associated with true value of the moments  by viewing
each methods portfolio weights as a function of the sample  we define the portfolio
rules risk function r       e l    w   wq    with expectation taken over the distribution of

 for a given set of   
l    w  w p        c  c p can be interpreted as a specific form of generalization error
since it captures the deviation of portfolio rule from the true optimal rule  the risk
function associated with different portfolio choice rules can be computed as follows     
generate sets of random samples which follow multivariate normal distribution with
known values of the mean and covariance      for each sample  calculate the certainty
equivalent loss c  cq       take the average of the certainty equivalent loss across all the
samples 
   empirical results
in this section  we derive the portfolio decision rule using a universe of five index assets 
risk free asset as given by the   month treasury bill rate  and four risky assets consisting
of russell       ray   msci eafe  mxea   goldman sachs commodity index
 spgsci   and sp     spx  with their bloomberg ticker given in the bracket  the data
contains monthly returns on the indices from jan      to oct       and they are obtained
from yahoo finance and bloomberg  the empirical results are summarized in table  
and graph    graph   illustrates how we can locate the tangency portfolio  which is
given by the line passing the riskfree asset and tangent to the efficiency frontier  the
tangency portfolio gives the allocation between the risk free asset and the frontier
portfolio on the mean variance frontier and has the maximum sharpe ratio within the
budge constraint  to computer the risk function       random samples of the same length
are generated based on standard multivariate normal distribution  we repeat the
calculation of the portfolio weights based on the ml and bayesian map for each sample 
and average the certainty equivalent loss over      random samples  the certainty
equivalent loss is presented in basis points as shown in table    bayesian estimator

fit  n  
at the price of
t   
reducing estimation error  evidenced in the reduced certainty equivalent loss  hence
mvo algorithm regularized with bayesian prior makes the portfolio weights more robust
to estimation error  but reduces the efficiency as shown in the drop in sharpe ratio of the
tangency portfolio 
shrinks the portfolio weights and sharpe ratio by the factor of

table    summary statistics  parameter estimates and performance measures
bayesian estimator
ray index
mxea index
spgsci index
spx index

mean
     
     
     
     

std
     
     
     
     

skew
      
      
      
      

kurtosis
     
     
     
     

tangent portfolio
     
     
    
     

sharpe ratio certainty equivalent loss
     
     

 data source  bloomberg  yahoo finance

maximum likelihood
ray index
mxea index
spgsci index
spx index

mean
     
     
     
     

std
     
     
     
     

skew
      
      
      
      

kurtosis
     
     
     
     

tangent portfolio
     
     
    
     

sharpe ratio
     

certainty equivalent loss
     

 data source  bloomberg  yahoo finance

graph    mean variance frontier and tangency portfolio

   conclusion
mean variance optimization algorithm seeks to form portfolios with the maximum trade
off between expected return and risk  as the expected returns and risk are estimated  the
algorithm has the fundamental limitation of maximizing the estimation error by
overweighing assets with higher returns and lower risks and underweighing assets with
lower returns and higher risks  to illustrate the effect of estimation error on portfolio
choice  we use two estimation methods  maximum likelihood and bayesian map  it is
shown that portfolio decision rule with bayesian regularization reduces the deviation of
portfolio value from that based on true moments  the reduction comes with a price of
efficiency  sharpe ratio of the tangency portfolio based on bayesian regularization
t n  
shrinks by a factor of
 
t   

fi