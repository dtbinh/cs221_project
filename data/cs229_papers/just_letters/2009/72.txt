multiclass svms for olfactory classication
cs    final project report

michael styer
computer science department  stanford university

  introduction
the study of olfactory classication has many attractions  philosophical and theoretical as well as practical
and functional  as part of the study of human cognition  it is widely recognized that the olfactory sense is
a fundamental component of the human perceptual system  the human brain is believed to have evolved
around the olfactory sense  and consequently the algorithms evolved for olfaction form the foundations of
the algorithms used by the other senses 

input from all sensory modalities converges in the entorhinal

cortex  indicating a degree of common processing function across the senses      

olfaction is also an

important and valuable perceptual mechanism for making distinctions about objects in and states of the
physical world  the development of the so called electronic nose over the past thirty years has led to a
wide variety of applications  from quality analysis in the food and pharmaceutical industries to explosive
and biological agent screening in security and defense applications 

more potential applications present

themselves  dependent on advances in sensor technology and signal processing algorithms  among them
medical diagnosis  environmental quality monitoring  autonomous bomb disposal robot navigation  and
smart re alarm and industrial monitoring systems  among others 
this research project concentrates on the problem of classication of an unknown odorant into one
of a set of previously observed classes  the problem in general of multiclass classication in a supervised
learning framework  in the olfactory sensing context there are several components required of a sucessful
classication algorithm 

preprocessing  feature extraction 

and

classication 

previous research has applied

various statistical learning techniques to each of these sub problems  for preprocessing  techniques include
feature normalization and baseline subtraction  for feature extration  methods include principal component
analysis  linear discriminant analysis  and sammon and kohonen maps  and for classication  techinques include bayesian classiers  k nearest neighbors  articial neural networks  radial basis functions and  recently 
support vector machines 
the paper proceeds in the standard fashion  in section    we describe the problem of olfactory sensing in
general and describe the distinguishing characteristics of the particular problem considered in this research
paper  in section    we identify the major trends in previous and current research into this problem  in
section    we describe the approach taken in this paper and locate our techniques within the broader scope
of related research  in section   we describe the results obtained   and nally in section   we discuss the
results and outline directions for further research 

  problem description
the problem of automatic olfactory classication has several related components in addition to the elements
of the classication algorithm mentioned above  perhaps most critical is the sensing apparatus itself  in the
mid  to late     s  researchers at the university of warwick devloped sensor arrays with suciently broad
sensitivity to be used for odor classication as opposed to detection of specic odorants               gas
sensor techonology in general relies on a change in electrical or other properties of some material in the
presence of volatile organic compounds  vocs   early sensors included inorganic semicoductors  e g       
organic semiconducting polymers       and langmuir blodgett lms  see  e g       and       

more recent

sensor technology includes piezoelectric sensors  which operate by changing resonating frequency due to
absorption of vocs  metal oxide silicon eld eect transistor  mosfet  devices  which employ a catalytic

 

fimetal whose reaction products cause a change in electrical conductivity  and optical ber sensors  in which a
glass ber is coated with a chemically active material that responds to the presence of vocs by changing its
uorescent emission spectrum       cutting edge research  however  employs nanotubes and other techniques
from nanotechnology to achieve substantially better results than previous methods  see  e g                  
      
given an adequate sensor array  olfactory object classication presents several connected challenges      
first  nearly all existing sensor types are subject to drift  a slow  random decrease in sensor response when
exposed to the same odorants under the same or similar conditions 

as a result  sensor patterns learned

previously become obsolete  and the system s ability to identify known odors is compromised  the primary
solution to this problem has been periodic recalibration with a reference gas  but recently work has been doen
to develop signal processing techniques that can remove the dependence on recalibration      second  due
to the omnipresence of vocs in the environment  and particularly in environments such as food processing
plants or medical facilities in which many of the most promising applications of olfactory sensing technology
would be located  any olfactory sensing system must be able to extract the signal of the target olfactant
from a broad spectrum background  techniques for extracting the signal from the background include simple
dierencing  relative extraction and fractional extraction 
third  a sensor response vector should be normalized for processing by subsequent classication algorithms  to eliminate sensitivity to concentration in the classication system  this can be done locally  by
normalizing each feature vector independently  or globally  by restricting or scaling the response of each
sensor across all feature vectors  fourth  a multiple sensor array yields a high dimensional feature space 
which may be computationally dicult or impossible to process in the classication stage  as a result  a
strategy of feature extraction  e g  linear discriminant analysis or principal component analysis   or feature
subset selection  e g  randomized search over feature subsets  may be used to choose a subset of the full
feature set that gives a good classier while reducing the problem complexity 
finally  given a normalized dataset with a selected feature subset  the problem remains to make a classication of an unknown odorant given previous exposure to a set of known odorants 

this is a typical

object classication problem not dissimilar to text classication or data mining  although the nonlinearity
of the sensor responses presents a challenge  most of the common classication algorithms have been applied to this problem  including linear and quadratic classiers  k nearest neighbors  neural networks  also
called multi layer perceptrons in this literature   radial basis function classiers  and recently support vector
machines 

  prior research
many of the early research pieces on olfactory classication drew on the literature of articial neural networks 
      one of the early presentations of the olfactory sensing technology  recommends neural networks as
showing promise for this application  examples include                   recent research also applies neural
networks to this problem  including             

other approaches include fuzzy logic           nearest

neighbors       fuzzy nearest neighbors      and genetic and evolutionary algorithms           much recent
research seems to be in the area of biologically inspired systems  perhaps a revisiting of the neural network
approach                                   finally  support vector machines have been successfully applied to
this problem as they have to classication problems in other domains         

  current approach
    data set
the data set studied in this project is a numerical simulation of results from a nanotechnology based system
as discussed in section    under development by evolved machines and partner isense  for the darpa
realnose program      real sensor data is not yet available  so a set of simulated data was made available
for this project  the long term objective would obviously be to develop and rene the classication algorithm
on the synthetic dataset and apply it to real sensor data when the sensor array is ready 
the data set consists of separate testing and training data  in each data set  an array of     sensors is
exposed to a sequence of     odorants  each odorant is presented to the sensor individually in the presence

 

fi a  raw data

 b  after background subtraction

fig     sensor    response over all training examples  time steps 

algorithm  

background subtraction

for each sensor
for i   to maxbuckets
group sensor data points in i buckets
calculate differences between number of values in each bucket
find pair of buckets a and b with largest difference
calculate backgroundboundary  upper boundary of bucket a
calculate numbelow  number of data points below backgroundboundary
terminate when numbelow does not change for   iterations
end
discard data points below backgroudboundary
rescale remaining data points to       
end

of a background of signicant concentration consisting of two dierent  unknown odorants  and is presented
in    log increasing concentrations from

   

to

     

the sensors are designed to mimic the response

of human olfactory receptors  as a consequence  each sensor responds to a broad spectrum of odorants  so
that the signature response of a particular odorant will be a combination of responses from multiple sensors 
additionally  the response of any particular sensor is non linear  falling o as the concentration of an odorant
to which it responds nears its saturation level  this data set  however  does not exhibit sensor drift  the
real sensors on which this data set is modeled have been designed to eliminate this problem associated with
earlier sensor technology  the data were also generated with sensor response values in the range        so
rescaling was not necessary 

    classication methods
the classication approach taken in this paper involves three steps 

classication 

preprocessing  feature selection 

and

as noted above  the target odorants are presented in the presence of a signicant background 

so before the sensor responses can be used in classication this background must be removed  see figure
  for an example of response data from one sensor before and after background subtraction 

as can be

seen from the gure  the background response varies within a relatively narrow range  so to remove the
background we need to nd the upper boundary of this range  which is done according to algorithm   
to select relevant features from among the     sensor responses  we implemented principal component

 

fi a  first three components of training data

 b  first three components of testing data

fig     principal component analysis of testing and training data after background subtraction  each likecolored ray of points represents a single olfactant at increasing concentrations 

analysis  pca   we noted that while the training set would be assumed present in its entirety  and hence
would be available for pca decomposition  the training set is assumed to be presented one element at a
time 

consequently  we approached pca by nding the principal components of the training data  then

generating the pca values of the testing data using the principal components found from the training data 
see gure   for a scatter plot of the rst three principal components of the training and testing data  as
is evident from the gure  pca reveals some surprising structure to the data  many of the olfactants are
clearly visually separable in the training data as arcs of equally spaced points projecting from a single origin 
this structure seemed to suggest that a svm with an appropriate kernel and kernel parameters would easily
separate the olfactants in pca space  but the results did not support this conjecture 
the classication algorithms implemented for this project are  a nave bayes classier  nb   multiclass
support vector machines with linear  lsvm   sigmoid  ssvm   polynomial  psvm  and radial basis function
 rsvm  kernels  and for comparison a bagged decision tree  bdt   nb was implemented in matlab  after
signicant experimentation with various platforms  including cvx      

sv m light

     

sv m struct  

and

libsvm      the nal svm testing was done using the matlab interface to libsvm  the bagged decision tree
was implemented using the matlab statistics toolbox  results from each classier are presented below 
since a standard svm is really a two class classier  several methods exist for using an svm in a multiclass scenario  we investigated the two that appear most often in the literature  one versus all  ova  and
one versus one  ovo   in the ova method  a classier is trained on each class  using the training examples
from that class as positive examples and all other training examples as negative examples  to classify a new
example  each of these classiers is run on the new example  the class of the new example is that of the
classier that returns
 thelargest distance from the separating hyperplane  in the ovo method  also known
as

max wins voting 

n
 

classiers are trained  each of which takes one class as positive and another class

as negative  to classify a new example  each classier is run  and a win is counted for each class selected
by its classier the opposing class  the new example is classied as belonging to the class with the largest
number of wins  there is signicant literature on the question of which method is more accurate  see  for
example                         and       but the results presented in these papers and particularly in the study by
rifkin and klautau      suggest that relative to the selection of kernel and kernel parameters the multiclass
classication method is insignicant  as a result  we used the ovo method  which is that implemented by
libsvm 

 

ficlassier

test accuracy

optimal parameters

nb

     
      
     
     
     
     
     
     

n a

lsvm
psvm  degree   
psvm  degree   
psvm  degree   
rsvm
ssvm
bdt

c
c
c
c
c

best cv accuracy
n a

c     
           
           
           
           
           
   trees

      
     
     
     
     
      
n a

tab     classier results

    classier selection and evaluation
each classier was trained on the      sample training set  additionally  for the svm classiers  extensive
cross validation  cv  analysis was done to search for an eective combination of parameters 
methods were evaluated  in the rst method  which we refer to as

two cv

leave one concentration out cross validation

 loco cv   twenty cv iterations were done  leaving out a dierent concentration level from each olfactant
on each iteration  the classier was trained each time on the remaining      training examples and tested
on the     examples left out  the second method was a standard randomized   fold cross validation  r cv   in which the data was randomly divided into ve groups  one of which was left out and used as the
cross validation set on each iteration  while these cv methods seem to oer substantially dierent methods
of evaluating the classiers  the results of both were substantially similar  as a consequence  for consistency
the results presented below all use classiers evaluated with r  cv 

  results
the classication results for each of the tested classiers are presented in table    although all the svm
classiers demonstrated approximately     cross validation accuracy  their generalization error was signicantly higher than predicted by cross validation  the boosted decision tree achieved good results  but the
best results were achieved by the nb classier 
the results presented above all use data after background subtraction  but without pca decomposition 
despite the apparent structure of the data when separated into principal components  using data after pca
decomposition actually decreased the accuracy of all classiers tested  furthermore  we investigated using
a geometric curve tting technique to identify the arcs visible in the pca plot  but it is not clear how to
translate the parameters for such an arc from the testing data space to the training data space 

  conclusion and further research
previous work in this area  particularly that in      suggested that a svm classier should produce good
classication results for olfactory sensor data 

our results did not conrm this hypothesis  but neither

should they be understood as an invalidation of the hypothesis  instead  these results should be understood as
conrmation that the implementation and tuning of svm classiers poses signicant technical and conceptual
challenges  even when using a pre existing svm implementation  which were not fully surmounted during
the course of this research project 

the multitude of applications for an accurate and precise olfactory

classier clearly warrants further research into this area 

future iterations of this research project will

attempt to understand more fully the shortcomings of the svm classiers implemented in this project  as
well as investigating other background extraction and feature selection methods and classiers 

 

fi  acknowledgements
this project would not have been possible without the coooperation and support of paul rhodes and evolved
machines  who provided the problem description and data set as well as helpful advice throughout the project 
thanks are also due to morgan quigley  whose suggestions for research directions were invaluable at each
stage of this research 

references
    darpa realnose program  http   www darpa mil dso thrusts bio biologically realnose index htm 
    s  baker  g  g  roberts  and m  c  petty  phthalocyanine langmuir blodgett lm gas detector 

proceedings i  solid state and electron devices                      

    jin ho bang  sung h lim  erwin park  and kenneth s suslick 

ieee

chemically responsive nanoporous

pigments  colorimetric sensor arrays and the identication of aliphatic amines 

journal of surfaces and colloids                       

langmuir   the acs

    s  bashyal  g  k  venayagamoorthy  and b  paudel  embedded neural network for re classication
using an array of gas sensors 

in

sensors applications symposium        sas       ieee 

pages

        feb       
    rossella blatt  andrea bonarini  elisa calabr  matteo torre  matteo matteucci  and ugo pastorino 
fuzzy k nn lung cancer identication by an electronic nose  in

applications of fuzzy sets theory  volume

      page           
    chih chung chang and chih jen lin 

libsvm  a library for support vector machines       

software

available at http   www csie ntu edu tw  cjlin libsvm 
    can demirkesen and hocine cheri  a comparison of multiclass svm methods for real world natural
scenes                 
    cosimo distante  nicola ancona  and pietro siciliano  support vector machines for olfactory signals
recognition 

sensors and actuators b  chemical                   

    kai bo duan and s  sathiya keerthi  which is the best multiclass svm method   an empirical study 
in

proceedings of the sixth international workshop on multiple classier systems  pages              

     d  dumitrescu  b  lazzerini  and f  marcelloni  olfactory signal classication based on evolutionary

in ijcnn     international joint conference on neural networks  proceedings  cat 
no   ch        page           
computation 

     d  dumitrescu  b  lazzerini  and f  marcelloni  a fuzzy hierarchical classication system for olfactory
signals 

pattern analysis   applications                 

     a  m  fard  a study of semiconductor sensors for an electronic olfactory system  msc thesis  university
of warwick       
     v  franc and v  hlavac  multi class support vector machine  in

interaction for service robots  page           

     walter freeman 

object recognition supported by user

olfactory system  odorant detection and classication 

volume iii  academic press 

new york       
     jun fu  guang li  yuqi qin  and walter j  freeman  a pattern recognition method for electronic noses
based on an olfactory neural network 

sensors and actuators b  chemical                   

     j w gardner  e l hines  and m wilkinson  application of articial neural networks to an electronic
olfactory system 

measurement science and technology                 

 

fi     julian w  gardner  james a  covington  su lim tan  and timothy c  pearce  towards an articial
olfactory mucosa for improved odour classication  proceedings of the royal society a  mathematical 
physical and engineering sciences                       

     michael grant  stephen boyd  and yinyu ye  cvx  matlab software for disciplined convex programming 
http   cvxr com cvx  december      

biologically inspired signal processing for chemical
sensing  volume     of studies in computational intelligence  springer       

     agustn gutirrez and santiago marco  editors 

     r  gutierrez osuna  pattern analysis for machine olfaction  a review 

sensors journal  ieee          

     jun      
     e  l  hines  j  w  gardner  and r  n  stanseld  a standalone neural network based electronic nose  in

dsp  digital signal processing  in instrumentation  iee colloquium on  digest no      

pages     

jan      
     chih wei hsu and chih jen lin  a comparison of methods for multiclass support vector machines 

transactions on neural networks   a publication of the ieee neural networks council 

ieee

            

     
     t  joachims 
editors 

making large scale svm learning practical 

in b  schlkopf  c  burges  and a  smola 

advances in kernel methods   support vector learning  mit press       

     laine kahsay  friedhelm schwenker  and gnther palm  comparison of multiclass svm decomposition
schemes for visual object recognition                 
     tae hyun kim  sang hun lee  joohyung lee  hyun seok song  eun hae oh  tai hyun park  and
seunghun hong  single carbon atomic resolution detection of odorant molecules using a human olfactory
receptor based bioelectronic nose 

advanced materials                 

     barry k lavine  charles e davidson  curt breneman  and william kaat 
classication of olfactory stimulants 

genetic algorithms for

methods mol  biol               may      

     b  lazzerini  a  maggiore  and f  marcelloni  fros  a fuzzy logic based recogniser of olfactory signals 

pattern recognition                        

     xu li  guang li  le wang  and walter freeman  study of a bionic pattern classier based on olfactory
neural system 

journal of bionics engineering                   

     amy lout  silvia coradeschi  achim j  lilienthal  and javier gonzalez  gas distribution mapping of
multiple odour sources using a mobile robot 

robotica                     

     mehmet k  muezzinoglu  alexander vergara  ramn huerta  thomas nowotny  nikolai rulkov  henry
d  i  abarbanel  allen i  selverston  and mikhail i  rabinovich  articial olfactory brain for mixture
identication  in

nips  pages                

the how and why of electronic noses 

ieee

     e  neuhaus and h  hatt  mimicking the olfactory system for the classication of chemical data 

trends

     h t  nagle  r  gutierrez osuna  and s s  schiman 

spectrum                 

in biotechnology                july      

     carey e  priebe  advanced data analysis methods for analyte recognition from optical sensor arrays 
     
     baranidharan raman 

sensor based machine olfaction with neuromorphic models of the olfactory system 

phd thesis  college station  tx  usa        adviser gutierrez osuna  ricardo 

 

fi     baranidharan raman  ping a sun  agustin gutierrez galvez  and ricardo gutierrez osuna  processing
of chemical sensor arrays with a biologically inspired model of olfactory coding  ieee transactions on
neural networks   a publication of the ieee neural networks council                     

     ryan rifkin and aldebaro klautau  in defense of one vs all classication 

j  mach  learn  res        

          
     h shurmer  a fard  j barker  p bartlett  g dodd  and u hayat  development of an electronic nose 

physics in technology                  

     h  v  shurmer  an electronic nose  a sensitive and discriminating substitute for a mammalian olfactory
system 

circuits  devices and systems  iee proceedings g                 jun      

     zu soh  t  tusji  n  takiguchi  and t  tsuji  neuro based olfactory model for estimation of sensory
characteristic of mice  in

     ieee international conference on robotics and biomimetics  page     

     
     jon m  sutter and peter c  jurs 

neural network classication and quantication of organic vapors

based on uorescence data from a ber optic sensor array 

analytical chemistry                  

     victor v sysoev  bradly k button  kelly wepsiec  serghei dmitriev  and andrei kolmakov  toward the
nanoscopic  electronic nose   hydrogen vs carbon monoxide discrimination with an array of individual
metal oxide nano  and mesowire sensors 

nano lett                    

     n  taguchi  british patent no                  
     r  h  tredgold  m  c  j  young  p  hodge  and a  hoorfar  gas sensors made from langmuir blodgett
lms of porphyrins 

solid state and electron devices  iee proceedings i                 june      

     le wang  guang li  xi liu  baojun wang  and w j freeman 

study of a chaotic olfactory neural

conference proceedings       annual international conference of the ieee engineering in medicine and biology society  ieee engineering in
medicine and biology society  conference                
network model and its applications on pattern classication 

     y yao  w freeman  b burke  and q yang  pattern recognition by a distributed neural network  an
industrial application 

neural networks                 

     hyeonseok yoon  sang hun lee  oh seok kwon  hyun seok song  eun hae oh  tai hyun park  and
jyongsik jang  polypyrrole nanotubes conjugated with human olfactory receptors  high performance
transducers for fet type bioelectronic noses 

angewandte chemie                     

 

fi