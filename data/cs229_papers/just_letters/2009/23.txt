transcription start site classification
max libbrecht  matt fisher  roy frostig  hrysoula papadakis  anshul kundaje  serafim batzoglou
december         
abstract
understanding the mechanisms of gene expression is a central problem in biology  important to gene
expression is the binding of rna polymerase at transcription start sites  tsss   tss detection from sequence
is a well studied problem  but recent innovations in data collection have made a much richer feature set
available  furthermore  these innovations allow for the large scale study of tss activity  which had not
previously been affordable  we developed a machine learning model to detect tsss as well as predict their
activity  using newly collected epigenetic data from the encode project  to improve interpretability of our
results  we used a learning model that produces a classifer easily understood by a human  our results improved
upon the state of the art in tss detection  and achieved very high accuracy in predicting tss activity 

 

introduction

tss prediction methods based on genomic sequence are widely used  down and hubbard         the most
well known such method is based on the so called tata box  an at rich region which indicates polymerase
binding nearby  while these methods can be used to to locate tsss in a small target area  for example  the
region just upstream from a known gene   they generally produce consensus sequences of less than    base pairs 
and therefore have poor sensitivity specificity when applied across the entire genome  we propose a machine
learning model with a larger feature set in the hope of producing a more discriminative tss model  using a newly
available data set taken by the encode project 
new data collection methods also make it possible to assay for tss activity on a large scale  we use available such assays to build a machine learning predictor of tss activity  this approach has not been attempted in
the past  because tss activity data simply was not available 
tss activity can be broken down into three classes  we call expressed tsss active and non expressed tsss
inactive  it is also common for polii to bind to a tss  but simply stall instead of transcribing  muse et al  
       we call this class poised 
we attempt to distinguish between the four classes non tss  inactive  poised and active by building classifiers
for three problems  tss vs  non tss  inactive vs  polii bound  and active vs  poised 

 
   

learning model
learning algorithm

our dataset and our goals have many characteristics that suggest a specific class of learning models  first  initial
experiments suggest that there will be many examples that are extremely hard to classify correctly  many tsss
exhibit essentially no features observed in our dataset that characterize it as a tss  however  there are subsets
of tsss with very identifying features on which we expect very good classification  this motivates a learning
algorithm that gives good confidence bounds  enabling us to perform good specificity and sensitivity queries 
second  initial experiments also suggested that the number of training examples available  at least       per

 

ficlass for all problems  far exceeds the number necessary for good learning  finally  our input feature vectors are
not in the same coordinate system  some represent the response of the genome to various signal tests  while others
represent the presence or absence of genomic sequences  while we could attempt to normalize similar elements
of the vector to avoid this problem  this could affect the learning algorithm  all three of these characteristics
discourage using svmsthey partition the dataset into only one axis  the margin   which does not necessarially
result in good confidence bounds  they are hard to train on a very large dataset  and they are not invariant to
coordinate scaling  decision trees  on the other hand  partition the dataset into similar regions where the class
probabilities can be read directly  and thus have good confidence bounds   are easy to train  and are invariant to
coordinate scaling  the internals of the classifier they produce are also an intuitive and understandable classifier 
we use a greedy id  algorithm to grow the decision tree  with the class probability being read directly from
the ratio of the training set in each leaf node  since the confidence value is very important to us  we seek to avoid
false high confidence readings  which are very common in leaves which only contain a small number of examples 
although various techniques can be used to overcome this problem  because the number of training examples
available is so large  we use a very simple approachdecisions splits which would produce a node with less than
    examples are not allowed  cross validation was used to select this number   we varied numerous parameters 
such as the maximum depth allowed  and most reasonable ranges yielded a learner with very comparable performance  for comparison  we also tried a variety of other common machine learning techniques  such as boosted
decision stumps  and also noted performance similar to the results shown in this paper  while it was possible
with any of these algorithms to drive the training error to zero  this never resulted in good performance  learners
with low training error all appeared to be training on the feature noise  which is sensible given our claim that
many tsss do not exhibit any features observed by our dataset 

   

feature set

we input the following features into our learning algorithm  we used data taken by the encode project on
the k    cell line  see section    methods for details on how we generated our training set and how the features
were generated from raw data 
   sequence k mers  we made one feature for each possible k mer for k          we extracted all the
k mers from a    bp window centered on each training example 
   histone modifications  histone tails are accessible from outside packed chromatin  and can be covalently
modified by other proteins  these marks are implicated in gene regulation  benevolenskaya        barski
et al         koch et al          we have data from the following nine histone marks  h k me   h k me  
h k me   h k ac  h k me   h k  ac  h k  me   h k  me   h k  me   we aggregated signal from
a     bp wide window centered on the tss 
   transcription factors  transcription factors are known to play a central role in gene regulation  we have
chip seq data for two transcription factors  tafii and gabp  we aggregated signal from a     bp wide
window centered on the tss 
   dna accessibility  tightly packed chromatin is inaccessible to transcription machinery  we have data
from three different assays measuring dna accessibility  we aggregated signal from a     bp wide window
centered on the tss 

   

training set

our training set consisted of       tss examples and       non tss examples  the tss examples were further
divided into       inactive        poised and       active examples 

 

fi 
   

results
tss vs  non tss

we achieved    percent accuracy on a training hold out set  which was composed of approximately half positive
and half negative examples  we achieved a    percent area under an roc curve  figure     almost any subset
of our features gave comparable accuracy   this suggests that our features are highly correlated 

      

      

classification error

      

      

      
training error

test error
      

      

     

     
 

     

     

     

     

     

     

     

     

number of training samples

 a  roc curve of our classifiers accuracy 

 b  a plot of our test error as a function of number of training examples  the test set in this case was approximately
evenly split between positive and negative examples 

figure    accuracy results on the tss vs  non tss problem 

we improved on the state of the art in tss detection  down and hubbard         who take a sequence based
approach  achieved    percent sensitivity and a    percent specificity  when matching their sensitivity  we achieve
   percent specificity and when matching their specificity  we achieve    percent sensitivity 

   

tss activity

we achieved nearly perfect accuracy in classifying inactive vs  polii bound  figure     our classifier picked
h k me  as the most important feature  which is supported by the literature 
predicting active vs  poised appears to be a much harder problem  we achieved only     area under the
roc curve  compared to significantly higher accuracy on the other two problems  our algorithm implicates
h k ac  h k  me  and h k    all of these features are supported by the literature 

 
   

methods
labels

we used encode tss annotations as our set of tss training examples  these were generated by a combination
of manual and automatic  unverified  annotation  so some small fraction of these examples may be mis annotated 
we selected positions at       and      from each tss as negative examples  throwing out examples less
than    bp from another annotated tss  other methods of choosing negative examples  such as selecting random positions in the genome  tend to yield examples that are so dramatically different from true tsss that they
are too easy to classify  by choosing positions near true tsss  we pick negative examples in a similar genomic
 

fi a  accuracy in classifying inactive vs  polii bound

 b  accuracy in classifying active vs  poised

figure    roc curves for classifying between active  poised and inactive 
neighborhood  but without the essential character of a true tss 
we labeled true tsss as active  poised or inactive as follows  we have chip seq data for polii binding and
rna seq data for mrna expression  we used encode point peak calls on the polii data and labeled tsss
as bound by polii if they fell within    bp of a peak call  we labeled tsss expressed as mrna if the    bp
sequence downstream of the tss has a signal in the rna seq experiment greater than   rpkm   we labeled
those tsss with both polii binding and mrna expression as active  those with polii binding but no mrna
expression as poised  and those with neither as inactive 

   

feature generation

the data for the histone modifications  transcription factors  and dna accessibility features were taken by the
encode project  the data comes from a set of chip seq experiments and the values correspond to unitless
signals  the features were generated from the data as an average of the signal over a     bp window centered
on the tss  we had an additional feature which corresponded to an increase in the signal from one side of the
tss to the other  this was computed by taking the average of the signal upstream of the tss  subtracting the
average downstream of the tss  and dividing by the average in the whole window  this feature was not picked
by the classifier as informative  which we believe is due to artifacts generated by our implementation  we are
working on removing these artifacts  and we expect this feature to become much more informative once this is
done 

 

future work

we are currently working on the following improvements to our method 

   

additional features

we plan to expand our feature set by adding the following features 
   gc content high gc content is known to correlate with functional elements  pozzoli et al          
  rpkm is a measure of signal in a sequencing assay  calculated r     ln   where r is the number of reads in the window  l is
the length of the window  and n is the number of reads in the whole assay 
  weve already processed the features for gc content and cpg islands  but the results werent ready at the time of this writing 

 

fi   cpg islands for chemical reasons  cg dinucleotides mutate much faster than average  so cg dinucleotides
are relatively rare in the genome except where they are under selective pressure  regions with high frequencies of cg dinucleotides  cpg islands  are known to correlate with functional elements  in particular 
promoters  saxonov et al         
   sequence conservation  conservation of sequence across different species is suggestive of function 
   dna helix structure while the  d structure of the dna backbone always roughly takes the form of
a double helix  it is modified by the sequence of bases  in particular  the structure of any substrand of  
bases is determined by the base pair sequence  packer et al          this structure is captured by a measure
called the hydroxyl radical cleavage pattern  price and tullius        
   spectrum kernel by replacing sequence with k mers  we lost a great deal of information  we plan to
replace this with running svms with a spectrum kernel  leslie et al          which captures more of the
complexity of the sequence 

   

tata box

the so called tata box is a well known indicator of promotor sequences  and several transcription factors are
known to bind to its sequence  we expected it would be chosen by the machine learning algorithm as an important
k mer feature  but it wasnt  even when we restricted our feature set to only sequence features  this is puzzling 
so we plan to investigate it by testing the sequence surrounding each tss for tata enrichment by comparing to
the tata consensus sequence  with this  we can analyze the predictive power of the tata box and hopefully
uncover why it isnt selected by our algorithm 

   

incorrectly classified tss non tss examples

as shown in the results section  on the tss vs  non tss problem  our classification accuracy using small subsets
of our feature set is almost as good as it is using the whole set  despite this  our accuracy is far from perfect 
this suggests that while most of our examples are characterized by almost every feature  a fraction of them arent
characterized by any of our features  we plan to analyze this set to see if it is dominated by a particular gene
type  chromosome  or other characteristic 

references
 barski et al         barski  a   cuddapah  s   cui  k   roh  t   schones  d   wang  z   wei  g   chepelev  i   and
zhao  k          high resolution profiling of histone methylations in the human genome  cell                
 benevolenskaya        benevolenskaya  e          histone h k  demethylases are essential in development and
differentiation  biochemistry and cell biology               
 down and hubbard        down  t  and hubbard  t          computational detection and location of transcription start sites in mammalian genomic dna  genome research            
 koch et al         koch  c   andrews  r   flicek  p   dillon  s   kara
oz  u   clelland  g   wilcox  s   beare  d   fowler  j   couttet  p   et al          the landscape of histone
modifications across    of the human genome in five human cell lines  genome research            
 leslie et al         leslie  c   eskin  e   and noble  w          the spectrum kernel  a string kernel for svm
protein classification  in proceedings of the pacific symposium on biocomputing  volume    pages        
 muse et al         muse  g   gilchrist  d   nechaev  s   shah  r   parker  j   grissom  s   zeitlinger  j   and
adelman  k          rna polymerase is poised for activation across the genome  nature genetics              
 packer et al         packer  m   dauncey  m   and hunter  c          sequence dependent dna structure 
tetranucleotide conformational maps  journal of molecular biology               
 

fi pozzoli et al         pozzoli  u   menozzi  g   fumagalli  m   cereda  m   comi  g   cagliani  r   bresolin  n  
and sironi  m          both selective and neutral processes drive gc content evolution in the human genome 
bmc evolutionary biology          
 price and tullius        price  m  and tullius  t          how the structure of an adenine tract depends on
sequence context  a new model for the structure of tnan dna sequences  biochemistry               
 saxonov et al         saxonov  s   berg  p   and brutlag  d          a genome wide analysis of cpg dinucleotides
in the human genome distinguishes two distinct classes of promoters  proceedings of the national academy of
sciences              

 

fi