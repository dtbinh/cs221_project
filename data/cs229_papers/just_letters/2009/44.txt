structural motif detection in high throughput structural probing of
rna molecules
diego munoz medina  sergio pablo sanchez cordero
december         
abstract
in recent years  the advances in structural probing in rnas have led to the development of high throughput experiments that generate vast amounts of data that is not feasible to curate manually  analogous to
the case of high throughput genome sequencing  there is a need to analyze the structural results via computational methods  in this project  we propose an algorithm based on support vector machines  svms 
to find structural motifs in data produced by an avant garde method for rna structural probing known as
rna tapestries  in this experimental method  every base of a specific rna molecule is mutated iteratively 
one by one  producing n number of mutants  where n is the length of the rna  in nucleotides   each
mutant is then modified using different chemical treatments  such as dms  cmct  and shape        the
modification of the molecule occurs in sites where the rna is unstructured  such as hairpins and loops
for shape chemical footprinting  or in specific base types  adenosine and cytosine for dms  and guanine
and uridine for cmct   thereby  giving a strong fragment signal during reverse transcription check by gel
electrophoresis  the final array of the modified mutants is given in form of a matrix t   where each entry 
t  i  j   is the signal strength of the ith nucleotide of the molecule in the jth mutant  careful analysis of t
may allow the recognition of patterns that are helpful in determining the structure of the rna in question 

 

rna tapestries

structural probing of rnas by means of chemical modification is a quick and powerful way to determine
important contacts of the rna molecule in question  the main idea behind these methods is to induce rna
modifications using different chemical treatments  modification of the molecule occurs as methylathion of
unpaired nucleotides  for dms and cmct  or as backbone conformational changes in regions where it is not
structured  for shape analysis   the resulting rna molecule is then reverse transcribed  which results in
the production of fragments of dna that stop at the modified sites and that can be subsequently analyzed
and compared using standard gel electrophoresis techniques  the information given by these methods can be
complemented by inflicting nucleotide mutations to the rna and repeating the chemical footprinting analysis 
positions of the rna that are modified after the mutations indicate strong structural dependence on the
nucleotides near those locations  this technique can be further extended by repeating the process for many
mutants and aligning the resulting signals to perform a comparative analysis between mutation effects on the
rna structure  simple patterns  such as those describing stems  can be easily visualized and annotated by
hand  but this is a time consuming and error prone process  furthermore  more complex interactions  such as
tertiary contacts  are not readily apparent and may be difficult to spot 

 

methods

we demonstrate the use of svms with l  regularization to detect structural motifs in rna tapestries  using
tapestry data from the medloop rna motif  the signal recognition particle motif  srph    trna phe  and the
sarcin loop motif rnas  these rnas have well known structures and can therefore be used as a training set
for our svm implementation 

   

pre processing the data

since comparison of various rna tapestries can be noisy due to the variance in the strength of the chemical
signal in each experiment   we compute global z scores for each entry in the tapestries  when classifying a new
rna given its tapestry  we adjust the entries to global z scores as well  furthermore  since the experimental
data contained chemical footprinting for the rna sequence of interest plus primer sequences at its ends  we had
to carefully locate the tapestry region that mapped to the rna molecule in question and discard the primer
sequences data  this was done by standard methods that align the chemical footprinting data for each mutant
 taking into account signal intensities and signal position in the sequence  
 

fifigure    defining the feature vector  an rna tapestry as a heat map  left   we focus on the four corner
boxes as well as the central box for each base pair  the central box is crucial for obtaining good results 

   

building the training set

first  let us define what an rna tapestry is  an rna tapestry is a n  n real valued matrix t such that its
kth column contains the chemical footprint data given by the chemical footprinting protocol when mutating a
single nucleotide in the wild type rna  the mutation is specified on a separate label vector l  that contains
the index of the nucleotide modified and the base to which is was mutated  by definition  the first column of
t contains the chemical footprint information of the wild type rna  with no mutations  we use a pairwise
criterion to build the training set  that is  for each pair of nucleotides i and j  given by their respective index
in the rna sequence   we will see if they interact in some manner  i e  form a base pair   to do this  we
will focus on a vecinity in the matrix t around the centers  t  i  i   t  i  j   t  j  i  and t  j  j   in other
words  given a neiborhood parameter   we will look on the entries t  k  l  where k and l are integers such that
k  l    i    i       j    j            n    this follows the intuition that when mutating a nucleotide in a certain
position  there will occur structural rearrangements in its vicinity that will be expressed as a particular signal
in the tapestry  in this way  we focus our attention only in the boxes centered at t  i  j   t  j  i   t  i  i  and
t  j  j   with side size        furthermore  if perturbating two positions separately result in a significant signal
change in both positions then there is some evidence to believe that the nucleotides in those positions interact
in some way  our objective is to implement a svm that is capable of predicting what changes in the chemical
signal correlate with a physical interaction between the bases  thus  we use all of the entries t  k  l  as features
to build our training set  in order to account for the the rest of the entries in the row k and l  we take the set
b of all background entries t  k     l    that lie in the rows i and j  but not in f   and obtain their mean and
standard deviation  finally  we append to each feature vector integer labels of the bases that were mutated 
in this way  we can convert the tapestry t into n  feature vectors that give the pairwise tapestry information
of the nucleotides in the rna  the category of each feature vector is    if the respective bases i and j do not
interact and   if they do  we repeat this process for each rna tapestry that was include in the training set 

   

tweaking the svm parameters and reducing training set size by random
sampling

we tried different parameters for our svm and compared their performance  we varied the c trade off parameter  tried linear   nd to  th degree polynomials  gaussian kernels  and varied the  vicinity value described
above  we also varied the constraints on the condition wt x   b    to be wt x   b   to reduce the number of
negative predictions  this last parameter is motivated by the small amounts of positive examples in our training
set  from the n  possible base interactions  only a small fraction of them actually occur     this observation
also allowed us to reduce the training set size by performing random sampling of the negative training examples
 this was done by discarding a negative training example with a certain probability which  in our case  was      
fortunately  this did not alter our results in any way and significantly reduced the complexity of the training
  if

we are only considering secondary structure  the number of interactions is of order o n   this result derives from the fact
that in secondary structure interactions a nucleotide can interact with at most one other nucleotide 

 

fifigure    svm parameters  leave one out precisions of various svm parameters  c trade off parameter  blue  
  green  and the neighborhood size   red   for comparison purposes  we fit  from   to   for the figures
scale  although it was actually taken from   to      the precision given is before applying the filter 
set  we analyzed the performance of the svm varying one parameter at a time  first the c parameter  followed
by the kernel type   and  finally     for each parameter value  we performed a cross validation similar to leave
one out  but leaving out a complete set of vectors corresponding to a particular rna in each trial 

   

prediction filtering

since only a small set of rnas was available and due to the noisy nature of the data  we designed a method
to filter the resulting predictions  first  we scored each possible base pair bp i  j   formed by the nucleotides
positioned in i and j in the rna sequence and where bp is the base pair matrix of all possible base pairs  this
was done in the following manner 
 start by defining score i  j      
 if i and j are within a vicinity  in bp of a base pair interaction predicted by the svm  then set
score i  j     score i  j      
 if bp i  j  is a predicted base pair interaction but bp j  i  is not  then set score i  j     score i  j     
 if bp i  j  is a watson crick base pair  au gc  or a gu base pair  then set score i  j     score i  j      
 define the stem bonus sb i  j  as the iterative sum of the positive scores in the diagonals starting at
bp i     j      and bp i      j      stopping when a score of zero is encountered  intuitively  these bonus
corresponds to scoring a possible stem from which bp  i  j  is a part of 
to filter the base pairs  we partitioned each column of the base pair matrix into m intervals  for each interval in
each column  we discarded all of the predicted base pairs except the one with the highest score i  j    sb i  j  
as the parameter m increases  our filter acts in a more selective manner  conserving fewer positive predictions 
the case where m equals the sequence length allows only one prediction pair column  which allows at most one
base interaction per nucleotide  this property aligns perfectly with the definition of the secondary structure 
and we were pleased to find that  in the case of srph   we could predict the full secondary structure setting
m to be the length of the sequence 

 

results

given a full set of vectors that describe an rna molecule  and following our previous definitions for positive negative training examples and predictions  we expected to see only a small number of positive predictions 
at first  our svm greedily gave a negative prediction for every base pair  indeed  given the nature of the testing
set  this gave a spectacular error of less than    in most cases  but with horribly low precisions  we tried
to include more positive predictions by decreasing the parameter   but still got poor results  since we were

 

fifigure    svm base interaction predictions on the srph  motif  right  and the correct secondary structure
 left   after applying our filter  we can get the correct secondary structure 
constantly observing inconsistencies in the way that the training precision  testing precision  recall  and error
were varying given increases in the training set size  our next approach was to include more features 

   

adding the central box

after numerous failed attempts to improve our training and testing precisions by changing the svms parameters 
we finally decided to include more features in our feature vector  since we had observed that most structural
motifs in the tapestries were visually manifested in the form of xs  we decided that it was not sufficient to
focus on the boxes centered in the combined coordinates of each possible base pair  therefore  we would also
have to consider the changes ocurring in the middle of the region defined by the corners t  i  i  t  i  j  t  j  i  
ji
and t  j  j   in other words  we added the box centered at t  i   d ji
  e  j   d   e   whose size was also defined by
the vicinity parameter   this gave a great boost in the performance of our svm and we were happy to find that
only using the medloop motif dms and cmct data was sufficient to obtain a training error of   using a linear
kernel  in other words  the medloop motif training data inputted into our svm was capable of predicting its
own structure  this was an expected result  since the medloop motif data has a well defined chemical footprint
from which the structure can be quickly inferred by visual inspection 

   

testing other svm parameters

after enhancing our feature vector  we performed a leave one out type of cross validation  separating a whole
set of vectors corresponding to a rna in each trial  setting each parameter to its default value  which would
be zero for all parameters   we first optimized with respect to c  then with respect to the kernel type  then 
and  lastly    taking the best value in each step  we found that the linear and second degree polynomial kernels
performed well overall  while the higher degree polynomial kernels and the gaussian kernel tended to overfit the
svm   

   

taking joint dms and cmct data

at first  we thought that dms and cmct data should be treated separately  building and testing training sets
that included only dms data or only cmct data  this led to poor training precision and recall values  close
to    however  we found that arbitrarily adding both types of data to the training and testing sets greatly
improved the accuracy of the results  to the point where  when we apply the filtering method described above 
we could get the complete secondary structure for the medloop and srph  motif  sadly  we could not fully
test this with the larger trna data  since we are missing the cmct tapestry   this may follow from the
intuitive idea that dms and cmct data complement themselves since they modify different nucleotides  to
our surprise  by predicting using a training set of dms and cmct data  with a testing set only comprised of
shape data  we get noisy but visually good results  for example  the number of stems predicted is accurate  
this indicates  that in all chemical footprinting methods  the rna structure manifests itself in  qualitatively 
the same manner 
  we varied the radial parameter of the gaussian kernel  but could not get a good intermediate between an extreme overfit and
an extreme underfit  in which it could perform similar to the linear kernel 

 

fi 

discussion and future work

we have described a svm approach to analyze high throughput chemical modification probings of rna structure  this is a recent experimental approach that is much faster and cheaper than the crystalography method
that is considered the gold standard when determining rna structure  its high throughput nature gives us
vast amounts of data that are ideal for machine learning analysis  our current filtered svm method can give
an accurate estimate of the secondary structure  what is most striking is that there is no thermodynamics involved in our method  its findings are purely empirical    this not only illustrates the power of the experimental
method  but also gives great room for improvement by including thermodynamic rules or parameters in some
manner  currently  our classifier is trained with secondary structure interactions  we can easily extend the
power of our classifier to tertiary contacts by adding known tertiary information for our training rnas  in this
case  it would be best to have a second svm that predicts tertiary interactions  finally  although our filtering
approach was sufficient to extract the secondary structure  it could be replaced with another svm that cleans
the first svms predictions based on another set of features  secondary substructure patterns in the predicted
base pairing plot are easily found by visual inspection  so there must be a way to estimate them using an
automatic classifier   furthermore  let us remember that we have a limited set of   rnas  most of them missing
one of the three chemical types of chemical footprinting  dms  cmct  and shape   as more experimental
data becomes available in the future  it can be easily integrated into our classifier for further improvement 

 

acknowledgements

we deeply thank the das lab for giving us the tapestry data  special thanks to rhiju das for his insightful
comments 

references
    quentin vicens samuel m  pearlman michael brenowitz daniel herschlag alain laederach  rhiju das and
russ b  altman  semi automated and rapid quantification of nucleic acid footprinting and structure mapping
experiments  nature protocols                   
    c  b  do  d  a  woods  and s  batzoglou  contrafold  rna secondary structure prediction without physicsbased models  bioinformatics          july      
    e  j  merino  k  a  wilkinson  j  l  coughlan  and k  m  weeks  rna structure analysis at single nucleotide
resolution by selective   hydroxyl acylation and primer extension  shape   j am chem soc              
      march      
    marc parisien and francois major  the mc fold and mc sym pipeline infers rna structure from sequence
data  nature                  march      
    michael zuker  mfold web server for nucleic acid folding and hybridization prediction  nucleic acids res 
                  

  it is interesting to note that all de novo algorithms for rna structure prediction involve thermodynamics in some way  either
explicitly by following free energy minimization        or implicitly by including thermodynamic parameters    

 

fi