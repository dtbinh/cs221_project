automatic segmentation of clothing for the identification of fashion trends using
k means clustering
abstract 
in this paper we propose a new method for the automatic segmentation of clothing  and its subsequent
classification based on color  shape  texture and outfit complexity  the basic technique for segmentation leverages a
combination of machine learning and computer vision algorithms  these algorithms include  haar classification  skin
and face detection  canny edge detection  k means clustering  lighting reduction and probabilistic modeling  while the
automatic segmentation was successful with the majority of images from our training set  the breadth of images that
the algorithm properly segments can be significantly increased by using reinforcement learning to individually adjust
the tolerances and thresholds used in feature extraction  after segmenting the images  fashion trends were identified
based on  color  texture  outfit complexity  and shape  while these trends represent true clusters of fashion  further
research should be completed that follows a supervised learning model 
   introduction
  st century society has been inundated with a litany of text based recommendation services that leverage movie
rental history and music preferences  however  consumers have few options in the area of automatically finding
desirable clothing options  a prominent example  like com  features a method for doing visual search based on
pattern  shape and color  however they constrain image uploads to  a single piece of clothing  not containing people
and not having shadows or noise  such a system does not reflect the current capabilities of machine learning  thus we
are interested in looking at segmentation of clothing images to construct an artificial intelligent rich application  this
application would be pandora esque in that it automatically recommends clothing items based on clothing that the user
currently deems fashionable 
motivation for developing a custom algorithm
image segmentation is a problem in computer vision that researchers have been exploring for over a decade
 mena         as such  significant developments have been made in the isolation of foreground and background 
however  some gaps remain in the literature surrounding effective segmentation of individual clothing items in still
imaging  researchers have been able to differentiate clothing from skin  gallagher        in order to extract clothing
as a whole  furthermore  work by hu et al        demonstrated the ability to extract clothes from a persons torso 
despite the presence of these two capabilities  little research has been undertaken to segment individual pieces of
clothing without the use of a precompiled database of clothing models  borrs et al         developed a high level
description of clothing based on a combination of color texture and structural design  however  this algorithm does
not offer sufficient resolution of artifacts  nor proper separation of color versus texture  instead of grouping different
pieces of clothing  borrs et al  grouped items based on their being plain or textured  this constrained form of
clothing extraction is insufficient for our intended purpose of using these clothing features to establish an
understanding of different fashion trends  accordingly  we propose an algorithm that not only partitions individual
from clothing  but also identifies individual pieces of clothing 
   data description
     images were collected from two large us clothing retail stores  this dataset was reduced to     images in
order to fit our constraints of an image of a single individual that displayed the face  torso and  at least  a portion of
the leg  the resultant images contained individuals wearing  one to four pieces of clothing     images were of men 
the remaining     were of women  the types of clothes that individuals wore varied from formal to casual  subjects
in the pictures were from multiple ethnicities and had varied physical characteristics  some of the images were full
body  while others simply contained the thighs and above  all pictured individuals appeared on relatively
monochromatic backgrounds  close examination of the images indicated that several of the images had been altered 
finally  image sizes ranged between   and    kilobytes  with approximate dimensions of     x     
   research method
automatic image segmentation
simple segmentation utilizing global k means analysis

figlobal k means was executed on each image using the matlab image processing toolkit  following k means
segmentation  the algorithm used face and skin detection  in conjunction with segment pixel ranges to resolve the
layer that contained clothing  background and skin 
k means color analysis process
images were resized by a factor of   and converted to grayscale before being run through the k means algorithm
with a cluster size of    the k means algorithm used the default settings of square euclidean distance as the
optimization objective  and initialized used randomly selected centroids  the segmented images were subjected to a
face detection algorithm  the segment containing a face was determined to be the layer for skin  the two remaining
layers  the background and the clothes  were differentiated by determining the range of the pixel locations for each
segment  clothing segments have a smaller range than background  this resulted in clearly labeled segments for the
clothes  background and skin 
segmentation through combinatorial computer vision and machine learning algorithms
this method uses knowledge of the input image criteria to optimize the segmentation  first  canny edge detection
is applied to the image  creating a separate image composed of the component boundaries  the most external
boundary will typically correspond to the outline of the person because of image focus  dilation is applied to the
image to connect gaps in the external edge  a background mask is created by setting all pixels inside the external edge
to white  the detected background is sampled to create a representative rgb histogram  each pixel in the remaining
image is compared to the background histogram  all high occurrence pixels are included in the background mask  a
process known as back projection  this step is done to eliminate background that is not discovered in the scanning
step  morphological operations are done to remove small pieces of clothing that may have been identified as
background  the result is stored in a foreground image 
next  the face is located using haar classification  the pixels of the facial region are sampled and put into an h s
histogram for the skin  with the v component omitted to reduce the influence of lighting variations  foreground
image pixels are compared to the skin histogram  and pixels with high occurrences are marked as skin  morphological
operators are then applied to remove misclassified pixels
the background and skin masks are subtracted from the original image  leaving behind the clothes  the areas of
all the items in the remaining mask are calculated  and removed if they are below a certain threshold  this step ensures
that any noise due to the image subtraction is removed  finally  the remaining items in the mask go through a polygon
approximation algorithm  this eliminates jagged contours along the clothing  finally  the images and masks are sent to
the clustering algorithm 
segmentation through image specific combinatorial computer vision and machine learning algorithms
here we identified   critical values that can be modified to improve the quality of an individual images
segmentation     background probability threshold     background histogram bin size     skin probability threshold    
skin histogram bin size     background sample size 
the probability thresholds are used in the back projection step  any pixel above a certain probability is grouped
into that category  for example  if the skin probability threshold is set to     then any pixels identified as having a
    probability of being skin will be included in the mask  changing these parameters is useful if the background or
skin in the image has similar coloration as the clothing 
the histogram bin sizes are also used in the back projection step and determine the resolution of the histogram
comparison  a small bin size means that close intensity values  e g           will be grouped together as one color
while a large bin size means a more accurate grouping  in essence changing the bin size allows you to vary the amount
of data smoothing in the comparison  changing these parameters is useful when you have small intensity variations
in an image due to lighting  noise  etc 
the final value is the background sample size  which determines how much of the background is used to
construct the histogram during back projection  the larger the sample area is  the more accurate the background
segmentation  the size is limited by the proportion of the image occupied by the subject  for the purposes of this
project  a sample area of  image height x     image width  was deemed ideal 
segmentation using a combination of our algorithms
using the combination of the two aforementioned methods enabled our team to effectively segment clothing tops
from clothing bottoms  thus each individuals clothing could be decomposed into its two primary components 

ficlustering of clothing segments
to get an idea of clothing type  we extracted shape approximations  one of the visual cues for differentiating
outfits is by their general shapes  for example  a shirt and pants set will have a near rectangular shape while a gown
will have a more triangular shape  to capture this information as a feature vector  we use the   hu moments 
regardless of the orientation or size of the clothing  the moments allow the algorithm to make comparisons across
different images 
we chose to extract the average standard deviation of the red  green  and blue channels as a way to represent the
complexity of the outfit  outfits with patterns and multiple pieces had higher standard deviations than clothing with
solid colors and fewer pieces  an extension of this feature would be to keep the r g b standard deviations as separate
entries in the feature vector  allowing the algorithm to differentiate between different levels of complexity across the
primary colors 
to allow differentiation based on the colors in the clothing  we used h and s histograms as a feature vector  the
v component was omitted  since it is primarily affected by variations in lighting in an image  the h and s histograms
each had bin sizes of      giving a total of     points  using the entire histogram allows the algorithm to segment
based on the occurrence of color combinations in an outfit  versus just discriminating based on primary color  future
work may involve using pca to reduce the number of points  or using smaller bin sizes to reduce the number of
points while also reducing the sensitivity of the histogram comparisons due to an averaging of color  similarly
clothing color between tops and bottoms was used as a feature vector to understand contrasts  these values were
represented as r g b 
   results
automatic image segmentation
simple segmenting utilizing global k means analysis
    of the     images were segmented properly when using this method  a sample was deemed successfully
segmented if the algorithm was capable of extracting a primary piece of clothing from the image  i e  a top or bottom  
of the images that were not segmented properly     contained black clothing and in    images the algorithm could
not resolve the face  the remaining    images suffered from blending of clothing and background 
segmentation through generalized combinatorial computer vision and machine learning algorithms
   of the     images were segmented properly when using this algorithm  an image was determined to be
properly segmented if clothes were properly isolated 
segmentation through image specific combinatorial computer vision and machine learning algorithms
by adjusting one of the   critical features we were able to improve the quality of the segmentation 

clustering extracted features  subset of results presented here for sake of brevity 
single feature clustering
results from cluster analysis based on standard deviation of clothing using k   

fifigure    low complexity clothing

figure    low complexity clothing

results from cluster analysis based on standard deviation of color  histogram  using k   

figure    dark shades

figure    blue

figure    red

figure   

pink
multiple feature clustering
results from cluster analysis based on standard deviation of color  histogram  and color using k   

figure    high complexity   dark

figure    low complexity   red

figure    low complexity   light shades
   analysis
efficacy of automatic image segmentation
global k means
using global k means for determining clothing segments worked relatively well given its simplicity  for our
dataset  this form of analysis yielded     accuracy  furthermore  when coupled with a region detection algorithm  this
method proved to be useful in providing reasonable results  however  as implemented  this method did not provide
sufficient consistency  generalizability or precision to be used as our final method for automatic image segmentation 
in terms of consistency  on more than one occasion a single sample produced no results the first time followed by
good results the second time  generalizability was in question because the algorithm did not apply well to certain
colors  and certain color combinations  precision was a concern because without additional modifications for
executing connected components on the different regions of the image  it is difficult to consistently acquire whole
pieces of clothing  instead  patches of multicolor clothing would be erroneously be grouped with the background  for
example 
nonetheless  given its ease of use  global k means provided significant benefit  and when coupled with our other
algorithm  enabled for the segmentation of individual pieces of clothing 
segmentation through combinatorial computer vision and machine learning algorithms
using our learning algorithm we were able to successfully resolve clothing from nearly half of the images in
our data set  however  once we adjusted the thresholds and bin sizes we were able to resolve clothing from all of the
images in our training sample  accordingly  we believe that by modifying our learning algorithm to automatically
determine the best parameters  this process can be extended to include very large training sets 
clustering extracted features
through the use of k means analysis on single and multiple features we grouped images that had similarly
colored tops  and can also group together images that have similar color histograms  similarly we can establish a
grouping for images that have some level of complexity in them  this complexity can be in the form of differently
colored tops and bottoms when taking the standard deviation of the histogram  complexity can also be a proxy for
highly textured clothes  or clothes with extensive designs  we see that through our analysis these types of items can be
clustered together  furthermore  the multiple feature analysis justified that by taking into account several features  we
can group together clothing items that have similarities on several different levels 

fibased on these clusterings we can make some initial conjectures about trends within the fashion industry 
firstly  by observing clustering based on color complexity  it is apparent that fashion tends to steer in the direction of
simplicity  complex designs are used in select cases  but the majority of the outfits are plain  similarly  in our findings
related to clothing shape  it was revealed that the majority of outfits  or at least models  tend to be more slim than
wide  this may also be a case of certain types of outfits being better suited for certain body sizes  but that question is
outside the scope of this project 
the result of the above feature clustering was the creation of reasonably meaningful groups  however  several
feature clusterings that completed revealed results that dont have easily perceivable physical manifestation  future
work may venture to make more sense of these features 
   future work
refining the image segmentation process
though our combined algorithms were able to successfully resolve individual clothing items from the majority of
the training samples  we recognize that there are actions that can be taken to improve this process  we have
demonstrated that several of the samples which were not amenable to the generalized combinatorial approach could
be solved by varying the parameters for the thresholds and bin sizes  based on this finding we propose the use of
reinforcement learning in order to train our system to automatically determine the appropriate parameters for
segmenting each image  determining these values would be based on a number of characteristics of the image 
furthermore  we surmise that completing a global k means or gaussian mixture model may help predict which images
will undergo poor segmentation in our custom algorithm 
extending feature extraction capability
additional work may also benefit from the inclusion of more extensive feature extraction  for example  we
currently examine color of primary clothing objects  extending our algorithm to also segment clothing accessories
could offer novel information for training machines to recognize fashion 
towards a model for learning fashion
finally  though we were able to identify small trends in societys conception of fashion  a more steadfast
conclusion could be established using a supervised learning model  one way for creating such a model could be by
taking segmented pieces of clothing  combining them at random and soliciting fashion experts to assess the
fashionability of each pair  these training examples could then be analyzed using support vector machines to create a
more concrete model of fashion 
   concluding remarks
through this study we have developed an algorithm for automatically segmenting clothing from still images 
using the features that we extracted from the clothes  we were able to draw some initial conclusions about fashion
trends  moreover  we have laid a framework for continued research in support of our desired end result  a machine
that can make fashion recommendations based on automatic segmentation and meaningful clustering of clothing
features 
   works cited
borrs agns  tous francesc  llads josep  vanrell maria   high level clothes description based on colourtexture and structural features    st  iberian conference on pattern recognition and image analysis ibpria      
hu  z   yan  h   and lin  x  clothing segmentation using foreground and background estimation based on the
constrained delaunay triangulation  pattern recogn        may        pages            doi 
http   dx doi org         j patcog            
mena  j b   malpica  j a         color image segmentation using the dempster sharer theory of evidence for the
fusion of texture  pattern recognition  internat  arch  photogrammet  remote sensing     part   w  

fi