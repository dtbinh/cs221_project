detecting chronic pain with structural mris
hoameng ung
hoameng ung stanford edu
cs     autumn       stanford university
abstract
the subjective nature of pain makes an objective measurement difficult to produce  if such a
measurement is possible  then this knowledge would assist in the management of patients whose self
report of pain is either unavailable or called into question  past studies have demonstrated that
chronic pain is associated with gray matter  gm  atrophy  detectable by magnetic resonance imaging 
we investigate to see if this decline of gm density can be used to distinguish between healthy and
chronic low back pain  lbp  subjects with greater than chance accuracy  structural mr scans from
   age and gender matched subjects were used  several feature selection and reduction methods were
performed  including grid and roi parcellation  principal component analysis  pca   and ranking by
mutual information  accuracy  assessed with both   norm and   norm svm using striated    fold
cross validation  while significant  were low and corresponding features driving the classifier were
inconsistent  parcellation gave a high of     accuracy  while pca and mi gave     and     
respectively 
   introduction
an estimated    million americans suffer
from chronic pain  and the costs of low back
pain in the united states exceed      billion
per year      since pain is subjective 
self reported pain cannot be verified  because of
this  an objective measure of pain could assist in
the management of patients who are suspected
of malingering or drug seeking and of patients
unable to communicate such as the critically ill 
studies have shown that regional changes in
gray matter density resulting from chronic pain
are detectable by mri         
recently  machine learning techniques have
been adopted in the field of neuroimaging in an
attempt to learn about cognitive science and to
detect conditions based on imaging data  some
examples include the detection of alzheimer s
and huntington s disease using svms and gray
matter density as features          however 
applications to detection of diseases such as
alzheimer s and huntington s are fairly trivial
tasks due to the etiology of the disease and its

tremendous effect on the structure of the brain
with time  the etiology of chronic pain is
relatively more complicated  the differences in
the type of pain have been shown to affect the
underlying biological changes  for instance 
apkarian demonstrated a larger decline in gray
matter density with neuropathic chronic pain
patients versus nonneuropathic patients through
voxel based morphometry  vbm  analysis
techniques     
vbm is currently the standard method used
to study differences in tissue classes between
subjects with structural mri data      it
essentially allows voxel by voxel comparison of
subjects by transforming each brain to a
template and then performing statistical tests on
the voxel level  the advantage of using an svm
as opposed to traditional techniques of vbm is
that an svm is can capture higher dimensional
relationships within the data  rather than
comparing between individual voxels as in
vbm  in addition  svms allow for
classification of one sample  whereas vbm

fi   

analyses are generally limited to comparisons
between groups of subjects 
   materials and methods
     dataset
the dataset includes    gender and
age matched subjects     controls     patients  
chronic pain patients were defined as having
greater than   months of pain  each scan was
segmented into gray matter and normalized to
the mni template  each example contained
roughly         features  with each feature
corresponding to the gray matter density at a
particular voxel  each feature was normalized to
a euclidean distance of   
     feature selection and reduction
four different feature reduction selection
methods were employed  two types of
parcellation  principal components  and ranking
based on mutual information 

       principal components
principal component analysis  pca  was
used to determine the directionality of the
training data  the dataset was transformed into
principal component space  consisting of    pcs 
the weights of the feature vector  corresponding
to weights of each principal component  was
transformed back into brain space by a
multiplication by the eigenvectors  principal
components  and the most highly weighted
individual voxels were found  this method is
similar to that employed in     
       mutual information
mutual information  mi  was calculated for
each of the original voxels with the labels 
intensity values were discretized to     values
in the range        and label          ranking
was performed using a forward search wrapper
method  adding the highest mi valued features
at a time until the error from leave one out
cross validation  loocv  increased  this
resulted in the selection of    individual voxels 

       grid parcellation
     classification
each gray matter map was divided into
 x x  voxel volumes  and the gray matter
density averaged within each  each volume
represented   cm  cubes  to prevent skewed
volumes  volumes with fewer than    voxels
were averaged into the nearest volume with
greater than or equal to    voxels  this method
reduced the number of features to roughly      
       aal parcellation
the automatic anatomical labeling
template divides the brain into     different
rois based on anatomical structure  each gray
matter map was divided into these rois and the
gray matter density averaged within each 
producing     features 

both an l  and l  regularized svm  with a
linear kernel  was used with each feature
reduction method  the matlab svm
implementation was developed by anton
schwaighofer and other code was based on
in house implementations  c parameter
selection was done using a standard grid search 
   fold striated cross validation was used to
assess the performance of the classifier  striated
k fold cross validation involves selecting an
equal ratio of examples from each class
representative of the dataset on a whole and has
been shown to be more accurate at assessing
performance     
the significance of the performance was
assessed using a monte carlo permutation test 
iterated      times  this test involves

fi   

permuting the labels and rerunning the training
and testing to determine if the separation was
based on meaningful patterns between the two
classes 

feature selection
method
grid       

  norm
svm
   

  norm
svm
   

aal      

   

   

pca     

    

    

mi     

   

   

     regression
linear regression was performed using
elastic net regularization with grid parcellated
features  a matlab implementation of least
angle regression  lars  by sjstrand was
used  the dependent variable was the duration
in pain  years   the model was trained on    
of the data and tested on the remaining     
the resulting beta weights were used to
determine the volumes driving the classifier 
   results
     classification accuracies
accuracies for grid and aal parcellation
were marginally better than chance  feature
reduction by pca resulted in high accuracies  as
well as selection of voxels by computation of
the mi values  table     with pca      
accuracy was achieved based on the first   
principal components  and     with mi  the
linear regression by elastic net resulted in a sum
of squared errors of       years  
differences in classification accuracy
between   norm and   norm svms were
marginal at best 
     neuronal correlates
the weights obtained by training with the
svm indicate the features most important in
determining whether an example belongs to a
specific class  for aal parcellation  highly
weighted features include the right pallidum
 figure  a   for grid parcellation  the highly
weighted features includes a section of the left
thalamus  a part of the ventromedial prefrontal
cortex  vmpc   and a part of the dorsolateral

table    classification accuracies based on
feature selection methods  with its
corresponding number of features  and   
  norm svms  all values are significant p     
prefrontal cortex  dlpc   figure  b   pca and
mi gave individual voxels that were delocalized
throughout the brain  not shown   regression by
elastic net performed on grid parcellated
features have similarities to the weights given
by training with the svm  figure  c  
   discussion
the accuracies obtained for parcellation are
poor  but because it is significant  this indicates
that something can be learned about the dataset
provided 
the aal template is commonly used to
select predefined rois  but the lack of
specificity may explain the low accuracy  the
large divisions of the brain will mask any
regional differences within each roi  for
instance  different parts of the cingulate cortex
are known to have different functions  so
grouping them all and averaging their gray
matter densities may smooth out any existing
differences  nonetheless  areas that are much
smaller are captured by the aal divisions  such
as the pallidum  since the pallidum is involved
in thalamic pathways  such as inhibiting the
relaying of sensory stimuli from specific nuclei 
overstimulation may lead to changes 

fi   

a 

b 

c 

figure    highly weighted features by a  aal
parcellation b  grid parcellation and c  elastic net
regression

grid parcellation was motivated by prior
knowledge about the functions of anatomical
parts in the brain  with chronic pain  certain
structural areas of the brain are expected to be
affected  thus  parcellation into   cm  volumes
is small enough to capture areas of interest  the
thalamus is believed to be a site that relays
sensory information received from the body
towards different cortices in the brain and is
believed to play a role in mediating pain signals
             nociceptive stimuli synapse at the
thalamus before being sent to parts of the
prefrontal cortex  for this reason  an overload of
sensory stimulus at the thalamus can cause a
decrease in gray matter density  a result of
suppressed neuronal activity from a decrease in

membrane receptors  neuronal cell degeneration 
or neuron apoptosis  the prefrontal cortex has
also been shown to mediate chronic pain 
decreases in dlpc gray matter density align
with previous findings     
principal component analysis enables very
high accuracy when performed on the original
features  upon transformation of the weight
vector back into brain space  the individual
voxels that were highly weighted were
delocalized and did not show any
comprehensible pattern  the first principal
component explains only     of the variance 
and subsequent components much less  the
need for many components to explain the data
may indicate a low signal to noise ratio  and the
components may not capture conditions inherent
in the underlying condition 
feature ranking by mutual information was
performed on the original feature set  and 
through cross validation  resulted in the
selection of    individual voxels  these voxels
were  similar to the pca results  scattered
throughout the brain and were unhelpful in
determining correlations with chronic pain and
brain structure 
the use of a   norm svm has been shown
to give better performance in the presence of
feature redundancies       thus  if multiple
areas of the brain undergo atrophy  then this
would be a redundant feature and performance
should improve with the use of an l  norm
penalty  although a   norm svm gave higher
accuracies in certain cases  the improvement
was marginal at best 
since duration of chronic pain also helps
determine the amount of gray matter loss      a
regression where the dependent variable is
duration of pain may help determine areas of the
brain affected by lbp  the elastic net is a
regularization and variable selection method
that represents the data as a sparse matrix where
a limited number of features are given weights
and is thus useful when the number of
predictors is greater than the number of

fi   

examples       the resulting beta weights
closely aligned with the results from grid
parcellation  indicating that those features are
important in determining both the duration of
pain with regression and the presence of chronic
pain with classification 
future directions would be to obtain more
data in order to increase the signal to noise ratio 
furthermore  manual feature selection by
defining rois may prove helpful  for instance 
rois of the left thalamus  dlpc  and vmpc
and classifying based only on voxels in those
areas may be interesting  in addition  lbp
encompasses a fairly large array of conditions 
and each of these conditions may have different
effects on the brain  a narrower subset of
patients may help in classification 
   conclusion
although classification accuracy was low
for parcellated features  the resulting weights
indicate that decreased gray matter density in
the left thalamus  dlpc  and vlpc help predict
incidence of chronic pain  the low accuracy of
parcellation methods and the high accuracy of
pca and mi performed on original voxels
indicate a low signal to noise ratio in the data
possibly a result of the variability in the
underlying lbp conditions  better feature
reduction methods  such as manual selection of
rois  may be performed and more data
gathered in order to reduce this noise 
nonetheless  the significance of the values gives
a promising outlook that gray matter density
may be used to detect chronic pain 
acknowledgements
i would like to thank catie chang and quoc
le for providing guidance in this project  as
well as professor andrew ng for instructing
cs     in addition  i would like to thank dr 
sean mackey and dr  amit etkin for providing
data used in this analysis 

references
   lumbar disc disorders and low back pain 
socioeconomic factors and consequences  katz  j 
      the journal of bone and joint surgery  pp 
      
   chronic back pain is associated with decreased
prefrontal and thalamic gray matter density 
apkarian  av        the journal of neuroscience 
pp              
   chronic pain may change the structure of the
brain  may  arne        pain  pp       
   automatic classification of mr scans in
alzheimer s disease  klppel  stefan        brain 
pp          
   support vector machine based classification of
alzheimer s disease from whole brain anatomical
mri  magnin  b        neuroradiology  pp        
   voxel based morphometry    the methods 
ashburner  john        neuroimage  pp         
   classifying brain states and determining the
discriminating activation patterns  support vector
machine on functional mri data  mourao miranda 
janaina        neuroimage 
   a study of cross validation and bootstrap for
accuracy estimation and model selection  kohavi 
ron        international joint conference on
artificial intelligence 
   functional mri study of thalamic and cortical
activations evoked by cutaneous heat  cold  and
tactile stimuli   david  karen        the journal of
neurophysiology  pp            
    affective components and intensity of pain
correlate with structural differences in gray matter
in chronic back pain patients  schmidth wilcke 
      pain  pp        
    abnormal brain chemistry in chronic back pain 
an in vivo proton magnetic resonance spectroscopy
study  grachey  igor        pain  pp       
      norm support vector machines  zhu  j       
nips 
    regularization and variable selection via the
elastic net  zuo  h        journal of the royal
statistical society b 

fi