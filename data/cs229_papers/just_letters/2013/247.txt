chess game result prediction system
zheyuan fan  yuming kuang  xiaolin lin  stanford university
cs     machine learning project report  autumn     

abstrct
n this project we train world chess
federation  fide  rating systems using a training dataset of a recent
eleven year period with games from     
chess players  we will then use our system to predict the outcome of chess games
played by the same players in the following half year  accuracy between predicted
results and actual game results is the primary indicator of whether our approach is
a practical chess rating system 

a     month period of professional chess games
from      different chess players from year     
to year      
   primary training dataset from the first    
months to train our prediction system 
   secondary training dataset  which is used
along with the primary data set to validate and
tune parameters 
   initial rating list that provides an initial list of
the involved players fide ratings and k factor
 players game activity factor  
   test games dataset that identifies the chess
games that we are predicting 

background

method

world chess federation  fide  adopted elo rating system since      and this rating system has
been the primary yardstick in the world to measure the strength of chess players  the elo rating
system also has many other applications in sports
rankings  despite the popularity of the elo system  it has never been demonstrated that it is
technically superior to other approaches  in this
project we are going to investigate approaches
that might do better than the elo system  such
an investigation could have major implications on
the theory and practice of ratings methodology 

model   hidden markov process

i

we model the game results as a hidden markov
process  we assume that each chess player i has
a rating  or relative strength  in month t  denoted
as xi t   we cant directly observe xi t   so its the
hidden state of the hidden markov process  we
can observe the chess game results yt j   j    which
denotes the result of the game between white
player j  and black player j  in month t  yt j   j 
can take   values    for white player win      for
draw    for white player lose  the dynamics of
xi t and yt j   j  is summarized as

dataset
xi t   w  xt  
all game results and rating data are extracted
from fide internal database and chessbase
database  we have collected the following data in

k
x

wl xi tl   i t

 
i t  n     i t
 

l  

   
yt j   j  

y
t jt j   j   j     

  yt j   j   

 t j   j   

   

page   of  

filog

t j   j 
  xj   t  xj   t   f a
   t j   j 

    fitting   newton raphsons method

the idea of fitting the data is to update the
in      the dynamic of ratings xi t follows player ratings by maximizing the log likelihood
a time series model ar k   in other words  function  at month t  the likelihood function of
xi t is a weighted average of xt   average player ratings x and game results y
i t
t j   j  is
rating of all the players at month t     and
xi tl  l                 k   the players ratings of
p  xi t   yt j   j   xi s   s   t 
previous k months   plus a gaussian noise  xt 
p
p
y
     xi t  w  xt    kl   wl xi tl    
 
 
i t
is included in the weighted average  because if


e
 i t
a player doesnt play this month  we would like
i  
y yt j  j
his rating to move to the average rating of all

t j   j         t j   j     yt j   j   
players  instead of just the average rating of the
 j   j   
player 
p
p
y
     xi t  w  xt    kl   wl xi tl    
 
 
i t


e
 i t
in      yt j   j  follows a bernoulli like disi  
y
tribution  with a parameter t j   j  which reflects

eyt j   j   xj   t xj   t  f a 
the winning probability determined by xj   t and
 j   j   
xj   t   here  a multinomial distribution might be
 
an alternative choice  but it also introduces a

xj   t xj   t  f a
  e
new tuning parameter which is hard to determine 
   
in      we model the odds of winning probability take log  we get the log likelihood function
to be linear in xj   t and xj   t   because of the
x  
simplicity of its log likelihood function  fa is
 xi t 
lt   log ct   
 
a constant representing the advantage of white
 
i t
i
player   taking value log     
  since in the rating
   
k
x
range of these players  white players winning
 w  xt   
wl xi tl    
probability is about     according to fide
l  
x
report 
 
yt j   j   xj   t  xj   t   f a 
 j   j   

the parameters in the model  the weights
 
wl s and the noise variance i t
  are chosen to
have the form
expl
wl   pk  
l
s   exp
w      

l                 k
k
x

wl

x

log     exj   t xj   t  f a  

   

 j   j   

    its easy to see the log likelihood function is concave  to maximize it  we compute the gradient
and hessian
   

l  
 
i t
  v ar xi t    xi t            xi tk       



   

in     the weight is decreasing exponentially 
which corresponds to the idea that historical
ratings influence on future games is decreasing
exponentially 
in      the noise variance includes a term
that represents the stability of a players rating 
note that the tuning parameters of this hidden
markov process are k   and     

gradi  

lt
xi t
k

x
 
      xi t   w  xt   
wl xi tl   
i t
l  
x
x
 
yt i j  
yt j   i
 i j   



x
 i j   

 

x
 j   i 

 j   i 

exi t xj   t  f a
    exi t xj   t  f a
exj   t xi t  f a
    exj   t xi t  f a

   

page   of  

fi    

tune k  given         
log likelihood

    

    
 

 

 

 

 

 

 

  

tune   given k     
      
simulation
fitting
     

      

     
 

   

   

   

   

 


tune   given k        
    

log likelihood

   

   

   

   

 

   

   



figure    testing log likelihood v s tuning parameters

results

p  yi j      white win    i j     
q
       draw    c i j     i j       

   

success rates v s predicted winning probability

   

   

success rates

   

p  yi j      white lose       i j     
where i j is computed by     and constant c is
set to be     constant c is set such that the
draw game probability agrees with the probability
that a draw game appears in the training data
set  which is roughlt      we then pick the result
with largest probability as our prediction 

    

   

given the current ratings xi and xj of player i
and j  we predict the game result yi j by computing

    
     

     
 

xi t  n          t    k       k               
    

prediction

simulation
fitting

     

   

    

at the start of the updating process  we initialize
the ratings to be

p  yi j

    

k

then we can apply newton raphsons method
to get the updated player ratings 
new
old
 
xi t
   xi t
 h   grad

simulation
fitting

    

    
 

log likelihood

   lt
x x
 i t j t p
xi t xj  t  f a

      i j    e xi t x j   t  f a  


   e
 
i t


x
xi t  f a

e j   t
 p
i j
 j   i     exj   t xi t  f a   
 
p
xi t xj t  f a
e


 i j     exi t xj t  f a   



p
x x  f a

    j i  e xj tj t xi ti t  f a  
i 
  j
   e
 

hi j  

picking tuning parameter

   

   

   

   

   

   

predicted winning probability

in our model  we have   tuning parameters 
k   and    that we have to specify before
fitting the data  to pick them  we separate
the data into training set and testing set  try
different combinations of k   and      and pick
the combination with the largest log likelihood
for testing data  figure   shows how testing
log likelihood changes with tuning parameters 

figure    success rates v s predict winning probability 

we applied our method to a data set of game
results of      chess players in    years  the
data set was separated into   parts  game results
of month   to     as the training set and results
of month     to     as testing set  for the
with this analysis  we pick k              training part  we fitted the training set to get the
       
player ratings  then for testing part  each month

page   of  

fiwe used the most recently updated ratings to probability  when true result is win  draw
predict the game results  then the ratings were and lose as figure    the figure clearly shows
updated using the observed game results of this that  predicts the trend of true results 
month 
the success rate of prediction is        
which is much better than a random guess       
since result has white win  draw  white lose  
cases   also if we only look at the games with the
case that both prediction and observed results
are not draw  the success rate of prediction
is         which implies that the prediction is
reliable when ratings show one player dominates
the other 

summary and future work

as a summary  the overall performance of the
hidden markov process model in predicting
chess game results is satisfactory  chess itself is
a rather unpredictable game  especially if two
players are close in rating performance and there
are tons of games where lower rated players
upset higher rated players  therefore  a success
rate of        given the three possible game
to further illustrate the result  we plot outcomes is not a bad result 
the success rates v s predict winning probability
 as figure    we can see that when  is below from figure   we can see that when the
    or above      the success rate is very high  predicted winning probability  is near the
which implies the confidence that when one threshold between a draw and win lose game  the
player dominates the other  our rating system prediction result is poor  in future work  a new
is reliable  when  is between     and      the model to better predict the game results when
success rate is around      which makes sense player ratings difference is near the threshold
because for games between players with similar may be possible  in general  it is hard to predict
ratings  most results would be draw which is game results in this edge case but a study of a
consistent with our prediction but its also likely large dataset of this particular type of games
that win or lost happens  for  between     may help to establish a new model  several
and          and       the prediction is poor  factors  including the two players historical game
because the result is on the edge of lose and results and trends  game time control  category
draw   or win and draw   which is difficult to of the tournament  chess opening preference and
predict in nature 
playing style  may be incorporated to better
evaluate their individual winning probability 
box plot of predicted winning probability

   
   
   
   

predicted winning probability

   

another further work that can be done is
to compare our system with the prevailing elo
chess rating system adopted by fide  accurate
comparison needs careful calibration from the
elo system into our system but from an empirical
points of view  our result should be no worse
than elo rating system  much of the appeal of
the elo system comes from its simplicity and
familiarity  and it was ideally suited to a time
when the computation of ratings was a significant
practical challenge even for an annual list of a
win
draw
lose
few hundred players  elos formula was derived
theoretically  in an era without large amounts of
figure    box plot of predict winning probability historical data or anything approaching todays
computing power  with the benefit of powerful

computers and large game databases  we are able
we also plot the box plot of predict winning to investigate approaches that might do better

page   of  

fithan elo at predicting chess results  such an
investigation could have major implications on
the theory and practice of ratings methodology 
both for chess and also for the world beyond
chess 

references
 the uscf rating system  glickman  mark e  
and thomas doan         
 rating the chess rating system  glickman 
mark e   and albyn c  jones         
chance berlin then new york                 
 hidden markov processes  ephraim  yariv  and
neri merhav          information theory 
ieee transactions on                       
 fide chess rating challenge  http 
  www kaggle com c chessratings 
 elo rating system  http   www princeton 
edu  achaney tmve wiki   k docs elo 
rating system html

page   of  

fi