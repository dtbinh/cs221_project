occlusion robust pose and model estimation using gaussian process latent
variable model on gpu
christopher b  choy
stanford university
chrischoy stanford edu

abstract
in this project  we would like to develop multi object
pose and model estimation which uses the  d voxelized
model and foreground background segmentation to detect
 d pose and model variation  in the relevant literature 
     the authors used gradient descent to minimize the optimization energy function which is the integration over image multiplied by the smoothed step function of sdf of  d
model  silhouette  to jointly optimize the   degree location
and rotations and deformation of model  the system is generally stable given prior mask and pose and works faster
than state of the art  d pose estimation algorithm such as
zia and stark      however  the system requires prior mask
which is hard to get automatically  in this project  we propose automatic segmentation mechanism that make use of
object relation and alternating multi object newton step 
thus  we improve the system by making it robust to texture and background color and especially occlusion from
other object  the pipeline is first  we use     object detector to find location of objects and use these bounding boxes
for contour detection techniques such as hierarchical image
segmentation     or grab cut to capture the contour of objects which is essential for correct pose estimation  then we
run newton step for pose and model estimation for multiple
objects 

 a  initialization  a jeep car

 b  after    iterations  sedan

figure    joint optimization over pose estimation and model
deformation

that incorporating  d structure helps recognition             
among these papers      uses  d image cues for part detection and  d model variation and this is one of the successful
algorithm that works in the real world setting but their computation time is too prohibitive 
before we delve into details  we would like to emphasize how important  d model recognition is in our perception which enables us to navigate through intricate obstacles
and recognize objects  however such recognition would not
be complete if we cant estimate what the objects pose is 
for instance  for a driverless car  it is crucial to recognize
cars direction precisely otherwise it might get into an accident  also   d pose estimation helps machine to predict the
occluded part of an object      needless to say  this prediction will be crucial if a robot navigates through a complex
environment 

   introduction
     relevant literature

     overview

the pose   dimension location and   dimension rotation 
estimation is one of the fundamental problems that intrigued
many scholars from the very beginning of the computer vision      however  due to the complexity and noise  pose estimation using  d model had been set aside from the main
stream  instead  d features such as sift and hog has
been used to find a bounding box    
recently  there has been active research about this topic
and object recognition using  d model     and they showed

to accurately capture the model  we first voxelize the
model by n  n  n grid and for stability  we use a sign
distance function sdf  to preserve the contour of an object 
 i e  the interior of the contour have negative distance where
as the exterior have positive distance from the contour c  
to search over discrete space of collection of objects  we
use a non linear dimensionality reduction technique called
gaussian process latent variable model gplvm       in
 

fix

we can get analytic formulation of 
  but x
has
p
no analytic form so we approximate it using centered finite
differences 

short  gplvm is a variant of probabilistic pca which is
capable of reducing high dimensional object to low dimension counterpart  latent variable  using non parametric representation  so we jointly search over possible  d  location 
rotation  scale  plus latent variable for shape deformation 
figure   shows the initial and final pose of a car  it takes
gradient steps to minimize the objective function 
we follow the steps of      the energy function required
for such optimization is the following 
x
e     
log   x  pf  x          x   pb  x  

   model variation
since we are taking newton steps for pose estimation 
we would like to take newton steps for the model variation 
thus  we have to reduce the dimension of voxelized data
to a very low dimensional representation  in       authors
use kpca to reduce the dimension of the voxelized models  similary      uses gaussian process latent variable
model gplvm   briefly  gplvm starts from the probabilistic pca  ppca  formulation  in ppca  data y is represented as y   w x     where x is the latent variable and w
is the mapping and white noise    n         i   then
we marginalize over x and posterior probability is given as
p y w      n     w w t      i   the log likelihood of
the probability is

x

   
where  is the  d sdf and  be  d image plane    
is projection function that indicate for foreground and background 
the above function is probabilistic or but for numerical
stability  exponential was used  where pf and pb are foreground and background posterior probabilities respectively 
pf  u   

f p  y u  cf  
f p  y u  cf     b p  y u  cb  

d
 
dn
ln     ln k   tr k   y t y  
 
 
 
t
 
k   ww    i

   

l 

where cf indicates color histogram of the foreground and
f is the fraction of pixels in the foreground 
our objective is to decrease the energy function with
     x   variables    degree of freedom in translation and
  degree of freedom in rotation and   for the scale and x
for latent variable dimension  for rotation  we parametrize
the rotation using quaternions 
we take gradient descent to minimize the objective function  since the energy function is multimodal and complex 
it is prone to stuck in a local minimum and takes some iterations to converge  for instance  the model should intersect
with the objects in the image to converge to the correct pose 
the gradients of the energy function are the following  for
detailed explanation we refer readers to     
the object deformation is quite challenging and we will
refer readers to     for detailed information  briefly  we
voxelize models into               grids and the take
discrete cosine transformation and take coefficients of the
highest            harmonics  we assume that the variation of the model is embedded in a very low dimensional
subspace which we will use gaussian process latent variable model gplvm  to reduce it to   latent dimensions 
we will explain more in section    the gradient of the energy is the following

where y is the row wise data matrix  the solution of
w l     is w   u   l  v   where u   anbd v   are first few
 
eigenvectors and eigenvalues of covariance matrix d
y ty
 
with arbitrary rotation matrix v   in this setting k can be
interpreted as an affine kernel matrix however  in the dual
problem of ppca  we marginalize w instead of x and get
similar but different log probability 
dn
d
 
ln     ln k   tr k   y y t  
 
 
 
k   xx t      i
l 

and take x l     and what we get is x   u lv
where u and l are first few eigenvectors and eigenvalues
of innerproduct matrix n  y y t   if we use non linear
kernel


  x x    

i
j
instead of affine kernel   xi   xj       exp
 
  
      ij we get gaussian process latent variable mode 
since the objective is non convex  we initialize using
pca and use stochastic gradient descent to find the latent
variables    

   development upon existing framework
     overview

x
e
pf  x   pb  x 
  
 
p
  pf  x           pb  x  p

our system make use of state of the art object
detection    and segmentation algorithms such as     and
     to make foreground segmentation mask  due to its imperfection  the segmentation is highly influenced by background around the object  in      the system requires prior

x

   
x e x   x
  
         
p
e x      x p
z

   

 

fifigure     a   d pose after    iterations of pixelwiseposterior  b   d pose after    iterations using      c  segmentation result    

 a   d pose after convergence   b  pixel wize posterior fore d model red 
ground background separation

mask which is hard to get automatically to make color histogram  so  in our framework  we propose automatic segmentation mechanism that later will be feed into the system 
even though the segmentation is imperfect  we can estimate
pose reasonably well using non intersection constraints 

good as hierarchical segmentation and grab cut  grow cut
requires semi supervised input for each of the image so it is
hard to scale  so we focus on hierarchical segmentation and
grab cut 

     segmentation

the problems using hierarchical segmentation is that it
takes too much time to process the whole image and if we
get poor result  also for grab cut  it requires bounding box 
thus we used deformable part model     for car bounding
box detection and feed it to the grab cut or hierarchical segmentation for foreground background segmentation  figure
  
through this process  we could get better segmentation 
however  if we have occlusion or adjacent objects  the mask
also includes the other objects  thus we will deal with this
imperfect segmentation mask using non intersection constraints in the next section 

     detection and segmentation

we performed several experiment on     to test the effectiveness of the color histogram foreground pixel wise posterior  using  a  clean background and  b  noisy background 
when the background is clean  it converged to a reasonable
pose  however  it does not mean that the method works
for any arbitrary initialization  the convergence sometimes
happens when  d model and the foreground of the image
 object in  d image  have overlap  this issue has been addressed also in the paper      also  we have to emphasize
again that the color histogram requires foreground mask
which is hard to get automatically 
in  b   the system generally had more difficulty finding
the right pose  the color histogram for foreground and
background separation are prone to noise since the foreground color appeared also in the background  thus it failed
to register the object correctly 
the primary reason for this failure is in part due to poor
foreground background segmentation figure  a  the patch
on the cup figure  b has similar color to the background
and thus the posterior probability on the patch is very low 
thus it creates strong local minima  so  apart from the fact
that the system requires foreground mask  which is hard to
get automatically  the color histogram is very noisy 
the comparison between hierarchical segmentation and
color histogram assuming mask is given  is shown in figure    the color histogram had problem distinguishing tires
and shadow from the background so it performs worse than
hierarchical segmentation 
thus  we naturally move on to other state of the art segmentation algorithms     expansion    swap  hierarchical segmentation  grab cut  graph cut and grow cut 
however  we found out that graph cut and variation of mrf
segmentation algorithms requires time consuming energy
function learning  even though we provided ground truth
mask and performed learning  the performance was not as

   multiple object pose estimation
to our knowledge there has been no work that tries to
make use of other objects to better estimate poses of multiple objects  to make use of object relations  we define
occlusion  occlusion is case when there are more than one
object is occupying the same pixel and formally 
x
x
 o  x      
   
oo xalongtheray

where  is the projection and o  x  is the sdf of voxel
x of the object o  we start from the case where there is
no occlusion but the segmentation gives us poor mask  i e 
figure   mask   and    for these objects  there is no overlap
but it is clear that masks are not reliable 
to robustly detect the objects from noisy mask  we make
use of projections of the other objects and make it not overlap with the object of interest  the additional constrains that
enforces that there should be only one object per pixel 
xx
min
log  o  x  pfo  x         o  x   pbo  x  


s t 

oo x

x
oo

 

 o     

fimin


x

log  o  x  pfo  x         o  x   pbo  x  

x

 
 
i e  we linearly project other objects o  into the mask so that
when the object is taking gradient step  it take into account
all the objects which helps to resolve the occlusion case 
this step effectively conveys all the information about object location and occlusions  experimentally  we found that
the system reasonably converges to optimal in the interval
of              

   result
we used intel xeon e     processor with geforce gtx
     due to lack of public dataset  we created our own
dataset consisting of up to   cars and various background 
this will be publicly available  in general  the detection was
reasonable except when there is too much occlusion for detection of camera height was too high  there is no right dpm
template to match   for the bad case  figure    we usually
had very bad segmentations  i e  segmentation mask   and
  are not capturing the car correctly and it thus affect the
pose estimation 
however  even when the mask was not correct  figure  
   non intersection constraint make the cars to find the right
pose  the information about where the occlusion happens
thus help the system to find the right pose 

figure    effect of non intersection constraint  though the
initialization was bad it correctly finds the right pose   a 
detection  b  initialization  c  during iteration  d  after convergence  e f g  segmentation of object      
however  the optimization is too high dimensional    
r o    diml    and we resort to alternating optimization
scheme for faster computation      

   conclusion

while convergence  
for   o in o  
x
min
log  o  x  pfo  x         o  x   pbo  x  


s t 

in general  our proposed optimization helps effectively
estimate the pose and model variation robust to occlusion 
but for objective comparison  we need a metric to evaluate the performance of the pose  to do so  we are building
ground truth segmentation for evaluation metric 
also  the system does not incorporates any of the image
features except the binary segmentation mask  we will improve the system by making use of other features runtime 
additionally  we will incorporate supporting plane assumption that would improve the system significantly 
finally we will add computation time for future performance comparison 

x

 o   

x

 o   

o o  o 

 
 
it is the stochastic version of the previous optimization  but
still the optimization constraints are too high dimensional
 there are total h  w constrains  corresponding to the number of pixels   also  this strict constraints makes occlusion
impossible  we loose the bound by projecting other objects
into the image masks 

references
    d  g  lowe  three dimensional object recognition
from single two dimensional images  artificial intelligence      

while convergence  
for   o in o  
for  o in o  o   
pbo  x    o   

    p  felzenszwalb  d  mcallester  d  ramanan  a discriminatively trained  multiscale  deformable part
model ieee conference on computer vision and
pattern recognition  cvpr       

pfo  x       o   

 
 

fifigure    bad initialization but non intersection constraints
push objects apart  a  detection  b  segmentation using
grab cut of object    c  object    d  initialization  e  before convergence  f  after convergence
monocular  d segmentation   d pose recovery and
 d reconstruction  accv     
    victor a  prisacariu  ian d  reid  pwp d  realtime segmentation and tracking of  d objects
ijcv     

figure    bad segmentation result in wrong pose  a  detection  b  initialization  c  before convergence  d  after
convergence  e f g  segmentation using grab cut of object
     

    m  zeeshan zia  michael stark  bernt schiele  and
konrad schindler  detailed  d representations for
object recognition and modeling  pami     
    p  arbelaez  m  maire  c  fowlkes and j  malik  
contour detection and hierarchical image segmentation ieee tpami     
    neil d  lawrence  probabilistic non linear principal component analysis with gaussian process latent variables jmlr     
     rother  c   kolmogorov  v   blake  a   rother  c  
kolmogorov  v     blake  a  grabcut  interactive
foreground extraction using iterated graph cuts acm
transactions on graphics     

figure    bad segmentation but non intersection constraint
help recover the correct pose  a  detection  b  segmentation
using grab cut of object    c  object    d  initialization  e 
before convergence  f  after convergence

     sandhu  r   dambreville  s   yezzi  a     tannenbaum  a  a nonrigid kernel based framework for
 d  d pose estimation and  d image segmentation
pami     
     boyd  s   parikh  n   chu  e   peleato  b     eckstein 
j  distributed optimization and statistical learning
via the alternating direction method of multipliers 
foundations and trends in machine learning      

    b  pepik  m  stark  p  gehler and b  schiele  teaching  d geometry to deformable part models  cvpr
    
    a  dame  v  a  prisacariu  c  y  ren and i  d  reid 
dense reconstruction using  d object shape priors  cvpr      
    v  a  prisacariu  a  v  segal  i  reid  simultaneous
 

fi