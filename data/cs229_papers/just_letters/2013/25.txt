use of texture classification to quantify stem cell
differentiation during time lapse imaging

sunil pai  nathan loewke  thomas m  baer
department of applied physics

 

introduction

one of the major roadblocks in understanding the efficacy of stem cell therapy is the prediction of
stem cell performance during treatment or quality assurance of stem cell therapy  there have been
some documented cases  notably one a few years ago in europe  of stem cell treatments that have
led to tumors  which are caused by stem cells that do not develop properly during treatment  our lab
is focusing on introducing novel imaging approaches to improve our current understanding of stem
cell behavior  in one approach  we are tracking stem cells and analyzing stem cell morphologies
to understand how cells socially interact  in another approach  and as this paper addresses  we are
trying to classify cells as they mature from the stem cell stage to mature cell stage based on their
morphology and texture  together  these two approaches will give us a better picture of not only
how stem cells differentiate as a function of time and morphology  but also how we can bring more
practical software solutions into the stem cell clinic 
in our experiments  we human embryonic stem cells onto a plastic dish for imaging over a period
of about a week using a nikon biostation  this microscope gives relatively high resolution phase
contrast images of cell proliferation  the goal of the experiments is to monitor stem cell growth and
migration patterns over several days as they begin to differentiate or mature into various different
cell types 
this allows us to arrive at several different revelations about stem cell behavior  we can quantify
how much of the cell plates area changes from embryonic stem cells to mature  fully developed
cells  we can also monitor cell death rates  as it turns out  dead cells have a unique texture as well 
as well as cell division rates  again  there is a distinct shape cells make when they divide which can
be correlated to a texture   both of which can inform us of a stem cell colonys propensity to be
useful for treatment  all of these events and cell types have distinct textures that can be identified by
texture classification techniques on phase contrast images  whereas phase contrast image analysis
is one of the most difficult tasks in biological computation studies today  this project presents a
straightforward analysis of stem cell images that may have the potential to tackle the one of the most
pressing challenges in stem cell therapy 

 

texture feature extraction from images

   
     

haralick features
gray level cooccurrence matrix

one common texture classification technique is haralick feature extraction  which uses gray level
co occurrence matrices  or glcms   which give an indication of how uniform or nonuniform a
given texture is  while gray level co occurrence matrices are rotation invariant  statistical analysis performed on these gclms  developed by haralick  provide useful information about how
grayscale values in the image matrix vary in a rotation invariant manner  this is done by calculating
the glcm over the four possible orientations for the four pixel neighbor orientations 
 

fi     

haralick statistics

the idea of haralick texture classification is that these statistics give a general idea of the pattern
of neighboring pixels  since glcms give information about the relations of neighboring pixels
to each other  they are a very good measure of the variational patterns of image pixel values in an
image  there are several different statistics that are used on each glcm to formalize these so called
patterns  features calculated include entropy  correlation  variance  contrast  mean  among others
over the   dimensional probability density given by the glcms  given by normalizing the matrix
elements by the size of the image   to reduce dimensionality and induce rotation invariance  these
quantities were averaged over the four possible glcms for the typical moore neighborhood pixel
representation 
   

gabor features

the gabor wavelets are constructed using the gabor filter method  which is a bandpass filter applied
to the image at different orientations and scales  similar to a mechanism used by the human visual
system  i used the starter code from the author of       and use of these features was inspired by a
patent on phase contrast texture classification     
     

radial component

the first step in calculating the gabor features is to use a low pass filter in order to ensure that
the normalization of the gabor filters can be performed  since low pass filters use the fuction
sincx   sins x   multiplying this to the gabor filters will allow the values of the gabor filters to fall
off at the corners of the image as required  then  i apply the gabor filter given by the following
gaussian radial formula evaluated at the scale s and yielding a matrix the same size as the training
example  


 log rs   
gs   exp 
f
 
 r

   

note that the part of the gabor filter here that depends on the scale s is the wavelength which exponentially depends on s as  s     ms    where   and m are pre defined parameters  additionally 
 
r is the radius matrix  discretized based on pixel distances from the center of the image  and r
is
just the variance parameter  finally  a low pass filter f is multiplied to this matrix to get the final
log gabor filter 
     

angular component

the angular component also requires the calculation of a matrix   which accounts for the orientations of all of the pixels in the image relative to the center  then  based on an orientation  another
gaussian wave packed is calculated as follows 
 o

     

fi
fi
fi
sin  cos o  cos  sin o fifi
fi
  fiarctan
sin  sin o   cos  cos o fi
 
 
o 
go   exp   
 

   
   

final construction of gabor features

the final construction of the gabor features is given by the mean energy and the mean amplitude at
all of the various scales and orientatinos s and o  we construct this by convolving the image matrix
i with the inverse fourier transform of the filter  aso   i  f    gs go    from this  take the
absolute value of all of the elements of aso   which i use to find the energy and the mean amplitude
for an n  n image 
n
x
 
eso  
 aso
   
ij  
i j

 

fifigure    gabor wavelet  aso   banks for indices s                and o                  giving a   
  bank  left  stem cell colony gabor filter bank   right  mature cell gabor filter bank  notice the
effect of orientation on white streaks and the relationship between scale and texture of the images

m aso  

n
  x so
 aij  
n  i j

   

since we are calculating features from   different orientations and   different scales  these values are
just stacked into a single column vector to give a total of    values     for the energy and another   
for the mean amplitude  see figure   for a picture of gabor wavelet bands created from this method 
feature selection
since we have    features     features from gabor wavelets and    features from haralick statistics  
it is important to avoid using features that actually confound the data  resulting in possibly more
misclassifications   so we decided to use a feature selection algorithm to help accomplish this  we
chose the genetic algorithm  implemented using matlabs optimization toolbox  to act as an
unsupervised heuristic search over the space of possible feature combinations  the population used
was a random population  but we found that the genetic algorithm usually converged at a set of
around half of the total features  with an improvement in cross validation of about     less than
what we were expecting  but it certainly helps with intuition to know which set of features provide
the best separation   see figure   for results  these bit vector values can be stored and used to select

figure     left  genetic algorithm learning curve on cross validations for linear kernel svm with
different feature sets   right  optimal bit vector selection for the feature set  where the first   
features are haralick features and the final    features are gabor wavelet features 
features from the training set with which to use in the svm model  the conclusion we can make
from the feature selection is that most of the haralick features do a fairly good job of separating
the data and the mean amplitudes and mean energies are better predictors at small and large scales
 values of s  respectively  subsequently  we achieve our final classification accuracies described in
the following section 
 

fi 

comparison of machine learning models in texture classification

setting up the classification
our ultimate goal is to classify our image into textures for stem cell colonies  mature cells  background  mitotic cells  and dead cells  the method we chose to do this was to develop a training gui
in matlab  one that any biologist can use  to classify regions of the image  from these regions 
we pick    by    pixel windows which are each about the size of an average cell  and calculate
features for each window  this feature calculation was demonstrated pictorially in figure    for our
tests  we interpolate through fixed pixel intervals  in this case     pixels up and down  and look at
the    by    window around each interpolated pixel to perform the classification for that region of
the image  note that the comparison shown in figure   only provides a rough estimate of the testing
accuracy because at present  we have not yet stained cells to determine whether a cell is mature or is
a stem cell  we do know  however  that the cells shown in green in figure   are indeed more mature 
or differentiated  than the stem cells because they form a different colony structure than the stem
cells do  but we are currently developing a method for experimentally supporting this 

figure     left  original   center  lda and haralick    classes  background  flat differentiating
cell  colony stem cell    right  svm and haralick gabor energies   classes  background 
flat differentiating cell  colony stem cell  dividing cell dead cell 

comparing c svm and lda performance
to get a sense for how well our training data is separated in the space of only   features  we decided to use linear discriminant analysis  lda   and chose the an optimal feature class within the
haralick feature space  notice that there is still some noise using just the lda algorithm to perform classification in the test image in figure    but in figure    one can already see that a simple
application of lda should provide quite nice separation of the data  we used our genetic algorithm
feature selection to choose the best feature class for the one versus one multi class support vector
machine classifier  svm   we subsequently ran our algorithm on several different kernels and the
linear kernel provided the best cross validation accuracy and the best testing accuracy  significantly
less noise prone performance than lda with three features   these comparative results are shown
in figure    note the dependence of features   and   in the graph  it is certainly not linear  and we
suspect that this relation holds for other features in the data set  a reason we opted not to use pca to
describe our feature space in the end  we also suspect that the linear kernel works the best for svm
because it provides the least variance  a  rd degree polynomial  for example  would overfit the data
resulting in poor classification  and relatively little bias since we have such good separation from
our features anyway 

 

event curves

we extended our one versus one svm model  which we picked due to having the least noise and
high cross validation accuracy  to around     images  similar to that shown in figure    of embryonic stem cells slowly differentiating into mature cell lines  we generated a movie of these textures 
which we had put on display at the poster session  to determine some practical uses for our classifier 
an event curve is a concept we hypothesize could be used as a time series predictor for stem cell
 

fitherapy efficacy  the curves are the percentage of the field of view occupied by a certain classification as a function of time  we show a preliminary event curve for the simple   class classification in
figure    the interpretation of this plot is that stem cell prevalence continues to grow and eventually
dominates the field of view  while the mature cell prevalence tends to peak at some point  we are
currently working on optimizing our more advanced   class svm model  after which we will plot a
similar event curve with mitosis events and cell death events  we hope that these event curves can
describe quantitatively the growth of stem cells and mature cells in vitro and can be used as a tool
for identifying useful cells for therapy 

figure     left  lda on space of two features   center  comparison of testing accuracy between
lda and svm and comparison of cross validation testing accuracy between different svm kernels 
showing that the linear kernel gives best model  right  event curve set for   class svm model

 

conclusion

texture classification is quite effective in classifying embryonic stem cells and mature human cells 
giving a cross validation accuracy of close to      and showing promising time lapse results  this
high accuracy allows us to describe a novel concept called an event curve which describes the frequency of a particular event in a given time lapse movie within a field of view as a function of time 
by using only phase contrast images  we do not need explicit fluorescent screening or cell sorting 
which may interfere significantly with cell function  rather we could in the future use time lapse
movies to make key decisions about whether a colony is fit for therapy or not  saving significant
effort and time  this is a novel idea which may have major implications in future stem cell therapy
approaches 
our group plans to expand on the notion of a biological event curve and derive a very basic quantitative measure for therapeutic potential of a given colony based solely on phase contrast image
texture analysis  we will continue to explore this problem by correlating our event curves with cell
fluorescence data  this is an extremely powerful idea which  if proven to be a quality assurance
measure  can be taken directly to the clinic  we are very excited about the prospect of continuing
this vein of research  id like to acknowledge my colleague nathan loewke  who works in the ee
department for writing the lda code on haralick features and helping me write the matlab gui 

 

references

    peter kovesi  symmetry and asymmetry from local phase tenth australian joint conference on artificial intelligence        december       http   www cs uwa edu au pub robvis papers pk ai   ps gz 
    peter kovesi  image features from phase congruency  videre  a journal of computer vision research 
mit press  volume    number    summer      http   mitpress mit edu e journals videre     v   html
    sammak et al  image based methods for measuring global nuclear patterns as epigenetic markers of cell
differentiation  the charles stark draper laboratory  inc  mar          

 

fi