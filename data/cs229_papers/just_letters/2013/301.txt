hong kong stock index forecasting
tong fu
tfu  stanford edu

shuo chen
cslcb stanford edu

abstract  prediction of the movement of stock
market is a long time attractive topic to
researchers from different fields  the hang seng
index  abbreviated  hsi  is a free float adjusted
market capitalization weighted stock market
index in hong kong  we believe the hsi is
influenced by other major financial indexes
across the world and try different machine
learning method to get a prediction based on the
history data  the higher accuracy rate we can get 
the more confidence we will develop a profitable
trading strategy  after several trials of
optimization in features and models  we get a
       accuracy rate of the future market trend
of hsi 

   introduction

chuanqi wei
chuanqi stanford edu

will move on to optimize our model  in section   we
fixed the svm model and try different kernels and
parameters for svm improvement  in section   we
use feature selection to reduce variance of our test
result  section   will present the results and analysis
of the whole models 

   data processing
we believe that the performance of other major
indexes will have an impact on hsi since the global
market is closely connected  we also want to
consider major currency rates and commodity price
as our potential features  all the features we selected
are listed in the appendix 

the hang seng index  abbreviated  hsi  is a free
float adjusted market capitalization weighted stock
market index in hong kong  it is used to record and
monitor daily changes of the largest companies of
the hong kong stock market and is the main
indicator of the overall market performance in hong
kong  these    constituent companies represent
about     of capitalization of the hong kong stock
exchange  as hk is one of the financial centers
across the world  the hsi is considered as one of the
most important global financial indicator 

we then give an initial correlation analysis based on
some of the most significant features 

in this project  we plan to find some driven factors
behind the market movement that can affect hk
market and then use the machine learning methods
we learned in class for future market trend prediction 
if our learning methods lead to a fairly accurate
estimate of the next days index trend based on the
information we have today  we can develop
profitable trading strategies based on our predictions 

we collected the data of          to            
what we really want is not the absolute value of
those variables so we calculate the percentage
change of the data as our predictors  we then match
our predictors with our response which is the hsi
index  what we should be careful here is when we
predict the hsi of certain day  all the information we
know is up to the day before  so we will match our
response with the previous trading days predictors 
this is very important since we later try regression
based on the same days information and the result
will be totally changed 

our report is organized as follows  section   will be
data collection and data processing  section   will be
our basic machine learning models based on our data
and an initial prediction of the market trend  the
initial prediction result is not so satisfactory so we

   
    
   
    
 
     
    
     

figure    major feature correlation analysis

fianother consideration is the holidays within
different markets  since our predictors cover
different financial products in different regions  data
will be missing within different time periods  we
will delete the dates when any of the predictors or
response is missing 
finally  we will change the percentage change in hsi
into        for the market trend and we successfully
finished our data processing for the classification
problem 

   methodologies
     model selection
we employed supervised learning models learned in
class  including logistic regression  gda  svm
and nave bayes in forecasting hsi 
to test model performance  we conducted cross
validation and randomly divided the given data into
    for training and     for testing 
initially  we trained these four basic models with all
features collected and then verified their accuracy
using testing dataset  in order to draw a preliminary
conclusion on how well each type of model work in
predicting hsi trend  cross validation is
implemented here and the following table shows test
results of the four models 
model
accuracy

logistic
      

gda
      

nb
      

svm
      

the reason why nave bayes classifier failed to
perform well here is most possibly that nave bayes
assumption does not hold in this case  where y
 direction of hsi  is correlated with features but not
conditionally independent 
next  we focused on improving logistic  gda and
svm models by feature and parameter selections 

     svm improvements
svm has shown its relatively good performance in
predicting hsi compared to the other three basic
models  and the following four steps are gone
through to improve svm classifier 

       data scaling
scaling data before applying svm models is
significant in avoiding the scenario that features with
larger numeric range in value dominate those with
small numeric range  additionally  this helps to
reduce computation workload 
in our project  we scalded feature values linearly into
a range of          after being implemented into basic
svm model  with linear kernel   its accuracy rate
has increased by        as shown in the table below 
mode
accuracy

before scaling
      

after scaling
      

table    accuracy rate before and after data scaling for svm
 linear 

       kernel selection
table    accuracy rate for   basic models after initial
training and testing

from the table above  we can conclude that logistic
regression  gda and svm performed significantly
better than nave bayes model  whose accuracy rate
is as low as         considering that in theory 
random guess will lead to an accuracy rate close to
     nb model does not make too much sense here
due to low accuracy  therefore  we selected the other
three basic models to further improve prediction
accuracy but dropped nave bayes 

we have tried three different kernels in svm  they
are linear kernel  polynomial kernel and gaussian
kernel  rbf  radical basis function  respectively 
the accuracy results of svm using the three kernels
 after scaling  are shown in the table below 
kernel
accuracy

linear
      

rbf
      

table    accuracy rate of different kernels

polynomial
      

firbf kernel achieved the highest accuracy in
predicting  this can be attributed to rbf kernels
function to map samples non linearly into a higher
dimensional space and that it has fewer hyperparameters than polynomial kernel which has an
impact on the complexity of model selection 

       feature selection
we used backward search to select features for
different models  the reason of choosing backward
search as a feature selection algorithm and
procedures of implementation are described in detail
in      feature selection section 
mode
accuracy

before
      

after
      

table    accuracy rate before and after feature selection

as we can see  the accuracy rate increased after
feature selection 

       parameter selection
two parameters in rbf kernel needs to be optimized 
namely c and   later on  we employed parameter
search to determine the values  with the objective to
find a pair of c and  which works to achieve higher
accuracy rate 
we used cross validation here by dividing the
training set into n subsets of equal size  and
sequentially  one subset was tested using the
classifier trained on the rest of n   subsets  gridsearch method was used on c and  by crossvalidation  and the pair which produced the best
cross validation accuracy is selected  eventually  we
set c      and              
after parameter selection  our prediction accuracy
rate has been improved further as shown in the table
below 
mode
accuracy

before
      

after
      

table    accuracy rate before and after parameter selection

     feature selection
in the previous section  the set of    features that we
assume could affect the hsi movement was used to
train supervised models  we suspected that the
number of features is so large that some features
might provide overlapping information  under this
situation  some features are redundant given the
other features in the selected feature set  to deal with
the potential over fitting  a feature selection
algorithm is necessary in reducing data complexity
and improving prediction accuracy 
in general  feature selection algorithms designed
with different evaluation standard fall into two
categories  the filter methods and the wrapper
methods  while filter methods acquires no feedback
from classifier  the wrapper methods are classifierdependent  which works for the prediction of hsi
movement  an appropriate wrapper method can be
used to evaluate the goodness of the selected
feature subset directly and yield better performance 
meanwhile  the high computational complexity of
wrapper methods can be balanced by sample size 
which further substantiates the use of wrapper
methods in feature selection 
as it is impossible to train model for all possible
feature subsets  we require feature selection
algorithms to proceed greedily  forward selection
method and backward selection method can be
regarded as a possible algorithm to select feature
subset yielding best accuracy rate  however  the hsi
movement cant be driven by a single factor itself  it
is difficult for forward to select a set of features that
can work with other features to give the prediction of
the direction of hsi movement  the first step of
forward search seems to be random because none of
features listed above is a good predictor by itself 
therefore  we implement backward search algorithm
in the part of feature selection to reduce over fitting
problem  during the selection  we calculate the
estimated accuracy rate of the learning algorithm for
each set of features by computing the generalization
error using hold out cross validation  in this way  we

fican train learning models with a set of selected
features and the corresponding accuracy rate is
summarized in the table below 
model
before
after
model
before
after

logistic
      
      
svm linear 
      
      

gda
      
      
svm rbf 
      
      

nb
      
      
svm poly 
      
      

table    accuracy rate before and after feature selection
 compute without implementing parameter selection for svm  

logistic
ftse

svmlinear
s p

svmrbf
s p

svmpoly
s p

nb

gda

s p

djia

sse

ftse

nikkei nikkei ftse

ftse

sti

cny  

ftse

ftse

cny  

sse

nasd

euro  

sse

sse

sti

cny  

jpy  

jpy  

gold

nasd

gold

gold

gold

table    features selected for different models

   results and analysis
      
      
      
      
      
      
      
     

before feature selection

after feature selection

figure    accuracy rate before and after feature selection

at the beginning  the initial correlation analysis
indicates the hidden interconnection between the

hang seng index and global markets indices that
close right before the hong kong trading time  to
unmask this hidden relationship  we proposed several
machine learning based models for predicting daily
trend of hang seng index  each of the forecasting
models described in the section   was estimated and
improved through feature selection  specifically  the
actual model performance was evaluated by holdout
cross validation  we were trying to test whether
specific machine learning model trained on market
data can be applied to make predictions about future
market trends  at this stage  the relative performance
of the models was measured by empirical error rate
when predicting the direction of hsi movement on
the hold out cross validation set 
the performances of four types of supervised
learning models are shown in the figure above  each
model is able to give a prediction rate higher than
     which is better than random  those raining
models can absorb the relevant information of other
financial markets on the previous trading day in
order to predict the trend of hsi movement  among
all learning models  according to the result table 
svm with gaussian kernel gives the best
performance in predicting index movement  whose
accuracy rate is         after further improvement
by backward search algorithm and parameter
selection  the rate of accuracy goes up to        
besides high accuracy rate  svm is the most
efficient tool in countering the over fitting problem 
the features we included in learning at first are highdimensional  which brings over fitting problems to
these learning models  comparing the prediction rate
with and without the feature selection  we can figure
out that certain feature selection algorithm plays a
more significant role in reducing the over fitting
problem in svm than in other classification models 
therefore  svm has proven to a possible solution in
prevent over fitting problems given limited training
dataset 

   conclusion and furtherwork
predicting stock market movements has always been
a challenging task considering the trends being

fiaffected by various random factors such as volatility
or other macroeconomics factors  however  the
interaction among all financial indices allows us to
capture those changes in order to make profit in
stock trading  in this project  we investigated the use
of several machine learning models to predict hsi
movement direction  even if the learning models we
used in this project are just simple derivation of
supervised learning we learned in the class  they
were able to meet our expectation of achieving
modest accuracy rates and capturing the relevant
features for each training model  although logistic
regression generates a decent prediction result  of
which the accuracy rate is over      svm is
considered to be a promising type of tool for hsi
movement forecasting  this is quite reasonable
considering the way we select features for
forecasting models  the initial screening of features
is based on macroeconomic analysis  it is evitable
that over fitting problem will arise because of the
high dimensionality of features  as demonstrated in
both empirical analysis and actual training results 
svm has been shown to be very resistant to the
over fitting problem  eventually reaching a high
generalization
performance
and
improving
profitability and the stability of predictions  the
result after feature selection further confirms that
svm is superior to the other individual classification
methods in forecasting daily movement direction of
hang seng index  because it performs best among all
the forecasting models  this can be interpreted as an
indication for financial analysts and traders  which
can bring a certain level of capital gain 
however  each method has its own strengths and
weaknesses  also  there are several aspects of our
research that need to be improved in the future  for
example  we assume different features can provide
relevant information for hsi movement forecasting
over different periods of time  including several time
series features can greatly help to detect the
underlying relationship between hsi movement and
the distribution of financial time series  after all  our
experience in this project has shown the great
potential that machine learning has in the field of
financial forecasting  we believe exploration in

improving performance via better feature selection
algorithms as well as optimizations can generate a
more convincing prediction result 

   references
    y s  abu mostafa and a f  atiya introduction
to financial forecasting  applied intelligence   
        pp          
    r  choudhry
learning system
proceedings of
engineering and
     

and k  garg   a hybrid machine
for stock market forecasting  
world academy of science 
technology  vol     pp          

    w  huang  y  nakamori and s  wang
forecasting stock market movement direction with
support vector machine  computers   operations
research      pp                    

fiappendix
   feature table
feature

category

explanation

s p    

stock index

djia
nikkei

stock index
stock index

ftse

stock index

sse

stock index

crude oil
cnyusd
jpyusd
eurousd
audusd
sti

commodity
currency rate
currency rate
currency rate
currency rate
stock index

nasdaq

stock index

gold price

commodity

standard   poor s      a stock market index based
on the market capitalizations of     large companies
having common stock listed on the nyse or
nasdaq
dow jones industrial average
nikkei stock average  a stock market index for the
tokyo stock exchange
ftse      a share index of the     companies listed
on the london stock exchange with the highest
market capitalization
sse composite index  a stock market index of all
stocks  a shares and b shares  that are traded at the
shanghai stock exchange
commodity price of crude oil
chinese renminbi us dollar exchange rate
japanese yen us dollar exchange rate
euro us dollar exchange rate
australian dollar us dollar exchange rate
straits times index  it tracks the performance of the
top    companies listed on the singapore exchange
a stock market index of the common stocks and
similar securities  e g  adrs  tracking stocks  limited
partnership interests  listed on the nasdaq stock
market
commodity price of gold

fi