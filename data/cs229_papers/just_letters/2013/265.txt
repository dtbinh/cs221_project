machine learning in stock price trend forecasting
yuqing dai  yuning zhang
yuqingd stanford edu  zyn stanford edu

i 

introduction

predicting the stock price trend by interpreting the seemly chaotic market data has
always been an attractive topic to both investors and researchers  among those popular
methods that have been employed  machine learning techniques are very popular due to
the capacity of identifying stock trend from massive amounts of data that capture the
underlying stock price dynamics  in this project  we applied supervised learning methods
to stock price trend forecasting 
according to market efficiency theory  us stock market is semi strong efficient
market  which means all public information is calculated into a stock s current share price 
meaning that neither fundamental nor technical analysis can be used to achieve superior
gains in a short term  a day or a week   indeed  our initial next day predication has very
low accuracy around      however  as we tried to predict long term stock price trend 
our models achieved a high accuracy        based on our prediction result  we built a
trading strategy on the stock  which significantly outran the stock performance itself 

ii 

implemetation
a  data collection

the training data used in our project were collected from bloomberg database  in
this project  we picked  m stock to apply our method  the data contains daily stock
information ranging from          to                 data points   there are   
features that we can use to apply our learning theory  in addition  we used the daily
labeling as follows  label     if the closing price is higher than that of the previous day 
otherwise label       for example  if the closing price of stock a on            is
higher than that on             and on             the pe ratio  px volume  px
ebitda     s p     index are x   x      x    so the training data of a on            is  x 
y   where x    x   x      x   t  y       

stock

 m co  nyse  mmm 

features

pe ratio  px volume  px ebitda  current enterprise value    day

finet price change     day volatility     day moving average     day
moving average  quick ratio  alpha overridable  alpha for beta pm 
beta raw overridable  risk premium  is eps  and corresponding
s p     index
data
source

bloomberg data terminal

b  model selection
   next day model
in our project  we mainly applied supervised learning theories  i e  logistic
regression  gaussian discriminant analysis  quadratic discriminant analysis  and svm 
the most important result that we should watch closely is the accuracy of prediction 
which we define as follows 

           
 
    
we used     of the data sets as training data and tested our fitted models with the
remaining     data sets 
model

logistic
regression

gda

qda

svm

accuracy

     

     

     

     

it turned out that the next day prediction has a very low accuracy with the highest
accuracy  qda  being only        we know that by flipping a coin we can probably get
an accuracy of roughly     since the investing decision is binomial  such result can be
explained by the semi strong efficient market theory  which states that all public
information is calculated into a stock s current share price  meaning that neither
fundamental nor technical analysis can be used to achieve superior gains 
   long term model
although our next day prediction isnt very positive  we believe the financial data of
a particular stock can still provide some insights for the stocks future movement  after
all  that why so many financial institutions individual investors believe their work is
meaningful 
especially  we think sometimes because of the existence of market sentiment  some
information will not be reflected in the stock price immediately  besides  in the eyes of
investors  we also care about the predictions results of longer term to design our
long term investment strategy 

fihere  we define our problem as predicting the sign of difference between
tomorrows stock price and that of certain days ago  again  we used     of the data set
as training data and tested our fitted models with the remaining     data sets 

long term  pedic on  accuracy  
     
     

acuuracy  

     
     

accu gda  

     

accu logis cs  reg   
accu svm  

     

accu qda  

     
     
   

    

    

    

    

    

    

time  window   days   

from the chart  we can see that for svm and qda model  the accuracy increases
when the time window increases  furthermore  svm gives the highest accuracy when the
time window is    days          its also the most stable model 
c  feature selection

feature  selec on  
        

accuracy  

        
        
        
        
        
        
   

   

   

   

   

    

    

    

    

number  of  features  

from the chart established by backward stepwise feature selection  we can see that
when we used all of the    features  we get our highest prediction accuracy  it makes
sense because with over      data points but only    features  theres no need to reduce

fithe number of features 

iii 

trading strategy
a  predictor characteristics

from the previous analysis  we have already determined that the best predicting
model for  m stock is svm model  here we use svm as our predictor in order to
develop our trading strategy 

predictor

svm

kernel

polynomial

number of features

  

time window

   days

b  strategy implementation
initially  we used     of our      data points to fit our model  then we used our
model to predict the stock price and made according investment decision on an on time
basis  meaning we will take in new information and update our predictor every trading
date  our back testing of the strategy is over the course of december      to october
     
on each day of the beginning    days  we will make a decision whether to buy the
stock or not based on our prediction of whether the stock price would go up after   
days  after the first    days  on each day we will make an investment decision again  its
better illustrated in the following decision tree 
buy  if  not  
holding  it  
increase  
hold  if  already  
holding  it  
predic on  
do  nothing  if  
not  holding  it  
decrease  
sell    if  already  
holding  it  

equivalently  we can interpret the strategy as if there are    traders  trader i is
responsible for trading his portfolio on i     i     n   i day  traders are
independent to each other 

fiprice  level  

p l  comparison  
     
     
     
     
     
    
    
    
    
         

 m  stock  performance  
our  strategy  
        

         

        

dates  

from the plot above  its obvious that our strategy has outrun the performance of
the stock  with an annualized return       vs        

iv 

conclusion

in this project  we applied supervised learning techniques in predicting the stock
price trend of a single stock  our finds can be summarized into three aspects 
   various supervised learning models have been used for the prediction and we
found that svm model can provide the highest predicting accuracy        as
we predict the stock price trend in a long term basis     days  
   our feature selection analysis indicates that when use all of the    features  we
will get the highest accuracy  thats because the number of data points is much
bigger than that of the features 
   the trading strategy based on our prediction achieves very positive results by
significantly outrunning the stock performance 
as for our future work  we believe we can make the following improvements 
   test our predictor on different stocks to see its robustness  try to develop a
more general predictor for the stock market 
   construct a portfolio of multiple stocks in order to diversify the risk  take
transaction cost into account when evaluating strategys effectiveness

fi