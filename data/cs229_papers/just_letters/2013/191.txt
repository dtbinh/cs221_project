imageobjectclassification
cs   finalproject
kevinwilderkmwilder stanford edu
adamkrzesinskiakrzesin stanford edu

goal 
forthisproject weattemptedtodotheilsvrc    classificationcompetition    dataset  task  we
aregiven    categoriesworthoftrainingimages upto    imagespercategory  and     validationimages 
foreachvalidationimage wearemeanttoproduce labels oneofwhichmustmatchoneoftheimagesgiven
labelsinordertonotbeconsideredanerror asweareshortoncomputingresources weusedasubsetofthisdata
trainingononly   categories andvalidatingonlyonimagesthatincludedoneoftheseincludedcategories 

implementation preprocessingthedata 
asourfirstchallenge wewerepresentedwithasetofimagesofdifferentsizes hues lightingconditions et
cetera thealgorithmswewereabouttousecannottoleratesuchvariancemostofthemexpectastandard
normalizedfeatureinput 
asafirststabatnormalizingourdata weconvertedeachcolorimagetograyscale initiallygrayscale
imageswereunchanged thiswouldhopefullyminimizetheeffectoflightingconditions orcolorvsblackandwhite
originals onourdownstreamclassifiers aswellassimplifytheprocessingwedhavetodo forexamplewedonly
havetofindcentroidsonsinglecolorvalues ratherthanathreedimensionalrgbmatrix 
afterthis wefeltthenextthingtostandardizewouldbetheimagesize inpixels weprofiledthetraining
andvalidationimagesets findinganaverageimagesizetobe    x   pixels withthesmallestimagesbeingas
littleas  x   andthehighesthavingoverathousandpixelsineachdimension eyeballingafewrescaledimages 
wefoundthatresizingeachimagetotheaverageimagesize roundedtothenearestpatch dimmultiple
discussedbelow wasareasonablecompromiseforstandardization 
whilewewerewillingtothrowawaysomedatatoresizeanimage wewantedtopreservetheoriginals
aspectratioasawarpedobjectshouldntberecognizableastheoriginalobject sincenotallimagesfitnicely
withinouraveragesize weoftenhadtopadournormalizedimageinthexorydimensiontofitourspec wefilled
thosepaddingpixelswithinformationrepeatedfromtheoriginalimagetheassumptionbeing pixelsnearthe
edgeareunlikelytobeourtargetobject buttheenvironment whichwouldbereasonabletobearepeatingpattern 
finally nowthatwevestandardizedourimagesizeandcolor wewantedtoprepareitforourdownstream
processes weslicedeachimageintopatch dim patch dimpixelpatches andpassedaonedimensional
arrayofthese dpatchesontoournextstage 

implementation kmeans 
inspiredbyapreviouslyencounteredimagerecognitionproject      weintendedtorunkmeansonour
collectionofpatchesasasortofedgedetectortofindn clusterscommonpatterns wewouldthentransform
ourimagesfromavectorofpatches toavectorofdistancesbetweenourpatchesandourdiscoveredclustersso 
ratherthanlearningonafeaturesetofn patch dim patch dimvalues wevereducedton n clusters
realnumbers 

implementation principalcomponentanalysis 
thisstillleavesuswithalargenumberoffeaturespersample weinvestigatedusingpcatodoan
additionallayeroffeaturereduction butfoundthatapplyingitdirectlyafterkmeansclusteringdidntimproveour
results however itdidnthurtourvalidationerrorbymuch anditcamewiththebenefitofreducingthememory
footprintofourclassifieralgorithm whichwashittinglimitsonoursystemduringsomeconfigurations hence weleft
itinourpipeline withinfinitememory wewouldnotincludeit 

implementation scaler standardization  
 

fifinally toaidinconvergenceforoursvm wenormalizedthetrainingdatatohavemean  variance  for
eachfeature wekeptthistransformationaround sothatvalidationdatawouldgothroughanidentical
transformation 

implementation linearsvm 
wechosetousealinearsvmasourclassifier astheyperformverywellinhighdimensionalfeature
spaces withoutpca ourtrainingdataprovedtobelinearlyseparable 

implementation puttingitalltogether 

 

fitohitourgoalonthecomputingresourcesonhand wechosetodothefollowing wewouldrunthe
kmeans pca andscalingalgorithmsonasubsetofourtrainingset toteachourmachinehowtoseeanedge 
andhowtoreduceanimagetoastandardsetoffeatures 
then foreachcategorywewouldwanttoclassify wedcreateauniquesvm trainedtogiveayesorno
foragivencategory theclassifierwouldbetrainedonamixtureofpositiveandnegativeexamples withslightly
morenegativeexamples asmorewereavailable  
ourgoalis givenanimage predictthefivemostlikelycategoriesitcouldbe welldothisbypushingthe
imagethroughthesamepreprocessing featureextractionprocessasourtrainingdata then foreachofour
classifiers wedgetnotonlytheprediction butalsotheimagesdistancefromthesupportvector ourproposalis
thatthefurtherabovethesupportvectoranimageis themorelikelyitisthattheimageiswhatwereclassifying 

tweakingparameters 
oncewehadtheinitialpipelinefunctioning thenextstepwastoadjusttheparameterstomaximizeaccuracy 
beforedoinglargescaletesting ourgoalwastotweaktheparameterstoachievethehighestpossible
singlecategoryvalidationaccuracy ourpipelineallowedustoadjustthefollowingparameters patchdimensions 
numberofkmeanscentroids numberoftrainingimages andnumberofnegativetrainingexamples 
thefollowingchartshowsthetrainingaccuracyasafunctionofthenumberofcentroidsforpatchdimensionsof  
         and   

 

fisincetheredidnotseemtobeanyreasonablerelationshipshere thenextthingwetriedwasincreasingthepatch
sizebeyond  whilekeepingthenumberofcentroidsconstant     thefollowingisagraphofthetrainingand
validationaccuracyasafunctionofpatchdimension 

aspatchdimensionincreases weseeadropoffintrainingaccuracywhilevalidationaccuracyincreasesslightly 
thevalidationaccuracydidseemtoincreasealbeitslowly butthiswaspromising 
oncewereachedanoptimalpatchsizefromtheabovechart wedecidedtotryadjustingthenumberofkmeans
centroids thefollowingchartshowstherelationshipbetweenthenumberofcentroidsandaccuracywithan
increasedpatchsize    pixels  

theaccuracypeakedaround   centroidswithamaximumaccuracyof   andtaperedoffthereafter 
fromthis webelievewefoundtheoptimalparametersforoursinglecategoryclassifier 
patchdimension    pixels
numberofcentroids    
validationaccuracy    

 

fibiasandvariance 
wheninitiallytrainingoursvm wewereachievingaveryhightrainingaccuracy thiswasinitially
encouraging butoncewestartedvalidating wenoticedthattheaccuracywaslowerthanwhatwewereexpecting 
basedonwhatwelearnedinclassaboutbiasandvariance thismeantweneededtoreducethenumberoffeatures 
todothis wereducedthenumberofpatchesbyincreasingthesizeofeachpatch thegraphaboveofaccuracy
vs patchsizeconfirmsthis aspatchsizeincreased thetrainingaccuracydecreased andthevalidationaccuracy
slowlyincreased 

results 
usingoursinglecategoryvalidationaccuracyabovetoguideus wechosetwoconfigurationstotestthefull
     imagedataset trainingonourfull    imagepercategorytrainingset 
withapatch dimof   pixels using  kmeanscentroids andwithoutusingpca ourtop 
predictionscontainedthecorrectitem   times outof     totalimages foranaccuracyrateof       for
computational memorylimitationreasonswecouldnotusetheoptimalsinglecategoryparameters  
withapatch dimof  pixels using  kmeanscentroids andpcafurtherreducingthefeaturesetto
   values ourtop predictionscontainedthecorrectitem   times foranaccuracyrateof       

conclusion 
ourfinalpipelineperformsabysmallyatimageclassification wethinkalargefactorinthisisourpoor
singlecategoryvalidationaccuracy kmeanstransformation followedbyalinearclassifier seemedtoperformwell
onsmallimageswithfewpatches itseemsthatscalinguptolargerpicturesrequiresadditionallevelsoflearning 
beyondsimpleedgedetection 
naivelytakingthedistanceaboveoursupportvectors andcomparingacrossclassifiers mayalsobe
flawed whilewedidstandardizefeaturesacrossclassifiers withsuchgreatclassifierinaccuracy thisdistance
alonelosesitsmeaning 

citations 
   ilsvc     http   www imagenet org challenges lsvrc      
   scikitlearn machinelearninginpython pedregosaetal  jmlr   pp               
   piech hannun visualcortex stanford     
   codeforthisprojectcanbefoundathttp   stanford edu  kmwilder cs    

 

fi