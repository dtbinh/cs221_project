identifying thyroid carcinoma subtypes and outcomes through gene
expression data
kun hsing yu  wei wang  chung yu wang
by leveraging gene expression data of a large
number of thyroid cancer patients from the cancer
genome atlas  tcga  research network     we aim
to     predict the stages and survival outcomes of
papillary thyroid cancer patients and identify the
most predictive genes for each classification  and    
discover patterns of gene expression which can be
signatures of unknown subtypes of papillary thyroid
carcinoma with clinical relevance 

abstract 
unlike most cancers  thyroid cancer has an everincreasing incidence rate over recent years  in order
to better understand its molecular mechanisms  we
acquired gene expression data from the cancer
genome atlas  tcga   leveraged supervised
machine learning methods to predict stages and
outcomes  and utilized unsupervised machine
learning methods to gain biomedical insights on the
gene activity patterns  results showed that support
vector machine with gaussian kernel could
distinguish patients with different survival outcomes
with     accuracy  and factor analysis identified
important biological processes in the tumor
development  with continuing effort to improve
classification accuracy  we envision personalizing
patient treatments based on their predicted disease
outcomes with larger sample size  thereby increasing
the quality of care and reducing the cost of cancer
management 

materials and methods 
data sources
we obtained gene expression and clinical data
from     patients with thyroid cancer from tcga  a
collaborative project sponsored by the national
cancer institute and the national human genome
research institute  we used the expression levels of
       genes measured by rna sequencing in the
tumor tissue as the features for classification and
clustering  the main outcome labels we examined
were patient survival groups  with survival time
longer than or shorter than       days  and tumor
stages  the distributions of these two labels are
shown in table   

introduction 
thyroid cancer is one of the few cancers with
increasing incidence rates over recent years  the
american cancer society estimated that in      
there will be about        new cases of thyroid
cancer in the u s  and about       people will die
from this disease        the rise in incidence rates
cannot be completely accounted for by improved
disease detection     understanding the genetic and
molecular basis of the disease will help us identify
its risk factors and point to possible explanations for
the trend of increasing incidence rates 
the recent availability of public gene expression
data sets has created great opportunities to study the
gene expression changes underlying the development
and progression of the disease  in addition  gene
expression data may be used to identify novel
subtypes of thyroid cancer  papillary tumor is the
most common type of thyroid cancer  which
generally grows slowly  however  there exist several
variants of thyroid cancer that tend to grow and
spread more quickly     gene expression data can
help us further refine the subtyping system  making
it more relevant to treatment response and clinical
outcomes    
  

table    stages and survival outcomes of thyroid
carcinoma patients 
stage at diagnosis
stage i
n      
stage ii
n     
stage iii
n     
stage iv
n     
survival
alive
n      
died
n     
survived         days
n     
survived        days
n     
preprocessing of feature data
we visualized the distributions of the gene
expression levels through histograms  normalized
them  and excluded genes with little or no variation
in expression levels from subsequent analyses 

   

ficlustering patients for subtype discovery using
unsupervised learning
due to the vast number of features  we used
principal component analysis  pca  to reduce
dimensions and visualize the data  and examined if
the first few principal components suggested distinct
clusters that correspond to clinically relevant
characteristics of the patients such as stages  survival
outcomes  histological types  and races 
we explored novel tumor subtypes through
hierarchical clustering  gene expression levels were
clustered based on euclidean distances  as an
external validation of the clustering  we investigated
whether or not any of the gene expression defined
clusters
correlated
with
known
clinical
characteristics 
we also employed factor analysis to explore the
latent factors that explain the heterogeneity in gene
expression among patients   

results 

significantly better than our baseline classifier  we
focused on binary class classification  with the first
class being stages i and ii and second class being
stages iii and iv 
forward feature selection 
we selected the top    most effective features 
since test errors plateaued after so  and demonstrated
that using only the top   features generally had the
best test performances  training and test error of
different classifiers are shown in figure    nave
bayes classifier with   features achieves the best
performance  with test error rate of     
figure    training and test error of binary stage
classification with top   features from forward
feature selection 
    

error  rate       

    

stage      fold  training  error  

    

stage      fold  test  error  

    
    

    
         

         

    

    

    
    

    

         

    

    

    
    
   
mr  

svm  linear  

svm  
nb  kernel   nb  normal  
gaussian  

knn  

dt  

feature selection by wilcoxon test statistics 
we also selected features that showed the largest
differences between the two outcome groups as
measured by wilcoxon test statistics  figure   shows
that the wilcoxon test statistics offered comparable
performances to forward feature selection 
figure    training and test error of binary stage
classification with top   features from wilcoxon
test statistics 
    
    

error  rate       

classifying clinical outcomes using supervised
machine learning techniques
we classified patients with naive bayes  nb   knearest neighbor  knn   support vector machine
 svm   decision tree  dt   and regularized logistic
regression  rlr   we utilized matlab built in
functions for most of the classifiers and the liblinear
package for svm  we implemented the newtons
method for rlr  we evaluated the performance of
our classification algorithms by hold out crossvalidation  cv      fold cv  and leave one out cross
validation  loocv  for classification tasks with less
than    samples   the performance of each classifier
was compared to the majority rule  mr   which
served as the baseline classifier  to optimize our
classifiers  we explored different box constraint
parameter c and kernels in svm  distribution
assumptions in nb  ks and distance measures in
knn  tree depths in dt  and lambdas in rlr 
we performed feature selection by forward
selection and wilcoxon test statistics  comparing the
features in outcome group   vs  outcome group    
we conducted gene ontology  go  analysis to
identify the enriched biological processes of the
selected genes 

stage      fold  training  error  
stage      fold  test  error  

    

    
    
    

         

    

    

    
    

    

    

         

    
         

    
    

    
    

   
i  supervised learning
mr   svm  linear  
svm  gaussian  
nb  kernel  nb  normal   knn  
dt  
rlr  
i    classifying tnm stages
we trained various classifiers to distinguish
patients with different tnm stages  stage i to iv  
test error rates didnt improve significantly when
since multiclass classifications did not perform
varying box constraint c in svm  distribution
  
   

fiassumption in nb  k in knn  or lambda in rlr 
we only showed the classifiers with the best
performances in the above figures 

i    classifying survival outcomes
we categorized the patients into two groups based
on their survival outcomes  the ones who died within
      days after diagnosis and the ones who survived
at least       days  observing that using all       
features was computationally expensive and incurred
overfitting  we applied forward feature selection
 figure    and feature selection according to
wilcoxon test statistics to select the most relevant
features  figure     among all classifiers  svm with
gaussian kernel on    features from wilcoxon test
statistics achieved the best performance  with    
test error rate 

diagnostics 
when using features selected by wilcoxon test
statistics  training error steadily decreased until
feature number reached         while test error
remained at a constant level when using       or
more features  suggesting high variance with more
than       features  figure    
figure    error rates of svm with linear kernel
with varying numbers of features 

figure    training and test error of survival
classification with top    features from forward
feature selection 
    
    

survival  loocv  training  error  

survival  loocv  test  error  
    

    

    

    

error       

    
         

    

    

    

    

    
   

    
   
   
mr  

figure    error rates of svm with varying
training sample sizes 

nb  

knn  
svm  linear   svm  gaussian  
classi iers  

    
    

    

    

survival  loocv  training  error  

survival  loocv  test  error  

    

    

    

    

    
error  rate       

    
    

svm  linear  training  error  
svm  linear  test  error  

    
    
   
   
   

    

     

     

     

     

     

     

     

    

    
         

    

    

pvrl   
ccl    
depdc   
rbm    

         

    

    

    

    

   

   

   

   
mr  

nb  

knn  

svm  linear  

svm  
classi iers   gaussian  

dt  

rlr  

diagnostics 
we investigated the optimal number of features
for our classifiers  results showed that underfitting
occurred when using less than   features in svm
with gaussian kernel  and overfitting was evident
when using more than    features  using   to   
features attained the lowest test error for svm with
gaussian kernel  our best performing classifier
 figure    

table    top genes in stage prediction selected by
wilcoxon test statistics 
st gal   
c orf    
flt   
epha    

    

   

the most informative genes in stage prediction
selected by wilcoxon test statistics are shown in
table    go analysis revealed their association with
protein kinase c  pkc  and vascular endothelial
growth factor  vegf  receptor signaling pathways 

fzd   
kif c  
tmem    
fam   b  

    

    

training  set  size  

lad   
mcf l  
cercam  
ranbp    

dt  

figure    training and test error of survival
classification with top    features from wilcoxon
test statistics   

    

error  rate       

    

    

    

the plot of error rates with increasing training size
 figure    indicates that a larger training set could
mitigate the high variance problem in our models 

  

    

    

vegfa  
slc  a   
retn  
plp   

   

fifigure    classification error rates of svm with
gaussian kernel for survival with varying numbers
of features 

figure    pca on whole genome expression
profiles   a  pca on tumor stages  b  pca on
survival outcomes 

    

 a   

survival  loocv  training  error  
    

survival  loocv  test  error  

error  rate       

    
    
    
    
   
   

   

   

   

   

    

    

    

    

    

 b   

    

number  of  features  

top features for survival prediction are shown in
table    go analysis revealed their association with
immune response and intercellular adhesion
molecules 
table    top genes in survival prediction selected
by wilcoxon test statistics 
tert
camp
mapk 

slc a 
chkb
clec m

trim  
nxf 
snora  

iqsec 
scfd 
psme 

rap gds 
flj     
tubb c

hierarchical clustering
to understand the clusters formed by hierarchical
clustering  we examined if patients with different
stages  histologic subtypes  or survival outcomes  the
three most important clinical characteristics  tend to
form distinct clusters with unique gene expression
patterns  results showed that hierarchical clustering
didnt suggest subtypes related to survival outcomes 
stages  or histologic subtypes  although clustering
was performed for the whole gene set  for illustration
purposes  we present in figure   the clustering
results of    genes most predictive of survival 

when varying box constraint c in svm from
       to     or varying lambda in rlr from      
to      test error rates didnt improve significantly 
test accuracy for knn also remained at similar
levels for different ks and when using different
distance measures such as euclidean  manhattan 
chebychev  minkowski  cosine  or correlation 
ii  unsupervised learning
pca on whole genome expression profiles
we plotted the first two principal components of
the features and examined if subjects with different
stages  figure  a  or survival outcomes  figure  b 
form separate clusters on the plots  although patients
with different stages and survival outcomes showed
significant differences in the median values of the
first two principal components  wilcoxon p values
in the range of    x     to        no distinct clusters
were formed according to these two labels  which
suggested that the greatest inter individual variation
in overall gene expression levels could not be readily
explained by the difference in tumor stages or
survival outcomes  similar results were observed for
histologic types and races  data not shown  

  

figure    hierarchical clustering by patients
 columns  and genes  rows      represents survival
time less than       days and   represents survival
more than       days 

   

fifactor analysis
factor analysis revealed three major factors that
best explained the inter individual differences in
gene expression  factor loadings of genes with the
most expression variability are shown in figure    
gene ontology  go  analysis showed significant
enrichment in rna binding in the first factor 
metabolism in the second  and extracellular matrix
structure in the third factor 

genomic information also appeared to have some
predictive value for stages  the informative genes
for stages were enriched in pkc and vegf
pathways  both of which are important pathways in
tumor progression  however  we could only
distinguish early stages thyroid cancer from the late
stages with     accuracy  which is not much higher
than the baseline accuracy  one possible explanation
is that genomic profiles might not change
significantly as tumor progresses in stages  based on
our diagnostics  more training samples are needed
for better classification performance 
we identified the major contributors of the
genomic differences among thyroid cancer patients
through factor analysis  by investigating the gene
components of the latent factors  we found rna
binding  metabolism  and extracellular matrix
structure were the themes of these factors 
interestingly  these factors are all closely related to
tumorigenesis or tumor progression     which provide
us insights on the biological processes underlying the
heterogeneity among thyroid cancer patients 
in summary  through machine learning methods 
we are able to classify patients with different
survival outcomes  identify the genes related with
prognosis  and characterize the genomic signatures
of thyroid cancer  with a larger number of samples 
we could achieve better prediction accuracy 
eventually  we hope to personalize treatment plans
based on their predicted disease outcomes  thereby
improving the quality of care and reducing the cost
of cancer management 

figure     factor loadings of genes with the most
expression variability  based on go analysis  the
three factors are related to rna binding 
metabolism  and extracellular matrix structure
respectively 

discussion
our work demonstrated that supervised machine
learning techniques could predict survival outcomes
of thyroid cancer patients with     accuracy  while
unsupervised methods such as pca and factor
analysis could help reduce dimensions  however 
clustering on the whole genome expression profiles
was not directly related to known clinical
characteristics 
our best classifiers could distinguish patients with
different survival with    to    genomic features 
we observed trends of overfitting when adding more
features  and trends of underfitting when using fewer
features  we further noticed that most of the
informative genes for survival prediction were
related to immune response and intercellular
adhesion molecules  our results were consistent with
clinical observations that poor host immunity and
extensive tumor invasion are generally poor
prognostic factors of cancers     the results suggest
that we could further develop prognostic markers of
thyroid cancer based on the expression levels of the
selected genes 
  

reference
     siegel r  naishadham d  jemal a  cancer statistics       
ca cancer j clin       jan             
   american cancer society   jan             what are the key
statistics about thyroid cancer  retrieved dec           
from http   www cancer org cancer thyroidcancer detailedgu
ide thyroid cancer key statistics
   chrisoulidou a  boudina m  tzemailas m  doumala e 
pashalia ki  patakiouta e  pazaitou panayiotou k 
histological subtype is the most important determinant of
survival in metastatic papillary thyroid cancer  thyroid
research               
   the cancer genome atlas          retrieved dec           
from http   cancergenome nih gov  
   dunn gp  bruce at  ikeda h  old lj  schreiber rd  cancer
immunoediting  from immunosurveillance to tumor escape 
nat immunol       nov             
   croce cm  oncogenes and cancer  n engl j med       jan
                 

   

fi