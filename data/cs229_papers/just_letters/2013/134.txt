predicting gas usage as a function of driving behavior
saurabh suryavanshi  manikanta kotaru

abstract

a new target variable and quantitatively demonstrate
the improvement in the prediction accuracy  in section
the driving behavior  road  and traffic conditions    we apply support vector regression  svr  to the
greatly affect the gasoline consumption of an au  data to obtain very good prediction accuracy  in sectomobile  we believe that accurate prediction of tion    we propose an application and obtain a solution
gasoline usage as a function of the above can be using reinforcement learning  rl  framework 
used to obtain optimal driving behavior  for given
road and traffic conditions  to reduce gasoline consumption  this results in great dollar savings and
also reduces the harmful effects of gasoline usage
on environment  in this project  we propose machine learning framework to predict gasoline usage as a function of driving behavior with high
accuracy  analysis of the results shows that we
are able to predict the rate of gasoline consumption  miles hour  much better than fuel economy
 miles gallon   as a function of driving behavior 
we then propose an application by constructing a
machine learning framework to minimize the total
gasoline consumption over a period of time 

 

   

data

this project is inspired from the identify       billion
in yearly gas savings from driver behavior project
floated on cs     project suggestions  the dataset
provided by metromile  inc includes high frequency
accelerometer readings  normalized with respect to g 
acceleration due to gravity   speed  in miles per hour  
heading angle  in degrees from north   and fuel economy  in miles per gallon  measurements of seventeen
different automobiles  each dataset contains varying number of data instances  varying from        to
          instances  the dataset for each automobile
consists of numerous trips of different time lengths 
the sensor measurements are taken each second for
the entire duration of each trip 

introduction

it is known that driving behavior and traffic conditions
play a significant role in the fuel consumption of automobiles      for example  traffic congestion results in
high gasoline usage due to frequent gear shifts  braking  and accelerating  also  on highways  by traveling
at different speeds  below the speed limits   the vehicles consume different levels of gasoline  if we are able
to accurately predict the values of gasoline usage as a
function of driving behavior and road conditions  we
would be able to suggest a driving profile to minimize
the gasoline consumption along a given path  if we
are given different paths from source to destination 
we may choose the path that consumes least amount
of gasoline  as opposed to time considerations alone in
googlet m maps  
previously  various regression models have been proposed for modeling the vehicle fuel consumption     
the key input variables for these regression models
are instantaneous speed and magnitude of acceleration deceleration  for example      models the fuel
consumption of light duty vehicles as the interaction
between linear  quadratic  and cubic speed and acceleration terms  however  the experiments in     were
conducted in a controlled setting  where the fuel consumption is measured for different instantaneous speed
and acceleration values  within the operating limits of
vehicle   in section    we explore the possibility of using velocity and acceleration as input variables to predict fuel economy for a set of data samples obtained
in a normal driving setting  in section    we introduce

prediction of gasoline usage
in section    we argued that the gasoline consumption
of an automobile is a function of driving behavior and
road conditions  the driving behavior is characterized
by the speed and acceleration profile of automobile 
which we have access to  however  we do not have access to the road conditions from the given data  so 
we make a reasonable assumption that the road conditions are implicitly incorporated into driver behavior
 see figure     for example  traffic congestion  which is
a component of road conditions  results in low average
speed and frequent change in acceleration  which are
components of driver behavior   hence  the input variables into our regression algorithms  to predict gasoline
usage  are speed and acceleration components 

figure    driving behavior implicitly accounts for road
conditions

 

fi 

simple regression models

for each automobile data  linear regression is performed and one fold cross validation error is obtained
using randomly selected    percent of the data as holdout cross validation set  the correlation coefficient
 cc  between actual and predicted values for six different automobile datasets are presented in the unpolished data section of figure    we can observe that the
cc values are not satisfactory with cc value being
close to     

   

polishing of the data

the accelerometer readings contain instantaneous acceleration experienced by the accelerometer device 
which includes the effect of acceleration due to gravity 
we assume that over a large number of observations 
the average accelerometer reading will point towards
the earths gravitation  the affect of acceleration due
to gravity can now be removed by subtracting the gravity value from all the measurements 
following      we add additional features like linear 
quadratic  and  cubic speed and acceleration terms 
the cc values for the data after polishing and adding
the additional features are presented in the additional
features section of figure    we can observe that not
much improvement in the performance is obtained by
adding additional features  also  locally weighted regression is performed and the hold out cross validation
errors are obtained by using randomly selected   percent of the data as hold out cross validation set  the
root mean square  rms  values obtained are smaller
than but comparable to those obtained using simple
linear regression  and are presented in figure   

   

figure    correlation coefficient for different experiments
for different automobile datasets  different curves correspond to different automobile datasets  the dataset is
divided into   sections corresponding to different experiments 

against the friction forces like air drag  depends on
speed  and friction against ground  hence  it may be
appropriate to model the rate of gasoline consumption
as a function of speed and acceleration rather than trying to model fuel economy  miles per gallon measurements  of the automobile  hence  we designed a new
 
target variable gasoline rate   f uel economy
speed 
measured in gallons per hour 

analysis

 

the rms values and cc values obtained for different datasets are not satisfactory  the failure of locally
weighted regression to predict the gasoline usage as a
function of input variables indicates that we are not
able to estimate the value of the target variable as
a locally linear function of features in nearby space 
there are two approaches to obtain better algorithms 
first  we can create a higher dimensional feature vector from the available feature vector  like we did in
svm   we then hope that  in this high dimensional
space  the value of the target variable at a point can
be obtained  with reasonable accuracy  as a linear  or
locally linear  function of input features  second  may
be  the features considered are not able to capture the
gasoline usage  either we need a different extended
feature set or change the target variable  we observe
that a combination of the two approaches provides the
best results for our problem 
key insight  the rate at which gasoline is consumed is proportional to the energy spent  the energy
from combustion of gasoline is used to increase the
kinetic energy of the automobile  depends on the difference of squares of successive speeds   and to work

new target variable

for each automobile data  linear regression is performed and results are obtained as described in section
   and are presented in the new target variable section of figure    we cannot use rms values to compare
the performance of the algorithm for the two targets
because the ranges of gasoline rate and mileage are
widely different  hence  we used correlation coefficient
 cc  values to compare the improvement in prediction
accuracy  we observe significant improvement in the
prediction accuracy  taking cc between predicted and
actual measurements of target variables as measure of
accuracy  when we change the target variable to gasoline rate 
hence  we can conclude that we can follow gasoline rate much better than fuel economy as a function
of speed and acceleration  also  adding difference between current speed and previous speed value as an additional feature slightly improved the cc values  we
believe that this is because the increase in the kinetic
energy  which effects the gasoline rate  depends on the
difference in speeds  this result further supports our
argument to change the target variable to gasoline rate 
 

fifigure    comparision of rms errors for linear and locally

figure    correlation coefficient for different kernels

weighted regression  the black line corresponds to rms
error for linear regression  the rms errors are normalized
with respect to the rms error of linear regression for the
corresponding dataset 

 

support vector regression

in this section  we describe the implementation of the
other approach  to map the feature vectors into higher
dimensions with gasoline rate as the target variable 

   

experiments

we used the libsvm software package     to implement  svr  with        randomly selected samples
for each automobile as training data  we then obtain the svr parameters by performing ten fold crossvalidation  svr performed better than linear regression over all the datasets  see figure    
choice of kernel  it can be observed from figure
  that gaussian kernel performs better than linear or
polynomial kernels  we believe that gaussian kernel
performs better because it introduces larger number
of features  also  scaling of the data  so that each of
the feature vectors lies in the same range  improved
the performance of the algorithm for all the kernels 
scaling of the feature attributes avoids attributes in
greater numeric ranges dominating those in smaller numeric ranges  another advantage is to avoid numerical
difficulties during the calculation     
choice of parameters  we choose gaussian kernel for svr  it has two parameters  c and   inner
product between xi and xj   for gaussian kernel is 
exp   xi  xj       and c is the cost parameter similar
to cost c in svm   we initially perform a grid search
to obtain a smaller range for optimal c and  values 
we then perform a finer grid search  see figure    in
this smaller range  to obtain optimal c and  values
as   and   respectively 
results  with this choice of optimal c    and
gaussian kernel  we obtain very good value of    
for correlation coefficient between predicted and actual gasoline rate  figure   presents a comparision of
cc values for linear regression and svr for different
automobiles 

figure    grid search to get optimal svr parameters 
cost is c and gamma is 

 

an application

we explore the following problem in this section can
we come up with an optimal velocity and acceleration
profile to minimize the total gasoline consumption over
a given finite time period  we can take a greedy approach to solve the above problem  given the present
velocity and acceleration of the vehicle  velocity of vehicle in the next time instant is automatically determined using equations of motion  we then greedily
choose the next acceleration as the acceleration that
minimizes the gasoline consumption for the fixed next
velocity  we then proceed greedily in this fashion 
proceeding in greedy manner may result in a nonoptimal solution  moreover  gasoline usage is not a
simple function of velocity and acceleration  hence 
in order to find the optimal acceleration for a given
velocity  we may resort to gradient descent schemes 
which again is non optimal  it is also necessary to use
numerical approximations to obtain partial derivative 
with respect to acceleration components  of the func 

fi   

problem formulation

the problem we are trying to solve can be posed as
 ai     arg min
ai

n
x

g ai   vi    t

   

i  

here   ai   is the set of optimal accelerations  decisions
we need to make   we make the decision at every timeinstant  n is the total time period  g is a function
which describes the function which takes speed and
acceleration as inputs and gives the gasoline rate as
output  t is the length of each time period 

   

obtaining the mdp model

gasoline rate is nothing but gasoline usage  measured
in gallons  in one second  hence the cumulative gasoline usage of an automobile over a time period is nothfigure    correlation coefficients for different datasets  ing but the sum of gasoline rates over the time period
svr new targ referes to svr  linear refers to linear re assuming that the gasoline rate is constant over each
gression  the target variable is gasoline rate 
time period which here is one second   in reinforcement learning framework  we minimize the expected
tion that describes gasoline rate as a function of input payoff  which in this case is total gasoline consumpvariables  we propose an alternative and very natural tion with gasoline consumption in time period t is dist
reinforcement learning framework to solve this prob  counted by a factor    we can use this function of total
expected
payoff
as
an approximation to the gasoline
lem in a non greedy fashion 
usage over a finite time period  hence  the modified
problem is

   

rl framework
 ai     arg min e 

we divide the continuous space of speed and acceleration into a finite number of discrete states  for this
setting  we assume gasoline usage is a function of speed
and acceleration alone  in line with assumptions in      
reward in each state is negative of gasoline rate  the
action space is  accelerate  decelerate  neither accelerate nor decelerate   the movement of the automobile
from one state to another can now be seen as mdp
 see figure     the uncertainty comes both due to the
choice of exact value of next acceleration and due to the
discretization of space  we note that the next speed is
fixed by the present acceleration  the data collected
can now be seen as a series of experiments where the
driver takes random action in the present state  moves
to the new state  and observes the reward in the new
state  see figure     as mentioned in section      we
the data for each car consists of multiple trips  we can
use these trips as experiments to create and update a
model of mdp 

ai


x

 i g ai   vi   

   

i  

we may argue that this is a reasonable proxy for our
original optimization problem if      and positive 
this is because the gasoline consumption at far away
time instants is discounted by a very large factor 

   

results

we learn the model of mdp and obtain the values 
which here are negative of the total expected gasoline consumption starting in the particular state  using
value iteration  the reward for each state obtained after applying the reinforcement learning framework is
presented in figure    it can be observed that lower
speeds are associated with lower gasoline consumption 
also  acceleration is associated with higher gasoline
consumption  lower reward  than corresponding deceleration of same magnitude  this observation complies
with similar observation made in     
we argued that reinforcement learning framework
provides a better acceleration profile that achieves
lower gasoline usage than the greedy approach  to support our argument  we present the cumulative gasoline
usage  the value of the objective function in equation
   achieved by greedy approach and rl approach in
figure    in rl approach  if action is to accelerate  we
choose a random acceleration in some range depending
on the distribution of acceleration values observed in
data  similarly  we decide the exact value of deceleration if the action is to decelerate  we observe that

figure    rl framework showing transition from one state
to next

 

fiactual gasoline rate values  we have also developed a
reinforcement learning framework to solve the problem
of minimizing cumulative gasoline consumption over a
given time period 
future work  a set of controlled measurements 
where we have some measurements where we know
that car is moving in a plane perpendicular to gravity direction  would help us to come up with better
approaches for data cleaning  especially  it helps in
taking into account directly the effects of road conditions on driving behavior  specifically  clean data
will help us to understand the transformation from accelerometer frame to car frame to ground frame  see
figure      this is essential in city like san francisco to
understand the terrain  like slopes  and include effect
of gravity  for example  when moving down a slope 
even though we are travelling at a high speed  gasoline
consumption may be low because gravity is helping us
figure    reward values for different states  vel  refers push forward  hence  by working in ground frame 
to speed  acc refers to acceleration with increasing magni  we can take into account gravity and come up with
tude  dec refers to deceleration with increasing magnitude  better prediction of gasoline consumption 
black boxes represent states which are never reached 

although greedy approach may result in short term
gains in gasoline consumption  gasoline consumption
achieved by rl approach is smaller than the greedy
approach over a longer duration 
figure     transformation of axes to ground frame
a more interesting application would be to minimize
the gasoline usage over a particular path  which may
be a path a user commutes daily   or at least for a
particular distance travelled  problem formulation for
the later problem is

p
 ai     arg minai
g ai   vi    t
s t 


p

i  

vi  t   d

i  

here  d is the distance to be covered  we have not
yet come up with tractable solutions or approximate
solutions for this problem  but  we believe that it is
an interesting direction to proceed 

references
    ahn k   rakha h   trani a   and van aerde m  
estimating vehicle fuel consumption and emissions
based on instantaneous speed and acceleration levels 
journal of transportation engineering  vol       no 
   march april       pp         
    chih chung chang and chih jen lin  libsvm   a library for support vector machines  acm
transactions on intelligent systems and technology                    
software available at
http   www csie ntu edu tw  cjlin libsvm
    chih wei hsu  chih chung chang  and chih jen
lin  a practical guide to support vector classification  http   www csie ntu edu tw  cjlin

figure    cumulative gasoline consumption  the experiment is performed for time period    minutes  the gasoline
consumption is scaled by      on y axis 

 

conclusions

we have shown that changing the target variable from
fuel economy to gasoline rate improves prediction accuracy both for linear and svr methods  we have shown
that using svr on scaled training data provides very
good prediction accuracy of around     measured in
terms of correlation coefficient between predicted and
 

fi