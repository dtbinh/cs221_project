cs     machine learning
project title 
recognition and classification of human embryonic stem  hes  cells differentiation level
team members
dennis won  jwon       jeong soo sim  digivice 

project purpose
   given an image of hes cell culture  use learning algorithms to classify whether the recognized cell colonies are
differentiated or not  binary classification 
   perform multi class classification to determine the level of differentiation of the recognized cell colonies
   spot the particular sections in the recognized colonies where there remains undifferentiated cell colonies
   provide a graphical display on the cell images demonstrating which colonies or which parts of the colonies are
undifferentiated  and thus utilizable for medical research
introduction
while human embryonic stem  hes  cells impose a huge potential in biomedical research discoveries to cure
numerous diseases  such as alzheimer s diseases  spinal cord injury  heart disease  etc    the difficulty to maintain
the undifferentiated state of hes cells hinders researchers to perform accurate and efficient experiments on hes
cells  human embryonic stem  hes  cells must be monitored and cared for in order to maintain healthy 
undifferentiated cultures  in order to maintain the undifferentiated state of hes cells  the cultures must be
continuously made sure to have no lost or lacking nutrients and be free of unwanted differentiation factors  in
addition  although a small amount of differentiation is normal and expected in stem cell cultures  the culture should
be routinely cleaned up by manually removing  or  picking  differentiated areas because those differentiated areas
within the colony starts the chain like reaction to differentiate others parts of the cultures  spreading the
differentiation  
having no technology to systematically maintain the undifferentiated state of hes cell culture  the stem cell
scientists today completely rely on human eyes  human hands  and human decision to i  keep the favorable
environment for the cell culture to remain undifferentiated  and to ii  identifying and removing excess differentiation
from hes cell cultures to maintain the healthy population of cells  due to the subjective nature of human decision
based on human eyes and hands  the maintenance of healthy  undifferentiated hes cell culture has become one of
the most difficult things to do for those scientists  
this particular project aims to use machine learning technologies  supervised learning algorithms  to perform ai
recognition and binary classification of healthy  undifferentiated stem cell colonies from hes cell images with their
differentiation levels  there are two main parts to this project 
   train an svm and logistic regression model to learn how to classify between differentiated and
undifferentiated hes colony  the input features for svm training includes  the closeness of the shape of
the colony to a perfect circle  the defined ness of the edge of the colony  the degree of color intensity
distribution within the colony  size of the colony  texture of the colony  etc 
   train svm and logistic regression model to learn how to classify the differentiatedness of the each
individual superpixel within the hes colony in order to localize the undifferentiated  healthy section within
the colony 

 

fics     machine learning
part i  extracting feature vectors from the training set of hes cell colony images
this project involves a heavy load of image processing work that needs to done prior to training and testing the
learning classifier in order to extract features from the images  we aggregated a total of     images of hes stem
cell colony provided from wu cardiovascular stem cell laboratory at stanford medical center  of the     images 
exactly     images were differentiated hes cell colony images  positive      and exactly other half     images
were undifferentiated  healthy hes cell colony images  negative       these images were taken by the same
microscope with the same size scale and the same color intensity  figure   shows the sample images of a positive
colony image  a   and a negative colony image  b  

 a 

 b 

figure     a  positive colony image for the differentiated colony   b  negative colony image for the undifferentiated
colony  note the morphological differences between the two 
i  colony image feature extraction
opencv  open source computer vision library  is a library of programming functions mainly aimed at realtime computer vision  developed by intel  we used this opencv library to extract the following features of the hes
colonies  figure   shows the detection of the cell colony using the opencv edge and object detector  which also
provides a variety of feature extraction methods  figure   below displays the feature vector extracted from each
hes cell colony image  along with the description of how individual features were measured and calculated 
 a 

 b 

figure     a  edge object detection of the positive colony image for the differentiated colony   b  edge object
detection of the negative colony image for the undifferentiated colony  note the morphological differences between
the two 
 

fics     machine learning
feature  colony level 
shape closeness to perfect circle

measurement
opencv library to fit circular objects on the image  the closeness of the
colony shape to a perfect circle determined by the opencv detector 
range       closeness     
edge definition level
edge definition level measured as the ratio of the number of edge pixels
in the boundary of the colony to the total number of boundary pixels  the
higher the ratio  number of edge pixels total number of boundary pixels  
the higher the edge definition is  calculated using the opencv detector 
range       edge definition level     
size
the size of the colony measured as the ratio of the radius of the edgedetected colony to the dimension of the cell image  note that all cell
colony images were taken under the same condition  size scale  light
intensity  etc  
range       size     
texture density
texture density of the cell colony measured as the edgeness per unit area 
which is defined by f edgeness     p   gradient magnitude p    t     n
where p is a pixel in the colony segment  t is some threshold  n is the
total number of pixels in the colony segment  and gradient magnitude
computed from opencv detector 
range       texture density     
color intensity distribution
color intensity distribution level measured by the standard deviation of
the color intensity histogram for all pixels within the cell colony region
divided by the range of the color intensity 
range       color intensity distribution     
figure    the feature vector extracted from each hes cell colony image
ii  superpixel feature extraction within a single colony
in addition extracting features of a colony to train svm to perform binary classification of whether the colony is
differentiated or undifferentiated in general  we also extracted features for each individual superpixels within each
hes cell colony  superpixel was defined as   x   pixel sqaure within the colony   a total of     samples of hes
cell colonies were manually tagged for their undifferentiated region within them  figure   displays the examples of
the tagged  the red roi  image input of hes colony  and figure   shows the feature vector extracted from each
superpixel    features extracted from each superpixel  
 a 

 b 

figure    the undifferentiated region roi of colony tagged input images   manually tagged 
 

fics     machine learning
feature  superpixel   x   level 
edge definition level

distance from centroid

texture density

color intensity distribution

measurement
edge definition level measured similar to the edge definition level from figure
   but measured from only within a particular superpixel 
range       edge definition level     
the distance from centroid measured as the ratio of pixel distance from the
centroid to the radius of the detected colony 
range       size     
texture density of the super pixel measured as the edgeness per unit area  similar
to as described from figure   feature vector for colony features 
range       texture density     
color intensity distribution level measured by the standard deviation of the color
intensity histogram for all pixels within the superpixel divided by the range of
the color intensity 
range       color intensity distribution     

figure    the feature vector extracted from each superpixel with in the detected hes cell colony image
part ii  training support vector machine  svm  and logistic regression model with the extracted features
ten fold cross validation
 positive samples
 negative samples
  fold used for svm training

  fold used for testing

support vector machine  python sklearn library 

classification result 
 a  part i  colony binary classification  positive  differentiated  negative  undifferentiated
 b  part ii  superpixel binary classification for segmentation of undifferentiated  negative  region
within the hes colony  figure   demonstrates an example of the segmented region of
undifferentiated region within the colony determined by the svm 

 a    training
 a    test
 b    training
 b    test
figure    the superpixel binary classification used to segment the undifferentiated  negative  region of the hes
cell colony  a   and b   are the svm classification induced roi  while a   and b   are manually tagged roi  

 

fics     machine learning
part iii  result
i  support vector machine on hes colony  colony level classification
for each of ten iterations of ten fold cross validation  we recorded the positive and negative classified samples for
both our prediction and the manually tagged result  by aggregating all iterations  we were able to deduce the
following table 
 
 
   
prediction
  
total
   
figure    svm prediction result using ten fold cross validation

real
  
   
   

total
   
   
   

using ten fold cross validation for    times and aggregating every result gave us       accuracy  figure    
ii  support vector machine on superpixel  superpixel level classification
for each of ten iterations of ten fold cross validation  we computed the numbers of predicted samples where the
overlap between the predicted roi of undifferentiated region and the manually tagged roi is higher than      that
is  the ratio of the overlap between the two rois to the size of the manually tagged roi exceeds        by
aggregating all iterations  we found that our svm achieves       accuracy     out of     total samples had over
    of its roi predicted by our svm model  

discussion
while our svm model to predict the differentiate ness of the hes cell colony and the segmentation of the
undifferentiated region in the colony achieved a degree of accuracy  around       there are definitely sources or
errors that hampered our study to be more accurate  first of all  our feature extraction and the normalization of the
extracted features might not completely capture the differences between positive and negative samples  most
importantly  the size of our training set is not large enough to have achieve higher level of accuracy 
the future effort to increase the performance of the learning machine includes the following  first of all  use more
data so that the machine gets trained better  second  use more sophisticated image processing techniques to extract
more features and also find out which features are the most important factors in determining the differentiated ness
of the colony  lastly  we will be able to improve the segmentation algorithm used in this project by constructing
more sophisticated and intuitive way to form superpixels  currently  superpixel is constructed based on chosen
constant  by allowing superpixels to have various size and shape  our analysis on the colony will have more
accuracy since we will be able to more precisely depict the characteristics of colonies and cell 

 

fi