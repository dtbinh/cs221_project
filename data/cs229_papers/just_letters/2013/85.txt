tcf   binding sites characterization using latent dirichlet allocation

tcf   binding sites characterization using latent
dirichlet allocation
tyler davis  eric kofman  sean scott
abstract
transcription factors play multiple roles in cell activity and gene expression  and discovering these roles often
requires experimentation in a wet lab  we hope to bypass this process computationally by using topic modeling to
infer the myriad of functions of a given transcription factor  specifically  we apply latent dirichlet allocation
 lda  to all peaks derived from running chip seq on tcf   in fetal heart cells  and model each peak as a mixture
of topics composed of known binding motifs and cell types  we cluster peaks with similar topic distributions together 
and we leverage great to demonstrate that a significant fraction of the resulting clusters have functional biological
significance  functional significance of the peak clusterings implies that we have found functional subgroups of
sites that bind tcf    and thus functions in which tcf   is involved  furthermore  we also show that the topics
deduced by lda can associate motifs with cell activity in a variety of human cells and thus also yield useful
information  these results are summarized in figure  

i 

introduction

i  biological background
one of the many fascinating aspects of biology is the way in which an organisms cells are able to to differentiate
themselves from one another  such that a cell in the liver knows to perform different functions from a cell in the lung 
this is remarkable because each cell in an organism bases its production of proteins on the same genetic blueprint 
and the underlying implication is that each cell must somehow repress certain genes and activate others depending
on what function it needs to serve  proteins called transcription factors serve as the switches in this process by
binding to certain stretches of dna  for example  an activating complex of transcription factor proteins might form a
scaffold that heightens the probability of rna polymerase binding and accordingly of transcription occurring  and
conversely  a repressing transcription factor might block key rna polymerase binding sites  a single transcription
factor can play roles in different biological pathways depending on its binding environment and the presence of other
protein factors with which it may complex  more specifically  examining the sequences in the region surrounding these
peaks  other potential binding sites  or motifs  gives insight into the roles played by nearby transcription factors 
chip seq  chromatin immunoprecipitation sequencing  is a technology employed to discover these transcription factor
binding sites  and its output is in the form of peaks representing regions at which transcription factors have a high
probability of binding along a genome      more specifically  the region around each chip seq peak is a combination
of certain binding motifs  that is  different combinations of the same short sequences will bind to different sets of
transcription factors  and these related but different sets of factors imply different biological functions  thus  we can
view this information as a mixed membership model      for this reason  we use latent dirichlet allocation as a an
algorithm to both generate topics of motifs and cluster peaks based on their motifs 

ii  applicability of latent dirichlet allocation
ldas original use case takes a corpus of documents and a vocabulary as inputs and operates within three layer
framework  each document is comprised of a mixture of topics  and each topic is a distribution over the words in
the vocabulary      lda generates the word composition of each topic and the topic composition of each document 
each binding site for a transcription factor may play roles in different biological processes  and assigning a mixture of
topics to each binding site provides a more realistic description of a transcription factors versatility  consequently 
uncovering the structure underlying chip seq data requires a topic modeling approach such as that employed by lda
as opposed to a simpler clustering algorithm such as k means which does not employ this mixed membership model 
we used chip seq results for transcription factor     tcf    in fetal heart cells  a dataset of known common binding
motifs  short sequences of dna with which transcription factors often interact  and a dataset of known activity levels
of dna regions in     cell types  we set out to use lda to develop a topic model for the chip seq peaks that would
 

fitcf   binding sites characterization using latent dirichlet allocation

figure    this is a visualization of the output of running lda on the combined cell activity motif matrix for the peaks
generated by chip seq  each row represents a binding site  and each column represents one of the    topics
generated by lda  the darker an intersection is  the larger the assignment of the referenced topic to the referenced
binding site  binding sites are clustered based on similarity of distributions over topics  and topics have been grouped
via hierarchical clustering  sample great outputs are shown for two of the binding site clusters on the right side
of the table  and one of topics  a mixture of motifs and cell types  is described at the top of the diagram 

 

fitcf   binding sites characterization using latent dirichlet allocation

allow us to split them into functional subgroups representing the different biological functions played by tcf   
tcf   binding sites serve as the documents in our model  and we tested three different vocabularies on various
runs of lda  the motifs present at each site  the cell type in which the sites are active  and both simultaneously 
in this context  the topics generated by lda are mixtures of cell types and motifs  which can in turn be related to
biological function  a useful byproduct of lda with this combined vocabulary is the association of certain cell types
with certain motifs 

ii 

methods

i  document clustering
for each document  lda outputs a distribution over topics  thus  the documents  in our case  binding sites 
may be clustered according to similarity of topic distributions  we implemented k means with    clusters using
jensen shannon divergence as a distance metric  to validate the use of lda in this context  we ran the algorithm
using various settings and showed that the clusters remain relatively stable  see model stability   we also processed
the clusters using the genomic regions enrichment of annotations tool  great  to see if they represent any
enrichment  have any biological significance  over the baseline of all peaks     

iii 

model stability

we ran hoffmans online lda  setting       no exponential decay of learning rate  and s   d         using
all documents at once  which recovers batch variational bayes lda      to compare  we changed some parameters
to ensure that our results were stable  in all iterations  we used    epochs  passes through the entire dataset  for
consistency 

i  random seed variation
lda uses random numbers to initialize  and   in order to test our algorithm for stability  in other words  to make
sure that the distributions of vocabulary within each topic stayed fairly constant between runs of lda  we seeded the
random generator with    different numbers  we then compared our baseline distribution to the distributions arising
from each of the seeds using jensen shannon divergence as a distance metric  with a confusion matrix mapping each
topic in the first set to one in the second set with the lowest divergence  theoretically  if each run of lda with a
different seed had produced the exact same set of distributions of words over topics  then      of distributions from
one run of lda would be matched with a unique highest similarity distribution from the second run of lda in a
one to one pairing  on average       of the    distributions over topics         from each run of lda matched up
well with our baseline distributions  this is significantly larger than the average of      for comparisons of    random
distributions over     iterations  which would have been the expected value if lda were outputting completely
different distributions on each run  this means that that despite some variability across runs  in general there is a
core group of fairly constant topics underlying the dataset 

ii  online lda
we also used            and batch sizes between    and      as suggested by hoffman et al      as the perplexity
graph shows  figure     this performs similarly to batch lda  which implies that the algorithm is also robust to
changes in parameters  the batch size does not affect the perplexity value  but does affect the amount of noise
observed  the value of   however  does change the final perplexity  and we see that        performs better than
    or      we also see it should be roughly equivalent to use the online algorithm instead of the full batch one  for
example to process massive or streaming peak data without running into memory issues 

iii  convergence
using hoffman et al s measure of estimated perplexity as a measure of log likelihood  we can see the convergence
of the model graphically  figure     as mentioned above  the perplexity value stabilizes within    epochs for all
 

fitcf   binding sites characterization using latent dirichlet allocation

figure    looking at both the stochastic  online  and batch versions of lda  we see that the algorithms converge 

parameters used 

iv 

biological validation

i  cluster enrichments
in order to determine whether our final clusters of binding sites based on the lda distributions contained meaningful
biological information  great  genome regions enrichment of annotation tool  was utilized to test each cluster for
biological categorization      of the clusters generated using a combination of cell activity and motif presence as a
vocabulary could be related to genes with known biological functions  an improvement over simple k means clustering
 figure    

lda
k means
random assignment

motif presence
   
   

cell activity
   
   
   

motif and activity
   
   

figure    we see that the cell activity matrix is the best data set for finding enrichments using great  adding the motifs
seen in the peaks adds noise  and performs worse than a random baseline   however  it should be noted that lda
does much better on the combined matrix  which can be explained by the fact that it weights features differently 
namely the cell type activities over the motifs 

 

fitcf   binding sites characterization using latent dirichlet allocation

motif presence
     

estimated perplexity

cell activity
     

motif and activity
     

figure    here we see that the estimated perplexity for lda run on the activity matrix only is lower than that run on the
combined motif and activity matrix  which is in turn lower than that of the run on the motif matrix only  this
corroborates our results above  since the model with the lowest perplexity also performs best in great 

ii  cell motif associations
dna binding motifs that often found at sites active in certain cell types are grouped into topics by the algorithm 
thus lda also yields informative cell type motif associations when run on a vocabulary composed of a concatenation
of the two 

v 

summary

useful insight into transcription factor multifunctionality can be garnered from data from just one initial laboratory
experiment  using probabilistic methods rather than further laboratory experiments to tease out the details  figure  
shows what kind of information can learned from the output matrix 

vi 

acknowledgements

we would like to acknowledge anshul kundaje  assistant professor at the stanford university department of genetics
and the department of computer science  and chuan sheng foo  ph d student at the department of computer
science at stanford  for their help throughout this project  we would also like to acknowledge thomas quertermous
and his lab at the stanford school of medicine for providing us the fetal heart cell data finally  we would also like to
acknowledge the course staff of cs     machine learning  for their guidance on the project in general 

vii 

data sources

region activity levels by cell type  http   www broadinstitute org  anshul projects roadmap segmentations models coremarks parallel set  final 
transcription factor binding site motifs  http   compbio mit edu encode motifs 
cell type maps  https   sites google com site epigenomeroadmapawg project updates auxiliarysegmentationcoremarksh k  ac
human genome  http   hgdownload cse ucsc edu goldenpath hg   chromosomes 
fetal heart cell data  courtesy of the quertermous lab 

references
    d  blei  a  ng  m  jordan  latent dirichlet allocation  journal of machine learning research                 
    m  hoffman  d  blei  f  bach  online learning for latent dirichlet allocation in nips       
    cy  mclean  et al  great improves functional interpretation of cis regulatory regions  nature biotechnology 
               
    e r  mardis  chip seq  welcome to the new frontier  nat  methods                   
    d  blei  mixed membership models  princeton university lecture     oct       

 

fi