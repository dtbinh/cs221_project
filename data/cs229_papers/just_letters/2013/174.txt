performance of different algorithms on clustering molecular dynamics trajectories
chenchen song
abstract
different types of clustering algorithms are applied to clustering molecular dynamics trajectories to get insight about
possible conformations for molecules    the algorithms covered include k means  em  multivariate gaussian   singlelinkage  centroid linkage  average linkage  complete linkage  root mean square deviation  rmsd  is used as metric 
performances of algorithms are analyzed and compared based on davies bouldin index dbi  and pseudo f static  psf  

   introduction
molecular dynamics simulation methods produce
trajectories of molecule configuration snapshots as a
function of time  the time scale of chemical process is
ns  while the time scale of molecule internal freedom is
fs  thus a sufficient simulation trajectory will need to
contain at least o n   configurations  for such large
amounts of data  machine learning algorithm becomes
helpful to extract useful information from the datasets 
one type of information we hope to get is the
conformation substates of a molecule  which falls into
the clustering problem  using clustering algorithm to
help analyze molecular dynamics trajectories is actually
not a new idea  and can date back to       since then  a
number of papers about applying different types of
clustering algorithms on md have been published  thus 
in this project  i will focus on comparing the
performance of different clustering algorithm 

positions of centroids and relative distances from points
to centroids during each iteration  because our metric is
not a simple euclidean distance  the latter methods will
be more time consuming 
    performance metric
dbi is defined as
db 

     

where d ij is distance between centroids and d i is the
average distance between points in some cluster with the
centroid of that cluster 
psf is defined as 
psf 

ss b  n  k 
ss w  k   
k

     
k

ss b   ni    mi  m       ss w      x  mi    
i  

   method
details of the methods have been carefully discussed in
the milestone report  here we only give a brief review 
    similarity metric
instead of normal euclidean norm  rmsd will be used
as metric  which first tries to align two molecule as
much as possible before calculating euclidean distance 
by using rmsd  we can eliminate the effect from
translational and rotational motion of molecule 
    algorithm
k means and multivariate gaussian will be called em
for short  have been introduced in class 
the linkage methods are different in how the distance
between clusters is defined  single edge  linkage uses
the shortest inter cluster point to point distance 
centroid linkage uses the distance between cluster
centroids  average linkage  uses average distances
between individual points of the two clusters  completelinkage uses maximal point to point distance 
due to their different definition of critical distance 
latter we will see that they sometimes can have very
different behavior 
single linkage  complete linkage  and average linkage
only need to calculate a metric matrix of size n  at the
very beginning  other methods need to update the

di  d j
  k
max j i dij   dij 

k i  
di   j

i   xci

where mi is centroid and m is the overall mean of data 
usually  lower dbi and higher psf reflects compact
and well separated dbi  but one should be careful
when using these indices  for example  dbi is affected
by cluster count  we should only compare dbi values
when the number of clusters is similar 
   results and analysis
molecular dynamics trajectories are generated by
terachem package  rmsd calculation and molecular
alignment is performed using vmd package  if the
methods only requires n  metric matrix as discussed in
the previous sections  then the clustering is performed by
matlab statistic box  otherwise  the clustering is
performed by cluster     where we have added our
metric into the clustering library  dbi and psf are
calculated by matlab 
    clustering points in  d plane from uniform
distribution
first  different clustering methods are applied to a
hundred points in  d plane which are sampled from
uniform distribution  the points dont have any internal

fifrom fig    the following properties can be observed 
    most of the methods tend to naturally and equally
partition the points into four blocks  this is especially
true for k means 
    single linkage  or edge linkage  almost classifies all
the points into a same cluster  this might because the
critical distance of single linkage is defined as the
nearest points between two clusters  thus single linkage
may be very sensitive to cases where points are close to
each other and no clear border exists 
    em method is the only one that produces clusters
with very different shapes  this might be em method
does clustering based on probabilistic assumptions while
all other methods are based on geometric structures 

em
link centroid
link single

link average

link centroid
link single

figure    clustering results for points in  d plane drawn from
uniform distribution

link complete

link average
link complete

em

k means

k means

structures  thus the clustering results will only reflect the
properties of different algorithm 

figure    clustering results for points in  d plane drawn from
three equally sized overlapped gaussian distribution 

compared to the original figure  the following properties
can be noticed 
    the success of k means may again due to the
internal property of k means to produce clusters with
same size and same shape 
    em can get pretty good result if the underlying
probability distribution is very close to gaussian 
    centroid linkage doesnt work well  perhaps because
the centroids are ill defined 
    single linkage seems to fail for this circumstance
again where points have no clear borders 
     clustering artificial md data  four equally sized
clusters

    clustering points on  d plane from overlapped
gaussian distribution 
in the second step  clustering methods are applied to
points sampled from three independent gaussian
distributions  the mean and covariance of  d gaussian
is tuned so that the three distributions are overlapped 
the reason to test on overlapped points is that in md
simulations  the trajectories are generated consequently 
thus adjacent configurations are usually very similar 

original

figure    illustrations of typical cyclo hexane conformations 

cyclo hexane is used as a test model  four clusters are
chair  twisted boat  boat   and half chair  to generate
each cluster  take chair as an example  we start from a

fil single

l centroid

figure   dbi and psf for clustering artificial md trajectories
of cyclo hexane  optimal clusters are four equally sized
clusters  x axis range from   to   

by checking the assignments  it is found that for this
test with equal clustering size and clear border  most of
the algorithm perform very well except em  this might
be because gaussian distribution is not a good
assumption for how configurations distribute within each
cluster around the centroid 
    clustering artificial md data  five differentially
sized clusters 
in real md simulations  the sizes of clusters can be very
different  because the lower the energy is  the higher
probability it will appear during simulation  to mimic
this property  in this test  we build an artificial md data
by combining 
  planar structures     half chair
structures     boat structures     twist boat structures 
and     chairs  the order is also consistent with the
energy order 

l centroid

l complete

l average

em

k means

this set is much difficult to cluster as it has both very
small clusters with small variance and relative large
clusters with large variance 
dbi
psf

l single

l complete

l average

em

k means

chair configuration  control the timestep to     fs 
control the temperature to very low and only proceed
    steps  repeat this procedure several times  we can
guarantee to generate a cluster with typical chair
configurations 
because the five different clusters are generated
independently and artificially  theres actually a very
clear border between different clusters 
the figure shows the expected idealized behavior
including minima in the dbi  maxima in psf when
clustering number is equal to the optimal value of   
dbi
psf

figure   dbi and psf for clustering artificial md trajectories
of cyclo hexane  optimal clusters are five distinct sized
clusters  x axis range from   to   

table    size of clusters for different algorithm with
different number of clusters 
method
 cluster
cluster size
 
           
kmeans
 
              
 
                 
 
       
   
 
       
      
l single
 
            
      
 
       
   
 
       
      
l average
 
                    
 
       
   
l centroid
 
       
      
 
                    
 
       
   
l complete
 
       
      
 
            
      
 
             
 
                
em
 
                   
it can be noticed that when configurations are not
uniformly separated  the metrics are less consistent and
not necessary gets optimal value at optimal cluster
numbers 

fifrom the table and figure the following properties could
be observed
    for this tests where clear border exists but cluster
sizes are very different  all the linkage methods are able
to recover the correct assignment at optimal cluster
number    when cluster number increases  different
methods then split clusters in different way due to their
different distance definition 
    k mean exhibits a strong tendency to cluster points
into equal size  thus doesnt give good performance for
this tests 
    em also gives pretty bad result  possibly due to same
reason as previous tests 

    clustering real md data 
unlike the artificial trajectories in which configurations
are clearly separated  configurations from adjacent steps
in real md simulations are very similar and will make
clustering to be more difficult 
cyclohexane is again used as the test examples  multiple
trajectories are generated starting from half chair
structure  after clustering each trajectories individually 
two distinct typical types of behavior is shown below 

figure    centroids for each cluster 

to explain this behavior  the energy profile for a
continuous changing cyclohexane is checked 

figure    cyclohexane energy profile 

it can be seen from the figure that  if starting from halfchair  it can either goes to the left  the chair region  if the
plat part flips downwards  or goes to the right  the boat
region if the plat fart flips upwards   once it steps to the
left  it will be separated from the other part by a high
energy barrier  similar for stepping into the right region 

k means

all methods give the almost the same clustering when
cluster number is three  if we set cluster number to two 
methods will have distinct results 

    upward twist boat

    boat

    downward twist boat

link centroids

    chair

link complete

figure    two distinct types of behavior and clustering results
when clustering real md trajectories of cyclo hexane starting
from half chair conformation 

filink average
link single

figure    different clustering results from different algorithm
when number of cluster is   

it can be seen from the figure that  
   k means and linkage complete method merges
upward and downward twist boat  these two methods
emphasize more on the difference between boat and
twist boat 
    link centroids and link average merge boat and
upward twist boat  and weigh more on the difference
between reversed configurations 
    link single doesnt preform very well for this tests 
perhaps because it cannot handle circumstances where
clear border is absent 

rmsd

    clustering protein trajectories
finally  clustering method is applied to protein
trajectories  complete linkage method is used  because it
performs well in the previous tests and only requires a
n  metric matrix  without necessity to compute updated
centroids during each iteration  optimal clustering
number is picked out by psf indices 
considering the available computing ability  we apply a
pulling force to the protein so that the structure will
change more rapidly  only the coordinates of backbones
 carbon  nitrogen  oxygen  are passed into the clustering
program  results are shown below 

figure     centroids for three clusters 
summary
in this project  we use several tests to compare and
analyze the performance of different clustering methods
under various conditions  the following properties can
be summarized from our observations 
    k means tends to produce blocky clusters of similar
size  thus when cluster sizes are similar  k means gives
very good performance  but it usually fails for clusters
with distinct sizes 
    single linkage is very sensitive to closely spaced
points  as a result it may be fragile to the presence or
absence of single point 
    multivariate gaussian doesnt work well for most of
the tests  perhaps because the assumption of gaussian
distribution is not good in our problem
    centroid   average   and complete average gives
quite consistency good results through the results  the
latter two doesnt require updating centroids during each
iteration  thus may be candidates for clustering
molecular dynamics trajectories 
references

time

figure    clustering results for protein 

   karpen  m  e   tobias  d  j   brooks  c  l   biochemistry       
            

the three clusters clearly show the transformation from
folded  half unfolded to completely unfolded under the
pulling force we apply to the system 

   kabsch  w  acta crystallogr                  
   ramanathan a  yoo  j o   langmead  c j   j  chem  theory
comput                
   shao  e  et al  j  chem  theory comput                 

fi