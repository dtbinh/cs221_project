cs     december     

synthesizing images with out of plane
transformations using stereo images
ruitang chen  zhuodong he  dai shen
stanford university

abstract
using a pair of stereo cameras  we can acquire the depth information  and thus synthesize images
with  d transformations  however  the resulting images often look uncanny because of data noises 
in this project  we attempt to repair the generated stereo images  one way to address this problem
is via unsupervised feature learning that could be achieved using linear autoencoders  also known as
reconstruction independent component analysis  rica   this algorithm has been shown to outperform
other algorithms by penalizing lack of diversity among features  we improve the algorithm by adding
an extension layer  and compare its performance with another image inpainting technique based on fast
marching method  our research shows that the inpainting method holds good promise 

i 

introduction

n computer vision  the process of obtaining
data has often been time consuming and expensive  moreover  research outcome often
heavily depends on both the quality and quantity of the data used  consequently  novel ways
of data generation has become an increasingly
hot research topic  however  generated data
often contains corruptions  which is inevitable
in the simulation of reality from data at hand 
many of the corruptions fall into the category
of inpainting problem  inpainting problems
occur when pixel values are missing or images
contain undesirable noises which hinder the
use of the these data in other applications  this
project aims to address this issue through denoising autoencoder  da  specifically in the
context of stereo view transformations 
one of the biggest motivations in choosing
da is that it employs deep learning that can
capture complicated nonlinear structures hidden in the images  da is a neural network that
aims to reconstruct the original image from
a noisy version of it through finding out the
hidden structure in the image  in our case  the
training data are obtained from two stereo cameras mounted on the top of a car  images from
the left camera are transformed and compared

i

to those of the right  some pixel values will
be lost due to data inaccuracies  loss of depth
information or occlusion   which will produce
noises  da is the used to restore the lost pixels
and reconstruct the original images 
the specific da algorithm we consider is
reconstruction independent component analysis  rica   which will be explained in detail
in the next section  we also propose a nonlinear extension of rica which improves the
performance  in the end  we implement an
inpainting telea algorithm which outperforms
rica in the denoising process 

ii 
i 

methods

 d transformation

the data set is obtained from kitti     images are taken from cameras mounted on
two extreme sides of a car  images are rectified in advance  depth maps are generated
using semi global block matching  sgbm 
algorithm    which uses pixel wise cost calculation  disparity is the difference between
intensity of two pixels at the same location of
two images and is inversely proportional to
depth  which is derived by the formula 
 

fics     december     

depth   t  f  disparity  x  y  

   

where t is the distance of two cameras  and
f is focal length of camera  hence we are able
to get the real world depth data and map the
pixel on the image to  d location according to
the formula 
  


x
f x   cu
x z
 y       f y cv   y z   
   
 
   
 
 
where f x   f y are focal lengths  cu  cv are coordinates of the principal point of the camera  and
  x  y  z   is the real world coordinate 

figure    a disparity map 

new image at a different angle can be obtained through imposing the following rotation
matrix such as the one along z axis 


cos   sin   
 sin 
   
cos     
 
 
 
in the original real world coordinate  we
can make line transformation  and use the
same method to project real world image data
to  d plane 

figure    a left image that has been transformed to match
that of the right  many pixels lost their values
during the trasnformation 

however  in this process some pixel values
will lose due to inaccurate calculation of depth
information  hence we are trying to repair
 

these black holes of images  we then propose
three methods  rica  deep rica and inpainting 

ii 

rica

model in this section  we introduce the
basic models of rica which serve as the foundation in our denoising method  compared to
traditional autoencoder  rica is able to train
data with overcomplete features  number of
features  dimentionality of data  and is insensitive to whitening  a preprosessing step that
decorrelate the data   therefore  this algorithm
has been shown to outpeform many other autoencoder algorithms 
suppose we have unlabeled training example set   x       x           in our case are vectors transformed by corrupted image matrix   y      y         are the original right image  we modified the problem to be training
  x       x          to find an encoding matrix w t w
to restore x  i  to y i   
hence  rica produce the following unconstrained optimization problem 

min 
w


m

m

m

 kw t wx i   y i  k     

n

 g wj x i     

i    j   

i   

where g is a nonlinear convex function  in
our case is the sparsity cost 
 

g wj x  i         e   wj x  i         
w  rkn is the weight matrix  where k is
number of features  w is the encoding matrix 
hence the encoding step is wxi   the activation
function of rica is proposed to be a linear
function of  wx  i     next we are going to propose a deep version of rica  which use an
extra layer of f   wx  i     for convenience  we
define that
m

h  w    

 kw t wx i   y i  k    

i   

m

g  w    

n

  g wj x i    

i    j   

fics     december     

j  w    


h  w     g  w    
m

process of rica
   initialize parameters    e  number of hidden units  
   use backpropagation algorithm to calculate   a      a                      
a l   to denote the activation of layer l
   calculate  w h  w    w g  w     w j  w   
   use the unconstrained optimizer l bfgs
to find w    argmin j  w   
w

   encode corrupted image by imposing
wx  i   
   calculate squared error kwx  i   y i  k  
to validate accuracy 
data processing using kitti dataset  we
are able to obtain a disparity map for each
set of images  then we artificially generate
right image based on the camera calibration
data we get  due to limit of computer memory
space  w cannot be high dimension  we divide
the picture into    pixel     pixel patches
as training sets  then we reshape image matrix into vector   x       x           the object vectors
 y      y         are original right images obtained
from kitti data set  in this project  we run rica
on    pictures of     patches 

study  we chose  to be      
effect of number of hidden units  features  
a low number of hidden units make poor
predictions  whereas high number of hidden
units may lead to overfitting  we run our
algorithm at k       

iv 

inpainting

here we employ telea algorithm for inpainting 
to inpaint a region   we select a boundary
point p and take a small neighborhood be   p 
of size e of the known image around p   the
inpainting of p should be determined by the
values of the known image points close to p 
i e   in be   p   for e small enough  we consider
a first order approximation iq   p  of the image
in point p  given the image i  q  and gradient
  i  q  values of point q 
the inpainting method is described by 
iq   p    i  q      i  q   p  q 

   

due to the linearity of rica  data underfitting
may occur  in this sense  we propose to add an
additional hidden layer to the neural network 
for inputs x  i    we preprocess it and calculate
the new input as sigmoid ux  i     and we also
use backpropagation on the additional layer 
we train the data on the same data set as rica 

q be   p     p  q   i  q      i  q   p  q  
q be   p     p  q 
   
the above equation explains how to inpaint a
point on the boundary of the to be inpainted
region as a function of known image pixels 
to inpaint the whole   we iteratively apply
equation    to all the discrete pixels of  and
advance the boundary inside  until the whole
region has been painted  inpainting points in
increasing distance order from  ensures that
images closest to known image are filled in
first  thus mimicking manual inpainting techniques 
to implement this  we use a fast matching
method which solves eikonal equation 
k   t k     on   with t     on   the
soluion t is the distance map of  pixels to
the boundary 

effect of parameter  
 plays an important in the calculation of cost 
very small values of  provide inadequate
weight to the error term of h  w    for our

data processing in the noisy images we synthesized  we define the to be inpainted region i e  the mask as all black pixels  and
then we train each image with telea algorithm 

iii 

deep rica

i   p   

 

fics     december     

iii 

table    mean squared error of repaired images

results

mean squared error of methods   e  

the following are some of the images after rotation transformations  they show that more
than    degree transformation would be accompanied by too many distortions and occlusion
effects to be of practical usage 
here a is the image rotated upwards by   
repaired by telea  b is the image rotated downwards by    repaired by telea  c is the image
rotated to the right by    repaired by telea  d
is the image rotated to the right by    repaired
by telea  e is the image repaired by linear rica 
f is the image repaired by nonlinear rica  images repaired by deep rica has smaller square
error than linear rica  we are able to generate rather clear image by telea till      image
rotated    is comparatively distorted 

we validate the error rate of repaired images by calculating its mean square error by
m

formula  k x  i   y i  k   comparing to the origi   

inal images 
 

i 

telea

rica

deep rica

   

   

   

iv 

discussion

advantages and limitations

one of the limitations of rica is that it relies
common inner structures of corrupted pictures 
however  in our dataset  noises tend to center
in certain areas  e g  the sky  where disparity information is inaccurate due to far distance  noises of this kind more often than
not bear few similarities  if any at all  in
fact  rica works most effectively on gaussian
noises  which is not a very accurate model of
the reality 
deep rica is a better model with a lower
mean squared error than the linear rica  however  the added complexity leads to a longer
run time  especially for large data sets  in our
data set  training time is still acceptable  telea
algorithm generates repaired images with the
lowest mean squared errors  instead of finding common features in images  this method is
based on local optimization  since an inpainting mask tells the algorithm which pixels correspond to the noises  this method only works
in the predefined region  it is also more costeffective in terms of implementation  inpainting does not need other image information to
train the data sets  it simply repairs the image
based on the image itself  however  in some
cases where noise is undefined  inpainting is
impossible  also  inpainting distance is a parameter that changes with respect to different
image conditions  for large data set  this is
also impossible to tune 
by comparison  rica  which requires no
predefinition of corrupted pixels  has broader
applications  however  in synthesizing  d images with out of plane transformations  telea
may be a better choice 

fics     december     

v 

conclusion

through  d transformation and image restoration process  we are able to generate images
of different orientations and locations  in so
doing  we can acquire data much faster and
more efficiently  for future work  we would
also like to extrapolate images beyond camera
positions  which would be more difficult than
our current interpolated images 

vi 

acknowledgement

we would like to thank mr tao wang  a phd
student at stanford cs department  for helping
us with the project 

references
    ica with reconstruction cost for efficient
overcomplete feature learning  andrew y n 

et  al 
    an image inpainting technique based on the
fast marching method  alexandru t 
    the kitti vision benchmark suite
http   www cvlibs net datasets 
kitti eval stereo flow php 
benchmark stereo
    semi global block matching algorithm
http   zone ni com reference 
en xx help       m    
nivisionconceptsdita 
guid          e af      bba  f  b c da f  
    image denoising and inpainting with deep
neural networks
http   hebb mit edu courses       
lectures xie   xu   chen   image 
  denoising   inpainting   deep 
  neural   networks      pdf

 

fi