decoding neural signals of memory
reinstatement and aective state
stephanie a  gagnon    james e  sorenson    and ian c  ballard 


department of psychology  stanford university  and  neurosciences program  stanford university

final project for cs      machine learning  december         

memory is thought to depend on the reinstatement of patterns of
activity across the cortex that are similar to the patterns elicited
by the original learning experience  according to this model  affective states such as stress might impair certain forms of memory by disrupting or delaying the reinstatement of these patterns 
characterizing the nature of cortical reinstatement under dierent
aective states is thus a critical initial step towards understanding
the neural basis of memory  here  we applied machine learning
techniques to electroencephalography  eeg  data collected during
a paired associate retrieval experiment  when participants were under conditions of relative safety and stress  specifically  we trained
an algorithm on neural patterns representing categories of visual images  and then classified neural signals during memory retrievial to
decode reinstatement of associate categories  additionally  we classified dierent types of mnemonic status and aective states  and
we also find limited evidence that stress may impact memory related
neural activity 
memory retrieval

 

cortical reinstatement

 

stress

 

pattern classification

abbreviations  eeg  electroencephalography  svm  support vector machine

o

ur ability to store and retrieve memories allows us to access knowledge about the past to inform decisions and
actions in the present  the process of memory retrieval is
thought to depend on     the initial formation of a cortical
representation of an event during encoding  and     the cortical reinstatement of these representations later during retrieval      critically  the cortical representations formed at
encoding and later reinstated at retrieval are category specific 
that is  dierent categories of information  e g   faces  places 
objects  are represented by separable patterns of brain activity     
in the present experiment  we examine whether stress  operationalized by threat of shock  might influence memory reinstatement  more specifically  our primary goal was to use
machine learning techniques to assess cortical reinstatement of
category specific information during periods of relative safety
and stress  we first trained a classifier to distinguish categoryspecific  i e   face  place  object  patterns of neural activity
from the eeg signal recorded during the category localizer
task trials  then  we applied this classifier to the eeg signal
recorded during retrieval phase trials in order to assess the relationship between cortical reinstatement of these categories
and memory accuracy in stressful and stress free conditions 
critically  we predict that under conditions of stress  participants will show reduced cortical reinstatement of category
specific information  as a result  our classifier will demonstrate
reduced accuracy under stress relative to safety 
additionally  we investigated whether we could independently classify both aective state and mnemonic status during the test phase  machine learning techniques have been
successfully applied to eeg in a relatively small number of
papers  and it is still an open question as to     what kinds
of states can be classified and     how to best define features
and run a modeling pipeline  our secondary goal was to examine dierent types of feature selection  modeling decisions 
and parameter choices in order to optimize classification performance across three dierent classification tasks 
http   cs    stanford edu 

methods
twenty three paid volunteers     females        years 
m      years  sd      participated after giving informed
written consent in accordance with procedures approved by
the institutional review board at stanford university 
the session consisted of three main phases   a  a learning phase  encoding    b  a test phase  retrieval   and  c  an
image viewing phase  category localizer   during encoding 
images of faces were paired with either object or place associates  at retrieval  participants viewed old and new face
cues while we recorded neural activity with electroencephalography  eeg      channels      hz sampling rate  under conditions of stress  i e   possibility of receiving an electric shock 
and safety  i e   no shock possible   if participants identified
the face as old  they were asked to recollect the paired associate  i e   whether that face had been originally paired with
a place  or an object   after the retrieval phase  participants
performed a separate category localizer task where they were
presented with images of faces  places  and objects and asked
to rate their familiarity with each stimulus 
our goal is to use the eeg signal recorded during the
category localizer task trials to train a classifier to distinguish
category specific  i e   face  place  object  patterns of brain
activity  then  we can apply this classifier to the eeg signal
recorded during retrieval phase trials in order to assess the relationship between cortical reinstatement of these categories
and memory accuracy in stressful and stress free conditions 

data preprocessing  the raw eeg data was detrended with a
high pass filter     hz hamming windowed sinc fir filter  order          and then low pass filtered     hz  order        
data from the four encoding runs were then concatenated into
a single file  next  the data was segmented into epochs     
to      ms relative to stimulus onset  and baseline corrected
      to   ms pre stimulus baseline   channels with spectral
power between    and    hz that were more than   standard
deviations greater than the other channels were replaced with
an average of its neighbors by spherical spline interpolation 
other noisy channels were identified by visually inspecting the
data  and interpolated 
electrocardiogram  ekg  artifact was extracted using the
extended independent component analysis  ica  algorithm of
lee  girolami   sejnowski  annealing rate of       with principal components analysis  pca  dimension reduction to select
the top    components  we identified the component weight s 
that accounted for the variance related to the ekg artifacts
   to   components per participant  see figure   for an example   then  the same method was used to remove component weight s  that accounted for the variance related to
the blink artifacts  e g   component spectral plot highlighted
frontal channels near the eyes  with component weight s  corresponding to blinks in the raw eeg signal   this allows us
to retain more training testing trials by excluding the components of the data contributing to signal  without excluding
the entire trial  data was then re referenced to a common
average 
stanford

cs    

fall     

  

fifeature space  after preprocessing  each trial consists of a
     ms voltage trace  measured in v  corresponding to a
    ms pre stimulus period  and the           ms following
stimulus onset  to decompose this voltage trace into features
for classification analyses  we first decomposed the continuous voltage trace for each channel into five frequency bands
of interest  delta      hz   theta      hz   alpha       hz  
beta        hz   and low gamma limited by our initial lowpass filter        hz   the amplitude component of the signal
was extracted by applying the hilbert transform on the bandpassed signal  we then computed power by squaring the signal
and transforming it to log scale  db   then  we down sampled
the power timeseries for each frequency band into     ms time
bins using an eighth order low pass chebyshev type i filter 

cross validation  we implemented feature selection  fit to the
training data only  to eliminate uninformative features  here 
we tried several types of feature selection  including truncated
singular value decomposition  svd  and univariate feature
selection  which both performed similarly  we also tried recursive feature elimination  but due to the size of our feature
space  this technique was impractical  here  we will focus on
the analyses using univariate feature selection  this method
runs a one way analysis of variance  anova  test for each
feature  and extracts the p value  we then extract some percentage of features with the highest log p value   i e   the
features best able to disciminate between the categories  here 
the percent of features selected did not have a large impact
on generalization performance  with all percentages yielding
cross validated accuracy between        on average  see figure   b  

fig     example ekg ica component plotted for a single
trial  a  and spectral topographical plot  b 

results
classification of visual category representations  our first
goal was to classify the neural representations of the three
visual categories  i e   faces  places  and objects  using the independent category localizer datasets  during a localizer trial 
participants viewed novel images of either a famous face  e g  
jennifer aniston   a famous place  e g   pyramids of giza  
or an object  e g   beach ball   and rated their general familiarity with that image  we labeled each trial as a face  place 
or object  then  for each trial for each participant  we constructed a feature vector containing the first    time samples
for each trial  averaged over     ms bins  spanning      ms in
total   for each scalp channel      total  full scalp coverage  
for the five frequency bands  each feature vector corresponds
to a pattern of neural activation 
we implemented pattern classification analyses to discriminate between face  place  and object trials in python using the
scikit learn package  classification was assessed separately
on each participants data using a    fold stratified crossvalidation procedure  trials from each of the   categories were
randomly divided into k      balanced subsets  preserving
the percentage of samples for each category  the trials from
k   of these subsets were then used for classifier training  and
the held out trials were used as a test set for assessing generalization performance  this was repeated iteratively k times 
we tested a variety of machine learning algorithms  including l  regularized logistic regression and support vector
machines  svm  with a linear kernel  hx  x  i  n b   we also
tried  nd order polynomial kernels and rbf kernels  but a linear kernel provided the best cross validated accuracy   both
of these algorithms yielded qualitatively similar results  here 
we will focus on the results using a multiclass linear svm
 implementation based on libsvm  with a one vs one scheme 
and a penalty parameter c       we selected the penalty
parameter c      to maximize generalization performance 
as shown in figure   a  
to decode neural patterns of visual categories  we first
normalized each feature  then  within each iteration of k fold

 

http   cs    stanford edu 

fig     group accuracy for classification of visual category
representations with a linear svm as a function of penalty
parameter c  a  and percent features selected  b 

with the linear svm  penalty parameter c        one vsone classification  and    fold cross validation  we successfully
classified visual category with     accuracy on average  significantly greater than chance  t             p          see figure   a  for the distribution of classification accuracy across
participants  looking at the group confusion matrix  figure
  b    it appears that classification is best when participants
were looking at images of faces        accuracy   classification was worse for the objects and places  which tended to get
mis classified as places and objects 

fig     group accuracy for classification of visual category
representations with a linear svm  a  and confusion matrix

next  we investigated classification accuracy as a function
of time bin width  more specifically  we trained and tested linear svms on subsets of the channel frequency band features
from specific time bins  e g         ms post stimulus onset 
including time features from       ms and         ms   this
provides us with some intuition about information contained
in the neural signal at dierent points in the trial  e g   the first
    ms post stimulus onset   as well as over specific temporal
gagnon  sorenson  ballard

fiwindows  e g   span of     vs      ms   in general  classification accuracy increased with the width of the time bin for
training testing with svms     fold cross validated   see figure    that is  when more temporal features were included in
classification  generalization performance increased from    
 when training testing on     ms of data at a time  to    
 when training testing on features from the entire      ms  
from these results  it seems that information across the entire
trial  and not some discrete subset  is valuable for discriminating visual stimulus category 

approximately        ms  here  classification of the retrieved
associate category was above chance  but only when a longer
amount of time had elapsed since cue onset  we ran a linear
mixed eects model to examine the eects of stress condition  the linear and quadratic eects of test time  and the
interaction between stress and time on accuracy decoding
reinstatement  this analysis revealed a significant interaction between the quadratic eect of time and stress condition 
        t         p         such that during stress  test time
had a strong quadratic relationship with classification accuracy          t         p          rising above chance for
a shorter time than during safe blocks  in contrast  during safe
blocks the quadratic eect of test time on accuracy was wider 
        t         p         such that accuracy was above
chance for a longer period of time  along these lines  when
training on the first     ms of the category localizer blocks 
there was an overall main eect of stress condition on accuracy  such that safe blocks had marginally higher accuracy
decoding the reinstated associates  relative to stress blocks 
        t        p         

fig     localizer classification accuracy across time bins as a
function of time bin size

decoding test phase neural activity  using the independent
set of category localizer data for each participant  we next
sought to decode cortical reinstatement  during the test
phase  participants were presented with image cues of faces
that were either new  never seen before  or old  learned during the study phase  paired with an object or a place   to
examine cortical reinstatement  we focused specifically on the
trials where participants correctly remembered that a face cue
was old  and were able to retrieve the specific category of associate  e g   the face cue had been paired with the eiel tower 
a place   these trials will be referred to as source hits  additionally  these source hit test phase trials were either under
conditions of stress  i e   threat of shock  or safety  we analyzed source hits from these conditions separately  here  we
were interested in the temporal dynamics of reinstatement 
specifically  a  when during a test trial might we be able to
decode the reinstated memory  and b what time window of
visual category information was reinstated 
first  we trained   way linear svm classifiers on the face
vs  place vs  object category localizer data for each participant seperately  we trained classifiers separately for each
    ms subset of the localizer data with a sliding window
 e g         ms          ms   then  we tested each of these
classifiers on each     ms subset of the test phase data  to
assess cortical reinstatement of the associate image       
classifications  see appendix for full spectrum of classifiers  
this analysis indicated that the first         ms of the localizer data contained information that was reinstated during memory retrieval  that is  when training a linear svm
on category localizer data from       ms or         ms poststimulus onset  this classifier was able to acheive above chance
accuracy decoding reinstatement of a object or a place 
specifically  during safe block trials  classification of the
reinstated image category was above chance starting at approximately         ms post cue onset  and was sustained
until approximately         ms post cue onset  there was a
second peak around          ms that lasted through     
ms  see figure    in contrast  during stress blocks  the rise
to above chance accuracy for reinstatement was delayed by

gagnon  sorenson  ballard

fig     decoding reinstatement across the test trial  trained
on category localizer from       ms

classification of mnemonic status  we next asked the question of whether we could classify mnemonic state using only
data from the test phase  since participants had fairly good
memory performance on the task  we sought to distinguish
between neural patterns during correct rejections  i e   correctly indicating that a face was new   general hits  correctly
indicating that a face was old without recalling the paired associate   and source hits  correctly indicating that a face was
old as well as the paired object or place   we implemented
both regularized logistic regression and linear svms across a
variety of parameter values  our results were roughly consistent across modeling choices  and we present data using
linear svms with c       keeping the top     of the features as determined by univariate feature selection  i e   linear
anova   other modeling procedures were the same as above
unless stated otherwise  we used k     fold cross validation
because this was the largest value we could use in order to be
consistent across all the subjects  who had variable numbers
of trials per label  we successfully classified memory status
       accuracy   which was significantly higher than chance 
t             p        see figure   a  for the distribution of
classification accuracy across subjects 
examining the confusion matrix for this classification
 figure   b    we observed that the classifier was best at distinguishing correct rejections from source hits  and tended to
classify test items as correct rejections too often  we were
concerned that the fewer number of general hits  mean number of correct rejections  general hits  source hits per subject
                    might be biasing results  in addition  general hits and source hits may be more similar to one another 
since the subject is remembering an old stimulus  than correct
rejections where a subject is classifying a stimulus as novel 
stanford

cs    

fall     

 

fiwe re ran the analysis in   separate ways      excluding general hits      combining general and source hits  both resulted
in above chance classification accuracy  we conclude that the
neural representations of the three categories are in fact distinct  and classification is best when separating them 

threat of shock  and to prevent excess motion artifact   we
excluded trials in which participants received a shock  or had
received a shock on the previous trial 
two way  threat vs  safety  aective state classification
was implemented using l   regularized logistic regression  with
univariate feature selection  keeping the most informative    
of features  within    fold cross validation  overall  we had
limited success classifying aective state  a classifier trained
on all eligible trials did not classify trials above chance  accuracy         t             p         see figure    as we
did with mnemonic status  we trained and tested the classifier with data sets of diering size  our results were similar
to figure    indicating that our modeling suered from high
variance but increasing data may oer minimal gains in performance 

fig     classification accuracy of mnemonic status across
subjects  a   confusion matrix  b 

since classification accuracy was close to chance  we examined whether our model suered from high bias or high
variance  to this end  we analyzed training and test accuracy
on subsets of the training data  with between       of the
data held out  figure     we observed that although training accuracy declines modestly with more training data  test
accuracy does improves only slightly  the large gap between
training error and testing error indicate high variance rather
than high bias  indeed  when reducing the number of features used from     to      accuracy increased to       
t             p          

fig     classification accuracy decoding aective state

notably  we had more success classifying stress and safety
when splitting our data into trials from correct rejections 
source hits and general hits  while using a more aggressive feature selection  keeping the top    of trials   here we achieved
classification significantly above chance for source hits  accuracy        t             p         but not for correct rejections  accuracy        t             p         or general hits
 accuracy        t             p         see figure    interestingly  the stress condition impaired source memory retrieval
behaviorally  we hope to examine whether stress classification
accuracy for source trials is correlated with memory performance across safe and stress blocks 

discussion
fig     training vs  testing accuracy by percent of data for
training

finally  we investigated whether stress impacted the ability to classify memory retrieval by constructing separate classifiers for threat and safety conditions  when keeping the top
    of features  we were able to correctly classify memory significantly above chance in both conditions  accuracy threat 
       accuracy safety          classification accuracy was
not dierent between conditions  t            p       
classification of aective state  another goal for the project
was to classify aective state  that is  to decode whether a
given trial was from a stress block  i e   during threat of
shock   or if it was from a safety block  i e   no threat of
shock   data used for decoding aective state came exclusively from the test phase of the experiment  eeg signal
from the first      ms of each source hit  general hit or correct rejection trial was preprocessed in the manner described
above  to specifically examine stress related to anticipatory
 

http   cs    stanford edu 

overall  we had success with our primary goal  to classify the
reinstatement of visual category information from neural signal during memory retrieval  this consisted of two steps     
decoding neural representations of stimulus category based on
visual input  and     detecting the reinstatement of these visual categories during the memory retrieval test phase  first
we were able to classify image category  face  object or place 
from neural signal related to visual input when participants
were viewing images during the category localizer  we achieved
above chance accuracy for all subjects using both linear svms
and l  regularized logistic regression  here  temporal features
proved important  as more temporal features were added  classification accuracy increased 
secondly  we were also able to train a classifier on this
category localizer data  and use it to successfully classify the
category  object vs  scene  of reinstated associate images during the memory retrieval task  notably  during retrieval  any
information participants had about the objects and scenes was
internally generated from memory  the success of our classifier therefore indicates that during retrieval  participants reinstated representations of associate visual category  objects
and scenes   that were similar to those representations present
during the viewing of these images  here  classification of regagnon  sorenson  ballard

fiinstated memory category was above chance when training on
the first     ms of localizer data  this suggests that neural activity related to stimulus visual category during recall is most
consistently similar to neural activity during the initial stages
of visual stimulus processing  because previous eeg work has
shown neural activity in the first     ms to be related to basic
attention and perceptual processes  our findings would seem
to indicate that the category information reinstated during
recall may share some overlap with neural processes related
to visual perception 
we had somewhat less success classifying mnemonic status
and aective state  first  when classifying mnemonic status 
a linear svm classifier was best at distinguishing correct rejections from source hits  and tended to classify test items
as correct rejections too often  overall  however  we were
able to successfully classify mnemonic status  secondly  we
were only able to classify neural representations of stress vs 
safety on trials where participants correctly recalled source
information  i e   source hits   this result may be related to
a behavioral eect in which stress selectively impacted participants memory for source information  our results also
indicate that neural activity related to aective state may be
more heterogenous than activity related memory and visual
perception 
analyses varying the percent of data used for training
on accuracy indicated that our modeling of mnemonic status and aective state suered from high variance  testing
on human subjects limits the amount of data that can be
acquired  so constraining feature selection is likely the most
critical step for optimizing classifier performance  indeed 
our modeling choices of classifier algorithm  svm  logistic regression   penalty parameters  and feature selection algorithm
 linear  svd   did not have a large impact on performance 
varying the percentage of features included was important for
mnemonic and aective state processing  although not for vi 

sual classification  since eeg data is correlated across space
and time  devising ways of decomposing the feature space is
critical  a promising first step was to examine the classification accuracy across dierent time bins in the trial  determine
where in time the most informative features were  and retrain
the classifier on just that time window  this analysis allowed
us to successfully classify reinstated associations based on a
classifier trained on category localizer data  other methods
for constraining the feature space  such as examining accuracy as a function of frequency band  are promising avenues
for future work 
the main contribution of this project is demonstrating
successful classification for three dierent problems  memory
reinstatement  memory status  and aective state  additionally  we identified that our models suered from high variance
and explored a variety of modeling choices and feature selection methods to reduce this problem  we determined that
strategies for reducing the feature space will be particularly
important  especially when it is not possible to collect large
datasets  in particular  we developed a technique for limiting
feature space to informative time bins which may be of broad
use to eeg classification problems  taken together  our results indicate the potential for machine learning techniques to
decode neural representations from eeg data  it will be exciting to examine the nature of the representations decoded 
their frequency  spatial location  and temporal latency  in order to characterize the underlying neural mechanisms 

   gordon  a  m   rissman  j   kiani  r     wagner  a d   in press   cortical reinstatement mediates the relationship between content specific encoding activity and
subsequent recollection decisions  cerebral cortex 

appendix  test phase classification accuracy for reinstatement  object place 

acknowledgments  this experiment was conducted in the stanford memory
laboratory  advised by anthony d  wagner  and supported by a grant from the john
d  and catherine t  macarthur foundations law and neuroscience project to adw 
sg is supported by a national defense science and engineering graduate  ndseg 
fellowship and a stanford graduate fellowship  sgf   ib is supported by the national science foundation graduate fellowship  nsfgf   we thank alex gonzalez
for assistance with eeg time frequency decomposition 

   polyn  s m   natu  v s   cohen  j d     norman  k a          category specific
cortical activity precedes recall during memory search  science                 

gagnon  sorenson  ballard

stanford

cs    

fall     

 

fi