game on  predicting english premier league match
outcomes
aditya srinivas timmaraju
stanford university
adityast stanford edu

aditya palnitkar
stanford university
aditpal stanford edu

vikesh khanna
stanford university
vikesh stanford edu

abstract
among the different club based soccer leagues in the world  the english premier
league  epl   broadcast in     territories to     million homes  is the most followed  in this report  we attempt to predict match outcomes in epl  one of the
key challenges of this problem is the high incidence of drawn games in epl  we
identify desirable characteristics for features that are relevant to this problem  we
draw parallels between our choice of features and those in state of the art video
search and retrieval algorithms  we demonstrate that our methods offer superior
performance compared to existing methods  soccer pundits and the betting markets  we also share a few insights we gained from this interesting exploration 

 

introduction

the most popular soccer league in the world is the english premier league  epl   which is based
in england  it was watched by an estimated figure of     billion people in the         season  so 
it doesnt come as a surprise that the tv rights are valued at   billion per season  in epl  there
are    teams that contest for the first place  the bottom three teams are relegated and replaced by
other teams from lower leagues who perform better  each team plays every other team twice  once
at home and once away  so  there are a total of             c    games per season  a season runs
from august to may of the following year 
   

challenges

one of the things that makes predicting outcomes tricky is the significant incidence of draws  neither
team wins  if they both score the same number of goals  as compared to other sports  most popular
games viz   tennis  cricket  baseball and american football either have no draws or very few draw
occurrences  consider this   out of the     games in the         season      games were won by
the home team      games by the away team and there were     draws  to put these numbers in
perspective  we calculate the seasons entropy  we regard home wins     away wins    and drawn
games    as three separate classes and compute the fraction of each of these outcomes 
p            p            p           
since  we have a   way classification  we use the base   logarithm 
entropy    p   log   p      p   log   p      p   log   p             
an entropy of   would correspond to a perfectly random setting  p         p         p         
so  considering this  a random prediction would give an expected accuracy of         another
naive  but a marginally better approach would be to predict a home win always  which would deliver
 

fi       accuracy  about the average fraction of home wins in epl   these are however  not very
good numbers 
   

prior work

in      a bayesian dynamic model is built  but there are many parameters and the authors do not
justify the choice of their values  which may not work well with other testing sets  also  out of
the    epl games they bet on  they won on only    games      their primary focus is towards
computing pseudo likelihood values for betting on match outcomes  in      the authors specifically
choose to focus on predicting match outcomes of a single team   tottenham hotspur  also  their
model is dependent on the presence of particular players and is thus  by their own admission  not
scalable  there is no standard way of reporting results for this problem  most authors do not mention
prediction accuracy directly  some specify precision recall and some others specify geometric mean
of predicted probabilities of correct classes  called pseudo likelihood statistic  pls   we report
the accuracy of predictions  precision recall as well as pls  we compare the performance of our
algorithms on all these fronts and show a marked improvement 
the remainder of the report is organized as follows  section   discusses the choice of features 
which we feel is a key step  in section    we give a description of the approaches we have taken
towards addressing the problem  section   describes our results  in the remainder of the report  we
use the words match and game interchangeably  by convention  in a vs  b  a is the home team
and b is the away team 

 

selection of features

we first identify the most relevant performance metrics  goals  corners and shots on target  goals
are an obvious choice as they determine which team wins  as for corners  a higher number of corners
indicate a team playing well  and thus enforcing a corner kick from the opponent  shots on target
convey the number of times a shot taken was on target  including those stopped by the keeper   we
consciously did not pick possession percentage  because some teams just have a more possessive
style of play than others  and moreover  higher possession percentage does not necessarily imply
better performance  so  our performance metric vector for a game is a   element vector of the form
 goals scored  corners  shots on target  
we recognize three important characteristics for a feature  it should 
 incorporate a notion of the competing nature  between teams  of the problem
 be reflective of the recent form of a particular team
 manifest the home advantage factor
 capture the improving declining trend in the relative performance of competing teams  i e  
has team a been on the rise more than team b  has team b slumped in form more than
team a  
keeping the above characteristics in mind  we propose the following choice of features  we progressively arrived at the above list and so  the first choice below does not capture all these properties  
   

kpp  k past performances 

in kpp  we use the performance of a team in the last k games to determine our prediction  in the
game a vs  b  we first take an average of each performance metric of team a in the last k games to
arrive at pa   if g    g    g    g         gk   is a vector containing the number of goals scored in each of
k 
  similarly  we arrive at cavg and stavg for corners
the last k games  we have gavg    g   g       g
k
and shots on target respectively  thus  we have pa    gavg   cavg   stavg   
 

fisimilarly  we arrive at pb   we then take the ordered difference pa  pb   a   element vector  as our
feature  the ordered difference is chosen to inherently include information about which team is
playing home and which team away 
   

tgkpp  temporal gradient k past performances 

in tgkpp  as in kpp  we first arrive at the   element vector pa  pb   now  consider the performance
metric  say goals scored  vector for team a in the past k games  denote it as g    g    g    g       gk  
we now apply a temporal differencing operator on this vector  which is essentially a convolution with
a filter of the form dif f           we now have
gda   convolution g  dif f      g   g    g   g         gk  gk   
we do this for the other performance metrics and compute cda and stda   we repeat this process for
team b and arrive at gdb   cdb and stdb   then  we compute
pdif f     gda     gdb     cda     cdb     stda     stdb   
where    indicates the standard mean of elements in a vector  thus  our final feature vector is a
  element vector of the form  pa  pb   pdif f    this feature is similar to the video fingerprint in
     where spatial and temporal gradient are applied to blocks in a frame of video  we have used the
website http   www football data co uk  for obtaining our data 

 

approaches taken

we first toyed with the idea of using naive bayes  but found that independence is a very strong
assumption in this problem  also  we did not try using gaussian discriminant analysis because our
data was nowhere close to being normally distributed  owing to space constraints  we have omitted
including figures that showed this  we used multiple variations on multinomial logistic regression
and support vector machines 
   

approach  

the first approach we took was using multinomial logistic regression  since there were more than  
possible outcomes   in this approach  during the training phase  we only considered the performance
metrics derived from the current match  rather than taking the average over the last k matches 
during testing  suppose we are required to predict the match outcome of team a vs team b  we
arrived at the feature vector using kpp 
   

approach  

in the second approach  we trained in the same way we would later test the data  more precisely 
in the training phase too  instead of using the feature vector as the performance metric vector
corresponding to the current match  we used kpp  this meant that the trained parameters now
inform our beliefs about the result of a match based on the performance in last k matches  in this
approach  we also used tgkpp instead of kpp and evaluate our approach 

   

approach     using teamwise models

so far  all approaches we tried would find a global set of parameters  which were independent of
the competing teams  so  given the past k performances of the team playing home and the team
playing away  our model was agnostic to the identity of the actual teams playing  however  we felt
we maybe missing out on some team specific trends using this method  so  in this approach  we
trained different models for different teams  however  this approach placed a limitation on the data
 

fitable    mlr with approach  
season

k value

accuracy

       
       

 
 

     
     

table    prediction accuracy  kpp   tgkpp
season

k

mlr kpp 

rbf svm kpp 

mlr tgkpp 

rbf svm tgkpp 

  class  rbf svm 

       
       
       
       

 
 
 
 

     
     
     
     

     
     
     
     

     
     
     
     

     
     
     
     

     
     
     
     

we could use to test train our model  we could no longer combine data from two different seasons 
due to the form of the teams varying between seasons  and major players being traded between
teams  so  due to the limited data  and the increased noise induced by increasing the granularity in
the model  we ended up getting a lower accuracy  an average of      

 

results and discussion

we train all our models on the         season and test on the          current  season  table   contains the prediction accuracy  in    obtained using mlr with approach    figure  
contains the learning curves for the two algorithms  mlr and rbf svm  our definition of k
imposes a restriction on starting point for testing  for k            we test on               
number of games respectively  table   contains the prediction accuracy  in    obtained using
approach   with mlr and rbf svm  the last column of table   contains accuracy obtained
using only home win and away win classes  disregarding the draws  basically  if c is the confusion matrix  we truncate the  rd p
row and  rd column to obtain ctrunc   we then compute
 classaccuracy   trace ctrunc    i j ctrunc ij   we computed this because we felt it would
offer a fair metric for comparing against accuracy in other sports which do not have the concept of
drawn games 
as our problem is a   way classification  there is no positive and negative class demarcation  so 
while computing them for the home wins class  we regard both the other classes as negatives 
table   lists the precision and recall values  while the precision of drawn games is fairly okay 
it is evident our method misses out majorly on recall value for draws  under estimating draws is a
problem with the existing methods too 

 a 

 b 

figure    accuracy vs training set size  for k     a mlr  b rbf svm
 

fitable    precision and recall with rbf svm  tgkpp and k   

precision
recall

home win

away win

drawn game

     
     

     
     

     
     

table    confusion matrix  tgkpp and k   

actual home wins
actual home losses
actual draws

predicted home wins
  
 
 

predicted home losses
 
 
 

predicted draws
 
 
 

in      the authors propose a metric which is computed as the geometric mean of the predicted
probabilites of actual outcomes  they call it pls  pseudo likelihood statistic   they obtain a pls
of       for epl  in      the best value of pls obtained is          in comparison  our average pls
value is         with a maximum of        with k   using mlr and tgkpp  in      the authors
report their results in the form of a confusion matrix  but they do not predict drawn games at all 
our method offer superior performance than     too  we also considerably outdo the accuracy of the
probabilistic model in      which reaches an accuracy of       for         and                
in comparison to our best accuracy of         the accuracy of expert pundits like mark lawrenson
of bbc is            also  we outperformed the accuracy of betting markets which averaged      
last season      suggesting possible avenues for making money 
the results we obtained  while interesting and significant in their own right  also offered interesting
insights into the match data we analysed  though our results using approach   were not encouraging 
we found a striking trend  since we have two models  we are faced with a choice  if a   b are the
teams competing  should we use a or b for prediction  or should we always use the home teams
parameters  we observed that using away for prediction always does better as compared to using
home   in hindsight  we may be tempted to interpret that using away does better because there is
more variability in an away teams performance  and so that gives us more information  but a priori 
we might as well have thought that home performances are more consistent and so a better predictor
would use home  

 

references

    rue  havard  and oyvind salvesen  prediction and retrospective analysis of soccer matches in a league
journal of the royal statistical society  series d  the statistician                       
    joseph  a   norman e  fenton    martin neil  predicting football results using bayesian nets and other
machine learning techniques  knowledge based systems                      
    goddard  john  regression models for forecasting goals and match results in association football  international journal of forecasting                      
    crowder  m   dixon  m   ledford  a  and robinson  m          dynamic modelling and prediction of english football league matches for betting  journal of the royal statistical society  series d  the statistician  
            doi                          
    constantinou  anthony c   norman e  fenton  and martin neil  pi football  a bayesian network model
for forecasting association football match outcomes  knowledge based systems        
    www pinnaclesports com online betting articles         lawrenson vs pinnacle sports aspx
    oostveen  job  ton kalker  and jaap haitsma  feature extraction and a database strategy for video fingerprinting  recent advances in visual information systems               

 

fi