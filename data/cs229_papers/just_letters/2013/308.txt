learning to identify winning stocks
avinash balachandran  durgesh saraph and erjie ang
december         

 

introduction

choosing stocks that improves on the widely used f score
strategy  our key response variable of interest is the return
on a portfolio of value stocks  which is the same as in piotroski         in our model  we will use continuous versions
of the nine variables from the f score as predictors to account for more robust relationships between the predictors
and portfolio returns  in addition to the f score variables 
we used the levels and changes in financial statement variables related to profitability  leverage  and liquidity that we
believed to be predictive of future returns  specifically  we
include additional measures of profitability such as gross
margin  sales turnover  cash balance  liabilities  holdings
and sale of property and investment and accounts receivable  our machine learning methods will also be calibrated
using historical financial data as well as returns  rather than
only using current and previous year data like in the f score
strategy  we find that both the use of historical data for
calibration and the inclusion of additional variables substantially increase the portfolio returns from our trading
strategy 

value investing is an approach to investment decisions
that relies on buying stocks that trade at a market value
below their intrinsic value and selling stocks that trade at a
market value above their intrinsic value  benjamin graham
and david dodd were early proponents of the paradigm 
and it was made famous by warren buffett  the intrinsic value of a companys stock is the value determined by
estimating the expected future cash flows of a stock and
discounting them to the present  this value is represented
as the book value on financial statements  it is distinct
from the market value of the stock  which is determined by
the companys stock price  the market value of a stock can
deviate from the intrinsic value due to reasons unrelated
to the companys fundamental operations  such as market
sentiment 
one major risk involved in value investing is the existence of value traps in the market  a value trap is a stock
that trades at a discount to its intrinsic value due to significant strategic or operational weaknesses in the company 
for example  a company trading at a relatively low market
value may be unable to grow its revenues  compete effectively in its target market  or operate efficiently  it is easy
for investors to confuse value traps for genuinely promising investments  because like value stocks  a value trap also
trades at a market value that is below its intrinsic value 
i e  they have a high book to market  bm  ratio 

the rest of this report is arranged as follows  section  
will describe the financial data sources used  sections   and
  will describe the f score strategy and how it was used to
construct the porfolios and annual returns that will serve
as our benchmark  section   describes how we construct
training and test sets for calibrating and testing our machine learning methods  we conclude and discuss further
extensions of this work in section   

to mitigate the risk of value traps  investors can use
accounting based fundamental analysis to select stocks from
financially strong companies  piotroski        finds that
the mean annual investment return on a portfolio of companies with high bm ratio can be increased by at least
     using a simple nine point score of financial strength
calculated based on accounting fundamentals  the choice
of portfolio mix is determined by using piotroskis f score 
which assigns a company one point for nine criteria related
to profitability  leverage liquidity  and operating efficiency
that can be derived from the balance sheet 

 

data and variable selection

our data is obtained from the compustat and crsp financial databases that are available on bloomberg machines
found on campus  compustat contains all the quarterly
financial reports of publicly traded firms in the us  the
crsp data set contains the daily closing price of all publicly listed firms  our data set comprises of the quarterly
financial reports and daily closing prices of all publicly listed
firms between the years of      to      inclusive 
we obtain quarterly financial statement data for publicly
traded firms from compustat and data on stock returns and

in this project  we propose the use of more advanced machine learning techniques to develop a predictive model for
 

fitrading volume from the crsp database  our data sample
comprises of the quarterly financial reports and daily closing
prices of all publicly listed firms between the years of     
to      inclusive 

lated  for example  if we calculated an f score for ibm
in december       we will use the stock price of ibm in
april           the reason we used this date is because by
that time  previous year financial reports of all firms will be
available to investors  and they can trade using information
we run principal component analysis  pca  on the lev  from these reports 
els and changes of all variables in our sample  we find that
the first two pcs explain only     and the first ten pcs
since we only consider long positions in stocks  we begin
explain     of the variation  and we decide not to use pca building our portfolio by ranking firms by bm and only conin our analysis 
sidering firms in the top quartile of this category  within
this high bm group  we pick the companies with the highest f score to build our portfolio  hence  we rank these
  f score strategy
firms by f score and take the firms in the highest decile to
form our portfolio  based on the prices of these firms in
using the data set described in section    we can recre  the current year and the subsequent year  we calculate the
ate the f score strategy as follows  using only the last return of the portfolio assuming equal investments in each
quarter in a firms financial year in our data set  the f  company in the portfolio  this return is used as the metscore assigns a company one point for each of the follow  ric to evaluate each method  the benchmark return used
ing nine criteria related to profitability  leverage liquidity  to compare the efficacy of the machine learning approach
and operating efficiency  positive return on assets  roa  is the return obtained using the basic f score strategy as
in the current year  positive operating cash flow  cfo  in outlined above 
the current year  higher return on assets  roa  in the current year compared to the previous year  cfo being greater
model construction and testing
than roa  lower ratio of long term debt to total assets in  
the current year than the prior year  higher current ratio
this year than the previous year  no new share issuance in
to improve on the f score strategy  which uses a limthe previous year  higher gross margin this year than the ited set of binary variables  we will use prediction models
previous year  no new share issuance over the year  higher that use real valued variables as our predictors  in the first
gross margin this year than the previous year  and higher test  the prediction models are built using only real valued
asset turnover compared to the previous year 
versions of the nine f score variables  in the second test 
the predictors are expanded to include additional fundamental variables as presented in the previous section  the
  creating a portfolio
three prediction models used are linear regression  logistic regression and support vector machines  svm  
in order to test the efficacy of the machine learning approach as compared to the f score strategy  a metric is
since we have cross sectional and time series panel data 
needed to evaluate each approach  the most intuitive met  we use a rolling window version of cross validation to test
ric to use is yearly portfolio return  in essence  an optimal our predictions  first  we choose the length of the traintrading portfolio is created for each method per year  and ing window  for example two years  this means that the
the portfolio return for that year is used as the evaluation prediction model is trained on two years of financial data 
metric 
the trained model is then used to predict the the share
price returns of firms in the year immediately following the
selecting the stock price that is used to build this portfo  training window  for example  if we use data from      and
lio is challenging as all firms do not release their quarterly      for training  data from      are used for prediction 
reports at the same time for the same quarter  therefore  in the next cross validation step  we move our training winthe stock price used to calculate quantities like bm must dow one year into the future to include      and       the
take into account the quarterly report release dates  for ex  trained model then uses      data to generate predictions 
ample  we cannot build our portfolio using the stock price so on and so forth  in total  we generated predictions for
on    december      while calculating an f score based on years ranging from      to      by moving our training
a quarterly report released on   jan      as investors will and testing time periods across time  at the same time 
not have all the information required on    december      the length of the training windows used are varied between
to build their portfolio  in order to overcome this  we look one and four years 
specifically at the stock price of each company on april   
of the year following the year when its f score was calcuin linear regression  the response variable is the return of

fithe stock over the following year  our portfolio is formed by
including only firms from the top decile of predicted returns 
for logistic regression and svm  all the response variables
in our training sets are re coded into a binary variable we
call class  a value of   is assigned to class for a firm if the
actual returns of that firm are in the top decile of the actual
returns of all firms  otherwise  class is coded as    logistic
regression and svm models are trained using this re coded
variable as the response  the predictions output from these
models are the probabilities of whether each firm belongs
to the group of high return firms  the portfolio for the test
year is then formed by including only firms with predicted
probabilities that are in the top decile amongst all firms
available in that year 

 

results

ables more than   year in the past results in the addition
of variables that are no longer valid to predict a companys
return  this points to the fact that there might exist an
expiration date of the usefulness of the   f score variables for predicting returns  however  from figure    we
see the addition of more variables seem to counteract this
expiration  this could mean that the additional variables
could contain signals from earlier years that are not captured by the   f score variables 
effect of using more variables  figure   shows the annual returns for the three different machine learning techniques used and for the two cases of using only f score
variables and using all the variables  we see that in the
case of linear regression  using only f score variables results
in higher annual returns  also seen in table     however 
the standard deviation is higher indicating that using more

return    

as discussed in section    we varied our portfolio construction method by varying the model used  linear regres   
piotroski fscore  baseline 
sion  logistic regression  svm   the length of training winlinear  win     
dow used    to   years  and the number of variables used 
logistic  win     
   
svm  win     
table   summarizes the mean and standard deviation of the
   
predicted returns of the portfolio formed from           
in general  we see that the portfolio returns in all our tech   
niques have higher means than the f score strategy  baseline   however  only the svm techniques have standard
  
deviations close to the f score strategy  this means that
only the svm technique allows us to generate less volatile
 
returns over the period of interest  another trend is that by
including more variables  the standard deviation in returns
  
    
    
    
    
    
    
can be significantly reduced  figure   shows the annual reyear
turns for all the methods using only f score variables and
a window of   year  figure   shows the annual returns for
all the methods using all variables and a window of   year 
figure    annual returns for all techniques  f score variin the next few sections  we discuss the results generated
ables 
by each machine learning model individually 

linear regression

in general  linear regression resulted in mean returns that
were higher than the f score strategy  baseline   however 
the standard deviation in these returns is much higher than
the f score strategy  baseline   this implies that while linear regression results in higher average returns  they are
riskier strategies  we also investigated the change due to
window length variation and data set size 

   

   

piotroski fscore  baseline 
linear  win     
logistic  win     
svm  win     

   
return    

   

   

  

 

effect of different window length  figure   shows the
  
annual returns for linear regression using only f score vari    
    
    
    
    
    
ables with different window lengths ranging from   to  
year
years  we see that using a longer window results in a worse
prediction  this implies that the variables used in the fscore calculation have an expiration  therefore  using vari  figure    annual returns for all techniques  all variables 

fiall strategies
technique
window
linear
 
linear
 
linear
 
linear
 
logistic
 
logistic
 
logistic
 
logistic
 
svm
 
svm
 
svm
 
svm
 
f score strategy  baseline 

f score variables
mean
stdev
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

all variables
mean stdev
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

table    mean annual portfolio returns     and stdev for all strategies used
variables in the prediction results in a less risky portfolio
building strategy 

   

   

logistic classification

   

   
return    

logistic classification generally resulted in mean returns
that were higher than the f score strategy  baseline   however  similar to linear regression  the standard deviation in
these returns are much higher than the f score strategy
 baseline  

piotroski fscore  baseline 
linear  win     
linear  win     
linear  win     
linear  win     

   

  

effect of different window length  for the cases where
 
we only used the f score variables  changing the window
length does not have any clear trend on the returns  see
  
table     the variation in mean returns is under     how    
    
    
    
    
    
    
    
year
ever  for the cases of using all variables  increasing the window length results in an increase of the mean return  either
way  the standard deviation based on the chosen technique
figure    annual returns for all windows  f score variis higher than the f score strategy  baseline  
ables 
effect of using more variables in figure    we see that
in the case of logistic classification  using only f score variables results in higher annual returns  also seen in table    
however  the standard deviation is higher indicating that
using more variables in the prediction results in a less risky
portfolio building strategy 

support vector machines

   

piotroski fscore  baseline 
linear  win     
linear  win     
linear  win     
linear  win     

   
return    

   

   

   

  

in general  svm resulted in mean returns that were
higher than the f score strategy  baseline   however  unlike
the other methods used  the standard deviations in return
for the smaller window sizes were comparable to that of the
f score strategy  baseline  
effect of different window length  changing the window length for the case of using just the f score variables

 

  
    

    

    

    

    
year

    

    

    

figure    annual returns for all windows  all variables 

fi   

   
piotroski fscore  baseline 
linear  fscore variables 
linear  all variables 

   

   

   
return    

   

   

   

  

  

  

 

 

 

  

  
    

    
year

    

piotroski fscore  baseline 
logistic  fscore variables 
logistic  all variables 

   

   
return    

   
return    

   
piotroski fscore  baseline 
svm  fscore variables 
svm  all variables 

  
    

    
year

    

    

    
year

    

figure    annual returns  f score variables vs all variables 
and using all variables resulted in changes in the mean returns and the standard deviations  increasing the window
size resulted in higher mean returns  however  no clear
trend is discernible between window size and standard deviation of returns 

that despite its relatively uncomplicated methodology  the
f score strategy  baseline  does very well  this is because
it builds a strategy by analyzing the fundamental financial
strengths of companies  future work should focus on how
to incorporate fundamental financial understanding of companies into the machine learning techniques proposed 

effect of using more variables  from figure    we see
that in the case of svm  using either f score variables or
references
all variables results in comparable returns and standard de   
viations  also seen in table     therefore  the change in
variable sets did not result in a big change in performance  piotroski  j d         value investing  the use of historone important thing to note is that using a window of   ical financial statement information to separate winners
years  we were able to have a standard deviation compa  from losers  journal of accounting research     pp     
rable to the f score strategy  baseline  while still having a
higher mean return  this implies that this particular case
actually beat the f score strategy  baseline  mean return
while having comparable risk 

 

conclusion

our results suggest that as expected  a strategy that gives
higher mean returns also results in higher standard deviation in returns  or risk   also  we note that including more
variables in the learning algorithm results in lower standard
deviation in the returns and hence results in a lower risk investment strategy  all our strategies have higher mean returns than the f score strategy  baseline   however  most
of them also have higher standard deviation  two of our
strategies  namely using an svm with a window length of
two years  result in better mean returns than the f score
strategy  baseline  while also having comparable standard
deviations  therefore  these two methods beat the f score
strategy  baseline   however  it is also important to note

fi