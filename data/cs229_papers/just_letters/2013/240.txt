humanmobilitypatternpredictionalgorithmusingmobile
devicelocationandtimedata
myungjunchoi yonghyunro hanlee

  notations
n numberofstatesinthemodel
t lengthofobservationsequence numberofstatetransitionsperday 
xt thestateinwhichtheuserisattimet
yt theobservationsymbolobservedatinstantt
i p xo i  theprobabilityofbeinginstateiatthebeginningoftheeachsequence
q     qij    where qij   p  xt     j   xt  i  thetransition matrix theprobabilityofbeinginstatejat
timet  giventhatuserwasinstateiattimet
p yt xt j  emissionprobabilityofobservationgiventhatuserisinstatej
i themeanvectorofeachstate
 thecovariancematrixofeachstate
  q i  i  ourhiddenmarkovmodel
  motivationandgoal
advent of smartphones enabled us to use gps  information for personal use  in addition  law
enforcement are utilizing nextgeneration technology  and applications monitor known targets
and identify suspects to predict their behavior and prevent attacks before they take place  in
order to implement these applications  it is necessary to track the movementsofmobileuserin
realtime or over a defined time period among mass location  mobile users mobility patternisa
hidden  markov model hmm    because we do not get to observe the  actual sequence of
states the location state   we can only observe the measurements location coordinate data 
generated by each state  hence  we designed the algorithm to predict mobile user mobility
pattern usingmachine learning algorithmandhmm werelaxeddataandourgoalwastopredict
thebestestimateofstatesequence 

  modeldescription
   introductionofmodel
mobile users mobility pattern isa hidden markov model  because we do not get to observe the
actual sequence of states   the location state    we can only observe the measurements  
location coordinate data   generated by each state specifically  if we projected an uniform grid
onto the region of interest like figure  a and each grid stands for each state  every single
different colored points tell us the coordinate of position of mobile device through gps or any
other navigation aids  but in this region the values of  the states are unobserved when we
observed location measurement  that is  we do not know which grid contains the specific
measurementbeforewelabelit 
 

fifigure  a anexampleofhumanmobilitypattern plotshowsasequenceoflocationmeasuredat
differenttimes t from to  measurementsateachtimefollowgaussiandistribution b anexampleof 
states measuredat differenttimepointsrepresentedbydifferentcolors x ycoordinatesareshownon
x yaxis eachstatecouldrepresentlocationsofhome work library shopping etc 

hence  if we measure  dimensional position data at every hour ofadayforconsiderabledays 
we can have a series of observed measurements which follows markov property withoutstate
assignment 

   modelparametersforhiddenmarkovmodel
if we  are given the data set  we have to specify which  parameters we have to find based on
hidden markov model  as we mentioned earlier  human mobility pattern followsmarkov property
whichthenextstatedependsonlyonthecurrentstateandtheequationisgivenbelow 
p xt   x  x  x     xt  p xt   xt wherextisthestateattimet
since our purpose is to build the maximum likelihood mobility pattern parameter modelin order
to find the optimalstatesequenceand theprobabilityofanobservedsequence wehave tolearn
values for the hiddenmarkovmodelsparametersandapplythattotheprobabilityofanobserved
sequence fromfigure  wecanrepresenthiddenmarkovmodelparametersgivenas 
t

 p  x   x        xt     p  x    p  xt xt  p  yt xt 
t  

where yt isthemeasurementattimet
p  x   x        xt   isprobabilityofseriesofstate
p  x   isinitialstateprobability
p  xt xt   isstatetransitionprobability
p  yt xt  isemissionprobability measurementprobabilitydistributionatgivenstate 

 

fifigure 
especially  state transition probability can be extended to the state transition probability matrix
givenasfigure  

figure 
hence   we will  learn the above parameters which are  state transition probability matrix  initial
probability and emission probability from the given data set and construct a human mobility
patternmodel 

   modelassumption
i mobilitypatternisacontinuousoutputhiddenmarkovmodel
ii humanmobilitypatternisnotstationarysothatweassumethereare differenttransition
matricesandinitialstateprobabilitieswithrespecttotime see  trainingdatasetrelaxation 
iii themeasurementsdrawnfromeachstateisthegaussiandistribution
iv timestepis hrandmeasurementsatsametimeofdifferentdayistimesynchronized
v themeasurementsarenotamixturegaussianmodel

   challenges
practically  we have to collect measurement datasetthatcorrespondsexactlytoourmodeland
learnparametersandapplyparameterstomaximizeoptimalstatesequenceprobability thereis
a publicly released real measurement data set from microsoft  the data set is stored in a
relational database and we processed to  extract  data from db file using mksqlite which is
matlab based sql query but after looking up the data  we cannot use thedatasetinitsform
directly because not every movement recorded on each day occurredatexactlythesametime 
for example  the timethatapersonsgpslocationgetsrecorded canoccurat    ononeday 
and at      on another day  and so on  therefore wehavetorelaxandmodifythetraining data
settobeabletousethisdatasetwithourmodel 

 

fi  trainingandtestdatasetrelaxation
humans mobility pattern is not stationary  but time dependent  specifically  people are usually
stationary at  home during sleeping time until they are  heading for workplace  during day time 
people are usually staying intheir workplace sometimes theygooutforlunchorshopping and
they go to gym after work  based on   divisions of humanactivitypattern hence wesplitinto 
blocks of sequencesspecifically  based on general human activity  wedivide  hoursinto am
to  pm with length of      pm to  pm with length of     pm to  amwith length of    figure   
we  used a training data set that is publicly released by microsoft  however  each geographic
data in the data set had a very granular time distribution in the unit ofseconds forthepurpose
of  simplicity to be used in our model  weperformed data set relaxation to an hour interval from
the seconds  hence  the movement of one user in a single hour will be funneled down into a
single point  total number ofeach blocks sequence can be varied bythe user  therefore  we
defined three differenttransition matrices q with respect to time division  we have defined total
of four states in this dataset fromthisdatasetwecancomputethreedifferentinitialprobability
i as well  lastly  we also have to obtain mean of each state and corresponding covariance
matrix because the measurement is two dimensional  so multivariategaussiandistribution we
call thisinitialmodel     q i   i   afterobtainingrelaxedoutputmeasurements weapplied
measurements to our mobility pattern prediction algorithm and adjusted result model   which
maximize the probability of state sequence and observation sequence  in order to validate that
thealgorithmisagoodestimatorofourreferencemodel 

lengthofeachsequenceperdayare      
totalnumberofeachsequenceis   days
totalnumberoftrainingsetare            

figure 
totaldatasequenceis   daysand   ofdataistrainingdatasetand   ofdataistest
datasettovalidatetheperformanceofthealgorithm whilerelaxingmeasurementdata wealso
 

fifiguredoutthestatevariablesimultaneously inordertocomparehowmanystatesequence
variableisdifferfromthestatesequencevariableproducedbyviterbialgorithmlater 

  algorithmimplementation
the features of our training data set is   dimensional position coordinate and time  from this
data set  we  estimate all parameters we need for maximizing optimal sequenceprobability we
wanttoknow ouralgorithmstartsfromthispoint 

   algorithmprocedure
i giventrainingdataset calculatetheinitialprobabilitiesandtransitionprobabilities

 the method to identify the hidden state of each measurements is using kmeans
algorithm 
kmeansalgorithmclustersdatapointsinordertomakeneighbordatapointsclustered
samestatevariable


theinitialmodel    parameterequationsaregivenbelow 

ii  now we shall assume that an initialhiddenmarkovmodelisknownfromstepi  andmaximize



   
p  x   x        xt       p  y  y        yt     by adjusting the parameters of     q  i   i  through
em expectationandmaximization algorithm 
thisemphaseusesdynamicprogrammingwhichisforwardbackwardprocedureandthe
baumwelchreestimationformula       
thismaximizationcriterioniscalledmaximumlikelihoodcriterionandthefunction

 p  y  y        yt     iscalledlikelihoodfunction 
baumwelchreestimationformulaisgivenbelow 

 

fi 

fiiii  algorithm iteratesuntilloglikelihoodfunctionwillconverges togetoptimalparameters such

that p  y  y        yt       p  y  y        yt    
iv  with the optimal parameters of model    we can verify that   is the best estimate of the
referencemodelwedefined 
weappliedthetrainingdatasetandthetestdatasetwhichareonlylocationandtimedata
withoptimalparameterstotheviterbialgorithmwhichproducesthebestestimatestate
sequence 
v  evaluate the error rate of by comparing the state variable  sequence produced by viterbi
algorithmandthestatevariablesequenceofrelaxedrealmeasurementdata 
wecalculatetrainingdataseterrorandtestdataseterror 

 

fi  resultandanalysis
our results are shown below in the figure    figure  a shows   states for  am to  pm state
sequence found by the kmeans algorithm  and figure  b showsthe error rate under these  
states  error  rates are  well below     which indicates that less than   out of     sequence
resulted in error in the timeslot in am to  pm and pmto pm  and approximately outof   
errorin pmto am 

figure  a measurementsandstatesofdatab errorrates topistheerrorratefortrainingdata and
bottomtableistheerrorratefortestdata 

 

fi  reference
   atutorialonhiddenmarkovmodels 
http   citeseerx ist psu edu viewdoc download doi                rep rep  type pdf

   hiddenmarkovmodel hmm toolboxformatlabwrittenbykevinmurphy
http   www cs ubc ca  murphyk software hmm hmm html

 

fi