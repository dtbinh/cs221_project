cs    project  classification of dengue fever outcomes from early
transcriptional patterns
alec macrae  clment schiano de colella  ellen sebastian

introduction
dengue fever is a mosquito borne tropical disease that affects about     million people
 
worldwide each year   the vast majority of dengue infections are either non symptomatic or very
mild  causing minor complaints such as fever  headache  and rash  however  a minority of patients
  about          or      of all patients   develop either dengue hemorrhagic fever of dengue
shock syndrome  which causes internal bleeding  leading to low blood pressure  and can be
 
fatal   given the lack of a vaccine and shortage of medical care and medication in dengueendemic areas  there is clearly an incentive to identify individuals who will likely develop severe
dengue  dengue hemorrhagic fever of dengue shock syndrome   dengue experts have
therefore tried to identify a distinct transcriptional signature  appearing in the first few days of
infection  that correlates with patients ultimate prognosis  this signature could be used to
 
construct a low cost diagnostic chip   however  efforts at identifying such a signature have been
confounded by the fact that most studies report separate sets of differentially expressed genes
between mild and severe dengue patients 
in this project  we aim to apply machine learning techniques to use early infection gene
expression signatures in combination with clinical data to estimate patients likelihood of ultimately
contracting severe dengue disease 

data acquisition   processing

 

gene expression data was downloaded from the gene expression omnibus for six
studies of the transcriptional response to dengue fever conducted over the past seven
           
years
  most studies also report patients gender  age  and virus serotype  all factors known
 
to affect dengue fever severity   in order to standardize input across studies  genes were mapped
  
to common identifiers using biomart and genes present in      of samples were considered as
potential features 
our features fell into two groups  gene expression features and non gene expression
features  we further divide the non gene expression features into those that are useful as features 
and those that have no real impact on dengue outcome and therefore should be corrected for  the
former group included gender  age  virus serotype  and whether the infection was primary  the
individuals first dengue infection  or secondary  the individual had been infected with dengue
previously   the latter group includes which study the same originated from  and what kind of
blood sample was taken  whole blood or isolated white blood cells   study origin unfortunately
drove much inter sample variation in gene expression  to correct for this  we used anova
regression  fitting each gene expression trait to the study where it originated and taking residuals
for further analysis 

feature selection algorithms
filter feature selection
as an exploratory early approach to feature
selection  we used filter feature selection to
choose as features the top n genes most correlated
with disease outcome  because we knew that nongene expression factors such as gender  age  virus
serotype  and primary or secondary infection do
have a large effect on dengue outcomes  these
features were included by default  ffs was limited
to gene expression features  this approach yielded
decent performance using svm for training  fig    
but seemed incompatible with the random forest
algorithm  since it greatly decreased accuracy
relative to the genetic feature selection approach

figure    svm accuracy vs  number of ffs selected genes
used as features  it is appropriate to use up to     genes
from ffs as features  after this threshold  technical noise
begins to outweigh useful information provided by the mostcorrelated genes 

fidescribed below 
surprisingly     fold cross validation accuracy decreased after the number of genes
exceeded     using over     genes  accuracy was roughly the same as that produced by training
the algorithm on randomized outcomes as a control  this is probably because very few genes
have a noticeable impact on disease outcomes  noise and other confounding factors outweighed
biologically meaningful factors and reduced predictive power 
backward feature selection
because related genes tend to be expressed similarly 
filter feature selection probably resulted in an unnecessarily
large number of redundant features  and therefore an
unnecessarily large amount of technical noise  being
incorporated into the algorithm 
in order to narrow down the number of potential
  
feature set members  we first used the r package boruta  
which uses a random forest model to classify the features as
either rejected  not important   confirmed  important   or
tentative  possibly important   this resulted in a subset of
    confirmed or tentative genes  from here  our next idea
was to use backwards feature selection using the rfe function
figure    backward feature selection
from the caret package  but the resulting performance did not
exceed      figure     next  we tried backwards feature selection  in this case  unlike filter
feature selection  random forest classification accuracy increased with number of genes used
up to      however  accuracy still did not exceed     
genetic algorithm
we therefore decided to try a genetic algorithm to find the best subset of genes  using a
heuristic wrapper to reduce computational expense involved in finding the optimal subset of
       features  the genetic algorithm selected    features as important  the smallest number of
features so far  and produced random forest accuracy of      the by far the highest accuracy
yet 
akaike information criterion
although genetic algorithms yielded much higher prediction accuracy than any other
feature selection algorithm  we felt that the model selected was probably too complex  i e  
selected too many features  we noticed that    genes had been selected as significant  most of
which had little biological connection to dengue or immunity  thus  we decided to tweak our model
to penalize excessively complex models  the akaike information criterion is a generalized
  
measure of quality for statistical models  the equation for the aic in the case of finite sample
sizes is 

where k  the number of features used  l   the likelihood of the model being tested  and n  
sample size  since a minimum value of aic is ideal  the k factors act to penalize large numbers of
features  we implemented aic as a custom r function passed as the fitness parameter to
ga  whereas genetic algorithms with gas default fitness function resulted in    genes and    
   fold cross validation accuracy with random forest  using aic reduced the number of features
to   and increased overall accuracy to       

fifigure    genetic algorithm feature selection without  left  and with  right  akaike information criterion  using aic reduces
number of features selected from    to   and increases random forest accuracy from     to       

machine learning algorithms
svm
as an initial exploratory approach  we applied the svm
  
implementation provided by the r package e      
parameters were automatically tuned using the tune svm
function  and we report performance resulting from optimal
parameters  ultimately  the optimal cost parameter was   
reflecting the fact that the data was linearly inseparable
and the algorithm needed to prioritize achieving a large
margin over correctly classifying all training examples 
knn
we also experimented with k nearest neighbors in
order to understand if local learning makes a
difference in classifying disease severity  we used
gene expression across samples as input features
to knn and measured accuracy using   fold crossvalidation for varying k values ranging from   to
    the maximum accuracy obtained was      
which is observed for k values ranging from     
however  the accuracy did not change significantly
across all k values  whereas specificity and
sensitivity were drastically altered by the k
selection 

figure    tuning cost and 
parameters for the svm algorithm 

random forest
finally  we applied the random forest implementation provided by the
caret package  simply by using this off the shelf algorithm  we have
achieved much better results with random forest than with any other
algorithm 
table    confusion matrix for
random forest prediction 

discussion
when comparing feature selection algorithms  the genetic algorithm with akaike
information criterion is both theoretically and experimentally superior  theoretically  it should
eliminate redundant gene expression features  therefore reducing the overall number of features 
indeed  even without the akaike information criterion  the optimal number of genes selected by

fiour genetic algorithm was     whereas
performance was consistently low between    and
    genes using ffs  reducing the number of
features is important because unimportant
features will introduce technical noise and other
confounding information into the algorithm 
experimentally  the genetic algorithm is clearly
table    prediction accuracy across various
superior  since it achieved       higher accuracy
learning algorithms
than ffs using random forest for prediction  and
made little difference in accuracy using svm for prediction  our only concern with the genetic
algorithm without aic was that the genes it selected appear to have little biological relevance 
  
most genes were unannotated and most of the genes that were annotated had no immunological
function  in contrast  many of the top genes selected by ffs seem biologically likely to play a role
in dengue outcomes  for example  the genes podxl  and stab  were among the top features
selected by filter feature selection  podxl  plays a role in leukocyte activity  and stab 
regulates cell adhesion and endoyctosis  two cellular activities essential to an effective primary
  
immune response   realizing that the genetic algorithm was probably choosing more features
than actually played a significant role in dengue outcomes  we decided to reduce the number of
features the genetic algorithm would include by incorporating the akaike information criterion  in
addition to increasing classification accuracy by      as mentioned  aic also appears to have
focused in on features that play a biological role in the immune response  table   details the
annotations of the features selected by the genetic algorithm with akaike information criterion 
almost all of which had some connection to dengue or the primary immune response  we were
especially encouraged to see the demographic feature primary vs  secondary infection included
in the list  as secondary dengue infections are known to be much more likely to progress to
 
dengue hemorrhagic fever or dengue shock syndrome as are primary infections  
  

feature
primary vs 
secondary infection

gene ontology
n a

dennd b  denn 
madd domain
containing  b 

involved in clathrinmediated endocytosis

fbn   fibrillin   

supports extracellular matrix in
connective tissues
regulates passage of
potassium across cell
membrane
interacts with actin to
create cell movement
and growth
cell cycle regulation 
centriole formation

kcnk    potassium
channel  subfamily k 
member    
mylip  myosin
regulatory light chain
interac ng protein 
poc a  poc 
centriolar protein a 
cgb   chorionic
gonadotropin  beta
polypeptide   

steroid hormone
regulation

comments
patients suffering a secondary infection  they
have been infected before  are much more prone
to severe dengue
endocytosis is a major activity required by the
primary immune response to fight infection  it is
often reported as enriched in gene expression
studies of dengue patients vs  healthy controls 
fbn  forms microfibrils  which control production
of tgf b  a growth factor important in
progression to dhf 
potassium transport is very generalized and
affects all cells  its role in dengue may be related
to another pathway that has not been annotated 
upregulation of actin related proteins is usually
observed during an immune response due to
movement and proliferation of plasmablasts 
due to the high level of b cell prolifera on 
ontology terms related to the cell cycle are oden
enriched in dengue transcrip onal response
studies 
steroid hormone pathways in blood are
perturbed during dengue infection

table    gene ontology annotations for features selected by the genetic algorithm with akaike information criterion 
unlike the    features selected by the genetic algorithm without aic  most of these features have a clear
connection to immunity  they may play a biological role in indicating differences in the immune response between
patients who are able to effectively fight off dengue  who do not progress to severe disease  and those with weaker
immune systems  who do 

fiin terms of training algorithms  knn performed the worst  random forest the best  and
svm in the middle  knn was probably inappropriate because local effects should not play a large
role in dengue outcomes  one patients prognosis has no impact on anothers  svms
underperformance can probably be attributed to the fact that the data does not even approach
linear separability  random forest was probably effective because the algorithms selection of
random decision trees helped uncover effects that would otherwise be overshadowed by more
prominent features 
although we achieved good classification accuracy  several caveats must be noted  first 
study specific effects were very strong determinants of gene expression variation  which raises the
possibility that much of our findings may be technical artifact  however  the fact that the features
ultimately chosen were strongly associated with immunity helps assuage this fear  second  in a
real world diagnostic situation  the relative proportion of patients who will develop severe dengue
would be much lower than in our study  as a result of study design  roughly half of our patients will
go on to develop severe dengue  in the clinic  only about   in     do  nevertheless  we believe
that our feature selection algorithms effectively choose features that will separate the groups
regardless of size  but the machine learning algorithms will likely need tweaking before
deployment as a diagnostic tool 
future directions on this project may include examining the tree structure produced by the
random forest algorithm to determine which features are most important  doing feature selection
on a study by study basis to eliminate study specific effects  and using bootstrap sampling to
replace missing gene expression values 
references
    popper sj  gordon a  liu m  balmaseda a  harris e  relman da  temporal dynamics of the
transcriptional response to dengue virus infection in nicaraguan children  plos negl trop dis       
             geo  gse     
    murphy  b r   whitehead  s s   immune response to dengue virus and prospects for a vaccine  annu 
rev  immunol                       
    gene expression omnibus  http   www ncbi nlm nih gov geo 
    loke p  hammond sn  leung jm  kim cc  batra s  rocha c  balmaseda a  harris e  gene expression
patterns of dengue virus infected children from nicaragua reveal a distinct signature of increased
metabolism  plos negl trop dis                   geo  gse     
    simmons cp  popper s  dolocek c  chau tn  griffiths m  dung nt  long th  hoang dm  chau nv 
thao le tt  hien tt  relman da  farrar j   patterns of host genome wide gene transcript abundance in
the peripheral blood of patients with acute dengue hemorrhagic fever  j infect dis                
        geo  gse     
    hoang lt  lynn dj  henn m  birren bw  lennon nj  le pt  duong kt  nguyen tt  mai ln  farrar jj 
hibberd ml  simmons cp   the early whole blood transcriptional signature of dengue virus and features
associated with progression to dengue shock syndrome in vietnamese children and young adults  j virol
                        geo  gse     
    long ht  hibberd ml  hien tt  dung nm  van ngoc t  farrar j  wills b  simmons cp   patterns of gene
transcript abundance in the blood of children with severe or uncomplicated dengue highlight differences
in disease evolution and host response to dengue virus infection  j infect dis                      
geo  gse     
    devignot s  sapet c  duong v  bergon a  rihet p  ong s  lorn pt  chroeung n  ngeav s  tolou hj 
buchy p  couissinier paris p   genome wide expression profiling deciphers host responses altered
during dengue shock syndrome and reveals the role of innate immunity in severe dengue  plos one
                    geo  gse     
    anders kl  nguyen nm  van thuy nt  hieu nt  nguyen hl  hong tham nt  thanh ha pt  lien le b 
vinh chau nv  simmons cp   a birth cohort study of viral infections in vietnamese infants and children 
study design  methods and characteristics of the cohort  bmc public health                 
     biomart  http   uswest ensembl org biomart martview 
     kursa mb  rudnicki wr  feature selection with the boruta package  journal of statistical software
                  
     akaike information criterion  http   en wikipedia org wiki akaike 
     david meyer  evgenia dimitriadou  kurt hornik  andreas weingessel and friedrich leisch        
e      misc functions of the department of statistics  e       tu wien  r package version       
http   cran r project org package e    
     carbon s  ireland a  mungall cj  shu s  marshall b  lewis s  amigo hub  web presence working
group  amigo  online access to ontology and annotation data  bioinformatics                   

fi