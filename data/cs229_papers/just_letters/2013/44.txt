cs    final project   finding economic groupings over time
stephen reid

 

introduction

people want to divide countries into economic groupings  whether it be along historic lines  first world  third world 
or because of strong trade links  nafta  mercosur  or because of some whim of a momentarily famous investment
banker trying to invent a catchphrase  brics   groupings are created  adopted and some even persist in the popular
consciousness  many of these groupings are artificial and become obsolete as time passes and economies change 
the question arises whether one could find economic groupings based on how economies actually behave  furthermore  how do these groupings change over time  does the number of groups change over time  or is there some
fixed number of groups with countries moving in and out of them  my project has two components  the first is to
fit a gaussian mixture model  with tweaks  to data vectors of economic variables  like savings rates  consumption
spending  export share  pertaining to countries at different times  the aim is to find a set of  possibly  time varying
groups to which the countries belong and then to see how the countries move between them  tweaks are detailed in
the next section 
the second component relates to visualisation of the groupings  a   dimensional plot  with animation over time 
is desired  the canonical coordinate directions encountered in lda  obtained by maximising the rayleigh coefficients
encountered in hastie et al         will be employed for this purpose 

 

model i  gaussian mixtures with prior on cluster centres

suppose we have data of the form xit   i              n and t              t   where xit is a p vector containing the values of
p economic variables relating to country i at time t  the aim is  given only these vectors  to find sensible and objective
clusters in the data over time  while the use of k means  or k medoids  clustering seems reasonable  i modelled
the data using a gaussian mixture model  once the means of the mixture components are estimated  we have our k
cluster centres  furthermore  the flexibility allowed by this modelling paradigm allows for intuitive generalisations of
a simple clustering model 
specifically then  i assume that xit comes from a mixture of multivariate gaussian distributions  let zitk     if
country i belongs to cluster k at time t  then i assume
xit  zitk      np  tk    
with p  zitk        k  
the zitk are latent variables and we use the em algorithm to maximise the loglikelihood  the em criterion to
maximise in the m step becomes 
n



t

k

  xxx
nt
log    
zitk  xit  tk  t    xit  tk  
 
  i   t  
k  

where zitk  



 
k p     xit tk  


pk
 
   xit tj  
j   j p 

is computed in the e step  p     is the p variate standard gaussian density

function 
there are issues with this setup  in particular  there is little to gain by having different  independently estimated
cluster centres tk for every time period  not only do we estimate many parameters  leading to high variance of the
estimates   but successive cluster centres will not necessarily relate to each other  so the decision is made to smooth
the cluster centres  in particular  i maximise the criterion 


n
t
k
t x
k
x
nt
  xxx
log    
zitk  xit  tk  t    xit  tk    
  t k  t  k    
 
  i   t  
t  
k  

k  

notice that when       we recover the original problem  when     we force t k   t  k and our cluster
centres become k and are constant over time  any intermediate  allows the cluster centres to change over time  but
encourages centres at successive time steps to be close together 
there are at least two intuitive interpretations of this problem 
 

fi   we are maximising a penalised loglikelihood  with a penalty directly geared toward ensuring that successive
centres are close together 
   we are computing a map estimate where our prior on the cluster centres is defined by the conditional distributions t k  t  k  np  t  k     ip   
considerations around the specification of this model include 
 the covariance matrix   note that this is constant over clusters  having one for each cluster requires the
estimation of too many parameters and this is prohibitive  estimating a full  allows for elliptically shaped
clusters in p space  one could even make the further assumption that    ip  after standardising the data  
reducing the parameter burden even further  i tried both 
 the regularisation parameter   currently this parameter is selected  rather unscientifically  to ensure a smooth
progression of the cluster centres over time 

 

model ii  hidden markov model

although the prior on the cluster centres imposed in the previous section speaks to the serial correlation in our
constituent time series  a more direct way of modelling time series data is via a hidden markov model  hmm   i
do not have space here to describe the likelihood  optimisation procedures and other details  but there is a rather
accessible treatment in zucchini   macdonald        
suffice it to say that the hmm is a mixure of gaussians where xit  zitk      n  tk     as before  but now we
model the latent variables as a first order markov chain  p  zitk     zi  t  j        jk   this induces the serial
correlation in our modelled time series  there are now k k     additional parameters to be estimated  a k  k
matrix  of transition probabilities with row sums equal to    and the number of parameters increases quite rapidly
in the number of clusters 
once its parameters are estimated  one can use the viterbi algorithm to deduce the most likely sequence of latent
states  cluster membership  for each of the data items  again  i shall spare the details  which can be found in zucchini
  macdonald        

 

visualisation

once we have estimated the cluster centres tk   we can turn to visualising the data  the problem here is that p     
making effective visualisation difficult  especially if we want some animated representation of the clusters over time  we
require a reasonable method for projecting our data into lower dimensional subspaces  principal component analysis
is one possibility  but that only considers overall variation in the data  we have no guarantee that the cluster centres
would spaced far apart in the lower dimensional subspace and visualisation would suffer 
a different method for selecting projection directions successively maximises  with unit length  mutually orthogonal
vectors  the rayleigh coefficient 
ut bu
r u    t
u wu
where u is a unit norm vector  the matrices b and w are the between cluster and within cluster covariance matrices
obtained from the decomposition  ignoring multiplicative constants  
t  

n x
t
x
 xit  x  xit  x t
i   t  

 

n x
t x
k
x

zitk  xit  tk   xit  tk  t  

i   t   k  

t x
k
n
x
x
t   k  

 
zitk

 tk  x  tk  x t

i  

 w  b
a direction u chosen in this way simultaneously maximises the distance between cluster centres  while minimising
the distance within each cluster between the points in that cluster and its centre  clearly ideal for visualisation in
our problem  the solution to this generalised eigenvalue problem is that the successive maxima are given by the
eigenvalues of the matrix w   b and the corresponding directions  the associated  unit vector  eigenvectors  as with
pca we can project our data onto  say  the first two of these directions to obtain a   dimensional plot  plotting each
year in isolation  then redrawing the next year after a delay creates an animated representation of the clustering 

 

fi 

data and model fits

versions of the models above were fit the to countries dataset  this is a dataset comprising of economic data from
n      countries  see tables below for list   for each country  annual data is gleaned for the years              so
t      years  on p      economic time series  which include  real consumption share of gdp  real fixed investment
share of gdp  real government consumption spending share of gdp  openness  exports   imports to gdp   annual
percentage change in foreign exchange reserves  unemployment rate  inflation  measured by the percentage change in
the gdp deflator   financial account as percentage of gdp  both in us    current account as percentage of gdp
 both in us    growth in real gdp 
these variables were chosen because they are relatively easily obtained  from the imf ifs database  and together
provide a  very  general description of the economy of interest  a clustering based on these variables is not entirely
devoid of content  note that for policy formulation purposes  more variables should be obtained to reflect deeper
attributes of the economies in question  however  data acquisition here is time intensive and it is difficult to collate
data across countries for the majority of available time series 
the output from   models is presented below  note that for each  i assumed that the covariance matrix    ip  
because the dataset is not very large and i wanted to focus attention on the estimation of the cluster centres and
transition probabilities  also  the data was mean centered and standardised  so a unit variance assumption is probably
not too stringent  these   models are  gaussian mixtures with constant cluster centres        gaussian
mixtures with time varying clusters          and a first order hmm with constant cluster centres 
tables       show the estimated cluster membership  numbering       and    for these   models respectively  note
that the cluster numbers themselves have no meaning other than being convenient labels  the same country may have
different cluster labels in different model fits  but this does not mean that it belongs to qualitatively different cluster 
number of clusters is selected using the bic  there are some details about how to count the number of parameters
in the smoothed cluster centre model  see appendix   conclusions are similar for the three model fits  additional
clusters in the gaussian mixture models are crisis clusters   they are occupied temporarily by countries experiencing
some extreme economic events  the hmm has only one such crisis cluster  whereas the gaussian mixture models have
three apiece  this allows one to characterise the type of crisis experienced by the country more fully 
there seems to be a fairly stable cluster containing western or first world economies like france  canada 
australia  spain and the united kingdom  it is somewhat surprising that some middle income economies  like
poland  south africa and brazil also spend much time in this cluster  notice that brazil bounces around quite
dramatically before settling down  the economic instability in this country during the   s and   s is well documented 
germany and austria are interesting exceptions in this cluster  they spend most of their time there  but end up in
a open  industrialised cluster with the netherlands and belgium  who never leave this cluster   open economies
are those characterised by large proportions of exports and imports relative to the overall size of the economies  this
observation also accords with the conventional wisdom these economies tend to be major export hubs 
furthermore  one can recognise a developing  third world cluster with members egypt  turkey  argentina  also
tumultuous  like brazil   a south american curse   india  mexico and indonesia  finally  one notices an asian tiger
cluster  characterised by rapid growth  high savings and investment rates  containing  at various times  china  south
korea  japan  thailand 
it is interesting to consider the asian economies and their progression  especially after the asian crisis of           korea moves briefly to a crisis cluster in       but soon returns to the tiger cluster  indonesia initially spends
time in the tiger cluster  experiences the crisis and then seems to drop down to the developing economy cluster 
it seems to have struggled to cope with the fallout from the crisis  in contrast  thailand starts off as a developing
economy  but then seems to graduate to the open  industrialised cluster with belgium and netherlands  this reflects
the differing responses these economies had to the crisis and the extent of their subsequent success 
visualisation techniques described in section   were used to create animations of these tables  colour coding different
clusters  these are posted on youtube on my channel  follow http   www youtube com watch v   dmdfzljaa for
table   and navigate to my channel from there to view the other two  cluster centres are marked by x and country
abbreviations label the countries  note that some distance information is lost when projecting onto lower dimensions 
so countries coloured according to one cluster may appear closer to a cluster centre of a different colour 

 

discussion

unsupervised clustering algorithms were applied to an economic dataset with time series data  the challenge here
is the modelling of cluster centres over time so that they properly reflect the serial correlation encountered in most
time series data  smoothing penalties and hmms were used to model the serial correlation  superficially interesting
clusters were discovered in the data  obvious extensions of this would be the automatic selection of the regularisation
parameter in the gaussian mixture model and an objective criterion to compare different model types  perhaps aiding
the selection of a single best clustering model 

 

ficountry
australia
canada
france
spain
u  kingdom
poland
s  africa
u  states
germany
austria
japan
brazil
mexico
egypt
turkey
india
indonesia
argentina
china
korea
thailand
belgium
netherlands

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

table    estimated cluster membership of the country dataset over the   clusters selected by the gaussian mixture model
with constant cluster centres  output shown only for              table is arranged by cluster in which countries spent
most of their time  ranked within each cluster in descending order of time spent there  solid lines separate clusters 
dashed lines special cases within each cluster 

appendix   number of parameters in bic
the bic criterion is used to determine the number of clusters in each model  the criterion  for number of clusters k 
has the form 
 loglik k    log npt    number of parameters in model
clearly  we need to count the number of parameters in the fit  this is easy for the constant cluster centre gaussian
mixture and the hmm  however  the regularisation in the smoothed cluster centre gaussian mixture complicates
matters  i used the rule of thumb proposed by hastie et al          chapter    modified slightly for this problem 
since we use the identity covariance matrix  the problem separates into p regularisations where 
jk    dk   m    vk
where jk is the
of the j th variable in cluster k  dk a t  t diagonal matrix with
pnt  vector of cluster centre estimates p
n
entries ntk   i   zitk   vk a t  vector with entries i   zitk xitj and m the tridiagonal matrix associated with the
quadratic form in the penalty  using the formula for the eigenvalues of tridiagonal matrices  a modified approximate
parameter count is 
df    

p x
n x
k
x

trace  cov xij   jk   

i   j   k  

 

k x
t
x

ntk


k   t  

ntk         cos



t
t   



references
hastie  t   tibshirani  r    friedman  j          the elements of statistical learning  data mining  inference and
prediction  springer verlag  new york 
zucchini  w    macdonald  i          hidden markov models for time series  an introduction using r  chapman
and hall  crc  boca raton 
 

ficountry
australia
france
spain
u  kingdom
s  africa
u  states
poland
canada
germany
austria
brazil
thailand
india
mexico
egypt
indonesia
turkey
argentina
japan
china
korea
belgium
netherlands

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

table    estimated cluster membership of the country dataset over the   clusters selected by the gaussian mixture
model with smoothed time varying cluster centres  output shown only for              table is arranged by cluster
in which countries spent most of their time  ranked within each cluster in descending order of time spent there  solid
lines separate clusters  dashed lines special cases within each cluster 
country
australia
canada
france
spain
u  kingdom
u  states
poland
s  africa
germany
austria
brazil
turkey
egypt
mexico
argentina
india
indonesia
china
korea
japan
thailand
belgium
netherlands

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

table    estimated cluster membership of the country dataset over the   clusters selected by the first order hmm 
output shown only for              table is arranged by cluster in which countries spent most of their time  ranked
within each cluster in descending order of time spent there  solid lines separate clusters  dashed lines special cases
within each cluster 

 

fi