astronomical implications of machine learning
arun debray
raymond wu
december         

abstract  in this project we use supervised learning to develop a classifier for stellar lightcurves to detect whether
they demonstrate the existence of exosolar planets  we use various features selection methods  in particular we will
be using dynamic time warping to measure the similarity between two temporal sequences 

   introduction
the recent discoveries of planets around stars other than our own is among the most significant trends in astronomy
today  long debated by philosophers and physicists alike  no such planets were known until       when two planets
were discovered around a star called psr b         in the two decades since then  over a thousand such planets
have been discovered  diverse in many ways  thanks to these discoveries  astronomers are learning more about
planetary systems other than our own  responding to these questions about other solar systems and even how
probable earth like life could be in the universe 
in this paper  we will use the following standard terminology 
 an exosolar planet is defined as in     to be a planet that orbits a star other than the sun   the standard
definition of a planet has two kinds of ambiguity  very low mass objects in our solar system  such as pluto 
were defined to be dwarf planets  and the boundaries of this definition arent entirely clear  very highmass planets  however  resemble very small stars  though they dont undergo hydrogen fusion  they look
very much like a dim type of star called a brown dwarf  the boundary is somewhat arbitrarily delineated
at    jupiter masses  however  neither of these is a great concern in this paper  science is yet unable to
detect pluto sized worlds around another star  so the low mass ambiguity does not arise in this data  and
the high mass boundary is not as important  a classifier that discovers planets and small brown dwarfs is
still useful  however  it will be helpful to distinguish these systems from eclipsing binaries  see below  
 planetary transit is a method of exoplanet detection  in general  because planets are very dim relative to
their bright host stars  they cannot be directly imaged  in the same way that it is difficult to detect a firefly
near a searchlight from afar  thus  several indirect methods exist  planetary transit repeatedly checks the
brightness of a star over time  periodic  regular dips in this output sometimes happen because an exoplanet
crosses between its sun and the observer  thus  a planet may be detected without direct observation  see
    for more information on transiting exoplanets 
 a lightcurve is a graph of a stars brightness over time  a transiting exoplanet will thus manifest itself as a
lightcurve that is relatively constant  but with regular  small dips corresponding to the transits  see figure  
for two examples  the brightness is often given in units of magnitude rather than strict luminosity  because
the logarithmic magnitude scale is generally easier to work with 
 an eclipsing binary is a pair of stars that orbit each other  but such that each eclipses the other from the
earths point of view during the orbit  these generally dont contain transiting exoplanets  but instead form
an important negative example  their lightcurves look like those of exoplanets  but they arent exoplanets 
until recently  most exoplanets werent detected by transit  astronomers used any of several other methods to find
them  however  when the kepler telescope was launched  it provided a wealth of data about transiting exoplanets 
in particular showing that many stars could be surveyed at once  since kepler provided such a wealth of data about
exoplanets  we decided to try to train a classifier on its lightcurves 
   methodology
we obtained kepler light curves from the mikulski archive for space telescopes  see       lightcurves are stored
in the  fits file format  so we used the astropy python library  found at      to parse them  we first divided
light curves into those corresponding to exoplanets and those corresponding to non exoplanets  the non exoplanets
contained non variable stars  which had relatively uniform light curves as well as stars with variable light curves
 the words exoplanet  exosolar planet  and extrasolar planet all mean the same thing  and are used interchangeably 
 

fifigure    lightcurves  graphs of stellar brightness versus time  of two planetary transit systems
discovered by kepler  the regular small dips correspond to the planet passing in front of its sun
and slightly diminishing the observed magnitude  source     

that did not have exoplanets  these variable light curves were caused by other reasons  including eclipsing binary
systems as well as intrinsically variable stars  the light curves are represented as time series data  which means that
each light curve is represented by a series of attributes at each time point within some range  the attributes of the
light curve stored in the binary table include 
 time  the time at the midpoint of the light curve
 sap flux  simple aperture photometry flux in units of electrons per second contained in the optimal aperture
pixels
 sap flux err  the error in sap flux in electrons per second
 sap bkg  the total background flux summed over the optimal aperture
 sap bkg err  the error in the background flux
 pdcsap flux  flux after presearch data conditioning  pdc  has accounted for systematic error sources
such as drift or focus change
 pdcsap flux err  the error in pdcsap flux
 psf centr   the column centroid obtained by fitting the point spread function
 psf centr  err  the error in psf centroid  
 psf centr   the row centroid obtained by fitting the point spread function
 psf centr  err  the error in psf centroid  
 mom centr   the column value for the flux weighted centroid  first moment 
 mom centr  err  the error in mom centroid  
 mom centr   the row value for the flux weighted centroid  first moment 
 mom centr  err  the error in mom centroid  
 pos corr   the column position correction based on bright stars
 pos corr   the row position correction based on bright stars
we decided early on that we should build a classification model on features extracted only from a couple of these
attributes since not all the attributes were relevant to our query  we decided to go with attributes sap flux  sap bkg 
pdcsap flux  mom centr   mom centr   pos corr   and pos corr   these values in particular were always defined
over the entire time interval and provided important data about the light curve 
 

fisince our lightcurves are time series  which are large series of data points separated by a uniform time interval 
it is both extremely difficult and unhelpful to train any sort of classifier over the raw data points  instead  we will
need to extract features from each time series  these features have to be both manageable and descriptive of the
light curve 
we decided to try a variety of feature selection methods  initially  we decided to look for global features such
as the arithmetic average  maximum  and minimum values for each attribute  these global features provide very
high level  general descriptions of the time series  thus they provide a good set of initial features  but can only
provide a limited amount of detail  using metafeatures can be used to provide a more accurate description of the
time series  but we decided to opt for a different type of feature 
given that we were examining light curves  which vary in time and speed due to differences in the size and shape
of the orbiting planets as well  differences in orbital periods  and differences in the instrument recordings  we want to
be able to detect common patterns that are indicative of exoplanets regardless of these differences between different
planets and stars  so to do this  we turned to an algorithm called dynamic time warping  dynamic time warping
 dtw   outlined in      calculates the optimal match between two time series by calculating a measure of similarity
independent of the time  speed  and acceleration of the time series 
we decided to use dynamic time warping to calculate the similarity of each light curve with a baseline light
curve  to find an appropriate baseline light curve  we took a relatively flat light curve from our training set of light
curves without exoplanets  then we used dynamic time warping to calculate a measure of similarity between each
light curve and this baseline  we used this result as one of our features in addition to our global features 
after extracting all of our appropriate features  we needed to train a classifier  we used an open source machine
learning algorithm suite called weka        developed at the university of waikato in new zealand  we used a
variety of classification methods including logistic regression  nave bayes  support vector regression  svr   and
multilayer perceptron  we found that svm did not work particularly well  so we used a modified svm algorithm
called regsmoimproved     in particular  we used a polynomial kernel to map the data to a higher dimension and
then use the altered smo algorithm to calculate a regression model  we also made use of the multilayer perceptron 
an artificial neural network model that learns through backpropgation 
we tested our classifiers on our data sets using    fold cross validation  for testing the features generated by
dtw  we had     light curves that were either confirmed exoplanets or were labeled as exoplanets but unconfirmed
as of august       and     light curves that were confirmed to not be exoplanets  so in total our training set size
was     instances  for the means of attributes features  we had about     data points  split evenly between those
with confirmed planetary transits and no known transits 
   results
see table   for the overview of results  in general  a variety of algorithms performed quite well on this data 
averaging an about     classification accuracy  we can take a look more specifically at how our logistic regression
confusion
matrix


     
logistic  means of attributes                        
      
      
       
      
logistic  dtw                        
      
      
     
    
      
      
nave bayes  means of attributes                        
       
      
      
      
nave bayes  dtw                        
      
     
smo  means of attributes           
        
    
      
      
     
smo  dtw                      
      
      
     
     
perceptron  means of attributes                        
      
      
       
      
perceptron  dtw                        
      
      
     
table    a summary of cross validation results  here  rms error is the root mean squared error 
and all confusion matrices in this table are of the form a    aij    where aij is the number of instances
classified as y   j during cross validation that were actually from group i 
model

correct

incorrect

 

mean absolute error

rms error

fifigure    the margin curve for the logistic regression classifier  here  the steeper the boundary
line  the greater the margin between the two sets  compare to figure   
model and multilayer perceptron model compare  the multilayer perceptron model takes all the input values  the
features we collected  and returns a single value between   and   that is used to distinguish light curves with
exoplanets  those with value greater than    and light curves without exoplanets  those with value less than     we
can look at what values our models gave for our training set  the results are plotted in figures   and    and illustrate
how the similar accuracies in these algorithms belies very different classfication boundaries 
   analysis
we were pleasantly surprised to see such high accuracy rates from these algorithms  we went into this project
assuming that issues such as noise in the data and the difficulty of programatically distinguishing transiting planets
from eclipsing binaries would make this project difficult  in particular  there are good reasons to assume that the
problem is not necessarily linearly separable  intuitively  there are two major astronomical constraints on a lightcurve 
if there are no dips in the lightcurve  then there is probably no transiting or eclipsing body around the parent star
 or it is too small to be detected with current technology   yet if the changes in the magnitude are too large  then the
transiting object is unlikely to be a planet  instead  it could be a brown dwarf or even a stellar companion  in which
case the system is an eclipsing binary   thus  the exoplanets lie in between these two constraints in the direction
of the depth of the magnitude loss  i e  some line in the feature space that accounts for these particular differences
in the lightcurves   so a linear classifier that doesnt use a higher dimensional kernel will be inaccurate 
this could very well be why the svms were snarled by this classification question  their attempts to fit a clean
decision boundary couldnt account for all of the edge cases  however  other classifiers are less concerned with
the shape of the decision boundary  as classification is done less geometrically  thus  these classifiers were more
successful  and with feature selection optimized for time series data  were able to perform very well 
   future work
there are still several improvements that could be made  for one  we can run a clustering algorithm beforehand
to group together light curves that have similar brightness and similar metafeatures  thus  we would have clusters
of stars that have similar apparent brightness  then we can select from each cluster a light curve that contains a
star that is known to not have any noticeable variability  exoplanet  binary system  variable star  etc   then we can
 

fifigure    the margin curve for the multilayer perceptron  compare with figure    even though
they had very similar error rates  their margin curves look very different 
run the dtw algorithm to compare each star in that cluster to the non variable star in order to obtain a even more
normalized measure of similarity between light curves 
another improvement we could make is to try to use a multinomial classifier or a clusterer to specifically classify
the light curve as a binary star  a variable star  a transiting planet  or something else  instead of just classifying to
be able to tell whether there is a exoplanet or not  we could expand our attribute list and collect more features to
generate a classifier that can provide more detailed classification 
we could also train and test our classifiers on larger sets of data  as the kepler project has been discontinued 
we have a very limited training set to work with  kepler has discovered over      unconfirmed planet candidates 
but only a little over     have been confirmed  which gives us a relatively small training set  and given that greater
than expected noise and failure of keplers instrumentation has plagued the project  the data collected in the latter
half of its mission is likely dubious  in the chance of another exoplanet discovery project in the future  we will aim
to continue training and testing our classifiers  but in the meantime  there are still hundreds of thousands of kepler
target light curves to be sorted through 
references
    the extrasolar planets encyclopedia  http   www exoplanet eu  november          
    malatesta  kerri  the transiting exoplanets hd        and tres     american association of variable star observers  june         
    mark hall  eibe frank  geoffrey holmes  bernhard pfahringer  peter reutemann  ian h  witten         the weka data mining
software  an update  sigkdd explorations  volume     issue   
    mikulski archive for space telescopes  mast   http   archive stsci edu kepler publiclightcurves html january          
    mitchell  scott  the application of machine learning techniques to time series data  university of waikato       
    robiatille  thomas p   et  al  astropy  a community python package for astronomy  astronomy and astrophysics  volume     
october      
    s k  shevade  s s  keerthi  c  bhattacharyya  k r k  murthy  improvements to the smo algorithm for svm regression  in  ieee
transactions on neural networks       
    transit tracks  nasa  http   kepler nasa gov education activities transittracks   june      

 

fi