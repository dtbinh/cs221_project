  
ilan  goodman   with  elena  frey  for  cs      
cs     final  report  
  

beating  the  streak   predicting  the  mlb  players  most  likely  to  get  a  hit  
each  day  

  
motivation  and  task  definition  

major   league   baseball   is   a   statistics rich   sport    with   a   premium   placed   on  
interpreting   those   statistics   and   determining   their   worth    despite   all   of   the   information  
catalogued   over   the   years   of   mlb    there   is   no   one   clear   indicator   of   the   factors   that   cause   a  
team   to   win   or   that   lead   to   a   player   performing   well   in   a   given   game    in   spite   of   these  
challenges    it   is   possible   to   discern   trends   in   the   data   and   create   a   model   for   the   game   that  
applies  more  accurately  than  a  casual  fan  might  be  able  to  predict  from  observation   
joe   dimaggio   holds   the   record   for   the   longest   hitting   streak   in   major   league  
baseball         games    set   in           no   other   player   has   come   close   to   that   record    in          
mlb com  created  a  fantasy  game  called  beat  the  streak  in  which  participants  pick  a  new  
player   each   day   they   think   will   get   a   hit    if   the   player   actually   gets   a   hit    the   participant  
extends  his  or  her  hitting  streak   if  not   the  participants  hitting  streak  resets  to      each  
day    a   participant   can   choose   a   new   player    or   the   same   player   if   they   prefer     and   the   first  
player   to   reach        games   wins   the   grand   prize   of          million    this   is   an   unexpectedly  
challenging  task   and  no  fan  has  even  reached  a  streak  of      in  the  history  of  the  game   with  
this   goal   in   mind    we   are   attempting   to   beat   the   streak   and   predict   the   batter   most  
likely  to  get  a  hit  each  day  using  machine  learning  techniques   further   we  also  wrote  a  
recommendation  tool  to  aid  a  human  player  in  this  competition   
  

data  

we   scraped   our   data   from   baseball reference com    in   order   to   be   able   to   make  
predictions  across  the  entire  mlb   we  trained  and  tested  on  data  from  the  last      years   we  
extracted   the   data   from   each   game   played   since          and   we   trained   our   models   on   the  
complete  data  for  batters  from  the             seasons   and  then  tested  it  on  the  complete  
data  from  the        season   we  continued  to  update  the  machines  weight  vector  and  data  
with  each  day  of  testing   as  we  would  when  using  our  program  in  the  competition  over  
the   course   of   a   season    to   harvest   this   data   we   accessed   complete   transcripts   to   every  
game   in   each   season   on   baseball reference com   and   derived   all   the   data  needed   from   these  
statistics   we  also  derived  the  player  data  from  these  games   we  downloaded  yearly  rosters  
to  represent  the  team   we  currently  have  this  database  stored   which  will  come  in  handy  
when   we   test   our   model   in   real   time   in   the          season    this   database   includes   data   for  
every   batter pitcher   matchup   since          and   their   results    plus   auxiliary   data   about   the  
games  such  as  time  and  location   
  

approach  and  features  

to  implement  our  machine  learning  algorithms  we  developed  a  feature  vector  that  
focused  on  areas  that  can  have  an  impact  on  a  batters  likelihood  to  get  a  hit  on  any  given  
day    features   included    but   were   not   limited   to    the   batters   and   pitchers   skills    game  

 

fi  
conditions   and  hot  streaks   with  this  in  mind   we  chose  a  set  of      features  to  form  a     
dimensional  vector  representing  a  single  batter  for  a  single  game   we  scaled  each  feature  
so  that  it  falls  roughly  in  the  interval         in  order  that  the  learned  weights  have  an  easily  
interpretable  meaning   refer  to  appendix  a  for  a  complete  list  of  the  features   we  also  have  
a  constant   bias   term  in  our  feature  vector   and  we  mark  whether  the  player  gets  a  hit  on  
each   day   or   not   with   a       or        the   input   for   our   algorithm   is   the   feature   vector   for   the  
player   and   the   opposing   pitcher    and   the   output   is   a   measure   of   how   likely   that   player   is   to  
get   on   that   day    we   needed   to   make   some   simplifying   assumptions   that   undoubtedly  
affected   our   training   and   our   predictions   due   to   the   lack   of   data   that   we   could   unearth    for  
example    we   assumed   that   a   teams   roster    although   it   can   vary   daily    was   static   and  
enlarged  for  the  entire  season   since  the  daily  roster  information  is  not  available   
  

primary  algorithms  

we  modeled  the  likelihood  that  a  player  gets  a  hit  on  any  given  day  as  a  generalized  
linear  model   glm   with  a  bernoulli  distribution   this  is  ultimately  equivalent  to  a  logistic  
regression    so   we   choose   to   solve   our   classification   problem   by   implementing   logistic  
regression    our   classifier   assigns   a   likelihood   to   each   player   that   he   will   get   a   hit   on   any  
given   day    based   on   his   feature   vector    via   the   sigmoid   function    since   we   have   so   much  
data    it   suffices   to   pass   over   our   training   data   once    when   testing   and   predicting    we  
selected  the  player  each  day  who  had  the  highest  score   as  given  by  the  sigmoid  function    
in   order   to   create   our   confusion   matrices   for   analysis    we   predicted   every   player   whose  
score  was  above       to  get  a  hit  and  all  the  others  to  go  hitless  on  that  day   
  

results  and  discussion  

while   our   ultimate   goal   is   to   predict   and   maintain   the   longest   possible   hitting  
streak   of   correct   predictions    the   probability   of   maintaining   such   a   streak    assuming  
mutual   independence   between   each   pair   of   days    is   slim    even   with   high   prediction  
accuracy    accordingly    the   best   way   to   measure   success   is   the   percentage   of   times   we  
correctly  predicted  a  player  to  get  a  hit   one  other  way  to  evaluate  our  performance  is  to  
look  at  how  many  players  were  correctly  classified  as  hit  or  no  hit  on  each  day   
we  tested  our  logistic  regression  algorithm  with  several  different  learning  rates  and  
calculated  our  pick  accuracy   the  percentage  of  the  time  our  pick  actually  got  a  hit  on  that  
day     along   with   the   longest   streak   we   were   able   to   achieve   and   the   confusion   matrix   for  
the  global  predictions  we  made  for  each  batter  each  day   when  multiple  learning  rates  are  
shown  it  means  the  model  was  trained  once  completely  with  each  successive  value   e g    the  
last   row   was   trained   once   with   a   learning   rate   of            a   second   time   with            and   a  
third  time  with  a  rate  of            
  

 

fi  

  
the   longest   streak   we   maintained   was        and   our   peak   accuracy   was            
although   these   results   are   significantly   above   average   for   a   human   playing   beat   the  
streak   and   are   better   than   a   baseline   measure   of   picking   the   player   with   the   highest  
batting  average        success  rate  over  a  few  months  of  data    these  initial  results  were  not  
as  successful  as  we  had  originally  hoped   
we   then   modified   our   classifier   to   serve   as   a   recommendation   tool   for   a   human  
playing   bts    once   we   made   our   predictions   for   each   batters   likelihood   to   get   a   hit    we  
selected  the  top  five  candidates  and  to  present  to  the  player   to  evaluate  this  system   we  
modeled  the  human  as  a  random  agent  and  uniformly  chose  the  batter  to  get  a  hit  from  this  
list  of  five   we  repeated  this  process  several  times  and  averaged  our  results  from  each  of  
these   trials    we   repeated   this   with   suggesting   the   top   ten   players   most   likely   to   get   hits   
these  results  represent  an  improvement  over  our  earlier  selection  algorithm   
learning rate

  of top players
considered before
random selection

accuracy

average longest
streak

                    

 

      

    

                    

  

      

 

  
we   found   that   in           of   days   in   the   first   third   of   the   season   our   recommender  
provided  three  or  more  batters  that  got  a  hit  from  the  five  total   in  the  middle  third  of  the  
season  the  recommender  offered  at  least  three  correct  batters       of  the  time   and  in  the  
last  third  of  the  season  he  recommend  was  at  least       correct       of  the  time   together   
 

fi  
over  the  last       of  the  season   once  the  season  statistics  that  comprise  the  majority  of  our  
feature  vector  are  meaningful    the  majority  of  the  hitters  we  recommended  got  hits       of  
the   days    this   is   a   significant   result   in   that   it   shows   how   powerful   a   tool   this  
recommendation   system   could   be   for   someone   playing   the   game   who   might   have   extra  
information  that  we  could  not  model  for  historical  data  reasons   such  as  injury  history   
although  we  did  not  attain  our  initial  goal  of  reaching  a  record breaking  streak   we  
were  able  to  achieve  a  prediction  percentage  that  is  consistently  around        this  is  still  
successful   as   this   level   of   accuracy  is   well   above   the   human   average   for   the   game   based   on  
data   from   beat   the   streak    and   it   beats   baseline   data   by          however    even   with   this  
above  average  prediction  it  is  nearly  impossible  to  maintain  a  hitting  streak   assuming  we  
predict   a   batter   correctly         of   the   time   and   each   prediction   is   independent    then   the  
chance  of  us  getting  merely  a     game  hitting  streak  is           and  the  chance  of  a  record 
breaking     game  streak  would  be       x        
  

additional  results  

we  also  approached  the  problem  from  another  direction   instead  of  modeling  each  
player day   independently    we   tried   to   model   each   streak    to   that   end    we   modeled   each  
players  expected  actual  hitting  streak   as  well  as  our  own  picked  hitting  streak   with  a  
glm   using   a   geometric   distribution    while   we   could   not   find   any   literature   to   reference   for  
this   particular   distribution    the   geometric   distribution   falls   nicely   into   the   exponential  
family   with   the   sufficient   statistic   t y        y    we   find   that          ln       with   probability      of  
predicting   a   player   to   get   a   hit   on   a   given   day     and   since   e y x                        we   find   that  
we  have  a  hypothesis  function  h      exp  tx            yielding  our  stochastic  gradient  update  
i            i      exp  tx             y   xi   we  tried  to  apply  our  data  to  this  model  to  see  if  we  
could  improve  our  results   but  it  did  not  work  in  our  prediction  framework  because  we  are  
predicting   the   next   player   to   get   a   hit   and   not   the   next   longest   actual   hitting   streak   
nevertheless    this   is   an   important   novel   result   because   we   could   use   it   to   model   other  
aspects  of  baseball  that  we  have  not  yet  incorporated  into  our  features   
  

conclusion  

while  we  did  not  manage  to  beat  the  streak   we  did  build  a  program  that  predicts  
which   major   league   baseball   players   are   most   likely   to   get   hits   consistently   better   than  
humans   and   baseline   implementations    even   though   our   theoretical   discoveries   did   not  
translate  into  practical  code   we  built  a  robust  recommendation  tool  for  anyone  who  wants  
to  play  beat  the  streak   
a  tool  such  as  ours  could  be  invaluable  to  managers  and  owners  of  baseball  teams   a  
manager  could  use  this  method  or  something  similar  to  select  their  daily  lineupeven  the  
few   percentage   points   that   we   would   add   to   the   win   probability   of   the   game   would   be  
worth   several   million   dollars   in   todays   baseball   market    furthermore    we   could   easily  
adjust  our  program  to  apply  for  player  scouting   suggesting  trades   analyzing  other  sports   
and  countless  other  possibilities   
overall   we  wrote  a  successful  artificial  intelligence  and  learned   about  how  machine  
learning  works  in  the  real  world   how  to  obtain  and  manage  large  quantities  of  data   and  
how  our  mathematical  theory  translates  to  reality   

 

fi  

appendix  a   feature  vector  



















































the   home   run   factor   for   the   park   the   game   is   played   in    how   home   run   friendly   this   park   is          is  
average   below  is  hard  to  hit  hrs              
the   run   factor   of   the   park   the   game   is   played   in    how   easy   it   is   to   score   a   run   in   this   park          is  
average   below  is  hard  to  score              
the  hit  factor  of  the  park  the  game  is  played  in   how  easy  it  is  to  get  a  hit              
the  double  factor  of  the  park  the  game  is  played  in   how  easy  it  is  to  hit  a  double              
the  triple  factor  of  the  park  the  game  is  played  in   how  easy  it  is  to  hit  a  triple              
the  walk  factor  of  the  park  the  game  is  played  in   how  easy  it  is  to  get  a  walk              
an   indicator   if   the   game   is   national   league    nl    or   american   league    al     as   determined   by   the  
home  park      or      
an  indicator  if  the  game  is  played  during  the  day  or  at  night      or      
an  indicator  if  the  game  is  a  home  game  for  the  batter  or  away      or      
the  time  zone  shift  that  the  batter  is  playing  in       to      discrete   
the  time  zone  shift  that  the  pitcher  is  playing  in       to      discrete   
the  number  of  hits  the  player  has  had  in  his  last  game  divided  by               
the  number  of  hits  the  player  has  had  in  the  last  two  games  divided  by               
the  number  of  hits  the  player  has  had  in  the  last  three  games  divided  by                
the  number  of  hits  the  player  has  had  in  the  last  four  games  divided  by                
the  number  of  hits  the  player  has  had  in  the  last  five  games  divided  by                
the  number  of  hits  the  player  has  had  thus  far  this  season  divided  by                 
the  batters  season  batting  average   avg   times                  
the  batters  season  on  base  percentage   obp   times                  
the  batters  season  slugging  percentage   slg   times                  
the  batters  current  hitting  streak  divided  by                
the  batters  season  strikeout   k   rate  times                  
the  batters  season  walk   bb   rate  times                  
the  batters  season  home  run  rate  times                      
the  batters  season  number  of  at  bats  per  game  divided  by               
the  batters  number  of  years  in  the  majors  divided  by                
the  batters  career  batting  average  times                  
the  batters  career  batting  average  in  this  park  times                  
an  indicator  if  the  batters  team  won  its  last  game  or  not      or      
the  number  of  hits  the  batters  team  had  in  its  previous  game  divided  by                
the  head to head  winning  percentage  of  the  batters  team  vs   the  pitchers  team  
the  number  of  hits  the  pitcher  gave  up  in  his  last  outing  divided  by                
the  number  of  ks  the  pitcher  got  in  his  last  outing  divided  by                
the  starting  pitchers  era  in  the  past  five  games  divided  by               
the  starting  pitchers  season  earned  run  average   era   divided  by               
the  starters  season  whip   walks  and  hits  per  inning  pitched           
the  starters  season  k ip  rate          
the  starting  pitchers  season  winning  percentage             
the  starters  season  k  to  bb  ratio  divided  by               
the  starters  average  innings  pitched   ip   per  game  divided  by               
the  pitchers  number  of  years  in  the  majors  divided  by                
the  starters  career  era  divided  by               
the  starters  career  whip          
the  starters  career  k ip  rate          
the  starters  career  bb ip  rate  times               
the  pitching  teams  season  bullpen  era  divided  by               
the  pitching  teams  season  bullpen  whip          
the  pitching  teams  season  k ip  rate          
the  pitching  teams  era  in  the  past      games  divided  by               
an  indicator  if  the  pitching  team  won  their  previous  game      or      

 

fi