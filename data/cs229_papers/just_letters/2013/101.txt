cs    final project

        

counting trees in deforested areas from aerial photographs
photographs
ritobrata sur  shengkai wang  wending lu
 rsur  shinek    wending  stanford edu

introduction
the recent alarming trends in the rate of deforestation
have had devastating environ mental consequences  to
monitor the progress of deforestation and afforestation 
it would be useful to effectively survey the number of
trees in affected areas  this is an ideal domain of
machine learning because automated surveying and tree
counting would allow us to collect this information
much more efficiently 
of particular interest to us in this project is the treecounting problem  specifically  when given training
image of trees and test aerial image as inputs  we want
to predict the number of trees in the aerial map  and a
tree labeled image as outputs 
object identification from aerial image is a well studied
subject  levner et al     reported using markov
decision process to identify meaningful objects from
pictures  but since the objective of this problem is to
identify trees from other objects  it was deemed
unnecessary to involve the computationally expensive
reinforced learning algorithms  instead an estimate was
made using image processing techniques following an
approach similar to the work of gougeon and leckie
     a simplified approach of edge detection was
inspired from the work of maloof et al     

   clustering 
clustering cluster the green pixels into different
groups using the k means clustering algorithm  where k
is initialized with the estimate from step   and then
further optimized for best performance
   classification 
classification each group of pixels obtained in step
  is then closely examined  and classified as either a tree
or a non tree cluster

data acquisition
the aerial images used in current study so far were
obtained from google maps  with their locations
randomly chosen from deserted areas in the southwest
united states 

image pre processing
the original test image  fig     in rgb colors is first
projected onto the lab  brightness and hue 
colorspace  where the a parameter  which differentiates
the pixel color between green and red  is exploited for
green color enhancement  then the green enhanced
image  fig     is used for extracting green pixels  fig    
from the original image  by thresholding the green
value and the intensity of each pixel 
   

   

   

basic prediction method
   

the aerial satellite images to be tested are first preprocessed to remove any background and keep only the
green pixels of interest  then from the extracted green
pixels  trees are identified via the following processes 

   

   

   

   

   

   

   

   

   

fig     original satellite image

   estimation 
estimation estimate the total number of green
regions by segmenting the green pixels into rectangles

 

fics    final project

        
rectangles  the tunable parameters in this section are 
   the maximum gap between adjacent green pixels for
them to be considered continuous     the minimum 
and    the maximum and the minimum diameters of
trees 

   

   

   

   

   green pixel isolation

   

   

   

   

   

   

   

   

   

fig     green enhanced image

the first step in our tree counting process from an
aerial photograph is finding the pixels that are  treegreen   there are two steps involved in it 
i  first the picture is converted to lab scale from rgb
and then green enhanced to increase the contrast
between the different shades of green 

   

   

   

ii  then  a threshold is set to identify the pixels above a
certain green ness level 

   

   

   continuous green patch identification

   

   

   

   

   

   

   

   

fig     green pixels extracted from the original image

step i  estimation

the  green pixels  found in the previous step have
numerous small specks through out the picture  all we
care about is a continuous patch of green of reasonable
size  to achieve this  the following steps are used 
i  the picture is divided into uniform grid lines in x
and y directions 

   

   

ii  along each line  the indices of the green pixels are
stored in an array 

   

   

iii  every element except the chunks of pixels that
increase at the rate of   per array index  with some
error margin  are removed 

   

   

   

   

   

   

   

   

   

fig     boundary detection and initial segmentation

the purpose of the estimation is to provide an initial
guess for the k value used in the k means clustering in
the next step  in this study  this estimation is realized
by first detecting the boundaries of the continuous
green pixel regions by scanning each line of pixels and
tracking the maximum and minimum indices of
continuous green regions  small gaps are tolerated   and
then segmenting the green pixels into different

iv  once these chunks are identified  the edges reveal
the outer bounds of the estimated trees 
   clustering green clusters into trees
the identified outer bounds of the trees are then
utilized to estimate the number of trees  this is done in
  steps 

 

fics    final project

        

i  maximum and minimum tree diameters  these
parameters are used to identify bounds that are within a
maximum diameter of each other  the centroid of each
estimated cluster is iterated until convergence 
ii  k means clustering  once the number of clusters are
estimated  k means clustering is used to find the
centroids and the proper tree clusters 

step ii  clustering
the boxes obtained from the estimation step are very
coarse boundaries of individual trees  to capture the
shape of individual tree cluster more accurately  we use
k mean clustering to cluster the green pixels  the
number of rectangles obtained in estimation step is set
as k  the center of each rectangle is used to initialize
the position of each centroid  example clustered images
are shown in fig    and fig    

as shown in fig     some green clusters can be
illusive  and not actually trees  having separated out
clusters of green pixels  now we want to examine if each
cluster is really a tree or not  this is a standard image
classification problem solvable using svm  the features
are selected as some smoothness measures of the green
regions  such as the mean and the variance of the pixels
values  a non tree cluster usually has too much or too
little variance  so we need to use at least a second order
dependence on the variance  a possible choice of the
feature vector is 
           
   
ff   fi   fi  ff    
  fi  
which is seen to perform reasonably well for this
particular application 
the training examples are     pre labeled   x   pixel
images chosen by our team members  fig      
tree examples

   

   

non tree examples  high variance 

   

   

   

non tree examples  low variance 
   

   

   

   

   

   

   

   

fig     k mean clustering of green pixels
fig     training examples of tree   non tree clusters

step iii  classification
after classification  the number of trees can be more
accurately determined  as shown in fig    
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

    

    

fig     example with non tree green clusters

   

   

   

   

   

    

    

fig     classification rejects non tree clusters

 

fics    final project

        

hierarchical k mean clustering

   

   

the aforementioned method works well for small size
problems  i e  when the number of trees in the image is
small  when the number is large  the k mean clustering
step takes very long to converge  and the final centroid
locations are also less predictable 

   

   

   

   

   

   

   

   

   

    

    

   

fig      hierarchical clustering  recursion depth     
   

fig     shows an example of how the hierarchical kmean clustering method works  for large scale images
with a lot of trees  this method is seen to be more
accurate and much faster compared to the direct
estimation clustering classification method 

   

   

   

   

   

   

   

   

   

    

    

fig     a more complicated example with many trees

references
    levner  ilya  et al   learning robust object
recognition strategies   the  th australian and new
zealand conference on intelligent information
systems       

   

   

   

    gougeon f  and leckie  d   forest information
extraction from high spatial resolution images using an
individual tree crown approach   technical report 
pacific forestry centre       

   

   

   

   

   

   

   

   

    

    

fig      initial segmentation of green clusters

an alternative approach is to recursively find the
number of trees in the image using hierarchical k mean
clustering  i e  each time we divide the image into two
domains using clustering of k    and run estimation on
each part  if the estimated number of trees in a subimage is small enough  we can directly apply the kmean clustering followed by classification as before 
otherwise we further divide the sub image into two
halves  and recurs on each half  finally  we add up all
the number of trees in each sub image to get the total
number for the whole image 

    maloof  m   langley  p   binford  t   nevatia  r  
and sage  s   to appear   improved rooftop detection in
aerial images with machine learning  machine
learning 
http   www kluweronline com issn          

 

fi