cs    final project

 

generating load profiles from building
characteristics
robert clain
stanford university
rclain stanford edu

abstractthe goal of this project was to create an electrical
load profile generator for commercial buildings that would be as
accurate as possible given minimal input  building characteristic
data came from a cbecs survey  and sample profiles came
from nrel simulations  a scoring method for produced profiles
combining mean  spread  and correlation was created  baseline
performance was determined using dc component regression and
nearest neighbor models  each rated using an average score of
    randomly left out samples  a multivariate regression model 
fit in the frequency domain  was created to reduce the bias of
the dc model and improve correlation  however  this model was
not better than using nearest neighbor due to phase mismatch 
a clustering approach to increase the bias of nearest neighbor 
grouping by medoids  improved correlation score  an added
scaling factor further increased the total score  lastly  matrix
completion was used for profile generation  results were better
than those from regression  but worse than those from clustering 

i 

i ntroduction

in community planning and electrical system simulation  it
is often desirable to have accurate profiles of loads  typically
at the building level  for example  one may want to know
if a proposed facility  consisting of multiple buildings  can
meet its own energy needs throughout the year with solar
panels  for another case  a building load profile may be needed
for simulating the performance of some energy consumption
optimization routine  if a building is metered  this data will
be available  but the building may not be metered due to
expense  the building may not exist at the time of study or
will never actually exist at all  while it is possible to create a
fairly accurate profile using simulation  for example  with the
software energyplus   this process can be time consuming and
the detailed information required to make the model may not
be available  because of these issues  the goal of this project
was to create a quick and fairly accurate method for generating
a load profile given a subset of building characteristics 
several models were trained in this study  using a combination of survey data collected by the doe  department of
energy  and simulation data from nrel  national renewable
energy laboratory   the survey data is from the      cbecs
 commercial buildings energy consumption survey       and
the simulation data comes from energyplus models created
by nrel using the information from this particular cbecs
survey      the cbecs survey is conducted approximately
every   years  and includes building information such as square
footage  building use  occupancy  and total energy used per
year  the simulation study     includes yearly load profiles
with   hour intervals  in joules  for most buildings from the
survey 
analysis of cbecs data     and load profile generation
         have been done before to some degree  unlike these
studies  the whole yearly profile is being generated for any
general building 

ii  data c ollection
the selected features from the cbecs fall under the category general building information and energy end uses 
these survey results were chosen since it is desirable to create
profiles using information that can be easily obtained  the
survey results were further paired down by removing variables
with over     missing values  those with single categorical
response  and those not useful for prediction  such as survey
respondent id  variance  etc    the final subset of features is
shown in table i 
table i 
region 
sqft  
elused 
fkused 
stused 
climate 
rfcns 
eqglss 
nfloor  
govown 
ownocc 
monuse  
open   
opnwe 
nwker  
ht  
watr 
manu 
adjwt  

g eneral b uilding f eatures

census region
square footage
elec  used
fuel used
steam used
climate zone
roof material
equal side glass
  of floors
gov  owned
owner occup 
months used
open   hr day
open weekend
  employees main shift
energy  nd heating
energy water heating
energy use manuf 
building weight

cendiv 
pba 
ngused 
prused 
hwused 
wlcns 
glsspc 
bldshp 
yrcon  
owner 
nocc  
porvac 
opnmf 
wkhrs  
ht  
cool 
cook 
genr 

census division
principal building activity
n  gas used
propane used
hot water used
wall material
percent glass
building shape
year constructed
owner
  businesses
vacancy
open m f
weekly operating hrs 
energy use heating
energy use cooling
energy use cooking
energy use generation

every asterisked variable is continuous  while the others are
categorical  the nrel simulation results  existing stock only 
were aggregated and then matched by respondent id to the
cbecs features to create the full dataset  containing survey
results and load profiles for       buildings  buildings with
poor survey responses were discarded  mostly na values  
leading to an eventual       samples 
iii  e rror e stimates
a custom measure of load profile similarity was created
for calculating training and test scores in order to capture the
qualities of the desired output  these qualities are generally not
present in a standard metric  for example  a sum of squares
difference may prefer a flat signal that is closer to the true one
than one that oscillates in tandem  here it was assumed that
there are three desirable traits 
 the generated and true profile are comparable in magnitude 
 the generated and true profiles have similar variation in
electricity use over the domain 
 the patterns present in the true profile are present in the
generated profile  and they align properly 
since there exist individual standard metrics for these properties  a weighted combination of measures was used  albeit
with a somewhat subjective choice of weights  which may
change depending on application   the final summed measure

fics    final project

 

comparing the real and predicted profiles  denoted m  sr   sp   
is 
w 

 
 
  w 
  w  dcorr sr   sp  
    n ae  
    n ae s 

   

all terms are between   and    the first is a transformed
normalized absolute error of the difference of means between
signals  normalized with respect to the true signal  the second
term is a similarly transformed normalized absolute error
of the difference of spread between signals  maximum 
minimum   and the third is the distance correlation  measuring the linear relationship between signals  the weights chosen
were           and     respectively to get a result between
  and    a perfect match yields a    while the worst match
yields a   
the predictive power of each model was estimated using an
average of scores from     randomly left out samples  left out
one at a time from the training set  then tested   while this was
not ideal and a more robust cross validation is desired  such
computation is prohibitively expensive given the nature of the
similarity metric and the size of the data  the average of each
term in     and the average final measure have been reported
for comparison 
iv  baseline m odels
two simple models were chosen to compare against others 
one is k nearest neighbors  with k       which simply picks
the closest profile from the dataset  another is dc regression 
which regresses on a single frequency component of the
response  even though many are present 
a  nearest neighbor
the distance measure used for knn was non obvious  as
there is a mixture of continuous and categorical variables in the
dataset  two different methods were used  both of which first
scaled the data to be centered and have unit variance  for the
first  the nearest neighbor was determined using the continous
variables  euclidean distance  with unlikely ties broken by the
number of identical categorical variables  hamming distance  
as many of the important variables found in     are continuous 
the second method used all of the variables with dummy
variables introduced for categorical features  the score results
are summarized in table ii and figure   shows the scores of
the second method 
table ii 
method   set
  training
  test
  training
  test

mean score
 
         
 
         

fig    

nearest neighbor score histograms

regression  results are within the minimum and maximums in
the dataset  any negative values predicted by the first method
were set to equal   
the training and test score results are summarized in table
iii  these values for linear regression actually represent the
scores from fitting on purely sqft   as it was found it gives
an r  of       compared to r           when using all of
the predictors  a histogram of scores for the linear regression
is shown in figure   
table iii 
method   set
  training
  test
  training
  test

mean score
         
         
         
         

dc r egression s core
spread score
         
         
         
         

correlation score
         
         
         
         

total score
         
         
         
         

n earest n eighbor s core
spread score
 
         
 
         

correlation score
 
         
 
         

total score
 
         
 
         

though the resultant score seems very good  the method is
highly variable  as evidenced by the histograms and difference
in training test scores 
b  dc component regression
a regression approach was also used as a baseline as it
is more biased than nearest neighbor and has the ability to
generate a profile outside those seen in the training data  as the
true responses are high in dimension  regression was performed
on the simplest component  the frequency   amplitude  two
methods were used here as well  the first method is a pure
linear regression  while the second is a random forest regression  the second approach was chosen since unlike linear

fig    

dc regression score histograms

only the first score component is affected by dc regression 
as a flat signal has no spread or movements to correlate  this
value is close to that achieved from nearest neighbor  the
regression is very biased  hence the similarities in training and
test scores 
v 

f requency d omain r egression

the first attempt at a more complicated and more accurate
model was to create a multivariate multiple linear regression
on the amplitude and phase of different frequency components
of the responses using a truncated fast fourier transform

fics    final project

 

 fft  using all of the predictors  the decision to truncate the
transform was based on the notion that while more frequencies
may generate a better profile  if the sinusoids are not aligned
the resultant signal may look like garbage  due to incorrect
constructive and deconstructive interference   since each load
profile has a well defined minimum energy usage  and truncated fourier series tend to have too much swing beyond this
point  the minimum was also included in the model as a lower
bound 
for each signal  an fft was performed and the k frequencies with the largest amplitudes were stored  afterwards 
the k most common frequencies stored across all signals
were chosen to represent every response signal  increasing k
had diminishing returns on improving similarity to the true
responses  by visual inspection  it was determined that k     
yielded fairly good results while still being small enough in
value  a histogram of the common frequencies for this k is
shown in figure    and a sample truncated series is shown in
figure   

fig    

fft regression score histogram

predictions were quite reasonable  the phases did not match
up  making the recombined signal appear distorted  on closer
inspection  it appeared that the phases congregate around
certain values in the dataset  early attempts to address this
issue involved using k means to cluster the phase values  using
minimum angular distances  and predict them separately from
amplitudes  this method had poor results  another attempt to
fix the issue removed close frequencies  taking frequencies
based on power spectra instead of fft   this did not seem to
improve results much 
vi 

fig    

common frequencies with large amplitude

fig    

sample transformed response

prior to regression  the phase components were also altered
to lie in the range   to    the resulting scores are shown
in table iv  a second method  using a multivariate regression
tree  was also shown as this was done for dc regression  the
histogram of these scores for the linear regression method is
shown in figure   
table iv 
method   set
  training
  test
  training
  test

mean score
         
         
         
         

fft r egression s core
spread score
         
         
         
         

correlation score
         
         
         
         

m edoid c lustering

clustering was pursued further due to the poor regression
results in comparison to nearest neighbor  the clustering
approach selected  k medoids  is similar to k means except
values are selected from within the dataset  in this case k
representative signals were selected from the dataset and group
labels were assigned  this was preferred since the method of
generating the centroid is again non obvious  since correlation
is the most heavily weighted term and the full similarity metric
is computationally inefficient  a similarity matrix was generated using pearsons correlation distance  somewhat related to
the distance correlation  the number of groups was selected
from a finite set by choosing the result with the lowest test
error for the third term in the similarity measure  this value
was selected to be     classification for the group labels used
a support vector machine with a linear kernel  with error being
calculated between the true signal and the reference signal for
the predicted label  results are presented in table v and figure
  

total score
         
         
         
         

while the fft regression did increase the correlation score
compared to dc regression  performance still fell short of the
nearest neighbor score  this is because while the amplitude

table v 
set
training
test

mean score
         
         

m edoid c lustering s core
spread score
         
         

correlation score
         
         

total score
         
         

while the correlation score was improved upon over nearest
neighbor  the mean and spread scores were severely reduced 
this is because they were not taken into account in generating
the similarity matrix 
vii 

m edoid s caling

since it appeared there was a common pattern to the
mean and spread scores for which medoid clusterig poorly
predicted  a second stage prediction for mean value was carried
out within the predicted group using a random forest  the

fics    final project

fig    

 

medoid clustering score histogram

fig    

mean was then divided by the mean of the centroid to get
an appropriate scaling factor  this method had very good
results  the correlation score was very similar to what was
achieved earlier and the mean spread scores improved  results
are shown in table vi and figure   
table vi 
set
training
test

fig    

s caled m edoid c lustering s core

mean score
         
         

spread score
         
         

correlation score
         
         

total score
         
         

scaled medoid clustering score histogram

viii  m atrix c ompletion
lastly  matrix completion was used in an attempt to create
a prediction signal  matrix completion attempts to make the
dataset matrix  with the predicting features and na responses
tacked on  low rank  as attaining low rank implies matching
correlations between data  and the signal quality is primarily
scored by correlation  it was thought this method may give
good results  specifically  alternating least squares was used
to fill in the missing values  results are shown in table vii
and figure   
table vii 
set
test

mean score
         

m atrix c ompletion s core
spread score
         

correlation score
         

profiles  upon examination  looked much better than those from
regression but contained a lot of noise  in addition  they seemed
to be somewhat restricted in the types of profiles that could be
produced  for example  all had a central peak   the means and
spreads are of correct proportion  but typically a few orders of
magnitude off of the true values  leading to many mean and
spread scores near      
ix  c onclusions
the small number of predictors and size of the output made
it very difficult to generate a representative signal  clustering
was found to give the best performance  it was the only method
found to give better results than the baseline nearest neighbor 
while regression by itself did not seem to work well  clustering
was noticeably improved by regressing on metadata extracted
from the profiles  creating a scaling factor from predicted
mean  after they had been grouped 
the profiles from this study are much less homogeneous
than those in the references  which may be why generative
approaches failed  a gam seemed to work well in      but
that regression was for much more similar buildings  homes 
and used data purposefully left out of this study  such as total
yearly consumption  
future work could improve upon a number of aspects of this
study  first  a more computationally efficient metric calculation
would better facilitate cross validation  which was limited here
to fewer random samples  the measures for mean and spread
could also be adjusted to use a log scale for representing order
of magnitude difference  as many of the values were close to
     which represent      difference   a more robust feature
selection  where terms from other parts of the survey were
selected and some used here were discarded would also be
useful if it would limit the information required as input for
the profile generation or improve performance 
r eferences
   
   
   
   

total score
         

these scores are better than those from regression  yet
worse than those from nearest neighbors and clustering  the

matrix completion score histogram

   

commercial buildings energy and consumption survey  cbecs        
http   www eia gov consumption commercial data      
national
renewable
energy
lab
simulation
data 
http   en openei org datasets node    
t  sharp  energy benchmarking in commercial office buildings  oak
ridge national laboratory  tech  rep        
r  a  a  a  abdelbaset ihbal  hs rajamani and m  jalboub  the
generation of electric load profiles in the uk domestic buildings through
statistical predictions  journal of energy and power engineering  pp 
        february      
s  heunis and m  dekenah  a load profile prediction model for
residential consumers  energize  pp        may      

fics    final project

 

a ppendix
sample results   below are profiles generated for the first    samples in the dataset using the various approaches  this subset
does not represent profiles related to testing scores  in fact  for this small subset  nearest neighbors scored abnormally high for
the correlation term and medoid clustering scored lower   but is meant to demonstrate some of the issues encountered 
real profile

nearest neighbor

dc linear reg 

fft regression

medoids

scaled medoids

matrix completion

fi