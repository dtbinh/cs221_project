computer science    
december         
primary authors  paul i  quigley     jack l  zhu   
comment to piq   stanford edu  jackzhu stanford edu

decoding the human motor cortex
abstract  a human beings motor cortex becomes engaged when he or she performs specific
motions  however  little is known about the relationship between the regions in the motor cortex  neuroscience has not reached consensus over how motions for specific joints relate  or how
engagement changes when a motion is performed more forcefully  we obtained fmri bold scans
of subjects motor cortices as they performed various movements  we found that we could distinguish between movements with considerable accuracy  moreover  we confirmed that these techniques
relied solely on data within the motor cortex  not skull movement or other disruptions 

background  brantner experiment

a recent paper authored by members of the stanford
artificial intelligence laboratory  svm based classification of motor tasks on fmri bold     explored the
technique of classifying motor tasks to gain insight into
the structure of the motor cortex  we were inspired to
first replicate their results  in order to verify our implementation of the machine learning techniques  and also
to gain insight into where their model and techniques
fell short  in their experiment  a subject performed one
of ten tasks while being monitored by an fmri scanner 
during each task they were either holding a light      kg 
or heavy     kg  weight  table   lists these tasks 
table i  the list of tasks  for simplicity in later results 
each task was given a number      
task    light heavy 
   
   
   
   
    

motion
wrist flex
wrist rotate
elbow flex
shoulder flex
shoulder rotate

each of three subjects performed a total of     motions  the pertinent data gathered from the experiment
was a measurement of the activation in each voxel  a
             mm  region in the brain  the scan area was
a rectangular prism of            voxels  resulting in
a scan volume with a total of        voxels  the fmri
volumes were taken every      seconds 
the data was preprocessed with glmdenoise  a software package by kay et al      glmdenoise uses statistical methods to derive global noise regressors for use in
a general linear model  glm  analysis  glmdenoise
denoises the raw time series data  and produces a modelmd volume for each task type  that represents the peak
percent signal change in the bold  blood oxygen level
dependant  signal when it is fitted to the haemodynamic
response function  hrf   each of the modelmd volumes represent  intuitively  which voxels gave the clearest

signals of engagement during a task  figure   and figure
  are examples of such modelmd volumes  corresponding to the unweighted wrist flex and unweighted elbowflex movements  respecitvely  looking at the figures  it
is visually evident that the activation regions are different for different motions  this is a strong indication that
distinguishing between motions using fmri data may be
an appropriate machine learning task 

fig       highlighted have voxels modelmd scores above a
threshold for the unweighted wrist flex 

fig       a different  though not disjoint  set of voxels exceeds
this threshold for the unweighted elbow flex 

in brantner  an svm was trained with the following
model  a subject performed tasks p and q each p and
q times respectively  define a time interval around each
task so that a total of t measurements were made during each time interval  also  choose some set of voxels
v    v         vj    now for each voxel vk we will measure
its activation at some time t within the interval for the
motion r  we can denote this atr  vj    we seek for each
of our training examples to contain information about

fi 
every voxel over the entire response  so we have p   q
training examples of the form 

a i  v   
     

 t
a  v   

 i
     


 

      
 a  vj   

 i
     
ati  vj  


x i 

y

 i 

 
  
 
  

if ith task is p
if ith task is q

brantner achieved the highest classification accuracy
when they let v be    voxels sampled from the top    
r  voxels  see voxel selection for more detail   and a
time window of       seconds 

fig       confusion matrix  ijth cell represents the accuracy
of classifying task i vs  task j

fig     an example of the time series features of five high r 
voxels 

replicating results
fig       each comparison is colored according to its group 

we used this model  and ran an svm with a linear kernel  using smo and leave out one cross validation  the
svm implementation we used was matlabs svmtrain
and svmclassify  in the statistics toolbox  we obtained
results nearly identical to those reported in brantner 
who used the libsvm implementation  we used nonlinear kernels as well  but found much lower classification
accuracy  as in brantner  we see a curious a result when
we divide our comparisons into   groups  in group    we
compare light weight tasks to other light tasks  in group
   heavy to heavy  in group    light to heavy  in group   
we compare light to heavy  but of the same motion 
we see that our accuracy is significantly lower in group
   barely over      while the other groups have accuracies of about      a central goal of our project was to
explore the causes of this lower accuracy in group    and
devise ways to raise it 

fig       the average accuracy for comparison within each
group  group   shows notably lower accuracy 

fi 
voxel selection

in brantner  voxels were included in v based on their
high r  values  calculated by glmdenoise  the r 
value indicates the variance in the time series response for
that voxel expalained by the onset of the task  like the
modelmd scores  these serve as an indicator of which
voxels showed the clearest signs of engagement  unlike
the modelmd scores  these take into account responses
over the entire experiment  not just one task  the logic
is that the voxels with the highest r  are most reliable 
however  in brantner it was not explored where these voxels actually were  we built a data visualization pipeline
to plot the location of specific voxels on to an image or
 d model of the brain 

fig     the top modelmd voxels for the unweighted  left 
and weighted  right  wrist flex  both are located in the same
region  but have different values  see figures   and   for
comparison 

mi  vk     max a i  vk         ati  vk   
then in this new model

x i 
 a  

 b  



mi  v   
       
mi  vj  

under this model  we were able to achieve higher accuracy for group    over      moreover  we found that we
could include a larger number of voxels  and still achieve
accurate classification  the other groups showed slight
decreases in accuracy under this model
 c  

 d  

fig       the top voxels by r     a   top     b   top    
 c   top      d   top     

the top    r  voxels are clearly located in the brain 
and are located near the motor cortex  the top     r 
voxels begin to include some voxels in the skull  with the
top      voxels  many skull voxels are included  brantner found that the classification accuracy began to decrease when including voxels outside of the top      see
conclusions for discussion of the possible implications
of this finding  in light of our visualization 

maximum model

based on the findings from our visualization pipeline 
 see figure    we designed a new model  instead
of including the entire time series for each voxel 
 a i  vk         ati  vk     we included only the maximum engagement achieved over that time series  formally  if we
define

fig     when we the maximum model  we were able to
achieve over     accuracy in group    even when using large
numbers of voxels 

voxel sphere search

our visualization pipeline showed us that the top   
r  voxels and the top     r  were relatively clustered 

fi 
using voxels from each of these groups gave relatively
high accuracy  we considered that we could use every
voxel from this cluster  we wrote a script that given a
radius  in voxel lengths   and center within the brain 
would extract every voxel within that sphere 
formally  for center c and radius r we let
v    v     v  c      r 
for our center  we first picked the centroid of our top   
r  voxels  since this appeared to be roughly the center of
the motor cortex  we then varied the radius  and found
that under this method of voxel selection  we achieved
the highest accuracy across all groups with r     

fig      with our sphere centered at thecentroid of the top
   r  voxelss  we achieved maximum accuracy with a r    
voxel lengths

we then explored various methods of maximizing accuracy with respect to the choice of centroid  our first
approach was a grid search across the voxel space  due
to computational contraints  we were unable to perform
an exhaustive grid search with a significantly small step
size  so we instead formulated a k means centroid search
on the top voxels sorted by r  as a heuristic for good
means to search in  with this technique  we need only
need to train and classify on k spheres  figure    top 
shows the top     r  voxels in the voxel space  and their
respective centroids as estimated by k means  figure  
 bottom  shows which parts of the brain these means
correspond to 
for this study  we did not do a rigorous selection for
the value of k  but qualitatively verified that the means
capture clusters within the motor cortex around k      
future analysis may use the elbow method or some other
heuristics for finding the optimal value of k  overall  the
idea of using the k means algorithm to find centroids of
high r  voxels is a good heuristic for optimizing the efforts of the sphere search algorithm because it includes
many of the high r  voxels  but also includes voxels in

fig      we created balls around our means within the top
    r  voxels  we used these means as the centroids in our
voxel balls  top  in three space  bottom  centroids projected
on to the brain

their vicinity  if these voxels are part of some cluster
in the motor cortex that correlates well to one of these
motions  this algorithm may be able to detect and identify that cluster  in this study  however  we were unable
to find any correlations between the task group and the
cluster that had the highest classification accuracy 

summary of results

table ii  time series model  the classification accuracy
for each group using the time series model by voxel selection
group  
 
 
 
 

top    r 
   
   
   
   

top    
   
   
   
   

top     
   
   
   
   

ball  r   
   
   
   
   

fi 
table iii  max model  the classification accuracy for
each group using the max model by voxel selection
group  
 
 
 
 

top    r 
   
   
   
   

top    
   
   
   
   

top     
   
   
   
   

ball  r   
   
   
   
   

conclusions

perhaps the most significant conclusions from our
project is also the simplest  using our visualization
pipeline we showed that all of the top          r    moreover  these voxels were around the region classically defined as the motor cortex  outside of this range  more
of the top voxels were located in the skull  brantner
found that using voxels outside of this range decreased
classification accuracy  with our visualization  we may be
able to attribute this decrease to rising portion of skullvoxels  brantners classification accuracy within the       range is then indicative of the ability to learn the
identity of motor tasks from motor cortex data 
another significant finding was that the max model
provided higher classification accuracy for group    including only the maximum bold response instead of the
entire time series removes information about the shape of
the response to a motion and its delay  since the group  
comparisons were between tasks of the same motion and
and different forces  the fact that we were able to classify more accurately without this information  for group
  but not the other groups  may imply that it is only the
amplitude of the bold response  and not the shape or
delay that changes with force 
we were unable to draw any strong conclusions from
the use of our sphere search method  our goal was to
use this algorithm to find distinct clusters in the brain
that provided greater classification accuracy for different
tasks and groups  in particular  finding a cluster that
gave highest classification accuracy for group   than the
other three groups could have been strong evidence for
the theory that there exists a seperate region in the brain
that encodes for force  we were unable to find any evidence of this claim  however  we still believe that this
method could be a powerful tool for future researchers 
as we discuss in the next section 

further research

several steps could be taken for further  more accurate results  and a greater understanding of the motor

cortex  we believe the first step that should be taken
in future research is gathering more training data  since
had only     motions per subject  we assumed that the
data would be specific to a subject  in other words  that
training an svm on data from subject a for classification
of data from subject b would not be reliable   exploring
whether or not this is possible to classify accurately with
such an svm may be an interesting topic for future research   this meant that we were training an svm on a
relatively small amount of data  scanning the same subjects over multiple sessions would be one way to gather
more motions per subject without having to keep subjects in an fmri scanner for too extensive a period of
time 
had our sphere search been successful  the implications
would have been strong  finding distinct clusters of voxels which classified best for different tasks  could imply
that these clusters were control centers for their respective tasks  we believe that our sphere search is a powerful
method  because it does not rely on the number of tasks 
the type of tasks  or any prior knowledge on the structure
of the brain  we expect it will be a useful tool in the future when we use haptic robotics with a much larger task
set  unfortunately  performing the full grid search over
the entire voxel space would have taken an exceedingly
long runtime  and even if we could have performed this
grid search  the actual regions that encode for motions
may be much smaller than our              mm  voxels 
in fact  a neuron is about     mm in diameter 
overall  there is a lot of work to be done to fully understand the motor cortex  but we believe we made significant progress over the course of this project 

acknowledgements

we would like to thank our advisor samir mennon
for providing us with data and guidance throughout the
quarter 

references

    brantner  g   menon  s   schoepp  g   khatib  o  svmbased classification of motor tasks on fmri bold data
    kay  k n   rokem  a   winawer  j   dougherty  b   wandell  b a  glmdenoise  a fast  automated technique for
denoising task based fmri data

fi