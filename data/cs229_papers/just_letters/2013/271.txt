cs      machine learning final report
identifying driving behavior from data
robert f  karol
project suggester  danny goodman from metromile
december   th     

problem description
for my project  i am looking into how the driving behaviors influence the fuel efficiency of different
vehicles  danny goodman  with metromile  has provided me with a set of data consisting of accelerometer  heading  speed  and gas usage information which i am using in order to determine how efficient a
given driving style is  the goal of this project is to identify techniques which people could use in order
to save fuel which has become a significant cost in the lives of many americans 

data parsing
initial work needed to be done in order to parse the data into a usable format in matlab  since each
set of data came in a different file  each file had to be parsed  imported into matlab  and manipulated
into an easy to access form  in particular  each file contains months worth of trips  and each trip needs
to be separated out in order to determine when a car stopped and restarted  in order to do this i
looked through the timestamps of data points  and whenever there was a gap greater than   seconds
between data entries which should be occurring at a rate of   per second  i recorded it as a new trip 
then  any trip which lasted less than a minute was removed as short trips could introduce too much
variability into the gas consumption since gas consumption is given as an instantaneous quantity so by
coasting with the car an artificially high efficiency can be created 
all of the data came from small units which have been attached to the on board car computer which
is where measurements of gas consumption come from  since every car is different the measurements
coming from each vehicle have slightly different noise characteristics  the unit has a built in accelerometer and magnetometer  so while the data might be noisy  or be off by a scale factor with bias  the data
from each vehicle should be consistent  in total  there is data from    different cars which collected
data for months on a number of different trips  the data collected does have a few major problems
which need to be addressed 
one of the biggest problems with the provided data is that the accelerometer is misaligned in ever
vehicle  this means that the data must be transformed from the reference frame of the accelerometer
to the reference frame of the car before it can be used  additionally  the data was collected at a rate of
  hz  while this is not a problem for heading data  it makes the accelerometer data extremely noisy 
this is a problem which might skew the final values calculated for some quantities of interest  however 
it shouldnt be a problem for spotting the important fuel consumption trends  a second problem for
which there is no correction is the presence of multiple drivers in a single vehicle  while we are able to
separate out the data obtained from each vehicle  there is no information available who is driving  or
what the road conditions happen to be  this could become quite a serious issue if different fuels are
being used  one example would be the different energy densities contained in the summer and winter
 

fifuel mixtures that exist in california 
i wrote a series of matlab scripts which import the data and put it in a more useful form  first 
i wrote a script which parsed through the csv file  and saved all of the data into a  mat file as given
in the dataset  this way  the data is much more accessible since it doesnt have to be imported for
every use  a second script was written in order to take the instantaneous data  and integrate it over
time  this way i was able to get estimates of the total gas consumption and distance traveled for each
trip the car took  using this data i was able to work out the average fuel consumption for a given trip
without as much error as is achieved by averaging the raw data  a second function was written capable
of plotting the path the car by combining information gained from both the heading information  and
instantaneous speed  this helps to determine how the car was moving for a given trip adding to the
intuition of what is going on for a given trip 
the most difficult data parsing task has been working with the accelerometer data  this is some of
the most important data collected since acceleration is a huge part of fuel consumption  however  the
misalignment problem is very difficult to deal with  in order to determine the correct orientation for
the car i determined the times when the car was stopped  and used the average accelerometer values to
determine what the gravity vector was  using this information i was able to reconstruct the rotation
matrices necessary in roll and pitch to move the gravitational vector to point straight down  while this
orients the gravity vector and determines   directional components  it is unable to determine which
direction the car is facing relative to the accelerometer  in other words  we are unable to determine yaw
using this information  in order to determine a value for yaw  i had to use my knowledge of what the
x and y accelerations should be  by finding the parts of the data where the car was moving relatively
straight  and using the fact that accelerations should be located in the x and z directions where positive
z points down  x out the front of the vehicle  and y out the right side  by choosing the yaw value so
that the acceleration is concentrated in the x direction while the heading is not changing  i was able to
estimate the overall vehicle orientation 

sample trip
figure   shows some sample data from a typical trip  the speed  distance traveled  gas consumed  and
an estimated path along which the car traveled  this gives a decent idea as to how useful the data
might be  as well as which features might be worth looking into in order to save gas  over the course
of my projects i plotted a number of other features  some of which i thought were highly relevant to
fuel efficiency  others which should have no affect 
 

  
  
  
 
    

    

   

 
 

    

 

    

   
   
   
 
 

    

    

time

    

    

time

    

yposition  meters 

time
   

unused trips
high efficiency trips
low efficiency trips

 

 
 

gas consumed  gallons 

   

miles per gallon

distance  km 

speed  mph 

  

    

   

   

   

   

    
   

    
 

 

    

 

    

 

xposition  meters 

   

 

   

 

trip

figure    dividing trips by efficiency 

figure    example of a typical trip 

 

   
 

x   

fidefining efficiency
the first step in identifying features of high or low efficiency driving is to determine what constitute
a high or low efficiency trip  first  i defined the efficiency of a trip by the total distance traveled in
a given trip divided by the amount of gas consumed  in order to do this i used k means clustering to
find two separate natural groupings  these two groups nicely divide the trips into lower and higher
efficiency categories  by using k means rather than sorting the trip efficiencies and dividing it at the
median  or using a parameter like half the maximum efficincy  we can get more natural groupings which
are less biased by outliers  additionally  there is no reason for a fixed percentage of the trips to be
considered efficient 
due to the nature of the data collection  some trips may have been cut off after a long period of coasting 
or slowing down  another possibility is the trip only includes time when the car was accelerating if the
data dropped out before cruising or slowing down  as can be seen in figure   there are certain trials
resulting in unrealistic efficiencies  in particular those with efficiencies of hundreds of miles per gallon 
or near   are probably not the trips to focus on  in order to remove some of these anomolies  only
the second and third quartiles of data are used removing the outliers in each of the two categories  in
figure   the red points indicate trips categorized as high efficiency trips while the blue points indicate
low efficiency trips  the remaining black points represent trips considered outliers in either of the two
categories 

features
since the goal of this project is to determine relevant features which a user can keep track of in order
to help maximize the fuel efficiency  i used the data provided to come up with    potential features
which a driver could keep track of with relative ease if these features ended up being relevant to gas
consumption  using the data provided  i came up with a list of    features to look into for determining
their relative importance  the following features were chosen for this analysis 
in particular i looked at the maximum and mean values of various quantities as these would give a
decent estimate of how the magnitude of these quantities directly affects fuel efficiency  by looking at the
standard deviation of various quantities  i am able to get an idea of the affect that more stable quantities
have as opposed to changing quantities  finally by looking for peas in the fourier transformation of a
variable i can try to see if any natural cycling occurs in a variable and determine how important such
cycles could be 
p
 total acceleration   x acceleration    y acceleration    z acceleration   
 maximum  mean  standard
deviation  peak in fourier transform
p
 planar acceleration   x acceleration    y acceleration   
 maximum  mean  standard deviation
 x  y  and z accelerations
 maximum  mean  standard deviation  peak in fourier transform
 speed
 maximum  mean  standard deviation
 heading
 maximum  mean
 total distance 
 maximum
 gas used
 maximum  mean  standard deviation  peak in fourier transform

 

fipca
one of the first tests i ran was a principal component analysis  in order to determine what combinations
of features contributed to the largest variation across trials  while a linear combination of features may
not be the best for giving drivers a concise and easy to remember set of instructions for reducing their
fuel consumption  i thought that it could provide some useful insights into the data itself  as well as
the particular features i choose to use  by examining the results of the principal component analysis 
the following results appear 
     of the variation in by the data is primarily due to the maximum and mean of the heading information  while this makes intuitive sense as heading is completely independent of all fuel efficiency
since the same trip can be done with any orientation with respect to north 
by including the maximum and mean speed  as well as the total distance      of all variation is explained  once again though  total distance traveled is completely irrelevant towards overall efficiency 
from these results i determined that while there might be better separation along a reoriented coordinate system  in order to perform feature selection it would be better to choose between the initial
features rather than a linear combination to maximize variance 

feature detection
the most important part of this project is the feature selection algorithm to determine which features
contribute the most to predicting high or low efficiency driving  in order to accomplish this  i decided
to use a linear kernel for a support vector machine in order to determine which features  when removed 
would affect how the data was separated the least  i developed a cross validation scheme which would
take a matrix containing all the trials  train a support vector machine using a linear kernel on     of
the data  and test it against the remaining     of the data to determine the number of classification
errors  this is repeated    times  each time holding out a different     
using the cross validation scheme described above  i used the following feature selection algorithm 
first  i ran the cross validation scheme on the matrix of trials and features    times  once each using
the matrix of trials and features having removed a single feature  be comparing the cross validation
error in each of these cases and selecting the one with minimal error  we could find which feature was
least important in data separation since the support vector machine was capable of perfectly separating
the data using all    features  this procedure was run repeatedly to determine the next least important
feature which could be removed  resulting in a ranked list of least important to most important features
for separating the data 
in the end this method indicated the following ranking for the most important features which would
contribute the most to determining high and low efficiency driving 
   average speed
   average gas used
   standard deviation of gas used 
   standard deviation of the planar acceleration
   average of the planar acceleration
   standard deviation of the y acceleration
   maximum of the planar acceleration
 

fiwhile this feature selection algorithm is not perfect  it does give us a good idea of what driving
techniques might cause higher gas usage  what this method does not do however  is distinguish which
of these features come from driving habits  and which come from natural road features  for example 
highway driving vs stop and go traffic are very different road conditions which are completely out of
the control of the driver 

svm
i have included a plot from the final run of the support vector machine cross validation to see how
well separated the data is when only using the two most important features identified by the feature
selection algorithm 
 

   

x   

 
 
support vectors

   

average gas used

   
   
 
   
   
   
   
 
 

  

  

  

  

  

  

  

  

average speed

figure    separation using only the   most important features 
using these two features alone  prediction errors are significantly lower than    

conclusion
in the end  the goal of this algorithm was to determine a list of features  all easy to compute in real time 
which do a good job at predicting how efficient a driving experience will be  however  more importantly
than that  this algorithm has determined some ways that drivers might be able to reduce their fuel
consumption  reducing average speed  the mean  and standard deviations of the planar acceleration
are two of the most significant which the driver has control over  in particular a driver can save fuel by
reducing the their average speed  while this is not practical in all situations  it suggests that following
the speed limit rather than exceeding it by       miles per hour  is not only safer  but could help
you save on gas  additionally  in situations with stop and go traffic it is best to accelerate slowly so
the average speed is reduced  and smoothly so the standard deviation of acceleration is reduced  this
makes intuitive sense which gives some credibility to the algorithm itself  while this provided for a
good method of predicting efficiency as well  there is less use in that as an individual driver may not
have control over the variables at all times 

 

fi