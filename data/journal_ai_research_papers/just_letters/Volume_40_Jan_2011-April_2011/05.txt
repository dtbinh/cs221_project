journal of artificial intelligence research                  

submitted        published      

the complexity of integer bound propagation
lucas bordeaux

lucasb microsoft com

microsoft research    j j thomson avenue  cb  fb
cambridge  united kingdom

george katsirelos

gkatsi gmail com

lri  universite paris sud   
paris  france

nina narodytska

ninan cse unsw edu au

nicta neville roach laboratory and
university of new south wales
    anzac parade kensington nsw       australia

moshe y  vardi

vardi cs rice edu

rice university  p  o  box     
houston  tx             u s a 

abstract
bound propagation is an important artificial intelligence technique used in constraint
programming tools to deal with numerical constraints  it is typically embedded within a
search procedure  branch and prune  and used at every node of the search tree to narrow
down the search space  so it is critical that it be fast  the procedure invokes constraint
propagators until a common fixpoint is reached  but the known algorithms for this have
a pseudo polynomial worst case time complexity  they are fast indeed when the variables
have a small numerical range  but they have the well known problem of being prohibitively
slow when these ranges are large  an important question is therefore whether stronglypolynomial algorithms exist that compute the common bound consistent fixpoint of a set
of constraints  this paper answers this question  in particular we show that this fixpoint
computation is in fact np complete  even when restricted to binary linear constraints 

   introduction and overview of the main results
constraint solvers typically solve problems by interleaving search and propagation  propagation is an iterative procedure which  at each iteration  propagates every constraint in
the problem to narrow the domains of its variables  the iteration stops when no constraint
changes the domains of its variables  in this case  propagation has reached a common fixpoint for all constraints  this iterative algorithm is guaranteed to compute the fixpoint in
polynomial time if propagating each constraint takes polynomial time and the domains of
the variables are defined as lists of values  very often  however  it is inconvenient or infeasible to list all values explicitly  instead the domains are defined by lower and upper bounds 
we focus on this representation  and on variables taking integer values  in this setting 
computing a fixpoint by the iterative algorithm may require exponential time even if each
constraint can be propagated in polynomial time  we show that this exponential behaviour
is not simply due to the iterative algorithm being suboptimal  rather it is intrinsic to the
c
    
ai access foundation  all rights reserved 

fibordeaux  katsirelos  narodytska    vardi

problem of computing a fixpoint  as it is np complete even when the system of constraints
is restricted to binary linear inequality constraints 
    bound propagation and slow convergence
we illustrate the behaviour of the iterative fixpoint algorithm using a system of two constraints 
x   y      x       y 

with initial bounds 

x          y         

a possible trace of the fixpoint computation is the following  the lower bound of y is
initially   but from the constraint x   y     we deduce that y cannot take values   or   
if it does  then the sum is      even if we fix x to its highest allowed value  therefore the
intervals can be narrowed down to x          y           similarly 
from
from

x   y     
x       y 

back to

x   y     

we deduce 
we deduce 
and 
we now deduce 

x          y
x          y
x          y
x          y

        
        
        
        

at this point we have reached a common fixpoint for both constraints  because we cannot
deduce that the domains need to be narrowed any further 
this algorithm  however  exhibits slow convergence behaviour even in deceivingly simple
examples such as 
x   y  y   x

with initial bounds 

x             y           

   

the iterative algorithm for fixpoint computation shrinks the bounds by one unit in each
iteration  which means that     iterations will be required to reach the fixpoint  which in
this case is empty  this slow convergence is in fact exponential in the size of the problem
representation  as log       bits are enough to represent each bound  this behaviour is not
limited to artificial examples as the previous one but in fact happens time and again when
solving problems with large numerical ranges  this severely limits the application of cp in
areas such as software verification or theorem proving where large ranges are needed  e g  
the whole    bit integer range  
due to the importance of the problem  efforts have been made to alleviate slow convergence  notably jaffar  maher  stuckey  and yap         lhomme  gottlieb  rueher  and
taillibert         lebbah and lhomme         leconte and berstel         but all proposed
algorithmic improvements prevent slow convergence only in specific cases  fully addressing
the slow convergence problem would require a strongly polynomial algorithm for fixpoint
computation  therefore the question is  does such an algorithm exist  or is bound propagation in fact intractable 
    prior complexity results on propagation
standard propagation algorithms are iterative processes that apply propagators  i e   narrowing functions associated with each constraint  until reaching a fixpoint  their complexity
is therefore determined by two complementary questions 
   

fithe complexity of integer bound propagation

q   how hard is it to compute each propagator 
q   how hard is it to find a common fixpoint of the propagators 
the complexity of constraint propagation has in a sense been extremely well studied  but
all the results we are aware of for bound propagation deal with question   only  those prior
hardness results showed that for some complex constraints we cannot have polynomial time
propagators reaching certain levels of consistency  two such results are 
 given a linear equality it has been observed  yuanlin   yap        choi  harvey 
lee    stuckey        that any propagator that reaches arc consistency or bound z 
consistency  needs to solve a knapsack problem  which is np complete in the weak
sense  for this reason propagators for linear constraints used in practice either reach
a weaker consistency such as bound r  consistency  or are restricted to very small
domains  as proposed for instance in trick        
 results by bessiere        prove that even bounded arity  two variable  constraints
can be constructed for which checking bound z  consistency is np complete 
question   only makes sense  of course  in the common case where the propagators are
polynomial time computable  if they are not  computing their common fixpoint cannot be
easy in general   the only known fact in this case is that the standard  iterative propagation
algorithms often take an exponential number of steps to reach a fixpoint in practice  as
mentioned and illustrated in section      this leaves open the question whether better
algorithms exist or fixpoint computation is  in fact  intrinsically hard 
    our main results
in this paper we consider very simple  common propagators and address question    we
show that in general even surprisingly simple propagators can lead to a fixpoint computation problem that is np hard  this not only explains why all standard  iterative fixpointcomputation algorithms have an exponential worst case in practice  but also shows it is unlikely that the there exists an algorithm with better worst case  in particular an important
class of simple propagators whose fixpoint computation is np hard is the bound r  consistency propagators for linear constraints  proposition     these are ubiquitous constraints 
and very weak and widely used propagators for these constraints  many problems that
use numerical computations and large domains tend to include at least linear constraints 
therefore there are few cases where slow convergence will be avoidable  we nevertheless
identify one such case  if the coefficients of the linear constraints are all unit    in absolute
value   then bound r  consistency can be obtained in polynomial time by a non standard
propagation algorithm based on linear programming  we also study other types of basic
numerical constraints  multiplication and max 
    outline
in section   we summarize the required material on constraint satisfaction problems
and bound propagation  section   then focuses on linear constraints  we prove the
   we give the formal definitions of bound r  and bound z  consistency in section     

   

fibordeaux  katsirelos  narodytska    vardi

aforementioned proposition    then identify restricted forms of linear constraints for which
propagation is tractable  section   presents results for some other basic propagators  for
quadratic constraints  the hardness result can be strengthened and holds even for a fixed
number of variables  for max constraints  fixpoint computation has an interesting complexity
 between p and np complete  and is proved equivalent to an important open problem  we
last comment on max closed constraints  we conclude in section   

   formal background
in this section we summarize the required material on constraint satisfaction problems and
bound propagation  more details on this material can be found in papers by e g  schulte
and carlsson         and bessiere        
    constraint satisfaction problems
a constraint satisfaction problem  csp  is a triple hx  d  ci  where  x    x     xn   is
a set of variables  d    d     dn   is a set of finite domains  finite sets of values   one for
each variable  and c is a set of constraints  in this paper we consider discrete domains  all
the elements in d are integers  for the moment we simply define constraints very generally
as logical predicates over subsets of x  later in the paper we consider specific types of
constraints  for instance linear ones  an assignment is a function  that assigns a value
  xi    di to every variable xi   a solution to the csp is an assignment that satisfies the
constraints  throughout the paper  we keep the following conventions 
 n    x  denotes the number of variables 
 m    c  is the number of constraints 
 d   maxi   n  di   is the size of the largest domain 
it is important to note that di may be represented as an interval  rather than an explicit
set of values  in this work  we only consider domains represented as intervals  each domain
is of the form di    li   ui    where li and ui are the lower and upper bounds of the domain 
    propagators and notions of bound consistency
the constraints of the problem are associated with propagators   in our setting there will
be  in general  several propagators per constraint   we follow the classical presentation of
propagators as operators on a lattice  initiated in work by benhamou        and on which
more details can be found in papers by apt         and schulte and carlsson         each
propagator is a function that can narrow the domains of  some of  the variables  removing
values that cannot appear in any solution  thus  we talk about the current domain of a
variable xi   as the result of it being narrowed by the application of one or more propagators 
 

we denote by x
i the current lower bound of xi and by xi its current upper bound  xi
 
and xi are initially set to the initial bounds li   ui and remain afterwards constrained by
 
li  x
i  xi  ui   we denote by d the cartesian product of the intervals  li   ui   for all
i     n 
   

fithe complexity of integer bound propagation

definition    propagator  a propagator for a constraint k     m is a function f  
p d   p d   that is 
 monotone  i e   a   a  f  a     f  a  
 contracting  i e   f  a   a 
 correct  i e   no point in a   f  a  satisfies the constraint 
we restrict ourselves to propagators that are polynomial time computable  bound consistency propagators are additionally restricted to elements of p d  that are representable
as cartesian products of intervals  plus the special value  
several types of propagators can be used for numerical constraints  these propagators
are characterized by the level of consistency they enforce  since we have restricted our
focus to interval domains  we present only bound consistency  the two main variants are
bound z  and bound r  consistency 
definition    bound z r  support  a bound z   bound r   support of a constraint k
 
is an assignment  of integer  real  values to the variables x such that x
i    xi    xi
for i     n and  satisfies the constraint k 
definition    bound z r  consistency  a constraint k is bound z   bound r   consistent iff for every variable xi  x  there exists a bound z   bound r   support   with
  with     x     x   
   xi     x
i
i
i and a bound z   bound r   support 
the difference between the two is easily understood on an example 
example   consider the constraint  x    y    z     
 the intervals x  y  z         are bound r  consistent since each of the integer bounds
has a real valued support  x     is supported by the tuple  x      y      z        
z     and y     by the tuple  x        y      z       x      y     and z     by the
tuple  x      y      z      
 these intervals are  however  not bound z  consistent  the only integer solution is
 x      y      z       which means that bound z  consistency would reduce the bounds
further to x          y          z         
bound z  consistency requires that we check the existence of an integer valued support 
and for some classes of constraints such as linear equalities each propagator would need to
solve an np complete problem  since our focus is on the computation of common fixpoint of
simple operators  we only consider bound r  consistency in this paper  as noted previously
in the literature  schulte   stuckey         bound r  consistency it is in fact the bound
consistency implemented for most primitive constraints  precisely because it is often the
only one for which propagators are easy to compute in general for large domains  in the
rest of the paper we focus on several of the main basic types of numerical constraints  in
particular linear ones   and give further details on the bound r  consistency propagators
obtained for these constraints  in all the cases we consider the propagators are very simple
indeed 
   

fibordeaux  katsirelos  narodytska    vardi

a    d
change    true
while change do
change    false
foreach f  f do
olda    a
a   f  a 
if a    olda then change    true
done
done
figure    a simple fixpoint computation algorithm 
    fixpoints
propagators are monotone narrowing operators  thus we may consider the problem of identifying the greatest common fixpoint of a set of propagators 
definition    greatest common fixpoint  the greatest common fixpoint gfp f   of a
set of propagators f is the largest cartesian product of intervals a  d such that for each
operator f  f   we have f  a    a 
there are two computational problems related to fixpoints 
 function problem  effectively compute gfp f   
 decision problem  decide whether gfp f        i e   whether there exists a  nonempty  fixpoint   note that our definition of propagators implies that f       for all
f  f   therefore  is always a common fixpoint   in other words  do the propagators
stabilize to non empty domains 
as often in complexity work we mostly focus on the decision problem in this paper 
the reason is that the basic complexity classes  np in particular  are defined for decision
problems  and that hardness results on the decision problem also imply that the function
problem is hard  the only place where we refer to the function problem is this section 
where we describe the basic greatest fixpoint computation algorithm 
an algorithm for computing gfp f   is specified in fig     it is presented in its simplest
form  which excludes several possible optimizations related  in particular  to the fact that
not all constraints necessarily deal with all variables   these optimizations are well known
and orthogonal to our discussion in this paper   in this algorithm we initialize the cartesian
 
product of domains to d  in other words we initially have x
i   li and xi   ui   for
all i     n  and we simply apply all propagators until a stable state is reached  i e   no
propagator shrinks any domain further  the reader can verify that this algorithm specifies
formally the reasoning that we presented informally in our introductory example  sec       
   

fithe complexity of integer bound propagation

    complexity upper bound of fixpoint propagation
the worst case time upper bound of fixpoint computation can be analyzed as follows   
let p    f   be the number of propagators   note that we have in general one or more
propagators per constraint  i e   p  m   we enter the while loop at most nd times since
at every new iteration we must reduce at least one bound by one unit  and each time the
foreach loop is entered at most p times  overall the algorithm therefore terminates after a
number of propagator applications of 
o npd  
in other words  it is in fact exponential in the number of bits of the encoding  this complexity
can be written o np b    where b is the number of bits of the bound encoding  this is despite
the fact that each propagator is polynomial in the size of the encoding  such algorithms are
called pseudo polynomial  in contrast algorithms that are truly polynomial in the number
of bits of the encoding  i e   whose worst case time complexity is o  n  m  log d    for
some polynomial   are called strongly polynomial  papadimitiou         the problem of a
pseudo polynomial algorithm for this problem is that it scales linearly with the size of the
domains  which may themselves be exponentially large  since the propagators we consider
take strongly polynomial time  the analyis of the upper bound is summarized as follows 
observation   the naive fixpoint computation algorithm  fig     always terminates in
pseudo polynomial time 
the question is whether strongly polynomial algorithms exist  the rest of the paper
focusses on this question  for several classes of propagators 

   linear constraints
in this section we consider linear inequalities  i e   our set of constraints c contains m
inequalities of the form 
x
ai k xi  ck  
k      m
   
i    n

where each ck and ai k are integers  it is convenient to introduce some extra notation  we
denote by si k the sign of the ith term in constraint k  i e   
si k  

 

  if ai k   
 if ai k    

   

moreover  given a sign s         the sign s is defined as   if s    and as 
s
otherwise  the sign  s will simply denote s  with this notation the terms ai k xi i k and
 s
 
ai k xi i k simply represent the smallest and largest elements of the set  ai k v   v   x
i   xi    
   few papers give explicit upper bounds on the complexity of computing a fixpoint of a set of bound
consistency propagators  the earliest reference we are aware of is the work of lhomme         it
considers constraints on the reals but assumes finite precision  floating points   and its analysis directly
adapts to discrete intervals 

   

fibordeaux  katsirelos  narodytska    vardi

    bound r  consistency propagators for linear inequalities
we briefly summarize the material we need on bound r  consistency in the case of linear
inequalities  we refer the reader to the literature for more details  in particular the papers
by harvey and stuckey         schulte and carlsson         bessiere         and apt and
zoeteweij        have substantial material on bound r  consistency and linear constraints 
also of interest are works that show how to improve bound propagation for long linear
constraints  harvey   schimpf        katriel  sellmann  upfal    van hentenryck        
s
consider a variable xi   its bound xi i k is bound r  inconsistent w r t  the kth inequality
of the system iff  even when we fix the other terms to their maximum  we obtain something
lower than ck   it is bound consistent if the opposite is true i e   iff 
 s  k

a  k x 

 s

si k

          ai  k xi i  k   ai k xi

 sn k

 s

  ai   k xi  i   k           an k xn

 ck

   

we call this the bound consistency inequality of variable xi w r t  constraint k  the
bound consistency propagator for a linear inequality simply shrinks the bounds of each
variable xi   let 
x
 s
aj k xj j k
qi k   ck 
j   n   j  i

s

be the minimal quantity that has to be reached by ai k xi i k to satisfy the bound consistency
s
inequality  in other words  xi is bound consistent w r t  constraint k iff ai k xi i k  qi k   
the  bound r  consistency  propagator associated with constraint k     m and variable
i     n is the function that reduces the bound of xi to the closest bound consistent value 
it is defined by the following pseudo code 
if ai k     then x
  
i
li k  
if ai k     then

x 
i

  



l



j

max x
i  
min

x 
i  

qi k
ai k

qi k
ai k

m

   

k

 the propagator does nothing if ai k      
    np completeness of integer fixpoint computation
we now prove that the propagators li k introduced in the previous sub section  eq     
although very simple when considered independently  give rise to complex fixpoints  more
precisely  we show the np completeness of the following decision problem 
decision problem    bound r  consistency for linear constraints 
input  a csp whose set of constraints c are linear inequalities 
question  let f    li k   i     n  k     m  be the set of bound r  consistency propagators associated with the csp  do the propagators in f have a non empty common fixpoint 
      characterising the fixpoints by inequalities
our first observation is that the bounds obtained when a fixpoint is reached are characterized
by the bound consistency conditions of eq     in other words a fixpoint is reached iff the
   

fithe complexity of integer bound propagation

 
lower and upper bounds x
i and xi satisfy the following inequalities  for each variable i and
constraint k 


 s
 s  k
 s
s
 s


       ai  k xi i  k   ai k xi i k   ai   k xi  i   k        an k xn n k  ck
 a  k x 




li 

x
i



x 
i

k          m  i          n
i          n

 ui

   

it is clear that decision problem   is answered positively iff there are integer values for
 
the bounds x
i and xi   i     n  that satisfy the linear program     if a fixpoint exists then
the bounds given by this fixpoint satisfy the inequalities and are within the initial bounds
li   ui   conversely if the inequalities are satisfied we have a fixpoint  
a first consequence for decision problem   is that its membership in np is straightforward since it is solvable by integer programming 
      linear inequalities with two variables per inequality
the key to understanding why decision problem   is hard is to connect fixpoint computation
to the special case of integer  linear  programming where all constraints have two variables
per inequality  tvpi in the lp terminology  see bar yehuda   rawitz        
definition   a tvpi instance with m constraints and n variables is an integer linear
program of the following form 
 

ak xik   bk xjk  ck k          m
li  xi  ui
i          n

where a  b  c are vectors of arbitrary  possibly negative  integers 
the feasibility of tvpi constraints is np complete  but can be decided in pseudopolynomial time  an early pseudo polynomial time algorithm can be found in work by
aspvall and shiloach         this algorithm essentially reduces the problem to a   sat
instance of size m  d  which is solvable in linear time  the overall algorithm therefore
runs in pseudo polynomial time  but also with a pseudo polynomial space requirement  
a particularly relevant algorithm for tvpi constraints is proposed in the work of baryehuda and rawitz         this algorithm has pseudo polynomial time complexity with
low  strongly polynomial space requirements  interestingly  this algorithm essentially uses
bound propagation  in fact  precisely bound r  consistency   and embeds it in what amounts
to a backtrack free search with a parallel improvement that allows to amortize its overall
runtime 
this seems to suggest a strong relation between propagation and tvpi constraints  in
particular one could easily be mistaken to believe that propagation is a decision procedure
for systems of tvpi constraints  we say that propagation provides a decision procedure for
a class of constraints if propagation fails exactly when the constraints are unsatisfiable  in
   here we focus on feasibility only  the optimization problem  i e   optimizing a linear function under
tvpi constraints  is strongly np hard  i e   np hard even for bounded domain sizes  in fact domains
       are enough   because it trivially encodes max  sat  bar yehuda   rawitz        

   

fibordeaux  katsirelos  narodytska    vardi

other words  the existence of a bound consistent state suffices to guarantee the existence
of a solution   this is the usual condition that guarantees a backtrack free search  but
propagation rarely achieves this in the general case and it is in fact not a decision procedure
for tvpi constraints 
example   consider the problem x   y      x   y with x  y          the problem is
inconsistent yet it is bound r  consistent  and also  in fact  bound z  consistent  
to prove our main result we need to identify a restricted case of tvpi constraints
for which fixpoint computation is indeed a decision procedure  this particular case is
monotone tvpi constraints  in which the two variables in each inequality have coefficients
with opposite signs  i e   the problem is of the following form 
definition   a monotone tvpi instance with m constraints and n variables is an integer linear program of the following form 
 

ak xik  bk xjk  ck k          m
li  xi  ui
i          n

where ak     bk     k          m 
we can now prove our np hardness result from monotone tvpi constraints  using the
following result 
theorem    lagarias        the feasibility of two variable per inequality monotone integer programming is np complete 
      np hardness
we now prove that decision problem   is np hard  we already know that it is in np 
therefore we can state our main result for bound r  consistency for linear constraints as 
proposition   decision problem   is np complete 
proof  we show that fixpoint computation decides systems of monotone tvpi constraints 
consider a monotone tvpi instance q of the form given by def     we want to show
the equivalence  q has an integer solution iff the set of bound r  consistency propagators
obtained for q have a non empty common fixpoint 
 q has an integer solution means that there exist integer values vi for each variable
xi satisfying li  vi  ui and  k          m 
ak vik  bk vjk  ck

   

 
 there exists a common fixpoint means that bounds x
i   xi   can be found for all
 

i          n  satisfying li  xi  xi  ui and  k          m 

ak x 
ik  bk xjk  ck

 
ak x  
ik  bk xjk  ck

   

 these are simply the constraints of eq    for variable xik  left  and xjk  right  
rewritten by taking into account a      b      
   

fithe complexity of integer bound propagation

we prove the two directions of the iff 
 consider an integer solution to q in which each variable xi takes value vi   it is easy
 

 
to verify that the bounds x
i   xi   vi satisfy li  xi  xi  ui and eq    
 
 consider a bound consistent state described by the bounds x
i   xi   it is easy to verify
that the solution v defined by vi   x 
i   i          n satisfies li  vi  ui and eq    

this means that we can reduce the problem of monotone tvpi feasibility to the existence
of a fixpoint  and that decision problem   is therefore np hard   
note that the np hardness result for decision problem   holds even for  monotone 
tvpi constraints  while the pseudo polynomial upper bound of section     holds for general
linear constraints of unbounded sizes  as said earlier the membership in np is also valid for
general linear constraints 
    a comment on linear equalities
from the beginning of this section we have focused on linear inequalities for reasons that
should become clear in this sub section  readers may wonder whether considering equalities
would make any difference  the short answer is no 
p
a first observation is that an inequality i    n ai xi  c can directly be encoded into the
p
p
equality i    n ai xi  y   c where y is a new variable ranging over     u  for u   i ai xi si  
so that there is a bijection between solutions of the two constraints  therefore the problem
of propagating inequalities reduces to the problem of propagating equalities  and the npcompleteness result still holds for problems whose linear constraints are all equalities  or
for any mix of equalities   inequalities  
a second observation is the following  because we focus on bound r  consistency  the
p
propagation obtained for an equality i    n ai xi   c is the same as the one obtained using
p
p
two constraints i    n ai xi  c and i    n ai xi  c  for this reason it is convenient
to assume that constraints are of homogeneous form  and to restrict ourselves to linear
inequalities   
    tractable classes of linear constraints
intractable problems often become tractable when additional restrictions are imposed on
the topology of the constraint graph  or on the constraints themselves  in this subsection
we identify one significant class of linear constraints that can be propagated in strongly
polynomial time  based on a restriction on the coefficients of the constraints 
our initial observation is that one source of complexity of the propagators li k of eq 
  is that they use rounding  when we update a variables bounds  we obtain from the other
variables a real value that is rounded upwards for lower bounds and downwards for upper
bounds  the effects of rounding were noticed by previous authors and used to optimize
   note also that in the case of inequalities the propagators for bound z  consistency are the same as for
bound r  consistency  since we want propagators to be polynomial time computable  the case we want
to avoid however is bound z  consistency for linear equalities  where we cannot define polynomial time
computable propagators unless p np 

   

fibordeaux  katsirelos  narodytska    vardi

propagation  harvey   stuckey         rounding effectively means that propagation stabilizes to integral solutions of linear programs  the linear programs in question have a very
specific form  but the intractability is due to the integrality  therefore in this sub section
    we observe that if we remove the rounding  the problem becomes tractable      we use
this observation to show that if the coefficients are unit  i e   belong to              there
is effectively no rounding  which means that the same tractability result holds 
      linear propagators without rounding
we now consider operators similar to those of eq    but without rounding  in other words
we now associate to the linear constraints the following operators 
if ai k     then x
  
i



si k  
if ai k     then

x 
i

  

q

i k
max x
i   ai k

min



qi k
x 
i   ai k



   



even when the initial bounds are integers as assumed throughout this paper  these
operators will in general reduce these bounds to real values  note that such propagators
can effectively be used to deal with variables with a real valued domain  indeed they are used
both in the constraint programming community  behamou   granvilliers        and in the
operations research community  where a different terminology is used  feasibility based
bounds tightening  see e g  belotti  cafieri  lee   liberti        
the decision problem we focus on is now whether there exist real valued bounds that
are a fixpoint  we note that this problem is tractable  a similar result has been reported
independently in the work of belotti  cafieri  lee  and liberti        
decision problem    fixpoint of continuous linear propagators 
input  a csp whose set of constraints c are linear inequalities 
question  does the set of real valued propagators f    si k   i     n  k     m  associated to c have a common fixpoint 
observation   decision problem   can be decided by linear programming 
it is easy to see that the fixpoints of operators si k are exactly the real valued solutions to
the system of linear constraints of eq     note that we have been careful in the statement
of observation    whether linear programming is strongly polynomial is in fact a longstanding open question  smale         the best polynomial time lp algorithms are 
encouragingly  of time complexity o  n  m  b   for some polynomial   where b is the
number of bits of the number encodingthis looks strongly polynomial  khachian        
but there is a catch  the complexity is counted in number of operations  and operations
on the rationals can in principle expand the size of the numbers  repeated multiplications
can blow up the representation exponentially   however  for practical purposes  typical lp
implementations prevent the blow up of number representation by limiting the precision
to b bits throughout the execution  solvability by linear programming is widely regarded
as synonymous to strong tractability  and provably sub exponential lp algorithms exist
 matousek  sharir    welzl         in other words  observation   should really be read as
a carefully phrased way to say that problem   is efficiently solvable in practice 
   

fithe complexity of integer bound propagation

      linear constraints with unit coefficients
a unit linear constraint is of the usual form i    n ai k xi  ck but with the additional
restriction that each coefficient ai k is chosen in             our introductory example of
slow convergence  eq     was a  particularly simple  example of unit linear constraints  and
the slow convergence could in this particular case be avoided  note that we are considering
linear unit constraints of any number of variables  a special case of unit constraints that
have been widely studied is the class of unit tvpi constraints  i e   both unit and tvpi  
this is perhaps the most important class of linear constraints whose integer feasibility can
be solved in strongly polynomial time  see for instance work by jaffar et al         
p

proposition   when all constraints have unit coefficients  decision problem   can be
decided by linear programming 
proof  the lp is  of course  of the form given in eq     the observation is  in short 
that no rounding is needed when the coefficients are unit 
t
more precisely  for any cartesian product of intervals a  let l a    i k li k  a  and
t
s a    i k si k  a   we show that when all coefficients are unit and when  as defined  the
bounds of the initial cartesian product d are integral  then we have lt  d    s t  d   for
all t     we first note that the bounds of lt  d  are integral for all t since the original
state d has integral bounds and that each operator in l applies rounding  the equality
lt  d    s t  d  is now proved by induction on t  for t      lt  d    s t  d    d  if
the induction hypothesis holds at step t  then s t    d    s s t  d     s lt  d    now
s t    d    l lt  d     lt    d  because lt  d  has integral bounds  hence applying s or l
on this cartesian product gives the same result   in eq    all qi k s are integral in this case
and all ai k s are unit therefore the division qi k  ai k gives an integer  which means that the
propagators li k with rounding return the same result as the non rounded propagators si k
of eq     
now having lt  d    s t  d   for all t    it is easy to see that gfp li k     gfp si k   
because the domains are finite lt  d  stabilizes for a finite t  for this particular t  lt  d  is
the greatest fixpoint of l and the same greatest cartesian product s t  d  is also the greatest
fixpoint of s   
note that in general linear programming does not necessarily find integer solutions to
the system of eq     what the result shows is that lp will find a solution iff an integer one
 
exists  if we want to actually compute the largest consistent bounds x
i and xi of a certain

 
variable xi   we can simply minimize xi or maximize xi under the constraints of eq    
the previous proof shows that these extremal values are integral 
      are there other tractable cases 
it is interesting to consider whether other properties make the propagation solvable in
strongly polynomial time  with respect to restrictions on the constraint graph  there are
nevertheless reasons to be pessimistic  we note that the feasibility of monotone tvpi integer
programming remains np complete under strict restrictions on the constraint graph  as
shown in the work of hochbaum and naor         this suggests that such restrictions are
unlikely to lead to interesting tractable classes of fixpoint computation 
   

fibordeaux  katsirelos  narodytska    vardi

regarding the restrictions on coefficients  we note that in general the np completeness
of  monotone  tvpi constraints assumes that the coefficients ak   bk   ck are arbitrary  the
unit restriction imposes  on the contrary  the strongest restriction on coefficients  that their
absolute value be     if we impose a more general bound  on these absolute values then
one may wonder whether the problem exhibits some form of fixed parameter tractability 
we leave this question open for future work 

   generalizations and non linear constraints
by proposition    fixpoint computation for numerical constraints as basic and common
as linear constraints is intractable  several cases of non linear constraints are nevertheless of interest  first  we show that if the simplest possible type of polynomials  a single
squaring operation  is added to linear constraints  then our general hardness result can be
strengthened  second  it is interesting to note that if we enrich unit linear constraints with
simple min or max constraints  then fixpoint computation is equivalent to a puzzling open
problem discussed recently in the theorem proving literature  last  we briefly comment on
connections between our results and the tractability of max closed constraints 
    quadratic constraints
for the purposes of this section it is sufficient to enrich our linear constraint language
 constraints of the form given by eq     with squaring constraints of the form 
xi   x j
it is also sufficient to restrict ourselves to non negative values for variables xi and xj   i e  
   li  ui and    lj  uj   in this setting the bound r  consistency propagators are
defined by the following instructions 




x
i    max xi   xj

x
j

  

max x
j  

 

q

x
i



 

 
 
x 
i    min xi   xj



x 
j

 

  

min x 
j  

q

 

x 
i

 



 

in other words the fixpoints are integer solutions to the following bound consistency
inequalities 



x
i  xj

 

 



 
x 
i  xj

 

 

x
j 

q

x
i  

x 
j 

q

x 
i

    

when these simple quadratic constraints are added to the language of linear constraints 
our np completeness result can be strengthened  the problem is np complete even when
considering a bounded    number of variables and constraints  in fact one tvpi constraint
and one squaring constraint  this is due to the fact that fixpoint computation converges to
a state that encodes a complex number theoretic problem 
proposition   given a csp with   variables and   constraints a  x    a  x    c  x    x    
determining whether their associated bound r  consistency propagators have a fixpoint is
np complete 
   

fithe complexity of integer bound propagation

proof  membership in np is straightforward  we show the hardness result for the special
case where ai     i            and focus  as said  on positive intervals  we first note
that the bound consistency inequalities of  eq      for the squaring constraint x    x   are
  
 
   
satisfied iff x
     x    and x     x    since we focus on integer bounds   this property of
the squaring propagator is noticed in a slightly different form in schulte   stuckey        
from a propagation viewpoint the equality a  x    a  x    c is seen as two inequalities
a  x    a  x   c and a  x   a  x   c whose bound consistent inequalities  eq     are

 
 
effectively satisfied iff a  x
    a  x    c and a  x    a  x    c 
we rely on a theorem  manders   adleman        which shows that deciding whether
an equation of the form a  x     a  x    c has integer solutions  where a    a  and c are
non negative integers  is np complete  we reduce this problem to the existence of bound
consistent bounds for the conjunction a  x    a  x    c  x    x   with initial bounds l    l   
l      and u    u    u    c  we just need to show that fixpoint computation is complete
for this systema bound consistent state is found iff the original equation has a solution 
 if the original equation has a solution  i e   a pair of non negative integer values

 
 
 
hv    v  i satisfying a  v     a  v    c  then we define x
    x    v    x    x    v    and

 

 
x    x    v    these bounds are such that    xi  xi  c and satisfy the bound
consistency conditions of eq     and eq    

 

 
 if the conjunction has a bound consistent state  i e   bounds x
i   xi such that eq    

and eq    are satisfied  then the solution v defined by v    x 
  and v    x  satisfies
 
the original equation a  v    a  v    c 

    connections to the max atom problem
another common type of primitive non linear constraints is of the form 
xh   max xi   xj  
the bound r  consistency propagators for this constraint are the following  schulte  
stuckey        
   
x 
i    min xi   xh  

  
x
h    max xh   xi   xj  

   
 
   
 
x 
h    min xh   max xi   xj    xj    min xj   xh  

 in fact to strictly reach bound r  consistency one would need to additionally check
whether the bounds of xh have an empty intersection with the bounds of one of the max ed
variables  say xi   in which case we can essentially impose the constraint xj   xh   for the
purposes of this section the simpler formulation above is equivalent   in other words the
fixpoints are characterized by the following inequalities 
   
x 
h  max xi   xj  

 
x 
i  xh

 
x 
j  xh


x
h  xi


x
h  xj

the fixpoint computation of max constraints mixed with unit linear constraints is interesting
because its complexity is an open problem  note that there is no rounding or use of
   

fibordeaux  katsirelos  narodytska    vardi

coefficients in the definition of the bound consistency inequalities  therefore the complexity
arising from rounding in all our np complete variants of propagation does not arise here 
the open problem we connect to is called max atom in the work of bezem  nieuwenhuis 
and rodrguez carbonell         see this reference for prior problems of interest that are
shown equivalent to max atom  a max atom constraint is of the form  max xi   xj   c  xh  
the work reported by bezem et al         shows a number of results on the feasibility of
conjunctions of max atom constraints      there is no significant complexity difference
between integer and real feasibility      the problem can be decided in pseudo polynomial
time using what amounts to a fixpoint computation algorithm      the problem has short
proofs of unsatisfiability and is therefore in npconp  which means that it is of a very
different nature from our other np complete variants  in fact  a recent result  atserias  
maneva        shows that the complexity of max atom is equivalent to well known open
problems called mean payoff games  which have in turn connections to some important open
questions in model checking  parity games  a class of games reducible to mean payoff games 
are equivalent to the model checking problem of  calculus  emerson  jutla    sistla       
jurdzinski        
here we draw a simple connection that follows from the observation that the bound
   
consistency inequalities for the upper bounds include the constraint x 
h  max xi   xj  
which encode max atom constraints almost directly 
proposition   bound r  consistency for a combination of unit linear and max constraints
can be solved in polynomial time only if max atom can be also be solved in polynomial time 
proof  to reduce a max atom instance with variables xi   i          n and m constraints to a
fixpoint computation problem we simply introduce one fresh variable yk   for each k          m 
let the kth constraint be of the form max xik   xjk     ck  xhk   it rewrites to the conjunction
max xik   xjk     yk   yk   ck  xhk   the lower bounds of all variables are fixed to   and the
p
upper bounds need only be set to k    m ck by the small model property  lemma    of the
paper by bezem et al          the bound consistency equations for the upper bounds directly
encode the problem   

    max closed constraints
we last note a connection between our results and the class of max closed constraints
introduced by jeavons and cooper         more on this in  e g   petke   jeavons        
a constraint r x            xn   is max closed if whenever we have two solutions hv        vn i and
hw        wn i  their maximum defined as hmax v    w             max vn   wn  i is also a solution 
results by jeavons and cooper        show that max closed constraints are tractable  if
a system of constraints is max closed  then its feasibility can be determined in polynomial
time  however note that this result essentially assumes an explicit  or table  representation
of the constraint  i e   it is assumed that each constraint is defined by explicitly listing the
tuples that are solutions to it  in contrast some important types of constraints such as the
numerical constraints considered in this paper are implicitly defined  we do not know the
list of solutions to r x            xn   but can only verify efficiently whether a particular tuple
is accepted by the constraint 
   

fithe complexity of integer bound propagation

implicitly defined max closed constraints played an important role in this paper  both
the monotone tvpi constraints  considered in section     and the max atom constraints
considered in section      are max closed  as shown respectively by hochbaum and naor
        and bezem et al          in sharp contrast to the case of explicitly defined constraints  the resolution of implicitly defined max closed constraints is therefore only pseudopolynomial and it is in fact intractable  as shown by the special case of monotone tvpi
constraints 
observation   the feasibility of implicitly defined max closed constraints is np complete 
as shown in section     with the particular example of monotone tvpi constraints 
even the fixpoint computation of implicitly defined max closed constraints is  in fact  npcomplete in general 

   conclusion
reasoning about intervals was introduced in the ai literature by the works of cleary        
and davis           a substantial body of ai work has ensued  see  e g  hyvonen        
bound computation is now used by most finite domain cp solvers  schulte   carlsson 
      
in this paper we have theoretically investigated the complexity of computing the common
fixpoint of a set of bound consistency propagators  we have shown that even when the
propagators are themselves very simple  the fixpoint computation used in these algorithms
can be complex  it is indeed np complete even for a very restricted constraint class  linear
monotone inequalities with two variables per inequality  we also considered some special
classes of constraints  like quadratic constraints and max constraints  finally  we identified a
class of constraints  namely  linear inequalities with unit coefficients  that allows a tractable
fixpoint computation algorithm 
bound propagation is a successful and widely used technique in constraint programing 
there is a large literature on propagating single constraints  van hoeve   katriel       
bessiere        rossi  van beek    walsh        and it is perhaps a surprise that no prior
study exists on the complexity of the fixpoint computation  the np completeness of fixpoint
computation for simple types of constraints is a fundamental and somewhat surprising
result  and one that sheds light on slow convergence phenomena 
this result also puts bound propagation on the map of ai computational problems 
together with knapsack constraints and some forms of learning in neural nets  schaeffer  
yannakakis         it is one of the few important ai problems we are aware of that have a
pseudo polynomial complexity and yet are intractable 
acknowledgments
preliminary results of bordeaux  hamadi  and vardi        showed the np completeness
of propagation in the case where quadratic constraints are considered  prop      this
   as often  a good case can be made that similar ideas are already present in earlier work  in particular the
work of lauriere         interval computations are of course also used in other areas and the fixpoint
computation methods we consider relate to the broader theme of interval arithmetic pioneered by moore
       

   

fibordeaux  katsirelos  narodytska    vardi

paper is a thoroughly revised version whose central result for linear constraints is new
and more general  part of this work was done while g  katsirelos  n  narodytska and
m  vardi were visiting microsoft research  cambridge  part of this work was done while
g  katsirelos was employed by nicta  australia  nicta is funded by the australian
governments department of broadband  communications  and the digital economy and
the australian research council  this work was partially supported by the anr unloc
project  anr    blan          discussions with youssef hamadi and claude guy quimper are gratefully acknowledged  thanks also to the anonymous reviewers whose feedback
helped improve the paper 

references
apt  k  r          the essence of constraint propagation  theoretical computer science
 tcs                     
apt  k  r     zoeteweij  p          an analysis of arithmetic constraints on integer intervals 
constraints                 
aspvall  b     shiloach  y          a polynomial time algorithm for solving systems of
linear inequalities with two variables per inequality  siam j  on computing        
       
atserias  a     maneva  e          mean payoff games and the max atom problem  tech 
rep   universitat politecnica de catalunya 
bar yehuda  r     rawitz  d          efficient algorithms for integer programs with two
variables per constraint  algorithmica                 
behamou  f     granvilliers  l          continuous and interval constraints  in rossi  f  
van beek  p     walsh  t   eds    handbook of constraint programming  chap     
elsevier 
belotti  p   cafieri  s   lee  j     liberti  l          feasibility based bounds tightening via
fixed points  in proc  of int  conf  on combinatorial optimization and applications
 cocoa   p  to appear 
benhamou  f          heterogeneous constraint solving  in proc  of int  conf  on algebraic
and logic programming  alp   pp       
bessiere  c          constraint propagation  in rossi  f   van beek  p     walsh  t   eds   
handbook of constraint programming  chap     elsevier 
bezem  m   nieuwenhuis  r     rodrguez carbonell  e          the max atom problem
and its relevance  in proc  of int  conf  on logic for programming  artificial intelligence and reasoning  lpar   pp       
bordeaux  l   hamadi  y     vardi  m  y          an analysis of slow convergence in
interval propagation  in proc  of int  conf  on principles and practice of constraint
programming  cp   pp         
   

fithe complexity of integer bound propagation

choi  c  w   harvey  w   lee  j  h  m     stuckey  p  j          finite domain bounds
consistency revisited  in australian conf  on artificial intelligence  pp       
cleary  j  g          logical arithmetic  future computing systems                
davis  e          constraint propagation with interval labels  artificial intelligence         
       
emerson  e  a   jutla  c  s     sistla  a  p          on model checking for fragments of
 calculus  in proc  of int  conf  on computer aided verification  cav   pp         
harvey  w     schimpf  j          bound consistency techniques for long linear constraints 
in proc  of cp workshop on techniques for implementing constraint propgramming
systems  trics  
harvey  w     stuckey  p  j          improving linear constraint propagation by changing
constraint representation  constraints                
hochbaum  d  s     naor  j          simple and fast algorithms for linear and integer
programs with two variables per inequality  siam j  on computing              
     
hyvonen  e          constraint reasoning based on interval arithmetic  the tolerance
propagation approach  artificial intelligence                  
jaffar  j   maher  m  j   stuckey  p  j     yap  r  h  c          beyond finite domains 
in proc  of int  workshop on principles and practice of constraint programming
 ppcp   pp       
jeavons  p     cooper  m  c          tractable constraints on ordered domains  artificial
intelligence                 
jurdzinski  m          deciding the winner in parity games is in up  co up  inf  process 
lett                  
katriel  i   sellmann  m   upfal  e     van hentenryck  p          propagating knapsack
constraints in sublinear time  in proc  of  north amer   nat  conf  on artificial
intelligence  aaai   pp         
khachian  l          a polynomial algorithm for linear programming  doklady akad  ussr 
              
lagarias  j  c          the computational complexity of simultaneous diophantine approximation problems  siam j  on computing                 
lauriere  j  l          a language and a program for stating and solving combinatorial
problems  artificial intelligence                
lebbah  y     lhomme  o          accelerating filtering techniques for numeric csps 
artificial intelligence                  
   

fibordeaux  katsirelos  narodytska    vardi

leconte  m     berstel  b          extending a cp solver with congruences as domains for
program verification  in cp workshop on software testing  verification and analysis 
pp       
lhomme  o          consistency techniques for numeric csps  in proc  of int  joint  conf 
on artificial intelligence  ijcai   pp         
lhomme  o   gottlieb  a   rueher  m     taillibert  p          boosting the interval
narrowing algorithm  in proc of joint int  conf  and symp  on logic programming
 jicslp   pp          mit press 
manders  k  l     adleman  l  m          np complete decision problems for binary
quadratics  j  of computer and system sciences                 
matousek  j   sharir  m     welzl  e          a subexponential bound for linear programming  algorithmica                   
moore  r  e          interval analysis  prentice hall 
papadimitiou  c          computational complexity  addison wesley 
petke  j     jeavons  p          tractable benchmarks for constraint programming  tech 
rep  cs rr        oxford university computing laboratory 
rossi  f   van beek  p     walsh  t          handbook of constraint programming  elsevier 
schaeffer  a  a     yannakakis  m          simple local search problems that are hard to
solve  siam j  on computing               
schulte  c     carlsson  m          finite domain constraint programming  in rossi  f  
van beek  p     walsh  t   eds    handbook of constraint programming  chap     
elsevier 
schulte  c     stuckey  p  j          when do bounds and domain propagation lead
to the same search space   acm trans  on programming languages and systems
 toplas                  
smale  s          mathematical problems for the next century  mathematical intelligencer 
        
trick  m  a          a dynamic programming approach for consistency and propagation for
knapsack constraints  in proc  of int  conf  on integration of ai and or techniques
in cp for combinatorial optimisation problems  cp ai or  
van hoeve  w  j     katriel  i          global constraints  in rossi  f   van beek  p    
walsh  t   eds    handbook of constraint programming  chap     elsevier 
yuanlin  z     yap  r  h  c          arc consistency on n ary monotonic and linear constraints  in proc  of int  conf  on principles and practice of constraint programming
 cp   pp         

   

fi