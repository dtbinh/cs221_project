journal of artificial intelligence research                  

submitted       published     

efficient computation of the shapley value
for game theoretic network centrality
tomasz p  michalak

tomasz michalak cs ox ac uk

department of computer science  university of oxford
ox   qd  uk
institute of informatics  university of warsaw
       warsaw  poland

karthik  v  aadithya

aadithya eecs berkeley edu

department of electrical engineering and computer sciences
university of california
berkeley  ca             united states  usa

piotr l  szczepaski

p szczepanski stud elka pw edu pl

institute of informatics
warsaw university of technology
       warsaw  poland

balaraman ravindran

ravi cse iitm ac in

computer science and engineering
indian institute of technology madras
chennai           india

nicholas r  jennings

nrj ecs soton ac uk

school of electronics and computer science
university of southampton
so    bj southampton  uk

abstract
the shapley valueprobably the most important normative payoff division scheme in coalitional gameshas recently been advocated as a useful measure of centrality in networks 
however  although this approach has a variety of real world applications  including social
and organisational networks  biological networks and communication networks   its computational properties have not been widely studied  to date  the only practicable approach
to compute shapley value based centrality has been via monte carlo simulations which
are computationally expensive and not guaranteed to give an exact answer  against this
background  this paper presents the first study of the computational aspects of the shapley
value for network centralities  specifically  we develop exact analytical formulae for shapley value based centrality in both weighted and unweighted networks and develop efficient
 polynomial time  and exact algorithms based on them  we empirically evaluate these algorithms on two real life examples  an infrastructure network representing the topology of
the western states power grid and a collaboration network from the field of astrophysics 
and demonstrate that they deliver significant speedups over the monte carlo approach  for
instance  in the case of unweighted networks our algorithms are able to return the exact
solution about      times faster than the monte carlo approximation  even if we allow for
a generous     error margin for the latter method 
c
    
ai access foundation  all rights reserved 

fimichalak  aadithya  szczepaski  ravindran    jennings

   introduction
in many network applications  it is important to determine which nodes and edges are more
critical than others  classic examples include identifying the most important hubs in a road
network  schultes   sanders         the most critical functional entities in a protein network
 jeong  mason  barabasi    oltvai         or the most influential people in a social network
 kempe  kleinberg    tardos         consequently  the concept of centrality  which aims
to quantify the importance of individual nodes edges  has been extensively studied in
the literature  koschtzki  lehmann  peeters  richter  tenfelde podehl    zlotowski       
brandes   erlebach        
v 

v 
v 
v 

v 

v 

v 
v  

v 
v  

v 

v  

v  

figure    sample network of    nodes
generally speaking  centrality analysis aims to create a consistent ranking of nodes within a
network  to this end  centrality measures assign a score to each node that in some way corresponds to the importance of that node given a particular application  since importance
depends on the context of the problem at hand  many different centrality measures have
been developed  three of the most well known and widely applied are  degree centrality 
closeness centrality and betweenness centrality   in this paper  we refer to these measures
as conventional standard centrality  degree centrality  in brief  quantifies the power of a
node by its degree  i e   by the number of its adjacent edges  for instance  in the sample
network in figure    nodes v  and v  have degree   and  if judged by degree centrality  these
are the most important nodes within the entire network  conversely  closeness centrality
focuses on distances among nodes and gives high value to the nodes that are close to all
other nodes  with this measure  node v  in figure   is ranked top  the last measure
betweenness centralityconsiders shortest paths  i e   paths that use the minimal number of
links  between any two nodes in the network  the more shortest paths the node belongs to 
the more important it is  with this measure  v  in figure   is more important than all the
other nodes  including v  and v    which are chosen by other measures as the most important
node   clearly  all these measures expose different characteristics of a node  consider  for
instance  an epidemiology application  where the aim is to identify those people  i e   nodes 
in the social network who have the biggest influence on the spread of the disease and should
become a focal point of any prevention or emergency measures  here  degree centrality
   koschtzki et al         and brandes and erlebach        give a good overview of these and other
centrality measures 

   

ficomputation of the shapley value for game theoretic network centrality

ranks top nodes with the biggest immediate sphere of influencetheir infection would lead
to the highest number of adjacent nodes being exposed to the disease  on the other hand 
closeness centrality identifies those nodes whose infection would lead to the fastest spread
of the disease throughout the society  finally  betweenness centrality reveals the nodes that
play a crucial role in passing the disease from one person in a network to another  
the common feature of all the aforementioned standard measures is that they assess the
importance of a node by focusing only on the role that a node plays by itself  however 
in many applications such an approach is inadequate because of synergies that may occur
if the functioning of nodes is considered in groups  referring again to figure   and our
epidemiology example  a vaccination of individual node v   or v  or v    would not prevent
the spread of the disease from the left to the right part of the network  or vice versa  
however  the simultaneous vaccination of v    v  and v  would achieve this goal  thus  in
this particular context  nodes v    v  and v  do not play any significant role individually 
but together they do  to quantify the importance of such groups of nodes  the notion of
group centrality was introduced by everett and borgatti         intuitively  group centrality
works broadly the same way as standard centrality  but now the focus is on the functioning
of a given group of nodes  rather than individual nodes  for instance  in figure    the group
degree centrality of  v    v    is   as they both have   distinct adjacent nodes 
although the concept of group centrality addresses the issue of synergy between the functions
is played by various nodes  it suffers from a fundamental deficiency  it focuses on particular 
a priori determined  groups of nodes and it is not clear how to construct a consistent ranking
of individual nodes using such group results  specifically  should the nodes from the most
valuable group be ranked top  or should the most important nodes be those which belong
to the group with the highest average value per node  or should we focus on the nodes
which contribute most to every coalition they join  in fact  there are very many possibilities
to choose from 
a framework that does address this issue is the game theoretic network centrality measure  in
more detail  it allows the consistent ranking of individual nodes to be computed in a way that
accounts for various possible synergies occurring within possible groups of nodes  grofman
  owen        gmez  gonzlez arangena  manuel  owen  del pozo    tejada       
suri   narahari         specifically  the concept builds upon cooperative game theorya
part of game theory in which agents  or players  are allowed to form coalitions in order to
increase their payoffs in the game  now  one of the fundamental questions in cooperative
game theory is how to distribute the surplus achieved by cooperation among the agents 
to this end  shapley        proposed to remunerate agents with payoffs that correspond to
their individual marginal contributions to the game  in more detail  for a given agent  such
an individual marginal contribution is measured as the weighted average marginal increase
in the payoff of any coalition that this agent could potentially join  shapley famously proved
that his conceptknown since then as the shapley valueis the only division scheme that
meets certain desirable normative properties   given this  the key idea of the game theoretic
network centrality is to define a cooperative game over a network in which agents are the
nodes  coalitions are the groups of nodes  and payoffs of coalitions are defined so as to meet
   for the differences in interpretation of standard centralities see the work of borgatti and everett        
   see section   for more details 

   

fimichalak  aadithya  szczepaski  ravindran    jennings

requirements of a given application  this means that the shapley value of each agent in such
a game can then be interpreted as a centrality measure because it represents the average
marginal contribution made by each node to every coalition of the other nodes   in other
words  the shapley value answers the question of how to construct a consistent ranking of
individual nodes once groups of nodes have been evaluated 
in more detail  the shapley value based approach to centrality is  on one hand  much more
sophisticated than the conventional measures  as it accounts for any group of nodes from
which the shapley value derives a consistent ranking of individual nodes  on the other
hand  it confers a high degree of flexibility as the cooperative game over a network can be
defined in a variety of ways  this means that many different versions of shapley value based
centrality can be developed depending on the particular application under consideration  as
well as on the features of the network to be analyzed  as a prominent example  in which a
specific shapley value based centrality measure is developed that is crafted to a particular
application  consider the work of suri and narahari        who study the problem of selecting
the top k nodes in a social network  this problem is relevant in all those applications where
the key issue is to choose a group of nodes that together have the biggest influence on the
entire network  these include  for example  the analysis of co authorship networks  the
diffusion of information  and viral marketing  as a new approach to this problem  suri
and narahari define a cooperative game in which the value of any group of nodes is equal
to the number of nodes within  and adjacent to  the group  in other words  it is assumed
that the agents sphere of influence reaches the immediate neighbors of the group  whereas
the definition of the game is a natural extension of the  group  degree centrality discussed
above  the shapley value of nodes in this game constitutes a new centrality metric that is 
arguably  qualitatively better than standard degree centrality as far as the nodes influence is
concerned  the intuition behind it is visible even in our small network in figure    in terms
of influence  node v  is more important than v    because it is the only node that is connected
to v  and v    without v  it is impossible to influence v  and v    while each neighbor of v  is
accessible from some other node  thus  unlike standard degree centrality  which evaluates
v  and v  equally  the centrality based on the shapley value of the game defined by suri and
narahari recognizes this difference in influence and assigns a higher value to v  than to v   
unfortunately  despite the advantages of shapley value based centrality over conventional
approaches  efficient algorithms to compute it have not yet been developed  indeed  given
a network g v  e   where v is the set of nodes and e the set of edges  using the original
shapley value formula involves computing the marginal contribution of every node to every
coalition which is o   v      such an exponential computation is clearly prohibitive for bigger
networks  of  e g      or      nodes   for such networks  the only feasible approach currently
outlined in the literature is monte carlo sampling  e g   suri   narahari        castro 
gomez    tejada         however  this method is not only inexact  but can be also very
time consuming  for instance  as shown in our simulations  for a weighted network of about
       nodes and about         edges  the monte carlo approach has to iterate         
   we note that other division schemes or power indices from cooperative game theory  such as banzhaf
power index  banzhaf         could also be used as centrality measures  see  for instance  the discussion
in the work by grofman   owen         however  like most of the literature  we focus on the shapley
value due to its desirable properties 

   

ficomputation of the shapley value for game theoretic network centrality

b 

a 
v 

v 

v 

 
  

v 
v 

v 
v 

v 
v 

 

 

v 

 

v 

 
v 

v 

figure    sample unweighted and weighted networks of   and   nodes  respectively 
times through the entire network to produce the approximation of the shapley value with
a     error margin   moreover  exponentially more iterations are needed to further reduce
this error margin 
against this background  we develop polynomial time algorithms to compute shapley valuebased centrality  specifically  we focus on five underlying games defined over a network  those
games extend  in various directions  standard notions of degree and closeness centrality  as
our starting point  we consider the game defined by suri and narahari and propose an
exact  linear time algorithm to compute the corresponding shapley value based centrality 
we denote this game by g    we then analyse the computational properties of four other
games defined over networks  we denote them g    g    g    and g    respectively  while each
of these games captures a different flavor of centrality  they all  similarly to the game of
suri and narahari  embrace one fundamental centrality idea  given a group of nodes c 
the function that defines the value of c in the game must somehow quantify the sphere of
influence of c over other nodes in the network  in particular 
g  in this game the value of coalition c is a function of its own size and of the number
of nodes that are immediately reachable in at least k different ways from c  this
game is inspired by bikhchandani  hirshleifer  and welch        and is an instance of
the general threshold model introduced by kempe  kleinberg  and tardos         it
has a natural interpretation  an agent becomes influenced  with ideas  information 
marketing message  etc   only if at least k of his neighbors have already become
influenced  for instance  given k      the value of coalition  v    v    in figure  a is
  as the coalition is of size   and there are two neighbors with no less than   edges
adjacent to this coalition 
g  this game concerns weighted graphs  unlike g  and g     here  the value of coalition c
depends on its size and on the set of all nodes within a cutoff distance of c  as measured
by the shortest path lengths on the weighted graph  for example  in figure  b  if the
cutoff is set to   then coalition  v    has value   as it is able to influence   nodes v   
v    and v  that are not further than   away from  v     the cutoff distance should be
interpreted here as a radius of the sphere of influence of any coalition 
   see section   for the exact definition of the error margin 

   

fimichalak  aadithya  szczepaski  ravindran    jennings

game graph
value of a coalition c  i e    c 
complexity
accuracy
g 
u w  c  is the number of nodes in c and
o  v      e  
exact
those immediately reachable from c
g 
u w  c  is the number of nodes in c and
o  v      e  
exact
those immediately reachable from c 
but via at least k different edges
g 
w  c  is the number of nodes in c and o  v   e     v    log v    exact
those not further than dcutoff away
g 
w  c  is the sum of f    s  the nono  v   e     v    log v    exact
 increasing functions of the distance
between c and other nodes
g 
w  c  is the number of nodes in c and
o  v   e  
approx 
those directly connected to c via edges
      
which sum of weights exceeds wcutoff
table    games considered in this paper and our results  u w denotes unweighted graphs
and w weighted  
g  this game generalizes g  by allowing the value of c to be specified by its size and an
arbitrary non increasing function f     of the distance between c and the other nodes
in the network  for instance  the value of  v    v    in figure  b when our function is
 
 
f  d      d
is                                    
  the intuition here is that the
coalition has more influence on closer nodes than on those further awaya property
that cannot be expressed with the standard closeness centrality  thus  g  can be seen
as an extension of closeness centrality 
g  the last game is an extension of g  to the case of weighted networks  here  the value
of c depends on the adjacent nodes that are connected to the coalition with weighted
edges whose sum exceeds a given threshold wcutof f  recall that in g  this threshold is
defined simply by the integer k   whereas in g  and g  weights on edges are interpreted
as distance  in g  they should be interpreted as a power of influence  for example  in
figure  b  when the threshold for each vertex is    the value of coalition  v    v    is  
because this coalition of size two has only enough power to influence one additional
node v   
the computation of the shapley value for each of the above five games  see table   for an
overview  will be the main focus of the paper  these shapley values are extensions of either
degree or closeness centrality metrics and their applications are all those settings in which
the influence of nodes on other nodes in the network has to be evaluated  our results can
be summarized as follows 

 we demonstrate that it is possible to exactly and efficiently compute a number of
shapley value based network centrality measures  our methods take advantage of both
   

ficomputation of the shapley value for game theoretic network centrality

the network structure  as well as the specifics of the underlying game defined over a
network 
 for the first four games  we derive closed form expressions for the shapley values 
based on these  we provide exact linear and polynomial time algorithms that efficiently
compute the shapley values  i e   without the need to enumerate all possible coalitions 
specifically  our algorithms run in o  v      e   for g  and g  and in o  v   e   
 v    log v    for g  and g    furthermore  for the fifth measure of centrality  we develop a
closed form polynomial time computable shapley value approximation  this algorithm
has running time o  v   e   and our experiments show that its approximation error
is about    for large networks  the summary of our algorithms performance can be
found in table   
 we evaluate our algorithms on two real life examples  an infrastructure network representing the topology of the western states power grid and a collaboration network
from the field of astrophysics  the results show that our algorithms deliver significant
speedups over monte carlo simulations  for instance  given the unweighted network of
western states power grid  our algorithms return the exact shapley value for g  and
g  about      times faster than the monte carlo method returns an approximation
with the     error margin 
the remainder of the paper is organized as follows  in section   we discuss related work 
notation and preliminary definitions are presented in section    in section   we analyse the
five types of centrality related coalitional games and propose polynomial time shapley value
algorithms for all of them  the results of numerical simulations are presented in section  
 with some details on the simulation setup presented in appendix a   conclusions and future
work follow  finally  appendix b provides a summary of the key notational conventions 

   related literature
the issue of centrality is one of the fundamental research directions in the network analysis
literature  in particular  freeman        was the first to formalise the notion of centrality by
presenting the conventional centrality measures  degree  closeness and betweenness  many
authors have subsequently worked on developing new centrality measures  or refining existing
ones  e g   bonacich        noh   rieger        stephenson   zelen         and developing
algorithms for efficient centrality computation  e g   brandes        eppstein   wang        
in this context  grofman and owen        were the first to apply game theory to the topic
of centrality  where they focused on the banzhaf power index  banzhaf         in a followup work  gmez et al         combined myersons        idea of graph restricted games
 in which each feasible coalition is induced by a subgraph of a graph  with the concept of
centrality and proposed new shapley value based network centrality measures  in contrast
to gmez et al   suri and narahari              assumed all coalitions to be feasible  which
is the approach we also adopt in this paper 
the fundamental problem with the conventional models of coalitional games  i e   their exponential complexity in the number of agents  that we tackle in this paper  has been also
   

fimichalak  aadithya  szczepaski  ravindran    jennings

 

 
v 

 
v 

 
 
 
v 
figure    the induced subgraph representation of a sample coalitional game of   players  in
this game  values of coalitions  v      v      v      v    v      v    v      v    v     and  v    v    v  
are                               and              respectively 
studied in the literature on algorithmic aspects of coalitional games  indeed  since the seminal work of deng and papadimitriou         this issue has received considerable attention
from computer scientists  specifically  as an alternative to the straightforward  but exponential  listing of all possible coalitions  a number of authors have proposed more efficient
representations for coalitional games  such representations fall into two main categories
 wooldridge   dunne        
 those that give the characteristic function a specific interpretation in terms of combinatorial structures such as graphs  this is the approach adopted by  for instance 
deng and papadimitriou         greco  malizia  palopoli  and scarcello         and
wooldridge and dunne        and its advantage is that the ensuing representation is
always guaranteed to be succinct  however  the disadvantage is that it is not always
fully expressive  i e   it cannot represent all coalitional games 
 those that try to find a succinct  but still fully expressive  representation  this is  for
instance  the approach adopted by conitzer and sandholm         ieong and shoham
        and elkind  goldberg  goldberg  and wooldridge         these representations are more general in that they completely capture all coalitional games of interest 
although they are not always guaranteed to be succinct 
unfortunately  even for some succinctly representable games  computing the shapley value
has been shown to be np hard  or even worse   p complete  for many domains  including weighted voting games  deng   papadimitriou         threshold network flow games
 bachrach   rosenschein        and minimum spanning tree games  nagamochi  zeng 
kabutoya    ibaraki         similarly  aziz  lachish  paterson  and savani      a  obtained negative results for a related problem of computing the shapley shubik power index
for the spanning connectivity games that are based on undirected  unweighted multigraphs 
also  bachrach  rosenschein  and porat      b  showed that the computation of the banzhaf
index for connectivity games  in which agents own vertices and control adjacent edges and
aim to become connected to the certain set of primary edges  is  p complete 
fortunately  some positive results have also been discovered  probably the most known
among these are due to deng and papadimitriou        and ieong and shoham         in
   

ficomputation of the shapley value for game theoretic network centrality

more detail  deng and papadimitriou proposed a representation based on weighted graphs 
where a node is interpreted as an agent  and the weight of an edge is interpreted as the value
of cooperation between the two agents that are connected by this edge   the value of any
coalition is then defined as the sum of weights of all its internal edges  or  in other words 
the weights of edges belonging to a subgraph induced by members of the coalition  a threeplayer example of this formalism  called the induced subgraph representation  can be found
in figure    the downside of this representation is that it is not fully expressive  however 
the upside is that  for games that can be formalised as weighted graphs  this representation
is always concise  furthermore  it allows the shapley value to be computed in time linear
in the number of players  specifically  in this case  the shapley value is given by the the
following formula 

shapley value vi     vi s self loop weight  
vj

weight of edge from vi to vj
 
 
neighbours of v
x

   

i

ieong and shoham        developed a representation consisting of a finite set of logical rules
of the following form  boolean expression  real number  with agents being the atomic
boolean variables  in this representation  the value of a coalition is equal to the sum of
the right sides of those rules whose left sides are satisfied by the coalition  this representation  called marginal contribution networks  or mc nets for short  is  i  fully expressive
 i e   it can be used to model any game    ii  exponentially more concise for some games 
and most importantly   iii  allows the shapley value to be computed in time linear in the
size of the representation  provided the boolean expressions in all rules are conjunctions
of  either positive or negative  atomic literals  in mc nets  the rules have an interesting
game theoretic interpretation  as each rule directly specifies an incremental marginal contribution made by the agents featured in that rule  now  using the additivity axiom met
by the shapley value  it is possible to consider every rule as a separate simple game  then
using other axioms straightforwardly compute the shapley value for this simple game 
and  finally  sum up the results for all simple games to obtained the shapley value  building on this  elkind et al         developed extensions of mc nets to more sophisticated
 read once  boolean expressions  while michalak  marciniak  samotulski  rahwan  mcburney  wooldridge  and jennings      a   michalak  rahwan  marciniak  szamotulski  and
jennings      b  developed generalizations to coalitional games with externalities  another
recently proposed representation formalism for coalitional games that allows for polynomial
calculations of the shapley value are decision diagrams  bolus        aadithya  michalak   
jennings        sakurai  ueda  iwasaki  minato    yokoo         now  while mc nets offer
a fully expressive representation that works for arbitrary coalitional games  it is possible to
speed up the shapley value computation by focusing on specific  not necessarily fully expressive  classes of games  one particular class of games that has been investigated in detail is
weighted voting  for which both approximate  but strictly polynomial   fatima  wooldridge 
  jennings        and exact  but pseudo polynomial  algorithms  mann   shapley       
matsui   matsui        have been proposed  chalkiadakis  elkind  and wooldridge       
provided a comprehensive discussion of this literature 
   also self loops are allowed 

   

fimichalak  aadithya  szczepaski  ravindran    jennings

whereas the choice of representation has been the foremost consideration for efficient shapley value computation in the context of conventional coalitional games  in this paper  we
face a rather different set of challenges 
 unlike conventional coalitional games  conciseness is usually not an issue in the networks context  this is because the games that aim to capture network centrality
notions are completely specified by  a  the underlying network compactly represented
as a graph  and  b  a concise closed form characteristic function expression for evaluating coalition values  see the next section for an example   rather  the issue here
is that the exact specification for the characteristic function is dictated not by computational considerations  but by the real world application of game theoretic network
centrality  in other words  the choice of representation for shapley value computation
is already fixed by the centrality under consideration 
 because the games in this paper are designed to reflect network centrality  the characteristic function definition often depends in a highly non trivial way on the underlying
graph structure  specifically  the value assigned by the characteristic function to each
subset of nodes depends not just on the subgraph induced by those nodes  but also on
the relationship between that subgraph and the rest of the network  for example  the
value assigned to a coalition of nodes may be based on the shortest path lengths to
nodes outside the coalition  or it may depend on the relationship between the coalition
and its neighbors 
therefore  the specific challenge we tackle is to efficiently compute the shapley value  given
a network and a game defined over it  where coalition values for this game are given by a
closed form expression that depends non trivially on the network  the key question here
is how to take advantage of  a  the network structure  and  b  the functional form for
the coalition values  so as to compute shapley values efficiently  i e   without the need to
enumerate all possible coalitions 
finally  we conclude this section by mentioning that the shapley value or other solution concepts from game theory have been applied to other network related problems  for instance 
the application of the shapley value  and the nucleolus  to the problem of cost allocation
in the electric market transmission system was considered by zolezzi and rudnick        
though the computational aspects were not discussed  the problem of maximizing the probability of hitting a strategically chosen hidden virtual network by placing a wiretap on a
single link of a communication network was analysed by aziz  lachish  paterson  and savani
     b   this problem can be viewed as a two player win lose  zero sum  game  a wiretap
game  the authors not only provide polynomial time computational results for this game 
but also show that one of the  key  strategies is the nucleolus of the simple cooperative
spanning connectivity game  aziz et al       a  mentioned above 

   preliminaries and notation
in this section we formally introduce the basic concepts from graph theory and cooperative
game theory used throughout the paper  we then look more closely into a sample coalitional
   

ficomputation of the shapley value for game theoretic network centrality

game defined over a network and into how the shapley value of this game can be used as a
centrality measure 
a graph  or network   g consists of vertices  or nodes  and edges  sets of which will be
denoted v  g  and e g   respectively  every edge from set e g  connects two vertices in
set v  g    by  u  v  we will denote the edge connecting vertices u  v  v  g   the number
of edges incident to a vertex is called a vertex degree  the neighboring vertices of v  v
are all vertices connected to v in the graph  for a weighted network a weight  label  is
associated with every edge in e g   a path is  informally  a sequence of connected edges 
the shortest path problem is to find a path between two given vertices in which the sum of
edge weights is minimized 
we now formalize the notions of coalitional games and the shapley value  specifically  let
us denote by a    a            a a    the set of players that participate in a coalitional game  a
characteristic function    r assigns to every coalition c  a a real number representing
the quality of its performance  where it is assumed that         a characteristic function
game is then a tuple  a     assuming that the grand coalition  i e   the coalition of all
the agents in the game  has the highest value and is formed  one of the key questions in
coalitional game theory is how to distribute the gain from cooperation among the agents
so as to meet certain normative positive criteria  to this end  shapley        proposed to
evaluate the role of each agent in the game by computing a weighted average of marginal
contributions of that agent to all possible coalitions he can belong to  the importance of
the shapley value stems from the fact that it is the unique division scheme that meets four
desirable criteria 
 i  efficiency  all the wealth available to the agents in the grand coalition is distributed
among them 
 ii  symmetry  the payoffs to agents do not depend on their identity 
 iii  null player  agents with zero marginal contributions to all coalitions receive zero
payoff  and
 iv  additivity  values of two games sum up to the value computed for the sum of both
games 
in order to formalize this concept  let    a  denote a permutation of agents in a  and
let c  i  denote the coalition made of all predecessors of agent ai in   more formally  if we
denote by  j  the location of aj in   then  c  i     aj      j     i    the shapley
value of ai   denoted svi     is then defined as the average marginal contribution of ai to
coalition c  i  over all     shapley        
svi     

  x
  c  i    ai      c  i    
 a  

   



   whereas our main focus in this paper is undirected graphs  we will also show how our results can be
readily extended to the case of directed graphs 

   

fimichalak  aadithya  szczepaski  ravindran    jennings

shapley provides the following intuition behind this formula  imagine that the players are
to arrive at a meeting point in a random order  and that every player ai who arrives receives
the marginal contribution that his arrival would bring to those already at the meeting point 
now if we average these contributions over all the possible orders of arrival  we obtain svi    
ai s payoff in the game 
the formula in     can also be stated in the equivalent  but computationally less involved 
form 
x  c    a    c      
svi     
  c   ai      c   
   
 a  
ca  ai  

in our network context  we will use g to define a coalitional game  v  g     with set of
agents a   v  g  and characteristic function   here the agents of the coalitional game are
the vertices of the graph g  thus  a coalition of agents c is simply any subset of v  g  
furthermore  the characteristic function     v  g   r can be any function that depends
on the graph g as long as it satisfies the condition         we use the phrase value of
coalition c to informally refer to  c  
we will first consider a sample characteristic function game defined over a network  as well
as its shapley value that becomes a centrality measure  we will then discuss the advantages
of the game theoretic network centrality over conventional measures 
in more detail  consider the notion of closeness centrality of a node in a graph g v  e  
which is traditionally defined as the reciprocal of the average distance of that node from
other  reachable  nodes in the graph  koschtzki et al          this definition captures the
intuitive idea that a node in close proximity to many other nodes is more valuable by
virtue of its central location  and hence should be assigned a higher centrality score 
the above measure  however  fails to recognize the importance of combinations of nodes  for
example  consider a typical application of closeness centrality  that of disseminating a piece
of information to all nodes in the network  at any time point t in the dissemination process 
define the random variable ct to be the subset of nodes actively involved in propagating the
information  in this situation  a new node added to ct would make maximum contribution
to the diffusion of information only if it is in close proximity to nodes that are not currently
in close proximity to any node in ct   thus  while conventional closeness centrality only
takes into account average proximity to all other nodes  the actual importance of a node in
actual applications is based on a very different measure  proximity to nodes that are not in
close proximity to the random variable ct  
we now show how coalitional game theory can be used to construct a centrality measure
that more faithfully models the above situation  let c be an arbitrary subset of nodes from
the given network g v  e   then  for every such c  assign a value  c  given by
 c   

x
vv  g 

 
 
    min d u  v  u  c 

where d u  v  is the distance between nodes u and v  measured as the shortest path length
between u and v in graph g  
   

ficomputation of the shapley value for game theoretic network centrality

the map  defined above captures a fundamental centrality notion  that the intrinsic value
of a subset of nodes c in the context of such an application as information dissemination is
proportional to the overall proximity of the nodes in c to the other nodes in the network 
in effect  the map  carries the original definition of closeness centrality to a global level 
where a measure of importance is assigned to every possible combination of nodes 
the map  above is therefore a characteristic function for a coalitional game  where each
vertex of the network is viewed as an agent playing the game  it follows that if a node v has
a high shapley value in this game  it is likely that v would contribute more to an arbitrary
randomly chosen coalition of nodes c in terms of increasing the proximity of c to other
nodes on the network  thus  computing the shapley values of this game yields a centrality
score for each vertex that is a much improved characterization of closeness centrality 
the only difficulty in adopting such a game theoretically inspired centrality measure is the
previously mentioned problem of exponential complexity in the number of agents  in the
next section  we show how to overcome this difficulty and compute the shapley value for
many centrality applications  including the above formulation  in time polynomial in the
size of the network 

   algorithms for shapley value based network centrality
in this section  we present five characteristic function formulations  c   each designed to
convey a specific centrality notion  as already mentioned in the introduction  a common
element of all these formulations is that they aim to quantify  albeit in a different way  the
sphere of influence of the coalition c over the other nodes in the network  specifically  in our
first game formulation  we start with the simplest possible idea that the sphere of influence
of a coalition of nodes c is the set of all nodes immediately reachable  within one hop  from
c  subsequent games further generalize this notion  in particular  the second formulation
specifies a more sophisticated sphere of influence  one that includes only those nodes which
are immediately reachable in at least k different ways from c  the other three formulations
extend the notion of sphere of influence to weighted graphs  the third game defines sphere
of influence as the set of all nodes within a cutoff distance of c  as measured by shortest
path lengths on the weighted graph   the fourth formulation is an extreme generalization 
it allows the sphere of influence of c to be specified by an arbitrary function f     of the
distance between c and the other nodes  the final formulation is a straightforward extension
of the second game  to the case of weighted networks 
the relationships among all five games are graphically presented in figure   
    game       c     agents at most   degree away
let g v  e  be an unweighted  undirected network  we first define the fringe of a subset
c  v  g  as the set  v  v  g    v  c  or  u  c such that  u  v   e g    i e   the
fringe of a coalition includes all nodes reachable from the coalition in at most one hop 
based on the fringe  we define the coalitional game g   v  g       with respect to the network
g v  e  by the characteristic function      v  g   r given by
   

fimichalak  aadithya  szczepaski  ravindran    jennings

figure    euler diagram showing the relationships among all five games considered in this
paper  specifically  game g  generalizes g    g  generalizes g  and is further generalized by
g    g  generalizes g    finally  we note that there are certain instances of games that can be
represented as g    g  and g   

 
 
   c   
size fringe c  

if c   
otherwise 

 
the above game was applied by suri and narahari        to find out influential nodes in
social networks and it was shown to deliver very promising results concerning the target
set selection problem  see kempe  kleinberg    tardos         it is therefore desired to
compute the shapley values of all nodes for this game  we shall now present an exact
formula for this computation rather than obtaining it through monte carlo simulation as
was done by suri and narahari 
in more detail  to evaluate the shapley value of node vi   consider all possible permutations
of the nodes in which vi would make a positive marginal contribution to the coalition of
nodes occurring before itself  let the set of nodes occurring before node vi in a random
permutation of nodes be denoted ci   let the neighbours of node vi in the graph g v  e 
be denoted ng  vi   and the degree of node vi be denoted degg  vi   
the key question to ask is  what is the necessary and sufficient condition for node vi to
marginally contribute node vj  ng  vi     vi   to fringe ci    clearly  this happens if and
only if neither vj nor any of its neighbours are present in ci   formally   ng  vj   vj   ci  
 
now we are going to show that the above condition holds with probability

 
  degg  vj    

proposition    the probability that in a random permutation none of the vertices from
ng  vj     vj   occurs before vi   where vi and vj are neighbours  is   deg g  vj    
   

ficomputation of the shapley value for game theoretic network centrality

algorithm    computing the shapley value for game  
input  unweighted graph g v  e 
output  shapley values of all nodes in v  g  for game g 
foreach v  v  g  do
sv v      deg  g  v   
foreach u  ng  v  do
sv v       deg  g  u   
end
end
return sv 

proof  we need to count the number of permutations that satisfy 
v ng  vj   vj     vi      v  

   

to this end 
 let us choose   ng  vj     vj    positions in the sequence of all elements from v   we

 v  
can do this in   deg
ways 
g  vj  
 then  in the last degg  vj   chosen positions  place all elements from  ng  vj     vj     
 vi    directly before these  place the element vi   the number of such line ups is
 degg  vj     
 the remaining elements can be arrange in   v         degg  vj     different ways 
all in all  the number of permutations satisfying condition     is 

 v  
 degg  vj      v
  degg  vj  

        degg  vj      

 v   
  degg  vj    

thus  the probability that one of such permutations is randomly chosen is

 
  degg  vj    

now  denote by bvi  vj the bernoulli random variable that vi marginally contributes vj to
fringe ci    from the above  we have 
e bvi  vj     pr  ng  vj     vj     ci      

 
 
    degg  vj  

therefore  svg   vi    which is the expected marginal contribution of vi   is given by 
svg   vi    

x

e bvi  vj    

x
vj  vi  ng  vi  

vj  vi  ng  vi  

   

 
 
    degg  vj  

   

fimichalak  aadithya  szczepaski  ravindran    jennings

which is an exact closed form expression for computing the shapley value of each node on
the network 
it is possible to derive some intuition from the above formula  if a node has a high degree 
the number of terms in its shapley value summation above is also high  but the terms
themselves will be inversely related to the degree of neighboring nodes  this gives the
intuition that a node will have high centrality not only when its degree is high  but also
whenever its degree tends to be higher in comparison to the degree of its neighboring nodes 
in other words  power comes from being connected to those who are powerless  a fact that
is well recognized by the centrality literature  e g   bonacich         following the same
reasoning  we can also easily predict how dynamic changes to the network  such as adding
or removing an edge  would influence the shapley value   adding an edge between a powerful
and a powerless node will add even more power to the former and will decrease the power
of the latter  naturally  removing an edge would have the reverse effect 
interestingly  although game g  is quite different from the induced subgraph representation
of deng and papadimitriou         the formula for svg   vi   is  to some extent  similar to
formula      in particular  in both cases  the shapley value of a node depends solely on the set
of its immediate neighbours  moreover  in both cases  it is a linear combination of fractions
involving in the numerator the weight of edges between the node and its neighbours   the
difference is in the denominators  where in our case it depends on the degree of the involved
nodes  we will see that the next two games considered in this paper yield comparable to g 
closed form expressions for the shapley value 
algorithm   directly implements expression     to compute the exact shapley values of all
nodes in the network  it cycles through all nodes and their neighbours  so its running time
is o  v      e   
finally  we note that algorithm   can be adopted to directed graphs with a couple of simple
modifications  specifically  in order to capture how many nodes we can access a given
node from  the degree of a node should be replaced with indegree  furthermore  a set of
neighbours of a given node v should consist of those nodes to which an edge is directed from
v 
    game       c     agents with at least k neighbors in c
we now consider a more general game formulation for an unweighted graph g v  e   where
the value of a coalition includes the number of agents that are either in the coalition or
are adjacent to at least k agents who are in the coalition  formally  we consider game g 
characterised by      v  g   r  where
 
 
   c   
  v   v  c  or   ng  v   c   k  

if c   
otherwise 

   many real life networks are in fact dynamic and the challenge of developing fast streaming algorithms
has recently attracted considerable attention in the literature  lee  lee  park  choi    chung        
   note that in case of g  the weight of any edge is   

   

ficomputation of the shapley value for game theoretic network centrality

the second game is an instance of the general threshold model that has been widely studied
in the literature  e g   kempe et al         granovetter         intuitively  in this model
each node can become active if a monotone activation function reaches some threshold  the
instance of this problem has been proposed by goyal  bonchi  and lakshmanan         where
the authors introduced a method of learning influence probabilities in social networks  from
users action logs   however  in many realistic situations much less information is available
about a network so it is not possible to assess specific probabilities with which individual
nodes become active  consequently  much simpler models are studied  bikhchandani et al 
        for instance  consider a teenager deciding whether or not to try drugs  a strong
motivation for trying out drugs is the fact that friends are doing so  conversely  seeing friends
reject drugs could help persuade the teenager to stay clean  this situation is modelled by
the second game  the threshold for each node is k and the activation function is f  s   
 s   another example is viral marketing or innovation diffusion analysis  again  in this
application  it is often assumed that an agent will be influenced only if at least k of his
neighbors have already been convinced  valente         note that this game reduces to
game g  for k     
adopting notation from the previous subsection  we again ask  what is the necessary and
sufficient condition for node vi to marginally contribute node vj  ng  vi     vi   to the value
of the coalition ci  
clearly  if degg  vj     k  we have e bvi  vj       for vi   vj and   otherwise  for degg  nj    k 
we split the argument into two cases  if vj    vi   the condition for marginal contribution
is that exactly  k     neighbors of vj already belong to ci and vj 
  ci   on the other
hand  if vj   vi   the marginal contribution occurs if and only if ci originally consisted of at
most  k     neighbors of vj   so for degg  vj    k and vj    vi   we need to determine the
appropriate probability 
proposition    the probability that in a random permutation exactly k    neighbours of vj
  degg  vj  k
occur before vi   and vj occurs after vi   is  degg  vj     deg
  where vj and vi are neighbors
g  vj   
and degg  vj    k 
proof  we need to count the number of permutations that satisfy 

n

 
 kng  vj    k    k     vk  v     vi   
o

 
vng  vj   k  vi     v    vi      vj    

   

to this end 
 let us choose   ng  vj     vj    positions in the sequence of all elements from v   we

 v  
can do this in   deg
ways 
 v
 
g j
 then  choose k    elements from the set  ng  vj      vi    the number of such choices
 vj   
is deggk 
 
   

fimichalak  aadithya  szczepaski  ravindran    jennings

algorithm    computing the shapley value for game  
input  unweighted graph g v  e   positive integer k
output  shapley value of all nodes in v  g  for game g 
foreach v  v  g  do
sv v    min      degk g  v    
foreach u  ng  v  do
g  u k  
sv v     max    deggdeg
 u    degg  u     
end
end
return sv 

 then  in the first k    chosen positions  place all elements chosen in previous step 
directly after those  place the element vi   and then the remaining vertices chosen in
the first step  the number of such line ups is  k          degg  vj    k   
 the remaining elements can be arrange in   v    degg  vj        different ways 
taking all the above together  the number of permutations satisfying condition     is 
 degg  
 v  
k   k
  degg  vj  

         degg  vj    k    v    degg  vj         

 v      degg  vj  k 
degg  vj     degg  vj     

thus  the probability that one of such permutations is randomly chosen is

  degg  vj  k
degg  vj     degg  vj     

using proposition   we obtain 
e bvi  vj    

    degg  vj    k
 
degg  vj       degg  vj   

and for degg  vi    k and vj   vi   we have 

e bvi  vi    

k 
x
n  

 
k
 
 
    degg  vi  
    degg  vi  

as before  the shapley values are given by substituting the above formulae into 
svg   vi    

x

e bvi  vj   

vj ng  vi   vi  

although this game is a generalization of game g    it can still be solved to obtain the shapley
values of all nodes in o  v      e   time  as formalised by algorithm   
   

ficomputation of the shapley value for game theoretic network centrality

an even more general formulation of the game is possible by allowing k to be a function
of the agent  i e   each node vi  v  g  is assigned its own unique attribute k vi    this
translates to an application of the form  agent i is convinced if and only if at least ki of his
neighbors are convinced  which is a frequently used model in the literature  valente        
the above argument does not use the fact that k is constant across all nodes  so this
generalized formulation can be solved by a simple modification to the original shapley value
expression 
sv  vi    

k vi  
 
    degg  vi  

x
vj ng  vi  

    degg  vj    k vj  
 
degg  vj       degg  vj   

the above equation  which is also implementable in o  v    e   time  assumes that k vi   
  degg  vi   for all nodes vi   this condition can be assumed without loss of generality because
all cases can still be modelled  we set k vi         degg  vi   for the extreme case where node
vi is never convinced no matter how many of its neighbors are already convinced  
finally  we note that algorithm   can be adapted to a case of directed graphs along the
same lines as algorithm   
    game       c     agents at most dcutoff away
hitherto  our games have been confined to unweighted networks  but in many applications 
it is necessary to model real world networks as weighted graphs  for example  in the coauthorship network mentioned in the introduction  each edge is often assigned a weight
proportional to the number of joint publications the corresponding authors have produced
 newman        
this subsection extends game g  to the case of weighted networks  whereas game g  equates
 c  to the number of nodes located within one hop of some node in c  our formulation
in this subsection equates  c  to the number of nodes located within a distance dcutoff of
some node in c  here  distance between two nodes is measured as the length of the shortest
path between the nodes in the given weighted graph g v  e  w    where w   e  r  is the
weight function 
formally  we define game g    where for each coalition c  v  g  
 
 
   c   
size  vi   vj  c   distance vi   vj    dcutoff   

if c   
otherwise 

clearly  g  can be used in all the settings where g  is applicable  for instance  in the diffusion
of information in social networks or to analyse research collaboration networks  e g   suri  
narahari               moreover  as a more general game  g  provides additional modelling
opportunities  for instance  suri and narahari        suggest that a more intelligent way
for sieving nodes in the neighbourhood would improve their algorithm for solving the target
selection problem  top k problem   now  g  allows us to define a different cutoff distance
   

fimichalak  aadithya  szczepaski  ravindran    jennings

algorithm    computing the shapley value for game  
input  weighted graph g v  e  w    dcutoff    
output  shapley value of all nodes in g for game g 
foreach v  v  g  do
distancevector d   dijkstra v g  
extneighbors v      extdegree v      
foreach u  v  g  such that u    v do
if d u   dcutoff then
extneighbors v  push u  
extdegree v    
end
end
end
foreach v  v  g  do
 
sv v      extdegree v 
 
foreach u  extn eighbors v  do
 
sv v       extdegree u 
 
end
end
return sv 

for each node in suri and naraharis setting  furthermore  g  is a specific case of the more
general model g  which will be discussed in next subsection 
we shall now show that even this highly general centrality game g  is amenable to analysis
which yields an exact formula for the shapley value  however  in this case the algorithm
for implementing the formula is not linear in the size of the network  but has o  v   e   
 v    log v    complexity 
before deriving the exact shapley value formula  we introduce some extra notation  define
the extended neighborhood ng  vj   dcutoff      vk    vj   distance vk   vj    dcutoff    i e   the
set of all nodes whose distance from vj is at most dcutoff   denote the size of ng  vj   dcutoff  
by degg  vj   dcutoff    with this notation  the necessary and sufficient condition for node vi
to marginally contribute node vj to the value of coalition ci is  distance vi   vj    dcutoff
and distance vj   vk     dcutoff vk  ci   that is  neither vj nor any node in its extended
neighborhood should be present in ci   from the discussion in previous subsections and
proposition    we know that the probability of this event is exactly   degg  v j  dcutoff     therefore  the exact formula for the shapley value of node vi in game g  is 
svg   vi    

x
vj  vi  ng  vi  dcutoff  

 
 
    degg  vj   dcutoff  

algorithm   works as follows  for each node v in the network g v  e   the extended neighborhood ng  v  dcutoff   and its size degg  v  dcutoff   are first computed using dijkstras algorithm
   

ficomputation of the shapley value for game theoretic network centrality

in o  e     v  log v    time  cormen         the results are then used to directly implement
the above equation  which takes maximum time o  v       in practice this step runs much
faster because the worst case situation only occurs when every node is reachable from every
other node within dcutoff   overall the complexity is o  v   e     v    log v    
furthermore  to deal with directed graphs we need to redefine the notion of extdegree and
extn eighbors for a given node u in algorithm    the former will be the number of vertices
from which the distance to u is smaller than  or equal to  dcutoff   the latter will be the set
of nodes whose distance from u is at most dcutoff  
finally  we make the observation that the above proof does not depend on dcutoff being
constant across all nodes  indeed  each node vi  v  g  may be assigned its own unique
value dcutoff  vi    where  c  would be the number of agents vi who are within a distance
dcutoff  vi   from c  for this case  the above proof gives 
sv  vi    

x

vj  distance vi  vj  
dcutoff  vj  

    game       c   

 
 
    degg  vj   dcutoff  vj   

p

vi v  g  f  distance vi   c  

this subsection further generalizes game g    again taking motivation from real life network
problems  in game g    all agents at distances dagent  dcutoff contributed equally to the
value of a coalition  however  this assumption may not always hold true because in some
applications we intuitively expect agents closer to a coalition to contribute more to its value 
for instance  we expect a facebook user to exert more influence over his immediate circle
of friends than over friends of friends  even though both may satisfy the dcutoff criterion 
similarly  we expect a virus affected computer to infect a neighboring computer more quickly
than a computer two hops away 
in general  we expect that an agent at distance d from a coalition would contribute f  d  to
its value  where f     is a positive valued decreasing function of its argument  more formally 
we define game g    where the value of a coalition c is given by 
 
 
   c    p

vi v  g  f  d vi   c  

if c   
otherwise 

where d vi   c  is the minimum distance  min distance vi   vj   vj  c  
we note that it is possible to solve for the shapley value in the above formulation by
constructing an mc nets representation  see section   for more details on this formalism  
indeed  the combinatorial structure of networks is to a certain extent similar to the structure
of mc nets  consequently  the existence of a polynomial algorithm to compute the shapley
value for mc nets strongly suggests that polynomial algorithms could be developed for
games defined over networks  our results in this paper demonstrate that this is indeed
the case  however  it should be underlined that our approach to compute the shapley
   

fimichalak  aadithya  szczepaski  ravindran    jennings

value is different from that applied in mc nets  this is because in our solutions we focus
on computing the expected contribution of every node in a random permutation of nodes
and not on disaggregating the game into a collection of simple  easily solvable  games
as it is done in mc nets  the difference in both approaches is clearly visible in the case
of g    here  the mc nets would have o  v      rules  whereas in the discussion below  we
propose a more efficient algorithm for g  that runs in o  v   e     v    log v     this is a
considerable improvement because most real world networks are sparse  i e   e  o  v   
 reka   barabsi        
in the case of g    the key question to ask is  what is the expected value of the marginal
contribution of vi through node vj    vi to the value of coalition ci   let this marginal
contribution be denoted m c vi   vj    clearly 
 
 
m c vi   vj    
f  distance vi   vj     f  d vj   ci   

if distance vi   vj    d vj   ci  
otherwise 

let dvj    d    d     d v      be the distances of node vj from all other nodes in the network 
sorted in increasing order  let the nodes corresponding to these distances be  w    w     w v      
respectively  let kij     be the number of nodes  out of these  v       whose distances to
vj are  distance vi   vj    let wkij      vi  i e   among all nodes that have the same distance
from vj as vi   vi is placed last in the increasing order  
we use literal wi to mean wi  ci and the literal wi to mean wi 
  ci   define a sequence
of boolean variables pk   vj  w   w        wk for each    k   v       finally denote
expressions of the form m c vi   vj  f   to mean the marginal contribution of vi to ci through
vj given that the coalition ci satisfies the boolean expression f  

m c vi   vj  pkij     wkij        f  dkij       f  dkij      
m c vi   vj  pkij     wkij        f  dkij       f  dkij      
  
  
  
 
 
 
m c vi   vj  p v     w v        f  dkij       f  d v      
m c vi   vj  p v        f  dkij      
with this notation  we obtain expressions for m c vi   vj   by splitting over the above mutually
exclusive and exhaustive  i e   covering all possible non zero marginal contributions  cases 
now  we need to determine the probability of pr pk  wk     
proposition    the probability that in a random permutation none of the nodes from
 
 
 vj   w            wk   occur before vi and the node wk   occurs before vi is  k    k   
proof  let us count the number of permutations that satisfy 
v vj  w       wk    vi      v    vi    wk     
to this end 
   

   

ficomputation of the shapley value for game theoretic network centrality

 let us choose   vj   w            wk   vj   wk      positions in the sequence of all elements
 v   
from v   we can do this in k  
ways 
 then  in the last k     chosen positions  we place all elements from  vj   w            wk   
directly before these  we place the element vi   and then vertex wk     the number of
such line ups is  k       
 the remaining elements can be arrange in   v     k       different ways 
thus  the number of permutations satisfying     is 
 v   
k    k

       v     k         

 v   
 k    k     

and the probability that one of such permutations is randomly chosen is

 
 k    k     

with the above proposition we find that 
pr pk  wk    

 
     kij  k   v      
 k      k     

using the m c vi   vj   equations and the probabilities pr pk  wk     




x f  distance vi   vj     f  dk    
   f  distance vi   vj   
e m c vi   vj      
 k      k     
 v  
 v   

k   kij

f  distance vi   vj   

 
kij    

 v   

x
k kij   

f  dk    
 
 k      k     

for vi   vj   a similar analysis produces 
 v   

e m c vi   vi      f     

x
k  

f  dk    
 
 k      k     

finally the exact shapley value is given by 
svg   vi    

x

e m c vi   vj    

vj v  g 

algorithm   implements the above formulae  for each vertex v  a vector of distances to
every other vertex is first computed using dijkstras algorithm  cormen         this yields
a vector dv that is already sorted in increasing order  this vector is then traversed in
   

fimichalak  aadithya  szczepaski  ravindran    jennings

algorithm    computing the shapley value for game  
input  weighted graph g v  e  w    function f   r   r 
output  shapley value of all nodes in g for game g 
initialise  v  v  g  set sv v      
foreach v  v  g  do
 distances d  nodes w    dijkstra v g  
sum      index    v     prevdistance       prevsv      
while index     do
if d index     prevdistance then
currsv   prevsv 
else
currsv   f  d index  
  index  sum 
end
sv w index      currsv 
sum   

f  d index  
index   index   

prevdistance   d index   prevsv   currsv 
index   
end
sv v     f     sum 
end
return sv 

p f  dk    
reverse  to compute the backwards cumulative sum
 k    k      at each step of the backward traversal  the shapley value of the appropriate node w is updated according to the
e m c w  v   equation  after the traversal  the shapley value of v itself is updated according
to the e m c v  v   equation  this process is repeated for all nodes v so that at the end of
the algorithm  the shapley value is computed exactly in o  v   e     v    log v    time 
our final observation is that algorithm   works also for directed graphs as long as we use
the appropriate version of dijkstras algorithm  see  e g   cormen        
    game       c     agents with

p
 weights inside c   wcutoff  agent 

in this subsection  we generalize game g  for the case of weighted networks  given a positive
weighted network g v 
p e  w   and a value wcutoff  vi   for every node vi  v  g   we first
define w  vj   c    vi c w  vj   vi   for every coalition c  where w  vi   vj   is the weight of
the edge between nodes vi and vj  or   if there is no such edge   with this notation  we
define game g  by the characteristic function 
 
 
   c   
size  vi   vi  c  or  w  vi   c   wcutoff  vi    
   

if c   
otherwise 

ficomputation of the shapley value for game theoretic network centrality

algorithm    computing the shapley value for game  
input  weighted network g v  e  w    cutoffs wcutoff  vi   for each vi  v  g 
output  shapley value of all nodes in g for game g 
foreach vi  v  g  do
compute and store i and i  
end
foreach vi  v  g  do
sv vi       
foreach m in   to degg  vi   do
ii        x ii    p   pr n           w
compute     xm
cutoff  vi    
m
p
sv vi        degg  vi    
end
foreach vj  ng  vi   do
p     
foreach m in   to degg  vj      do
ij
ij
ij
compute     xm
       xm
  and z   zm
 
deg  v  m

g j
p    z degg  vj   deg
 
g  vj     

end
sv vi      p 
end
end
return sv 

the formulation above has applications in  for instance  the analysis of information diffusion  adoption of innovations  and viral marketing  indeed  many cascade models of such
phenomena on weighted graphs have been proposed  e g   granovetter        kempe et al  
      young        which work by assuming that an agent will change state from inactive
to active if and only if the sum of the weights to all active neighbors is at least equal to
an agent specific cutoff 
although we have not been able to come up with an exact formula for the shapley value in
this game     our analysis yields an approximate formula which was found to be accurate in
practice 
in more detail  we observe that node vi marginally contributes node vj  ng  vi   to the value
of coalition ci if and only if vj 
  ci and wcutoff  vj    w  vi   vj    w  vj   ci     wcutoff  vj   
let us denote by bvi  vj the bernoulli random variable corresponding to this event  we will
need the following additional notation 
 let ng  vj      vi   w    w     wdegg  vj      
    computing the shapley value for this game involves determining whether the sum of weights on specific
edges  adjacent to a random coalition  exceeds the threshold  this problem seems to be at least as hard
as computing the shapley value in weighted voting games  which is  p complete  elkind et al         

   

fimichalak  aadithya  szczepaski  ravindran    jennings

 let the weights of edges between vj and each of the nodes in ng  vj   be wj  
 w  vi   vj    w    w     wdegg  vj      in that order 
 let j be the sum of all the weights in wj and j be the sum of the squares of all the
weights in wj  
 let kij be the number of nodes of ng  vj   that occur before vi in ci  
 let xtij be the sum of a t subset of wj    w  vi   vj    drawn uniformly at random from
the set of all such possible t subsets  and finally
 let ymij be the event  kij   m  vj 
  ci   
then 
degg  vj   

e bvi  vj    

x

ij
pr ymij   pr xm
  wcutoff  vj    w  vi   vj    wcutoff  vj     

m  

where pr ymij   is obtained from proposition   
pr ymij  



degg  vj    m
degg  vj      m   degg  vj    m  
 
 
 
 degg  vj        
degg  vj   degg  vj       
m

ij
evaluating pr xm
  wcutoff  vj    w  vi   vj    wcutoff  vj     is much more difficult because
ij
is a complicated function of the degg  vj      numbers in wj  
the distribution of xm
ij
 w  vi   vj     however  we can obtain analytical expressions for the mean  xm
  and variance
ij
    xm
   these are given by 

m
 j  w  vi   vj   
degg  vj     
 j  w  vi   vj    
m degg  vj       m 
ij
  
 j  w  vi   vj    
  
    xm
 degg  vj       degg  vj      
degg  vj     
ij
 xm
  

ij
knowing only the mean and variance  not the exact distribution  of xm
  we propose the
approximation 

ij
ij
ij
xm
 n   xm
       xm
   

where n         denotes the gaussian random variable with mean  and variance      this
approximation is similar to the randomised approach that has been proposed and tested by
fatima et al         
with this approximation  we have 
   

ficomputation of the shapley value for game theoretic network centrality

ij
ij
zm
  pr xm
  wcutoff  vj    w  vi   vj    wcutoff  vj    

given by

ij
zm

 
 
erf

 

ij
wcutoff  vj     xm
 

ij
  xm  

 
 erf

ij
wcutoff  vj    w  vi   vj     xm
 

ij
  xm  

  
 

this allows us to write 
degg  vj   

e bvi  vj    

x
m  

degg  vj    m
z ij  
degg  vj   degg  vj        m

the above equations are true only for vj    vi   for vj   vi we have 

 
e bvi  vi   
    degg  vi  

degg  vi  

x

ii
ii
pr n   xm
       xm
     wcutoff  vi    

m  

where
ii
 xm
  

m
i
degg  vi  

and

ii
    xm
  

i 
m  degg  vi    m 
 i 
  
degg  vi    degg  vi      
degg  vi  

p
finally the shapley value of node vi is given by vj  vi  ng  vi   e bvi  vj   
p
while inpeach graph
p it holds that vi v  g  degg  vi      e   algorithm   implements an
o  v     vi v  g  vj ng  vi   degg  vj     o  v      v   e     o  v   e   solution to compute
the shapley value for all agents in game g  using the above approximation 
furthermore  we make the following observation  the approximation of the discrete random
ij
variable xm
as a continuous gaussian random variable is good only when degg  vj   is large 
for small degg  vj    one might as well use the brute force computation to determine e bvi  vj  
in o  degg  vj      time 
as far as directed graphs are concerned  in all calculations in algorithm   we have to consider
the indegree of a node instead of degree  furthermore  the set of neighbours of a node u
should be defined as the set of nodes vi connected with directed edge  u  vi   
   

fimichalak  aadithya  szczepaski  ravindran    jennings

   simulations
in this section we evaluate the time performance of our exact algorithms for games g  to
g  and our approximation algorithm for game g    in more detail  we compare our exact
algorithms to the method of approximating the shapley value via monte carlo sampling
which has been the only feasible approach to compute game theoretic network centrality
available to date in the literature  first  we provide a detailed description of the simulation
setup  then  we present data sets and the simulation results 
    simulation setup
there are a few approximation methods for the shapley value that have been recently
proposed in literature  they can be divided into three groupseach referring to a specific
subclass of coalitional games under consideration 
   first  let us consider the method proposed by fatima et al         and elaborated
further by fatima  wooldridge  and jennings         this approach concerns weighted
voting games  in these games  each player has a certain number of votes  or in other
words  a weight   a coalition is winning if the number of votes in this coalition
exceeds some specific threshold  or losing otherwise  fatima et al  propose the
following method to approximate the shapley value in weighted voting games  instead
of finding marginal contributions of players to all  n coalitions  the authors consider
only n randomly selected coalitions  one of each size  i e   from   to n   only for
these n coalitions are the players expected marginal contributions calculated and the
average of these contributions yields an approximation of the shapley value  whereas
fatima et al  method is certainly attractive  it is only applicable to games in which the
value of a coalition depends on the sum of associated weights being in some bounds 
this is not the case for our games g  to g     
   another method was proposed by bachrach  markakis  procaccia  rosenschein  and
saberi      a  in the context of simple coalitional games    in which the characteristic function is binaryi e   each coalition has a value of either zero or one  for
these games  bachrach et al  extend the approach suggested by mann and shapley
       and provide more rigorous statistical analysis  in particular  mann and shapley
described the monte carlo simulations to estimate the shapley value from a random
sample of coalitions  bachrach at al  use this technique to compute the banzhaf power
index and then they suggested using a random sample of permutations of all players
in order to compute the shapley shubik index for simple coalitional games    the
computation of the confidence interval  which is crucial in such an approach  hinges
upon the binary form of the characteristic function for simple coalitional games  this
    recall that our approximation algorithm for g  builds upon fatima et al  method  this is because in
this game the marginal contribution of each node depends on the weights assigned to its incident edges 
    note that weighted voting games are simple coalitional games 
    the shapley shubik index is a very well known application of the shapley value that evaluates the power
of individuals in voting  shapley   shubik        

   

ficomputation of the shapley value for game theoretic network centrality

algorithm    monte carlo method to approximate the shapley value
input 
 characteristic function v  maximum iteration maxiter
output  aproximation of shapley value for game v
for vi  v  g  do
sv vi        
end
for i     to maxiter do
shuffle v  g   
marginal contribution block
p  
for vi  v  g  do
sv vi      v p   vi      v p   
p   p   vi    
end
end
for vi  v  g  do
sv vi  
sv vi     maxiter
 
end
return sv  

method is more general than the one proposed by fatima et al        as weighted
voting games are a subset of simple coalitional gamesbut still it cannot be effectively
used for our games g  to g    where the characteristic functions are not binary 
   unlike the first two methods  the last method described by castro et al         can
be efficiently applied to all coalitional games in characteristic function game form 
assuming that the worth of every coalition can be computed in polynomial time  here 
approximating the shapley value involves generating permutations of all players and
computing the marginal contribution of each player to the set of players occurring
before it  the solution precision increases  statistically  with every new permutation
analysed  furthermore  the authors show how to estimate the appropriate size of a
permutation sample in order to guarantee a low error  given its broad applicability 
this method is used in our simulations as a comparison benchmark 
in more detail  in a preliminary step  we test what is the maximum number of monte
carlo iterations that can be performed in a reasonable time for any given game  this
maximum number of iterations  denoted maxiter  becomes an input to algorithm   for
monte carlo sampling  in this algorithm  in each one of the maxiter iterations  a random
permutation of all nodes is generated  then  using a characteristic function from the set
                        it calculates the marginal contribution of each node to the set p
   

fimichalak  aadithya  szczepaski  ravindran    jennings

of nodes occurring before a given node in a random permutation    finally  the algorithm
divides the aggregated sum of all contributions for each node by the number of iterations
performed  the time complexity of this algorithm is o maxiter  con   where con denotes
the number of operations necessary for computing the marginal contribution block  this
block is specifically tailored to the particular form of the characteristic function of each of
the games g  to g    in particular  for game g   see algorithm     it is constructed as follows 
recall that  in this game  node vi makes a positive contribution to coalition p through itself
and through some adjacent node u under two conditions  firstly  neither vi nor u are in p  
secondly  there is no edge from p to vi or u  to check for these conditions in algorithm  
we store those nodes that have already contributed to the value of coalition p in an array
called  counted  for each node vi   the algorithm iterates through the set of its neighbours
and for each adjacent node it checks whether this adjacent node is counted in the array
counted  if not  the marginal contribution of the node vi is increased by one  in appendix
a we describe the marginal contribution block for games g            g    respectively   
some details of how algorithm   is applied to generate the shapley value approximations for
games g  to g    for which we propose exact polynomial solutions  differ from g    for which
we developed an approximate solution  specifically  for games g  to g   
   we use the exact algorithm proposed in this paper to compute the shapley value 
   then  we run monte carlo simulations    times    in every run 
 we perform maxiter monte carlo iterations 
 after every five iterations  we compare the approximation of the shapley value
obtained via monte carlo simulation with the exact shapley value obtained with
our algorithm 
 we record the algorithms runtime and the error  where the error is defined as the
maximum discrepancy between the actual shapley value and the monte carlobased approximation of the shapley value 
   finally  we compute the confidence interval using all iterations        confidence
level    
in the case of game g  we cannot determine the exact shapley value for larger networks 
therefore  we performed two levels of simulation  one level on small networks and one level
on large networks  specifically 
   for small networks  we generate    random instances of weighted complete graphs
with   nodes  denoted k    and the same number of graphs with    nodes  denoted
    recall that the characteristic functions v    v            v  correspond to games g    g            g    respectively 
    the software package in c   containing all our exact approximation algorithms  as well as the monte
carlo approximation algorithms are available at www tomaszmichalak net 
    for the purpose of comparison to our method  it suffices to use    iterations  as the standard errors
converge significantly to indicate the magnitude of the cost of using the monte carlo method 
    since for g  each monte carlo iteration is relatively time consuming  we run it only once  thus  no
confidence interval is generated  i e   the third step is omitted 

   

ficomputation of the shapley value for game theoretic network centrality

k     with weights drawn from a uniform distribution u         then  for each graph
and each of the two parameters wcutoff  vi         vi   and wcutoff  vi         vi     
 we compute the exact shapley value using formula     
 then  we run our approximation algorithm and determine the error in our approximation 
 finally  we run      and      monte carlo iterations for k  and k     respectively 
   for large networks  we again generate    random instances of weighted complete
graphs  but now with      nodes  we denote them k        then  for each graph
and each of the three parameters wcutoff  vi         vi    wcutoff  vi         vi    and
wcutoff  vi         vi    
 we run our approximation algorithm for the shapley value 
 then  we run the fixed number          of monte carlo iterations 
 finally  we compute how the monte carlo solution converges to the results of our
approximation algorithm 
having described the simulation setup  we will now discuss the data sets and  finally  the
simulation results 
    data used in simulations
we consider two networks that have already been well studied in the literature  specifically 
for games g   g  we present simulations on an undirected  unweighted network representing
the topology of the western states power grid  wspg     this network  which has     
nodes and      edges  has been studied in many contexts before  see  for instance  watts  
strogatz        and is freely available online  see  e g   http   networkdata ics uci edu 
data php id       for games g   g   played on weighted networks   we used the network
of astrophysics collaborations  abbreviated henceforth aphc  between jan         and
december           this network  which has       nodes and        edges  is also freely
available online  see  e g   http   networkdata ics uci edu  data php id     and has
been used in previous studies like newman        
    simulation results
the results presented in this section show that our exact algorithms are  in general  much
faster then the monte carlo sampling  and this is the case even if we allow for generous
error tolerance  furthermore  requiring smaller monte carlo errors makes the monte carlo
runtime exponentially slower than our exact solution 
    recall that j is the sum of all the weights in wj as defined in section     
    note that with the distance threshold dcutoff replaced with a hop threshold kcutoff   game g  can be played
on an unweighted network 

   

fimichalak  aadithya  szczepaski  ravindran    jennings

    

    

    

    

    

    

    

    
   

    
   

   

   

   

   

   

   
     ms

 
   

  

                    
maximal allowable mc error    

  

    

   

  

                    
maximal allowable mc error    

  

 

figure    g    k      wspg  uw 
    

monte carlo solution
our exact solution

    

     ms

 

 

figure    g    wspg  uw 

monte carlo solution
our exact solution

    

    

    

    

    

    

    

time  ms 

time  ms 

monte carlo solution
our exact solution

    

time  ms 

time  ms 

    

monte carlo solution
our exact solution

    

    
   

    
   

   

   

   

   

   

   
     ms

 
   

  

                    
maximal allowable mc error    

figure    g    ki  

degi
   

  

 

     ms

 
   

  

                    
maximal allowable mc error    

figure    g    ki  

wspg  uw 

 
 

  

 

degi   wspg  uw 

in more detail  the simulation results for game g  are shown in figure    the dotted line
shows the performance of our exact algorithm which needs     ms to compute the shapley
value  in contrast  generating any reasonable monte carlo result takes a substantially longer
time  the solid line shows the average and the shaded area depicts the confidence interval
for monte carlo simulations   in particular  it takes on average more than    ms to achieve
a     error and more than     ms are required to guarantee a    error  which is more
than      times slower than our exact algorithm  
 
i
figures       concern game g  for different values of k  k      ki   deg
    and ki     degi  
  
respectively  where degi is the degree of node vi    the advantage of our exact algorithm
over monte carlo simulation is again exponential 

replacing the distance threshold dcutoff with a hop threshold kcutoff enables game g  to be
played on an unweighted network  thus  similarly to games g  and g    we test it on the
western states power grid  the results are shown on figures   and    for kcutoff being
equal to   and    respectively  the third game is clearly more computationally challenging
than g  and g   note that the vertical axis is in seconds instead of milliseconds   now 
    recall that in g  the meaning of parameter k is as follows  the value of coalition c depends on the
number of nodes in the network with at least k neighbours in c 

   

fi  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

monte carlo solution
our exact solution

time  s 

time  s 

computation of the shapley value for game theoretic network centrality

      s
   

  

                    
maximal allowable mc error    

  

 

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

monte carlo solution
our exact solution

      s
   

figure    g    kcutoff      wspg  uw 

  

                    
maximal allowable mc error    

  

 

figure     g    kcutoff      wspg  uw 

our exact algorithm takes about   s to complete  the much lower speedups of the exact
methods with respect to monte carlo approach stem from the fact that both algorithms
have to start with dijkstras algorithm  although this algorithm has to be run only once in
both cases it takes more than     s for the considered network  this means that the exact
solution is slower by orders of magnitude  compared to games g  and g     the monte carlo
approach is also slower  but this slowdown is much less significant in relative terms 
figures    and    show the performance of the algorithms for game g  on the astrophysics
collaboration network that  unlike the western states power grid  is a weighted network 
d
davg
we observe that increasing the value of dcutoff  here from dcutoff   avg
  to dcutoff      
significantly worsens the performance of the monte carlo based algorithm  this is because
the increasing number of nodes that have to be taken into account while computing marginal
contributions  see the inner loop in algorithm    is not only more time consuming  but also
increases the monte carlo error 
 
for game g  the performance of algorithms is shown in figures          for f  d      d
 
 
d
f  d      d  and f  d    e   respectively   whereas the monte carlo methods for the
first three games are able to achieve a reasonable error bound in seconds or minutes  for
the fourth game it takes more than    hours to approach     error  this is because the
inner loop of the marginal contribution block  see algorithm    iterates over all nodes in
the network  due to the time consuming performance we run the simulations only once 
interestingly  we observe that the error of the monte carlo method sometimes increases
slightly when more iterations are performed  this confirms that the error of the monte
carlo method to approximate the shapley value proposed in castro et al         is only
statistically decreasing in time  certain new randomly chosen permutations can actually
increase the error 

figures            and    present comparisons of our approximation algorithm for game g 
against monte carlo sampling for small networks  for which the exact shapley value can
be computed from the definition in formula       in these figures  the horizontal dotted
line shows the running time of our solution  while the vertical dotted line shows its average
approximation error with the shaded area being the confidence interval  as previously  the
   

fi  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
 
 
 

monte carlo solution
our exact solution

   
   
   
   
  
  
  
  
     min
   

  

                    
maximal allowable mc error    

figure     g    dcutoff  

  

davg
   

  

     min

 

   

  

  

  

  

  

  

  

  

  

  

 

 
     min
  

                    
maximal allowable mc error    

figure     g    f  d   

 
  d  

  

  

aphc  w 

     min

 
  

                    
maximal allowable mc error    

figure     g    f  d   

aphc  w 

 

monte carlo solution
our exact solution

   

 

davg
   

  

  

  

   

                    
maximal allowable mc error    

  

monte carlo solution
our exact solution

 

  

figure     g    dcutoff  

aphc  w 

time  h 

time  h 

monte carlo solution
our exact solution

   

time  min 

time  min 

michalak  aadithya  szczepaski  ravindran    jennings

 
 
  d 

  

 

aphc  w 

monte carlo solution
our exact solution

  
  

time  h 

  
  
  
  
 
     min

 
   

  

                    
maximal allowable mc error    

  

 

figure     g    f  d    ed   aphc  w 
solid line shows the average  and the shaded area depicts the confidence interval for the
monte carlo simulations  we see in figures        and    that the approximation error
in our proposed algorithm is well contained for small networks  specifically  for k  it is
about      whereas for the bigger network k   it is about     however  we notice that  for
higher values of wcutoff   the monte carlo method may slightly outperform our solution  see
   

fi 
   
 
   
 
   
 
   
 
   
 
   
 
   
 

  
     
        
    
 

monte carlo solution
our approximation solution

time  ms 

time  ms 

  
     
        
    
 

computation of the shapley value for game theoretic network centrality

     ms
      

                       
maximal allowable mc error    

 
   
 
   
 
   
 
   
 
   
 
   
 
   
 

 

monte carlo solution
our approximation solution

     ms
      

  
 
      
 
      
  
 

monte carlo solution
our approximation solution

time  ms 

time  ms 

  
  
  
  
  
  
  
  
  
 
 
 
 
 

     ms
      

                       
maximal allowable mc error    

 

figure     g    wcutoff      i   k   w  

  
 
      
 
      
  
 

figure     g    wcutoff      i   k   w 

                       
maximal allowable mc error    

 

  
  
  
  
  
  
  
  
  
 
 
 
 
 

monte carlo solution
our approximation solution

     ms
      

figure     g    wcutoff      i   k    w 

                       
maximal allowable mc error    

 

figure     g    wcutoff      i   k    w 

in figure    how the average approximation error of the monte carlo sampling achieved in
    ms is lower than the average error achieved by our method  already for k   this effect
does not occur  see figure     
for large networks  where the exact shapley value cannot be obtained  we are naturally
unable to compute exact approximation error  we believe that this error may be higher
than the values obtained for k  and k     however  the mixed strategy  that we discussed
in section   and that uses our approximation only for large degree vertices  should work
towards containing the error within practical tolerance bounds  as far as we believe that
monte carlo gives good results  from figure     we can infer that our approximation solution
for large networks gives good results  within     and is at least two times faster than the
monte carlo algorithm 
to summarise  our exact solutions outperform monte carlo simulations even if relatively
wide error margins are allowed  however  this is not always the case for our approximation
algorithm for game g    furthermore  it should be underlined that if the centrality metrics
under consideration cannot be described with any of the games g  to g  for which exact
algorithms are now available  then monte carlo simulations are still a viable option 
   

fimichalak  aadithya  szczepaski  ravindran    jennings

our approximation solution
monte carlo solution wcutoff     
monte carlo solution wcutoff     
monte carlo solution wcutoff     

  
  
  

time  min 

  
  
  
      min

  
 
 

    

 

    

 

    

 
   

  

                    
maximal allowable mc error    

  

 

figure     g    wcutoff      i   wcutoff      i   and wcutoff      i   k      w 

   conclusions and future work
the key finding of this paper is that the shapley value for many centrality related cooperative
games of interest played on networks can be solved analytically  the resulting algorithms
are not only error free  but also run in polynomial time and  in practice  are much faster
than monte carlo methods  approximate closed form expressions and algorithms can also
be constructed for some classes of games played on weighted networks  simulation results
show that these approximations are acceptable for a range of situations 
there are a number of directions for future work  on one hand  the shapley value based
extensions of other centrality notions  that suit particular applications  can be developed  as
a step in this direction  the first study of the shapley value based betweenness centrality has
been recently presented by szczepaski  michalak  and rahwan         on the other hand 
it would be interesting to analyze what other coalitional games defined over a network would
better reflect centrality of nodes in certain real life applications  in this spirit  recent works of
del pozo  manuel  gonzlez arangena  and owen        and amer  gimnez  and magana
       focus on generalized coalitional games in which the order of agents forming coalitions
matter  nevertheless  there are still other classes of coalitional games  such as games with
either positive or negative externalities  yi         that have been extensively studied in
game theory and that may yield interesting results when applied to network centrality 
another interesting application for which a new class of coalitional games defined over a
network could be developed is the problem of influence maximization  already mentioned in
the introduction 
it is also interesting to analyse the properties of game theoretic network centralities constructed on solution concepts from cooperative game theory other than the shapley value 
in particular  if the game defined over a network belongs to the class of simple coalitional
games  i e   with a binary characteristic function  then the banzhaf power index  banzhaf 
      could be also used as a centrality metric  otherwise  more general solution concepts
such as the core  osborne   rubinstein        or the nucleolus  schmeidler        could be
applied 
   

ficomputation of the shapley value for game theoretic network centrality

ultimately  it would be interesting to develop a more formal and general approach that
would allow us to construct coalitional games defined over networks that correspond to
other known centrality metrics or even entire families of them    such an approach would
involve developing a group centrality first and then building a characteristic function of
a coalitional game upon it  of course  while developing new centrality metrics based on
coalitional games  one should keep in mind computational the properties of the proposed
solutions  although we were able to obtain satisfactory computational results for the games
considered in this paper  the computation of the game theoretic network centrality may
become much more challenging for more complex definitions of the characteristic function 

acknowledgments
we would like to thank three anonymous reviewers for their comments on the earlier version
of the paper that helped to improve it considerably  also  we would like to thank dr talal
rahwan and dr suri rama narayanam for proofreading  helpful comments and suggestions 
tomasz michalak was partially supported by the european research council under advanced grant         race   nicholas r  jennings  and partially tomasz michalak  was
supported by the orchid project  funded by epsrc  engineering and physical research
council  under the grant ep i         

appendix a  marginal contribution blocks for algorithm   for g   g 
algorithm    marginal contribution block of algorithm   for g 
counted  false  
edges     
foreach vi  v  g  do
foreach u  ng  vi     vi   do
edges u     
if  counted u  and   edges u   k u  or u   vi   then
sv vi      
counted u    true  
end
end
end
for each of the games considered in our paper the marginal contribution block of algorithm   takes a slightly different form  in the main text we explained the functioning of
this block for g    in this appendix  we discuss this block for the remaining four games  in
particular 
g    here  node vi makes a positive contribution to a coalition p both through itself and
through some adjacent node u also under two conditions  firstly  neither vi nor u are
    we thank an anonymous reviewer for this suggestion 

   

fimichalak  aadithya  szczepaski  ravindran    jennings

algorithm    marginal contribution block of algorithm   for g 
counted  false  
foreach vi  v  g  do
foreach u  extn eighbors vi     vi   do
if  counted u  then
sv vi      
counted u    true  
end
end
end
algorithm    marginal contribution block of algorithm   for g 
dist  infinity  
foreach vi  v  g  do
foreach u  v  g  do
if d u    dist u  then
sv vi      f d u     f dist u    
dist u    d u   
end
end
sv vi      f dist u     f     
dist vi        
end

in p   secondly  there is less than k edges from p to vi and there is exactly k    edges
from p to u  in order to check the first condition in algorithm   we use the array
counted  and to check the second one  we use the array edges  for each node vi  
the algorithm iterates through the set of its neighbours and for each adjacent node it
checks whether this adjacent node meets these two conditions  if so  then the marginal
contribution of the node vi is increased by one 
g      in marginal contribution blocks for games g  and g   algorithms   and     all the
values that are dependent on the distance  extn eighbours and d  are calculated
using dijkstras algorithm and stored in memory  these pre computations allow us
to significantly speed up monte carlo methods  now  in g  node vi makes a positive
contribution to coalition p through itself and through some adjacent node u under
two conditions  firstly  neither vi nor u are in p   secondly  there is no edge length of
dcutoff from p to vi or u  to check for these conditions in algorithm   we again use the
array counted  for each node vi   the algorithm iterates through the set of its extended
neighbours and for each of them it checks whether this neighbour meets the conditions 
if so  the marginal contribution of the node vi is increased by one  in game g    node
vi makes a positive contribution to coalition p through each node  including itself 
that is closer to vi than to p   in algorithm   we use array dist to store distances
   

ficomputation of the shapley value for game theoretic network centrality

algorithm     marginal contribution block of algorithm   for g 
counted  false  
weights     
foreach vi  v  g  do
foreach u  ng  vi     vi   do
weights u    w  vi   u  
if  counted u  and   weights u   wcutoff  u  or u   vi   then
sv vi      
counted u    true  
end
end
end

from coalition p to all nodes in the graph and array d to store all distances from vi
to all other nodes  for each node vi   the algorithm iterates through all nodes in the
graph  and for each node u  if the distance from vi to u is smaller than from p to u 
the algorithm computes the marginal contribution as f  d u    f  dist u    the value
dist u  is then updated to d u this is a new distance from p to u 
g    in game g    which is an extension of g  to weighted graphs  node vi makes a positive
contribution to coalition p  both through itself and through some adjacent node u 
under two conditions  firstly  neither vi nor u are in p   secondly  the sum of weights on
edges from p to vi is less than wcutoff  vi   and the sum of weights on edges from p to u is
greater than  or equal to  wcutoff  u w  vi   u  and smaller than wcutoff  vi   w  vi   u  
in order to check the first condition in algorithm    we use the array counted  and
to check the second one  we use the array w eights  for each node vi   the algorithm
iterates through the set of its neighbours and for each adjacent node it checks whether
this adjacent node meets these two conditions  if so  then the marginal contribution
of the node vi is increased by one 

appendix b  main notation used in the paper
a

the set of players 

ai

a player in a 

c

a coalition 
a value of the coalition  where  is characteristic function 

 c 
 a    gi
svgj  vi  
g    v  e 
g    v  e  w  
w  v  u 

a coalitional game 
the shapley value od the vertex vi in game gj  
unweighted graph network consisting of the set of vertices v and edges e 
weighted graph network 
weight on the edge from v to u 
   

fimichalak  aadithya  szczepaski  ravindran    jennings

v  g  v  e g  e
vi  v

the set of vertices and edges in graph g 

deg vi  

the vertex from the set v  
degree of the vertex vi  

ng  vi  

set of neighbours of vertex vi  g 

distance v  u  d v  u  the distance between vertices v and u 
extended neighbourhood  ng  vj   dcutoff      vk    vj   distance vk   vj   
ng  vi   dcutof f  
dcutoff   
marginal contribution that vertex u makes through vertex v 
m c u  v 
 a 
   a 
 i 
c  i 

the set of all orders of players in a 
the single ordering of agents in a 
the position of i  th element in ordering  
 aj      j     i   

e  

 v  v  g    v  c  or  u  c such that  u  v   e g   
the number assigned to vertex v used in game    the minimum number of
adjacent nodes necessary to influence node vi  
the number assigned to vertex v used in game    minimum sum of weights
on adjacent edges necessary to influence node vi  
the expectation operator 

p  

the probability operator 

o  

the big o complexity notation 

f ringe c 
k vi   ki
wcutoff  vi  

b  x  y
n        
erf   

random variables 
normal distribution with mean  and variance     

j

the error function 
the sum of all the weights of incident edges to vertex vj  

j

the sum of the squares of all the weights of incident edges to vertex vj  

f    

a positive valued decreasing function 

ki

the complete graph  clique  with i nodes 

references
aadithya  k   michalak  t     jennings  n          representation of coalitional games with
algebraic decision diagrams  in aamas     proceedings of the   th international
joint conference on autonomous agents and multi agent systems  pp           
amer  r   gimnez  j     magana  a          accessibility measures to nodes of directed
graphs using solutions for generalized cooperative games  mathematical methods of
operations research             
aziz  h   lachish  o   paterson  m     savani  r       a   power indices in spanning connectivity games  in aaim     proceedings of the  th international conference on
algorithmic aspects in information and management  pp       
   

ficomputation of the shapley value for game theoretic network centrality

aziz  h   lachish  o   paterson  m     savani  r       b   wiretapping a hidden network 
in wine     proceedings of the the  th workshop on internet   network economics 
pp         
bachrach  y   markakis  e   procaccia  a  d   rosenschein  j  s     saberi  a       a  
approximating power indices  in aamas     proceedings of the  th international
joint conference on autonomous agents and multi agent systems  pp         
bachrach  y   rosenschein  j  s     porat  e       b   power and stability in connectivity
games  in aamas     proceedings of the  th international joint conference on
autonomous agents and multi agent systems  pp          
bachrach  y     rosenschein  j          power in threshold network flow games  autonomous
agents and multi agent systems                 
banzhaf  j  f          weighted voting doesnt work  a mathematical analysis  rutgers
law rev              
bikhchandani  s   hirshleifer  d     welch  i          a theory of fads  fashion  custom 
and cultural change in informational cascades  journal of political economy          
        
bolus  s          power indices of simple games and vector weighted majority games by
means of binary decision diagrams  european journal of operational research          
       
bonacich  p          factoring and weighting approaches to status scores and clique identification  journal of mathematical sociology                
bonacich  p          power and centrality  a family of measures  american journal of
sociology                   
borgatti  s  p     everett  m          a graph theoretic framework for classifying centrality
measures  social networks  social networks                
brandes  u          a faster algorithm for betweenness centrality  journal of mathematical
sociology                 
brandes  u     erlebach  t          network analysis  methodological foundations  lecture
notes in computer science  tutorial  springer 
castro  j   gomez  d     tejada  j          polynomial calculation of the shapley value
based on sampling  computers   operations research                   
chalkiadakis  g   elkind  e     wooldridge  m          computational aspects of cooperative game theory  synthesis lectures on artificial intelligence and machine learning 
morgan   claypool publishers 
conitzer  v     sandholm  t          computing shapley values  manipulating value division schemes and checking core membership in multi issue domains  in aaai    
proceedings of the nineteenth national conference on artificial intelligence  pp     
    
cormen  t          introduction to algorithms  mit press 
   

fimichalak  aadithya  szczepaski  ravindran    jennings

del pozo  m   manuel  c   gonzlez arangena  e     owen  g          centrality in directed
social networks  a game theoretic approach  social networks                 
deng  x     papadimitriou  c          on the complexity of cooperative solution concepts 
mathematics of operations research                 
elkind  e   goldberg  l   goldberg  p     wooldridge  m          a tractable and expressive
class of marginal contribution nets and its applications  mathematical logic quarterly 
               
eppstein  d     wang  j          fast approximation of centrality  in soda     proceedings
of the twelfth annual acm siam symposium on discrete algorithms  pp         
everett  m  g     borgatti  s  p          the centrality of groups and classes   journal of
mathematical sociology                 
fatima  s  s   wooldridge  m     jennings  n          a randomized method for the shapley
value for the voting game  in aamas     proceedings of the   th international joint
conference on autonomous agents and multi agent systems  pp         
fatima  s  s   wooldridge  m     jennings  n          a linear approximation method for
the shapley value  artificial intellilgence                     
freeman  l          centrality in social networks  conceptual clarification  social networks 
              
gmez  d   gonzlez arangena  e   manuel  c   owen  g   del pozo  m     tejada  j 
        centrality and power in social networks  a game theoretic approach  mathematical social sciences               
goyal  a   bonchi  f     lakshmanan  l  v          learning influence probabilities in
social networks  in wsdm     proceedings of the  rd acm international conference
on web search and data mining  pp         
granovetter  m          threshold models of collective behavior  american journal of
sociology                   
greco  g   malizia  e   palopoli  l     scarcello  f          on the complexity of compact
coalitional games  in ijcai     proceedings of the twenty first international joint
conference on artifical intelligence  pp         
grofman  b     owen  g          a game theoretic approach to measuring centrality in
social networks  social networks            
ieong  s     shoham  y          marginal contribution nets  a compact representation
scheme for coalitional games  in ec     proceedings of the sixth acm conference on
electronic commerce  pp         
irwin  m     shapley  l  s          values of large games  iv   evaluating the electoral
college by montecarlo techniques  ca   rand corporation  santa monica 
jeong  h   mason  s  p   barabasi  a  l     oltvai  z  n          lethality and centrality in
protein networks  nature                   
kempe  d   kleinberg  j     tardos            maximizing the spread of influence through
a social network  in kdd     proceedings of the ninth acm sigkdd international
conference on knowledge discovery and data mining  pp         
   

ficomputation of the shapley value for game theoretic network centrality

kempe  d   kleinberg  j     tardos            influential nodes in a diffusion model for
social networks  automata  languages and programming           
koschtzki  d   lehmann  k   peeters  l   richter  s   tenfelde podehl  d     zlotowski  o 
        centrality indices  network analysis  vol       of lecture notes in computer
science  pp        springer 
lee  m  j   lee  j   park  j  y   choi  r  h     chung  c  w          qube  a quick
algorithm for updating betweenness centrality  in mille  a   gandon  f  l   misselis 
j   rabinovich  m     staab  s   eds    www  pp          acm 
mann  i     shapley  l          values of large games  vi  evaluating the electoral college
exactly   rand research memorandum 
matsui  t     matsui  y          a survey of algorithms for calculating power indices of
weighted majority games  journal of the operations research society of japan     
     
michalak  t   marciniak  d   samotulski  m   rahwan  t   mcburney  p   wooldridge  m  
  jennings  n       a   a logic based representation for coalitional games with externalities  in aamas     proceedings of the  th international joint conference on
autonomous agents and multi agent systems  pp         
michalak  t   rahwan  t   marciniak  d   szamotulski  m     jennings  n       b   computational aspects of extending the shapley value to coalitional games with externalities 
in ecai     proceedings of the nineteenth european conference on artificial intelligence 
myerson  r          graphs and cooperation in games  mathematics of operations research 
              
nagamochi  h   zeng  d   kabutoya  n     ibaraki  t          complexity of the minimum
base game on matroids  mathematics of operations research                 
newman  m          scientific collaboration networks  ii  shortest paths  weighted networks 
and centrality  physical review e                     
noh  j     rieger  h          random walks on complex networks  physical review letters 
                    
osborne  m  j     rubinstein  a          a course in game theory  vol    of mit press
books  the mit press 
reka  a     barabsi  a          statistical mechanics of complex networks  reviews of
modern physics           
sakurai  y   ueda  s   iwasaki  a   minato  s     yokoo  m          a compact representation
scheme of coalitional games based on multi terminal zero suppressed binary decision
diagrams  in prima     public risk management association  pp      
schmeidler  d          the nucleolus of a characteristic function game  siam journal on
applied mathematics           
schultes  d     sanders  p          dynamic highway node routing  in sea     proceedings
of  th workshop on experimental and efficient algorithms  lncs  pp        springer 
   

fimichalak  aadithya  szczepaski  ravindran    jennings

shapley  l  s          a value for n person games  in kuhn  h     tucker  a   eds    in
contributions to the theory of games  volume ii  pp          princeton university
press 
shapley  l  s     shubik  m          a method for evaluating the distribution of power in
a committee system  the american political science review                 
stephenson  k     zelen  m          rethinking centrality  methods and examples  social
networks              
suri  n     narahari  y          determining the top k nodes in social networks using the
shapley value  in aamas     proceedings of the  th international joint conference
on autonomous agents and multi agent systems  pp           
suri  n     narahari  y          a shapley value based approach to discover influential
nodes in social networks  ieee transaction on automation science and engineering 
        
szczepaski  p  l   michalak  t     rahwan  t          a new approach to betweenness
centrality based on the shapley value  in aamas     proceedings of the   th international joint conference on autonomous agents and multi agent systems  pp 
       
valente  t          social network thresholds in the diffusion of innovations  social networks 
             
watts  d     strogatz  s          collective dynamics of small world networks  nature 
                   
wooldridge  m     dunne  p          on the computational complexity of coalitional resource games  artificial intelligence                   
yi  s  s          stable coalition structures with externalities  games and economic behavior                 
young  h  p          the diffusion of innovations in social networks  in blume  b  l    
durlauf  s  n   eds    economy as an evolving complex system  vol    of proceedings
volume in the santa fe institute studies in the sciences of complexity santa fe institute
studies on the sciences of complexity  pp          oxford university press us 
zolezzi  j  m     rudnick  h          transmission cost allocation by cooperative games
and coalition formation  ieee transactions on power systems               

   

fi