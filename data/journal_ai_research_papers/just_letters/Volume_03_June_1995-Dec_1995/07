journal artificial intelligence research                 

submitted       published      

statistical feature combination
evaluation game positions
michael buro

nec research institute
  independence way
princeton nj       u s a 

mic research nj nec com

abstract

article describes application three well known statistical methods field
game tree search  using large number classified othello positions  feature weights
evaluation functions game phase independent meaning estimated means
logistic regression  fisher s linear discriminant  quadratic discriminant function
normally distributed features  thereafter  playing strengths compared means
tournaments resulting versions world class othello program 
application  logistic regression   used first time context game
playing   leads better results approaches 

   introduction

programs playing games chess  draughts  othello use evaluation functions estimate
players  winning chances positions leaves game trees  values
propagated root according negamax principle order choose move
root position leads highest score  normally  evaluation functions combine
features measure properties position correlated winning chance 
material chess mobility othello  popular quickly computable linear feature
combinations  early days game programming  feature weights chosen
intuitively improved manual hill climbing process programmer s patience
gave out  technique laborious  samuel             first describe method
automatic improvement evaluation function parameters  since many approaches
investigated  two main strategies distinguished 

move adaptation  evaluation function parameters tuned maximize frequency
searches yield moves occur lists moves belonging training
positions  idea get program mimic experts  moves 

value adaptation  given set labelled example positions  parameters determined

evaluation function fits specific model  instance  evaluation functions
constructed way predict final game result 

move adaptation  proposed instance marsland         v d  meulen        
mysliwietz         linear feature combination two degrees freedom  multiplied positive constant constant added without changing move
decision  evaluation function depends game phase  positions different
phases compared  for example within framework selective extensions opening
book play   constants must chosen suitably  evaluation functions optimized
c      ai access foundation morgan kaufmann publishers  rights reserved 

fiburo

move adaptation moment global interpretation  solution problem
obvious  schaeffer et al         presented ad hoc game specific approach 
respect  value adaptation promising  here  evaluations different
phases comparable example position labels phase independent meaning 
mitchell        labelled othello positions occurring game final game result
form disc differential tried approximate values using linear
combination features  since regression used determine weights 
possible investigate features  statistical relevance  another statistical approach
value adaptation used lee   mahajan         example positions classified
win loss side move   assuming features multivariate normal  
quadratic discriminant function used predict winning probability  technique
ensures desired comparability applies games without win degrees  i e 
know wins  draws  losses 
besides classical approaches heavily rely given feature sets  recent
years artificial neural networks  anns  trained evaluating game positions 
instance  moriarty   miikkulainen        used genetic algorithms evolve topology
weights anns order learn othello concepts means tournaments
fixed programs  discovering concept mobility  best   ply ann player
able win     games   ply brute force program used evaluation
function without mobility features  important contribution field
tesauro                   using temporal difference learning  sutton        updating
weights  anns learned evaluate backgammon positions master level means
self play  tesauro conjectured stochastic nature backgammon responsible
success approach  though several researchers obtained encouraging preliminary
results applying tesauro s learning procedure deterministic games  work yet
led strong tournament programs tactical games awari  draughts  othello 
chess  allow deep searches powerful quickly computable evaluation
functions known  might due tactics games knowledgeable
slower evaluation functions necessarily accurate relatively simple
faster evaluation functions conjunction deeper searches 
follows  three well known statistical models   namely quadratic discrimination function normally distributed features  fisher s linear discriminant  logistic
regression   described evaluation game positions context value
adaptation  thereafter  shown example positions parameter estimation
generated  finally  playing strengths three versions world class othello program 
  logistello   equipped resulting evaluation functions compared order
determine strongest tournament player  turns quadratic feature combinations necessarily lead stronger programs linear combinations  logistic
regression gives best results application 

   statistical feature combination

formal basis statistical feature combination position evaluation stated
follows 
   since appearance october      twelve    international tournaments played 

   

fistatistical feature combination


set positions evaluate 
 
  fl  wg classifies positions loss win player move 
assuming optimal play sides  draws handled manner
outlined section   
x          x  
  ir features 
evaluation position    
x    x          x      conditional winning probability
n

n

v         p  y

  w j  x          x     x     p  w j x  
n

n classified example positions               
available
n

x    x          x              


n







following subsections models express p  w j x  function linear quadratic feature combinations brie introduced way sucient practical
purposes  good introductions theoretical details given instance duda
  hart         hand         agresti         mccullagh   nelder         fisher s
classical method logistic regression used model p  w j x  first time 
quadratic discriminant function used lee   mahajan         however  without
considering fisher s discriminant first 

    discriminant functions normally distributed features
bayes  rule gives

j w  p  w  
  p x j pw x  p  w     p x j w p p x w
    p x j l p  l 
  

      pp  xxj jwl  pp   lw    
p x j c   features  conditional density function p  c   priori probability
class c   fl  wg  case priori probablities equal  features
multivariate normally distributed within class  i e 
p  w j x  

p x j c            j j     exp
n 

c

 

n

      x       x     
c

c

c

mean vector covariance matrix c   fw   lg  follows
 
p  w j x   
 
    exp  f  x  
f following quadratic discriminant function 
c

f  x 



c

n



       x  w     l   x    l  l     w  w  x   


                log jw j   log jl j  
w
w
l
l
w
l
 

   

fiburo

   

                                                           
                    
            
          
        
 
 
 
 
  
       
     
    
     
    
    
 
 
   
    
     
    
   
    
 
 
   
    
                        
                               
      
     
      
 
    
         
    
    
                 
    
   
 
 
 
 
 
      
   
  
    
 
 
 
 
 
 
    
 
 
 
        
    
 
 
     
    
 
 
 
 
 
 
 
 
 
     
         
                
 
 
 
 
 
 
 
     
 
      
                 
    
     
 
 
 
 
 
 
 
 
 
 
 
       
       
                
    
 
 
 
 
      
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
        
    
               
                                                                                                                                           
                                                                                                                                                                        

   
   

l

x

w

figure    conditional densities winning probability
covariance matrices equal      expression simplified linear function 
f  x     w   l     fx    l   w    g  
interestingly  function solution problem finding linear transformation
maximizes ratio squared sample mean distance sum within class
sample variances transformation  therefore  good separator properties even
features normally distributed  called fisher s linear discriminant  figure  
illustrates relation conditional densities winning probability 
maximum likelihood  ml  parameter estimates
  xx
   
c

ji j
c

    ji  j

 c



x

c

c





 c



 x        x      


c



c



  j   c g  covariance matrices equal 
x x
    ji j    ji j
 x        x       
w
l  fl wg   c
c





c

 



c



c



    logistic regression

logistic regression conditional winning probability p  w j x  depends linear
combination x   here  x    assumed order able model constant offsets 
simple approach p  w j x    xfi using parameter column vector unusable
xfi         cannot guaranteed generally  requirement fulfilled means
link function g           ir according g  p  w j x     xfi   figure   shows typical
nonlinear relation winning probability one feature  since probability
usually monotone increasing function features  g satisfy lim     g  x      
lim     g  x        link function g  t    logit t     log t      t  
properties  using g   logit  since g    x    f    exp  x g     follows
 
p  w j x   
    exp  xfi    


x

x

   

fistatistical feature combination

hence  winning probability shape discriminant analysis  logistic
regression require features multivariate normal  even use
discrete features possible 
parameter vector estimated using ml approach  unfortunately 
case necessary solve system nonlinear equations  follows  known
solving approach brie described  cf  agresti        mccullagh   nelder        
order ensure convergence iterative algorithm given below  necessary
slightly
variable
p generalize model  observed value random
  
 

 



 


 
f
 
 
 
g

mean

 
f
 
 
exp 
 
x

 
g
  
stochastically independent  definition includes old model  n       f    g  
likelihood function l fi   probability density  measures likely
see realization stochastically independent random variables   true
parameter vector  order maximize l  suces consider log l  


n



j

i j

i j











log l fi     log


n

  
xx


 

n

j

  



      ni  yi


n

  

yx


ij




 

j



x
n

  

x
n

 
h

  





log    n     log      



log     exp

n







x
n

j

  



x
ij

j






 

function twice differentiable  strictly concave rare border cases 
unique maximum location       n  cf  wedderburn       
iteratively found using newton raphson method follows 
     
fi 
   x     x     x      z    
















 n n  matrix x built x  



      diag n                              exp  















n







n



j

     
  n      
 
 
z   log
 
 
          n                 

  

x fi    


ij

o  

j







x











   
p  w j x     

   















                                     
                                       
             
          
         
       
 
 
 
 
 
 
    
     
     
     
    
    
 
 
 
 
  
    
   
    
    
   
 
 
 
   
    
    
    
    
    
 
 
 
 
    
     
      
     
       
         
 
 
 
 
 
 
 
 
    
                   
                                                                  

x

figure    typical shape winning probability
   

 



fiburo

starting          y        n      ml estimate fi  may usually computed high
accuracy within steps since method quadratically convergent relatively robust
respect choice starting vector  unfortunately     
  n estimates might converge  original model approximated 
instance  setting n               depending whether position
question lost won 
















   generation classification example positions
value adaptation requires labelled example positions  here  problems arise  first
all  nontrivial games endgame positions classified correctly won 
drawn  lost  opening midgame positions optimal play reach due
lack game knowledge time constraints  furthermore  example positions
contain significant feature variance since otherwise discrimination possible  hence 
problematic use high level games   might first idea   since good
players programs know relevant features try maximize game 
therefore  features tend constant time statistical methods would
assign small weights them  final diculty  estimating parameters accurately
different game phases requires many positions 
pragmatic  solution  problems indicated figure    period
two years         othello games  played early versions logistello
  urd anovic s program rev   feature variance ensured examining openings
igor
length seven led mostly unbalanced starting positions  since early program
versions used      minutes thinking time  games  though well
played time  error free  cases even big mistakes occurred
which  example  one side fell corner losing trap  caused lack look ahead 
without errors  reasonable weight estimation principal features  such corner
possession othello  possible explained above  following lee   mahajan        
positions classified final game results  approach problematic
classification reliability decreases endgame opening phase due player
mistakes  reduce effect  early outcome searches performed solving othello
positions    moves game end  furthermore  time time game database
searched  obvious  errors using new program versions longer searches correct
games  since process many lines play repeated  misclassification
rate reduced propagating game results leaves root
game tree  built games according negamax principle 
way classification position depends examined successors
therefore reliable 
proposed classification method relatively fast allows us label many positions
reasonable time  on average    new positions       minutes   addition
   game file obtained via anonymous ftp 
 ftp uni paderborn de unix othello misc database zip 
   brief description programs given help pages internet othello server 
 telnet faust uni paderborn de      
   implications compared losing material nothing chess 

   

fistatistical feature combination

                                                    
                     
            
            
       
      
        
   
      
  
   
   
  
   
      
    
    
       
 
 
 
 
 
          
          
 
                
 
 
 
 
 
 
 
 
 
 
 
 
                                                     

             
          

       
      
      
      
       
       
      
       
          
         
                   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                         

database consisting
ca         games

l
w
l
w

w x
w
x l xd x
w
x xw x

          
                 
    
     
      
    
      
    
          
                   
              
 
  
 
  
 
  
       
            
            
      
           
   
   
 
 
 
    
  
   
   
    
    
 
   
         
        
 
       
            

       
           
 
  
                

                                                        
                    
            
          
        
        
     
     
   
    
  
  
  
  
    
    
       
     
      
 
 
 
 
 
 
            
   
                                                                                  

             
          

         
        
 
       
         
  
                
   
   
 
 
   
   
   
   
   
    
    

game tree

       
 
      
      
      
      
       
     
         
        
               
          
                                            

    million
classified positions

figure    classification process
ensuring accurate parameter estimation even different game phases  which indicated
small parameter confidence intervals   method enabled us develop new pattern
features othello based estimating winning probability conditioned upon occurrence
sub configurations  edge diagonal instances  board  

   parameter estimation playing strength comparison

although    example positions labelled drawn  decided
use parameter estimation since positions give exact information
feature balancing  natural way handle drawn positions within statistical evaluation
framework considered define winning probability     case 
extension logistic regression parameters easily determined setting   n   
case draw  alternatively  doubling lost positions incorporating drawn
positions lost leads estimate log likelihood
functions equal constant factor  latter technique used fitting
models 
previous experiments showed parameters depend game phase 
disc count adequate measure othello  example positions grouped according number discs board  adjacent groups used parameter
estimation order smooth data ensure almost equal numbers lost
positions 
success othello program bill described lee   mahajan        shows
othello table based features quite effective  instance  important edge
structure quickly evaluated adding four pre computed edge evaluations
stored table     features used logistello table based  fall
two groups  first group pattern instances including horizontal  vertical 
diagonal lines board evaluated second group two mobility measures
computed  
parameter estimation three described models  tournaments players quad  which uses quadratic discriminant function normally distributed features  




   details given buro         postscript file thesis obtained via anonymous ftp 

   

fiburo

pairing
log   quad
fisher   quad
log   fisher
log   fisher
log   quad
fisher   quad
log   quad

time per game
result
winning
 minutes 
 win draw loss  percentage
       
       
       
       
       
       
       

             
             
            
            
            
            
            

     
     
     
     
     
     
     

table    tournament results
fisher  log played order determine best tournament player  starting
    nearly even opening positions    discs  i e  move     logistello s opening book  game return game colours reversed played  

opening midgame phase program versions performed usual iterative deepening negascout searches  reinefeld        selective corner quiescence search extension 
endgame positions    empty squares solved win draw loss searches 
pattern learning tournaments  facility think opponent s time turned order speed tournaments run parallel
seven sun sparc    workstations 
applying conservative statistical test  seen results listed table  
stating winning percentage greater     statistically significant    level 
first two results show clear advantage linear combinations normal tournament
conditions     minutes per player per game   furthermore  since log outperforms fisher
features would seem even approximately normally distributed  lies
advantage logistic regression  even discrete features castling status chess
parity othello used 
tournaments played time weaker players fisher
quad order determine time factors lead equal playing strength 
shown table   fisher reaches log s strength given     time 
quad needs     time compete log  logistello s optimized
implementation  search speed using quadratic combination still    
slower linear combination  thus  giving quad     time        
             balances total number nodes searched game  even
timing  log stronger quad  fisher still compete it  all 
quadratic combination slower linear combination 
better discrimination properties  indeed  look estimated covariance matrices
   log s    ply evaluation positions lies range              corresponds winning
probabilities range             nearly even starting positions used compare
programs similar playing strength since clear positions colour determines winner
winning percentage would     even one player stronger      starting positions six
always led game pairs balanced score 

   

fistatistical feature combination

class revealed almost equal  therefore better evaluation quality
fisher s linear discriminant could expected 

   discussion

paper three statistical approaches modelling evaluation functions game 
phase independent meaning presented compared empirically using world 
class othello program  quadratic feature combinations necessarily lead stronger
programs linear combinations since evaluation speed drop significantly 
course  effect depends number features used evaluation speed 
features used takes long time evaluate them  playing strength
differences cannot explained different speeds case evaluation times
almost equal  case  using quadratic combinations covariance matrices
compared   almost  equal  quadratic terms omitted
fisher s linear discriminant used  therefore  motivations lee   mahajan       
need refinement  since existing feature correlation necessarily justify use
nonlinear combinations  generally  possibly accurate nonlinear feature combinations
 such anns  compared simpler faster approaches practice  since
use always guarantee greater playing strength 
besides linear regression discriminant analysis  logistic regression proven
suitable tool construction evaluation functions global interpretation 
drawback  parameter estimation system nonlinear equations solved 
compensated higher quality evaluation function comparison
approaches  since application parameters determined
once  current tournament version logistello uses feature weights estimated
means logistic regression profits comparability evaluations different
game phases ensured use value adaptation  result possible
perform selective searches values different game phases compared 
moreover  values opening compared even late midgame values order
find promising move alternatives program s opening book  buro            
sense  value comparability cornerstone logistello s strength 

acknowledgements
wish thank wife karen competently answering many statistical questions 
  urd anovic many fruitful discussions led
thank colleague igor
considerable improvements othello programs  furthermore  grateful colin
springer  richard e  korf  anonymous referees useful suggestions earlier
versions paper  helped improve presentation contents 

references

agresti  a          categorical data analysis  wiley 
buro  m          techniken fur die bewertung von spielsituationen anhand von beispielen 
ph d  thesis  university paderborn  germany 
 ftp uni paderborn de unix othello ps files mics dis ps gz 

   

fiburo

buro  m          l apprentissage des ouvertures chez logistello  magazine de la federation
francaise d othello fforum           
duda  r   hart  p          pattern classification scene analysis  wiley 
hand  d j          discrimination classification  wiley 
lee  k f   mahajan  s          pattern classification approach evaluation function
learning  artificial intelligence          
lee  k f   mahajan  s          development world class othello program  artificial
intelligence           
marsland  t a          evaluation function factors  icca journal      
mccullagh  p   nelder  j a          generalized linear models  chapman   hall 
van den meulen  m          weight assesment evaluation functions  in  d f  beal
 editor   advances computer chess    elsevier science publishers 
mitchell  d h          using features evaluate positions experts  novices  othello
games  master thesis  northwestern university  evanston illinois u s a 
moriarty  d   miikkulainen  r          evolving complex othello strategies using marker 
based genetic encoding neural networks  tech  rep  ai        department
computer sciences  university texas austin 
mysliwietz  p          konstruktion und optimierung von bewertungsfunktionen beim
schach  ph d  thesis  university paderborn  germany 
reinefeld  a          improvement scout tree search algorithm  icca journal
           
samuel  a l          studies machine learning using game checkers  ibm
journal research development            
samuel  a l          studies machine learning using game checkers ii 
ibm journal research development             
schaeffer  j   culberson  j   treloar  n   knight  b   lu  p   szafron  d          world
championship caliber checkers program  artificial intelligence             
sutton  r s          learning predict methods temporal differences  machine
learning         
tesauro  g          practical issues temporal difference learning  machine learning   
        
tesauro  g          td gammon  self teaching backgammon program  achieves
master level play  neural computation            
tesauro  g          temporal difference learning td gammon  communications
acm              
wedderburn  r w m          existence uniqueness maximum likelihood
estimates certain generalized linear models  biometrika           
   


