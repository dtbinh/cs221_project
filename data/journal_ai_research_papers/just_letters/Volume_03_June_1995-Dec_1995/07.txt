journal of artificial intelligence research                 

submitted       published      

statistical feature combination for the
evaluation of game positions
michael buro

nec research institute
  independence way
princeton nj       u s a 

mic research nj nec com

abstract

this article describes an application of three well known statistical methods in the field of
game tree search  using a large number of classified othello positions  feature weights for
evaluation functions with a game phase independent meaning are estimated by means of
logistic regression  fisher s linear discriminant  and the quadratic discriminant function for
normally distributed features  thereafter  the playing strengths are compared by means
of tournaments between the resulting versions of a world class othello program  in this
application  logistic regression   which is used here for the first time in the context of game
playing   leads to better results than the other approaches 

   introduction

programs playing games like chess  draughts  or othello use evaluation functions to estimate
the players  winning chances in positions at the leaves of game trees  these values are
propagated to the root according to the negamax principle in order to choose a move in
the root position which leads to the highest score  normally  evaluation functions combine
features that measure properties of the position correlated with the winning chance  such as
material in chess or mobility in othello  most popular are quickly computable linear feature
combinations  in the early days of game programming  the feature weights were chosen
intuitively and improved in a manual hill climbing process until the programmer s patience
gave out  this technique is laborious  samuel             was the first to describe a method
for automatic improvement of evaluation function parameters  since then many approaches
have been investigated  two main strategies can be distinguished 

move adaptation  evaluation function parameters are tuned to maximize the frequency
with which searches yield moves that occur in the lists of moves belonging to training
positions  the idea is to get the program to mimic experts  moves 

value adaptation  given a set of labelled example positions  parameters are determined

such that the evaluation function fits a specific model  for instance  evaluation functions
can be constructed in this way to predict the final game result 

in move adaptation  proposed for instance by marsland         v d  meulen         and
mysliwietz         a linear feature combination has two degrees of freedom  it can be multiplied by a positive constant and any constant can be added to it without changing the move
decision  if the evaluation function depends on the game phase  and positions from different
phases are compared  for example within the framework of selective extensions or opening
book play   these constants must be chosen suitably  because evaluation functions optimized
c      ai access foundation and morgan kaufmann publishers  all rights reserved 

fiburo

by move adaptation for the moment have no global interpretation  a solution of this problem
is not obvious  schaeffer et al         presented an ad hoc and game specific approach 
in this respect  value adaptation is more promising  here  evaluations from different
phases are comparable if the example position labels have a phase independent meaning 
mitchell        labelled othello positions occurring in a game with the final game result
in the form of the disc differential and tried to approximate these values using a linear
combination of features  since a regression was used to determine the weights  it was also
possible to investigate the features  statistical relevance  another statistical approach for
value adaptation was used by lee   mahajan         example positions were classified as a
win or loss for the side to move and   assuming the features to be multivariate normal   a
quadratic discriminant function was used to predict the winning probability  this technique
ensures the desired comparability and applies also to games without win degrees  i e  that
only know wins  draws  and losses 
besides these classical approaches which heavily rely on given feature sets  in recent
years artificial neural networks  anns  have been trained for evaluating game positions  for
instance  moriarty   miikkulainen        used genetic algorithms to evolve both the topology
and weights of anns in order to learn othello concepts by means of tournaments against
fixed programs  after discovering the concept of mobility  their best   ply ann player was
able to win     of the games against a   ply brute force program that used an evaluation
function without mobility features  the most important contribution in this field is by
tesauro                   using temporal difference learning  sutton        for updating
the weights  his anns learned to evaluate backgammon positions at master level by means
of self play  tesauro conjectured the stochastic nature of backgammon to be responsible for
the success of this approach  though several researchers obtained encouraging preliminary
results applying tesauro s learning procedure to deterministic games  this work has not yet
led to strong tournament programs for tactical games such as awari  draughts  othello  or
chess  that allow deep searches and for which powerful and quickly computable evaluation
functions are known  it might be that due to tactics for these games more knowledgeable
but slower evaluation functions are not necessarily more accurate than relatively simple and
faster evaluation functions in conjunction with deeper searches 
in what follows  three well known statistical models   namely the quadratic discrimination function for normally distributed features  fisher s linear discriminant  and logistic
regression   are described for the evaluation of game positions in the context of value
adaptation  thereafter  it is shown how example positions for parameter estimation were
generated  finally  the playing strengths of three versions of a world class othello program 
  logistello   equipped with the resulting evaluation functions are compared in order
to determine the strongest tournament player  it turns out that quadratic feature combinations do not necessarily lead to stronger programs than linear combinations  and that logistic
regression gives the best results in this application 

   statistical feature combination

the formal basis of statistical feature combination for position evaluation can be stated as
follows 
   since its appearance in october      it won twelve of the    international tournaments it played 

   

fistatistical feature combination

 
 is the set of positions to evaluate 
 y   
   fl  wg classifies positions as a loss or win for the player to move 
assuming optimal play by both sides  draws can be handled in the manner
outlined in section   
 x          x   
   ir are the features 
 the evaluation of a position     
 with x    x          x      is the conditional winning probability
n

n

v         p  y

  w j  x          x     x     p  w j x  
n

 there are n classified example positions                
 available with
n

x    x          x       and y   y      
i

n

i

i

i

in the following subsections models which express p  w j x  as a function of linear or quadratic feature combinations are briey introduced in a way that is sucient for practical
purposes  good introductions and further theoretical details are given for instance by duda
  hart         hand         agresti         and mccullagh   nelder         both fisher s
classical method and logistic regression are used here to model p  w j x  for the first time  the
quadratic discriminant function has been used by lee   mahajan         however  without
considering fisher s discriminant first 

    discriminant functions for normally distributed features
bayes  rule gives

j w  p  w  
  p x j pw x  p  w     p x j w p p x w
    p x j l p  l 
  

      pp  xxj jwl  pp   lw    
where p x j c   is the features  conditional density function and p  c   is the a priori probability
of class c   fl  wg  in the case that the a priori probablities are equal  and the features are
multivariate normally distributed within each class  i e 
p  w j x  

p x j c            j j     exp
n 

c

 

n

      x        x      
c

c

c

with mean vector  and covariance matrix  for c   fw   lg  it follows
 
p  w j x   
 
    exp  f  x  
where f is the following quadratic discriminant function 
c

f  x 

o

c

n 



       x  w     l   x    l  l     w  w  x   

o
                  log jw j   log jl j  
w
w
l
l
w
l
 

   

fiburo

   

                                                           
                    
            
          
        
 
 
 
 
  
       
     
    
     
    
    
 
 
   
    
     
    
   
    
 
 
   
    
                        
                               
      
     
      
 
    
         
    
    
                 
    
   
 
 
 
 
 
      
   
  
    
 
 
 
 
 
 
    
 
 
 
        
    
 
 
     
    
 
 
 
 
 
 
 
 
 
     
         
                
 
 
 
 
 
 
 
     
 
      
                 
    
     
 
 
 
 
 
 
 
 
 
 
 
       
       
                
    
 
 
 
 
      
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
        
    
               
                                                                                                                                           
                                                                                                                                                                        

   
   

l

x

w

figure    conditional densities and winning probability
if the covariance matrices are equal      the expression can be simplified to a linear function 
f  x     w   l     fx    l   w    g  
interestingly  this function is also a solution to the problem of finding a linear transformation
which maximizes the ratio of the squared sample mean distance to the sum of the within class
sample variances after transformation  therefore  it has good separator properties even if the
features are not normally distributed  this is called fisher s linear discriminant  figure  
illustrates the relation between the conditional densities and the winning probability 
the maximum likelihood  ml  parameter estimates are
  xx
   
c

ji j
c

    ji  j

 c

i

x

c

c

i

i

 c

i

 x        x      
i

c

i

c

i

with i   fi j y   c g  if the covariance matrices are equal 
x x
    ji j    ji j
 x        x       
w
l  fl wg   c
c

i

i

c

 

i

c

i

c

i

    logistic regression

in logistic regression the conditional winning probability p  w j x  depends on a linear
combination of the x   here  x     is assumed in order to be able to model constant offsets 
the simple approach p  w j x    xfi using a parameter column vector fi is unusable because
xfi         cannot be guaranteed generally  this requirement can be fulfilled by means of
a link function g           ir according to g  p  w j x     xfi   figure   shows a typical
nonlinear relation between the winning probability and one feature  since the probability is
usually a monotone increasing function of the features  g should satisfy lim     g  x      
and lim     g  x        the link function g  t    logit t     log t      t   has these
properties  using g   logit  since g    x    f    exp  x g     it follows that
 
p  w j x   
    exp  xfi    
i

x

x

   

fistatistical feature combination

hence  the winning probability has the same shape as for discriminant analysis  but logistic
regression does not require the features to be multivariate normal  even the use of very
discrete features is possible 
again the parameter vector fi can be estimated using the ml approach  unfortunately 
in this case it is necessary to solve a system of nonlinear equations  in what follows  a known
solving approach will be briey described  cf  agresti        mccullagh   nelder        
in order to ensure convergence of the iterative algorithm given below  it is necessary
to slightly
variable
p i generalize our model  from now on y is the observed value of random
   and are
y  
y
 
where
the
y
 


 
f
 
 
 
g
have
mean

 
f
 
 
exp 
 
x
fi
 
g
  
stochastically independent  this definition includes the old model  n     and y   f    g  
the likelihood function l fi   which is a probability density  measures how likely it is to
see the realization y of the stochastically independent random variables y   if fi is the true
parameter vector  in order to maximize l  it suces to consider log l  
i

n

i

j

i j

i j

i

i

i

i

i

log l fi     log

y
n

  
xx
i

 

n

j

  



i i      i  ni  yi
y

n

  

yx
i

ij


fi

 

j

i

x
n

  

x
n

 
h

  

y

i

log     n   y   log       

i

log     exp

n

i

i

i

x
n

j

  

i

x fi
ij

j

i

i

i
 

this function is twice differentiable  is strictly concave up to rare border cases  and has
a unique maximum location if     y   n for all i  cf  wedderburn        that can be
iteratively found using the newton raphson method as follows 
     
fi 
   x     x     x      z    
i

i

t

t

t

t

with



the  n  n  matrix x built from the x  



      diag n                              exp  



i

t

t

i

i

t

n

t

i



n

i

j

       
y   n      
 
 
z   log
 
 
          n                 

  

x fi    
t

ij

o  

j

t

t

t

x

i

i

i

t

i

   
p  w j x     

   

i

i

t

i

t

i

i

                                     
                                       
             
          
         
       
 
 
 
 
 
 
    
     
     
     
    
    
 
 
 
 
  
    
   
    
    
   
 
 
 
   
    
    
    
    
    
 
 
 
 
    
     
      
     
       
         
 
 
 
 
 
 
 
 
    
                   
                                                                  

x

figure    typical shape of the winning probability
   

 

and

fiburo

starting with          y        n      the ml estimate fi  may usually be computed with high
accuracy within a few steps since the method is quadratically convergent and relatively robust
with respect to the choice of the starting vector  unfortunately  if there is an i with y    
or y   n the estimates might not converge  but our original model can be approximated 
for instance  by setting n       and y     or     depending on whether the position in
question is lost or won 
i

i

i

i

i

i

i

i

   generation and classification of example positions
value adaptation requires labelled example positions  here  some problems arise  first of
all  for most nontrivial games only endgame positions can be classified correctly as won 
drawn  or lost  for opening and midgame positions optimal play is out of reach due to the
lack of game knowledge and time constraints  furthermore  the example positions should
contain significant feature variance since otherwise no discrimination is possible  hence  it
is problematic to use only high level games   which might be the first idea   since good
players and programs know the relevant features and try to maximize them during a game 
therefore  these features tend to be constant most of the time and statistical methods would
assign only small weights to them  as a final diculty  estimating parameters accurately for
different game phases requires many positions 
a pragmatic  solution  to these problems is indicated in figure    over a period of
two years  about        othello games  were played by early versions of logistello and
  urd anovic s program rev   feature variance was ensured by examining all openings
igor d
of length seven which led mostly to unbalanced starting positions  since early program
versions were used which had only      minutes thinking time  the games  though well
played most of the time  are not error free  in some cases even big mistakes occurred in
which  for example  one side fell into a corner losing trap  caused by a lack of look ahead 
but without these errors  no reasonable weight estimation of principal features  such as corner
possession in othello  is possible as explained above  following lee   mahajan         all
positions were then classified by the final game results  this approach is problematic because
the classification reliability decreases from the endgame to the opening phase due to player
mistakes  to reduce this effect  early outcome searches were performed for solving othello
positions    moves before game end  furthermore  from time to time the game database
was searched for  obvious  errors using new program versions and longer searches to correct
these games  since in this process many lines of play were repeated  the misclassification
rate was further reduced by propagating the game results from the leaves to the root of the
game tree  which had been built from all games according to the negamax principle  in
this way the classification of a position depends on that of all examined successors and is
therefore more reliable 
the proposed classification method is relatively fast and allows us to label many positions
in a reasonable time  on average about    new positions in       minutes   in addition to
   the game file can be obtained via anonymous ftp 
 ftp uni paderborn de unix othello misc database zip 
   a brief description of both programs is given in the help pages of the internet othello server 
 telnet faust uni paderborn de      
   in its implications this can be compared with losing material for nothing in chess 

   

fistatistical feature combination

                                                    
                     
            
            
       
      
        
   
      
  
   
   
  
   
      
    
    
       
 
 
 
 
 
          
          
 
                
 
 
 
 
 
 
 
 
 
 
 
 
                                                     

             
          

       
      
      
      
       
       
      
       
          
         
                   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                         

database consisting
of ca         games

l
w
l
w

w x
w
x l xd x
w d
x d xw x

          
                 
    
     
      
    
      
    
          
                   
              
 
  
 
  
 
  
       
            
            
      
           
   
   
 
 
 
    
  
   
   
    
    
 
   
         
        
 
       
            

       
           
 
  
                

                                                        
                    
            
          
        
        
     
     
   
    
  
  
  
  
    
    
       
     
      
 
 
 
 
 
 
            
   
                                                                                  

             
          

         
        
 
       
         
  
                
   
   
 
 
   
   
   
   
   
    
    

game tree

       
 
      
      
      
      
       
     
         
        
               
          
                                            

about     million
classified positions

figure    the classification process
ensuring an accurate parameter estimation even for different game phases  which is indicated
by small parameter confidence intervals   this method enabled us to develop new pattern
features for othello based on estimating the winning probability conditioned upon occurrence
of sub configurations  like edge or diagonal instances  of the board  

   parameter estimation and playing strength comparison

although only about    of the example positions were labelled as drawn  it was decided
to use them for parameter estimation since these positions give exact information about
feature balancing  a natural way to handle drawn positions within the statistical evaluation
framework considered here is to define the winning probability to be     in this case  for
this extension the logistic regression parameters can easily determined by setting y   n   
in case of a draw  alternatively  doubling won or lost positions and incorporating drawn
positions once as won and once as lost leads to the same estimate because both log likelihood
functions are equal up to a constant factor  the latter technique was used for fitting the
other models 
previous experiments showed that the parameters depend on the game phase  for which
disc count is an adequate measure in othello  so the example positions were grouped according to the number of discs on the board  and adjacent groups were used for parameter
estimation in order to smooth the data and to ensure almost equal numbers of won and lost
positions 
the success of the othello program bill described by lee   mahajan        shows
that in othello table based features can be quite effective  for instance  the important edge
structure can be quickly evaluated by adding four pre computed edge evaluations which are
stored in a table  all    features used by logistello are table based  they fall into
two groups  in the first group pattern instances including the horizontal  vertical  and most
diagonal lines of the board are evaluated while in the second group two mobility measures
are computed  
after parameter estimation for the three described models  tournaments between the players quad  which uses the quadratic discriminant function for normally distributed features  
i

i

   details are given by buro         the postscript file of this thesis can be obtained via anonymous ftp 

   

fiburo

pairing
log   quad
fisher   quad
log   fisher
log   fisher
log   quad
fisher   quad
log   quad

time per game
result
winning
 minutes 
 win draw loss  percentage
       
       
       
       
       
       
       

             
             
            
            
            
            
            

     
     
     
     
     
     
     

table    tournament results
fisher  and log were played in order to determine the best tournament player  starting
with     nearly even opening positions with    discs  i e  before move     from logistello s opening book  each game and its return game with colours reversed was played   in

the opening and midgame phase all program versions performed their usual iterative deepening negascout searches  reinefeld        with a selective corner quiescence search extension 
endgame positions with about    empty squares were solved by win draw loss searches 
there was no pattern learning during the tournaments  and the facility to think on opponent s time was turned off in order to speed up the tournaments which were run in parallel on
seven sun sparc    workstations 
applying a conservative statistical test  it can be seen that all results listed in table  
stating a winning percentage greater than     are statistically significant at the    level  the
first two results show a clear advantage for the linear combinations under normal tournament
conditions     minutes per player per game   furthermore  since log outperforms fisher
the features would not seem to be even approximately normally distributed  here lies the
advantage of logistic regression  even very discrete features like castling status in chess or
parity in othello can be used 
further tournaments were played with more time for the weaker players fisher and
quad in order to determine the time factors which lead to an equal playing strength  as
shown in table   fisher reaches log s strength if it is given about     more time  and
quad needs about     more time to compete with log  with logistello s optimized
implementation  the search speed when using the quadratic combination is still about    
slower than that with the linear combination  thus  giving quad     more time        
             balances the total number of nodes searched during a game  but even with
this timing  log is stronger than quad  and fisher can still compete with it  all in all 
the quadratic combination is not only slower than the linear combination  but it also has no
better discrimination properties  indeed  a look at the estimated covariance matrices of each
   log s    ply evaluation of these positions lies in the range              which corresponds to winning
probabilities in the range             only nearly even starting positions should be used to compare
programs of similar playing strength since in clear positions the colour determines the winner and the
winning percentage would be     even if one player is stronger  of the     starting positions only six
always led to game pairs with a balanced score 

   

fistatistical feature combination

class revealed that they are almost equal  and therefore a better evaluation quality than that
of fisher s linear discriminant could not be expected 

   discussion

in this paper three statistical approaches for modelling evaluation functions with a game 
phase independent meaning have been presented and compared empirically using a world 
class othello program  quadratic feature combinations do not necessarily lead to stronger
programs than linear combinations since the evaluation speed can drop significantly  of
course  this effect depends on the number of features used and their evaluation speed  if only
a few features are used or if it takes a long time to evaluate them  then the playing strength
differences cannot be explained by different speeds because in this case the evaluation times
are almost equal  in any case  before using quadratic combinations the covariance matrices
should be compared  if they are  almost  equal  the quadratic terms can be omitted and
fisher s linear discriminant can be used  therefore  the motivations of lee   mahajan       
need refinement  since an existing feature correlation does not necessarily justify the use of
nonlinear combinations  generally  possibly more accurate nonlinear feature combinations
 such as anns  should be compared to simpler but faster approaches in practice  since their
use does not always guarantee a greater playing strength 
besides linear regression and discriminant analysis  logistic regression has proven to be
a suitable tool for the construction of evaluation functions with a global interpretation  the
drawback  that for parameter estimation a system of nonlinear equations has to be solved 
is more than compensated for by the higher quality of the evaluation function in comparison
to the other approaches  since in this application the parameters have to be determined only
once  the current tournament version of logistello uses feature weights estimated by
means of logistic regression and profits from the comparability of evaluations from different
game phases which is ensured by the use of value adaptation  as a result it is possible
to perform selective searches in which values from different game phases are compared 
moreover  values from the opening can be compared even with late midgame values in order
to find promising move alternatives in the program s opening book  buro             in this
sense  value comparability is a cornerstone of logistello s strength 

acknowledgements
i wish to thank my wife karen for competently answering many of my statistical questions 
  urd anovic for many fruitful discussions which have led to
i also thank my colleague igor d
considerable improvements of our othello programs  furthermore  i am grateful to colin
springer  richard e  korf  and the anonymous referees for their useful suggestions on earlier
versions of this paper  which helped improve both the presentation and the contents 

references

agresti  a          categorical data analysis  wiley 
buro  m          techniken fur die bewertung von spielsituationen anhand von beispielen 
ph d  thesis  university of paderborn  germany 
 ftp uni paderborn de unix othello ps files mics dis ps gz 

   

fiburo

buro  m          l apprentissage des ouvertures chez logistello  magazine de la federation
francaise d othello fforum           
duda  r   hart  p          pattern classification and scene analysis  wiley 
hand  d j          discrimination and classification  wiley 
lee  k f   mahajan  s          a pattern classification approach to evaluation function
learning  artificial intelligence          
lee  k f   mahajan  s          the development of a world class othello program  artificial
intelligence           
marsland  t a          evaluation function factors  icca journal      
mccullagh  p   nelder  j a          generalized linear models  chapman   hall 
van den meulen  m          weight assesment in evaluation functions  in  d f  beal
 editor   advances in computer chess    elsevier science publishers 
mitchell  d h          using features to evaluate positions in experts  and novices  othello
games  master thesis  northwestern university  evanston illinois u s a 
moriarty  d   miikkulainen  r          evolving complex othello strategies using marker 
based genetic encoding of neural networks  tech  rep  ai        department of
computer sciences  university of texas at austin 
mysliwietz  p          konstruktion und optimierung von bewertungsfunktionen beim
schach  ph d  thesis  university of paderborn  germany 
reinefeld  a          an improvement of the scout tree search algorithm  icca journal
           
samuel  a l          some studies in machine learning using the game of checkers  ibm
journal of research and development            
samuel  a l          some studies in machine learning using the game of checkers ii 
ibm journal of research and development             
schaeffer  j   culberson  j   treloar  n   knight  b   lu  p   szafron  d          a world
championship caliber checkers program  artificial intelligence             
sutton  r s          learning to predict by the methods of temporal differences  machine
learning         
tesauro  g          practical issues in temporal difference learning  machine learning   
        
tesauro  g          td gammon  a self teaching backgammon program  achieves
master level play  neural computation            
tesauro  g          temporal difference learning and td gammon  communications of
the acm              
wedderburn  r w m          on the existence and uniqueness of maximum likelihood
estimates for certain generalized linear models  biometrika           
   

fi