journal of artificial intelligence research                 

submitted       published      

learning membership functions in a
function based object recognition system
kevin woods

woods bigpine csee usf edu

computer science   engineering
university of south florida
tampa  fl           

diane cook

cook centauri uta edu

computer science   engineering
university of texas at arlington
arlington  tx      

lawrence hall
kevin bowyer

hall waterfall csee usf edu
kwb bigpine csee usf edu

computer science   engineering
university of south florida
tampa  fl           

louise stark

stark napa eng uop edu

electrical and computer engineering
university of the pacific
stockton  ca      

abstract

functionality based recognition systems recognize objects at the category level by reasoning about how well the objects support the expected function  such systems naturally
associate a  measure of goodness  or  membership value  with a recognized object  this
measure of goodness is the result of combining individual measures  or membership values 
from potentially many primitive evaluations of different properties of the object s shape  a
membership function is used to compute the membership value when evaluating a primitive
of a particular physical property of an object  in previous versions of a recognition system known as gruff  the membership function for each of the primitive evaluations was
hand crafted by the system designer  in this paper  we provide a learning component for
the gruff system  called omlet  that automatically learns membership functions given a
set of example objects labeled with their desired category measure  the learning algorithm
is generally applicable to any problem in which low level membership values are combined
through an and or tree structure to give a final overall membership value 

   introduction
in any computer vision  cv  application involving the recognition or the detection of  objects   descriptions of the types of objects to be recognized are required  object descriptions
can be explicitly supplied by a human  expert   alternatively  machine learning techniques
can be used to derive descriptions from example objects 
there are some advantages to learning object descriptions from examples rather than
from direct specification by an expert  specifically  it may be dicult for a person to

c      ai access foundation and morgan kaufmann publishers  all rights reserved 

fiwoods  cook  hall  bowyer    stark

provide a cv system with an accurate description of an object that is general enough to
cover the possible variations in the visual appearance of different instances of the object  for
example  no two tumors in medical images will look exactly the same  similarly  it would
be cumbersome for a human to provide a cv system with the ranges of possible values
for all the different physical aspects of chairs  i e   what are the possible surface areas
of the seating surface of a chair  how is the seating surface supported    considerable
 tweaking  of the object description parameters may be required by a human expert in
order to achieve satisfactory system performance  machine learning techniques can be
used to generate concepts that are consistent with observed examples  some examples of
such learning systems include c     quinlan         and aq  michalski         system
performance is affected by the ratio of the number of training examples to the number of
features used to describe the examples  and the accuracy with which the examples represent
the  real world  objects the cv system may encounter 
a function based object recognition system is an example of a cv system for which
machine learning techniques can be useful in the development of object descriptions  a
function based object recognition system recognizes an object by classifying it into one
or more generic object categories which describe the function that the object might serve
 bogoni   bajcsy        brand        di manzo  trucco  giunchiglia    ricci        kise 
hattori  kitahashi    fukunaga        rivlin  rosenfeld    perlis        stark   bowyer 
            sutton  stark    bowyer        vaina   jaulent         each object category
is defined in terms of the functionality required of an object that belongs to the category 
for example  an object category might be defined as 
straight back chair     provides sittable surface   provides stability  
provides back support
indicating that an object can be classified as a straight back chair to the degree that it
satisfies the conjunction of the three functional properties 
the functional properties are themselves defined in terms of primitive evaluations of
different aspects of an object s shape  for example  candidate surfaces may be checked
for provides sittable surface by evaluating whether they have appropriate width  depth and
height above the support plane  in many cases  there is not a unique ideal value for some
given aspect of an object s shape  but instead there is a range of values that can be considered
equivalent in terms of  goodness   for example  anything between      to      meters
might be an equally acceptable height for a seating surface  however  as a particular shape
measurement becomes too small or too large  the evaluation measure should be reduced 
fuzzy set theory provides a mathematical framework for handling this  goodness of fit 
concept  in our case  a fuzzy membership function transforms a physical measurement  i e  
height of an object s surface above the ground  into a membership value in the interval       
this membership value  or evaluation measure  denotes the degree to which the object  or
portion of the object  fits the primitive physical concept  i e   how well the height of the
surface matches the seating surface height of typical chairs   thus  a separate measure
of goodness is produced for each primitive evaluation  these measures are combined to
produce a final aggregate measure of goodness for the object 
the gruff system  stark   bowyer        is a function based object recognition system
which utilizes fuzzy logic  in the manner just described  to evaluate   d shapes  in previous
   

filearning membership functions in object recognition

versions of gruff  the fuzzy membership functions embedded in the system have been
collectively hand crafted and refined to produce the best results over a large set of example
shapes  these membership functions are ideal candidates to be learned from examples using
a machine learning approach 
in this paper  we present a method of automatically learning the collection of fuzzy
membership functions from a set of labeled example shapes  due to the system constraints
imposed by gruff  general purpose machine learning algorithms  such as neural networks 
genetic algorithms  or decision trees  are not readily applicable  thus  a new special purpose
learning component  called omlet  has been developed  omlet is tested with synthetic
data for two different object categories  chairs and cups   and with data collected from
human evaluations of physical chairs  results are presented to show that  a  learning the
membership functions in this way provides a level of recognition performance equivalent to
that obtained from the  hand tweaked  gruff  and  b  the learning method is compatible
with human interpretation of the shapes  the approach should be generally applicable
to any system in which a set of primitive evaluation measures is combined to produce an
overall measure of goodness for the final result 
this paper is organized as follows  section   discusses some related work  and justifies our need to develop a special purpose learning component  section   introduces the
gruff object recognition system  section   presents the new learning component  called
omlet  at this point  we should state that the material in section   has previously been
published  and is presented here to facilitate an understanding of the new learning component  although omlet has been specifically  tailored  as an add on learning component
for the gruff system  it applies to a data structure that can be used in other systems 
in general  omlet can be described as a system for learning in the context of a fuzzy
and or categorization tree  we point the reader with any questions concerning gruff s
object recognition paradigm to the references provided  section   describes our experimental design and the data sets that are utilized  section   documents the experimental results
and gives our analysis of them  finally  in section   a summary of the paper is given and
conclusions are drawn 

   related work
there are two ways that learning might be used to ease the construction of systems such as
gruff  the first is that the rules  or proof tree  that make up gruff could be built by an
inductive learning system  c     a decision tree learner  quinlan         is a good example
of this class of learning systems  however  these types of inductive classification systems
cannot adequately replace the functionality of the gruff omlet system  omlet allows
examples which have less than perfect membership in a class to be used for training  there
is no direct way to accomplish this in a system such as c     a decision tree based system
would probably require different trees to be trained for parent and child categories  the
functional concepts  provides sittable surface  for example  would get lost in the training
process if the individual features for a chair were directly used  we could train a series
of trees to learn functional concepts individually  then train a decision tree to combine the
results  in such an approach the parameters of the membership functions that are learned in
this paper would be learned implicitly in the construction of a decision tree for a functional
   

fiwoods  cook  hall  bowyer    stark

concept and any resulting rules  replacing gruff omlet with a decision tree or other
general purpose rule learner is possible  but would require extensive work to preserve the
idea of functional object recognition 
omlet is aimed at the second area in which a gruff like system could benefit from
learning  which is in tuning the membership functions  a knowledge primitive might be a
sittable surface  given measurements for a specific surface of an object in a specific orientation  it is necessary to develop a representation of acceptable bounds on the measurements
to determine whether the surface has the area to be sittable 
techniques from other areas of machine learning have been used to represent and learn
probabilistic and fuzzy membership functions  for example  belief networks provide a mechanism for representing probabilistic relationships between features of a domain  individual
feature probabilities can be combined to generate the probability of a complex concept by
propagating belief values and constraints through the network  adaptive probabilistic networks are a kind of belief nets that can learn the individual probability values and distributions using gradient descent  pearl        cooper   herskovits        spiegelhalter  dawid 
lauritzen    cowell         the structure of belief nets and their update algorithms are
similar to the approaches found in omlet  however  omlet incorporates symbolic theorem proving  a feature that is fundamental to performing function based object recognition 
as well as value propagation 
similar research has been performed to learn fuzzy membership functions using adaptive techniques such as genetic algorithms and classifier systems  parido   bonelli       
valenzuela rendon         much of this work can only be used to learn individual membership functions and cannot handle combinations of input  once again  little work has
been directed at learning fuzzy memberships in the context of a rule based system  additional refinement techniques such as reinforcement learning  mahadevan   connell       
watkins         neural networks  and statistical learning techniques can also be used to
refine confidence values 
this project represents a new direction in computer vision and machine learning research  namely  the integration of machine learning and computer vision methods to learn
fuzzy membership functions for a function based object recognition system  although learning such functions in a rule based context is a novel effort  similar research has been performed in the area of refining certainty factors for intelligent rule bases  for example 
mahoney and mooney        and lacher et al         use backpropagation algorithms to
adjust certainty factors of existing rules in order to improve classification of a given set of
training examples  in contrast to omlet s approach  all of these systems refine values that
represent a measure of belief in a given result and are adjusted according to the combination
functions of certainty factors  omlet s measures represent degrees of fuzzy membership in
an object class  and the refinement method propagates error through an and or tree 
the work by wilkins and ma        focuses on revising probabilistic rules in a classification expert system  probabilistic weights are applied to each rule  indicating the strength
of the evidence supplied by the rule  however  refinements to the rule occur in the form
of modifying the applicability of the rule by generalizing  specializing  deleting or adding
rules  instead of automatically refining the weight of the rule  the authors avoid automatic
refinement of weights because the resulting rule base may not be interpretable by experts 
   

filearning membership functions in object recognition

towell and shavlik        convert a set of rules into a representation suitable for a
neural net  then train the network and re extract the refined rules  the initial network
can be set up for a chain of rules  the extracted rules will not necessarily have the clear
functional meaning that our approach aims at preserving 
there are several new approaches to learning and tuning fuzzy rules  ishibuchi  nozaki 
  yamamoto        berenji   khedkar        jang        jang   sun        that use
genetic algorithms or specialized kinds of neural networks  some making use of reinforcement
learning  these approaches might provide an alternative way to learn the membership values
provided the initial functional rules are given as fuzzy rules  however  some modifications
to the learning approaches would be needed as they normally work in domains without rule
chaining or hierarchies of rules as there are in gruff omlet 

   the gruff object recognition system
the gruff acronym stands for generic representation using form and function  stark
  bowyer         the gruff recognition system takes a   d shape description as input 
reasons about whether the shape could belong to any of the object categories known to
gruff  and outputs an interpretation for each category to which the object could belong 
an  interpretation  is a specified orientation and a labeling of the parts of the shape which
are identified as satisfying the functional properties  see figure   for an example of an
interpretation 
gruff input

gruff output

provides
sittable
surface

provides
stable
support

figure    gruff interpretation of a   d shape for the category conventional chair  elements of the shape are labeled with the functional property they provide 

   

fiwoods  cook  hall  bowyer    stark

    the knowledge primitives

all of gruff s reasoning about shape is performed using  low level  procedural knowledge
which is implemented as a set of knowledge primitives   each knowledge primitive represents
some primitive physical property concerning shape  physics  or causation  each knowledge
primitive takes some  specified portions of a    d shape description as its input  along with
values of the parameters for the primitive  and returns an evaluation measure between   and
   the evaluation measure represents how well the shape element satisfies the particular
invocation of the primitive 
the knowledge primitives used by gruff to recognize chairs are  stark   bowyer       
      sutton et al         
   relative orientation  normal one  normal two  range parameters 
this primitive determines if the angle between the normals for two surfaces  normal one and normal two  falls within a desired range 
   dimensions   shape element  dimension type  range parameters  
this primitive can be used to determine if the dimension  e g  width or depth  of a
surface lies within a specified range 
   proximity   proximity type  shape element one  shape element two  
this primitive can be used to check qualitative relations between shape elements  such
as above   below and close to  
   clearance   object description  clearance volume  
this primitive can be used to check for a specified volume of unobstructed free space
in a location relative to a particular part of the shape 
   stability   shape  orientation  applied force  
this primitive can be used to check that a given shape is stable when placed on a at
supporting plane in a given orientation and with a  possibly zero  force applied 
each of the first two knowledge primitives include four range parameters  z    stands
for  st zero point   n    st normal point   n    nd normal point   and z     nd zero point  
these parameters are used to define a trapezoidal fuzzy membership function  as in figure   
for calculating an evaluation measure for the invocation of the primitive  the last three of
the knowledge primitives do not have range parameters  they return an evaluation measure
of   or   depending on whether or not the primitive physical property has been satisfied 
trapezoidal membership functions reect a desire to name  categorize  objects in a
manner compatible with human naming  there is typically a non trivial range for the
 ideal  value of many physical properties related to functionality  for example  while there
is a unique value for the mean sittable surface area of a population of chairs  that value
is not the only one that would rate a perfect       for sittability  reasonable deviations
result in no decrease in the sittability  when the sittable surface area falls outside the ideal
range  i e   between z   and n   or between n  and z   in figure     the evaluation measure
is reduced  indicating the surface provides a less than perfect  but still functional  sittable
   

filearning membership functions in object recognition

   
evaluation
measure

   

z    least

z    greatest
n    low ideal n    high ideal

physical measurement for a particular property i

figure    fuzzy membership function returns an evaluation measure of a primitive physical
property 

area  finally  when the area falls outside the range of values  less than z    or greater than
z   in figure     the surface can no longer function as the sittable portion of a chair  and a
evaluation measure of   is returned 

    the category definition tree

gruff s knowledge about different object categories is implemented as a category definition

tree   the leaves of which represent invocations of the knowledge primitives  the category
definition tree for the chair category is illustrated in figure   
a node in a category definition tree may have two subtrees  one subtree gives the
definition of the category in terms of a list of functional properties  in our chair example  an
object must satisfy the functional properties of stability and provides sittable surface in order
to be considered a member of the category conventional chair  each functional property
may be defined in terms of multiple primitives  the evaluation measures of individual
primitives are combined  in a manner to be discussed shortly  to determine how well the
functional properties have been satisfied  these functional property measures are further
combined to arrive at an overall evaluation measure for a category node 
the other subtree defines a subcategory  a subcategory is a specialization of its parent
 or superordinate  category  and thus provides a more detailed elaboration of the definition
of its parent  a subcategory node has a subtree of functional properties that are required
in addition to those of the parent category  for example  in figure    the subcategory
straightback chair is a specialization of a conventional chair with the additional functional
requirement provides back support  the overall evaluation measure for a subcategory node
is a combination of its parent category evaluation measure and the evaluation measure
associated with the additional functional properties  in figure    the overall measure for
the subcategory straightback chair is a combination of the measures from the conventional
   

fiwoods  cook  hall  bowyer    stark

name  chair
node
 sub category
type 
funtional subcategory
definition
trees

name  conventional
chair
node
type  sub category

name 

node
type  sub category

funtional subcategory
definition
trees

name  provides
sittable surface
node
functional
type 
property

provides
name 
stable support
node
functional
type 
property

name 
node
type 

funtional subcategory
definition
trees
name  provides
stable support
node
functional
type 
property

name  straightback
chair
node
type  sub category
funtional subcategory
definition
trees

provides
back support
functional
property

lounge
chair

provides
name 
lounging sittable surface
node
type 

recliner

node
type   sub category
funtional
definition

subcategory
trees

functional
property
name  provides
lounging back support
node
functional
type 
property

name  armchair

name 

name  provides
lounging arm support
node
type 

functional
property

node
type  sub category
funtional subcategory
definition
trees

name  provides
arm support
node
type 

functional
property

figure    category definition tree for the basic level category chair 
chair node and the provides back support subtree  note that subcategory measurements do
not contribute to the cumulative measure for a parent category  there may be multiple levels
of subcategories  as with conventional chair  straightback chair  and armchair in figure   
category nodes which have no associated functional properties  such as the root node
chair in figure    do not have associated evaluation measures  these nodes are used to
set up the control structure of the function based definition  however  they do provide the
category definition since an object that is a member of a subcategory is automatically a
member of all its predecessor categories  for example  in figure    an object that belongs
to the subcategory straightback chair also belongs to the categories conventional chair and
chair  a superordinate category furniture could be added above the chair category  stark
  bowyer        
   

filearning membership functions in object recognition

    combination of evidence

the evaluation measures returned by the primitive invocations at a functional property
node are combined using the t norm 

t  a  b    a  b
where a and b are the measures being combined  this t norm is commonly referred to as
the probabilistic and  pand  function  bonissone   decker         the immediate parent
category node directly receives an associated measure by combining the measures of the
functional property nodes using the same t norm 
for example  the functional property provides sittable surface is defined by six primitives  for simplicity  we ll denote the evaluation measures returned by these six primitives
as p  through p   the functional property stability is defined by a single primitive  which
also returns an evaluation measure  p    to determine the overall evaluation measure of a
shape for the category conventional chair we compute
conventional chair     provides sittable surface pand stability

where
provides sittable surface     p  pand p  pand p  pand p  pand p  pand p 

and
stability    p 

since the definition of a  sub category is a conjunction of required functional properties  the cumulative measure should be dominated by the  weakest link  in the individual
primitive evaluation measures  a property of the pand function  so  an evaluation measure
of   for any one primitive physical property will result in a cumulative evaluation measure
of    an evaluation measure of   indicates that the primitive physical property has been
ideally satisfied  and the shape may belong to the object category  the final result depends
on the evaluation of other primitive physical properties 
it would seem that each category could simply be defined by the knowledge primitives without using the notion of functional properties  the functional property level was
introduced into the representation hierarchy for two reasons  first  the subgroupings of
functional properties intuitively follow the levels of named categorization typical of human
concepts of function  secondly  most functional property evaluations result in the labeling
of the functional elements of the object  i e   the portions of the structure  that fulfill the
functional requirement 
since the subcategory definition represents an increasingly specialized definition  evidence for belonging to the subcategory should result in an increased measure for the object
belonging to the subcategory as opposed to just the parent category  the combination
of the functional property measurement of a subcategory node  a  with its parent node s
evaluation measure  b  is computed using the t conorm 

s  a  b    a   b   a  b
   

fiwoods  cook  hall  bowyer    stark

this t conorm is commonly referred to as the probabilistic or  por  function  bonissone
  decker         while the t conorm is used to combine measures at a subcategory node 
the final subcategory evaluation measure is actually computed as 

 

a   t 
esubcategory    s  a  b   ifotherwise
 
where t is a user defined threshold  thus  the functional property measurement of a
subcategory node  a  must be greater than some minimum in order for a shape to receive a
non zero evaluation measure for the subcategory  for the purposes of this work  a value of
t     is assumed  indicating that a shape can be assigned to a subcategory as long as there
is some non zero evidence that it meets the additional functional requirements associated
with the subcategory  in practice  a final classification decision might require much stronger
evidence  say t        before a shape is assigned to a subcategory 
for example  to determine the overall evaluation measure of a shape for the category
straightback chair  we first compute the overall evaluation measure for the category conventional chair  as previously described  the functional property provides back support is defined by   primitives  denoting the measurements returned by the   primitives as p  through
p    the overall evaluation measure  assuming the measure for provides back support   t  
for the category straightback chair is computed as 
straightback chair     conventional chair por provides back support
where
provides back support     p  pand p  pand p   pand p   pand p  
pand p   pand p   pand p  

an object that can function as a straightback chair can also by definition function as a
conventional chair  the t conorm will give the object a higher evaluation measure for the
subcategory straightback chair since there is some evidence in addition to the  minimal 
amount of evidence required for the shape to belong to the parent category conventional
chair  thus  gruff performs recognition of a shape by selecting the  sub category with the
highest overall evaluation measure  this should correspond to the most specific applicable
subcategory  one exception occurs when the parent category has an evaluation measure
of   and there is non zero evidence supporting the subcategory functional requirements 
in this case  the t conorm assigns an evaluation measure of   to both the category and
subcategory 
the particular t norm t conorm pair utilized in this paper was chosen from among
representative t norm t conorm possibilities  including non probabilistic formulations  described by bonissone and decker        after analyzing their performance in conjunction
with gruff across a set of example shapes  stark  hall    bowyer      a  

   the omlet learning system

in this section  we describe the omlet learning  sub system  omlet learns fuzzy membership functions  which are located at the leaves of an and or categorization tree  from sets
   

filearning membership functions in object recognition

of training examples  omlet works together with gruff to automatically learn object
category definitions and use those definitions to recognize new objects 
in the training mode  omlet uses examples to learn the fuzzy ranges for primitive
measurements  each training example consists of an object description coupled with a
desired overall evaluation measure  in the testing mode  omlet uses the previously learned
ranges to act as a function based object recognition system  knowledge primitives form the
building blocks of the omlet system  and rules make up the representation language  the
rules  which are fixed  are derived from gruff s category definition tree  they indicate
   how the knowledge primitives are combined to define functional properties  and    how
the functional properties are combined to give the function based definition of an object
category 
given a training example  omlet uses the rules to construct a general proof tree for
the example s given object category  the proof tree is simply a data structure that mimics
the way gruff combines primitive evaluation measures  the proof tree also maintains
the primitive ranges that are modified by the learning algorithm  an example proof tree
generated from the rules that define an object in the conventional chair category is shown in
figure    the proof trees contain only those knowledge primitives which are defined using
range parameters  this is because the other knowledge primitives return only     measures 
and so there is no primitive membership function to learn  the training example must satisfy
these  binary   or necessary  functional properties and return evaluation measures of   in
order for the example to be a member of the given category  for example  in figure    the
left branch of the top pand node represents the functional property provides stable support 
this functional property is defined by a single knowledge primitive which has no range
parameters  therefore  this input to the pand node is fixed to always return a   
for omlet to obtain an overall evaluation measure for an example object  the physical
measurements of the shape elements of the object are input to the primitive fuzzy membership functions in the leaves of the proof tree  the output at a leaf node represents
the evaluation measure for the individual functional property  the evaluation measures
are combined at the internal nodes of the tree using the probabilistic t norm t conorm
combiners described in section      the overall evaluation measure of the input example is
then output at the root node  see figure    
input to omlet consists of a set of goals for specific examples from object  sub categories 
the goal includes the example s  sub category  the elements of the   d shape that fulfill
the functional properties  and an overall desired evaluation measure which is greater than  
 otherwise the object is not an example of the object category   figure   shows an example
of a goal for a conventional chair object 
using the training examples  omlet attempts to learn the ranges used in the trapezoidal
membership functions associated with the knowledge primitive definitions  see figure    
when a training example is presented  omlet attempts to prove via the rule base that the
object is a member of the specified category  here  the check is to make sure the physical
elements of the object listed in the goal satisfy the binary  or necessary  functional properties 
so  for a conventional chair training example  omlet checks that the given orientation is
stable  and the given seating surface is accessible  clearance in front and above  and meets a
minimum width to depth ratio  if the necessary functional properties have all been satisfied 
a proof tree is constructed  the actual overall evaluation measure is then calculated in the
   

fiwoods  cook  hall  bowyer    stark

rules for conventional chair

conventional chair
evaluation measure
       
pand

 conventional chair  a  b  c     
 provides sittable surface  a  b  c  pand
 provides stable support  a 
 provides sittable surface  a  b  c     
 dimensions area range parameters  b  pand
 width depth      b  pand
 dimensions contigous surface range parameters  b  pand
 dimensions height range parameters  b  pand
 clearance above  a  b  pand
 clearance in front  a  c 
 provides stable support  a     
 stability self  a 

   
     

binary functional property
 provides stable support 
is fixed to always return a  

 b
 c

pand

 a

     

   

height       

     
contiguous
surface      

area        

knowledge primitives with ranges that are used
to compute the evaluation measures of the functional
property  provides sittable surface  

figure    the simplified proof tree constructed for a learning example from the category
conventional chair  the  a   b  and  c symbols in the rules represent the physical
aspects of a shape that are used by the rules  an orientation of the shape  the face
of the sittable surface  and the front edge of the sittable surface are substituted
for  a   b  and  c  respectively  this way omlet knows which elements of a
shape are to be  measured  and evaluated by the knowledge primitives 
   

filearning membership functions in object recognition

  conventional chair mchair    orientation  mchair    face  mchair    edge     

object category

object orientation

sittable surface

front edge of
sittable surface

      

desired
evaluation
measure

functional properties

figure    training goal input to omlet for a conventional chair object 
manner described above  if the actual evaluation measure is suciently different from
the desired evaluation measure  then the primitive fuzzy membership functions that were
included in the definition need to be adjusted 
primitive membership functions are adjusted by propagating the overall error for each
training sample down through the nodes of the proof tree in a way that attempts to give
each leaf node  i e   range  some portion of the error  the range parameters  z    n   n  
and z    that define the fuzzy membership trapezoids are then adjusted in an attempt to
reduce the total error of the examples in the training set  the next few subsections provide
details of the omlet learning algorithm  first  we discuss the method for calculating an
error value and propagating it down through the proof tree  next  we present a method for
making initial estimates of the parameters for each membership function  we describe error
propagation first because it is utilized in the initialization phase  we then describe how
omlet makes adjustments to the membership functions in an attempt to reduce the error
over the entire training set  the last subsection describes the general learning paradigm
and provides some theoretical justification for our implementation 

    error propagation

the error for a training example is defined as the difference between the desired evaluation
measure and the actual evaluation measure computed by the current state of the omlet
system  a fraction of the error  defined by a  learning rate   is propagated down the proof
tree through the pand and por nodes  error propagation through pand and por nodes
is handled differently  if the error at a three element pand node is e   then each of the three
elements will receive a portion of the error equal to the cube root of e  i e   the inverse of
the pand function   for a por node  the full amount of error  rather than an equal share 
is propagated down each link  the rationale for this treatment of error should become clear
in section     
it should be noted that while the desired evaluation measure is fed to the root of the tree
and propagated down to the leaves  the error is directly computable since the actual and the
projected desired values are always known at each node  the actual values at each node are
those computed when the physical measurements of the object shape are fed into the leaf
   

fiwoods  cook  hall  bowyer    stark

desired      
pand
actual       

desired       

desired       

pand

pand

actual       

actual       

actual      

actual      

desired       

desired       

actual      

actual      

actual      

desired        desired        desired       

figure    example of error propagation through a pand tree  actual values are found
when an overall evaluation measure is computed for an object  desired values are
propagated down the tree  and error is computed as desired   actual 
nodes and combined to produce an overall evaluation measure at the root  the projected
desired values in the proof tree are obtained by propagating the desired evaluation measure
from the root node down to the leaves  for example  given a two input pand node with
actual inputs a  and a   the actual output a will be a   a   from the t norm in section
      if the desired output of the node is d  then we can compute the desired inputs to the
node as d  and d  by solving the following set of equations 

a   a    d   d    a   d
and

a    d    a    d 

   

   
the first equation computes the error for the pand node   while the second equation assures
equal portions of the error are assigned to each input  figure   shows an example of the
desired values computed via equations   and   for every node in a proof tree  in this figure 
we have a known desired overall measure of d       at the top pand node  and an actual
measure of a        which was computed as the pand of the actual node inputs  a         
and a           using equations   and    we can easily compute the two unknown desired
inputs d  and d  to the top pand node  which are also the desired outputs of the bottom
   the equivalent and simpler equation d   d    d could be substituted here 
   

filearning membership functions in object recognition

two pand nodes  as       and        respectively  if there are three inputs to a pand node 
then we solve a set of three linear equations to derive the desired inputs  when there are
more than three inputs to a pand node  we divide the set of inputs recursively into groups
of two or three and solve a set of two or three linear equations  respectively 
since the por nodes are used to combine a single parent category measure with a single
aggregate measure for a subcategory s functional properties  there will never be more than
  inputs to this type of node  therefore  the full amount of error can be propagated through
a por node by simply solving the independent equations 
a    d    a   d    d
   
and
a    d    a   d    d
   
eventually  some portion of the overall error is propagated to the ranges defined by
the trapezoid membership functions  when the error reaches the individual ranges for a
training example  the input to the primitive membership function  i e   the x axis value 
and the desired primitive evaluation measure  the y axis value  define a point that should
lie somewhere on the trapezoid  we also note which leg of the trapezoid the point belongs
to  based on which side of the normal portion of the range  n  n   that the x value lies 
the set of desired points for each leg can be used to make adjustments to the trapezoid
in an attempt to reduce the error  omlet collects these desired points for each leg of
each membership function by propagating the error for all training examples down the
proof trees  the trapezoid range parameters  z   n  n  z    are adjusted at the end of each
training epoch  training continues for a fixed number of epochs or until some satisfactory
level of performance  defined by minimal classification error rate averaged over the training
set  is achieved 

    initial estimate of measurement functions

omlet s learning algorithm begins by making reasonable initial estimates of all fuzzy trape 

zoid membership functions for the physical measurements  this is accomplished by assigning actual values of   for the membership functions for each training example and propagating the errors  which in this case would be equal to the desired evaluation measures 
down to the ranges in the leaf nodes of the proof trees  from the collections of desired
points  we make an initial estimate of each trapezoidal membership function  it is only
important at this stage to place the edges of the constructed normal range  the n  and n 
range parameters  somewhere within the actual normal range  the learning algorithm will
make adjustments to the n  and n  points on subsequent training epochs  additionally 
omlet may set minimum or maximum limits on the values of some of the range parameters
 more on this shortly  
a training example with a desired evaluation measure of   is considered a  perfect 
example of an object from a given category  perfect training examples are desirable in
the training set because all primitive measurements for perfect examples are known to fall
in the range  n  n    for example  if a conventional chair training example has a desired
evaluation measure of    then we know that all of the membership functions in its proof
tree  see figure    must return values of    this is because the result of the pand function
can be no greater than the minimum input 
   

fiwoods  cook  hall  bowyer    stark

omlet now examines the set of desired points that have been propagated to each range
in the definition tree and determines  limit  points  these are defined as follows  if any
two desired points have y values  memberships  of    then at least a segment of the normal
range  n  n   is known  the n  range parameter is set to the minimum x value of all desired
points with y values of    similarly  the n  parameter is set to the maximum x value of all
desired points with y values of    note that if only one such desired point is found then
n  and n  are set to the same value  and the membership function is initially triangular 
since some portion of the normal range is known to be correct  an upper limit is set on
the n  value and a lower limit is set on the n  value to assure that the known segment
of the normal range is not reduced during subsequent training  since training examples
have desired membership values greater than    we know that all x input values must lie
between z   and z    omlet uses the minimum and maximum x values from the set of
desired points to set limits on the z   and z   range parameters  the z   range parameter is
never permitted to increase above the minimum x value during training  similarly  the z  
value may never decrease below the maximum x value in the set of desired points  figure  
shows the range parameters  limit points  omlet sets during the initialization phase given
a set of    examples 
p 

p 

p 

   
p 
p 

p 

p 
p 
   

p 
maximum
z  value
allowed

maximum
n  value
allowed

minimum
n  value
allowed

p  
minimum
z  value
allowed

figure    range parameter limits that may be set when initializing range parameters 
the limits on the range parameters serve several purposes  first  the limits assure that
perfect training examples will not be assigned evaluation measures less than    and that
all training examples will have evaluation measures greater than    more importantly  by
limiting the changes that can be made to some range parameters  better approximations
to the desired membership functions can be learned  in subsequent learning  the error is
propagated down the proof tree with the assumption that equal amounts of the error come
from each input to a node  this assumption is not always valid  and there is no way to
directly determine the portion of the error that belongs to each input  if an error propagated
to a membership function would cause a change in one or more of the range parameters
 z   n  n  z    that moves the parameter past its set limit  the portion of the overall error
assumed to be caused by the membership function has not been correctly estimated  when
   

filearning membership functions in object recognition

this occurs the parameter is set equal to its limit  effectively reducing the degree to which
changes in the membership function would compensate for the overall error  this should
allow the learning algorithm to find a good solution in the case where different membership
functions contribute different amounts of error 
if a segment of the normal range is known for some membership function  then initialization of the range parameters is straight forward  the n  and n  values will have already
been set  the z   value is set simply by making the left leg of the trapezoid pass through
the point  n       and the point from the set of desired points with the minimum x value 
similarly  the z   value is set by making the right leg of the trapezoid pass through the point
 n       and the desired point with the maximum x value  if there are no points to the
left  right  of the n   n   point  then the membership function is assumed to be one legged
 as for contiguous surface in figure    and the parameters n  and z    n  and z   
are extended to a very large negative  positive  value and not permitted to change during
training 
if no portion of the normal range of a membership function can be determined  then we
attempt to fit a trapezoid to the set of desired points  first  the two desired points with the
maximum y values are found  we assume that the normal range lies somewhere between
them  a best fit trapezoid is determined by varying the n  and n  range parameters over
the assumed normal range  and selecting the normal range  n  n   that produces the lowest
error for the set of desired points  the error is the sum of the absolute values of the
difference between the desired y value and the actual y value found for each point  the z  
 z    range parameter is set in the same manner as before  where the left  right  trapezoid
leg is forced to pass through the desired point with the minimum  maximum  x value  the
n  value is varied from the leftmost point of the assumed normal range to the rightmost
point in small increments  for each different value of n   the n  value is varied from n  to
the rightmost point of the assumed normal range in small increments  so  we are simply
testing a range of possible trapezoids  with the degree of accuracy  and number of trapezoids
tested  defined by the increments in which n  and n  are varied  that have a normal range
 n  n   somewhere within the assumed normal range  from these we select the set of range
parameters that minimize the total error over the set of training examples  the use of a
best fit trapezoid approach is helpful  because we have no initial way to accurately associate
error with any given trapezoid 

    adjusting membership functions

to make adjustments to a membership trapezoid  each leg of the trapezoid is fit to a set
of desired points using a least squares line fit  recall that after every training epoch we
have a set of desired points for each leg of each trapezoid  the new z    z    value of the
trapezoid is set to the point at which the left  right  leg intersects    the new n   n  
value is set to midway between the old n   n   value and the value where the left  right 
leg of the fitted line intersects y      the new n  and n  values are not directly set to
where the fitted trapezoid legs intersect   because overestimating the normal range  n  n  
can eliminate some desired points that should be used in the least squares line fit for a
trapezoid leg  desired points in the normal  n  n   range by definition do not fall on a
leg of the trapezoid  and are not used when adjusting the trapezoid legs  therefore  if the
normal range is overestimated  points that truly belong on a trapezoid leg will not be used
   

fiwoods  cook  hall  bowyer    stark

to adjust the leg  by gradually moving the normal points n  and n   omlet is better able
to converge on an appropriate solution  after the new range parameter values  z   n  n  z   
have been determined  omlet checks to make sure that none of them lie outside any limits
that may have been set in the initialization phase  restrictions on new range parameters
assure that the membership functions remain trapezoidal  or triangular if n    n    first 
z   must be less than or equal to n   similarly z   must be greater than or equal to n   if
z    z    is greater  less  than n   n   then z    z    is set equal to n   n    also  n  must be
less than or equal to n   in the case that there is only a single point in the set of desired
points for a trapezoid leg  the leg is defined by the normal point for that leg  n  for the left
leg and n  for the right leg  and the single desired point 
the training data may provide target points for only a portion of a trapezoid for some
of the ranges  omlet is capable of detecting this situation by observing the slope of the
fitted line  and adjusting the membership function appropriately  the slope of the left
trapezoid leg should be positive and the slope of the right leg should be negative  if the
slope of the fitted trapezoid leg is nearly horizontal  close to       or the sign of the slope
is opposite what is expected  then the normal point on that leg is moved  again  n  for
the left leg and n  for the right leg  outward  this adjustment allows omlet to learn
one legged membership functions  and to handle  as well as possible  situations when not
enough training data is available 
a method of escaping local minima was empirically found useful  normally omlet
does not allow a trapezoid leg to change if the change causes an increase in total error for
the training set  so  it is possible for zero  one or both trapezoid legs for each range to
get adjusted on an epoch  if learning slows down suciently  then omlet will temporarily
allow trapezoid leg changes that cause an increase in overall error in hopes of escaping a
possible local minima  more precisely  if the total training set error for one epoch decreases
by less than a specified threshold  then range changes that cause an increase in overall error
are permitted for the next training epoch 

    the training approach

in order to learn all the various subcategories defined in a category definition tree  we
utilize a machine learning approach which is based on an assumption about human learning
known as one disjunct per lesson  lehn         perhaps it is easiest to understand the
mechanics of our learning approach if we explain the one disjunct per lesson assumption
in the terminology of cognitive science  since many of the terms in machine learning are
derived from the cognitive sciences  it will not be dicult to show the similarities between
our algorithm and this characterization of human learning  we will also examine some of
the computational characteristics of our learning algorithm that support our choice of this
approach 
      one disjunct per lesson

van lehn        tells us that an effective way of teaching more complicated concepts is to
build them up from simple subconcepts  as opposed to an  all at once  approach  for our
purposes  a disjunct can be considered one of these simple subconcepts  a lesson consists
of an uninterrupted sequence of demonstrations  examples  and exercises  the length of
a lesson varies  thus  we might expect a human to better understand the concept of an
   

filearning membership functions in object recognition

armchair by presenting a series of lessons  each of which introduces a single new subconcept
that builds upon the previous subconcepts  for example  a first lesson teaches the concept of
a conventional chair which requires only a stable sittable surface in the correct orientation 
to learn what constitutes a straightback chair  we build upon the concept of conventional
chair by introducing the subconcept of back support in a second lesson  so  the second
lesson broadens our notion of chairs  in general  finally  a third lesson builds upon our
understanding of a straightback chair by introducing the subconcept of arm support  by
contrast  the all at once approach may try to explain that an armchair provides a stable
sittable surface in the correct orientation with some back and arm support  here  we
are trying to teach three subconcepts at one time  and show how the three subconcepts
together form the more complex concept of an armchair  indeed  van lehn        cites
some laboratory studies which indicate that the learning task is more dicult when more
than one disjunct  subconcept  is taught per lesson 
we have chosen to utilize a machine learning algorithm which has underpinnings similar
to van lehn s one disjunct per lesson assumption  in our case  concepts and subconcepts
are represented by categories and subcategories  a lesson for our algorithm consists of
numerous epochs of the training examples from one  sub category  thus  our lesson can
be viewed as an uninterrupted sequence of positive examples that  teach  the functional
requirements for a single  sub category  the length  or number of training epochs  of our
lessons may vary depending on the subcategory being learned  to learn all the ranges in
a category definition tree  we begin by learning the simplest concepts first  then we learn
additional more complex subconcepts by building upon the notion of the more simple concept  for example in the simplified proof tree in figure    the parent category conventional
chair will be learned before attempting to learn the subcategory  specialization  straightback
chair  since the subcategory straightback chair is itself a parent category  it will be learned
before attempting to learn the even more complex subcategory armchair  the remainder
of this subsection discusses our implementation in finer detail 
from an implementation standpoint  the simplest concepts are the functional properties
associated with the categories that are directly linked to the root node in our category
definition tree such as provides sittable surface and provides stable support for the category
conventional chair  in our first lesson  we use positive examples from these  first level   or
parent  categories to learn only those membership functions associated with these categories 
once the first level categories have been learned  their membership functions are  frozen 
and not permitted to change during subsequent lessons 
in our second lesson  only the membership functions of the  second level  categories
 i e   the subcategories of the first level categories in the definition tree  are learned  in
figure    these membership functions belong to the node provides back support for the subcategory straightback chair  if we have learned the  simple  functional concept associated
with the parent category  the values computed for a parent category node are assumed to be
reasonably accurate  for example  when the actual values in a proof tree are computed for a
straightback chair training example  the actual values emanating from the parent category
node conventional chair should be accurate since the concepts associated with this node
have already been learned  that is  the evaluation measures for the functional properties
provides sittable surface and provides stable support of a straightback chair example are assumed to be correct  this implies that the membership functions making up the functional
   

fiwoods  cook  hall  bowyer    stark

arm chair
por
example of a subcategory
to be learned after the
parent category

provides arm support
pand

straight back chair
por

   
example of a
 parent category 

conventional chair
pand

provides back support
pand

   

   

figure    simplified proof tree for an armchair object 

requirement subtree  i e   provides back support  are responsible for the entire error for a
subcategory training example   this explains why equations   and   are used to propagate
error through por nodes   hence  the error is propagated to the modifiable leaves under a
functional requirement node through a pand subtree and learning continues as before 
the lessons continue with each parent category being learned before any of its subcategories are learned  until all subcategories have been learned  by freezing the parent category
membership functions after they have been learned  we are applying to the one subconceptper lesson strategy  so in figure   after learning straightback chair  the membership functions for that branch are frozen and the armchair subcategory is learned by modifying the
membership functions under the provides arm support branch of the proof tree 
omlet begins learning by evaluating the rule base in order to determine subcategory
dependencies and assigns each  sub category in the definition tree a level in the learning
hierarchy  for example  omlet determines that the category conventional chair has no parent category and its membership functions can be learned immediately  level     however 
the evaluation measure of the subcategory straightback chair is dependent on the parent
category conventional chair  the straightback chair subcategory is assigned to learning
level    subcategory armchair is dependent on parent category straightback chair  and is
therefore assigned to learning level   
   

filearning membership functions in object recognition

      practical justification

in order to understand why we have taken a one disjunct per lesson approach rather than
an all at once approach  let s make some observations concerning how accurately blame
assignment for an error can be determined for a typical training example 
recall that error propagation through a proof tree involves projecting desired node input
values from a known node output value  consider a pand node with a known desired output
of      and two unknown inputs  we know that both of the inputs must be at least     
this means both inputs to the pand node fall within the relatively small range           
however  when the desired output of a two input por node is      we can only be sure
that both inputs fall in the range          if the known output to the pand or por node
is very low  say      then there is an opposite effect  that is  the unknown inputs for a
por node would lie in the relatively small range            and the unknown inputs for the
pand node would fall somewhere in the much larger range            these observations
suggest that the blame assignment for error can be propagated through a pand node with
reasonable accuracy on examples that are relatively good  say     or above  however  for
high evaluation measures  an error value cannot be reliably propagated through a por
node 
since a subcategory evaluation measure is computed as the por of a parent category
evaluation measure and the combination of additional functional requirements  all por
nodes in a proof tree have two inputs  all por nodes  in our proof trees  have at least  
connecting node which consists of a parent  or more general  category whose membership
calculation involves only pand connectives  the structure of the proof trees permits the
membership functions which contribute to the evaluation measure of a parent category to be
accurately learned prior to learning those defined in the additional functional requirements
of the subcategories  that is  we can determine one of the inputs to any por node before we
attempt to propagate an error through that node  with one input and the desired output
of a por node known  calculation of the unknown input is trivial  thus  our learning
approach eliminates the reliability problems associated with propagating blame assignment
for error through por nodes  this will be verified in section   with experimental results
for the subcategories straightback chair and armchair 
the mechanics of our learning algorithm suggests that omlet s performance depends on
how accurately blame assignment can be propagated through the pand nodes of a proof tree 
earlier  we observed that blame assignment is less reliably propagated through pand nodes
for  bad  training examples  not surprisingly  this suggests that the quality of the training
data will have an effect on system performance  this does not mean that  bad  examples
of an object  sub category cannot  or should not  be included in the training set  since we
use a least squares line fit to adjust the fuzzy membership functions  the use of some  bad 
training examples  for which the blame may have been inaccurately distributed among the
fuzzy membership functions  should not dramatically affect the overall reliability of the
learned system parameters  rather  it is just desirable to train the system with examples
that  for the most part  are good examples of their labeled object category  however  this
is not unreasonable as we might expect a machine  or a human for that matter  to better
learn what constitutes a chair by observing good examples of chairs 
   

fiwoods  cook  hall  bowyer    stark

   experimental setup
upon reading in the rule base  the knowledge primitive measurements of the training examples  and all training example goals  omlet begins by learning the membership functions
of all level   categories  the first learning epoch is used to make initial estimates of the
membership functions  and then omlet iterates for      additional training epochs  a
learning rate of      is used during the      training epochs  so that    percent of the actual error for each training example is propagated to the adjustable ranges on each epoch 
after the      training epochs  the best range parameters  those that resulted in the lowest
overall error  for level   categories are restored and frozen  the      training epochs are
then repeated for the level   categories  followed by the level   categories  and so on until
all ranges in the category definition tree have been learned  
the performance task of the omlet system is evaluated by how well the trained system
recognizes objects that were not used in the training phase  one measurement of system
performance is the error observed on the test examples  the error for a test example is
computed as the absolute value of the difference between the desired and actual evaluation
measures  training test sets are configured two ways  random partitioning of all labeled
data into training and test sets  and leave one out testing  in the first case  for a given
size training set     train test set pairs are created by randomly partitioning all the labeled
data  the error for a single test set is the average error of all test examples  the results for
a given size training set are reported as the average error of the    partitions  in leave oneout testing  one example in the data set is used to test while all remaining samples form
the training set  this is repeated using each example in the data as the test set  and results
are reported as the average error of all test examples  the average error per example versus
the training set size is plotted for training sets of                   n   samples  the point
with n   training examples represents the leave one out test results 

    test on the gruff chair database

from the evaluations of gruff  stark   bowyer         a large database of   d shapes
specified as polyhedral boundary representations has been built up  figure   shows    chair
shapes  a number of the    shapes can belong to more than one category or can function
in more than one stable orientation  this results in a total of     training examples  there
are    labeled instances for the category conventional chair  some    of these instances
additionally satisfy the function of straightback chair  and   instances satisfy the function
of armchair  for each shape  we have the evaluation measure for the shape s membership
in different object categories  as computed by gruff with the hand crafted functions for
the primitive evaluation measures  this set of shapes and their evaluation measures make
up the first set of training examples 
the first set of experiments will help determine how well omlet learns a set of membership functions that minimize the overall error  and also how closely the learned membership
functions approximate the original functions hand crafted by an expert for gruff  a
question of great practical importance to vision researchers is whether a machine learning
   in some preliminary experiments  omlet converged on a low overall error for each level of categories
anywhere between     and     training epochs  hence the decision to train for      epochs per category
level  the learning rate was also determined empirically 

   

filearning membership functions in object recognition

figure    the    object chair database 
technique can derive a set of system parameters equivalent to the hand crafted results of
the system designer  if so  the manual effort in system construction could be greatly eased 
when the learning task is formulated as duplicating the gruff measures  the training
data for these experiments is effectively  noiseless    noiseless in the sense that the desired
evaluation measures that are used as input to omlet are all derived in the same manner
from the same set of hand crafted fuzzy membership functions  

    test on a synthetic cup database

the definition and recognition of cups is a task that has been visited frequently in machine
learning research  mitchell  keller    kedar cabelli        winston  binford  katz   
lowry         as winston        observes  it is hard to tell vision systems what cups
should look like  it is much easier to talk about the purpose and function of a cup  we
convey the description of a cup by providing its functional definition  in particular  a cup
is described as an object that can hold liquid  that is stable  liftable  and can be used
to drink liquids  the physical identification can be made using this functional definition 
in particular  for the synthetic set of objects created here  these functional properties are
broken down into    knowledge primitives     of which have range parameters 
we generated a database of     synthetic cup examples  for which the measurements
of the knowledge primitives are randomly distributed  hand crafted range parameters
 z   n  n  z    are supplied for all    ranges in the cup functional definition  to generate a
   

fiwoods  cook  hall  bowyer    stark

cup example  a primitive measurement is randomly selected for each range  approximately
    of the time the primitive measurement is randomly chosen between n  and n   the
other     of the time the measurement is randomly chosen outside n  and n   but inside
z   and z    this cup generator program provides us with the capability to create a large
number of cup examples without the time consuming process of creating actual   d cad
models for each example 

    learning from human evaluation measures

in object recognition it is important to test a system on real objects  if possible  for a number
of reasons  first  we can see whether the system can approximate human judgment  second 
it is important to observe system performance in the presence of noise  which real world data
will inevitably contain  finally  using real world data will alleviate the need to completely
hand craft the system with synthetic data  this is actually a useful guide for the scenario
where the  vision system engineer  gives the system a set of human labeled examples  and
lets the system learn the parameters  to test omlet  we have used a set of    actual
objects and human ratings of how well they might serve as a chair  figure    shows some
of the objects used in these experiments 

figure     some examples of the chair objects used for human evaluation tests 
in order to determine how well omlet can learn to recognize the set of real chair like
objects  all the objects were collected together in a single room and each object was placed
in the orientation in which it would most likely be recognized as a chair  for actual chairs 
this is simply the orientation in which the chair would typically be used  for a metal trash
   

filearning membership functions in object recognition

can it would be an  upside down  orientation  etc  then a group of    undergraduate
students in an artificial intelligence class was given the following instructions 
you are asked to rate each of the thirty seven objects according to the degree
of  chair ness  that is reected in its   d shape  for our purposes   chair ness 
measures if the object could be used as a chair  you are to consider only the
  d shape in making your rating  you should assume that each object is made
of appropriate materials  so that this is not a factor in your ratings  you are
to consider the suitability of the object shape only in the orientation that you
see it  rather than some other orientation  examples of factors that you should
consider in rating the  chair ness  of a shape are height  width  depth  area 
relative orientation and apparent stability 
you are asked to rate each shape against the requirements of three different
aspects of  chair ness   the first aspect is solely its ability to provide a stable
seating surface  the second aspect is solely its ability to provide back support
compatible with the seating surface  the third aspect is solely its ability to
provide arm support compatible with the seat and back  each aspect should
be judged independently on a scale of   to    where   means it has no ability
to provide the required function and   means that it seems ideal to provide the
desired function  you may mark halfway between two numbers if you wish 
the ratings of each aspect of  chair ness  were then averaged  normalized and rounded
to the nearest multiple of      to result in values in the range        the overall evaluation
measures for the objects for the conventional chair category are taken as the normalized
evaluation measures for the first aspect of  chair ness   that is the object s ability to provide
a stable seating surface  overall evaluation measures for the categories straightback chair
and armchair are computed using the probabilistic or t conorm to combine the three aspects
of  chair ness  in the manner described in subsection      hence  a comfortable  sturdy
chair would have a value close to   for  chair ness   while the upside down trash can has a
considerably lower value  approx       
after the objects had been rated  measurements were taken for each of the primitives
describing the chair in the gruff system  the measurements were those required for the
omlet rules  such as the clearance from the ground  the area of the sittable surface  the
height of the sittable surface  etc  complete omlet examples describing the objects were
then created  including the aggregate evaluation measure of the objects for the categories
conventional chair  straightback chair  and armchair  this resulted in    objects for the
conventional chair category     objects in the straightback chair category     objects had
no back support at all   and    objects in the armchair category     objects that had
back support did not have any arm support   there are at least two sources of noise in
this experimental data     the human evaluations  and    the actual measurements of the
physical properties of the objects  for example  the standard deviations of the normalized
human evaluations of the    objects for the conventional chair category are about      
or      on average  the results of leave one out testing on the    real world objects are
presented in the next section 
   

fiwoods  cook  hall  bowyer    stark

   experimental results

there are at least four factors that may affect the performance of the omlet system    
the number of training epochs     the number of training samples for each category     the
number of ranges to be learned for each category  and    the quality of the training data for
each category  histograms of the desired evaluation measures of the training data are used
to convey the concept of training set  quality   they are shown in figure    for the gruff
chair data  the height of each histogram bin is the number of training samples with desired
evaluation measures that fall within a particular range  so  the histogram of a  good  set
of training data would be skewed towards the higher evaluation measures  similarly  the
histogram representing  bad  training data would be skewed towards the lower evaluation
measures 

figure     histograms of desired evaluation measures of the gruff chair training sets 
the histogram of a parent category  such as conventional chair or cup  represents the
distribution of the overall desired evaluation measures  which are the goal measures of the
examples in the data set provided as input to omlet   however  the histograms for subcategories  such as straightback chair and armchair  represent the distributions of the desired
evaluation measures associated with the additional functional requirements defined for the
   

filearning membership functions in object recognition

subcategory  for example  the histogram for the straightback chair category represents the
quality of the provides back support portion of the straightback chair examples in a data
set  not the overall desired evaluation measures  recall that the ranges associated with
the parent category conventional chair will be frozen  and presumably accurate  before
learning begins for the category straightback chair  so  omlet only uses straightback chair
examples to learn the ranges associated with the provides back support functional property 
thus  when learning the ranges for the category straightback chair  we want to observe the
quality of the back supports of the training examples  similarly  we want to observe the
quality of the arm supports of the armchair examples  not the overall desired evaluation
measures 
a  effect of training time for gruff objects

b  effect of training time for synthetic cups

training with    gruff
labeled conventional chairs

training with    
synthetic cups

training with    gruff
labeled straightback chairs

c  effect of training time for real objects

training with    human
labeled conventional chairs

training with    human
labeled straightback chairs

figure     average training sample error versus number of training epochs for a  gruff
chair objects  b  synthetic cups  and c  real chair objects  these plots are for
a single leave one out test run 
figure    shows examples of the average training sample error plotted as a function of
the number of training epochs for each of the three data sets  gruff objects  synthetic
cups  and real objects   from these plots  we can see that      training epochs is more
than sucient for all of the categories in the three data sets  training could most likely
   

fiwoods  cook  hall  bowyer    stark

be stopped after     epochs for any of the categories without a degradation in system
performance  since the number of training epochs is the same for all categories  and has
been shown to be sucient  we can eliminate this factor as a possible cause for the different
levels of performance among categories  some experiments in addition to those described
in section   were run to examine the effect of the other performance factors 

    the gruff chair database

figure     omlet results for test samples from the gruff chair database 
figure    shows the plot of the average error per sample versus training set size for examples from the conventional chair category  and a separate plot for examples from the
straightback chair category  since there are only    straightback chair examples  only   different training set sizes           were evaluated in addition to the leave one out testing  all
   conventional chair examples were used to train the ranges associated with the conventional chair category before the ranges for the straightback chair category were trained  no
testing was done for the subcategory armchair since there were only four training samples
available  the plot shows that increasing the number of training samples generally leads
to a reduction in the average error  when more than    training examples are used  the
actual evaluation measures of the test examples are within approximately    of the desired
evaluation measures for both the conventional chair and straightback chair categories 
we should note here that the errors in overall evaluation measures found for categories
at different learning levels are not directly comparable  so  the plot of the error rate for
the straightback chair category is not directly comparable to the plot for the conventional
chair category  figure      as an example  consider an object with a desired overall evaluation measure of      for the category conventional chair  if omlet computes an actual
   

filearning membership functions in object recognition

evaluation measure of       then the error for this example is       let s assume the provides back support portion of this object has a desired evaluation measure of       the
overall desired evaluation measure for this example in the category straightback chair would
be         por of      and        now  suppose omlet finds the actual evaluation measure for the back support of the object to be       or an error of       in this case  the
actual overall evaluation measure of this example for the category straightback chair would
be         por of      and        as a result  the error of      attributed to the provides back support portion of the object is manifested as a much smaller error of        in
the overall evaluation measure of the object 
the original range parameters  z   n  n  z    hand crafted by an expert for the three
ranges in the conventional chair definition  see figure    are 
area                               
contiguous surface                  
height                    
these are the range values used by gruff to determine the desired evaluation measures
in the goals provided to omlet  a typical example of the range parameters as learned by
omlet is 
area                                      
contiguous surface         e                         
height                             
omlet was able to determine that the contiguous surface range was a one legged

membership function  and the n  and z   values  i e   the leg that does not exist  were set
to arbitrarily large values  these results show that the omlet system is capable of using
labeled examples to automatically determine range parameters which are similar to those
that would be hand crafted by an expert  this will facilitate the construction of other
object category definitions 
in figure     we can see that the number of training samples does indeed affect the
error rate of test samples  with more than    or so training samples  the error rates
for both the conventional chair and straightback chair categories begin to level off  so 
the number of training samples becomes less of a factor affecting system performance if a
sucient number are used  what constitutes a sucient number of training samples for a
category may depend on the number of ranges to be learned and the quality of the training
data  there are   ranges that must be learned for the category conventional chair  and  
ranges that must be learned for the category straightback chair  the histograms of desired
evaluation measures for the gruff conventional chairs and the back supports of the gruff
straightback chairs in figure    a and b  respectively  reect the quality of the training
data used for the leave one out tests 
we can isolate the effect of the quality of the training data with some additional experiments utilizing two separate data sets of gruff conventional chair examples  the number
   

fiwoods  cook  hall  bowyer    stark

of training epochs  the number of training samples  and the number of ranges to be learned
will be identical for each data set  one data set of     bad  examples contains all conventional chair examples with desired evaluation measures less than      a second data set of
 good  examples was created by selecting    of the remaining conventional chair examples 
the histograms of desired evaluation measures for the examples used in the  good  and
 bad  data sets are shown in figure    c and d  respectively  leave one out testing    
training examples  resulted in an average error of        for the examples in the  good 
data set  and        for the examples in the  bad  data set  thus  it would seem that the
quality of the training data has a considerable effect on the performance of the learning
algorithm 
using the set of     good  conventional chair examples to train omlet  the average
error found using the     bad  examples to test drops to        compared to an average
error of        when     bad  examples are used to train   a closer examination of the
results reveals that one  bad  example contributes a relatively high error of     to the
average  if this single example is excluded from the test results  the average error of the
remaining     bad  examples is only          if the     bad  examples are used to train
omlet  the average error found using the     good  examples to test is        these
results indicate that omlet is not inherently biased to produce more accurate test results
for  good  examples since we are able to achieve a low error rate for the  bad  examples
when  good  training data is used  rather  these results emphasize the importance of
controlling the quality of the data used to train omlet 

    the synthetic cups database

figure     omlet results for test samples from the gruff cup database 
   

filearning membership functions in object recognition

figure    shows the plot of the average error per sample versus training set size for examples
from the randomly generated cup category  as before  omlet s performance generally
improves as the number of training samples is increased  a comparison of the error plots
for the conventional chair data and the cup data reveals that the average error for the
cups is higher for the same number of training samples  and the error rate decreases more
erratically  the comparison of error rates between these two categories is valid since they
are both at the same level in the learning hierarchy  as before  there are two performance
factors that could be the cause of the different error rates  there are considerably more
ranges that need to be learned for the cup category than for the gruff conventional chair
category     versus     also  from figure    a  we can see that data set created by the
cup generator program is of poor quality  thus  due to the random nature of the synthetic
cup generator program  the system was trained with shapes that  on average  are not very
good examples of cups  regardless of the poor training data  when more than     training
samples are used  the actual evaluation measures for the cup test examples are within
approximately    of the desired evaluation measures  in light of the  bad  set of shapes
used as training examples and the large number of ranges that must be learned  the higher
average error for cups seems reasonable 

figure     histograms of desired evaluation measures of the synthetic cup training sets 
as an additional test  we generated a set of    synthetic cups in the same manner as
before  see section       however  we required the distribution of the desired evaluation
measures of the synthetic cups to have a similar distribution as the gruff conventional
chair examples  shown in figure    a   figure    b shows the histogram of desired evaluation measures of the examples in this second synthetic cup data set  since the number of
training epochs  the number of training examples  and the quality of the training data are
the same as for the first test using the gruff conventional chair examples  this experiment
isolates the effect of the number of ranges that must be learned  performing a leave one out
test     training examples   the average error per sample was found to be approximately
      in figure     the leave one out results on the    gruff conventional chair examples
   

fiwoods  cook  hall  bowyer    stark

 sub category
conventional
chair
straightback
chair
armchair

number of
average desired average error
training samples evaluation measure per sample
  
      
         
  

      

         

  

      

         

table    leave one out test results for real object database with evaluation measures derived from human ratings of the objects 

show an average error of less than      per sample  thus  it would seem that the number
of ranges to be learned affects system performance considerably 
finally  we created a set of     synthetic cups with a similar distribution as the gruff
conventional chair examples  the histogram of desired evaluation measures of the examples
in this third synthetic cup data set would look similar to the histograms in figure    a  and
figure    b  performing a leave one out test      training examples   the average error per
sample was found to be approximately        compared to the error rate of the original    
synthetic cups  approximately        we again note that  better  training data improved
system performance considerably  compared to the error rate of the    synthetic cup data
set  approximately        which is similar in quality  we see the increased number of training
samples significantly improved system performance  the error rate for this third synthetic
cup data set with     examples is still higher than the error rate for the gruff data set
of    conventional chair objects  less than        which has a similar quality distribution 
consider that for the gruff data set we used    training examples to learn the   ranges
of the conventional chair category  and for the synthetic cup data set  we used     training
examples to learn the    ranges of the cup category 

    the chair database for human evaluation

leave one out test results for the real object database with evaluation measures derived
from human ratings of the objects are listed in table    recall that the error rates are not
directly comparable among the three categories  the actual evaluation measures for the
conventional chairs objects are within approximately    of the human evaluation measures 
the average error here is about    greater average error than for the gruff data with a
similar number of training samples  the histogram in figure    a shows that the data set of
real conventional chair objects contains mostly  good  examples  thus  the higher average
error can probably be attributed to the  noise  associated with the real object evaluation
measures  considering an average standard deviation of     for the human evaluations of
the conventional chair objects  a    average error per sample for the omlet results does not
seem unreasonable  the actual evaluation measures for the real object straightback chairs
and armchairs differ on average by less than    from the desired measures  as before  all
conventional chair examples were used to train the ranges associated with the conventional
   

filearning membership functions in object recognition

chair category before the ranges for the straightback chair category were trained  the
histograms of desired evaluation measures for the back support of the real straightback
chair objects and the arm support of the real armchair objects are shown in figure    b
and c  respectively 

figure     histograms of desired evaluation measures of the real object training sets 

   summary and discussion

we have presented a system  omlet  which uses labeled training examples to learn fuzzy
membership functions embedded in a function based object recognition system  the fuzzy
membership functions are used to provide evaluation measures which determine how well a
shape fits the functional description of an object category  the omlet system is an example
of using machine learning techniques to aid in the development of a computer vision system 
we have shown that it is possible to accurately and automatically learn system parameters
which would otherwise have to be provided by a human expert  omlet may be used to aid
in the construction of other object categories for the gruff object recognition system  the
expert does not need to concentrate on  hand tweaking  the range parameters to improve
system performance  but rather on providing a good set of example objects to  show  to
omlet  this is intuitively appealing in that we are deriving descriptions of objects we would
   

fiwoods  cook  hall  bowyer    stark

like gruff to recognize by providing examples from the object category  additionally  we
have been able to demonstrate that the performance of the learning algorithm is affected
by the number and quality of the training examples 
it should be possible for the learning approach described in this paper to be applied to
other systems in which measurements  or other values  are combined in a tree structure 
all cases are covered by our approach  except the case of   leaves leading directly to a por
node  however  a generalization of our method for treating por nodes may be developed
to handle this situation  the tree structure in our cv system is composed entirely of
probabilistic and and probabilistic or nodes  which are used to combine measurements  it
is possible that a similar approach is applicable to tree structures in which other types of
nodes  t norms or t conorms  are used 
the omlet system should make it easier to adapt the gruff system to new object
domains  early versions of gruff performed object recognition starting from complete
  d shape descriptions  stark   bowyer              sutton et al         rather than from
real sensory data  the task of reliably extracting accurate object shape descriptions from
normal intensity images is beyond the current state of the art in computer vision  although
work in  for example  binocular stereo  is steadily progressing  accurate models of object
shape are more readily extracted from range imagery  whereas in normal imagery a pixel
value represents the intensity of reected light  in range imagery a pixel value represents the
distance to a point in the scene  a version of gruff has been developed which attempts to
recognize object functionality from the shape model that is extracted from a single range
image  stark  hoover  goldgof    bowyer      b   a major diculty here is  of course 
that a single range image does not yield a complete model of the   d shape of an object 
the  back half  of the object shape is unseen  hoover  goldgof    bowyer         the
accumulation of a complete   d shape model through a sequence of range images is a topic of
current research  if this problem was solved  then it is conceivable that an omlet training
example might consist of a sequence of range images along with some operator annotations
to identify which portions of the images correspond to the functionally important parts of
the object  seating surface  back support surface  etc   

acknowledgements
this research was supported by air force oce of scientific research grant f         j     and national science foundation grant iri          

references
berenji  h     khedkar  p           learning and tuning fuzzy logic controllers through
reinforcements   ieee transactions on neural networks             
bogoni  l     bajcsy          an active approach to characterization and recognition of
functionality and functional properties   in aaai    workshop on reasoning about
function  pp          washington  d c 
   

filearning membership functions in object recognition

bonissone  p  p     decker  k  s           selecting uncertainty calculi and granularity 
an experiment in trading off precision and complexity   in kanal  l     lemmer  j 
 eds    uncertainty in artificial intelligence  pp           north holland publishing
company 
brand  m           vision systems that see in terms of function   in aaai    workshop
on reasoning about function  pp        washington  d c 
cooper  g     herskovits  e           a bayesian method for the induction of probabalistic
networks from data   machine learning             
di manzo  m   trucco  e   giunchiglia  f     ricci  f           fur  understanding
functional reasoning   international journal of intelligent systems             
hoover  a   goldgof  d     bowyer  k          extracting a valid boundary representation
from a segmented range image  ieee transactions on pattern analysis and machine
intelligence  accepted to appear 
ishibuchi  h   nozaki  k     yamamoto  n           selecting fuzzy rules by genetic
algorithm for classification problems   in  nd ieee international conference on
fuzzy systems  pp            
jang  j  s  r           anfis  adaptive network based fuzzy inference systems   ieee
transactions on systems  man and cybernetics                  
jang  j  s  r     sun  c  t           neuro fuzzy modeling and control   proceedings of
the ieee          
kise  k   hattori  h   kitahashi  t     fukunaga  k           representing and recognizing
simple hand tools based on their functions   in asian conference on computer
vision  pp          osaka  japan 
lehn  k  v          mind bugs  the origins of procedural misconceptions  the mit press 
cambridge  massachusetts 
mahadevan  s     connell  j           automatic programming of behavoir based robots
using reinforcement learning   in aaai  pp          
michalski  r  s           a theory and methodology of inductive learning   in michalski 
r  s   carbonell  j  g     mitchell  t  m   eds    machine learning  an artificial
intelligence approach  tioga publishing company  palo alto  ca 
mitchell  t  m   keller  r  m     kedar cabelli  s  t           explanation based generalization  a unifying view   machine learning           
parido  a     bonelli  p           a new approach to fuzzy classifier systems   in
proceedings of the fifth international conference on genetic algorithms  pp      
    
pearl  j          probabilistic reasoning in intelligent systems  networks of plausible
inference  morgan kaufmann 
   

fiwoods  cook  hall  bowyer    stark

quinlan  j  r          c     programs for machine learning  morgan kaufmann 
rivlin  e   rosenfeld  a     perlis  d           recognition of object functionality in
goal directed robotics   in aaai    workshop on reasoning about function  pp 
        washington  d c 
spiegelhalter  d   dawid  p   lauritzen  s     cowell  r           bayesian analysis in
expert systems   statistical science             
stark  l     bowyer  k  w           achieving generalized object recognition through
reasoning about association of function to structure   ieee transactions on pattern
analysis and machine intelligence                    
stark  l     bowyer  k  w           function based recognition for multiple object categories   image understanding                
stark  l   hall  l  o     bowyer  k  w       a    an investigation of methods of combining
functional evidence for   d object recognition   int  j  of pattern recognition and
artificial intelligence                 
stark  l   hoover  a  w   goldgof  d  b     bowyer  k  w       b    function based
recognition from incomplete knowledge of shape   in ieee workshop on qualitative
vision  pp        new york  new york 
sutton  m   stark  l     bowyer  k  w           function based generic recognition for
multiple object categories   in jain  a  k     flynn  p  j   eds    three dimensional
object recognition systems  pp           elsevier science publishers 
vaina  l     jaulent  m           object structure and action requirements  a compatibility
model for functional recognition   int  j  of intelligent systems             
valenzuela rendon  m           the fuzzy classifier system  a classifier system for continuously varying variables   in proceedings of the fourth international conference
on genetic algorithms  pp          
watkins  c  j          models of delayed reinforcement learning  ph d  thesis  cambridge
university 
winston  p  h   binford  t  o   katz  b     lowry  m           learning physical descriptions from functional definitions  examples  and precedents   national conference on
artificial intelligence          

   

fi