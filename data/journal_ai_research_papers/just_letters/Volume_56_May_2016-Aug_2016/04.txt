journal of artificial intelligence research                  

submitted        published      

qualitative spatial logics for buffered geometries
heshan du

h du leeds ac uk

university of leeds  uk

natasha alechina

natasha alechina nottingham ac uk

university of nottingham  uk

abstract
this paper describes a series of new qualitative spatial logics for checking consistency
of sameas and partof matches between spatial objects from different geospatial datasets 
especially from crowd sourced datasets  since geometries in crowd sourced data are usually not very accurate or precise  we buffer geometries by a margin of error or a level of
tolerance   r    and define spatial relations for buffered geometries  the spatial logics
formalize the notions of buffered equal  intuitively corresponding to possibly sameas  
buffered part of  possibly partof   near  possibly connected  and far  definitely disconnected   a sound and complete axiomatisation of each logic is provided with respect to
models based on metric spaces  for each of the logics  the satisfiability problem is shown
to be np complete  finally  we briefly describe how the logics are used in a system for generating and debugging matches between spatial objects  and report positive experimental
evaluation results for the system 

   introduction
the motivation for our work on qualitative spatial logics comes from the needs of integrating
disparate geospatial datasets  especially crowd sourced geospatial datasets  crowd sourced
data involves non specialists in data collection  sharing and maintenance  compared to
authoritative geospatial data  which is collected by surveyors or other geodata professionals  crowd sourced data is less accurate and less well structured  but often provides richer
user based information and reflects real world changes more quickly at a much lower cost
 jackson  rahemtulla    morley         it is in the interests of national mapping agencies 
government organisations  and all other users of geospatial data to be able to integrate and
use different geospatial data synergistically 
geospatial data matching refers to the problem of establishing correspondences  matches 
between spatial objects represented in different geospatial datasets  it is an essential step
for data comparison  data integration or enrichment  change detection and data update 
matching authoritative geospatial data and crowd sourced geospatial data is a non trivial
task  geometry representations of the same location or place in different datasets are usually not exactly the same  objects are also sometimes represented at different levels of
granularity  for example  consider geometries of objects in nottingham city centre given by
ordnance survey of great britain  osgb         and by openstreetmap  osm        
in figure    the position and shape of the prezzo ristorante are represented differently in
osgb data  dotted  and osm data  solid   the victoria shopping centre is represented
as a whole in osm  and as several shops in osgb 
c
    
ai access foundation  all rights reserved 

fidu   alechina

figure    prezzo ristorante and victoria shopping centre represented in osgb  dotted 
and osm  solid 

in order to integrate the datasets  we need to determine which objects are the same
 represent the same entity  and sometimes which objects in one dataset are parts of objects
in the other dataset  as in the example of victoria shopping centre   the statements
representing these two types of relations are referred to as sameas matches and partof
matches respectively  one way to produce such matches is to use locations and geometries
of objects  although of course we also use any lexical labels associated with the objects  such
as names of restaurants etc  in our previous work  du  alechina  jackson    hart        
we present a method which generates matches using both location and lexical information
about spatial objects  as generated matches may contain errors  they are seen as retractable
assumptions and require further validation and checking  one way is to use logical reasoning
to check the consistency of matches with respect to statements in input datasets  by
using description logic reasoning  the correctness of matches can be checked with respect
to classification information  for example  it is wrong to state that spatial objects a and
b are the same  if a is a bank and b is a clinic  because the concepts bank and clinic
are disjoint  containing no common elements  however  this is not sufficient for validating
matches between spatial objects    for example  two spatial objects which are close to each
other in one dataset cannot be matched to two spatial objects which are far away apart in
the other dataset  no matter whether they are of the same type or not  therefore  spatial
reasoning is required to validate matches with regard to location information  in addition
to description logic reasoning 
spatial logic studies relations between geometrical structures and spatial languages describing them  aiello  pratt hartmann    van benthem         there are a variety of
spatial relations  such as topological connectedness of regions  relations based on distances 
relations for expressing orientations or directions  etc  in a spatial logic  spatial relations
are represented in a formal language  such as first order logic or its fragments  and inter   there are works  lutz   milicic        on extending description logics with concrete domains or constraint systems  such as the region connection calculus  rcc   randell  cui    cohn        and allens
interval algebra  allen         the description logic reasoner pellet  sirin  parsia  grau  kalyanpur 
  katz        was extended to pelletspatial  stocker   sirin         which supports qualitative spatial
reasoning in rcc  however  later we will show that it is not appropriate to use rcc in our application 

   

fiqualitative spatial logics for buffered geometries

preted over some structures based on geometrical spaces  such as topological spaces  metric
spaces and euclidean spaces  in the field of qualitative spatial reasoning  several spatial
formalisms have been developed for representing and reasoning about topological relations 
such as the region connection calculus  rcc   randell et al          the   intersection
model  egenhofer   franzosa        and their extensions  clementini   felice        roy
  stell        schockaert  cock  cornelis    kerre      b      a  schockaert  cock   
kerre         in addition  there are formalisms for representing and reasoning about directional relations  frank              ligozat        balbiani  condotta    del cerro 
      goyal   egenhofer        skiadopoulos   koubarakis         as well as relative or
absolute distances  zimmermann        clementini  felice    hernandez        wolter  
zakharyaschev               recent comprehensive surveys on qualitative spatial representations and reasoning are provided by cohn and renz        and chen  cohn  liu  wang 
ouyang  and yu        
qualitative spatial reasoning has been shown to be applicable to geospatial data  bennett        bennett  cohn    isli        guesgen   albrecht        mallenby        mallenby   bennett        li  liu    wang         where location information of spatial
objects comes from a single data source  the application described in this paper is different  as location representations about the same spatial object come from different sources
and are usually not exactly the same  rather than treating all the differences in geometric
representations as logical contradictions  we would tolerate slight geometric differences and
only treat qualitatively defined large differences as logical contradictions used for detecting
wrong matches  more specifically  after establishing matches between two sets of spatial
objects  if the set of matches gives rise to a contradiction  then some match must be wrong
and should be retracted  in addition  we would provide explanations to help users understand why a contradiction exists and why some matches are wrong  in the following  we
assess the appropriateness of several existing spatial formalisms for these purposes 
the region connection calculus  rcc   randell et al         is a first order formalism
based on regions and the connection relation c  which is axiomatised to be reflexive and
symmetric  two regions x  y are connected  i e  c x  y  holds   if their closures share a
point  based on the connection relation  several spatial relations are defined for regions 
among them  eight jointly exhaustive and pairwise disjoint  jepd  relations are identified 
dc  disconnected   ec  externally connected   p o  partially overlap   t p p  tangential
proper part   n t p p  non tangential proper part   t p p i  inverse tangential proper
part   n t p p i  inverse non tangential proper part  and eq  equal   they are referred
to as rcc   which is well known in the field of qualitative spatial reasoning 
the   intersection model is developed by egenhofer and franzosa        and egenhofer
and herring        based on the point set interpretation of geometries  by comparing the
nine intersections between interiors  boundaries and exteriors of point sets  it identifies   
mutually exclusive topological relations  the   intersection model provides a comprehensive
formal categorization of binary topological relations between points  lines and regions  only
a small number of these    relations are realisable in a particular space  egenhofer  
herring         restricting point sets to simple regions  regions homeomorphic to disks  
the     relations collapse to the rcc  relations 
for the described application  we found it difficult to use spatial formalisms such as the
region connection calculus  randell et al         and the   intersection model  egenhofer
   

fidu   alechina

  franzosa         since they presuppose accurate geometries or regions with sharp boundaries and define spatial relations based on the connection relation  this is too strict for
crowd sourced geospatial data  as shown in figure    a  is sameas a    both representing a
prezzo ristorante  b  is sameas b    both referring to a blue bell inn  though the sameas
matches are correct  a topological inconsistency still exists  since a  and b  are disconnected
 dc   a  and b  are externally connected  ec   and the spatial relations dc and ec are
disjoint  therefore  relations based on connection are too strict for crowd sourced geospatial
data which is possibly inaccurate and may contain errors 

figure    in osgb data  the prezzo ristorante  a    and the blue bell inn  b    are disconnected  whilst in osm data  they  a  and b    are externally connected 
the egg yolk theory is independently developed by lehmann and cohn         cohn
and gotts      b      a   and roy and stell        extending the rcc theory and by
clementini and felice              extending the   intersection model  in order to represent and reason about regions with indeterminate boundaries  in this theory  a region with
an indeterminate boundary  an indeterminate region  is represented by a pair of regions 
an egg and a yolk  which are the maximum extension and the minimum extension of
the indeterminate region respectively  similar to the upper approximation and lower approximation in the rough set theory  pawlak  polkowski    skowron         the yolk is
not empty and it is always a proper part of the egg  the egg yolk theory presupposes the
existence of a core part of a region and a more vague part  for the described application 
the same location can be represented using two disconnected polygons from an authoritative geospatial dataset and a crowd sourced geospatial dataset respectively  in this case  we
could not define a certain inner region for any of the disconnected polygons  otherwise  it
is inconsistent to treat them as different representations for the same location 
we are aware that there are several approaches  fine        zadeh        smith       
to representing vague concepts and relations  which have been adopted to extend classical
theories such as rcc and the   intersection model  a main approach is to assign a degree of
truth or a degree of membership to concepts and relations  for example  in the fuzzy region
connection calculus  fuzzy rcc   schockaert et al       b      a         the connection
relation c is defined as a reflexive and symmetric fuzzy relation  for regions a  b  c a  b 
denotes the degree to which a and b are connected  using c as the primitive relation 
every rcc relation r can be redefined to calculate the degree to which r holds  the
fuzzy rcc or other similar formalisms may be applied in the case shown in figure    for
example  with an appropriate membership function for the relation ec  ec a    b         
   

fiqualitative spatial logics for buffered geometries

figure    buffering the geometry x by a distance   three dashed circles are buffered part
of  bpt  the solid circle  the dashed circle and the solid circle are buffered equal
 beq 

and ec a    b         then no contradiction will arise  we did not adopt this approach in the
matching problem  mainly because there is no good way to define the degree of membership 
and it is difficult to generate user friendly explanations for why the matches are wrong if
the underlying reasoning is numerical and relatively obscure 
the logic m s m   was proposed and developed by sturm  suzuki  wolter  and zakharyaschev         kutz  sturm  suzuki  wolter  and zakharyaschev         kutz  wolter 
sturm  suzuki  and zakharyaschev         wolter and zakharyaschev               and
kutz        for reasoning about distances  the logic m s m   makes it possible to define
concepts such as an object within the distance of     meters from a school  m in m s m  
is a parameter set  a typical example of m is q    the satisfiability problem for a finite set
of m s q    formulas in a metric space is exptime complete  wolter   zakharyaschev 
       m s m   was not developed for the problem of geospatial data matching  however  after we designed the logics introduced in this paper  we discovered that they form a
proper fragment of m s q     to detect problematic matches  we also reason about distances between objects  but this reasoning is of a more restricted and qualitative kind  the
complexity of the satisfiability problem of our logics is np complete  which makes them
somewhat more suitable for automatic debugging of matches than the full m s q     the
syntax and semantics of m s m   and the proofs for the proper fragment relations are
provided later in this paper  see section    
in this paper  we present a series of new qualitative spatial logics developed for validating
matches between spatial objects  a logic of near and far for buffered points  lnf   du 
alechina  stock    jackson         a logic of near and far for buffered geometries
 lnfs  and a logic of part and whole for buffered geometries  lbpt   du   alechina 
    a      b   the notion of buffer  iso technical committee            is used to model
the uncertainty in geometry representations  tolerating slight differences up to a margin of
error or a level of tolerance   r    as shown in figure    the buffer of a geometry x is
a geometry which contains exactly all the points within  distance from x  the buffer of
x is denoted as buffer  x      for a geometry x which is possibly represented inaccurately
within the margin of error  in one dataset  its corresponding representation in the other
dataset is assumed to be somewhere within buffer  x     
the spatial logics involve four spatial relations bufferedpartof  bpt   bufferedequal
 beq   near and far  they formalize the notions of possibly partof  possibly sameas 
possibly connected  given a possible displacement by   and definitely disconnected
 even if displaced by   respectively  a geometry x is bufferedpartof a geometry x     if
x is within buffer  x        two geometries are bufferedequal  if they are bufferedpartof
   

fidu   alechina

figure    near and far
each other  figure     we assume that two geometries x and x   from two diferent
datasets may correspond to the same object if they are bufferedequal  the parameter
 captures the margin of error in representation of geometries  two geometries x  y are
near  if the corresponding geometries x     y   in the other dataset could be connected 
i e  distance x  y            figure     clearly  if far x   y   holds  then near x   y  
should be false for x and y from the same dataset  in addition  we want to exclude the
possibility that near x     y     may hold for x     y    corresponding to x  y respectively 
in the other dataset  therefore we define far x   y   as distance x  y            figure     it is possible that two geometries x  y are not near and not far  this is 
distance x  y           
the way of defining beq  n ear and f ar is similar to that for defining distance
relations between points by moratz and wallgrun         where each point is assigned one
or more reference distances  the distance relations between two points x  y are defined
by comparing the distance between x  y to the reference distances of x and those of y  
as different points can have different reference distances for indicating nearness  distance
relations may not be symmetric  differing from the work by moratz and wallgrun        
the relations we defined are not only for points but also for general geometries  and every
geometry has the same reference distances      and     which leads to the symmetric
definitions of beq  n ear and f ar  we provide sound and complete sets of axioms to
support reasoning about beq  bp t   n ear and f ar relations  see section     this reasoning is useful for verifying matches between spatial representations from different sources 
as explained in our previous work  du et al          though the relations are named
n ear and f ar  we do not attempt to model human notions of nearness or proximity 
which is influenced by several factors  such as absolute distance  relative distance  frame of
reference  object size  travelling costs and reachability  travelling distance and attractiveness
of objects  guesgen   albrecht         in this work  we provide a strict mathematical
definition for the calculation of whether two objects are to be considered as being n ear
or f ar  based on a margin of error   while this makes our approach less likely to be
suitable for the simulation of human notions of nearness  it provides a useful tool for verifying
consistency of matches  the following arguments are formalized for checking consistency of
sameas and partof matches  if spatial objects a    b  are sameas or partof spatial objects
a    b  respectively  a    b  are n ear  a    b  are f ar  then a contradiction exists 
the rest of this paper is structured as follows  section    section   and section   provide
an introduction to the new spatial logics  their syntax and semantics  their relationships
with the logic m s m    their axioms and theorems  section   and section   present the
proofs of the soundness  completeness  decidability and complexity theorems for lbpt  as
the proofs for lnf and lnfs are similar and lbpt is more expressive than lnf and
lnfs  section   describes how lbpt is used for debugging matches between objects from
   

fiqualitative spatial logics for buffered geometries

different geospatial datasets  section   discusses the generality and limitations of the spatial
logics  section   concludes the paper 

   syntax and semantics
the language l ln f   is defined as
      beq a  b    n ear a  b    f ar a  b         
where a  b are individual names     def       the language l ln f s  is
exactly the same as l ln f    the language l lbp t   is almost the same as l ln f   and
l ln f s   except that it has bp t instead of beq as a predicate  l lbp t   is defined as
      bp t  a  b    n ear a  b    f ar a  b          
l ln f    l ln f s  and l lbp t   are all interpreted over models based on a metric
space  every individual name involved in an lnf formula is mapped to a point  whilst
each of those involved in an lnfs lbpt formula is mapped to an arbitrary geometry or
a non empty set of points 
definition    metric space  a metric space is a pair    d   where  is a non empty
set  of points  and d is a metric on   i e  a function d       r    such that for
any x  y  z    the following axioms are satisfied 
   identity of indiscernibles  d x  y      iff x   y 
   symmetry  d x  y    d y  x  
   triangle inequality  d x  z   d x  y    d y  z  
definition    metric model of lnf  a metric model m of lnf is a tuple    d  i    
where    d  is a metric space  i is an interpretation function which maps each individual
name to an element in   and   r  is a margin of error  the notion of m       is
true in the model m   is defined as follows 
m    beq a  b  iff d  i  a   i  b           
m    n ear a  b  iff d  i  a   i  b             
m    f ar a  b  iff d  i  a   i  b           
m     iff m      
m       iff m     and m     
where a  b are individual names     are formulas in l ln f   
definition    metric model of lnfs lbpt  a metric model m of lnfs lbpt is
a tuple    d  i     where    d  is a metric space  i is an interpretation function which
maps each individual name to a non empty set of elements in   and   r  is a margin
of error  the notion of m       is true in the model m   is defined as follows 
   

fidu   alechina

m    bp t  a  b  iff pa  i  a  pb  i  b    d  pa   pb           
m    n ear a  b  iff pa  i  a  pb  i  b    d  pa   pb             
m    f ar a  b  iff pa  i  a  pb  i  b    d  pa   pb           
m     iff m      
m       iff m     and m     
where a  b are individual names     are formulas in l ln f s  l lbp t    beq a  b  is
defined as bp t  a  b   bp t  b  a  
the notions of validity and satisfiability in metric models are standard  a formula is
satisfiable if it is true in some metric model  a formula  is valid       if it is true in all
metric models  hence if its negation is not satisfiable   the logic lnf lnfs lbpt is the
set of all valid formulas in the language l ln f   l ln f s  l lbp t   respectively 

   relationship with the logic m s m  
the logic m s m    as well as its variations  was developed by sturm et al          kutz
et al                wolter and zakharyaschev               and kutz        for reasoning
about distances 
m s m   is a family of logics defined relative to the parameter set m  q    m is
subject to the following two conditions  if a  b  m and a   b  r  then a   b  m   where
r   sup m if m is bounded  otherwise r     if a  b  m and a  b      then a  b  m  
the alphabet of m s m   consists of
 an infinite list of region variables x    x       
 an infinite list of location constants c    c       
 a set constant  ci   for every location constant ci  
 
 binary distance     equality     and membership    predicates 
 the boolean operators u    and their derivatives t    and   
 two distance quantifiers  a   a and their duals  a   a   for every a  m  
 two universal quantifiers  and  
m s m   terms are defined as 
s  t    xi    ci            s   s u t    a s   a s   s 
in addition to standard description logic concept constructions  m s m   can define a
concept of objects which are at a distance less than a from instances of some other concept
s   a s  and similarly for a distance at most a   a s and a s are defined as  a  s 
and a  s  respectively 
   

fiqualitative spatial logics for buffered geometries

m s m   formulas are defined as
 
      c  s   s   t    c    c      a    c    c     a         
 
 
 
further  s v t is an abbreviation for  s u t    s and s  
  t is an abbreviation for  s   t  
 c    c      a and  c    c     a are defined as   c    c     a  and   c    c      a  respectively 
an m s m   model b is a structure of the form 
b
b   hw  d  x b   x b        cb
    c       i

where hw  di is a metric space  definition     each xib is a subset of w   and each cb
i is
an element of w   the value of any other m s m   term in b is computed inductively as
follows 
  b   w   b    
  ci  b    cb
i   
  s b   w  sb  
b
  s  u s   b   sb
   s   

   a s b    x  w   y  sb   d x  y    a  
  a s b    x  w   y  sb   d x  y   a  
  s b    x  w   y  sb   
 a   a and  are dual to  a   a and  respectively  for instance 
  a s b    x  w   y  w    d x  y    a  y  sb    
the truth condition of b      where  is an m s m   formula  is defined as follows 
 b    c  s iff cb  sb  
 
b
 b    s    s  iff sb
    s   
 b     k  l    a iff d k b   lb     a 
 b     k  l   a iff d k b   lb    a 
 b     iff b      
 b       iff b     and b     
a set of m s m   formulas  is satisfiable  if there exists an m s m   model b such that
b     for every     this is denoted as b     
it is proved below that lnf lnfs lbpt are proper fragments of the logic m s q    
strictly speaking  this only holds when   q    but later we will show that a finite set of
lnf lnfs lbpt formulas is satisfiable where   r    if it is satisfiable when       in
other words   acts as a scaling factor  see the proof of lemma     
   

fidu   alechina

lemma   for individual names a  b  the m s m   formula  a  v  b  is not expressible
in lnf 
proof  let m    m  be metric models    m         d  i       m         d  i      
in m         o    o     d o    o        i   a    o    i   b    o    for any individual name x
differing from a  b  i   x    o   
in m         o   i   a    o  i   b    o  for any individual name x differing from a  b 
i   x    o  for any individual name y  ii   y      ii  y    i         
by the definitions of m    m    for any individual names x  y  d i   x   i   y          
d i   x   i   y        if  is an atomic lnf formula about x  y  then by definition    m     
iff m       by an easy induction on logical connectives  for any lnf formula   m     
iff m      
since i    a      o     i    b      o    and i    a     i    b      o   by the truth definition of m s m   formulas  m       a  v  b    m        a  v  b    hence   a  v  b  is
not equivalent to any lnf formula  
lemma   the logic lnf is a proper fragment of the logic m s q    
proof  every atomic lnf formula is expressible in m s q    
 beq a  b     a  b         a  b     
 n ear a  b     a  b         a  b      
 f ar a  b     a  b       
this means that all lnf formulas can be expressed in a fragment of m s q     the image
of lnf under the translation above  which only contains location constants  binary distance predicate and boolean connectives     by lemma    lnf is a proper fragment of
m s m    
lemma   for individual names a  b  the m s m   formula a v b is not expressible in
lnfs lbpt 
proof  let m    m  be metric models    m         d  i       m         d  i      
in m         o    o     d o    o        i   a     o     i   b     o     for any individual
name x differing from a  b  i   x     o    
in m         o   i   a     o   i   b     o   for any individual name x differing from
a  b  i   x     o  
if  is an atomic lnfs lbpt formula about x  y  then by definition    m      iff
m       by an easy induction on logical connectives  for any lnfs lbpt formula  
m      iff m      
   note that we can construct models in a one dimensional or two dimensional euclidean space in a similar
way and prove the lemma 
   note that we can construct models in a one dimensional or two dimensional euclidean space in a similar
way and prove the lemma 

   

fiqualitative spatial logics for buffered geometries

by the truth definition of m s m   formulas  m      a v b  and m       a v b  
hence  a v b is not equivalent to any lnfs lbpt formula  
lemma   the logic lnfs lbpt is a proper fragment of m s q    
proof  every atomic lnfs lbpt formula is expressible in m s q    
  for lnfs  beq a  b  iff  a v   b     b v   a   
  for lbpt  bp t  a  b  iff  a v   b   
 
 n ear a  b  iff  a u    b   
    
 
 f ar a  b  iff  a u    b      
note that the formulas on the right belong to a fragment of m s q    which is the image
of lnfs lbpt under the translation above 
the correctness of translation of beq a  b  and bp t  a  b  into m s q    follows directly from the truth definition of beq and bp t  definition     to show that the translation of n ear and f ar are correct  consider that the truth definition of n ear a  b 
is equivalent to    dmin  a  b     and f ar a  b  to dmin  a  b       where dmin  a  b   
inf d pa   pb     pa  i a   pb  i b    it was shown by wolter and zakharyaschev        that
 
dmin  a  b   m iff a u  m b   
    this makes the translation of the formulas have the
same truth conditions as defined in definition    by lemma    lnfs lbpt is a proper
fragment of m s q     
wolter and zakharyaschev        proved that the satisfiability problem for a finite set
of m s q    formulas in a metric space is exptime complete  which provides an upper
bound on the complexity of the satisfiability problems of lnf  lnfs and lbpt in a metric
space 
kutz et al         and kutz        gave axioms or inference rules connecting m s m  
terms  e g    s  s  for m s m   and its variants  however  the axiomatisation we are
going to present is for lnf  lnfs and lbpt formulas  corresponding to m s m   formulas
rather than m s m   terms  

   axioms and theorems
this section presents a sound and complete axiomatisation for the logic lnf lnfs lbpt
respectively  the axiomatic systems have been used as a basis for a rule based reasoner
described later in section      
the following calculus  which we will also refer to as lnf  is sound and complete for
lnf 
axiom   all tautologies of classical propositional logic
   it is important to have a complete axiomatisation  otherwise  the reasoner can not detect all the
lnf lnfs lbpt inconsistencies caused by problematic matches 

   

fidu   alechina

axiom   beq a  a  
axiom   beq a  b   beq b  a  
axiom   n ear a  b   n ear b  a  
axiom   f ar a  b   f ar b  a  
axiom   beq a  b   beq b  c   n ear c  a  
axiom   beq a  b   n ear b  c   beq c  d   f ar d  a  
axiom   n ear a  b   n ear b  c   f ar c  a  
mp modus ponens          
the following calculus  which we will also refer to as lnfs  is sound and complete for
lnfs 
axiom   all tautologies of classical propositional logic
axiom   beq a  a  
axiom   beq a  b   beq b  a  
axiom   n ear a  b   n ear b  a  
axiom   f ar a  b   f ar b  a  
axiom   beq a  b   beq b  c   n ear c  a  
axiom   beq a  b   n ear b  c   beq c  d   f ar d  a  
axiom   n ear a  b   beq b  c   beq c  d   f ar d  a  
mp modus ponens          
axiom   of the calculus lnf only holds for points  but not for arbitrary geometries 
because two points within the same line or polygon can be far from each other  axiom   is
replaced by axiom   in lnfs  all other axioms in lnfs are the same as those in lnf 
the following calculus  which we will also refer to as lbpt  is sound and complete for
lbpt 
axiom   all tautologies of classical propositional logic
axiom   near a  b   near b  a  
axiom   far a  b   far b  a  
axiom   bpt  a  a  
axiom    bpt  a  b   bpt  b  c   near c  a  
   

fiqualitative spatial logics for buffered geometries

axiom    bpt  b  a   bpt  b  c   near c  a  
axiom    bpt  b  a   near b  c   bpt  c  d    far d   a  
axiom    near a  b   bpt  b  c   bpt  c  d    far d   a  
mp modus ponens          
the calculus lbpt is similar to the calculus lnfs  changing predicates from beq to
bp t   lnfs axioms         are replaced by axioms           respectively in lbpt  since
bp t is not symmetric  lnfs axiom   does not have a corresponding axiom in lbpt  and
lnfs axiom   is replaced by two lbpt axioms  axiom    and axiom    
the notion of derivability     in lnf lnfs lbpt calculus is standard  a formula
 is derivable if     a set  is lnf lnfs lbpt inconsistent if for some formula  it
derives both  and  
we proved the following theorems for lnf  lnfs and lbpt 
theorem    soundness and completeness  the lnf lnfs lbpt calculus is sound
and complete for metric models  namely that
       
 every derivable formula is valid and every valid formula is derivable  
theorem    decidability and complexity  the satisfiability problem for a finite set
of lnf lnfs lbpt formulas in a metric space is np complete 
in the following sections  we give proofs of the results above for the case of lbpt  the
proofs for lnf and lnfs are similar  for lbpt  we have the following derivable formulas 
which we will refer to as facts in the completeness proof 
fact    bp t  a  b   n ear a  b  
fact    n ear a  b   f ar a  b  
fact    n ear a  b   bp t  b  c   f ar c  a  
fact    bp t  a  b   f ar a  b  
fact    bp t  a  b   bp t  b  c   f ar c  a  
fact    bp t  b  a   bp t  b  c   f ar c  a  
fact    bp t  a  b   bp t  b  c   bp t  c  d   f ar d  a  
fact    bp t  b  a   bp t  b  c   bp t  c  d   f ar d  a  
fact    bp t  a  b   bp t  b  c   bp t  c  d   bp t  d  e   f ar e  a  
fact    bp t  b  a   bp t  b  c   bp t  c  d   bp t  d  e   f ar e  a  
fact    bp t  b  a   bp t  c  b   bp t  c  d   bp t  d  e   f ar e  a  
as shown by facts        a chain of at most four bp t s implies the negation of f ar 
because f ar is defined as being     distance away in definition   
   

fidu   alechina

   soundness and completeness of lbpt
this section shows that the lbpt calculus is sound and complete for metric models 
though several definitions and lemmas have been presented in our previous work  du et al  
      du   alechina      b   the proofs presented here are more complete  structured  accurate  small errors are corrected  and simplified 
the proof of soundness  every lbpt derivable formula is valid           is by an
easy induction on the length of the derivation of   axioms            are valid  by the
truth definition of bp t   n ear and f ar  and modus ponens preserves validity 
in the rest of this section  we prove completeness  every lbpt valid formula is derivable  
       
we will actually prove that if a finite set of lbpt formulas  is consistent  then there
is a metric model satisfying it  any finite set of formulas  can be rewritten as a formula
 which is the conjunction of all formulas in    is consistent  iff  is consistent       
if there is a metric model m satisfying   then m satisfies   thus       therefore  if
we show that if  is consistent  then there exists a metric model satisfying it  then we
show that if      then       this shows that          and by contraposition we get
completeness 
the completeness theorem is proved by constructing a metric model for a maximal
consistent set  definition    of any finite consistent set of lbpt formulas  lemma    
definition    mcs  a set of formulas  in the language l lbp t   is maximal consistent  if  is consistent  and any set of lbpt formulas over the same set of individual names
properly containing  is inconsistent  if  is a maximal consistent set of formulas  then we
call it an m cs 
proposition    properties of mcss  if  is an m cs  then 
  is closed under modus ponens  if         then    
 if  is derivable  then    
 for all formulas      or    
 for all formulas          iff    and    
 for all formulas          iff    or    
lemma    lindenbaums lemma  if  is a consistent set of formulas in the language
l lbp t    then there is an m cs   over the same set of individual names such that
     
let                 be an enumeration of lbpt formulas over the same set of individual names
as that in     can be defined as follows 
      
 n     n   n    if it is consistent  otherwise  n     n   n   
   

fiqualitative spatial logics for buffered geometries

    

s

n  n  

for a finite consistent set of formulas   we construct a metric model satisfying a
maximal consistent set     which contains  and is over the same set of individual names
as   as follows  firstly  we equivalently transform   to b      which is a set of basic
quantified formulas  then we construct a set of distance constraints d     from b     
a key concept here is path consistency for a set of distance constraints 
definition    non negative interval  an interval h is non negative  if h         
definition    distance constraint  distance range  a distance constraint is a statement of the form d p  q   g  where p  q are constants representing points  d p  q  stands for
the distance between p  q  and g is a non negative interval  which stands for the distance
range for p  q 
definition    composition  if d    d  are non negative real numbers  then the composition of  d    and  d    is defined as   d      d        d   d     d    d        if g    g  are nonnegative intervals  then their composition is an interval which is the union of all  d    d    
where d   g    d   g    this is 
s
g   g    d  g   d  g   d      d    
it is assumed that a set of distance constraints d contains at most one distance range for
each pair of constants p  q involved in d  and d is closed under symmetry  i e  if d p  q   g
is in d  then d q  p   g is in d 
definition    path consistency  for a set of distance constraints d  for every pair of
different constants p  q involved in d  their distance range is strengthened by successively
applying the following operation until a fixed point is reached 
s   g p  q   g p  q    g p  s   g s  q  
where s is a constant in d  s    p  s    q  and g p  q  denotes the distance range for p  q 
this process is called enforcing path consistency on d  if at a fixed point  for every pair of
constants p  q  g p  q       then d is called path consistent 
in this paper  we say an interval is referred to in the process of enforcing path consistency
on d  if it occurs in d or is involved in the enforcement of the operation g p  q   g p  q  
 g p  s g s  q    in other words  it is used as g p  q   g p  s  or g s  q   a distance constraint
appears in the process of enforcing path consistency on d  if its distance range  an interval 
is referred to in the process of enforcing path consistency on d 
the way of enforcing path consistency on a set of distance constraints defined above is
almost the same as that of enforcing path consistency on a binary constraint satisfaction
problem  csp   renz   nebel        van beek         except that the operation s  
g p  q   g p  q    g p  s   g s  q     is the composition operator for non negative intervals 
definition    is applied instead of k   rij  rij  rik rkj     is the composition operator
   based on d x  z   d x  y    d y  z   property   of definition    

   

fidu   alechina

for relations   the time complexity of the path consistency algorithm for csp is o n     van
beek        mackworth   freuder         where n is the number of variables involved in
the input set of binary constraints  the path consistency algorithm for csp can be adapted
easily for enforcing path consistency on a set of distance constraints  the time complexity of
the resulting path consistency algorithm is also o n     where n is the number of constants
involved in the input set of distance constraints  later in this paper  we will show that
the process of enforcing path consistency on d     terminates  and a fixed point can be
reached in o n     see lemma     
after constructing a set of distance constraints d     from     we prove the metric
model lemma  metric space lemma and path consistency lemma which are stated below 
the notion of path consistency acts as a bridge between the lemmas 
lemma    metric model lemma  let  be a finite consistent set of formulas  and  
be an m cs which contains  and is over the same set of individual names as   if a
metric space satisfies d      then it can be extended to a metric model satisfying    
lemma    metric space lemma  let  be a finite consistent set of formulas  and  
be an m cs which contains  and is over the same set of individual names as   if d    
is path consistent  then there is a metric space    d  such that all distance constraints in
d     are satisfied 
lemma    path consistency lemma  let  be a finite consistent set of formulas  and
  be an m cs which contains  and is over the same set of individual names as   then 
d     is path consistent 
using these three lemmas  we prove the completeness of lbpt  if a finite set of formulas
 is lbpt consistent  then there exists a metric model satisfying it 
proof  if  is lbpt consistent  by the lindenbaums lemma  lemma     there is an m cs
  over the same set of individual names such that       by the path consistency
lemma  lemma    and the metric space lemma  lemma     there is a metric space    d 
such that all distance constraints in d     are satisfied  by the metric model lemma
 lemma     the metric space can be extended to a metric model m satisfying     since
      m satisfies   
the detailed proofs of the metric model lemma  metric space lemma and pathconsistency lemma are provided in section      section     and section     respectively 
note that  in this paper    denotes an m cs which contains a given finite consistent set
of formulas  and is over the same set of individual names as  
    metric model lemma
this section shows how to construct a set of distance constraints d     from     and
presents the proof of the metric model lemma 
by the definition and properties of mcss  definition   and proposition     the following
lemma holds 
   

fiqualitative spatial logics for buffered geometries

lemma   if   is an m cs  then for any pair of individual names a  b occurring in  
exactly one of the following cases holds in    
   case a  b    bp t  a  b   bp t  b  a  
   case a  b    bp t  a  b   bp t  b  a  
   case a  b    bp t  a  b   bp t  b  a  
   case a  b    bp t  a  b   bp t  b  a   n ear a  b  
   case a  b    n ear a  b   f ar a  b  
   case a  b    f ar a  b  
where case a  b  denotes the formula which holds between a  b in each case 
lemma   is proved using lbpt axioms and facts  such as axiom    facts         in the
same way as proving the lemma for lnf  see du et al          the full proof of lemma  
is provided in appendix a 
the construction of a set of distance constraints d     from   has two main steps 
step   for every pair of individual names a  b occurring in   we translate case a  b  into
a set of first order formulas which is equi satisfiable to case a  b   the union of all
such sets of first order formulas is b      hence  b     and  are equi satisfiable   
this step is described by definition   and definition    
step   we construct a set of distance constraints d     from b      this step is described by definitions       
for lbpt formulas  there are first order formulas corresponding to their truth definition
in definition    we use formulas of the form d p  q   g as abbreviations of their equivalent
first order formulas  for example  d p  q         abbreviates d p  q      d p  q    
observe that 
 bp t  a  b  and pa  a pb  b   d  pa   pb           are equi satisfiable  
 n ear a  b  and pa  a pb  b   d  pa   pb             are equi satisfiable 
 f ar a  b  and pa  a pb  b   d  pa   pb           are equi satisfiable 
definition    basic quantified formula  we refer to the first order formulas of the
following forms as basic quantified formulas 
 pa  a pb  b   d  pa   pb    g 
 pa  a pb  b   d  pa   pb    g 
   note that by pa  a pb  b   d  pa   pb            we are actually quantifying over a metric space  in
such sense  it is more precise to say  for example  bp t  a  b  is satisfiable in a metric model  iff
pa  a pb  b   d  pa   pb           is satisfiable over a metric space 

   

fidu   alechina

 pa  a pb  b   d  pa   pb    g 
 pa  a pb  b   d  pa   pb    g 
where g is a non negative interval  the abbreviations of these four forms are defined
as  a  b  g    a  b  g    a  b  g  and  a  b  g  respectively  in other words  for example 
 a  b  g    pa  a pb  b   d  pa   pb    g  
now we translate the formula in each case listed in lemma   into basic quantified
formulas  which will be used to count the number of points needed for interpreting individual
names occurring in  later 
definition     b      for an m cs   over the same set of individual names as   its
corresponding set of basic quantified formulas b     is constructed as follows  for every
pair of individual names a  b  we translate case a  b  into basic quantified formulas 
 translate bp t  a  b   bp t  b  a       a  b           b  a          
 translate bp t  a  b   bp t  b  a       a  b           b  a         
 translate bp t  a  b   bp t  b  a       a  b          b  a          
 translate bp t  a  b   bp t  b  a   n ear a  b       a  b        
 b  a          a  b            b  a           
 translate n ear a  b   f ar a  b       a  b           b  a         
 a  b            b  a           
 translate f ar a  b       a  b           b  a          
where   r  is a fixed margin of error  let names   be the set of individual names
occurring in   then 
s
b       anames   bnames   translate case a  b   
in the following  for a set of basic quantified formulas b      we construct a set of
distance constraints d      and then show that if there is a metric space satisfying d     
then it can be extended to a model of     in other words  we are constructing a metric
over a set of points used to interpret individual names 
the number of points needed for interpreting each individual name depends on the
numbers of different forms of formulas in b      for any individual name a  let us predict
how many particular constants in points a   points assigned to an individual name a  can
be specified by the finite set of formulas about a in b      points a  contains at least
one constant  if a formula in b     says there exists a constant in points a   then this
constant is a particular constant within points a   for any pair of different individual names
a  b  if both  a  b  g  and  b  a  g  are in b      we only count one of them  if  a  b  g 
is in b      we map all the constants in points a  to the same constant in points b   by
lemma   and definition     in b      for any pair of different individual names a  b and
r         we never have r a  b  g    and r a  b  g     where g     g    at the same time 
the cardinality of points a  is specified as follows 
   

fiqualitative spatial logics for buffered geometries

definition     num a  b      and points a   let names   be the set of individual names
occurring in      for any individual name a  names   
num a  b            b  names      g    a  b  g   b        
num a  b            b  names      g    a  b  g   b        
num a  b            b  names      g    b  a  g   b        
then num a  b          num a  b          num a  b          num a  b        
points a  is a set of constants  p a           pna    where n   num a  b      
definition     witness for a formula  a witness for a formula  a  b  g  is a pair of
constants pa  points a   pb  points b  such that d pa   pb    g  a witness for a formula
 a  b  g  or  b  a  g  is a constant pa  points a   such that for any constant pb  points b  
d pa   pb    g  a constant is clean for a formula  if it is not a witness for any other formula 
definition     d      let b     be the corresponding set of basic quantified formulas
of an m cs     for every individual name a in   we assign a fixed set of new constants points a  to it  we construct a set of distance constraints d     as follows  by
iterating through the basic quantified formulas in b     and eliminating quantifiers on new
constants  initially  d           for every individual name a in   for every constant
pa  points a   we add d pa   pa        to d      for every pair of different individual
names a  b  if
  a  b  g   b        then we take clean constants pa  points a   pb  points b   and
add d  pa   pb     d  pb   pa    g to d      so pa   pb become a witness for  a  b  g  
  a  b  g   b        then we take a clean constant pa  points a   for every pb  points b  
we add d  pa   pb     d  pb   pa    g to d      so pa becomes a witness for  a  b  g  
  b  a  g   b        then we take a clean constant pb  points b   for every pa  points a  
we add d  pa   pb     d  pb   pa    g to d      so pb becomes a witness for  b  a  g  
  a  b  g   b        then we take a clean constant pb  points b   for every pa  points a  
we add d  pa   pb     d  pb   pa    g to d      so pb becomes a witness for  a  b  g  
  b  a  g   b        then we take a clean constant pa  points a   for every pb  points b  
we add d  pa   pb     d  pb   pa    g to d      so pa becomes a witness for  b  a  g  
  a  b  g   b        then for every pair of constants pa  points a   pb  points b  
we add d  pa   pb     d  pb   pa    g to d     
for every pair of different constants p  q in d      we add d  p  q    d  q  p         
to d      then repeatedly replace d  p  q    d  q  p   g  and d  p  q    d  q  p   g  with
d  p  q    d  q  p    g   g     until there is only one distance range for each pair of p  q in
d     
   by the definition of       contains the same set of individual names as  

   

fidu   alechina

in definition     for every pair of different individual names a  b  we check whether
 a  b  g   b       holds and check whether  b  a  g   b       holds  because it is possible only one of them holds  for the same reason  we check  a  b  g   b       and
 b  a  g   b       separately  by definition      a  b  g   b       iff  b  a  g   b       
hence we only need to check any one of them  we only check whether  a  b  g   b      
holds  as  a  b  g   b       iff  b  a  g   b       
lemma    when constructing d      for any individual name a  the number of clean
constants needed from points a  is no larger than num a  b      
proof  by definition     for any individual name a   a  a         is in b      by definition     num a  b         
if a is not involved in any formula of the form  a  b  g    a  b  g  or  b  a  g   for any
other individual name b  then by definition     num a  b           by definition     we
need no clean constants from points a  
otherwise  by lemma   and definition     in b      for any pair of different individual
names a  b and r          we never have r a  b  g    and r a  b  g     where g     g    at the
same time  by definition     for each  a  b  g   b      we take one clean constant from
points a   so num a  b      clean constants are needed in total for all formulas of this
form  similarly  num a  b      and  num a  b          clean constants are needed
for formulas of forms  a  b  g  and  b  a  g  respectively  where a  b are different individual
names  we do not need any other clean constant from points a  for formulas in other forms 
by definition     num a  b      is enough  
d     and b     are not equi satisfiable because of the way we assign witnesses for 
formulas  more specifically  for any pair of different individual names a  b  if  a  b  g  is in
b      we map all the constants in points a  to the same constant in points b   in other
words  if b        is the set of formulas resulting from replacing every  a  b  g  in b    
with  b  a  g   then d     and b        are equi satisfiable  since every individual name is
interpreted as a non empty set of constants  if a model satisfies  b  a  g   then it satisfies
 a  b  g   but not vice versa  hence  constructing d     for b        rather than b    
imposes stronger restrictions  i e   a  b  g  in b     is replaced with  b  a  g  in b        
on the metric space compared to that required by     however  later we will show that
if   is consistent  then d     can be satisfied in a metric space by proving the metric
space lemma and path consistency lemma in the following sections 
before proving the metric model lemma  let us look at some important properties of
d      as shown by lemmas        the proof of lemma    is provided in appendix a 
lemma    follows from the proof of lemma    
lemma    for any distance range g occurring in d     
g                                                          
lemma    if p  points a   q  points b   and a    b  then d p  q       is not in d     
lemma    the number of constants in d     is finite 
   

fiqualitative spatial logics for buffered geometries

proof  it is assumed that  is a finite consistent set of formulas over n  a finite number  individual names  by lemma   and definition     b     contains at most f  
 n    n n      formulas over n individual names  by definition     for any individual
name a  num a  b       f   by definition     the number of constants in d     is at
most nf   
the metric model lemma is proved as follows 
lemma    if a metric model satisfies b      then it satisfies    
proof  the lemma follows from two observations  first  by lemma      is entailed by
the set c        case a  b    a  names      b  names       second  by definition    
b     is a translation of truth conditions of c     into first order logic  if a metric model
satisfies b      then it satisfies c      and hence it satisfies     
lemma    metric model lemma  let  be a finite consistent set of formulas  and
  be an m cs which contains  and is over the same set of individual names as   if a
metric space satisfies d      then it can be extended to a metric model satisfying    
proof  suppose a metric space satisfies d      we extend it to a metric model m by
interpreting every individual name a occurring in   as points a   as corresponding set
of constants of size num a  b       definition    and definition      by definition    
any formula of the form  a  a         is satisfied by m   for any pair of different individual names  every    or  formula has a witness  and all  formulas are also satisfied by
m   therefore  m is a metric model of b      by lemma     m is a metric model of     

    metric space lemma
as the process of enforcing path consistency  definition    involves the application of the
composition operator   definition     we present several lemmas in section       to demonstrate the main calculation rules of  and the properties of intervals obtained from composition  in section        we characterize distance constraints in d     and those appearing
in the process of enforcing path consistency on d      using the definitions and lemmas introduced in section       and section        the metric space lemma is proved in
section       
      the composition operator
in this section  we present several lemmas to show the main calculation rules of the composition operator  and the properties of intervals obtained from composition  these lemmas
are important for understanding several proofs in later sections 
lemmas       follow from definition   
lemma    let g    g  be non negative intervals  if d   g   g    then there exist d   g   
d   g  such that d     d   d     d    d    
   

fidu   alechina

lemma     calculation of composition  if  m  n    s  t    m      s      l    r  are
non negative non empty intervals  h    h    h are non negative intervals  then the following
calculation rules hold 
    l    r     l  r  l   r   if l  r 
    l    s  t     s  l  t   l   if s  l 
    l    s  t        t   l   if l   s  t  
    l    s  t     l  t  t   l   if t  l 
    l    s        s  l      if s  l 
    l    s               if s   l 
    m  n    s  t     s  n  t   n   if s  n 
    m  n    s  t        t   n   if  m  n    s  t      
    m  n    s        s  n      if s  n 
     m  n    s               if s   n 
     m       s              
    h       
    h   h    h   h   
     h   h     h    h   h    h   h  
s
s
      k hk    h   k  hk  h   where k  n    
     h   h     h    h   h    h   h   if  h   h        
     h   h     h   h    h   h  
in lemma     rule    is a special case of rule     where k      rule    states that
the composition operation is distributive over non empty intersections of intervals  it is
necessary to require h   h       otherwise the property may not hold  for example  if
h            h            h           then  h   h     h    whilst  h   h    h   h   
                    a similar property is defined by li  long  liu  duckham  and both
       for rcc relations  the proofs for the last three calculation rules are provided in
appendix a  whilst others are more obvious 
for an interval h of the form  l  u    l  u    l  u  or  l  u   we call l the greatest lower
bound of h  represented as glb h   and u the least upper bound of h  represented as lub h  
below we show some interesting properties regarding the composition of intervals and their
greatest lower least upper bounds 
lemma    for any non negative non empty intervals g  h  the following properties hold 
   

fiqualitative spatial logics for buffered geometries

   lub g  h    lub g    lub h  
   glb g  h   max glb g   glb h   
proof  follows from lemma     
a non empty interval h is right closed  iff h    x  y  or h    x  y   h is right open  iff
h    x  y  or h    x  y   h is right infinite  iff h    x    or h    x     h is left closed  iff
h    x  y  or h    x  y   h is left open  iff h    x  y  or h    x  y  
lemma    let g    g    g  be non negative non empty right closed intervals  if g   g   g   
then lub g     lub g      lub g    
proof  suppose g   g   g    since lub g     g    lub g     g   g    by lemma     there
exist d   g    d   g    such that lub g     d    d    since d   lub g     d   lub g    
lub g     lub g      lub g     
lemma    let g    g    g  be non negative non empty intervals  g   g   g    if g  is rightinfinite  then g  or g  is right infinite 
proof  suppose g  is right infinite  since g   g   g    g   g  is right infinite  by definition   and lemma     g  or g  is right infinite  
      distance constraints in d     and ds    
in this section  we characterize the distance constraints which appear in the process of
enforcing path consistency on d     in two main steps 
step   we characterize the intervals involved in d      as well as the composition of those
intervals  this step is described by definition    and lemmas       
step   we introduce the notion of ds     as a set containing all distance constraints
appearing in the process of enforcing path consistency on d      and characterize
the distance constraints in ds      this step is described by definitions       and
lemmas       
definition     primitive  composite  definable intervals  let h be a non negative
interval  h is primitive  if h is one of                                           
       h is composite  if it can be obtained as the composition of at least two primitive
intervals  h is definable  if it is primitive or composite 
lemma    for any non negative interval h  h        h 
proof  follows from definition    
since lemma    holds  we call     an identity interval 
   

fidu   alechina

lemma    if an interval occurs in d      then it is an identity interval or a primitive
interval 
proof  follows from definition    and lemma     
lemma    if h is a definable interval  then h     
proof  follows from definition    and definition    
lemma    if an interval h is definable  then the following properties hold 
   glb h    n  n                  
   lub h      or lub h    m  m  n    
proof  let us prove by induction on the structure of h 
base case  h is primitive  by definition     n                lub h      or m            
inductive step  suppose properties      hold for any interval ht which can be obtained as
the composition of t primitive intervals  where t  n    induction hypothesis   we will
show properties      hold for any interval ht   which can be obtained as the composition of
 t      primitive intervals 
for any ht     there exist an ht and a primitive interval hp such that ht     ht  hp   by
induction hypothesis  glb ht     nt   nt                   lub ht       or lub ht     mt  
mt  n     from the base case  glb hp     np   np                lub hp       or lub hp    
mp   mp             by lemma     lub ht       lub ht     lub hp    thus  property   holds 
by lemma     if
 lub ht     glb hp    then glb ht       glb hp    lub ht   
 lub hp     glb ht    then glb ht       glb ht    lub hp   
 otherwise  glb ht         
since mt     and mp      for glb ht       nt     nt        in each case  nt                
 property   holds   
lemma    if h is an identity or definable interval  then 
   lub h       iff h       
   lub h      iff h         
   glb h       iff h         
proof  follows from lemma     lemma    and its proof  
now we start to characterize the distance constraints which appear in the process of
enforcing path consistency on d     
   

fiqualitative spatial logics for buffered geometries

definition     ds      ds     is a minimal set of distance constraints such that the
following holds 
 any distance constraint in d     is in ds     
 if distance constraints d p  q   h and d q  s   g are in ds      then d p  s   h  g
is in ds     
 if distance constraints d p  q   h and d p  q   g are in ds      then d p  q   h  g
is in ds     
where p  q  s are constants in d     
in the definition above  ds     is required to be minimal  such that any interval
involved in ds     is either in d     or is obtained by applying composition or intersection
operations on intervals in d      for generality  we do not restrict p  q  s to be different
constants  for example  it is possible p   q 
lemma    if a distance constraint appears in the process of enforcing path consistency on
d      then it is in ds     
proof  follows from definition    path consistency  and definition     
ds     covers all the distance constraints appearing in the process of enforcing pathconsistency on d      however  not every distance constraint in ds     necessarily
appears in the process of enforcing path consistency on d      for example  if d    
contains exactly one distance constraint d p  p          then by definition     d p  p  
       is in ds      so is d p  p       n   for any n  n      but by definition    d p  p  
       does not appear in the process of enforcing path consistency  it is easy to see that
ds     is an infinite set 
the concept of ds     is similar to the concept of distributive subalgebra defined by
li et al          as the composition operation distributes over non empty intersections of
intervals involved in ds      rule    in lemma      however  in our work  the composition
operation is defined for intervals rather than relations 
lemma    if a distance constraint d p  q   h is in ds      then h is a non negative
interval 
proof  if a distance constraint d p  q   h is in d      by lemma     h is a non negative
interval  by definitions      and the definition of intersection  applying composition or
intersection on non negative intervals  we obtain non negative intervals  by definition    
h is a non negative interval  
differing from the previous version  du   alechina      b   the following definitions
and lemmas are restricted to non empty intervals 
recall that a non empty interval h is right closed  iff h    x  y  or h    x  y   h is
right open  iff h    x  y  or h    x  y   h is right infinite  iff h    x    or h    x     h is
left closed  iff h    x  y  or h    x  y   h is left open  iff h    x  y  or h    x  y  
   

fidu   alechina

lemma    if a distance constraint d p  q   h is in ds     and h      then h is either
right infinite or right closed 
proof  let n denote the total number of times of applying composition or intersection to
obtain h  n     we prove by induction on n 
base case  n      then d p  q   h is in d      by lemma     h is either right infinite
or right closed  inductive step  suppose the statement holds for any non empty h which
can be obtained by applying composition or intersection no more than n times  induction
hypothesis   we will show it also holds for any non empty h which can be obtained by
applying composition or intersection  n      times 
 if the last step to obtain h is intersection  then by definition     there exist non empty
h    h  such that h   h   h    by induction hypothesis  for each hi   i          hi is
either right infinite or right closed  by intersection rules  h is either right infinite or
right closed 
 if the last step to obtain h is composition  then by definition     there exist nonempty h    h  such that h   h   h    by induction hypothesis  for each hi   i          hi
is either right infinite or right closed  by composition rules  lemma      h is either
right infinite or right closed 


lemma    for a distance constraint d p  q   h in ds     and h      if glb h        then
h is left open 
proof  let n denote the total number of times of applying composition or intersection to
obtain h  n     we prove by induction on n 
base case  n      then d p  q   h is in d      by lemma     if glb h        then
h is left open  inductive step  suppose the statement holds for any non empty h which
can be obtained by applying composition or intersection no more than n times  induction
hypothesis   we will show it also holds for any non empty h which can be obtained by
applying composition or intersection  n      times 
 if the last step to obtain h is intersection  then by definition     there exist nonempty h    h  such that h   h   h    by induction hypothesis  for each hi   i         
if glb hi         then hi is left open  by intersection rules  if glb h        then h is
left open 
 if the last step to obtain h is composition  then by definition     there exist non empty
h    h  such that h   h   h    if glb h        then by composition rules  lemma     
h  h      suppose lub h     glb h     then glb h    glb h   lub h     by lemma   
and glb h        we have glb h       thus glb h      lub h     by lemma     lub h    
   thus glb h         by induction hypothesis  h  is left open  by composition rules
 lemma      h is left open  similarly  this also holds if lub h     glb h    
   

fiqualitative spatial logics for buffered geometries


for a distance constraint d p  q   h in ds      by definition     h is obtained by
applying the composition and or intersection operations n    times on intervals occurring
in d      as applying the intersection operation does not generate any new bound  the
greatest lower least upper bound  and its openness  of h must be the same as that of an
interval in d     or the composition of intervals in d      we formalize this rationale
as the concepts of left definable and right definable to characterize the distance constraints in ds      later  we will show that every distance constraint d p  q   h  h      in
ds     is left definable and right definable  left definable and right definable are key
concepts for proving the path consistency lemma  as they establish the correspondences
between a distance constraint in ds     and a sequence of distance constraints in d     
if a non empty interval h is left open  then its greatest lower bound is represented as
glb  h   if h is left closed  then its greatest lower bound is represented as glb   h   if h is
right open  then its least upper bound is represented as lub  h   if h is right closed  then
its least upper bound is represented as lub   h  
definition     left definable  a distance constraint d p    pn    hs  n      is leftdefinable  iff hs     and there exists a sequence of distance constraints d pi   pi      hi
     i   n  in d      such that for m   h        hn    the following holds 
   if hs is left open  then m is left open and glb   m    glb   hs   
   if hs is left closed  then m is left closed and glb    m    glb    hs   
   hs  m 
definition     right definable  a distance constraint d p    pn    hs  n      is rightdefinable  iff hs     and there exists a sequence of distance constraints d pi   pi      hi
     i   n  in d      such that for m   h        hn    the following holds 
   if hs is right open  then m is right open and lub   m    lub   hs   
   if hs is right closed  then m is right closed and lub    m    lub    hs   
   hs  m 
it is important to distinguish the definition of left definable right definable distance
constraints  definitions    and     from definition     definable intervals   for example  if
distance constraints d p    p         and d p    p         are in d      then d p    p         is
left definable and right definable  but     is not a definable interval  if distance constraints
d p    p           and d p    p           are in d      then d p    p            is leftdefinable  but        is not a definable interval 
lemma    let h  g be non negative intervals  if distance constraints d p  q   h and
d q  s   g are left definable and right definable  then d p  s   h  g is left definable and
right definable 
   

fidu   alechina

proof  since d p  q   h and d q  s   g are right definable  then by definition     h     
g      by definition    h  g      by definition     in d      there exist a sequence of
distance constraints d p  x     h         d xn    q   hn  for d p  q   h and a sequence of
distance constraints d q  y     g         d yt    s   gt  for d q  s   g respectively satisfying
the three properties  let us take the union of the two sequences as a new one  this is 
d p  x     h         d xn    q   hn    d q  y     g         d yt    s   gt    by composition
rules  lemma      the new sequence satisfies the properties in definition    for d p  s   hg 
hence  d p  s   h  g is right definable 
by composition rules  lemma      if h  g      then glb   h  g       we can use the
same new sequence above  let m     h        hn     m     g        gt     by definition    
h  m    g  m    then m   m       therefore  glb   m   m         by definition   
h  g  m   m    by definition     d p  s   h  g is left definable 
if h  g     let us suppose glb h   lub g   since d p  q   h is left definable and
d q  s   g is right definable  by definitions    and    respectively  in d      there exist
a sequence of distance constraints for d p  q   h and a sequence of distance constraints
for d q  s   g  satisfying the corresponding properties  then by composition rules  lemma
     the union of the two sequences satisfies the properties in definition    for d p  s   hg 
hence  d p  s   h  g is left definable  similarly  we can show d p  s   h  g is left definable 
if glb g   lub h   
lemma    let h  g be non negative intervals  if distance constraints d p  q   h and
d p  q   g are left definable and right definable  h  g      then d p  q   h  g is leftdefinable and right definable 
proof  as applying intersections does not generate any new bound and h  g      the
left right bound of h  g is the same as that of h or g  if the left bound of h  g is the
same as that of h  then by definition     the same sequence used for showing d p  q   h is
left definable can be used to show d p  q   h  g is left definable  other cases are similar  
lemma    if a distance constraint d p  q   h is in ds     and h      then it is leftdefinable and right definable 
proof  let n denote the total number of times of applying composition or intersection to
obtain h  n     we prove by induction on n 
base case  n      then d p  q   h is in d      by definitions    and     d p  q   h is
left definable and right definable 
inductive step  suppose the statement holds for any non empty h which can be obtained
by applying composition or intersection no more than n times  induction hypothesis   we
will show it also holds for any non empty h which can be obtained by applying composition
or intersection  n      times  by definition     the last operation to obtain h is either
composition or intersection  in the former case  there exist d p  s   g  and d s  q   g  in
ds      such that g   g    h  as h      by definition    gi      i          since g 
and g  are obtained by applying composition or intersection no more than n times  then by
induction hypothesis  d p  s   g  and d s  q   g  are left definable and right definable  by
   

fiqualitative spatial logics for buffered geometries

lemma     d p  q   h is left definable and right definable  in the latter case  there exist
d p  q   g  and d p  q   g  in ds      such that g   g    h  as h      by intersection
rules  gi      i          by induction hypothesis  d p  q   g  and d p  q   g  are leftdefinable and right definable  by lemma     d p  q   h is left definable and right definable 

for generality  we do not exclude the possibility that d p  q    is in ds      however 
it follows from the proof of the path consistency lemma in section     that d p  q    is
not in ds      alternatively  for a direct proof  see lemmas    and    in appendix c 
      proving the metric space lemma
in the following  we show there is a metric space satisfying d      if d     is pathconsistent  metric space lemma   firstly  we show that the process of enforcing patchconsistency on d     terminates  by lemma     the number of constants in d     is
finite  let us suppose the number of constants in d     is t  n    
lemma    let t  n   be the number of constants in d      for any non empty
right closed interval h referred to in the process of enforcing path consistency on d     
lub   h    t 
proof  if a non empty right closed interval h occurs in d      then by lemma    
lub   h       t 
otherwise  it is generated from the application of composition and or intersection operators by definition    composition creates larger least upper bounds  lemma      whilst
intersection does not  since h is right closed  lub   h  is obtained by composing right closed
intervals only  lemma      over t constants  the longest chain involves  t     intervals 
lub   h  is maximal if we use all of these  t     intervals and the least upper bound of each
interval is    thus  lub   h    t  
lemma    let t  n   be the number of constants in d      enforcing path consistency
on d      a fixed point can be reached in o t    
proof  by definition    lemmas    and the fact that intersection does not generate new
bounds  for any interval s appearing in the process of enforcing path consistency on d     
the following properties hold 
   glb s    n  n                  
   lub s      or lub s    m  m  n    
for any interval h appearing in d      by enforcing path consistency  definition     h can
only become an h   h  by lemma     h      by lemma     h is either right closed or
right infinite  h  is   right closed or right infinite 
 if h is right closed  then h     or h  is right closed  if h  is right closed  then by
lemma     lub h     lub h      by properties       there are finitely many
possibilities for h   
   

fidu   alechina

 if h is right infinite  then h  is   right closed or right infinite 
 if h  is right closed  then by lemma     lub h      t  by properties       there
are finitely many possibilities for h   
 if h  is right infinite  then by property    there are finitely many possibilities for
its greatest lower bound  thus for h   
since in each case  there are finitely many possibilities for h    a fixed point is always reached 
suppose the widest non negative interval       appears in the process of enforcing
path consistency on d      in the worst case  firstly        is strengthened to     u   where
u   t  by lemma      then     u  is strengthened by  each time  hence        can be
strengthened at most   t      times  over t constants  by definition     there are o t   
distance constraints in d      for any interval h appearing in d      h         hence h
can be strengthened at most   t      times  therefore  the total time of strengthening all
the distance constraints is o t     
the following lemma shows how to construct a metric space from d      it is used to
prove the metric space lemma 
lemma    let t  n   be the number of constants in d      df      be a fixed point of
enforcing path consistency on d      if d     is path consistent  ds      is obtained from
df      by replacing every right infinite interval with   t   every right closed interval h
with  lub h    then ds      is path consistent 
proof  suppose d     is path consistent  by lemma     df       ds      by definition    for any interval h appearing in df       h      by lemma     h is either right infinite
or right closed  to prove ds      is path consistent  we only need to show that for any three
distance ranges   npq     nqs     nps   in ds      over three constants p  q  s  we have
   npq  nqs   nps  
   nqs  npq   nps  
   nps  npq   nqs  
let hpq   hqs   hps denote the corresponding distance ranges of  npq     nqs     nps   respectively
in df       by definition    we have
 hpq  hqs  hps  
 hqs  hpq  hps  
 hps  hpq  hqs  
we prove ds      is path consistent by cases 
 if every hi  i   pq  qs  ps   is right closed  then ni   lub hi    by lemma        
hold 
   

fiqualitative spatial logics for buffered geometries

 otherwise  not all of them are right closed  by lemma     at least two of them are
right infinite 
 if all of them are right infinite  then ni    t  since  t   t    t      hold 
 otherwise  only one of them is right closed  let hpq be right closed  then 
npq   lub hpq    nqs    t  nps    t  by lemma    and   r    lub hpq   
 t    t  by lemma     lub hpq       since lub hpq      t    t and
 t   t   lub hpq        hold 

lemma    metric space lemma  let  be a finite consistent set of formulas  and  
be an m cs which contains  and is over the same set of individual names as   if d    
is path consistent  then there is a metric space    d  such that all distance constraints in
d     are satisfied 
proof  suppose d     is path consistent  let  be the set of constants in d      which is
used to interpret individual names occurring in   as shown in definition     if      then
it is trivial  let us assume       the number of constants in  is denoted by t  n     by
lemma     a fixed point df      can be reached by enforcing path consistency on d     
let ds      be a set of distance constraints obtained from df      by replacing every
right infinite interval with   t   every right closed interval h with  lub h    since every
distance constraint in ds      is of the form d p  q    r   where r  r    and d p  q    r 
is equivalent to d p  q    r  a metric  distance function  is defined over   by definition   
and lemma     for any pair of constants x  y  if x   y  then d x  y      holds in ds      
if x    y  then d x  y        holds in ds       thus  we have d x  y      iff x   y in
ds       by definitions    and    for any pair of constants x  y  d x  y    d y  x  holds
in ds       by lemma     ds      is path consistent  thus  for any constants x  y  z 
d x  z   d x  y    d y  z  holds in ds       by definition    the    d  of ds      is a
metric space such that all distance constraints in d     are satisfied  

    path consistency lemma
this section proves the path consistency lemma by contradiction  supposing that d    
is not path consistent  we examine every case where the first  interval is obtained by
enforcing path consistency  in each case  we show that  is derivable from the corresponding
lbpt formulas in   using lbpt axioms  this contradicts the assumption that   is
consistent  lemma    is used to generate all possible cases and make sure no duplicated ones
are generated  by using lemma     the proof of the path consistency lemma is largely
simplified  compared to the previous version  du   alechina      b  
lemma    let g  h be non negative intervals  g  h    iff  g  h          
proof  if g  h      then by definition        g  h  
if     gh   then by lemma     there exist d   g  d   h such that      d  d     d   d    
thus  d    d    therefore  g  h     
   

fidu   alechina

since g  h     iff     g  h   by contraposition we get g  h    iff  g  h           
knowing a least upper bound or a greatest lower bound of a definable interval h  lemmas       show all possible ways in which h can be obtained as the composition of primitive
intervals  lemma    and lemma    are proved below  proofs of the other lemmas are similar and omitted 
lemma    if an interval h is definable  lub h       then h is a primitive interval       
or h is obtained as the composition of two       
proof  if h is primitive  then by definition     h          
if h is composite  then by definition     there exist two definable intervals g    g  such that
g   g    h  by lemma     lub g      lub g         by lemma     lub g       lub g      
thus lub g        lub g        by lemma     h                 

lemma    if an interval h is definable  lub h       then h is obtained as the composition
of       and        or as the composition of three       
lemma    if an interval h is definable  lub h       then h is a primitive interval        
or h is obtained as the composition of two         as the composition of two       and one
       or as the composition of four       
lemma    if an interval h is definable  glb h       then h is obtained as the composition
of       and       
proof  by definition     h cannot be primitive 
since h is composite  then by definition     there exist two definable intervals g    g  such
that g   g    h  g   g      otherwise  by lemma     glb h      
without loss of generality  let us suppose lub g     glb g     by lemma     glb g    
lub g         by lemma     glb g        lub g       thus glb g         lub g        by
lemma     h is obtained as the composition of       and        
lemma    if an interval h is definable  glb h       then h is a primitive interval      
or         or h is obtained as the composition of        and       or as the composition
of two       and one       
lemma    if an interval h is definable  glb h      then h is a primitive interval      
or h is obtained as the composition of       and        as the composition of       and
        as the composition of one        one        and one        or as the composition
of three       and one       
lemma    if an interval h is definable and left open  glb h       then h is obtained in
exactly the following ways 
 as the composition of       and      
   

fiqualitative spatial logics for buffered geometries

 as the composition of        and       
 as the composition of two       and one       
 as the composition of        and        
 as the composition of two       and one        
 as the composition of        and       
 as the composition of two        and one       
 as the composition of two        one        and one       
 as the composition of four       and one       
in our previous work  du et al         du   alechina      b   we presented a slightly
different way to prove the path consistency lemma for lnf and lbpt respectively  the
first empty interval is obtained using the strengthening operator  this is  g    g   g      
and gi      where i             gi may be     or a primitive interval  or it can be written as
xi   yi  zi    where each of xi   yi   zi may not be an identity or primitive internal also  in the
latter case  since gi   xi   yi  zi        xi   yi   zi are all not empty  since the composition
operation is distributive over non empty intersections of intervals  rule    in lemma     
we use rule    repeatedly to rewrite g    g   g    until every interval is an identity or
primitive interval  the final form is h        hn     n      where hx      x  n  is
    or a definable interval  thus there exist two intervals hi   hj      i  n      j  n 
i    j  such that hi  hj     then we look at all the different combinations such that
lub hi    glb hj    there are exactly    such combinations  in this paper  the proof of the
path consistency lemma is largely simplified  it shows that it is sufficient to examine  
rather than    combinations 
lemma    path consistency lemma  let  be a finite consistent set of formulas  and
  be an m cs which contains  and is over the same set of individual names as   then 
d     is path consistent 
proof  suppose d     is not path consistent  then by definitions       and lemma    
d p  q    is in ds      for some constants p  q  by lemma     for any distance range g
occurring in d      g      by definitions        and intersection rules  the last operation
to obtain the first  interval is intersection  by definition     there exist d p  q   g  and
d p  q   g  in ds      g       g       and g   g      by lemma     g    g  are
non negative intervals  by lemma     g   g     iff  g   g            
by definition    and definition     d q  p   g  is in ds      since d p  q   g  is in
ds      by definition     d p  p    g   g    is in ds      by definition    g   g      
by lemma     d p  p    g   g    is left definable and right definable  let h   g   g   
since d p  p   h is left definable  then by definition     there exists a sequence of distance
constraints d pi   pi      hi      i   n  in d      such that p   p    pn and for h   
h        hn    h and h  have the same greatest lower bound  including both value and
   

fidu   alechina

openness  and h  h    by definition     lemmas    and     h  is an identity or definable
interval  by lemma     glb h                     therefore   g   g            iff one of
the following holds 
 glb h               
 h is left open and glb  h      
we will check whether  can be derived in every case using axioms  or derivable facts  
by axiom   and axiom    n ear and f ar are both symmetric 
   glb h      we look at all the different ways where h  is obtained from a sequence of
distance constraints d pi   pi      hi      i   n  in d     such that p   p    pn and
h    h        hn   see definition      as every hi is     or a primitive interval  by
lemma      lemma    specifies all the different ways to obtain h   
 a  h  is a primitive interval        by definition     d p    pn          is in
d     and n      as p   p    pn   d p  p         is in d      suppose
p  points a  for an individual name a in   by the proof of lemma          
only can come from formulas of the form  x  y         where x  y are individual names  by definition      x  y        only can come from bp t  x  y  
since d p  p         is in d     and p  points a   bp t  a  a       by
axiom    bp t  a  a    
 b  h  is obtained as the composition of       and       or as the composition of
      and        
by the proof of lemma    and definition     bp t  a  b     or bp t  b  a      
n ear a  b     and n ear b  a      
by fact     bp t  x    x     n ear x    x        x    x       a  b  
 c  h  is obtained as the composition of one        one        and one       
by the proof of lemma    and definition     bp t  a  b     or bp t  b  a      
n ear b  c       n ear c  b       f ar c  a       f ar a  c       by
fact     bp t  x    x   n ear x    x   f ar x    x        x    x    x       a  b  c  
 d  h  is obtained as the composition of three       and one        
by the proof of lemma    and definition     we have three bp t and one
f ar over four individual names a  b  c  d  bp t refers to either bp t  x  y  or
bp t  y  x   some cases  for example  in     we have bp t  a  b   bp t  c  b  
bp t  d  c  and f ar a  d   are not valid  because different constants will be
taken from the same points b   for an individual name b  by definition      as
a consequence  in an invalid case  a sequence consisting of distance constraints
d pi   pi      hi      i   n  p   p    pn   cannot exist in d      we only need
to consider all valid cases  which are listed below 
i  bp t  x    x     bp t  x    x     bp t  x    x     f ar x    x     where
 x    x    x    x       a  b  c  d   by fact     bp t  x    x     bp t  x    x    
bp t  x    x     f ar x    x      
ii  bp t  x    x     bp t  x    x     bp t  x    x     f ar x    x     where
 x    x    x    x       a  b  c  d   by fact     bp t  x    x     bp t  x    x    
bp t  x    x     f ar x    x      
   

fiqualitative spatial logics for buffered geometries

cases     below use similar arguments  in the following proof  bp t refers to either
bp t  x  y  or bp t  y  x   whichever makes the corresponding case valid   n ear
and f ar are symmetric  thus the order of x  y does not matter 
   glb h       by definition    and lemma     lemma    specifies all the different
ways to obtain h  from a sequence of distance constraints d pi   pi      hi      i   n 
in d     
 a  h  is a primitive interval       or        
n ear a  a   using axiom   and fact    
 b  h  is obtained as the composition of        and         
one n ear and one f ar  using fact    
 c  h  is obtained as the composition of two       and one        
two bp t and one f ar  using facts    and    
   glb h       by definition    and lemma     lemma    specifies all the ways to
obtain h  from a sequence of distance constraints d pi   pi      hi      i   n  in
d      by lemma     h  is obtained as the composition of       and        
one bp t and one f ar  using fact    
   glb h       by definition    and lemma     lemma    specifies all the ways to
obtain h  from a sequence of distance constraints d pi   pi      hi      i   n  in
d      by lemma     h            f ar a  a   using axiom   and fact    
   glb  h       by definition    and lemma     lemma    specifies all the ways to
obtain h  from a sequence of distance constraints d pi   pi      hi      i   n  in
d     
 a  h  is obtained as the composition of       and       by definition     ensuring
no different constants taken from the same points x  
bp t  x    x       and bp t  x    x          x    x       a  b  
bp t  x    x     bp t  x    x      
 b  h  is obtained as the composition of        and       or as the composition of
       and        
one n ear and one n ear  using axiom   
 c  h  is obtained as the composition of two       and one       or as the composition of two       and one        
two bp t and one n ear  using axioms    and    
 d  h  is obtained as the composition of        and       
one f ar and one f ar  using axiom   
 e  h  is obtained as the composition of two        and one       
two n ear and one f ar 
this case is invalid  by definition     d     contains d pa   pb            d pb   pc   
       and d pa   pc           where pa  points a   pb  points b   pc 
points c   for individual names a  b  c  by definitions    and     d pa   pb          
and d pb   pc           cannot come from n ear a  b  and n ear b  c  in    by
   

fidu   alechina

the proof of lemma     it is clear that they cannot come from other formulas as
well   because two different constants will be taken from points b  as witnesses
for  a  b          and  b  c          respectively 
 f  h  is obtained as the composition of two        one        and one       
two bp t   one n ear and one f ar  using axioms    and    
 g  h  is obtained as the composition of four       and one       
four bp t and one f ar  using facts       
in each valid case   is derivable using the corresponding axioms or facts  which contradicts
the assumption that   is consistent  therefore  d     is path consistent  
there is an alternative way to prove the path consistency lemma  which we believe is
longer and more complicated than the one presented in this paper  but since it may provide
additional intuitions to the reader  we sketch it in appendix b 

   decidability and complexity of lbpt
in this section  we establish the complexity of the lbpt satisfiability problem  the complexity of the lnf lnfs satisfiability problem can be established in a similar way  the
complexity of these satisfiability problems is important  as it is related to the complexity
of the problem of finding inconsistencies  which is the basis of our approach to debugging
matches between geospatial datasets 
definition     size of a formula  the size of a lbpt formula s   is defined as follows 
 s bp t  a  b        s n ear a  b        s f ar a  b       
 s         s   
 s           s     s   
where a  b are individual names     are formulas in l lbp t   
as a set of lbpt formulas s and the conjunction of all formulas in s are equi satisfiable 
the combined size of lbpt formulas in a set s is defined as the size of the conjunction of
all formulas in s 
next we prove theorem   for lbpt  the satisfiability problem for a finite set of lbpt
formulas in a metric space is np complete 
proof  np hardness of the lbpt satisfiability problem follows from np hardness of the
satisfiability problem for propositional logic  which is included in lbpt 
to prove that the lbpt satisfiability problem is in np  we show that if a finite set of
lbpt formulas  is satisfiable  then we can guess a metric model for  and verify that this
model satisfies   both in time polynomial in the combined size of formulas in  
suppose  is a finite set of lbpt formulas  and the number of individual names in  is
n  the completeness proof shows that  if  is satisfiable  it is satisfiable in a metric model
   

fiqualitative spatial logics for buffered geometries

m of size which is polynomially bounded by the number of individual names in   to recap
the construction of the metric model for   first we construct b      the corresponding set
of basic quantified formulas from an mcs   containing   and then construct a model for
b      by definition     the number of formulas in b     is at most f    n    n n      
by definitions    and     to every individual name a in   we assign a fixed set of new
constants  points a     p a           pxa    where x   num a  b       since x  f   the number of
constants in m is at most t   nf   by lemma    and proofs of the metric space lemma  in
such a model m   every value assigned by the distance function is of the form m  m  n   
m   t 
we guess a metric model m like this  let s be the combined size of formulas in   then
n   s  to every individual name a in   we assign  p a           pxa    where x    s    this results
in a set of constants   the size of which is    s    to every pair of constants p  q in   we
assign m to d p  q   where m  n    m     s    to verify that    d  is a metric space  by
definition    it is in o s    
to verify that m satisfies   we need to verify that it satisfies the conjunction of all formulas in   for any r a  b   where r   bp t  n ear  f ar   a  b are individual names  to
verify that r a  b  is satisfied  it takes time which is polynomial in  points a     points b   
thus it is in o s     hence  verifying that m satisfies  can be done in o s     
in section    we mentioned that  acts as a scaling factor of a metric model  this is
stated as lemma    and follows from the proofs of the completeness theorem and theorem   
the proof for lbpt is provided below  the proof for lnf lnfs is similar 
lemma    a finite set of lnf lnfs lbpt formulas is satisfiable in a metric model
where   r    iff it is satisfiable in a metric model when      
proof  for lbpt  suppose  is a finite set of lbpt formulas  the number of individual
names in  is n and the combined size of formulas in  is s  by definition     n   s 
the completeness proof shows that  if  is satisfiable  it is satisfiable in a metric model
m      d  i    constructed as shown in section     and section      by definition    
to every individual name a in   we assign  p a           pxa    where x   num a  b         s   
this results in a set of constants   the size of which is    s    to every constant p in  
we assign d p  p       by definition    and lemma     to every pair of different constants
p  q in   we assign m to d p  q   where m  n     m     s    as m is a metric model  by
definition   and the proof of the metric space lemma  for any x  y  z    we have
   d x  y       iff x   y 
   d x  y    mxy   iff d y  x    mxy  
   if d x  z    mxz   d x  y    mxy   d y  z    myz   then mxz   mxy    myz  
if m satisfies   by definition    the following holds 
m    bp t  a  b  iff pa  i  a  pb  i  b    d  pa   pb           
m    n ear a  b  iff pa  i  a  pb  i  b    d  pa   pb             
   

fidu   alechina

m    f ar a  b  iff pa  i  a  pb  i  b    d  pa   pb           
m     iff m      
m       iff m     and m     
where a  b are individual names     are formulas in l lbp t   
by setting          d  is still a metric space  as the following holds for any x  y  z   
   d x  y      iff x   y 
   d x  y    mxy   iff d y  x    mxy  
   if d x  z    mxz   d x  y    mxy   d y  z    myz   then mxz  mxy   myz  
by setting       the definitions of bp t   n ear and f ar change accordingly as well 
one can easily see that m still satisfies  after replacing every  by   
similar  if we have a metric model with       we can obtain a metric model with
  r  by multiplying every distance value m by   one can easily see that m still satisfies  after multiplying all distance values in m by   and multiplying all greatest lower
bounds and least upper bounds of intervals in the truth definitions of bp t   n ear and
f ar by   

   validating matches using spatial logic
the spatial logics ln f   ln f s and lbp t can be used to verify consistency of sameas
and partof matches between spatial objects from different geospatial datasets  if every
spatial object has a point geometry  then we apply ln f   otherwise  we apply ln f s or
lbp t   lbp t reasoning has been used together with description logic reasoning in a
geospatial data matching system matchmaps  du  nguyen  alechina  logan  jackson   
goodwin        du         lbp t reasoning and description logic reasoning complement
each other in the sense that lbp t reasoning verifies matches regarding spatial information
whilst description logic reasoning verifies matches regarding classification information  the
unique name assumption and a stronger version of it  in the following  we describe how
lbpt is used for debugging matches 
a dedicated lbpt reasoner integrated with an assumption based truth maintenance
system  atms   de kleer        was developed as a part of matchmaps  it implements
lbpt axioms and the definition beq a  b   bp t  a  b   bp t  b  a  as a set of inference
rules  for efficiency reasons  there is no one to one correspondence between rules and axioms  to speed up matching and avoid cycles  facts such as n ear a  b  are stored for only
one order of a and b  and symmetry axioms are removed  each of the remaining axioms
involving any symmetric relation gives rise to several rules  to compensate for the removal
of symmetry  for example  the axiom
bpt  b  a   near b  c   bpt  c  d    far d   a 
also gives rise to a rule corresponding to the following implication 
bpt  b  a   near c  b   bpt  c  d    far d   a 
   

fiqualitative spatial logics for buffered geometries

 with n ear c  b  instead of n ear b  c    however the set of rules is trivially equivalent
to the set of axioms 
possible matches of the form sameas a  b  and partof  a  b   a is partof b  are generated as assumptions  to be withdrawn if they are involved in a derivation of a contradiction
in description logic or in lbpt  in order to apply the lbpt reasoning  sameas a  b  is
replaced by beq a  b   and partof  a  b  is replaced by bp t  a  b   these substitutions do
not affect correctness of the matching results of matchmaps  as matchmaps adopts the definitions of sameas and partof such that sameas a  b  entails beq a  b  and partof  a  b 
entails bp t  a  b   n ear a  b  and f ar a  b  facts are generated for those objects a  b
in the same dataset that are involved in some matches across the two datasets  there is
an object c in the other dataset such that beq a  c   bp t  a  c  or bp t  c  a  holds  and
similarly for b  
the lbpt reasoner derives new formulas by applying inference rules to previously
derived formulas  and the atms maintains dependencies between derived consequences and
a set of assumptions  corresponding to possible matches   in particular  it maintains all
minimal sets of assumptions responsible for the derivation of   false   referred to as nogoods
in atms terminology  such minimal sets of assumptions responsible for a contradiction
are used to decide which matches are wrong and should be withdrawn 
in experiments  the lbpt reasoner with an atms was used to validate matches between
spatial objects from osm data  building layer  and osgb mastermap data  address layer
and topology layer   du et al          the study areas are in city centres of nottingham uk
and southampton uk  the nottingham data was obtained in       and the southampton
data in       the numbers of spatial objects in the case studies are shown in table   

nottingham
southampton

osm spatial objects
   
    

osgb spatial objects
     
    

table    data used for evaluation

the initial matches are generated by the matching method implemented in matchmaps 
the detailed matching method is provided by du et al          the method consists
of two main steps  matching geometries and matching spatial objects  a spatial object
in a geospatial dataset has an id  location information  coordinates and geometry  and
meaningful labels  such as names or types  and represents an object in the real world  a
geometry here refers to a point  a line or a polygon  which is used to represent location
information in geospatial datasets 
the geometry matching requires a level of tolerance  as some difference in the geometry
representation of a spatial object is to be expected in different datasets  after discussing
with domain experts in geospatial science  we decided to apply the same level of tolerance
for the matching method and the spatial logic used in matchmaps  in the experiments
described by du et al          the level of tolerance for the geometry matching was set to
be    meters  based on the published estimate about the positional accuracy of osm data 
the osm positional accuracy was estimated to be about    meters in uk  haklay        
in our more recent work  du et al          we analysed how the level of tolerance affects
   

fidu   alechina

the precision and recall of matching results for the same geographic area in nottingham
 the same data as shown in the first row of table    using    different levels of tolerance
within a range of   to    meters  it shows that  for the nottingham case     meters is a
good estimate  though it is not the optimal value 
following the first step of the matching method  we first aggregate adjacent single geometries  such as those of shops within a shopping center  then establish correspondences
between aggregated geometries using geometry matching  in the second step  we match
spatial objects located on these corresponding aggregated geometries by comparing the
similarity of names and types of spatial objects in several different cases  one to one  manyto one and many to many   the most difficult case is when there is a match between
two aggregated geometries which contain objects  a            an   in one dataset and objects
 b            bk   in the other dataset  many to many matching case   when we cannot decide
the exact matches automatically using names and types of objects  we generate all matches
which are possibly correct between the objects in the two sets  for each pair ai   bj with similar labels  we generate sameas ai   bj    partof  ai   bj    partof  bj   ai    we apply reasoning in
lbpt and description logic to verify consistency of these matches  the use of description
logic reasoning is described by du        

figure    examples of using lnfs and lbpt for validating matches
if a minimal set of statements involved in a contradiction contains more than one
retractable assumption  a domain expert is needed to decide the correctness of the retractable assumptions and remove the wrong one s  to restore consistency  location information is visualized and provided to help domain experts make such decisions  as
shown in figure    a    b    c    d   dotted  are from osgb data and a    b    c    d   solid  are
from osm data  in the left example  by lnfs axiom    or by lbpt axiom    and
beq a  b   bp t  a  b   bp t  b  a    a minimal set of statements for deriving an inconsistency consists of beq a    a     beq b    b     n ear a    b     f ar a    b     it is clear that
beq b    b    is wrong  as n ear a    b    and f ar a    b    are facts  in the right example 
bp t  d    d    is wrong  because it contradicts bp t  c    c     n ear c    d     f ar c    d    by
lbpt axiom     as a consequence  the sameas and partof matches corresponding to
beq b    b    and bp t  d    d    respectively are also incorrect 
table   shows the numbers of nogoods generated by the lbpt reasoner with an atms 
as mentioned earlier  nogoods are justifications for false  the minimal sets of statements
from which a contradiction is derivable  the number of interactions is the number of
times users are asked to take actions or use strategies to resolve problems  a strategy is
a heuristic which allows users to retract all similar statements at a time  for example 
   

fiqualitative spatial logics for buffered geometries

nottingham
southampton

nogoods
   
   

retracted beq bpt
  
   

retracted sameas partof
    
   

interactions
 
 

table    lbpt verification of matches

retracting partof  o  x  for any x differing from an object o   as a result of lbpt reasoning
and removal of beq and bpt assumptions  we withdraw      sameas partof assumptions
for the nottingham case and     sameas partof assumptions for the southampton case 
with the lbpt validation of matches  matchmaps achieved high precision        and
recall        for both nottingham and southampton cases 
as described in our previous work  du  alechina  hart    jackson         matchmaps
was used by    experts from the university of nottingham and ordnance survey of great
britain to match about     buildings and places in southampton  a graphical user interface of matchmaps is provided allowing users to take different types of actions to remove
wrong matches  the number of actions and the decision time of users are recorded  the
precision and recall of the matching results are compared to those obtained without using any user involved verification  experimental results showed that by using reasoning in
lbpt and description logic  the precision and recall of matches generated by matchmaps
were improved on average by    and    respectively  the human effort is also reduced  in
the sense that the decision time required is much less than that of a fully manual matching
process 

   discussion
the spatial logics lnf  lnfs and lbpt are generally applicable to reason with spatial objects whose locations are represented at different levels of accuracy or granularity in different
datasets  locations of spatial objects can be represented using vector data  coordinates 
or raster data  images   sometimes  for spatial objects in different datasets  measuring
whether their locations are buffered equal directly is difficult or impossible  for example 
when locations are represented as images without knowing their coordinates  in such cases 
spatial objects may be matched by comparing shapes in images or using lexical information 
no matter how the matches between spatial objects are generated  the lnf lnfs lbpt
reasoning could be used to verify consistency of matches with regard to relative locations
 n ear f ar facts  between spatial objects in the same dataset  which are often reliable
and easy to capture 
another potential application of these logics is in matching non georeferenced volunteered spatial information or sketch data  egenhofer        kopczynski        wallgrun 
wolter    richter         instead of being created by surveying or other mapping techniques  sketch data is often created by a person from memory or by schematizing authoritative geospatial data  a sketch map cannot provide precise metric information such as the
exact distance or size of a spatial object  but it roughly shows several kinds of qualitative
relations  e g  nearness and directions  between spatial objects  in the work by wallgrun
et al          qualitative spatial reasoning  based on the dipole relation algebra presented in
moratz  renz    wolter       for checking connectivity and the cardinal direction calculus
   

fidu   alechina

presented in ligozat        is used for the task of matching a sketch map of a road network to a larger geo referenced data set  for example  from openstreetmap  endpoints and
junctions of roads are extracted and their relative directions are represented and checked
by spatial reasoning  the spatial logic lnf can be applied similarly to check the relative
distances between endpoints or junctions of roads  n ear f ar relations between these
points indicate the length of roads  for the task of matching a sketch map of polygonal
objects  e g  buildings and places   the logic lnfs lbpt can be applied  suppose users
draw a sketch map of buildings and estimate the distances between some buildings as being
n ear or f ar regarding an agreed level of tolerance   the n ear and f ar relations
between buildings in a geo referenced map can be calculated automatically  a mapping
between the sketch map and a geo referenced map can be checked by reasoning in the logic
lnfs lbpt  for example  two buildings which are specified as being f ar in the sketch
map cannot be matched to two buildings which are n ear in the geo referenced map 
the main limitation of the new spatial logics is that they require a level of tolerance 
and when using the logics  the value of  is the same for spatial objects of different sizes
and types  such as buildings  roads  rivers and lakes   for example  the margin of error
used for cities should be larger than that for buildings  ideally  the value of  should vary
by the size and type of the spatial object being checked  this motivates the development
of new spatial logics to reason about the sizes and types of spatial objects  in addition to
their relative locations 
in this paper  the theorems were all proved with respect to a metric space  however 
models based on a metric space may not be realisable in a  d euclidean space  which is
more realistic for geospatial data  suppose there are four points pi   where i               
for each point pi   d pi   pi        for any pair of them  d pi   pj     d pj   pi        it is clear
that there is a metric space satisfying all the distance constraints  but there is no such
 d euclidean space  wolter and zakharyaschev              proved that the satisfiability
problem for a finite set of m s q    formulas in a  d euclidean space r  is undecidable 
whilst its proper fragments may be decidable  we proved that the satisfiability problem
for a finite set of lnf formulas in a  d euclidean space is decidable in pspace  du 
       but whether the satisfiability problem for a finite set of lnfs lbpt formulas in a
 d euclidean space is decidable is still unknown  it also remains open that whether the
lnf lnfs lbpt calculus is complete for models based on a  d euclidean space  if not 
a theoretical challenge is to design logics which are complete for  d euclidean spaces  and
hence provide more accurate debugging of matches than the logics of metric spaces 
finally  the use of description logic and the new spatial logics may not be able to detect
all the wrong matches  for example  for spatial objects x  y in one dataset and x     y   in
the other dataset  if sameas x  x     is correct  y is n ear and to the south of x  and y  
is n ear and to the north of x     then sameas y  y     is wrong but cannot be detected 
to deal with this  we could extend the logics with existing spatial formalisms for reasoning
about directional relations  frank              ligozat        balbiani et al         goyal
  egenhofer        skiadopoulos   koubarakis        
   

fiqualitative spatial logics for buffered geometries

   conclusion and future work
we presented a series of new qualitative spatial logics lnf  lnfs and lbpt for validating
matches between spatial objects  especially in crowd sourced geospatial data  for models
based on a metric space  a sound and complete axiomatisation is provided and corresponding
theorems are proved for each logic  the lnf  lnfs and lbpt satisfiability problems in
a metric space are all np complete  an lbpt reasoner with an atms was implemented
and used as a part of matchmaps  experimental results show that the lbpt reasoner
can be used to verify consistency of matches with respect to location information and
detect obvious logical errors effectively  as future work  we will investigate whether the
lnf lnfs lbpt calculus is complete for models based on a  d euclidean space and
develop new spatial logics  e g  for reasoning about directional relations and object sizes in
addition to distances  to provide more accurate debugging of matches 

acknowledgments
we would like to thank the anonymous reviewers who provided excellent comments that
helped us improve the paper 

appendix a  proofs
lemma   if   is an m cs  then for any pair of individual names a  b occurring in  
exactly one of the following cases holds in    
   case a  b    bp t  a  b   bp t  b  a  
   case a  b    bp t  a  b   bp t  b  a  
   case a  b    bp t  a  b   bp t  b  a  
   case a  b    bp t  a  b   bp t  b  a   n ear a  b  
   case a  b    n ear a  b   f ar a  b  
   case a  b    f ar a  b  
where case a  b  denotes the formula which holds between a  b in each case 
proof  for any pair of individual names a  b occurring in     we have 
   b  b    n  f     b  b    n  f     b  b    n  f     b  b    n  f  
 b  b    n  f     b  b    n  f     b  b    n  f     b  b    n  f  
 b  b    n  f     b  b    n  f     b  b    n  f     b  b    n  f  
 bb   n f   bb   n f   bb   n f   bb   n f  
where b  b     n  f stand for bp t  a  b   bp t  b  a   n ear a  b   f ar a  b  respectively 
from table    we have
   b  b       b  b       b  b       b  b    n     n  f    f  
   

fidu   alechina

b
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

b  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

n
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

f
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

prime implicant

b  b  



b  b  



b  b  



b  b    n
f
n  f

axiom fact used
fact   
facts         axiom
fact     axiom  
fact     axiom  
fact   
facts         axiom
fact     axiom  
fact     axiom  
fact   
facts         axiom
fact     axiom  
fact     axiom  
fact   
fact   
facts         axiom
fact     axiom  

 

 

 

 

table    truth table    stands for true    stands for false


lemma    for any distance range g occurring in d     
g                                                          
proof  suppose p  q are constants and d p  q   g is in d      let us look at g in all
different cases 
 p   q  by definition     g       
 p    q 
 p  points a   q  points a   for some individual name a 
by definition     g         
 p  points a   q  points b   for different individual names a  b 
by lemma   and definition     exactly one of following cases holds 
c 
c 
c 
c 
c 
c 

  a  b           b  a           b    
  a  b           b  a          b    
  a  b          b  a           b    
  a  b          b  a          a  b            b  a            b    
  a  b           b  a           a  b            b  a            b    
  a  b           b  a           b    

in c  
 if exactly one of p  q is a witness of  a  b         or  b  a          then by
definition     in the construction process  d p  q         will be added to
   

fiqualitative spatial logics for buffered geometries

d      and then d p  q          will be added to d      since       
                g         
 else if p is a witness of  b  a         and q is a witness of  a  b          then
by definition     in the construction process  d p  q         will be added
to d      and then d p  q         will be added to d     again  and then
d p  q          will be added to d      since                       
       g         
 else  by definition     g          
in c  
 if q is a witness of  a  b          then by definition     in the construction
process  d p  q         will be added to d      and then d p  q        
will be added to d      since                       g         
 else if q is a witness of  b  a         then by definition     in the construction process  d p  q        will be added to d      and then d p  q  
      will be added to d      since                     g        
 else  by definition     g          
in c  
 if p is a witness of  a  b         then by definition     in the construction
process  d p  q        will be added to d      and then d p  q        
will be added to d      since                     g        
 else if p is a witness of  b  a          then by definition     in the construction
process  d p  q         will be added to d      and then d p  q        
will be added to d      since                       g         
 else  by definition     g          
in c  
 if the pair p  q is a witness of  a  b           then by definition     in the
construction process  d p  q          will be added to d      and then
d p  q         will be added to d      since                        
g          
 else if exactly one of p  q is a witness of  a  b        or  b  a        
then by definition     in the construction process  d p  q        will be
added to d      and then d p  q         will be added to d      since
                    g        
 else if p is a witness of  a  b        and q is a witness of  b  a         then
by definition     in the construction process  d p  q        will be added
to d      and then d p  q        will be added to d     again  and then
d p  q         will be added to d      since                    
      g        
 else  by definition     g          
in c  
 if the pair p  q is a witness of  a  b           then by definition     in the
construction process  d p  q          will be added to d      and then 
   

fidu   alechina

d p  q         will be added to satisfy the  formulas  and then d p  q  
      will be added to d      since                               
g          
 else  by definition     d p  q         will be added to satisfy the  formulas  then d p  q         will be added to d      since               
       g         
in c   by definition     d p  q         will be added  then d p  q        
will be added to d      since                       g         
therefore  g                                                           
lemma     calculation of composition  if  m  n    s  t    m      s      l  
 r  are non negative non empty intervals  h    h    h are non negative intervals  then the
following calculation rules hold 
    l    r     l  r  l   r   if l  r 
    l    s  t     s  l  t   l   if s  l 
    l    s  t        t   l   if l   s  t  
    l    s  t     l  t  t   l   if t  l 
    l    s        s  l      if s  l 
    l    s               if s   l 
    m  n    s  t     s  n  t   n   if s  n 
    m  n    s  t        t   n   if  m  n    s  t      
    m  n    s        s  n      if s  n 
     m  n    s               if s   n 
     m       s              
    h       
    h   h    h   h   
     h   h     h    h   h    h   h  
s
s
      k hk    h   k  hk  h   where k  n    
     h   h     h    h   h    h   h   if  h   h        
     h   h     h   h    h   h  
   

fiqualitative spatial logics for buffered geometries

s
s
proof  for rule     suppose d    k hk    h s by lemma     there exist d   k hk and
d   h such that d   d      d     since d   k hk   then there exists a k  n   such that
d   hk   sincesd   hk for some k  d   h  then by definition    d  hk  h  for some k 
therefore d  k  hk  h  
s
suppose s
d  k  hk  h   then  theresexists a k  n   such that d  hk  h 
since hk  k hk   by definition    d    k hk    h  
proof  for rule     suppose h   h       then  hi      i          since h    h    h
are non negative intervals  by the intersection rules and definition     h   h     h and
 h  h  h  h  are non negative intervals  let l    h  h   h  r    h  h  h  h  
if h     then by rule     l   r     otherwise  we show l   r by cases 
 h   h  or h   h    when h   h    then definition    h   h  h   h 
l   h   h   r  when h   h    similarly  l   h   h   r 
 h    h  and h    h    without loss of generality  let us suppose glb h     glb h    
lub h     lub h     then  glb h   h      glb h     lub h   h      lub h    
to prove l   r  it is sufficient to show the following properties hold 
   lub l    lub r  
   glb l    glb r  
   lub l   l iff lub r   r 
   glb l   l iff glb r   r 
by rules      and intersection rules  lub l    lub h   h      lub h    lub h     
lub h   lub r    min lub h      lub h   lub h      lub h     lub h      lub h  
thus  lub l    lub r   property   holds  
if lub h     h  and lub h   h  then by rules      and intersection rules  lub l   l
and lub r   r  otherwise  lub l    l and lub r    r  thus  property   holds 
we prove property   and property   by cases 
 h  h     and h  h     
 lub h   glb h    
glb l    glb h   h     lub h    glb h     lub h  
glb r    max glb h     lub h   glb h     lub h     glb h     lub h  
thus  glb l    glb r   property   holds  
if glb h     h  and lub h   h  then by rules      and intersection rules 
glb l   l and glb r   r  otherwise  glb l    l and glb r    r  thus 
property   holds 
 glb h   lub h    
glb l    glb h   lub h   h      glb h   lub h    
glb r    max glb h   lub h     glb h   lub h       glb h   lub h    
similar to the case above  it is clear that property   and property   hold 
 h  h      and h  h      then  h   h   h       
glb l    glb h   h     lub h    glb h     lub h  
   

fidu   alechina

glb r    max    glb h     lub h     glb h     lub h  
similar to the cases above  it is clear that property   and property   hold 
 h  h     and h  h       then  h   h   h       
glb l    glb h   lub h   h      glb h   lub h    
glb r    max glb h   lub h          glb h   lub h    
similar to the cases above  it is clear that property   and property   hold 
 h  h      and h  h      
since h    h    h are intervals and h   h       h   h   h        
glb l      
glb r    max           
by rules       glb l   l and glb r   r 
it is clear that property   and property   hold 
in every case  properties     hold 
therefore  l   r  
proof  for rule     let
s l    h   h     h  r   h    h   h  
by definition    ls    d  h   d  h   d      d      h 
by rule     l   d  h   d  h     d      d      h  
by rule       d      d      h   h
s    d      d     
by rule     h    d
s       d       dh   d     d      d      
by rule     l  
s d  h   d  h   dh    d      d       d   
similarly  r   d  h   d  h   dh   d       d      d    
to prove l   r  it is sufficient to show
  d      d       d     d       d      d   
let l     d      d       d   then l     d   d     d    d      d  
r    d       d      d    then r    d       d   d   d    d  
we prove l   r by cases 
 d    d   d     d    d     by definition    l       d    d    d  
d    d   d  d    d  d    d    d  d   
thus  d     d   d   d    d   by definition    r       d    d    d  
 d     d   d     d    d    
 d   d    d    by definition    l    d  d   d    d    d    d  
d    d  d     d   d  
by definition    r    d  d   d    d    d    d  
 d    d   d     by definition    l     d   d     d  d    d    d  
 d   d    d   d   d    this is  d    d    d 
by definition    r    d   d   d  d    d    d  
 d    d    d   d   d    this is  d    d   d 
by definition    r    d   d  d    d    d    d  
in each case  l   r  therefore  l   r  

   

fiqualitative spatial logics for buffered geometries

appendix b  alternative proof of the path consistency lemma
in this appendix  we would like to provide a sketch of an alternative proof idea of the
path consistency lemma  since it may appeal to some of the readers more than the proof
presented in section      the alternative proof uses lemma    
lemma    if a distance constraint d p  q   h is in ds     and h  
    then there exist
 
d p  q   m  and d p  q   m  in ds    such that h   m   m    m  and m  are both
identity or definable intervals 
proof  by lemma     d p  q   h is left definable and right definable  by definition    
there exists a sequence of distance constraints d pi   pi      hi  p    p  pn   q      i   n 
in d      such that for m    h        hn    h  m    h and m  have the same greatest
lower bound  both value and openness   by definition     d p  q   m  is in ds      by
lemma    and definition     m  is an identity or definable interval  similarly  by definition     there exists an m  such that h  m    h and m  have the same least upper bound
 both value and openness   d p  q   m  is in ds      m  is an identity or definable interval  by intersection rules  h   m   m    
proof  sketch of the alternative proof of the path consistency lemma  suppose d     is
not path consistent  then there exist d p  q   g  and d p  q   g  in ds      g      
g       and g   g      by lemma     there exist d p  q   m  and d p  q   s  in ds    
such that g    m   s    m  and s  are both identity or definable intervals  similarly  we
have g    m   s    where m  and s  are both identity or definable intervals  g   g    
holds iff one of the following holds  m   m      m   s      s   m      s   s     
without loss of generality  let us suppose m   m      by lemma     m   m    
iff  m   m             let m   m   m    then m is an identity or definable interval 
since d p  q   m  and d p  q   m  are in ds      m       m       then by lemma    
d p  q   m  and d p  q   m  are left definable and right definable  since d p  q   m    we
have d q  p   m    by lemma     d p  p   m is left definable and right definable  the rest
of the proof is almost the same as the proof of the path consistency lemma  starting from
by lemma     glb h                     presented in section      we discuss different
ways to obtain m given its greatest lower bound  the role of m is similar to h    and check
whether  can be derived in every valid case  

appendix c  consequences of the path consistency lemma
in this appendix  we state explicitly some implications of the path consistency lemma 
lemma    let  be a finite consistent set of formulas  if a distance constraint d p  q   h
is in ds      then h     
proof  follows immediately from the proof of the path consistency lemma  
lemma    let  be a finite consistent set of formulas  if a distance constraint d p  p   h
is in ds      then    h 
   

fidu   alechina

proof  suppose a distance constraint d p  p   h is in ds     and     h  by definition   
and definition     d p  p       is in d      by definition     d p  p    h           this
contradicts the fact that d p  p    is not in ds      by lemma      therefore     h  

references
aiello  m   pratt hartmann  i     van benthem  j   eds            handbook of spatial
logics  springer 
allen  j  f          maintaining knowledge about temporal intervals  communications of
the acm                  
balbiani  p   condotta  j     del cerro  l  f          a new tractable subclass of the
rectangle algebra  in proceedings of the   th international joint conference on
artifical intelligence  pp         
bennett  b          the application of qualitative spatial reasoning to gis  in proceedings
of the  st international conference on geocomputation  vol  i  pp       
bennett  b   cohn  a  g     isli  a          a logical approach to incorporating qualitative spatial reasoning into gis  extended abstract   in proceedings of the  rd
international conference on spatial information theory  vol       of lecture notes
in computer science  pp          springer 
chen  j   cohn  a  g   liu  d   wang  s   ouyang  j     yu  q          a survey of
qualitative spatial representations  the knowledge engineering review             
    
clementini  e     felice  p  d          an algebraic model for spatial objects with indeterminate boundaries  in proceedings of the gisdata specialist meeting on geographic
objects with undeterminate boundaries  pp         
clementini  e     felice  p  d          approximate topological relations  international
journal of approximate reasoning                 
clementini  e   felice  p  d     hernandez  d          qualitative representation of positional information  artificial intelligence                 
cohn  a  g     gotts  n  m       a   representing spatial vagueness  a mereological approach  in proceedings of the  th international conference on principles of knowledge
representation and reasoning  pp         
cohn  a  g     gotts  n  m       b   the egg yolk representation of regions with
indeterminate boundaries  in proceedings of the gisdata specialist meeting on
geographical objects with undetermined boundaries  pp         
cohn  a  g     renz  j          qualitative spatial representation and reasoning  in
handbook of knowledge representation  pp          elsevier 
de kleer  j          an assumption based tms  artificial intelligence                 
du  h          matching disparate geospatial datasets and validating matches using spatial
logic  ph d  thesis  school of computer science  university of nottingham  uk 
   

fiqualitative spatial logics for buffered geometries

du  h     alechina  n       a   a logic of part and whole for buffered geometries  in
proceedings of the   st european conference on artificial intelligence  pp         
du  h     alechina  n       b   a logic of part and whole for buffered geometries  in
proceedings of the  th european starting ai researcher symposium  pp        
du  h   alechina  n   hart  g     jackson  m          a tool for matching crowd sourced
and authoritative geospatial data  in proceedings of the international conference
on military communications and information systems  pp      ieee 
du  h   alechina  n   jackson  m     hart  g         
a method for matching crowd sourced and authoritative geospatial data  transactions in gis 
http   dx doi org         tgis       
du  h   alechina  n   stock  k     jackson  m          the logic of near and far  in
proceedings of the   th international conference on spatial information theory  vol 
     of lecture notes in computer science  pp          springer 
du  h   nguyen  h   alechina  n   logan  b   jackson  m     goodwin  j          using
qualitative spatial logic for validating crowd sourced geospatial data  in proceedings of the   th aaai conference on artificial intelligence  the   th conference on
innovative applications of artificial intelligence   pp           
egenhofer  m  j          query processing in spatial query by sketch  journal of visual
languages and computing                
egenhofer  m  j     franzosa  r  d          point set topological spatial relations  international journal of geographical information systems                
egenhofer  m  j     herring  j  r          categorizing binary topological relations
between regions  lines  and points in geographic databases  tech  rep   university
of maine 
fine  k          vagueness  truth and logic  synthese             
frank  a  u          qualitative spatial reasoning with cardinal directions  in proceedings
of the  th austrian conference on artificial intelligence  pp         
frank  a  u          qualitative spatial reasoning  cardinal directions as an example 
international journal of geographical information science                 
goyal  r  k     egenhofer  m  j          similarity of cardinal directions  in jensen  c  s  
schneider  m   seeger  b     tsotras  v  j   eds    advances in spatial and temporal
databases  vol       of lecture notes in computer science  pp        springer 
guesgen  h  w     albrecht  j          imprecise reasoning in geographic information
systems  fuzzy sets and systems                  
haklay  m          how good is volunteered geographical information  a comparative
study of openstreetmap and ordnance survey datasets  environment and planning
b  planning and design                 
iso technical committee             iso            geographic information  spatial
schema  tech  rep   international organization for standardization  tc      
   

fidu   alechina

jackson  m   rahemtulla  h     morley  j          the synergistic use of authenticated and
crowd sourced data for emergency response  in proceedings of the  nd international
workshop on validation of geoinformation products for crisis management  pp       
kopczynski  m          efficient spatial queries with sketches  in proceedings of the isprs
technical commission ii symposium  pp       
kutz  o          notes on logics of metric spaces  studia logica                
kutz  o   sturm  h   suzuki  n   wolter  f     zakharyaschev  m          axiomatizing
distance logics  journal of applied non classical logics                   
kutz  o   wolter  f   sturm  h   suzuki  n     zakharyaschev  m          logics of metric
spaces  acm transactions on computational logic                
lehmann  f     cohn  a  g          the egg yolk reliability hierarchy  semantic
data integration using sorts with prototypes  in proceedings of the  rd international
conference on information and knowledge management  pp         
li  s   liu  w     wang  s          qualitative constraint satisfaction problems  an extended framework with landmarks  artificial intelligence            
li  s   long  z   liu  w   duckham  m     both  a          on redundant topological
constraints  artificial intelligence            
ligozat  g            reasoning about cardinal directions  journal of visual languages  
computing              
lutz  c     milicic  m          a tableau algorithm for description logics with concrete
domains and general tboxes  journal of automated reasoning                   
mackworth  a  k     freuder  e  c          the complexity of some polynomial network
consistency algorithms for constraint satisfaction problems  artificial intelligence 
             
mallenby  d          grounding a geographic ontology on geographic data  in aaai
spring symposium   logical formalizations of commonsense reasoning  pp         
mallenby  d     bennett  b          applying spatial reasoning to topographical data with
a grounded ontology  in proceedings of the  nd international conference geospatial
semantics  no       in lecture notes in computer science  pp          springer 
moratz  r   renz  j     wolter  d          qualitative spatial reasoning about line
segments  in proceedings of the   th european conference on artificial intelligence 
pp         
moratz  r     wallgrun  j  o          spatial reasoning with augmented points  extending
cardinal directions with local distances  journal of spatial information science        
    
openstreetmap         the free wiki world map  http   www openstreetmap org 
ordnance survey         ordnance survey  http   www ordnancesurvey co uk 
pawlak  z   polkowski  l     skowron  a          rough set theory  in wiley encyclopedia
of computer science and engineering  john wiley   sons  inc 
   

fiqualitative spatial logics for buffered geometries

randell  d  a   cui  z     cohn  a  g          a spatial logic based on regions and connection  in proceedings of the  rd international conference on principles of knowledge
representation and reasoning  pp         
renz  j     nebel  b          qualitative spatial reasoning using constraint calculi  in
aiello  m   pratt hartmann  i     van benthem  j   eds    handbook of spatial logics 
pp          springer 
roy  a  j     stell  j  g          spatial relations between indeterminate regions  international journal of approximate reasoning                 
schockaert  s   cock  m  d   cornelis  c     kerre  e  e       a   fuzzy region connection
calculus  an interpretation based on closeness  international journal of approximate
reasoning                 
schockaert  s   cock  m  d   cornelis  c     kerre  e  e       b   fuzzy region connection calculus  representing vague topological information  international journal of
approximate reasoning                 
schockaert  s   cock  m  d     kerre  e  e          spatial reasoning in a fuzzy region
connection calculus  artificial intelligence                  
sirin  e   parsia  b   grau  b  c   kalyanpur  a     katz  y          pellet  a practical
owl dl reasoner  journal of web semantics              
skiadopoulos  s     koubarakis  m          composing cardinal direction relations  artificial intelligence                  
smith  n  j          vagueness and degrees of truth  oxford university press 
stocker  m     sirin  e          pelletspatial  a hybrid rcc   and rdf owl reasoning and query engine  in proceedings of the  th international workshop on owl 
experiences and directions 
sturm  h   suzuki  n   wolter  f     zakharyaschev  m          semi qualitative reasoning
about distances  a preliminary report  in proceedings of the logics in artificial
intelligence  european workshop  jelia  pp       
van beek  p          reasoning about qualitative temporal information  artificial intelligence                   
wallgrun  j  o   wolter  d     richter  k          qualitative matching of spatial information  in proceedings of the   th acm sigspatial international symposium on
advances in geographic information systems  pp         
wolter  f     zakharyaschev  m          reasoning about distances  in proceedings of the
  th international joint conference on artificial intelligence  pp           
wolter  f     zakharyaschev  m          a logic for metric and topology  journal of
symbolic logic                 
zadeh  l  a          fuzzy logic and approximate reasoning  synthese                   
zimmermann  k          measuring without measures  the delta calculus  in proceedings
of the  nd international conference on spatial information theory  pp       

   

fi