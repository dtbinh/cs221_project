journal of artificial intelligence research                  

submitted        published     

a multiagent approach to
autonomous intersection management
kurt dresner
peter stone

kdresner cs utexas edu
pstone cs utexas edu

department of computer sciences  university of texas at austin
  university station  c       austin  tx       usa

abstract
artificial intelligence research is ushering in a new era of sophisticated  mass market
transportation technology  while computers can already fly a passenger jet better than a
trained human pilot  people are still faced with the dangerous yet tedious task of driving automobiles  intelligent transportation systems  its  is the field that focuses on integrating
information technology with vehicles and transportation infrastructure to make transportation safer  cheaper  and more efficient  recent advances in its point to a future in which
vehicles themselves handle the vast majority of the driving task  once autonomous vehicles
become popular  autonomous interactions amongst multiple vehicles will be possible  current methods of vehicle coordination  which are all designed to work with human drivers 
will be outdated  the bottleneck for roadway efficiency will no longer be the drivers  but
rather the mechanism by which those drivers actions are coordinated  while open road
driving is a well studied and more or less solved problem  urban traffic scenarios  especially
intersections  are much more challenging 
we believe current methods for controlling traffic  specifically at intersections  will not
be able to take advantage of the increased sensitivity and precision of autonomous vehicles
as compared to human drivers  in this article  we suggest an alternative mechanism for
coordinating the movement of autonomous vehicles through intersections  drivers and
intersections in this mechanism are treated as autonomous agents in a multiagent system 
in this multiagent system  intersections use a new reservation based approach built around
a detailed communication protocol  which we also present  we demonstrate in simulation
that our new mechanism has the potential to significantly outperform current intersection
control technologytraffic lights and stop signs  because our mechanism can emulate a
traffic light or stop sign  it subsumes the most popular current methods of intersection
control  this article also presents two extensions to the mechanism  the first extension
allows the system to control human driven vehicles in addition to autonomous vehicles 
the second gives priority to emergency vehicles without significant cost to civilian vehicles 
the mechanism  including both extensions  is implemented and tested in simulation  and
we present experimental results that strongly attest to the efficacy of this approach 

   introduction
few concepts  if any  embody the goals and aspirations of artificial intelligence as well
as fully autonomous robots  countless films and stories have been made that focus on a
future filled with such humanoid agents which  when not violently overthrowing their human
masters  run errands  complete menial tasks  or perform duties that would be too difficult
or dangerous for humans  however  machines that sense  think about  and take actions in
the real world around us are no longer just the stuff of science fiction and fantasy  research
c
    
ai access foundation  all rights reserved 

fidresner   stone

initiatives like robocup  noda  jacoff  bredenfeld    takahashi        and the darpa
grand challenge  darpa        have shown that current ai can produce autonomous 
embodied  competent agents for complex tasks like playing soccer or navigating the mojave
desert  respectively  while certainly no small feat  traversing a barren desert devoid of
pedestrians  narrow lanes  and multitudes of other fast moving vehicles is not a typical
daily task for humans  as gary bradski  a researcher at intel corp  said following the
successful completion of the      grand challenge by stanley  a modified volkswagen
touareg  now we need to teach them how to drive in traffic  johnson         since then 
competitors in the      darpa urban challenge took significant strides towards this next
milestone  though in the competition cars did not need to sense traffic signs or signals and
traffic was relatively sparsemore characteristic of suburban than dense urban settings 
in modern urban settings  automobile traffic and collisions lead to endless frustration
as well as significant loss of life  property  and productivity  a      study of    u s 
cities by researchers at texas a m university estimated the annual time spent waiting in
traffic to be    hours per capita  up from    hours in       texas transportation institute 
       americans burn approximately     billion gallons of fuel each year simply idling their
engines  all told  the annual financial cost of traffic congestion has swollen from     billion
to more than     billion  in      us dollars  in this period  the cost of all the wasted
time and fuel due to congestion pales in comparison to the costs associated with automobile
collisions  in a      report  the national highway traffic safety administration  nhtsa 
put the annual societal cost of automobile collisions in the u s  at      billion  national
highway traffic safety administration        
fully autonomous vehicles may be able to spare us much  if not nearly all of these costs 
an autonomous driver agent can much more accurately judge distances and velocities 
attentively monitor its surroundings  and react instantly to situations that would leave a
 relatively  sluggish human driver helpless  furthermore  an autonomous driver agent will
not get sleepy  impatient  angry  or drunk  alcohol  speeding  and running red lights are
the top three causes of automobile collision fatalities  autonomous driver agentsproperly
programmedwould eliminate all three 
a fully autonomous vehicle that will drive in traffic will have to do everything from
obeying the speed limit and staying in its lane to detecting and tracking pedestrians or
choosing the best route to the mall  while this is certainly a complex task  advances in artificial intelligence  and more specifically  intelligent transportation systems  its   suggest
that it may soon be a reality  bishop         cars can already be equipped with features
of autonomy such as adaptive cruise control  gps based route planning  rogers  flechter 
  langley        schonberg  ojala  suomela  torpo    halme         and autonomous
steering  pomerleau        reynolds         some current production vehicles even sport
these features  daimlerbenzs mercedes benz s class has an adaptive cruise control system
that can maintain a safe following distance from the car in front of it  and will apply extra
braking power if it determines that the driver is not braking hard enough  both toyota and
bmw are currently selling vehicles that can parallel park completely autonomously  even
finding a space in which to park without any driver input  in       general motors  gm 
plans to release a nearly autonomous vehicle under its european opel brand  the     
opel vectra will be able to drive itself at speeds up to    miles per hour  even in heavy
traffic  using a video camera  lasers  and a lot of processing power  the car will be able to
   

fia multiagent approach to autonomous intersection management

identify traffic signs  curves in the street  lane markings  as well as other vehicles  by the
end of the decade  gm hopes to incorporate the system into many other models 
autonomous vehicles are coming  in this article  we present a well defined multiagent
framework to manage large numbers of autonomous vehicles at intersections  while there
still exist many technical hurdles and rigorous safety tests  we show in simulation that this
framework may someday dramatically improve the safety and efficiency of our roadways 
    multiagent systems
as autonomous vehicles become more and more prevalent  the possibility of autonomous
interactions among multiple vehicles becomes more interesting  multiagent systems  mas 
is the subfield of ai that aims to provide both principles for construction of complex systems involving multiple agents and mechanisms for coordination of independent agents
behaviors  stone   veloso         automobile traffic is a vast multiagent system involving millions of heterogeneous agents  commuters  truck drivers  pedestrians  cyclists  and
even traffic directing police officers  the mechanism that coordinates the behavior of these
agents is a complex conglomeration of laws  signs  and signaling systems that vary slightly
from state to state and widely from country to country  the mechanism is designed to
work closely with the agentsthe humansthat populate the multiagent system  traffic
lights leave time in between green lights to allow slower or perhaps impatient drivers to
clear intersections  street signs are colored brightly to make them easier to see and use
simple designs to make them easy to understand  drivers must maintain a sufficient following distance to make up for slow reaction times  speed limits ensure that humans have
enough time to process all the necessary information about the position and velocities of
other vehicles  safety buffers of myriad sorts are built into almost every part of the system
to compensate for the limitations of humans 
the first generation of autonomous vehicles will undoubtedly need to work within this
system  processing intensive vision algorithms will identify and extract semantic information from signs and signals  special subroutines will ensure that the vehicles do not exceed
the speed limit  and in the middle of the night  with not another moving vehicle for blocks 
an autonomous vehicle will come to a stop at a red light  however  once most vehicles are
autonomous and the limitations are eliminated  it will not make sense to use a mechanism
designed to control fundamentally different agentsit will be inefficient  both in terms of
processing power and getting vehicles to their destinations quickly 
replacing this soon to be outdated mechanism is inherently a multiagent challenge for
several reasons  first  there are no viable single agent solutions  one computer cannot
handle all the vehicles in the world  second  with vehicles constantly entering and leaving
countries  states  cities  and towns  any solution will have to be flexible and distributed 
third  the different agents have separate  and sometimes conflicting objectives  as with
human driven vehicles  autonomous vehicles will act in their own self interest  attempting
to minimize travel time  distance  and fuel use  other types of agents may aim to maximize
social welfare  minimizing these quantities for the average vehicle  finally  even if a single
computer could control a citys worth of traffic  it would be a very sensitive point of failure 
   

fidresner   stone

    intersections
on the open road  automobiles can be more or less completely autonomous  furthermore 
there is little need for more than a simple reactive behavior that keeps the vehicle in the
lane  maintains a reasonable distance from other vehicles  and avoids obstacles  even lane
changing can be safely and efficiently accomplished by an autonomous vehicle  hatipo 
redmill    ozguner         the algorithmic and ai aspects of open road driving are
essentially solved  the problem itself is not too difficult  there are no pedestrians or cyclists
and vehicles travel in the same direction at similar velocities  relative movement is smooth
and rare 
intersections are a completely different story  vehicles constantly cross paths  in many
different directions  a vehicle approaching an intersection can quickly find itself in a situation in which a collision is unavoidable  even when it has acted optimally  traffic statistics
support the sensitive nature of intersections  vehicle collisions at intersections account for
anywhere between     and     of all collisions  as intersections make up a very small
portion of the roadway  this is a wildly disproportionate amount  collisions at intersections tend to involve cars traveling in different directions  and thus they frequently result in
greater injury and damage  most modern day intersections are controlled with traffic lights
or stop signs  the former usually reserved for larger  busier intersections  at the busiest
of intersectionsfreeway interchangeslarge  extremely expensive cloverleaf junctions are
built 
with the vastly improved precision control and sensing that autonomous vehicles will
offer  there must be a more efficient and safe way to manage intersections  imagine the
scenario in which an autonomous vehicle stops at a red light in the middle of the night with
no other vehicles nearby  at the very least  the vehicle should be able to communicate its
presence to the intersection  which can verify that no other vehicles are nearby  and turn the
light green for the stopped vehicle  in a more ambitious implementation  the intersection
could turn the light green preemptively  obviating the stop altogether  in this article  we go
a step further  allowing vehicles to call ahead and reserve space time in the intersection 
the remainder of this article is organized as follows  in section    we describe the problem of autonomous intersection management and a framework with which we will attempt
to solve this problem  in section    we describe the implementation of the solution framework  section   presents our experiments and empirical results  in section    we conduct a
failure mode analysis of the proposed mechanism  related work is discussed in section   
section   briefly explores some avenues for future research and concludes 

   problem statement and solution framework
automobile traffic is already a huge multiagent system with millions of human driver agents 
various signaling and control mechanisms  and a complicated protocol governing the actions
of the driver agents  in the form of traffic laws  however  if human drivers are to be
replaced by autonomous driving agents  the other elements of the multiagent system should
be rethought  traffic lights  stop signs  and our current traffic laws are all designed with
human drivers in mind and fail to take advantage of the increased sensitivity and precision of
computerized driver agents  if we want autonomous vehicles to operate with high efficiency
and safety  we must design a new way to coordinate them  in this section  we formulate
   

fia multiagent approach to autonomous intersection management

the problem we are trying to solve and present a framework within which we believe the
problem can best be solved 
    desiderata
in designing a mechanism by which traffic is controlled at intersections  we aim to satisfy
the following list of properties 
autonomy each vehicle should be an autonomous agent  if the entire mechanism were
centrally controlled  it would be more susceptible to single point failure  require massive
amounts of computational power  and exert unnecessary control over vehicles in situations
where they are perfectly capable of controlling themselves 
low communication complexity by keeping the number of messages and amount of
information transmitted to a minimum  the system can afford to put more communication
reliability measures in place  furthermore  each vehicle  as an autonomous agent  may have
privacy concerns which should be respected  keeping the communication complexity low
will also make the system more scalable 
sensor model realism each agent should have access only to sensors that are available
with current day technology  the mechanism should not rely on fictional sensor technology
that may never materialize 
protocol standardization the mechanism should employ a simple  standardized protocol for communication between agents  without a standardized protocol  each agent
would need to understand the internal workings of every agent with which it interacts  this
requirement would forbid the introduction of new agents into the system  an open  standardized protocol would make adoption of the system easier and simpler for private vehicle
manufacturers 
deadlock starvation avoidance deadlocks and starvation should not occur in the
system  every vehicle approaching an intersection should eventually cross  even if it is
better for the rest of the agents to leave that vehicle stranded 
incremental deployability the system should be incrementally deployable  in two
senses  first  it should be possible to set up selected intersections to use the system  and
then slowly expand to other intersections as needed  second  the system should function
even with few or no autonomous vehicles  at each stage of deployment  whether it is an
increase in the proportion of autonomous vehicles or the number of equipped intersections 
overall performance of the system should improve  at no point should a net disincentive to
continue deploying the system exist 
safety excepting for gross vehicle malfunction or extraordinary circumstances  e g  natural disasters   as long as they follow the protocol  vehicles should never collide in the
intersection  note that no stronger guarantee is possibleas with modern mechanisms  a
suicidal human driver can always steer a vehicle into oncoming traffic  furthermore  the
system should be safe in the event of total communication failure  if messages are dropped
or corrupted  the safety of the system should not be compromised  it is impossible to prevent all negative effects due to communication failures  but those negative effects should
   

fidresner   stone

be isolated to efficiency  if a message gets dropped  it can make someone arrive    seconds
later at their destination  but it should not cause a collision  in the rare but unpreventable
case of gross vehicle malfunction  the system should react and attempt to minimize damage
and casualties 
efficiency vehicles should get across the intersection and on their way in as little time
as possible  to quantify efficiency  we introduce delay  defined as the amount of additional
travel time incurred by the vehicle as the result of passing through the intersection 
    the reservation idea
of the desiderata  modern day traffic lights and stop signs completely satisfy all but the
last one  while many accidents take place at intersections governed by traffic lights  these
accidents are rarely  if ever  the fault of the traffic light system itself  but rather that of the
human drivers  however  as we will show  traffic lights and stop signs are terribly inefficient 
not only do vehicles traversing intersections equipped with these mechanisms experience
large delays  but the intersections themselves can only manage a somewhat limited amount
of traffic  any stretch of open road can accommodate a certain level of traffic at a given
velocity  the capacity of an intersection involving a road is trivially bounded above by the
capacity of the road  as we will also show  the capacity of traffic lights and stop signs is
much less than that of the roads that feed into them  the aim of this research is to create
an intersection control mechanism that exceeds the efficiency of traffic lights and stop signs 
while maintaining each of the other desiderata 
with the desiderata in mind  we developed a multiagent approach to direct vehicles
through intersections more efficiently  in this approach  computer programs called driver
agents control the vehicles  while an arbiter agent called an intersection manager is placed
at each intersection  the driver agents call ahead and attempt to reserve a block of
space time in the intersection  the intersection manager decides whether to grant or reject requested reservations according to an intersection control policy  figure   shows one
interaction between a driver agent and an intersection manager  the system functions
analogously to a human attempting to make a reservation at a hotelthe potential guest
specifies when he or she will be arriving  how much space is required  and how long the stay
will be  the human reservation agent determines whether or not to grant the reservation 
according to the hotels reservation policy  just as the guest does not need to understand
the hotels decision process  the driver agents should not require any knowledge of the
intersection control policy used by the intersection manager 
when a vehicle approaches the intersection  the vehicles driver agent transmits a reservation request  which includes parameters such as time of arrival  velocity of arrival  as well
as vehicle characteristics like size and acceleration deceleration capabilities  to the intersection manager  the intersection manager then passes this information to the policy  which
determines whether or not it is safe for the vehicle to cross the intersection  if the policy
deems it to be safe  the intersection manager responds to the driver agent with a message
indicating the reservation has been accepted and including any supplemental restrictions
the driver must observe in order to guarantee the safety of the traversal  otherwise  the
intersection manager sends a message indicating that the reservation request has been rejected  possibly including the grounds for rejection  in addition to confirming or rejecting
   

fia multiagent approach to autonomous intersection management

request

driver
agent

reject

postprocess

preprocess

no  reason

yes 
restrictions

intersection
control policy

confirm

intersection manager
figure    one of the driver agents attempts to make a reservation  the intersection manager responds based on the decision of an intersection control policy 

the request  the intersection manager may respond with a counter offer  the driver agent
may not pilot the vehicle into the intersection without a reservation  even with a reservation  a driver agent may only proceed through the intersection according to the parameters
and restrictions associated with the reservation  for the sake of brevity  we may refer to
a vehicle having or obtaining a reservation  rather than specifically stating that the driver
agent of that vehicle has or obtains a reservation 

   building the system
this section describes the realization of the reservation idea as an implemented algorithm 
this process involved developing a simulator in which to run the algorithm  as well as
creating behaviors for each of the agents and a protocol by which they can communicate 
    custom simulator
in order to empirically evaluate the reservation idea  we built a custom time based simulator 
the simulator models an area that is     m      m  the intersection is located at the
center of that area  and its size is determined by the number of lanes traveling in each
direction  which is variable  we assume throughout that vehicles drive on the right side
of the road  however this assumption is not required for the system to work properly 
figure   shows a screenshot of the simulators graphical display  during each time step  the
simulator 
  
  
  
  
  

probabilistically spawns new vehicles
provides sensor input to all vehicles
allows all driver agents to act
updates the position of all vehicles according to the physical model
removes any vehicles outside the simulated area that have completed their journey

      vehicles
vehicles in the simulator have the following properties 
   

fidresner   stone

figure    a screenshot of the simulator in action 

 vehicle identification number  vin 
 length
 width
 distance from front of vehicle to front axle
 distance from front of vehicle to rear axle
 maximum velocity
 maximum acceleration
 minimum acceleration
 maximum steering angle
 sensor range
and the following state variables 
 position
 velocity
 heading
 acceleration
 steering angle
the driver agent assigned to pilot the vehicle may access each of these quantities  with
or without noise  depending on the configuration of the simulator  the driver agent may
also access several simulated external sensors  a list of all vehicles within the sensor range 
and a simplified laser range finder  a detailed description of the simplified laser range finder
can be found in appendix a 
the steering angle is the angle of the front wheels with respect to the vehicle  this
angle can be changed by the driver agent  but the simulator limits the rate at which it
can be changed  this limitation simulates the fact that even a computerized driver cannot
move the steering wheel infinitely fast  by introducing this limitation  we more accurately
approximate vehicle turning  including some of the more dangerous aspects  if the driver
   

fia multiagent approach to autonomous intersection management

cannot turn the wheels instantaneously  it must ensure that it does not drive around corners
at too high a velocityit may not be able to straighten out quickly enough and wind up
veering off the road instead 
the constants representing the distance from the front of the vehicle to the front and
rear axles allow more accurate simulation of vehicle turning  specifically  they allow the
simulator to treat different styles of vehicle differently  the distance between the front
and rear axles is known as the wheelbase  vehicles with shorter wheelbases can turn more
sharply than those with longer wheelbasesif the simulator is to accurately model turning 
it needs access to these important parameters  furthermore  a vehicle with a long hood
will turn differently than a vehicle whose front wheels are located nearer to the front of the
vehicle 
      lanes
lanes in our system consist of a directed line segment  a width  left and right borders that
vehicles may or may not be permitted to cross  and references to which lanes  if any  border
on the right and left side  in a real life implementation  this would be a software construct
the vehicles and driver agents would use to perform lane following and changing  if a vehicle
wants to change lanes to the left or right  it must first establish that the vehicle is allowed
to cross the border between the lanes  after which it can feed its lane following algorithm
the reference to the desired lane 
      physical model
at each time step  the simulator must update the position of every vehicle  because we
model only planar vehicle kinematics and not dynamics  we must make a few assumptions 
first  we assume that vehicles do not skid on the road  second  we assume that vehicles
move according to the following differential equations for non holonomic motion 
x
  v  cos  
t
y
  v  sin  
t

tan 
 v
t
l
in these equations  x  y  and  describe the vehicles position and orientation  v represents the vehicles velocity   describes the vehicles steering angle  and l is the vehicles
wheelbase  we solve these equations holding v and  constant for each time step 
      measuring delay
in section      we introduced delaythe increase in travel time for a vehicle due to the
presence of the intersection  in the simulation  this is measured by first assuming that
on the open road  a vehicle can maintain its velocity at the speed limit  each vehicle is
timestamped when it enters the simulation and keeps track of how far it has traveled  when
the vehicle is removed from simulation  its total delay is calculated as the difference between
how long it actually took to travel as far as it did and how long it would take were the
   

fidresner   stone

vehicle to travel at the speed limit for the entire journey  by this measure  a zero delay is
not possible when the vehicle is turning  as it needs to slow down in order to safely make
the turn  in practice  we compare the delays of all vehicles to delays using a policy that
allows vehicles through the intersection unhindered  which will also be non zero if any of
the vehicles turn or if the road is congested  in this way  we can quantify the effect of
the intersection on the vehicle  both directly  not being able to go through the intersection
because requests were rejected  and indirectly  having to decelerate because another vehicle
cannot get through  
    communication protocol
this section presents a detailed communication protocol by which vehicles and intersections
can coordinate their behavior  the protocol as presented here offers three major benefits 
 all information between the agents goes through one monitorable channel  which
makes reasoning about the communication straightforward 
 by limiting the interactions of the agents to a few message types  we can ensure that
no agent has an unrealistic amount of control over another 
 the agents have a way to communicate that is identical for any intersection management policy or driver agent policy  thus  a vehicle can cross an intersection without
having any idea what policy the intersection manager is usingit simply sends and
receives messages and obeys the rules 
the protocol consists of several message types for each kind of agent  as well as some
rules governing when the messages should be sent and what sorts of guarantees accompany
them  driver agents can send request  change request  cancel  and done messages  request and change request are used when the driver agent wants to make a
reservation or change an existing reservation  respectively  both types of request message
include all the relevant properties of the vehicle  driver agents send a cancel message
when they want to cancel an existing reservation  when a vehicle has successfully crossed
the intersection  its driver agent sends a done message to the intersection manager  both
the cancel and done messages include the vin of the vehicle  as well as an identifier for
the reservation to be cancelled or reported as complete 
intersection managers can send confirm  reject  and acknowledge messages  as
well as a special emergency stop message  which is only used when the intersection
manager detects a major problem in the intersection  see section     confirm is sent
when the intersection manager approves a request or change request message  it
includes information describing the reservationa unique identifier for the reservation  a
start time  a start lane  a departure lane  which will be identical to the start lane unless the
vehicle is turning   and a list of constraints for the vehicles acceleration while it is in the
intersection  the reject message is used to reject either a request or change request
message  the intersection sends an acknowledge message in response to cancel and
done messages sent by the vehicles  a more detailed specification of the protocol including
full syntax and semantics can be found in appendix b 
   

fia multiagent approach to autonomous intersection management

      message corruption and loss
we assume that messages can be digitally signed  such that the possibility of an undetected
message corruption is acceptably small  the protocol is designed specifically to be robust
to message loss  if a message is sent but not receivedor deemed corruptedthe worst
thing that can happen is additional delay  no collisions can occur due to lost messages 
when a vehicle makes a reservation request  it does not assume the space is reserved until it
receives a confirmation from the intersection manager  if a request message is dropped 
no confirm message will follow  if a confirm or reject message is dropped  the vehicle
will simply try againit wont assume that it has a valid reservation 
      enabling policy switching
the protocol hides the implementation of the policy from the driver agents  they have
no idea how the intersection manager is making its decisions  they are just guaranteed that
if they follow them  they will be safe  thus  there are no stipulations that the policy must
remain fixed  an intersection manager could use one policy one moment and then switch
to a more appropriate policy later  provided it can still guarantee that vehicles following
the protocol make it safely across the intersection 
      intersection manager
the intersection manager acts as a stable communication interface between the driver agents
and the intersection control policy and therefore does not contain a lot of functionality 
however  regardless of how the policy makes its decision  the intersection manager must
present the same interface to the driver agents  the general intersection manager algorithm
is shown in algorithm    in it  cancel messages and done messages are treated almost
identicallywhen a done message is received  the intersection manager knows that the
policy can erase any information about the related reservation  however  the done message
also may contain information that is useful to the intersection manager and policy  for
example  when a vehicle sends a done message  it could include the delay it experienced
crossing the intersection  providing the intersection manager with a sort of reward signal 
by which it can judge its performance 
    driver agent
the vast majority of this research focuses on how to make a better intersection manager
and control policy  these parts are designed to work with any driver agent that follows the
protocol  however  for testing purposes  a driver agent implementation is required  despite
the fact that a lot of work went into the driver agent  it is probably the most intricate
part of the system   it is not the focus of this article  we refer the interested reader to
appendix c  which explains the driver agent in detail  in brief  the driver agent estimates
the time and velocity at which it will reach the intersection  and requests an appropriate
reservation  if granted a reservation  it attempts to arrive on schedule  if it determines
that it is unable to keep the reservation  it cancels the reservation  if it believes it will be
substantially early  it attempts to change to an earlier reservation  if it is unable to get a
reservation  it decelerates  down to a minimum velocity  and requests again  it does not
   

fidresner   stone

algorithm   the intersection manager algorithm  vehicle v sends a message to the
intersection manager  which responds according to policy p  
   loop
  
receive message from v
  
if message type is request then
  
process request for new reservation with p
  
if p accepts the request then
  
send confirm message to v containing the reservation returned by p
  
else
  
send reject message to v
  
else if message type is change request then
   
process request for change of reservation with p
   
if p accepts the request then
   
send confirm message to v containing the reservation returned by p
   
else
   
send reject message to v
   
else if message type is cancel then
   
process cancel with p
   
send acknowledge message to v
   
else if message type is done then
   
record any statistics supplied in message
   
process cancel with p
   
send acknowledge message to v

enter the intersection without a reservation  on the open road  the driver agent employs a
simple lane following algorithm  and maintains a following distance of one second between
its vehicle and the vehicle in front of it 
    the fcfs policy
to this point  weve described the substrate infrastructure that enables our research  the
remainder of section   introduces the core contribution of this article and the main payoff for
creating this infrastructure  namely an intersection control policy that enables fine grained
coordination of vehicles at intersections  and a subsequent dramatic decrease in delays 
while the intersection manager communicates directly with the driver agents  the intersection control policy is the brains behind the operation  here we describe an intersection
control policy created from the reservation idea as discussed in section      because of the
first come  first served nature of the policy  we name this policy fcfs  the main part
of the policythe request processingis shown in algorithm   
recall that fcfs enables a car to reserve in advance the space time it needs to cross
the intersection  planning ahead allows vehicles coming from all directions to traverse the
intersection simultaneously with minimal delay  the policy works as follows 
 the intersection is divided into an n  n grid of reservation tiles  where n is the
granularity of the policy 
   

fia multiagent approach to autonomous intersection management

 upon receiving the reservation parameters from an approaching driver agent  the policy runs an internal simulation of the trajectory of the vehicle across the intersection
using these parameters 
 at each time step of the internal simulation  the policy determines which reservation
tiles will be occupied by the vehicle
 if at any time during the simulation the requesting vehicle occupies a reservation tile
that is already reserved by another vehicle  the policy rejects the request  otherwise 
the policy accepts the reservation and reserves the appropriate tiles for the times they
will be required 
figure   shows a graphical depiction of the concept behind the fcfs policy 

 a  successful

 b  rejected

figure    the internal simulation of a granularity   fcfs policy  the black rectangles represent vehicles  and the shaded tiles are tiles that are currently reserved  in   a  
a vehicles request is accepted  and the intersection reserves a set of tiles at time
t  in   b   a second vehicles request is rejected because during the simulation of
its trajectory  the policy determines that it requires a tile  darkly shaded  already
reserved by the first vehicle at time t 

while the concept behind fcfs is sound  it requires some modifications before it will
work reliably  safely  and efficientlyeven in simulation  in the remainder of this section  we
present these modifications  most of which were created in response to early experimental
results documented in section   
      determining the outbound lane
in our first implementation of the reservation system  vehicles were capable of traveling
only in straight lines  once we allowed vehicles to turn  it became apparent that the
driver agents should not determine which lane they use to exit the intersection  instead 
the intersection manager  which has more information about the intersection  makes this
decision  driver agents indicate in their request message which way they intend to turn 
or for more complicated intersections  which direction they intend to go  the intersection
control policy then decides in which outbound lane to place the vehicle  for all experiments
documented in this article  the fcfs policy chooses the most natural lane  for left and
   

fidresner   stone

right turns  it chooses the nearest lane  whereas for vehicles that are not going to turn  it
chooses the lane in which they are planning to arrive at the intersection  however  a policy
could behave differently if configured to do so  for example  the policy can create a priority
list of outbound lanes based on the inbound lane  and then run internal simulations using
each of these lanes until it found an acceptable configuration  for turning vehicles  this list
would be the set of outbound lanes in the correct direction  sorted from nearest to farthest 
for vehicles not turning  it would spiral out from the lane in which they arrivefirst the
arrival lane  then the lane to the left  then the lane to the right  then two lanes to the left 
and so forth  in this manner  a vehicle that might otherwise have had its request rejected
can obtain a reservation for a different path through the intersection 
      acceleration in the intersection
given a set of reservation parameters  there are an infinite number of possible trajectories
a vehicle can take  if it is allowed to accelerate in the intersection  this is because at
each time step  the driver agent could set its vehicles acceleration to any value within the
limits of the vehicles capabilities  depending on the trajectory  the intersection manager
may or may not be able to grant the reservationone set of accelerations may cause it to
collide with another vehicle  while a second set might let the vehicle through safely  for
this reason  acceleration in the intersection must be constrained by the intersection control
policy  allowing driver agents to decide their own acceleration within the intersection would
require the policy to be much more conservative in estimating vehicle trajectories  thereby
reducing efficiency substantially  instead  it is the responsibility of the intersection control
policy to choose a safe and efficient acceleration schedule and include it in the confirm
message  if the driver agents request is accepted 
choosing the best acceleration schedule for the requesting vehicle  or on an even more
basic level  finding a schedule for which the intersection manager can grant the reservation  is a difficult challenge for the intersection control policy  our initial solution was to
allow no acceleration within the intersection  driver agents were required to maintain the
same velocity throughout the entire trajectory  this approach had several major flaws  the
most severe of which was causing a deadlock scenario as vehicles traversed the intersection
more and more slowly  unable to recover from the slightest decelerations  this scenario is
described in much more detail in section     
the fcfs policy  as we have implemented it still takes a fairly straightforward approach
to the problem of determining acceleration schedules for reservation requests  it first attempts a trajectory in which the requesting vehicle accelerates as quickly as possible to
maximum velocity as soon as it enters the intersection  if it cannot grant a reservation
based on that trajectory  it tries one in which the requesting vehicle maintains a constant
velocity throughout the intersection  if neither work  it rejects the request  furthermore  if
the request indicates that the vehicle will arrive at a sufficiently slow velocityin our case
   m sit does not grant a fixed velocity reservation  were it to grant arbitrarily slow
reservations  a vehicle could use an excessively large amount of space time in the intersection  causing other vehicles undue delay  by enforcing a minimum velocity for fixed velocity
reservations  the policy ensures that no vehicle will spend too long in the intersection  while
more complex solutions exist  this solution is good for several reasons  first  it is compu   

fia multiagent approach to autonomous intersection management

d
d

figure    several vehicles are waiting at the intersection  with a reservation distance of
d  the front  white  vehicle is incapable of obtaining a reservation because the
vehicles behind it  shaded  hold conflicting reservations  once the white vehicles
request is rejected  the reservation distance is decreased to d    once the shaded
vehicles cancel their reservations  the white vehicle can obtain a reservation uncontested 

tationally tractable  the policy runs at most two internal simulations per request  second 
it allows vehicles that are stopped or moving very slowly at the intersection to clear the intersection in a timely manner once they get a reservation  third  it eliminates the deadlock
scenario presented in section     by allowing vehicles to recover from decelerating when
they cannot obtain a reservation  even a vehicle that comes to a full stop at the intersection
can accelerate back up to a reasonable velocity as it crosses the intersection 
      reservation distance
allowing accelerations in the intersection helps eliminate deadlocks  but other problems
arose in our prototype implementation that significantly impaired the performance of the
system  frequently  a lane of traffic would become congested when many vehicles were
spawned in that lane  even when the simulator stopped spawning vehicles in that lane  the
lane would remain congested  the problem is that fcfs  as first described  does nothing
to control how vehicles in the same lane are alloted reservations  at best  the frontmost
vehicle will get a reservation and make it through the intersection unhindered  however 
this is often not the case  sometimes the vehicle in front cannot obtain a reservation  due
to congestion   and must decelerate  as shown in figure    driver agents in vehicles further
back may expect to accelerate soon and successfully reserve space time in the intersection
that the frontmost vehicle needs  while all vehicles will eventually make it through  a vehicle
might get a reservation immediately after vehicles behind it cancel   this process can repeat
many times before the frontmost vehicle gets a reservation  in the worst scenarios  a single
vehicle can continue for quite some time to obtain reservations that prevent the front car
from crossing the intersection 
if we could maintain the invariant that vehicles do not get reservations unless all cars
in front of them  in their lane  have reservations  this scenario could be avoided entirely  a
   

fidresner   stone

simple way to enforce this would be to insist that no vehicle can get a reservation unless the
vehicle in front of it already has one  unfortunately  there is no way to strictly enforce this 
vehicles do not communicate their positions  and even if they did  they could be untruthful  
however  because the vehicles communicate the time at which they plan to arrive at the
intersection  as well as what their velocity will be when they get there  quantities which
the vehicles have no incentive to misrepresent   it is possible to approximate a vehicles
distance from the intersection  given a reservation request by that vehicle  we approximate
this distance  which we call the reservation distance  as va  ta  t   where va is the proposed
arrival velocity of the vehicle  at the intersection   ta is the proposed arrival time of the
vehicle  and t is the current time  this approximation assumes the vehicle is maintaining a
constant velocity 
the policy uses the approximation as follows  for each lane i  the policy has a variable
di   initialized to   for each reservation request r in lane i  the policy computes the
reservation distance  d r   if d r    di   r is rejected  if  on the other hand  d r   di   r is
processed as normal  if r is rejected after being processed as normal  d i  min di   d r   
otherwise  di   
while this does not guarantee that vehicles only get reservations if all vehicles in front
of them already have reservations  it makes it much more likely  two properties make the
approximation particularly well suited to this problem  first  if a vehicle is stopped at
the intersection  its reservation distance will be approximated as zero  this means that no
vehicle behind it will be granted a reservation before it isno smaller reservation distance
is possible  furthermore  because the reservation distance is the product of the arrival
velocity and the time until the vehicle arrives  as vehicles approach the intersection and
slow down  the reservation distance gets smaller and more accurate  thus  vehicles most
susceptible to the problem described in figure   are the most likely to be protected against
it  the second property is that because the estimate uses the arrival velocity of the vehicle 
it overestimates the distance of vehicles expecting to accelerate significantly before reaching
the intersection  it is this expectation that causes driver agents to reserve space time that
is needed by vehicles in front of them  note also that this heuristic only works within a
single laneeach lane keeps track of its own reservation distance 
in the example of figure    the white vehicles rejected reservation request would shorten
the maximum allowed reservation distance for its lane  this  in turn  would cause future
requests by the shaded vehicles to be immediately rejected  giving the white vehicle exclusive
access  within the lane  to the reservation mechanism  once the white vehicle secured a
reservation  the maximum allowed reservation distance would be reset to the maximum 
and all vehicles would once again have equal priority 
      timeouts
once a driver agents reservation request is rejected  that driver agent may immediately
make a new request  unless the new request is significantly different  it will most likely
be rejected as well  with the exception of the request made immediately after the first
rejected request  a driver agents estimate of its arrival at the intersection is not likely to
change much in the instant between consecutive requests  eventually  after the vehicle has
decelerated enough or the driver agents with conflicting reservations have canceled  the ve   

fia multiagent approach to autonomous intersection management

hicle will obtain a reservation and make it through the intersection  from the standpoint
of the intersection manager  each of the requests before the successful one are wasted effort 
while our policy runs at most two internal simulations per request  those simulations may
be computationally expensive  especially if the fcfs policy has a high granularity  furthermore  if each rejected vehicle makes a request at every possible instant  the work can
add up very quickly 
in order to keep the required amount of computation down and discourage driver agents
from overloading the intersection manager with requests  the policy employs a system of
timeouts  once a driver agents request is rejected  subsequent requests will not be considered until a period of time  determined by the reservation parameters  has elapsed  when
rejecting a request  the policy includes in the rejection message the time after which it
will consider further requests from the driver agent  in our implementation  this time is
equal to t   min        ta t     where t is the current time and ta is the time of arrival in
the request message  this process serves two purposes  first  it dramatically reduces the
amount of computation the policy needs to do  because the intersection manager receives
fewer requests  vehicles may not obtain reservations at the earliest moment possible  but
the computational savings are more than worth it  second  it gives preference to vehicles
that will enter the intersection sooner  if a vehicle is stopped at the intersection  it can send
requests as quickly as it wishes  giving it the best chance of getting a reservation approved 
a vehicle farther away  however  may have to wait the full half second before attempting
to make another reservation  as a vehicle approaches the intersection  if it is unable to
procure a reservation  the frequency of opportunities to send reservation requests increases 
in practice  timeouts significantly improve the performance of the system  allowing it to
handle much higher traffic loads while avoiding backups 
      buffers  static vs  time
in any system involving physical robots  noise in sensor readings and errors in actuators will
inevitably manifest themselves  even in simulation  artifacts resulting from the discretization of time are enough to weaken the reservation tiles guarantees of exclusivity  in the
intersection  where vehicles move at high speeds in all different directions  these potential
sources of calamity cannot be ignored  for example  what happens when a driver agent
realizes that it will not make its reservation exactly on time  close enough to the intersection
that it is not possible to stop before entering the intersection  some sort of safety buffer is
required  two types of buffers are most natural  static buffers and time buffers 
static buffersbuffers whose size is constantcertainly suffice for safety purposes  if the
intersection manager assumes each vehicle is ten times as large in each dimension  certainly
no vehicle should even get close to another vehicle  however  this defeats the point of the
intersection manager  which is to leverage the increased precision of autonomous vehicles 
furthermore  a static buffer does not take into account the direction of motion of the vehicle 
two vehicles whose paths would never intersect may begin to interfere with one anothers
reservation process if a large static buffer is used  as in figure   a  
time buffers  on the other hand  do take into account the motion of the vehicles  if
the intersection manager instead assumes that the vehicle might be early or late  the actual
area restricted by this buffer will shrink and grow with the vehicles velocity  and only in the
   

fidresner   stone















 
 
 
 


 
 
 





 a  static buffer

 b  time buffer  low velocity

 
 
 
 
 







 
 
 
 
 







 c  time buffer  high velocity

 d  hybrid buffer

figure    various styles of buffers designed to cope with sensor noise and actuator errors 
the hatched areas show where buffers would cause reservation conflicts  only one
of each pair of conflicting vehicles would be granted a reservation 

direction of movement  figures   b  and   c  show how the buffer scales with the speed of
the vehicle  thus  if two vehicles are traveling along parallel lines  the time buffers for those
vehicles should not interfere unless those vehicles could potentially collide  they are in the
same lane or the lanes are too close together for the vehicles width   alone  time buffers
are not sufficient to guarantee safety  a small error in lateral positioning  orthogonal to
the direction of motion  may still cause a collision  figure   d  shows the best solution 
a hybrid buffer  the hybrid buffer has a time buffer that scales with velocity  as well as a
small static buffer that protects against lateral positioning errors and serves as a minimum
buffer for slow moving vehicles 
      edge tiles
when driving on the open road  vehicles must maintain a reasonable following interval
 usually measured as an amount of time  between one another  if a vehicle decelerates suddenly  it puts the vehicle behind it in a dangerous situationif the rear vehicle doesnt react
quickly enough  it may collide with the front vehicle  in the intersection  following intervals
are not very practical  because vehicles are traveling in many different directions  vehicles
in the intersection cannot react normally to their sensor readings  because the intersection
manager may orchestrate some close calls that would look like a potential collision to a
vehicle operating in open road mode  instead  the vehicles trust the constraints given
to them by the intersection manager  this does not pose a problem in the intersection 
but when a vehicle exits the intersection  it may enounter a vehicle that also just left the
intersection  but at a much slower velocity  as shown in figures   a  and   b   this may
lead to an unavoidable collision  with the later vehicle being unable to stop quickly enough 
even with autonomous vehicles  which can react almost instantaneously  some amount of
following interval is required for vehicles leaving the intersection 
   

fia multiagent approach to autonomous intersection management

b

a

b

a

a

b

 a  a turns right in front of
b 

 b  b cannot stop in time 

 c  b must slow down preemptively 

figure    edge tiles prevent collisions after vehicles leave the intersection  in   a   vehicle
a turns in front of vehicle b  traveling slowly because it is making a right turn 
in   b   vehicle b gets through the intersection without incident  but finds that
once it leaves the intersection  it cannot stop before colliding with vehicle a  the
extra buffers on edge tiles  as shown in   c   prevent vehicle b from obtaining a
reservation which would cause it to exit the intersection too close to vehicle a 
the shaded tiles are edge tiles  while the darkly shaded tiles are the specific tiles
that would prevent the collision in   a  and   b  

a first cut solution to this problem is simply to increase the time buffers on all reservation tiles to the desired following interval  thus  if vehicles require a following interval
of one second when exiting the intersection  then no vehicle will be able to reserve a tile
within one second of another vehicle  this ensures that vehicles leaving the intersection
in the same lane will not exit within one second of each other  and there will be a gap of
at least one second between the vehicles  unfortunately  this wreaks havoc with fcfss
ability to conduct vehicles efficiently through the intersection  the close calls from which
the system gets its efficiency advantages will no longer be possible 
instead  we divide the reservation tiles into two groups  internal tiles are tiles that
are surrounded on all sides by other reservation tiles  edge tiles  which are shown shaded
in figure   c   are tiles that abut the intersection  at sufficiently high granularities  edge
tiles are a relatively small fraction of the total number of tiles  it is only on these tiles
that we increase the time buffer to the desired following interval  because  at sufficiently
high granularities  only vehicles leaving by the same lane will require the same edge tiles 
this modification enforces the desired following intervals without otherwise preventing the
intersection from exploiting its ability to interleave vehicles closely 
    other policies
because of the layer of abstraction provided by the protocol  the intersection manager can
work in an emulation mode  imitating modern day control mechanisms  such as the stop
sign and traffic light  here we briefly explain the implementation of two intersection control
policies designed to mimic these mechanisms 
   

fidresner   stone

algorithm   fcfss request processing algorithm  fcfs has persistent state variables 
tiles  a map from tiles and times to vehicles  reservations  a map from vehicles to sets of
tiles  and timeouts  a map from vehicles to times 
   tc  the current time
   if timeouts vehicle id    tc then
  
reject the request
   ta  proposed arrival time
   timeouts vehicle id   tc   min       ta  tc     
   for acceleration in  true  false  do
  
tile times    
  
t  ta
  
v  temporary vehicle initialized according to reservation parameters
   
while v is in the intersection do
   
s  tiles occupied by v and v s static buffer at time t
   
tile times  tile times    t  s  
   
for all s  s do
   
if s is an edge tile then
   
buf  edge tile buffer
   
else
   
buf  internal tile buffer
   
for i   buf to buf do
   
if tiles s  t   i  is reserved by another vehicle then
   
if acceleration then
   
goto line   
   
else
   
reject the request
   
t  t   time step
   
move v according to physical model
   
if acceleration then
   
increase v s velocity by v s maximum acceleration
   
break
   
   
   
   
   
   
   
   
   
   
   

if request is a change then
old tile times  reservations vehicle id 
for all  ti   si    old tile times do
for all s  si do
clear reserved status of tiles s  ti  
for all  ti   si    tile times do
for all s  si do
tiles s  ti    vehicle id
reservations vehicle id   tile times
accept request  return reservation constraints  incl  accelerations 

   

fia multiagent approach to autonomous intersection management

stop sign stop signs are traditionally used at intersections with very light traffic  while
they are much more cost effective and reliable  they cannot provide the throughput
and efficiency of a traffic light  thus  there would never be a reason for our system
to emulate a stop sign  however we include a description for completeness 
stop sign is exactly like fcfs  except that it only accepts reservations from vehicles
that are stopped at the intersection  any other reservation requests are rejected
with a message indicating the vehicle must stop at the intersection  the intersection
determines whether a vehicle is stopped at the intersection by examining the difference
between the current time and the arrival time in the request message 
traffic light when the traffic light policy receives a reservation request message 
it calculates the next time after the proposed arrival time that the light for sending
vehicles lane will be green  it then responds with a confirmation message that reflects
this information  because confirmation messages have maximum tolerable errors associated with them  the intersection manager uses these errors to encode the beginning
and end of the green light period 
    compatibility with human drivers
while an intersection control mechanism for autonomous vehicles will someday be very
useful  there will always be people who enjoy driving  additionally  there will be a fairly
long transitional period between the current situation  all human drivers  and one in which
human drivers are a rarity  even if switching to a system comprised solely of autonomous
vehicles were possible  pedestrians and cyclists must also be able to traverse intersections in
a controlled and safe manner  for this reason  it is necessary to create intersection control
policies that are aware of and able to accommodate humans  whether they are on a bicycle 
walking to the corner store  or driving a classic car for entertainment purposes  in this
section we explain how we have extended the fcfs policy and the reservation framework
to incorporate human drivers  in order to accommodate human drivers  a control policy
must be able to direct both human and autonomous vehicles  while coordinating them 
despite having much less control and information regarding where and when the human
drivers will be  the main concept behind our extension is the assumption that there is
a human driven vehicle anywhere one could be  while this may be less efficient than an
approach which attempts to more precisely model human behavior  it is guaranteed to be
safe  one of the desiderata on which we are unwilling to compromise  adding pedestrians
and cyclists follows naturally  and we give brief descriptions of how this would differ from
the extensions for human drivers 
compatibility with human drivers offers more than the ability to handle the occasional
human driver once the levels of human drivers in everyday traffic reaches a steady state  it
will also help facilitate the transition from the current standardall human driven vehicles
 to this steady state  in which human drivers are scarce  in section      we emphasized the
need for incremental deployability  as we will show experimentally  human compatibility
adds significantly to the incremental deployability of the reservation system  we will also
show that the specifics of the implementation offer further benefits  incentives for both
communities and private individuals to adopt autonomous vehicle technology 
   

fidresner   stone

      using existing infrastructure
a reliable method of communicating with human drivers is a prerequisite for including
them in the system  the simplest and best solution is to use something human drivers
already know and understand  traffic lights  traffic light infrastructure is already present
at many intersections and the engineering and manufacturing of traffic light systems is well
developed  for pedestrians and cyclists  standard push button crossing signals can be
used that give enough time for a person to traverse the intersection  these can also serve
to alert the intersection to their presence 
      light models
if real traffic lights are to be used to communicate to human drivers  they must be controlled
and understood by the intersection manager  thus  we add a new component to each
intersection control policy  called a light model  the light model controls the physical lights
as well as providing information to the policy with which it can make decisions  in more
complicated scenarios  the light model can be modified by the control policy  for example 
in order to adapt to changing traffic conditions  the lights have the same semantics as
modern day lights  red  do not enter   yellow  if possible  do not enter  light will soon be
red   and green  enter   each control policy requires a light model so that human users
know what to do  for instance  the light model for fcfs keeps all the lights red at all
times  indicating to humans that it is never safe to enter  the traffic light policys light
model  on the other hand  corresponds exactly to the light system the policy is emulating 
here  we describe a few light models used in our experiments 
all lanes in this model  which is very similar to some current traffic light systems  each
direction in succession gets green lights in all lanes  thus  all northbound traffic  turning
and going straight  has green lights while the eastbound  westbound  and southbound traffic
all have red lights  the green lights then cycle through the directions  as it is similar
to some current traffic lights  this light model is particularly well suited to controlling
distributions of vehicles with significant contingents of human drivers  we demonstrate this
fact experimentally in section      figure   shows a graphical depiction of this light model 

figure    the all lanes light model  each direction gets all green lights in a cycle  north 
east  south  west  during each phase  the only available paths for autonomous
vehicles with red lights are right turns 

single lane in the single lane light model  the green light rotates through the lanes
one at a time instead of by direction  for example  the left turn lane of the northbound traffic
   

fia multiagent approach to autonomous intersection management

would have a green light  while all other lanes would have a red light  next  the straight
lane of the northbound traffic would have a green light  then the right turn  next  the green
light would go through each lane of eastbound traffic  and so forth  a graphical description
of the models cycle can be seen in figure    this light model does not work very well if
most of the vehicles are human driven  but as we will show  is very useful for intersections
which control mostly autonomous vehicles but need also to handle an occasional human
driver 

figure    the single lane light model  each individual lane gets a green light  left turn 
straight  then right turn   and this process is repeated for each direction  note
how a smaller part of the intersection is used by human vehicles at any given
time  the rest of the intersection is available to autonomous vehicles 

      the fcfs light policy
in order to obtain some of the benefits of the fcfs policy while still accommodating human
drivers  a policy needs to do two things 
   if a light is green  ensure that it is safe for any vehicle  autonomous or human driven 
to drive through the intersection in the lane the light regulates 
   grant reservations to driver agents whenever possible  autonomous vehicles can thus
move through red lights  whereas humans cannot   provided they have a reservation
similar to a right on red  but extended much further to other safe situations 
the policy fcfs light  which does both of these  is described as follows 
 as with fcfs  the intersection is divided into a grid of n  n tiles 
 upon receiving a request message  the policy uses the parameters in the message to
establish when the vehicle will arrive at the intersection 
 if the light controlling the lane in which the vehicle will arrive at the intersection will
be green at that time  the reservation is confirmed 
 if the light controlling the lane will be yellow  the reservation is rejected 
 if the light controlling the lane will be red  the journey of the vehicle is simulated as
in fcfs  section      
 if throughout the simulation  no required tile is reserved by another vehicle or in use
by a lane with a green or yellow light  the policy reserves the tiles and confirms the
reservation  otherwise  the request is rejected 
   

fidresner   stone

request
preprocess

yes 
restrictions

red

light model

no  reason

fcfs

reject

postprocess

yellow

driver
agent

green

confirm

intersection manager

figure    fcfs light is the combination of fcfs and a light model  when a request
is received  fcfs light first checks to see what color the light will be  if it
is green  it grants the request  if it is yellow  it rejects  if it is red  it defers to
fcfs 

off limits tiles unfortunately  simply deferring to fcfs does not guarantee the safety
of the vehicle  if the vehicle were granted a reservation that conflicts with a vehicle following
the physical lights  a collision could easily ensue  to determine which tiles are in use by
the light system at any given time  we associate a set of off limits tiles with each light 
for example  if the light for the northbound left turn lane is green  or yellow   all tiles
that could be used by a vehicle turning left from that lane are considered reserved for the
purposes of fcfs  the length of the yellow light is adjusted so that vehicles entering the
intersection have enough time to clear the intersection before those tiles are no longer off
limits 
fcfs light subsumes fcfs using a traffic lightlike light model  for example alllanes   fcfs light can behave exactly like traffic light if all drivers are human 
with a light model that keeps all lights constantly red  fcfs light behaves exactly like
fcfs  in this case  if any human drivers are present it will fail spectacularly  leaving the
humans stuck at the intersection indefinitely  however  in the absence of human drivers  it
will perform exceptionally well  fcfs is just a special case of fcfs light  we can thus
alter fcfs lights behavior to vary from strictly superior to traffic light to exactly
that of fcfs 
    emergency vehicles
in current traffic laws there are special procedures involving emergency vehicles such as
ambulances  fire trucks  and police cars  vehicles are required to pull over to the side of
the road and come to a complete stop until the emergency vehicle has passed  this is
both because the emergency vehicle may be traveling quickly  posing a danger to other
vehicles  and because the emergency vehicle must arrive at its destination as quickly as
possiblelives may be at stake  hopefully  once a system such as this is implemented 
automobile accidentsa major reason emergency vehicles are dispatchedwill be all but
eradicated  nonetheless  emergency vehicles will still be required from time to time as fires 
heart attacks  and other emergencies will still exist  while we have previously proposed
other methods for giving priority to emergency vehicles  dresner   stone         here we
present a new  simpler method  which is fully implemented and tested 
   

fia multiagent approach to autonomous intersection management

      augmenting the protocol
in order to accommodate emergency vehicles  the intersection manager must first be able
to detect their presence  the easiest way to accomplish this is to add a new field to all
request messages  in our implementation  this field is simply a flag that indicates to the
intersection manager that the requesting vehicle is an emergency vehicle in an emergency
situation  lights flashing and siren blaring   in practice  however  safeguards would need
to be incorporated to prevent normal vehicles from abusing this feature in order to obtain
preferential treatment  this could be accomplished using some sort of secret key instead of
simply a boolean value  or even some sort of public private key challenge response mechanism  this details of the implementation  however  are beyond the scope of this project
and are already a well studied area of cryptography and computer security 
      the fcfs emerg policy
now that the intersection control policy can detect emergency vehicles  it can process reservation requests while giving priority to the emergency vehicles  a first cut solution is simply
to deny reservations to any vehicles that are not emergency vehicles  however  this solution
is not satisfactory  because if all the traffic comes to a stop due to rejected reservation
requests  any emergency vehicles may get stuck in the resulting congestion  instead  the
fcfs emerg policy keeps track of which lanes currently contain approaching emergency
vehicles  as long as at least one emergency vehicle is approaching the intersection  the
policy grants reservations only to vehicles in those lanes  this ensures that vehicles in front
of the emergency vehicles will also receive priority  due to this increase in priority  lanes
with emergency vehicles tend to empty very rapidly  allowing emergency vehicles to proceed
relatively unhindered 
    summary
in this section  we have explained how we created a reservation based intersection control
mechanism in simulation  we described the construction of the simulator itself  as well
as the communication protocol  the intersection manager  the driver agent  and several
intersection control policies  the first policy  fcfs is only for fully autonomous vehicles 
fcfs light extends fcfs to allow human interoperability using existing traffic light
infrastructure  the last policy  fcfs emerg  extends fcfs to give priority to emergency
vehicles without significant increasing delays for other vehicles 

   experimental results
in this section  we fully test all of the features introduced in section   and demonstrate that
the reservation system can reduce delay by two orders of magnitude  our experiments evaluate the performance of the reservation system using different intersection control policies 
amounts of traffic  granularities  levels of human drivers  and the presence of emergency
vehicles  we first compare the system using fcfs to traffic lights of varying cycle periods
using a prototype simulator  we then show results from the full version  including the stop
sign control policy as implemented under our protocol  comparing these results to those from
the traffic light experiments  next  we experiment with allowing vehicles to turn from any
   

fidresner   stone

lanesomething that would be extremely dangerous without the reservation based mechanism  finally  we evaluate the two extensions to fcfs  fcfs light and fcfs emerg 
videos of the simulator in action  including many scenarios from this section  as well as other
supplementary materials can be found at http   www cs utexas edu  kdresner aim  
    low granularity fcfs vs  the traffic light
the simplest implementation of fcfs has granularity  the entire intersection is a single reservation tile  while only one vehicle may be in the intersection at a time  if that
vehicle is traveling sufficiently fast  the total amount of time for which it will occupy the
intersection is small  if we increase the granularity to    the intersection is no longer entirely exclusive  for example  non turning vehicles traveling north no longer compete for
the same reservation tiles as non turning vehicles traveling south  similarly  eastbound and
westbound non turning vehicles no longer compete   here we present our initial results
comparing these two instances of the reservation mechanism and several incarnations of a
traffic light 
      experimental setup
these experiments were carried out using a prototype version of the simulator  which is fully
described in an earlier publication  dresner   stone         in this version of the simulator 
vehicles are not allowed to turn or accelerate while in the intersection  these restrictions do
not detract from the core challenge of the problem  and the results are relevant even when
the restrictions are relaxed  each simulation contains one lane traveling in each direction 
the speed limits of which are    meters per second  traffic spawning probability varies from
       to      in increments of         and each configuration runs for         steps in the
simulator  which corresponds to approximately     hours of simulated time 
      results
figure    a  shows delay times for traffic light systems with varying periods  ranging from
extremely short     seconds  to fairly long     seconds   as expected from real life experience  short period traffic lights control light traffic well  while traffic lights with longer
periods work better in heavy traffic scenarios  when traffic is sparse  a short period allows
vehicles to wait a shorter time before getting a green light  in many cities  traffic light
periods are shortened during early hours of the morning to take advantage of this fact  in
scenarios with more densely packed vehicles  the per vehicle costs of slowing to a stop and
accelerating back to full speed  as well as the intervals needed to clear out the intersection
 the time during which there is a yellow light  or all lights are red   tend to dominate 
this makes the longer period lights better in these situations  in the figure    a   above a
certain traffic level  each of the traffic light systems reaches what appears to be a maximum
delay level  this is an artifact of the simulatorwhen the traffic level gets high enough 
the vehicles back up so far that the simulator cannot keep track of them  it cannot spawn
new vehicles  for lack of a place to put them   at this point  vehicles are arriving at the
intersection faster than the traffic lights can safely coordinate their passage  thus  the
point at which the delay spikes upwards indicates the maximum throughput of each traffic
configuration 
   

fi   
  
  
  
  
  
  
  
  
  
 

   
period   

   

period   

average delay  s 

average delay  s 

a multiagent approach to autonomous intersection management

period   

granularity  

   
   
   
granularity  
   
granularity  

   
 
   

   

   

   

 

   

traffic level  vehicles s 

   

   

   

 

traffic level  vehicles s 

 a  reservation vs  traffic light

 b  increasing granularity

figure        a  shows average delays for traffic light systems with period         and    seconds plotted against varying traffic levels along with a   tiled reservation based
system     b  shows average delays for granularity   and   fcfs policies with
varying traffic levels  spawning probability was varied in increments of        
and each configuration was run for           steps of simulation  approximately
    hours of simulated time   each direction has   lane 

also in figure    a  are the delays for the granularity   and   fcfs policies  with
the car spawning probability below about        the granularity   policys delay is visually
indistinguishable from the x axis  while this is true for the granularity   reservation system
for the whole graph  figure    b  shows the bottom      of the graph  enlarged to show
these results in more detail  at the vehicle spawning rate of       all of the traffic light
systems are already beyond maximum capacity  while the granularity   system is allowing
vehicles through without even adding a tenth of a second to the average vehicles travel
time 
    choosing granularity
of note in figure    a  is the spike in delay for the granularity   fcfs policy  the system looks as though it is behaving chaoticallyin figure    b   delay slowly and steadily
increases with the traffic level  until spiking off the graph when the probability of spawning
a vehicle each time step reaches about       
with the granularity   system  vehicles traveling parallel to one another compete for
the same tiles  this also happens to vehicles in the lanes closest to the middle of the
road whenever the granularity is a small  odd number  as in figure    b   recall that in
the prototype simulator  acceleration in the intersection is forbidden  thus  if a vehicle
slows down because it cannot obtain a reservation  when it finally does get a reservation
it will be moving slowly for the entirety of the reservation and occupy the reservation
tiles for a longer period of time  the next car to approach the intersection is therefore
more likely to slow down as well  this process feeds itself and the vehicles slow down
more and more  for small to average amounts of traffic  delays increase  but the system
recovers during probabilistically generated periods of light traffic  however  for very heavy
   

fidresner   stone

traffic  the intersection will eventually reach a deadlocked state  because traffic is generated
stochastically  this could happen early or late in the experiment  if it happens early  it will
have a large effect on the average delay  whereas if it happens late  the effect will be smaller 
deadlocking is difficult to measure quantitatively  because as it progresses  driver agents
make reservations for very long periods of timeso long  in fact  that they overflow the
memory of the computer running the simulator  this effect can be seen in the rough line in
figure    a   to further explore the effects of granularity  we ran several more experiments 
varying the granularity as well as the number of lanes 

 a  granularity  

 b  granularity  

figure     increasing the granularity does not always improve performance  in    a   a
granularity of   suffices  in    b   increasing the granularity to   actually hurts
performancevehicles traveling parallel to each other  but in opposite directions  are competing for the middle row of tiles 

      experimental setup
these experiments were also used the prototype simulator as described in section       
each data point represents         steps of simulation  approximately     hours of simulated
time   the traffic level is fixed at     vehicles per second 
      results
as shown in figure     with   lanes in each direction  a      grid performs better than
a      grid  increasing to a      grid is better than       but increasing it to      is
again worse  an increase in granularity should correspond to a decrease in delay  however 
for small granularities  incrementing the granularity from a small even number to a small
odd number actually increases delay  in the case of maximum delay  even the granularity  
   

fia multiagent approach to autonomous intersection management

    

 

    

   

   

maximum delay  s 

average delay  s 

system performs better than the granularity   system  the ill effects of odd granularities as
shown in figure    tend to slow down a few unfortunate vehicles 

    
    
    

 

   

 

   

    
 

 
 

 

 

 

 

granularity

 

 

 

granularity

 a  average delay

 b  maximum delay

figure     simulation statistics for fcfs policies with varying granularity  there are  
lanes in each direction and the traffic level is     vehicles per second  each
experiment is run for         simulation steps  note that increasing the granularity does not always improve performance 
this experiment suggests that fcfs should always be run with granularity high enough
such that vehicles that never cross paths never compete for the same reservation tiles  as
figure    shows  more lanes require a higher granularity  though even with low granularity 
the system out performs the traffic light   however  because the computational complexity
of the system increases proportional to the square of the granularity  the granularity should
not be increased indiscriminately 
    the full power of fcfs
while earlier experiments used a prototype simulator  these experiments use the full power
of fcfsturning  acceleration  and all the modifications from section      because vehicles
turn  and thus do not always travel within a line of reservation tiles  increasing granularity
beyond twice the number of lanes can improve performance even more  in addition to
fcfs  we evaluate the stop sign policy as presented in section     
technically  the optimal delay for an individual vehicle is no delay at all  however 
although a vehicle could experience delay as low as   seconds  turning vehicles may need to
slow to avoid losing control  in order to create a worthwhile benchmark against which to
compare the reservation system  we empirically measure the optimal average delay for an
intersection manager  to do this  we use a special control policy that accepts all requests 
we also deactivate each vehicles ability to detect other vehicles  eliminating the interactions
between them  these results are presented as the optimal control policy  which while
optimal in terms of delay  provides no safety guarantees 
small intersections with slow moving traffic tend not to be amenable to control by traffic
lights  very light traffic can usually regulate itself fairly effectively  for example  consider an
intersection with a stop signall vehicles must come to a stop  but afterwards may proceed
   

fidresner   stone

  lanes
  lanes
  lanes
  lane

    

average delay  s 

    
   
    
    
    
    
 
 

 

 
granularity

  

  

figure     average delays for the fcfs policy with independently varying numbers of lanes
and granularity  increasing the granularity beyond twice the number of lanes
results in only marginal improvements  all simulations were run for at least
        steps    lanes with   tile deadlocks and overflows the system memory
before         steps can complete 

if the intersection is clear  in these situations  a stop sign is often much more efficient than
a traffic light  because vehicles are never stuck waiting for a light to change when there is
no cross traffic  the protocol enables us to define such a control policy  and we compare it
experimentally to the other policies  note that this policy is much more efficient than an
actual stop sign  because once the vehicle has stopped at the intersection  the driver agent
and intersection can determine when the car may safely proceed much more precisely and
much less conservatively than a human driver 
      experimental setup
the simulator simulates   lanes in each of the   cardinal directions  the speed limit in all
lanes is    meters per second  every configuration shown is run for at least         steps in
the simulator  which corresponds to approximately half an hour of simulated time  vehicles
that are spawned turn with probability      and turning vehicles turn left or right with
equal probability  vehicles turning right are spawned in the right lane  whereas vehicles
turning left are spawned in the left lane  vehicles that are not turning are distributed
probabilistically amongst the lanes such that the traffic in each lane is as equal as possible 
fcfs and the stop sign  implemented as an extension of fcfssee section      both have
a granularity of    
      results
the results for the experiments are shown in figure     as expected  the average delay for
the optimal system is positive and nonzero  but very small 
   

fia multiagent approach to autonomous intersection management

fcfs performs very well  nearly matching the performance of the optimal policy  at
higher levels of traffic  the average delay for a vehicle gets as high as      seconds  but is
never more than   second above optimal  under none of the tested conditions does fcfs
even approach the delay of the traffic light system from the previous experiment  shown in
figure    a  
the stop sign does not perform as well as fcfs  but for low amounts of traffic  it
still performs fairly well  with average delay only about   seconds greater than optimal 
however  as the traffic level increases  performance degrades  it is difficult to imagine a
scenario in which this implementation of the stop sign would actually be usedit requires
the same technology as the reservation system  but does not have any advantages over
fcfs 
 
   

stop sign

 
   
delay  s 

traffic light minimum
 
   
 
   
 

optimal

   

fcfs

 
 

   

 

   

 

   

traffic level  vehicles s 

figure     delays for varying amounts of traffic for fcfs  the stop sign  and the optimal
system 

    allowing turns from any lane
in traditional traffic systems  especially those with traffic lights  vehicles wishing to turn
onto the cross street must do so from specially designated turning lanes  this helps prevent
cars that want to turn from holding up non turning traffic  however  with a system like
the reservation system  this restriction is no longer necessary  there is nothing inherent
in the reservation system that demands vehicles turn from any specific lane  investigating
the effects of allowing turning from any lane produced some surprising results  as seen in
figure     relaxing the restriction actually hurts fcfss performance slightly  while one
   

fidresner   stone

might think this allows the vehicles more flexibility  on average it increases the resources
used by any one turning vehicle  by making left turns from the left lane and right turns
from the right lane  vehicles both travel a shorter distance and reserve reservation tiles that
are less heavily used  however  these experiments may be misleading  vehicles changing
lanes to get into a designated turn lane could potentially delay vehicles behind them in the
process  because we do not currently model lane changing before the intersection  we have
not been able to experimentally verify this conjecture 
 
fixed lane
any lane

delay  s 

   

   

   

   

 
 

   

 
   
traffic level  vehicles s 

 

   

figure     comparison of an fcfs policy with traditional turns to one allowing turning
from any lane  allowing turns from any lane decreases performance slightly 
producing longer delays 

    the effects of human interoperability
in section      we showed that once all vehicles are autonomous  intersection associated
delays can be reduced dramatically  the following experiments suggest a stronger result 
by using the two light models presented in section        delays can be reduced at each stage
of adoption  furthermore  additional incentives exist at each stage for drivers to switch to
autonomous vehicles 
      experimental setup
for these experiments  the simulator models   lanes in each of the   cardinal directions 
the speed limit in all lanes is    meters per second  for each intersection control policy
with reservation tiles  the granularity is     the simulator spawns all vehicles turning left in
the left lane  all vehicles turning right in the right lane  and all vehicles traveling straight in
   

fia multiagent approach to autonomous intersection management

the center lane    unless otherwise specified  each data point represents        time steps 
or one hour of simulated time  our simulated human driven vehicles use a two second
following distance  but use the same lane following algorithm as the autonomous drivers 
they also employ a point of no return mechanism for reacting to lightsif the vehicle
can stop at a yellow or red light  it does  otherwise it proceeds 
      results
we present the experimental results for the human compatible policies in two parts  the
first focuses on how these policies can facilitate a smooth transition to an all autonomous or
mostly autonomous vehicle system  the second focuses on the incentives throughout this
process  both global and individual  to continue deployment of the system  combined  these
results suggest that an incremental deployment  one of the desiderata  is both technically
possible and desirable 
transition to full deployment the purpose of a hybrid intersection control policy
is to confer the benefits of autonomy to passengers with driver agent controlled vehicles
while still allowing human users to participate in the system  figure    shows a smooth
and monotonically improving transition from modern day traffic lights  represented by the
traffic light policy  to a completely or mostly autonomous vehicle mechanism  fcfslight with the single lane light model   in early stages           human   the alllanes light model is used  later on  less than     human   the single lane light model
is introduced  at each change  both in driver populations and light models   delays are
decreased  notice the rather drastic drop in delay from fcfs light with the all lanes
light model to fcfs light with the single lane light model  although none of the
results is quite as close to the minimum as pure fcfs  the single lane light model
allows for greater use of the intersection by the fcfs portion of the fcfs light policy 
which translates to higher efficiency and lower delay 
for systems with a significant proportion of human drivers  the all lanes light model
works wellhuman drivers have the same experience they would with the traffic light
policy  but autonomous driver agents have extra opportunities to make it through the
intersection  a small amount of this benefit is passed on to the human drivers  who may
find themselves closer to the front of the lane while waiting for a red light to turn green  to
explore how much the average vehicle would benefit  we ran our simulator with the fcfslight policy  the all lanes light model  and a            and     rate of human drivers 
this means that when a vehicle is spawned  it receives a human driver  instead of a driver
agent  with probability        and    respectively  as seen in figure     as the proportion of
human drivers decreases  the delay experienced by the average driver also decreases  while
these decreases are not as large as those brought about by the single lane light model 
they are at least possible with significant numbers of human drivers 
incentives for individuals even without any sort of autonomous intersection control
mechanism  there are incentives for humans to switch to autonomous vehicles  not having
   this is a constraint we will likely relax in the future  it is included in this work to give the single lane
light model more flexibility and for a fair comparison to the fcfs policy  which performs even better
in its absence 

   

fidresner   stone

  

  

   human

delay  s 

  

  
     human
  
   human

    human
  

fully autonomous
 
 

   

 
   
traffic level  vehicles s 

 

   

figure     average delays for all vehicles as a function of traffic level for fcfs light with
two different light models  the all lanes light model  which is well suited to
high percentages of human driven vehicles  and the single lane light model 
which only works well with relatively few human driven vehicles  as adoption
of autonomous vehicles increases  average delays decrease 

  

delay  s 

  

  

 
traffic light
fcfs light     human
fcfs light     human
 
 

    

   
traffic level  vehicles s 

    

 

figure     average delays for all vehicles as a function of traffic level for fcfs light
with the all lanes light model  shown are the results for            and
    human driven vehicles  the      case is equivalent to the traffic light
policy  note that the average delay decreases as the percentage of human driven
vehicles decreases 

to do the driving  as well as the myriad safety benefits are strong incentives to promote
autonomous vehicles in the marketplace  our experimental results suggest additional incentives  using our reservation system  autonomous vehicles experience lower average delays
than human driven vehicles and this difference increases as autonomous vehicles become
more prevalent 
figure    shows the average delays for human drivers as compared to autonomous driver
agents for the fcfs light policy using the all lanes light model  in this experiment 
half of the drivers are human  humans experience slightly longer delays than autonomous
vehicles  but not worse than with the traffic light policy  thus  by putting some
   

fia multiagent approach to autonomous intersection management

autonomous vehicles on the road  all drivers experience equal or smaller delays as compared
to the current situation  this is expected because the autonomous driver can do everything
the human driver does and more 
  
humans
autonomous
  

delay  s 

  
  
  
  
 
 
 

    

   
traffic level  vehicles s 

    

 

figure     average delays for human driven vehicles and all vehicles as a function of traffic
level for fcfs light with the all lanes light model  in this experiment 
    of vehicles are human driven  autonomous vehicles experience slightly
lower delays across the board  and human drivers experience delays no worse
than the traffic light policy 

once the reservation system is in widespread use and autonomous vehicles make up
a vast majority of those on the road  the door is opened to an even more efficient light
model for the fcfs light policy  with a very low concentration of human drivers  the
single lane light model can drastically reduce delays  even at levels of overall traffic that
the traffic light policy can not handle  using this light model  autonomous drivers can
pass through red lights even more frequently because fewer tiles are off limits at any given
time  in figure    we compare the delays experienced by autonomous drivers to those of
human drivers when only    of drivers are human and thus the single lane light model
can be used  while the improvements using the all lanes light model benefit all drivers
to some extent  the single lane light models sharp decrease in average delays  figure    
comes at a high price to human drivers 
as shown in figure     human drivers experience much higher delays than average  for
lower traffic levels  these delays are even higher than those associated with the trafficlight policy  figure    shows that despite this  at high levels of traffic  human drivers
benefit relative to traffic light  additionally  intersections using fcfs light will still
be able to handle far more traffic than those using traffic light 
the singlelane light model effectively gives the humans a high  but fairly constant
delay  because the green light for any one lane only comes around after each other lane has
had a green light  a human driven vehicle may find itself sitting at a red light for some time
before the light changes  however  since this light model would only be put in operation
once human drivers are fairly scarce  the huge benefit to the other     or     of vehicles
far outweighs this cost  a light model that detects and reacts to the presence of human
   

fidresner   stone

  
humans
autonomous
  

delay  s 

  

  

  

  

 
 

    

   
traffic level  vehicles s 

    

 

figure     average delays for human driven vehicles and all vehicles as a function of traffic
level for fcfs light with the single lane light model  humans experience
worse delay than with traffic light  but average delay for all vehicles is much
lower  in this experiment     of vehicles are human driven 

drivers might be able to achieve even better overall performance  without causing the human
drivers to wait as long 
these data suggest that there will be an incentive to both early adopters  persons
purchasing vehicles capable of interacting with the reservation system  and to cities or
towns  those with properly equipped vehicles will get where they are going faster  not
to mention more safely   cities and towns that equip their intersections to utilize the
reservation paradigm will experience fewer traffic jams and more efficient use of the roadways
 along with fewer collisions and less wasted gasoline   because there is no penalty to the
human drivers  which would presumably be a majority at this point   there would be no
reason for any party involved to oppose the introduction of such a system  later  when
most drivers have made the transition to autonomous vehicles  and the single lane light
model is introduced  the incentive to move to the new technology is increasedboth for
cities and individuals  by this time  autonomous vehicle owners will far outnumber human
drivers  who will still benefit when traffic is at its worst 
    emergency vehicle experiments
while we have already shown that fcfs on its own can significantly reduce average delays
for all vehicles  fcfs emerg helps reduce delays for emergency vehicles even further 
      experimental setup
to demonstrate this improvement  we ran the simulator with varying amounts of traffic 
while keeping the proportion of emergency vehicles fixed at       that is  a spawned vehicle
is made into an emergency vehicle with probability         because of the very small number
of emergency vehicles created with realistically low proportions  we ran each configuration
 data point  for     hours of simulated timemuch longer than the other experiments 
   

fia multiagent approach to autonomous intersection management

      results
as shown in figure     the emergency vehicles on average experience lower delays than
the normal vehicles  the amount by which the emergency vehicles outperform the normal
vehicles increases as the traffic increases  suggesting that as designed  fcfs emerg helps
most when more traffic is contending for space time in the intersection 
  

delay  s 

 

 

 

 
all vehicles
emergency vehicles
 
 

 

 
 
traffic level  vehicles s 

 

 

figure     average delays for all vehicles and emergency vehicles as a function of traffic
level for the fcfs emerg policy  one out of a thousand vehicles  on average 
is an emergency vehicle  delays for the emergency vehicles are lower for all data
points 

   performance in failure modes
fully autonomous vehicles promise enormous gains in safety  efficiency  and economy for
transportation  however  before such gains can be realized  a plethora of safety and reliability concerns must be addressed  in the previous sections  we have assumed that all
vehicles perform without gross malfunctions  in this section  we relax that assumption and
demonstrate how our reservation based mechanism reacts to scenarios in which such malfunctions occur  additionally  we intentionally disable some elements of the system in order
to investigate both their necessity and efficacy 
    causes of accidents
a collision in purely autonomous traffic can have any number of causes  including software
errors in the driver agent  a physical malfunction in the vehicle  or even meteorological
phenomena  in modern day traffic  such factors are largely ignored for two reasons  first 
the exclusively human populated system  with its generous margins for error  is not as
sensitive to small or moderate aberrations  second  none of these are significant with
respect to driver error as causes of accidents  wierwille  hanowski  hankey  kieliszewski 
lee  medina  keisler    dingus         however  in the future of infallible autonomous
driver agents  it is exactly these issues which will be the prevalent causes of automobile
collisions  the safety allowances explained in sections       and       are adjustablegiven
some maximum allowable error in vehicle positioning  the buffers can be extended to handle
   

fidresner   stone

that errorbut no reasonable adjustment can account for gross mechanical malfunction like
a blowout or failed brakes  because these types of issues are infrequent  we believe the safety
of the intersection control mechanism will be acceptable even if individual occurrences are
slightly worse than accidents today 
    adding a safety net
one can easily imagine how badly an accident in such an efficient system could be without
any reactive safety measures in place  here  we explain how the system deals with these
rare  but dangerous events  as we will show in section      disabling the safety measures
leaves the system prone to spectacular failure modes  sometimes involving dozens of vehicles 
intact  the measures make such events much more manageable 
      assumptions
in section      we will show how our reactive safety measures can reduce the average number
of vehicles involved in a crash from dozens to one or two  however  in order to employ these
safety measures fully  we must make a few additional assumptions 
detecting the problem first  we assume that the intersection manager is able to detect
when something has gone wrong  while this is certainly a non trivial assumption  without
it  no substantial mitigation is possible  simply put  the intersection manager cannot react
to something it cannot detect  there are two basic ways by which the intersection manager
could detect that a vehicle has encountered some sort of problem  the vehicle can inform
the intersection manager  or the intersection manager can detect the vehicle directly  for
instance  in the event of a collision  a device similar to that which triggers an airbag can
send a signal to the intersection manager  devices like this already exist in aircraft to emit
distress signals and locator beacons in the event of a crash  the intersection manager itself
might notice a less severe problem  such as a vehicle that is not where it is supposed to be 
using cameras or sensors at the intersection  however  this method of detection is likely
to be much slower to react to a problem  each has advantages and disadvantages  and a
combination of the two would most likely be the safest  the specifics of the implementation
are beyond the scope of this analysis  what is important is that whenever a vehicle violates
its reservation in any way  the intersection manager should become aware as soon as possible 
because our simulations only deal with collisions  we assume that the colliding vehicle sends
a signal and the intersection manager becomes aware of the situation immediately 
as described in appendix b  our protocol includes a done message that vehicles transmit when they complete their reservations  one way to reliably sense when a vehicle is in
distress would be to notice a missing done message  this approach has two drawbacks 
first  the done message is optional  mainly because there is no incentive for the driver
agent to transmit it  second  the intersection manager may not be able to notice the missing message until some time after the incident has occurred  we intend to investigate this
alternative in future work 
informing other vehicles we also assume that there exists a way for the intersection
manager to broadcast the fact that something is wrong to the vehicles  since the intersection manager can already communicate with the vehicles  this is not a big assumption 
   

fia multiagent approach to autonomous intersection management

however  the mode of communication is a bit different from that employed in the rest of the
communication protocol  see appendix b   under normal operating conditions  individual
messages each containing multiple pieces of information are transmitted between agents 
because we cannot verify the receipt of these messages without a response  the semantics of
the protocol ensure that whenever a message is sent  the sending agent makes the most conservative assumptionin the case of a request message  that it was not received  in the
case of a confirm message  that it was  in the event of a collision  however  the intersection
manager needs to communicate one bit of information to as many vehicles as possible  that
something is wrong  because it is very important that all vehicles receive this message  it
is transmitted repeatedly  to all vehicles  to the exclusion of all other messages  while we
would like to assume that all vehicles receive this message  we will show in section     that
even when a significant number of vehicles do not  the safety measures in place still protect
many vehicles that would otherwise wind up crashing 
      incident mitigation
when a vehicle deviates significantly from its planned course through the intersection resulting in physical harm to the vehicle or its presumed occupants  we refer to the situation
as an incident  once an incident has occurred  the first priority is to ensure the safety of
all persons and vehicles nearby  because we expect such incidents to be very infrequent
occurrences  re establishing normal operation of the intersection is a lower priority and the
optimization of that process is left to future work 
intersection manager response as soon as the intersection manager detects or is
notified of an incident  it immediately stops granting reservations  all subsequent received
requests are rejected without consideration  due to the nature of the protocol  the intersection manager cannot revoke reservations  as driver agents would have no incentive to
acknowledge their receipt  however  the intersection manager can send a message to the
vehicles that an incident has occurred  this message is the special emergency stop message  which the intersection manager may only send in an emergency situation  and which
 as with the rest of the protocol  it must assume has not been received 
the emergency stop message lets vehicles know that an event has taken place in the
intersection such that 
 no further reservations will be accepted
 vehicles able to come to a stop before entering the intersection should do so
 vehicles in the intersection should no longer assume that near misses will not result
in collisions
for human compatible policies  such as fcfs light  the intersection manager also
turns all lights red  in a real world implementation  a more conspicuous visual cue could
be provided  but semantically it is only important that the intersection informs the human
drivers that they may not enter 
vehicle response for the emergency stop message to be useful in any way  driver
agents must react to it  here we explain the specific actions our implementation of the driver
agent takes when it receives this message  normally  when approaching the intersection 
our driver agent ignores any vehicles sensed in the intersection  this is because what might
otherwise appear to be an imminent collision on the open road is almost certainly a precisely
   

fidresner   stone

coordinated near miss in the intersection  however  once the driver agent receives the
emergency stop message from the intersection manager  it disables this behavior  if the
vehicle is in the intersection  the driver agent will not blindly drive into another vehicle if
it can help it  if the vehicle is not in the intersection and can stop in time  it will not enter 
even if it has a reservation 
while our first inclination was to make the driver agent immediately decelerate to a
stop  we quickly realized that this is not the safest behavior  if all vehicles that receive the
message come to a stop  vehicles that would otherwise have cleared the intersection without
colliding may find themselves stuck in the intersectionanother object for other vehicles
to run into  this is especially true if the vehicle that caused the incident is on the edge of
the intersection where it is unlikely to be hit  trying to stop all the other vehicles in the
intersection just makes the situation worse 
if a driver agent does detect an impending collision  it should take evasive actions or
apply the brakes  since this is a true multiagent system with self interested agents  we
cannot prevent driver agents from doing so  even if it is detrimental to vehicles overall 
thus  our driver agent brakes if it believes a collision is imminent 
    experiments
in order to evaluate the effects of our reactive safety measures  we performed several experiments in which various components were intentionally disabled  the various configurations
can be separated into three classes  an oblivious intersection manager takes no action at all
upon detecting an incident  an intersection manager utilizing passive safety measures stops
accepting reservations  but does not send any emergency stop messages to nearby driver
agents  finally  the active configuration of the intersection managerwhich corresponds
to the full version of the protocol as specified in appendix bhas all safety features in
place  in addition to considering these three incarnations of the intersection manager  we
also study the effects of unreliable communication in the active case  note that when no
vehicles receive the emergency stop message  the active and passive configurations are
identical 
      experimental setup
with the great efficiency of the reservation based system comes an extreme sensitivity to
error  while buffering might protect against minute discrepancies  it cannot hope to cover
gross mechanical malfunctions  to determine just how much of an effect such a malfunction
would have  we created a simulation in which individual vehicles could be crashed  causing
them to immediately stop and remain stopped  whenever a vehicle that is not crashed
comes into contact with one that is  it becomes crashed as well  while this does not model
the specifics of individual impacts  it does allow us to estimate how a malfunction might
lead to collisions 
in order to ensure that we included malfunctions in all different parts of the intersection 
we triggered each incident by choosing a random  x  y  coordinate pair inside the intersection  and crashing the first vehicle to cross either the x or y coordinate  this is akin to
creating two infinitesimally thin walls  one horizontal and the other vertical  that intersect
at  x  y   figure    provides a visual depiction of this process 
   

fia multiagent approach to autonomous intersection management

figure     triggering an incident in the intersection simulator  the dark vehicle turning
left is crashed because it has crossed the randomly chosen x coordinate  if a different vehicle had crossed that x coordinate or the randomly chosen y coordinate
earlier  it would be crashed instead 

after initiating an incident  we ran the simulator for an additional    seconds  observing
any subsequent collisions and recording when they occurred  using this information  we
constructed a crash log  which is essentially a histogram of crashed vehicles  for each step
of the remaining simulation  the crash log indicates how many vehicles were crashed by
that step  by averaging over many such crash logs for each configuration  we were able to
construct an average crash log  which gives a picture of what a typical incident would
produce 
because our system is compatible with humans  we included experiments with a humancompatible intersection control policy  as demonstrated in section      when a significant
number of human drivers are present  the fcfs light cannot offer much of a performance
benefit over traditional traffic light systems  as such  we limited our experimentation to
scenarios in which    of the vehicles are controlled by simulated human drivers  and used
a single lane light model  see section         with only    human drivers  an fcfslight policy can still create a lot of the precarious situations that are the focus of this
investigation 
for these experiments  we ran our simulator with scenarios of          and   lanes in
each of the four cardinal directions  although we will discuss results only for the    and
  lane cases  other results were similar  for the sake of brevity  as with earlier experiments 
vehicles are spawned equally likely in all directions  and are generated via a poisson process
which is controlled by the probability that a vehicle will be generated at each step  vehicles
are generated with a set destination    of vehicles turn left      turn right  and the
remaining     go straight  as before  the leftmost lane is always a left turn lane  while the
right lane is always a right turn lane  turning vehicles are always spawned in the correct
lane  and non turning vehicles are not spawned in the turn lanes  in scenarios involving only
autonomous vehicles  we set the traffic level at an average of       vehicles per second per
lane in each direction  this equates to   total vehicles per second for   lanes  and    total
   

fidresner   stone

vehicles per second for   lanes  scenarios with human driven vehicles had one third the
traffic of the fully autonomous scenariosthe intersection cannot be nearly as efficient with
human drivers present  we chose these amounts of traffic as they are toward the high end of
the spectrum of manageable traffic for the respective variants of the intersection manager 
while we wanted traffic to be flowing smoothly  we also wanted the intersection to be full
of vehicles to test situations that likely lead to the most destructive possible collisions 
      how bad is it 
as we suspected  the average crash log of the oblivious intersection manager is quite grisly 
as explained in section        driver agents must ignore their sensors while in the intersection  because many of the close calls would appear to be impending collisions  without
any way to react the situation going awry  vehicles careen into the intersection  piling up
until the entire intersection is filled and crashed vehicles protrude into the incoming lanes 
figure    shows that for both   lane casesfully autonomous and    human driversthe
rate of collisions does not abate until over    vehicles have crashed  even a full    seconds
after the incident begins  vehicles are still colliding  in the   lane case  the intersection
is much smaller and thus fills much more rapidly  by    seconds  the number of collided
vehicles levels off 
   

  
  lanes
  lanes

  

  lanes
  lanes
  

  

cars crashed

cars crashed

  
  
  
  

  

  

  

  
  

  

  
 

  

  

  

  

  

  

 

time  s 

  

  

  

  

  

  

time  s 

 a  all autonomous

 b     humans

figure     average crash logs  with     confidence interval  for    and   lane oblivious
intersections  in    a   the intersection manages only autonomous vehicles 
while    b  includes    human drivers 

in both of the scenarios with human drivers  shown in figure    b   the number of vehicles involved in the average incident is noticeably smaller  this outcome is likely the result
of two factors  first and foremost  the fcfs light policy must make broad allowances
to accommodate the human drivers  and thus overall is inherently less dangerous  the
characteristic close calls from the standard fcfs policy are less common  second  the
simulated human driver agents do not drive blindly into the intersectiontrusting to the
intersection managerthe way the autonomous vehicles do  also of note in figure    b 
is the visible periodicity of the light model portion of the policy  as paths open up for
   

fia multiagent approach to autonomous intersection management

autonomous vehicles due to changes in the lights  they drive unwittingly into the growing
mass of crashed cars 
      reducing the number of collisions
there are two main components to the safety mechanism introduced in section      first 
the intersection manager stops accepting reservations  second  the intersection manager
sends messages informing the driver agents that an incident has taken place  there is a
possibility that this second part might not always work perfectly  some vehicles might not
receive the message  to investigate the effects of these potential communication failures 
we intentionally disabled some of the vehicles ability to receive the emergency stop
message  a parameter in our simulator controls the fraction of vehicles created with this
property  and by varying this parameter  we could observe its subsequent effect on the
average number of vehicles involved in incidents 
as compared to the oblivious intersection manager  the number of vehicles involved in
the average incident for an active intersection manager decreases dramatically  table  
shows the numerical results for both the    and   lane intersections  along with a    
confidence interval  the average crash logs for these runs are not shown in figure     as
they would be indistinguishable from one another at that scale  instead  we present them
in figure    

oblivious
passive
active
    receiving
    receiving
    receiving
    receiving
     receiving

fully autonomous
  lanes
  lanes
                   
                   

   human
  lanes
  lanes
                   
                   

         
         
         
         
         

         
         
         
         
         

         
         
         
         
         

         
         
         
         
         

table    average number of simulated vehicles involved in incidents for    and   lane intersections  even with only the passive safety measures  the number of crashed
vehicles is dramatically decreased from the oblivious intersection manager  in the
active configuration  as more vehicles receive the emergency signal  the number of
crashed vehicles decreases further 
figure    shows the effects of the reactive safety measures in intersections with   lanes 
with the proportion of receiving vehicles varying from     passive  to      in increments
of      even in the passive configuration  the overall number of vehicles involved in the
average incident decreases by a factor of almost    in the fully autonomous scenario  and
a factor of over    in the scenario with    human drivers  as compared to the oblivious
intersection manager  as expected in the active configuration  when more vehicles receive
the emergency signal  fewer wind up crashing  the graphs in figure    only show the first
   

fidresner   stone

   seconds of the incident  because in no case did a collision occur more than    seconds
after the incident started 
   

   
passive
    receiving
    receiving
    receiving
    receiving
     receiving

 
cars crashed

cars crashed

 

passive
    receiving
    receiving
    receiving
    receiving
     receiving

   

   

 

   
   
   

   
   
 

 
 

 

 

 

 

  

  

  

 

time  s 

 

 

 

 

  

  

  

time  s 

 a  all autonomous

 b     humans

figure     the first    seconds of average crash logs for   lane passive and active intersections  as more vehicles react to the signal  safety improves 

      reducing the severity of collisions
while it is reassuring to know that the number of vehicles involved in the average incident
can be kept fairly low  these data do not give the entire picture  for example  compare an
incident in which    vehicles each lose a hubcap to one in which two vehicles are completely
destroyed and all occupants killed  while we do not currently have any plans to model the
intricate physics of each individual collision with high fidelity  our simulations do allow us
to observe the velocity at which the collisions occur  in the previous example  we might
notice that the    vehicles all bumped into one another at low velocities  while the two
vehicles were traveling at full speed  to quantify this information  we record not only when
a collision happens  but the velocity at which it happens  in a collision  the amount of
damage done is approximately proportional to the amount of kinetic energy that is lost 
because kinetic energy is proportional to the square of velocity  we can use a running total
of the squares of these crash velocities to create a rough estimate of the amount of damage
caused by the incident  figure    shows an average damage log of a   lane intersection
of autonomous vehicles  qualitatively similar results were found for the other intersection
types 
as figure    a  shows  the effect of our safety measures under this metric is quite
dramatic as well  in the passive case the total accumulated squared velocity decreases by
a factor of over     in the active case  with all vehicles receiving the signal  it decreases
by another factor of    of particular note is the zoomed in graph in figure    b   in the
passive configuration  the total squared velocity accumulates as if the intersection manager
were oblivious  until the first vehicles stop short of the intersection at around   seconds 
without a reservation  they may not enter  in the active scenario  when all the vehicles
receive the message  the improvement is almost immediate 
   

fia multiagent approach to autonomous intersection management

    
oblivious
passive
active

   

     

accumulated squared velocity  m  s  

   

accumulated squared velocity  m  s  

     

     

     

     

    

 

oblivious
passive
active

    
    
    
    
   
   
   
   

 

  

  

  

  

  

  

 

 

 

 

time  s 

 

 

 

 

time  s 

 a  the average incident

 b  zoomed in

figure     average total squared velocity of crashed vehicles for a   lane intersection with
only autonomous vehicles  sending the emergency message to vehicles not only
causes fewer collisions  but also makes the collisions that do happen less dangerous 

      delayed incident detection
implicit in these results is the assumption that intersection managers become aware of
incidents instantaneously  while this could be the case in many collisionsvehicles should
communicate when they have collidedif a vehicles communications are faulty  or if the
vehicle does not realize it has collided  the intersection may not discover the problem for a
few seconds  when another vehicle or sensor will detect the problem  to assess the effects
of delayed incident detection  we artificially delayed the intersection managers response in
some of our simulations  figure    shows the results from these experiments 
 

 
number of crashed vehicles

number of crashed vehicles

 s delay
   
 

 s delay

   
 s delay

 

no delay

   
 

   
g

vin

ei

 
 

   

  

ay

 

 s

l
de

c
re

g

 s delay      receivin

   
 
   
 

 

 

 

 

 

  

 

time  s 

 

 

 

 

  

time  s 

 a  delaying detection

 b  delays and faulty communication

figure     crash logs showing the effects of delayed incident detection 
in figure    a   the intersection managers reaction was delayed          and   seconds 
note that the total number of crashed vehicles with a delay of   seconds is on par with the
number in the experiment in which the intersection manager reacts immediately  but none of
   

fidresner   stone

the vehicles receive the message  shown in figure    a   figure    b  shows what happens
with both delayed detection and faulty communication  this graph  along with the earlier
results  suggests that for small values  each second of delay is approximately equivalent to
    of vehicles not receiving the emergency stop message  and that when combined 
delayed detection and faulty communication have an additive effect  for larger delays  the
number of vehicles involved can be approximated using the data shown in figure    a  
because in these cases  the number of vehicles that crash after the intersection is much
smaller than the number that crash before it reacts 
    safety discussion
the results in this section suggest that it may be possible to improve efficiency while also
improving safety  but of course before deployment in the real world  extensive testing with
real vehicles would be needed in order to verify both the suggested efficiency benefits  as
well as the safety properties of the system  people are often hesitant to put their wellbeing  physical or otherwise  in the hands of a computer unless they can be convinced that
they will receive a significant safety benefit in exchange for surrendering precious control 
humans often suffer from the overconfidence effect  erroneously believing they are more
skillful than others  in a      survey of swedish drivers  respondents were asked to rate
their driving ability in relation to others  a full     of those asked placed themselves in
the top     of drivers  svenson         it is this effect that creates the high standard to
which computerized systems are held  it is insufficient for such systems to be marginally
safer  or safer for the average user  they must be the very paragon of safety 
in our experiments  we showed that the number of vehicles involved in individual incidents can be drastically reduced by utilizing a fairly straightforward reactive safety mechanism  in fact  in the active configuration with   lanes      of the incidents involved only
one vehicle  the one we intentionally crashed      for   lanes   even in the passive case
with   lanes of traffic  an average of only      vehicles were involved  but how does this
compare with current systems  if we conservatively assume that accidents in traffic today
involve only one vehicle  this represents a      increase per occurrence  thus  all other
things being equal  if the frequency of accidents can be reduced by      these experiments
suggest that an autonomous intersection management system will be safer overall  a     
report for the u s  federal highway administration blamed over     of all accidents on
driver error  wierwille et al          the remaining accidents were divided equally between
vehicle failures and problems with roads  it is important to note that these numbers are for
all driving  not just intersection driving  accidents in intersections are even more likely to
be caused by driver error  sometimes even by drivers willfully disobeying the law  running
red lights and stop signs or making illegal u turns 
even if we make overly conservative assumptionsthat all driving is as dangerous as intersection driving  and that driver error is no more accountable for intersection crashes than
it is in other types of drivingour data suggest that automobile traffic with autonomous
driver agents and an intersection control mechanism like ours will reduce collisions in intersections by over      we believe that in reality  the improvement will be much greater 
the safety measures presented in this section constitute just one approach for mitigating
the systems failure modes  more sophisticated methods involving explicit cooperation
   

fia multiagent approach to autonomous intersection management

amongst vehicles may create an even safer system  we have not shown  or attempted
to show  that this particular solution is the best possible  rather we have demonstrated
that even with a simple and straightforward response to accidents  the overall safety of the
system can be maintained  without sacrificing the benefits of vastly improved efficiency 

   related work
traffic control is a vast area of research for computer scientists and engineers alike  the field
of intelligent transportation systems  its  is concerned with applying information  computing  and sensor technologies to solve problems in traffic and road management  bishop 
       its includes intelligent vehicles  iv  as well as infrastructure  such as intersections  unfortunately  while both aspects of its are heavily studied  relatively little current
research considers how intelligent or autonomous vehicles and infrastructure can work together to improve the efficiency and safety of the overall traffic system  the berkeley
path project has produced a lot of interesting work  including work on a fully automated
highway  alvarez   horowitz        
in this section  we describe some work related to our own  both directly and tangentially  some of this work is specifically concerned with intersection control  some takes a
multiagent approach to other aspects of traffic management  and some represents work on
the technologies necessary to bring fully autonomous vehicles into the mainstream 
    requisite technology
before autonomous vehicles can take over the roads  they will need to be able to interact
with all the aspects of roadways  including pedestrians  other vehicles  and lanes  as early
as       a driver agent system named ulysses had been developed in simulation  reece
  shafer         while most systems currently under development for implementation on
real vehicles are geared toward assisting human drivers  many of the technologies created
through these efforts are applicable to the creation of a completely autonomous driver
agent  such a successful driver agent needs to do three main things  detect other entities
on the road  keep its vehicle in the lane  and maintain safe distances from other vehicles 
fortunately  each of these three subtasks currently attracts an extensive amount of research 
      object detection and tracking
a fully autonomous vehicle must be able to reliably detect  classify  and track various objects
that may be in the roadway  from pedestrians and bicycles to cars and trucks  autonomous
vehicles will require robust sensors that can monitor the world around them in all manner
of lighting conditions and weather  without such abilities  any amount of higher reasoning
a driver agent can do is irrelevant  fortunately  researchers are attacking this problem with
many techniques 
in       honda introduced an intelligent night vision system to the japanese market
capable of detecting pedestrians  liu   fujimura         the system uses two far ir
 fir  cameras on the front of the vehicle to detect heat emitting objects beyond the range
illuminated by the vehicles headlights  the two cameras allow the system to obtain distance
information about the detected pedestrians and can then warn the driver  daimlerchrysler
   

fidresner   stone

is developing a similar system that also extrapolates the trajectories of classified objects
in order to predict possible outcomes sooner  gavrila  giebel    munder         mahlisch
et al         have developed a sensor fusion technique that can glean information about
pedestrians reliably even from low resolution images 
the ford motor company has been investigating how to track vehicles using both color
and shape information  she  bebis  gu    miller         gepperth et al         have
demonstrated that with only gray valued videos  no color   a two stage  initial detection
and confirmation  mechanism using a simple neural network for confirmation can reliably
and quickly classify other vehicles 
vehicle and pedestrian classification and tracking is a well studied area of iv research
that is progressing quickly  a glance at any iv related conference or symposium will reveal
a plethora of articles aimed at using lidar  fir  normal video  and any combination of these
sensors with algorithms like kalman filters  particle filters  and neural networks to track
and classify other objects on the road 
      lane following
as with pedestrian and vehicle detection and tracking  lane following is a heavily studied area of iv research  varying from passive lane  and road departure warning systems
 ldws rdws  to active lane keeping assistance  lka   many systems are already showing up in production vehicles 
as far as rdws go  kohl et al         have used neuroevolution to create a warning
system that can warn drivers of both road departure and impending crashes with other
vehicles  the system was tested both in simulation and with a robotic vehicle  this work is
sponsored by toyota  who have also currently have an ldws on the market in japan  this
system is unique in that it uses a rear facing camera to predict and warn of impending lane
departures  while ldws and rdws promise extensive benefits to drivers  they only warn
of imminent road and lane departures  and do not provide information on what specific
action should be taken  autonomous vehicles will need to ensure they do not reach a point
where a lane or road departure is imminent 
lane keeping  on the other hand  provides and executes actions  for example  the no
hands across america project in      drove a vehicle       miles from pittsburgh to los
angeles  for       of the journey  the vehicle steered itself  pomerleau         more recent
projects have concentrated on making such systems robust to varying speed  inclement
weather and poor lighting conditions such as beneath overpasses and in tunnels  wu et
al         have proposed and tested a vision based lane keeping system that can operate at
varying speed while providing smooth human like steering  watanabe and nishida        
working for toyota  have developed a lane detection algorithm specifically designed for
steering assistance systems that is extremely robust to varying road conditions and lighting 
while several lka systems are on the market in japan  these systems are not intended
to allow autonomous driving  rather  they attempt to reduce driver fatigue and make
turning more stable  bishop         production systems that allow autonomous steering
are almost invariably based on specially painted lines and are limited to special vehicles on
closed courses 
   

fia multiagent approach to autonomous intersection management

even without the benefit of explicitly designated lanes  autonomous vehicles can keep
themselves on the roadway  in the      darpa grand challenge  darpa         the
winning vehicle  stanley  used a technique fusing short range laser range finders with
long range video cameras to follow a rough dirt path  first  the vehicle found smooth areas
in front of it using the laser range finders  then it mapped this information onto video
images from forward facing cameras  by determining the color of the area in the image
corresponding to the smooth areas found by the laser range finder  stanley was able to
extrapolate using a flood fill type algorithm to find which areas of the video image were on
the dirt path  nova         ramstrom and christensen        achieved a similar goal by
using a strategy based on a probabilistic generative model 
      adaptive cruise control
if lane keeping systems represent the main lateral component of an autonomous vehicles
driver agent  then adaptive cruise control  acc  is the main longitudinal component  acc
allows a vehicle to maintain a safe following distance and can react quicker than a human
driver in the case of sudden deceleration by the vehicle in front  acc systems are already
available on the marketdaimlerchryslers mercedes benz s class  for example  comes with
a system that will automatically apply the brake if it detects that the driver is not slowing
sufficiently fast  jaguar  honda  and bmw offer similar systems  nissan and toyota have
recently begun offering low speed following systems  which can follow other vehicles in
slower  denser  urban traffic scenarios  bishop         acc relies on robust sensing and
uses radar  lidar  and traditional machine vision algorithms  by combining various flavors
of acc  low speed  high speed  etc an agent could control the longitudinal motion of a
vehicle in all situations  recently  the notion of cooperative adaptive cruise control  cacc 
has emerged  laumonier  desjardins    chaib draa         this concept goes much further
toward realizing the goal of fully autonomous vehicles  by allowing vehicles to collaborate
and take advantage of the precision of autonomous driver agents  vehicles can use the
existing road space much more efficiently 
    intersection collision avoidance
to date  much of the its work relating to intersections has focused on intersection collision
avoidance  ica   this work seeks to warn the driver when the vehicle may be entering an
intersection unsafely  with the aid of high precision digital maps and gps equipment  the
vehicle detects and classifies the state of the traditional signaling systems placed at the
intersection  lindner  kressel    kaelberer         ica systems typically do not take any
action on behalf of the driver  but simply provide a visual or auditory warning 
rasche and naumann                    have worked extensively on decentralized solutions to intersection collision avoidance problems  including those involving autonomous
vehicles  this work is very similar to ours in that it uses potential points of collision
to restrict access to the intersection  only one vehicle may occupy any potential point of
collision at a time  vehicles attempt to obtain a token  similar to a token ring in computer networking  for each point needed to cross the intersection  once a vehicle has all
the necessary tokens  it may cross  rasche and naumanns system also includes a priority
model that allows emergency vehicles to cross more quickly and prevents deadlocks amongst
   

fidresner   stone

normal vehicles  however  the system fails to satisfy several of our desiderata  it does not
make any guarantees  nor do the authors provide any results regarding the efficiency of the
system as compared to a traditional system  furthermore  the distributed algorithm is not
shown to be resilient to unreliable communication  the authors also do not provide any
insight into how the system could be adapted to work with a mixed human autonomous
vehicle population  the most striking difference  however  is that the mechanism does not
seem to have any notion of planning ahead  tokens for the potential points of collision
are either taken or not takena vehicle can not seek to obtain a token for some point in
the future  thus allowing it to proceed toward the intersection without slowing down while
other vehicles have the tokens 
in the context of video games and animation  reynolds        has developed autonomous steering algorithms that attempt to avoid collisions in intersections that do not
have any signaling mechanisms  such a system would have the enormous advantage of not
requiring any special infrastructure or agent at the intersectionvehicles equipped with
such algorithms could operate at any intersection  unfortunately  the two main drawbacks
of the system make it unsuitable for use with real life traffic  first  the algorithm does not
let the agent choose which path it will take out of the intersection  a vehicle may even find
itself exiting the intersection the same way it came in  due to efforts to avoid colliding with
other vehicles  second  the algorithm only attempts to avoid collisionsit does not make
any guarantees about safety 
cooperative intersection collision avoidance is a form of cooperative vehicle highway system  cvhs  in which the intersection is allowed to participate in the ica problem  ica
systems contained entirely in individual vehicles cannot account for gaps in sensor views
or other sources of incomplete information  thus  a cvhs approach is required  as with
many other its technologies  production systems still assume a human driver and attempt
to warn them when a violation is about to occur  or in some cases  punish them after the
fact  as with cameras that detect when a vehicle has run a red light and automatically
issues the driver a citation  the u s  department of transportation is sponsoring several ica projects including both infrastructure only and cooperative approaches  usdot 
       the intention is to first deploy the infrastructure only systems  and then as the
market penetration of ica equipped vehicles increases  to roll out the cooperative systems 
significant work on ica is also underway in japan  bishop        
while these systems are a large step toward enabling autonomous vehicles to take to the
roads  none are designed to work specifically with autonomous vehicles  with the exception
of the algorithm designed for games  each assumes both a human driver and traditional
signaling systemsa clumsy  inefficient interface that will find itself all but obsolete due to
autonomous vehicle technology 
    optimizing traffic signal timing
the vast majority of deployed technology for intersection control involves calibrating the
timing of traditional traffic lights in order to create a wave of green such that once vehicles
reach one green light  they continue through all subsequent intersections without having to
stop  unfortunately  in practice  such waves tend to be sporadic and short lived due to
   

fia multiagent approach to autonomous intersection management

rapidly changing traffic patterns  however  they do offer substantial benefits compared to
systems without this coordination 
transyt  the traffic network study tool  is an off line system that  given average
traffic flows  can determine optimum fixed time coordinated traffic signal timings  robertson         transyt requires extensive data gathering and analysis  but is used very
heavily all over the world  unfortunately  this system is very brittle because it does not
have the ability to react to unusual changes in traffic flow  for example  at the end of a
major sporting event  thousands of vehicles may all be attempting to cross an intersection
in a direction which under normal circumstances is rarely used  because the light timings
are set up to reflect these normal circumstances  the length of time for which the departing
vehicles get a green light may be significantly less than the cross traffic  of which there may
be little 
scoot  the split  cycle  and offset optimisation technique  represents an advancement over transyt  hunt  robertson  bretherton    winton         scoot is an
on line adaptive traffic control system that can react to changes in traffic levels  give priority to vehicles such as buses  and even estimate vehicle emissions  while scoot has been
shown to reduce traffic delays by an average of     over systems like transyt  it still
relies on traditional signaling systems and vehicles  furthermore  scoot requires reliable
traffic data in order to adapt  and thus may be slow to react to changes in traffic flow 
    mas and traffic
automobile traffic is a great example of a multiagent system  and it is not surprising that
there is a lot of research into modelling and studying traffic using multiagent techniques 
many of these approaches consider systems consisting only of traffic light controlling agents
or driver agents  as opposed to a heterogeneous multiagent system with many kinds of
agents  nevertheless  many of the ideas involved could potentially be adapted to work
within the framework of the reservation system 
      cooperative traffic signals
much of mas traffic research focuses on improving current technology  systems of traffic
lights   for example  roozemond        allows intersections to act autonomously while
sharing the data they gather  the intersections then use this information to make both
short  and long term predictions about the traffic and adjust accordingly  this strategy
attempts to overcome one of the weaknesses of scoot  the need for large amounts of
reliable traffic data  if multiple intersections can share data  each intersection will get a
more accurate picture of the current traffic situation 
bazzan        has used a decentralized approach combining mas and evolutionary
game theory  the approach models each intersection as an individually motivated agent
which must focus not only on local goals  getting vehicles through the intersection   but
also on global goals  reducing travel times for all vehicles   both bazzan and roozemonds
techniques still assume traditional signaling mechanisms and human drivers 
   

fidresner   stone

      platoons
in addition to multi intersection systems  multi vehicle systems are the focus of a lot of
research  much of this research centers on creating platoons of vehicles in order to minimize
the effects of stop and go driving  consider a line of cars stopped at a red light  when the
light turns green  the first car begins to move  eventually  the car behind it notices that
it has enough space to accelerate as well  some time later  the vehicle at the back of the
line will begin to move  but this may be too late to actually get through the intersection
during the current green phase of the light  if  on the other hand  all the vehicles were to
simultaneously and uniformly accelerate  more vehicles could make it through each green
phase  because the vehicles would more efficiently use the space time available to them to
cross the intersection 
clement        has proposed a model called simple platoon advancement  spa  
which addresses this exact problem  spa boasts the ability to get nearly twice as many
vehicles through a green light  increasing the lights throughput  as compared to normal
human drivers  in addition to any safety and delay benefits associated with automated control  one the vehicles are through the intersection and dispersed to safe following distances 
control is returned to the human driver 
halle and chaib draa        have used the platoon approach to facilitate collaborative
driving in general  they allow vehicles  which are controlled by separate agents  to form
such platoons  with varying degrees of autonomy  vehicles merge and split with platoons
using carefully crafted maneuvers  during which each vehicle in the platoon has a specific
responsibility  they present both centralized version  in which a master vehicle gives orders
to the rest of the platoon  and a decentralized version  in which social laws dictate each
agents role  while the platoons leader acts only as a representative to other platoons 
both platooning systems assume automated control of vehicles  but use ordinary traffic
lights for intersection control  by using platoons  these methods attempt to solve a problem
inherent in the traffic lights themselvesthey are designed for humans to use  and are not
well suited to automated vehicle control  the work presented in this article attempts to
free autonomous vehicles from the control of traffic lights and instead design a new system
that specifically utilizes the capabilities of fully autonomous vehicles 
      history based traffic control
taking a different approach to intersection control  balan and luke        use a historybased method to maximize fairness  all vehicles experience similar delays  as opposed to
efficiency  the average vehicle experiences short delays   under this paradigm  vehicles
which have historically  previously in their journey  experienced long delays should be
more likely to experience shorter delays at subsequent intersections  in addition to being
a multi intersection approach  this method uses a marketplace model involving a system of
credits that can be given and taken in exchange for shorter and longer delays  respectively 
coordination at individual intersections is still done with traditional traffic lights  the timings of which are part of the mechanism  interestingly  the fairness approach actually yields
results that are also reasonably efficient 
   

fia multiagent approach to autonomous intersection management

    machine learning and traffic
abdulhai et al         have used q learning  a simple  yet powerful form of reinforcement
learning  to do on line adaptive signal control  in the work  the authors explore both an
isolated intersection as well as a linear chain of intersections  they demonstrate that qlearning can significantly reduce delays for vehicles and quickly adapt to changing traffic
patterns  bull et al         have shown how learning classifier systems  lcs  can also make
traditional traffic signals more efficient  wiering        has demonstrated that multiagent 
model based reinforcement learning can also be used to optimize signal timings in more
complex networks of intersections 
while not focusing on intersections  moriarty and langley        have shown that
reinforcement learningspecifically neuro evolutioncan train efficient driver agents for
lane  speed  and route selection during freeway driving  all of which are critical components
for a fully autonomous vehicle  additionally  many of the object tracking and detection
examples mentioned previously use neural networks to classify objects 
    physical robots
on real autonomous vehicles  kolodko and vlacic        have created a small scale system
for intersection control which is very similar to the granularity   fcfs policy  the authors
developed the mechanism for small cooperative autonomous mobile robots  camrs  
which are about    cm in diameter and have a top speed of    cm s  the camrs were
programmed to follow australian traffic laws  and communicate with several different types
of messages  once demonstrated on the camrs  the mechanism was scaled up to use imara
vehicles  which are much larger  capable of carrying two human passengers  and faster  top
speed of    km h   the system is completely distributed and does not require extensive
infrastructure at the intersection  however  it does assume that all vehicles cooperate with
one another 
    safety analysis
section   includes a failure mode analysis for our proposed intersection control mechanism  to the best of our knowledge  this is the first study of the impact of any other
such autonomous intersection protocol on driver safety  however  there is an enormous
body of work regarding safety properties of traditional intersections  this includes the
generalcorrelating traffic level and accident frequency  sayed   zein        and analyses
of particular types of intersections  bonneson   mccoy        harwood  bauer  potts  torbic  richard  rabbani  hauer  elefteriadou    griffith        persaud  retting  gardner 
  lord       as well as plenty of more esoteric work  such as characterizing the role
of alzheimers disease in intersection collisions  rizzo  mcgehee  dawson    anderson 
       however  because it concerns only human operated vehicles  none of this work is
particularly applicable to the setting we are concerned with 

   conclusion and future work
the reservation system as presented is a large step toward easing our traffic woes  in terms
of both wasted time and injury or loss of life  however  substantial work must still be done
   

fidresner   stone

before the system is ready to deploy  some of this work represents possible future directions
for this line of research  for example  more detailed studies of the safety properties of the
systemhow it reacts to various failures and whether the effects of those failures can be
mitigatedare required  another area ripe for improvement is the intersection manager 
a manager that can switch among several different policies  learning from reservation histories which policy is best suited to particular traffic conditions  could significantly improve
performance  furthermore  a light model that could react not only to traffic conditions  but
also to the presence of individual vehicles  might better be able to exploit the abilities of
autonomous vehicles  without adversely affecting human drivers  framing the intersection
as a marketplace and space time as a commodity could allow the system to handle vehicle priorities more intelligently or allow driver agents to exchange a long wait on one day
for quick passage on some later  more important day  finally  the driver agent itself may
be able to benefit from some machine learning techniques  perhaps learning to make more
accurate reservations and thus needing to cancel less frequently 

this article makes three main contributions  first  it defines the problem of autonomous
intersection management  including a set of desiderata by which potential solutions can be
evaluated  second  it presents a framework that can meet all of these desiderata  and an
algorithm  fcfs  that shows the advantages of the framework over current intersection
control methods  third  it demonstrates how the framework can be extended to allow
human driven  not autonomous  vehicles to use the system  while still exploiting the abilities
of the autonomous vehicles to increase throughput and subsequently decrease delays 

getting from where we are today to a future in which humans are no longer burdened
with the mundane yet dangerous task of piloting automobiles will involve a vast amount of
work in many different disciplines  while it does not extensively address the engineering or
societal challenges involved in building and deploying such a system  this article suggests
that it is both algorithmically feasible and worthwhile  in terms of decreasing delay  to do
so 

acknowledgments

this research is supported by nsf career award iis          and experiments were
carried out on machines provided by nsf grant eia         
   

fia multiagent approach to autonomous intersection management

appendix a  simplified laser range finder
this appendix describes an implementation detail of the driver agents sensor model  recall
from section       that each driver has access to a set of simulated external sensors  in this
set is a simplified laser range finder  which is intended to give the agent the same type of
information as an actual laser range finder  but without the expensive computation required
to fully simulate the sensor  instead  the simplified laser range finder sensor examines each
vehicle within sensor range and determines which is closest to the front of the sensing
vehicle  then  it records the point on that vehicle that is closest to the sensing vehicle and
provides the distance and angle to this point 
modern laser range finders and distance sensors can provide a large amount of distance
and angle data to a mobile agent  in a real life setting  this information would definitely
prove useful in fine tuning a driver agent  however  in a simple simulation  we must process
sensor information for all vehicles simultaneously  and accurately simulating a full laserrange finder is not feasible  thus  we use this simple  yet pertinent sensor reading which
the driver agent can use to control its actions with respect to the other vehicles  a purely
straight ahead sensor suffices when vehicles are traveling only in straight lines  however 
when a vehicle turns  it must also take into account what is going on in the direction in
which it is turning  to complicate matters  when a vehicle is turning it must still take into
account what is going on directly in front of it because at any point it might straighten
its wheels and continue on its current heading  a sensor that points in the same direction
as the wheels will not be sufficient because vehicles coming out of turns may run into
vehicles ahead of them  instead  our sensors scope widens in the direction of the turn 
while narrowing slightly from the other side  figure    shows a scenario that demonstrates
the concept  a testament to the sensors usefulness  vehicles equipped with only the sensor
 i e  no intersection manager is present  are able to avoid many collisions in the intersection 
even with moderate amounts of traffic 

appendix b  communication protocol
section     gave a brief introduction to the communication protocol used by the agents in
the reservation system  in this appendix  we specify the protocol with much greater detail 
the protocol consists of several message types for each kind of agent  as well as some rules
governing when the messages should be sent and what sorts of guarantees accompany them 
in this section we present those aspects that are essential to understanding the remainder
of the article 
b   message types
the vehicles and intersection manager are each restricted to a few types of messages with
which they must coordinate 
b     vehicle  intersection
there are four types of messages that can be sent from vehicles to the intersection 
   

fidresner   stone

figure     a depiction of the sensor model for the driver agents  the sensor is focused
between the gray lines and does not provide information outside of them  the
black line represents the reading provided to the driver agent 

   request  this is the message a vehicle sends when it does not have a reservation
and wishes to make one  it contains the properties of the vehicle  id number  performance  size  etc   as well as some properties of the proposed reservation  arrival time 
arrival velocity  type of turn  arrival lane  etc    the message also communicates the
vehicles status as an emergency vehicle  in an emergency situation   in practice  this
would be implemented using a secure method such that normal vehicles could not
impersonate emergency vehicles  such methods are well understood and the details
of the implementation are beyond the scope of this research 
this message has    fields 
vehicle id  a unique identifier for the vehicle 
arrival time  the absolute time at which the vehicle agrees to arrive at the intersection 
arrival lane  a unique identifier for the lane in which the vehicle will be when it
arrives at the intersection 
turn  which way the vehicle will turn when it reaches the intersection 
arrival velocity  the velocity at which the vehicle agrees to be traveling when
it arrives at the intersection 
maximum velocity  the maximum velocity at which the vehicle can travel 
maximum acceleration  the maximum rate at which the vehicle can accelerate 
   

fia multiagent approach to autonomous intersection management

minimum acceleration  the minimum rate at which the vehicle can accelerate  i e 
negative number representing maximum deceleration  
vehicle length  the length of the vehicle 
vehicle width  the width of the vehicle 
front wheel displacement  the distance between the front of the vehicle and the
front axle 
rear wheel displacement  the distance between the front of the vehicle and the
rear axle 
max steering angle  the maximum angle to which the front wheels can be turned
for the purposes of steering 
max turn per second  the rate at which the vehicle can turn its wheels 
emergency  whether or not this is an emergency vehicle in an emergency situation 
   change request  this is the message a vehicle sends when it has a reservation 
but would like to switch to a different set of parameters  if the new parameters are
not acceptable to the intersection  the vehicle may keep its old reservation  it is
identical to the request message  except that it includes a unique reservation id for
the reservation the vehicle currently has 
this message is identical to the request message  except for one added field 
reservation id  an identifier for the reservation to be changed 
   cancel  this is the message a vehicle sends when it no longer desires its current
reservation 
it has   fields 
vehicle id  a unique identifier for the vehicle 
reservation id  an identifier for the reservation to be cancelled 
   done  this message is sent when the vehicle has completed its traversal of the
intersection  while it communicates the same information as the cancel message 
there may be behavior tied to the cancel message which should not occur when a vehicle successfully completes the trip across the intersection  additionally  this message
could be extended in order to communicate statistics for each vehicle  which could
then be recorded in order to analyze the performance of the intersection manager 
this message can be used to collect statistics for each vehicle  which can be recorded
in order to analyze and improve the performance of the intersection manager 
it has   fields 
vehicle id  a unique identifier for the vehicle 
reservation id  an identifier for the reservation that was just completed 
   

fidresner   stone

b     intersection  vehicle
there are four types of messages that can be sent from the intersection to the individual
vehicles 
   confirm  this message is a response to a vehicles request  or change request 
message  it does not always mean that the parameters transmitted by the vehicle are
acceptable  it could  for example  contain a counter offer by the intersection  the
reservation parameters in this message are implicitly accepted by the vehicle  and
must be explicitly cancelled if the driver agent of the vehicle does not approve  note
that this is safe even with faulty communicationthe worst that can happen is that
the intersection reserves space that does not get used  included in the message are
acceleration constraints determined by the intersection  this is just a list of rates and
durations  how the list is created depends on the intersection manager  however  the
vehicles safety must be guaranteed if it adheres to the list 
this message has   fields 
reservation id  a unique identifier for the reservation just created 
arrival time  the absolute time at which the vehicle is expected to arrive 
early error  the tolerable error  early  in arrival time for the vehicle 
late error  the tolerable error  late  in arrival time for the vehicle  note that
the intersection manager must assume that the car could arrive and traverse the
intersection at any time within the resulting bounds
arrival lane  a unique identifier for the lane in which the vehicle should be when
it arrives at the intersection 
arrival velocity  the velocity at which the vehicle is expected to be traveling
when it arrives at the intersection  a negative number signifies that any velocity
is acceptable 
accelerations  a run length encoded description of the expected acceleration of
the vehicle as it travels through the intersection  here  a run length encoded description is a sequence of order pairs of acceleration and durationstarting
with the instant the vehicle enters the intersection  it should maintain each
acceleration for the duration with which it is paired  if the sequence is empty 
any accelerations are acceptable 
   reject  by sending this message  an intersection can inform a vehicle that the
parameters sent in the latest request  or change request  were not acceptable 
and that the intersection either could not or did not want to make a counter offer 
this message also indicates whether or not the rejection was because the reservation
manager requires the vehicle to stop at the intersection before entering  this lets the
driver agent know that it should not attempt any more reservations until it reaches
the intersection 
this message has   field 
   

fia multiagent approach to autonomous intersection management

stop required  a boolean value indicating whether the vehicle must first come to
a full stop before entering the intersection 
   acknowledge  this message acknowledges the receipt of a cancel or done
message 
it has   field 
reservation id  a unique identifier for the reservation just cancelled or completed 
   emergency stop  this message is only sent when the intersection manager has
determined that a collision or similar problem has occurred in the intersection  this
message informs the receiving driver agent that no further reservation requests will
be granted  and if possible  the vehicle should attempt to stop instead of entering the
intersection  even if it has a reservation  the specifics of how this message is used
are discussed in section        this message has no fields  as it only communicates a
single bit of information 
b     vehicle  vehicle
there is currently no protocol for communication between vehicles 
b   protocol actions
in addition to message types  the agents involved  the vehicles and the intersection  must
obey a set of rules  these are not entirely unlike the rules that human drivers follow when
driving 
b     vehicle actions
these are the rules that the vehicles are expected to follow in order to allow the intersection
to function efficiently 
   a vehicle may not enter the intersection without a reservation 
   if a vehicle is going to cross the intersection  it must do everything reasonable within
its power to cross in accordance with the parameters included in the most recent
confirm message it has received from the intersection 
   if a vehicle sends another message before the intersection manager has sent a response 
the intersection manager may choose to ignore it  thus  a vehicle should only send a
message if it has received a response to its previous message 
   if a vehicle has not yet entered the intersection and does not have a reservation  it
may send a request message  if it has not yet entered the intersection and does
have a reservation  it may send either a change request or cancel message  if
it sends any of these messages when it is not allowed to  the intersection may choose
to ignore them 
   if a vehicle has a reservation and has successfully crossed the intersection  it may send
a done message 
   

fidresner   stone

   if a vehicle receives a confirm message  it is considered to have a reservation 
b     intersection actions
these are the rules representing the obligations the intersection manager is expected to
fulfill 
   when an intersection receives a request message  it must respond with either a
confirm or a reject message  if it responds with a confirm message  it is guaranteeing that no cross traffic will interfere with the vehicle if it crosses the intersection
in accordance with the parameters in the message 
   when an intersection receives a change request message  it must respond with
either a confirm or a reject message  if it responds with a confirm message  it
is guaranteeing that no cross traffic will interfere with the vehicle if it crosses the intersection in accordance with the parameters in the message  any previous guarantees
are nullified 
   when an intersection receives a cancel message  it must respond with an acknowledge message  any guarantee that had been made to the sending vehicle is nullified 

appendix c  driver agent
as stated in section      the main focus of this work is on improving the framework and
algorithms for intersection control  however  in order to do this we require some sort of
driver agent  furthermore  the efficiency of the reservation framework depends on driver
agents being reasonably intelligent  which is non trivial  this appendix describes the driver
agent implementation used in our experiments 
containing both behaviors to control turning vehicles as well as optimizations to increase
peformance of the system overall  the driver agent represents the single most intricate component of the reservation mechanism  algorithm   gives a high level pseudocode description
of the driver agent 
c   lane following
given the model of lanes  each driver must be able to drive the vehicles in those lanes 
we accomplish this by means of a lane following behavior that acts only by modifying the
steering angle of the vehicle  this behavior is entirely independent of the rest of the agents
behavior  which controls the vehicles acceleration and communicates with the intersection
manager  this behavior is active at all timesthe vehicle is always attempting to stay
in its current lane  the lane following behavior is designed to be robust to sudden lane
reassignment  and this is how both turning and lane changing are implemented  the driver
agent simply changes which lane is its current lane  and the lane following behavior steers
the vehicle into the correct lane  this process is entirely smooth  provided the vehicle is
traveling at a reasonable velocitya condition enforced by other parts of the driver agents
behavior 
because lanes are modeled as directed line segments  the lane following behavior attempts to keep the vehicle evenly straddling the lane  the line segment represents the
   

fia multiagent approach to autonomous intersection management

middle of the lane  and thus this condition is equivalent to keeping the vehicle centered in
the lane  the driver agent accomplishes this by turning the front wheels toward a point on
the segment  this point  which we call the aim point is farther along the segment than the
vehicle  the aim point is computed by first projecting the point at the front and center of
the vehicle onto the line segment  and then displacing this point in the direction of the line
segment by an amount we call the lead distance  for the most part  the lead distance is
proportional to the velocity of the vehicle  the proportion is smaller inside the intersection
so that vehicles will pull more strongly into their new lane if they are turningthey must
be entirely in the correct lane before they leave the intersection so that they do not collide
with other vehicles outside the intersection  the proportional lead distance is necessary
because otherwise at high velocities  the required steering angle may change faster than the
driver agent can steer  resulting in either wildly erratic steering or the vehicle driving in
circles  the lead distance also has a minimum value of   meter  if the lead distance gets
too small  the effect is the same as if the velocity were too largeby ensuring the aim point
is at least a meter farther down the lane  we can ensure that the vehicle will end up in
a stable configuration traveling in the proper direction  figure    depicts how the driver
agent determines the lead distance  and subsequent aim point  for different velocities 

a

b

c

figure     a vehicle is attempting to follow the lane  to do so  it first calculates the point
that represents the projection of its position onto the directed line segment
running down the center of the lane  a   then  depending on its velocity  it
displaces the resulting point in the direction of travel by a small or large amount
to obtain the point at which it should aim its front wheels  for low velocities 
the point will not be displaced muchonly enough to ensure the vehicle moves
in the correct direction  b   for higher velocities  the aim point must be farther
along the lane  so that the vehicles steering will be more gradual and thus more
stable  c  

this method of lane following is only one possible method  and was selected because it
is sufficient for our purposes  furthermore  the reservation systems functionality does not
depend on the driver agent using this particular method  but will work with any method 
provided the driver agent turns within some mutually understood constraints 
   

fidresner   stone

c   optimistic and pessimistic driver agents
a nave driver agent can perform poorly when  for example  it makes a reservation while
stuck behind a slower moving vehicle  if the vehicle in front eventually accelerates  it would
ideally accelerate as well  possibly switching to an earlier reservation  
to account for situations like this  we introduce the notion of an optimistic or pessimistic
driver agent  an optimistic agent makes a reservation assuming it will arrive at the intersection in the minimum possible time  an agent which finds itself no longer stuck behind
a slower vehicle will become optimistic and attempt to make a new  earlier reservation  a
pessimistic agent assumes it will be stuck at its current velocity until it reaches the intersection  if an agent has to cancel its reservation because there is no way for it to arrive
on time  it becomes pessimistic  due to the relatively infrequent and smooth transitions
through these moods  our driver agent can take advantage of improving circumstances
without causing it to send excessive numbers of messages when things change 
as shown in figure    the addition of optimism and pessimism to the driver agent
reduced both the average number of reservations made as well as the average number of
messages transmitted  as expected  the effect was less pronounced for lower amounts of
traffic 

with
without

messages
      
    

reservations
      
    

table    for a moderate amount of traffic  the average number of messages sent and reservations made by driver agents with and without the optimism pessimism heuristic 

c   estimating time to intersection
a driver agents estimate of how long it will take to get to the intersection must be very
precise so that vehicles can arrive on time for their reservations  if  at this point  the
vehicle is not certain whether or not it will arrive on schedule  it cannot safely continue 
the pessimistic driver agent simply divides the distance to the intersection by its current
velocityit assumes it will not be able to accelerate  an optimistic driver first determines
what its velocity will be when it arrives  if it is turning  for example  this velocity may be
lower than the speed limit  otherwise  it may be limited by the amount the vehicle can
accelerate before reaching the intersection  it then computes the minimum possible time
to reach the intersection at that velocity  that is  it assumes it can accelerate as much as
possible before decelerating to its arrival velocity 
   

fia multiagent approach to autonomous intersection management

algorithm   the driver agent behavior  all driver agents are initialized as optimistic 
   determine aim point and attempt to point wheels at it
   t  current time
   if velocity is below speed limit then
  
accelerate
   if before the intersection then
  
if optimistic then
  
ti  optimisitic estimate of time to intersection
  
else
  
ti  pessimistic estimate of time to intersection
   
if do not have a reservation then
   
if t   ti is after scheduled arrival then
   
cancel reservation
   
become pessimistic
   
else if t   ti is significantly before scheduled arrival then
   
become optimistic
   
attempt to change reservation to earlier time
   
else
   
try to make reservation according to ti
   
if reservation request rejected then
   
decelerate
    else if in the intersection then
   
set acceleration according to parameters of reservation
    if not in the intersection and less than   second behind car in front then
   
decelerate

references
abdulhai  b   pringle  r     karakoulas  g  j          reinforcement learning for true
adaptive traffic signal control  journal of transportation engineering              
    
alvarez  l     horowitz  r          traffic flow control in automated highway systems 
tech  rep  ucb its prr        university of california  berkeley  berkeley  california  usa 
balan  g     luke  s          history based traffic control  in proceedings of the fifth
international joint conference on autonomous agents and multiagent systems  pp 
        hakodate  japan 
bazzan  a  l  c          a distributed approach for coordination of traffic signal agents 
autonomous agents and multi agent systems                
bishop  r          intelligent vehicle technology and trends  artech house 
bonneson  j  a     mccoy  p  t          estimation of safety at two way stopcontrolled
intersections on rural highways  transportation research record             
   

fidresner   stone

bull  l   shaaban  j   tomlinson  a   addison  j  d     heydecker  b  g          towards
distributed adaptive control for road traffic junction signals using learning classifier
systems  in bull  l   ed    applications of learning classifier systems  pp         
springer 
clement  s          the spa model with smooth acceleration  in   th conference of
australian institutes of transport research  caitr        sydney  australia 
darpa         the darpa urban challenge   http   www darpa mil grandchallenge 
dresner  k     stone  p          multiagent traffic management  a reservation based intersection control mechanism  in the third international joint conference on autonomous agents and multiagent systems  pp          new york  ny  usa 
dresner  k     stone  p          multiagent traffic management  opportunities for multiagent learning  in k  tuyls et al   ed    lamas       vol       of lecture notes in
artificial intelligence  pp          springer verlag  berlin 
gavrila  d  m   giebel  j     munder  s          vision based pedestrian detection  the
protector  system  in proceedings of the ieee intelligent vehicles symposium
 iv       parma  italy 
gepperth  a   edelbrunner  j     bucher  t          real time detection and classification
of cars in video sequences  in proceedings of the ieee intelligent vehicle symposium
 iv       pp          las vegas  nv  usa 
halle  s     chaib draa  b          a collaborative driving system based on multiagent
modelling and simulations  journal of transportation research part c  trc c  
emergent technologies             
harwood  d  w   bauer  k  m   potts  i  b   torbic  d  j   richard  k  r   rabbani  e 
r  k   hauer  e   elefteriadou  l     griffith  m  s          safety effectiveness of
intersection left  and right turn lanes  transportation research record               
hatipo  c   redmill  k     ozguner  u          steering and lane change  a working system 
in ieee conference on intelligent transportation systems  pp         
hunt  p  b   robertson  d  i   bretherton  r  d     winton  r  i          scoot   a traffic
responsive method of co ordinating signals  tech  rep  trrl lr       transport and
road research laboratory 
johnson  r  c          steady pace takes darpa race  ee times  accessed at http 
  www eetimes com 
kohl  n   stanley  k   miikkulainen  r   samples  m     sherony  r          evolving a
real world vehicle warning system  in proceedings of the genetic and evolutionary
computation conference       seattle  wa  usa 
kolodko  j     vlacic  l          cooperative autonomous driving at the intelligent control
systems laboratory  ieee intelligent systems              
laumonier  j   desjardins  c     chaib draa  b          cooperative adaptive cruise control 
a reinforcement learning approach  in the fourth workshop on agents in traffic and
transportation  hakodate  hokkaido  japan 
   

fia multiagent approach to autonomous intersection management

lindner  f   kressel  u     kaelberer  s          robust recognition of traffic signals  in
proceedings of the ieee intelligent vehicles symposium  iv       parma  italy 
liu  x     fujimura  k          pedestrian detection using stereo night vision  in ieee
international conference on intelligent transportation systems  shanghai  china 
mahlisch  m   oberlander  m   lohlein  o   gavrila  d     ritter  w          a multiple
detector approach to low resolution fir pedestrian recognition  in proceedings of the
ieee intelligent vehicles symposium  iv       las vegas  nv  usa 
moriarty  d     langley  p          learning cooperative lane selection strategies for highways  in proceedings of the fifteenth national conference on artificial intelligence 
pp          madison  wi  aaai press 
national highway traffic safety administration         economic impact of u s  motor
vehicle crashes reaches        billion  new nhtsa study shows  nhtsa press release
       http   www nhtsa dot gov 
naumann  r     rasche  r          intersection collision avoidance by means of decentralized security and communication management of autonomous vehicles  in proceedings
of the   th isata   att ist conference 
naumann  r   rasche  r     tacken  j          managing autonomous vehicles at intersections  ieee intelligent systems               
noda  i   jacoff  a   bredenfeld  a     takahashi  y   eds            robocup       robot
soccer world cup ix  springer verlag  berlin 
nova         the great robot race   originally aired    march      on pbs  available
online at http   www pbs org wgbh nova darpa 
persaud  b  n   retting  r  a   gardner  p  e     lord  d          safety effect of roundabout conversions in the united states  empirical bayes observational before after
study  transportation research record           
pomerleau  d  a          neural network perception for mobile robot guidance  kluwer
academic publishers 
ramstrom  o     christensen  h          a method for following umarked roads  in
proceedings of the ieee intelligent vehicle symposium  iv       pp          las
vegas  nv  usa 
rasche  r   naumann  r   tacken  j     tahedl  c          validation and simulation
of decentralized intersection collision avoidance algorithm  in proceedings of ieee
conference on intelligent transportation systems  itsc     
reece  d  a     shafer  s          a computational model of driving for autonomous
vehicles  tech  rep  cmu cs         carnegie mellon university  pittsburgh  pennsylvania  usa 
reynolds  c  w          steering behaviors for autonomous characters  in proceedings of
the game developers conference  pp         
rizzo  m   mcgehee  d  v   dawson  j  d     anderson  s  n          simulated car crashes
at intersections in drivers with alzheimer disease  alzheimer disease and associated
disorders               
   

fidresner   stone

robertson  d  i          transyt  a traffic network study tool  tech  rep  trrl lr     transport and road research laboratory 
rogers  s   flechter  c  n     langley  p          an adaptive interactive agent for route
advice  in etzioni  o   muller  j  p     bradshaw  j  m   eds    proceedings of the third
international conference on autonomous agents  agents     pp          seattle 
wa  usa  acm press 
roozemond  d  a          using intelligent agents for urban traffic control systems  in proceedings of the international conference on artificial intelligence in transportation
systems and science  pp       
sayed  t     zein  s          traffic conflict standards for intersections  transportation
planning and technology                 
schonberg  t   ojala  m   suomela  j   torpo  a     halme  a          positioning an
autonomous off road vehicle by using fused dgps and inertial navigation  in  nd
ifac conference on intelligent autonomous vehicles  pp         
she  k   bebis  g   gu  h     miller  r          vehicle tracking using on line fusion of
color and shape features  in proceedings of the ieee international conference on
intelligent transportation systems  washington  dc  usa 
stone  p     veloso  m          multiagent systems  a survey from a machine learning
perspective  autonomous robots                
svenson  o          are we all less risky and more skillful than our fellow drivers   acta
psychologica                 
texas transportation institute              urban mobility report   accessed at http 
  mobility tamu edu ums in december      
usdot         inside the usdots intelligent intersection test facility  newsletter of
the its cooperative deployment network  accessed online    may      at http 
  www ntoctalks com icdn intell intersection php 
watanabe  a     nishida  m          lane detection for a steering assistance system  in
proceedings of the ieee intelligent vehicle symposium  iv       pp          las
vegas  nv  usa 
wiering  m  a          multi agent reinforcement learning for traffic light control  in
langley  p   ed    proceedings of the seventeenth international conference on machine
learning  icml       pp           
wierwille  w  w   hanowski  r  j   hankey  j  m   kieliszewski  c  a   lee  s  e   medina 
a   keisler  a  s     dingus  t  a          identification and evaluation of driver
errors  overview and recommendations  tech  rep  fhwa rd         virginia tech
transportation institute  blacksburg  virginia  usa  sponsored by the federal highway administration 
wu  s  j   chiang  h  h   perng  j  w   lee  t  t     chen  c  j          the automated
lane keeping design for an intelligent vehicle  in proceedings of the ieee intelligent
vehicle symposium  iv       pp          las vegas  nv  usa 

   

fi