journal artificial intelligence research                  

submitted       published     

generating hard satisfiable formulas hiding
solutions deceptively
haixia jia

hjia cs unm edu

computer science department
university new mexico

cristopher moore

moore santafe edu

computer science department
university new mexico

doug strain

doug strain gmail com

computer science department
university new mexico

abstract
test incomplete search algorithms constraint satisfaction problems  sat  need source hard  satisfiable  benchmark instances  simple way
choose random truth assignment a  choose clauses randomly
among satisfied a  however  method tends produce easy problems  since
majority literals point toward hidden assignment a  last year  achlioptas 
jia moore proposed problem generator cancels effect hiding
complement  achlioptas  jia    moore         resulting formulas
appear hard dpll algorithms random   sat formulas hidden
assignment  solved walksat polynomial time 
propose new method cancel attraction a  choosing clause
    literals satisfied probability proportional q q      varying
q  generate formulas whose variables bias  i e   equally likely
true false  even cause formula deceptively point away a  present
theoretical experimental results suggesting formulas exponentially hard
dpll algorithms incomplete algorithms walksat 

   introduction
evaluate search algorithms constraint satisfaction problems  need good sources
benchmark instances  real world problems best benchmarks definition 
problem structures specific application domain  addition 
wish study running times search algorithms scale  need entire families
benchmarks varying size density 
one way fill need generate random instances  instance    sat
generate instances
n variables clauses choosing clause uniformly
among   n  possibilities  vary formulas according
size density r   m n  formulas lack much structure realworld instances  instrumental development study new search
methods simulated annealing  johnson  aragon  mcgeoch    shevon        
c
    
ai access foundation  rights reserved 

fijia  moore    strain

breakout procedure  morris         walksat  selman  kautz    cohen         survey
propagation  mezard   zecchina        
however  wish test incomplete algorithms walksat survey propagation  sp   need source problems hard satisfiable  contrast  critical density r       random formulas defined almost certainly unsatisfiable 
random formulas threshold appear quite hard complete solvers  cheeseman  kanefsky    taylor        mitchell  selman    levesque        hogg  huberman   
williams         precisely reason  feasible generate large problems
threshold filter unsatisfiable ones  classes satisfiable
csps proposed  quasigroup completion problem  shaw  stergiou   
walsh        kautz  ruan  achlioptas  gomes  selman    stickel        achlioptas  gomes 
kautz    selman         would problems generators native
  sat 
natural way generate random satisfiable   sat formulas choose random
truth assignment
      n   choose clauses uniformly independently
n
among     clauses satisfied a  problem simply rejecting clauses
conflict causes unbalanced distribution literals  particular  average
literal agree value hidden assignment     time  thus  especially
many clauses  simple majority heuristic local search quickly find
a  sophisticated versions hidden assignment scheme  asahiro  iwama   
miyano        van gelder        improve matters somewhat still lead biased samples 
thus question avoid attraction hidden assignment 
one approach  achlioptas et al         choose clauses uniformly among
satisfied complement a  inspired recent work
random k sat not all equal sat  achlioptas   moore      b   symmetry
respect complementation reduces variance number solutions  idea
cancel others attractions out  making either one hard find  indeed 
resulting formulas appear take dpll solvers exponential time and  general 
hard random   sat formulas hidden assignment 
hand  walksat solves formulas polynomial time  since variables set
way agrees one hidden assignments  neighboring variables develop
correlations consistent  barthel  hartmann  leone  ricci tersenghi  weigt   
zecchina        
paper  pursue alternate approach  inspired achlioptas preres 
reweighted satisfying assignments natural way  achlioptas   peres         hide
one assignment  bias distribution clauses follows 
   predefine constant q     generate random truth assignment       n
   rn times  choose random k tuple variables  choose among clauses
    literals satisfied probability proportional q  
penalizes clauses satisfied a  reduces extent
variable occurrences likely agree a   note naive formulas discussed
amount case q       see below  choosing q appropriately
rebalance distribution literals  variable likely appear positively
   

figenerating hard satisfiable formulas hiding solutions deceptively

often negatively longer points toward value a  reducing q further 
even make likely variable occurrence disagrees a 
formula becomes deceptive points away hidden assignment 
call formulas q hidden  distinguish naive   hidden formulas discussed above    hidden formulas studied achlioptas  jia moore  achlioptas et al            hidden formulas consisting random   sat formulas
hidden assignment  families  q hidden formulas readily amenable
mathematical tools developed studying random k sat formulas 
including moment calculations method differential equations  calculate
expected density satisfying assignments function distance a 
analyze behavior unit clause  uc  algorithm q hidden formulas 
present experiments several complete incomplete solvers  certain values q 
find q hidden formulas hard harder dpll algorithms   hidden
formulas   hidden formulas  much harder naive   hidden formulas  addition  find local search algorithms walksat find formulas much harder
families  taking exponential opposed polynomial time  moreover 
running time walksat increases sharply formulas become deceptive 

   expected density solutions bias local search
        let x number satisfying truth assignments random q hidden
k sat formula agree fraction variables hidden assignment a 
is  hamming distance     n  wish calculate expectation
e x   
symmetry  take all true assignment  case  clause
    positive literals chosen probability q        q k     here normalize
probabilities summing kt clauses       let b truth assignment
n variables true    n false  then  analogous calculation
achlioptas  jia moore  achlioptas et al          use linearity expectation  independence clauses  selection literals clause replacement 
stirlings approximation factorial obtain  where suppresses terms polynomial
n  

n
pr b satisfies random clause m
n
 m

k
x
k q     t kt
n
 
 
     q k  
n
t  

e x    



fk r q   n


f     

 
     



 

 q        k k
     q k  

r

 

looking figure    see behavior f near       changes dramatically
vary q  q      i e   naive   hidden formulas   f         positive 
   

fijia  moore    strain

density solutions q    

density solutions r  
   

   
r  

 

   

q    

   

   

r  

q      
   

   

   

 

r  

   

r    

q  

   
r  

   

   

   

   

r  

   
 

   

   



   

   

   
 

 

   

   



   

   

 

figure    nth root f    expected number solutions agree
hidden assignment fraction variables  k      left part
figure shows f    q      q         q       r      right part
shows f    q       varying r  note r        f       
    
hand  q positive root q
     q      q k     

   



f          
   call resulting q  hidden formulas balanced  k      q
golden ratio                    
choice q affects local search algorithms walksat following way 
start random assignment b  step walksat chooses random unsatisfied
clause  satisfies literal   chosen randomly clause  expected change
hamming distance d a  b  probability   agrees a  minus
probability doesnt  since clauses equally likely unsatisfied
random assignment  expectation  t k   random clause  namely

e d a  b    

k
x
k q   t k   
t  

     q k  

 

     q      q k 
 
     q k  

thus zero     holds  case walksat equally likely move toward away
a  thus  analogous calculation achlioptas peres  achlioptas   peres 
       q   q given literal equally likely agree disagree a  walksat
information direction hidden assignment lies   this argument
applies first o n      steps walksat  since unlikely seen
variable twice  
   

figenerating hard satisfiable formulas hiding solutions deceptively

smaller values q q       shown figure    f         becomes negative 
expect local search algorithm starting random assignment move away
a  indeed  f    local maximum        small r solutions
       r sufficiently large  however  f              
n probability alternate solutions exist exponentially small 
conjecture q q threshold rc  q  high probability
solutions close a  setting max f               yields upper
bound rc  q   show figure   below  instance  dotted line figure  
shows rc           
call formulas deceptive  since local search algorithms walksat  dpll
algorithms zchaff use majority heuristic splitting rule  messagepassing algorithms sp presumably search wrong direction  take exponential time cross local minimum f    find hidden assignment 
experiments appear confirm intuition  addition  three types algorithms appear encounter difficulty roughly density rc  q  
conjecture alternate solutions disappear 

   unit clause heuristic dpll algorithms
unit clause  uc  linear time heuristic permanently sets one variable
step follows  unit clauses  satisfy them  otherwise  pick random literal
satisfy it  random   sat formulas  uc succeeds constant probability
r        fails high probability r        chao   franco         uc
thought first branch simple dpll algorithm s  whose splitting rule takes
random unset variable tries truth values random order  thus uc succeeds
succeeds without backtracking  hand  showed ss expected running
time exponential n r        cocco   monasson        cocco  monasson 
montanari    semerjian         achlioptas  beame molloy used lower bounds
resolution complexity show takes exponential time high probability
r         achlioptas  beame    molloy         general  appears simple dpll
algorithms begin take exponential time exactly density corresponding
linear time heuristic fails 
section  analyze performance uc q hidden formulas  specifically 
show balanced case q   q   uc fails r      
  hidden formulas  based this  conjecture running time s 
simple dpll algorithms  exponentially large formulas density
  hidden ones 
analyze behavior uc arbitrary initial distributions   sat clauses using
method differential equations  simplicity assume all true assignment  round uc consists free step  satisfy random literal 
ensuing chain unit clause propagations        j i  let si j   si j n
number
clauses length j positive literals j negative ones  let
p
si   j si j   let x   xn number variables set far  let mt mf
expected number variables set true false round  model discrete
   

fijia  moore    strain

stochastic process si j following differential equations si j  
ds  j
dx
ds  j
dx

 s  j
 x
 s  j
mf  j     s  j     mt    j s  j
 
 
 x
 mt   mf     x 
 

   

unit clauses governed two type branching process  transition matrix


 
s     s   
m 
 
  x  s    s   
calculation achlioptas moore  achlioptas   moore      a   long
largest eigenvalue less    branching process subcritical  summing
round gives




   
mf
 
   i  
 
   
mt
solve equation     initial conditions s       

qj
 
s  j  
j      q    
    j    balanced case q   q   find uc succeeds q hidden formulas
constant probability r          hidden formulas  reason
that    hidden formulas  expected number positive negative literals
throughout process  symmetry causes uc behave would
random   sat formulas without hidden assignment 
note q   q   uc succeeds slightly higher densities  find
one alternate solutions        higher densities alternate
solutions disappear  experimental results show deceptive formulas
take dpll algorithms exponential time  r   rc  q  harder   hidden
formulas density 

   experimental results
    dpll
section discuss behavior dpll solvers q hidden formulas  focus
zchaff  zhang         behavior oksolver  kullmann        similar  figure  
shows zchaffs running time   hidden    hidden    hidden  q hidden formulas
various values q 
balanced formulas  i e  q   q             appear hard   hidden
ones  including satisfiability threshold r        hidden formulas become
unsatisfiable    hidden formulas  q  hidden formulas appear peak complexity near satisfiability threshold  consistent picture given previous
two sections  namely  balanced formulas make impossible algorithms
feel attraction hidden assignment  contrast  naive   hidden formulas far
easier  since attraction hidden assignment strong 
   

figenerating hard satisfiable formulas hiding solutions deceptively

zchaff performance n    

zchaff performance r    

 

  

 

  

median number decisions    trials

median number decisions    trials

 

  

q    
q    
q    
q    
q      
 hidden
 hidden
 hidden

 

  

 

  

 

  

 

 

  

q    
 hidden
q      
 hidden
 hidden

 

  

 

  

 

  

 

   

 

   

 
r

   

 

   

  
  

 

   

   

   

   

   

n

figure    left part figure shows zchaffs median running time    trials
  hidden    hidden    hidden q hidden formulas n       r ranging
         right part shows median running time r      
n ranging         note   hidden formulas almost always
unsatisfiable r        

deceptive formulas  i e  q   q   appear two phases  low density
relatively easy  hardness peaks density rc  q   rc  q  take
exponential time    hidden formulas  r increases coefficient
exponential decreases clauses generate contradictions quickly 
believe peak rc  q  threshold density defined earlier  see figure  
below  solutions close hidden assignment 
situation seems following  rc  q   alternate solutions  
     zchaff led splitting rule  rc  q   alternate solutions
disappear  zchaff takes exponential time find vicinity hidden assignment 
since formula deceptively points direction  moreover  fixed r
rc  q  formulas become harder q decreases become deceptive 
illustrate further  right part figure   shows zchaffs median running
time   hidden formulas    hidden formulas    hidden formulas  q hidden formulas
q   q  balanced  q        deceptive   fix r        appears
rc  q  values q  density    hidden    hidden  balanced
q hidden formulas comparable difficulty    hidden formulas much easier
deceptive formulas appear somewhat harder 
    sp
survey propagation sp  mezard   zecchina        recently introduced incomplete
solver based insights replica method statistical physics generalization
belief propagation  tested sp   hidden formulas q hidden formulas different
values q  using n       varying r    hidden formulas  sp succeeds r        
   

fijia  moore    strain

quite close satisfiability threshold  q hidden formulas q   q   sp fails
       hidden formulas  suggesting finds formulas exactly
hard   hidden ones even though guaranteed satisfiable  naive   hidden
formulas  sp succeeds significantly higher density  r       
presumably naive   hidden formulas easier sp since messages
clauses variables  majority heuristic  tend push algorithm towards
hidden assignment  balanced case q   q   attraction successfully suppressed 
causing sp fail essentially density   hidden formulas  close satisfiability threshold  even though q hidden formulas continue satisfiable densities  contrast    hidden formulas proposed achlioptas  jia moore  achlioptas
et al         solved sp somewhat higher density r      thus seems
reweighting approach q hidden formulas better job confusing sp hiding
two complementary assignments does 
q   q   sp succeeds somewhat higher densities  matches quite
closely value rc  q  zchaffs running time peaks  see figure   below   building
conjecture density solutions close
hidden assignment  guess sp succeeds r   rc  q  precisely
local gradient density solutions pushes towards alternate solutions
       rc  q   solutions longer exist  sp fails clauses send
deceptive messages  demanding variables set opposite hidden assignment 
    walksat
conclude local search algorithm  walksat  formula     
restarts      steps per attempt  step random greedy flip
equal probability  left part figure   measure walksats performance  hidden    hidden  q hidden formulas various values q  use n       r
range      even relatively small formulas  see three
deceptive values q  density median running time jumps    
flips  instance  q hidden formulas q       appear unfeasible walksat for 
say  r     
believe that  consistent discussion above  local search algorithms
walksat greedily follow gradient density solutions f     q   q  
gradient deceptive  lures walksat away hidden assignment  densities
rc  q   many alternate solutions       walksat finds one
easily  densities rc  q   solutions near hidden
assignment  walksats greed causes wander exponentially long time
wrong region  picture supported fact that  figure   shows below  density walksats running time jumps upward closely matches thresholds rc  q 
observed zchaff sp 
right part figure   looks walksats median running time fixed density
function n  compare   hidden   hidden formulas q hidden ones
q   q two deceptive values           choose r        rc  q 
three values q  running time   hidden   hidden formulas
polynomial  achlioptas et al         barthel et al          contrast  even balanced
   

figenerating hard satisfiable formulas hiding solutions deceptively

case q   q   running time exponential  slope exponential increases
dramatically decrease q make formulas deceptive  note
might possible develop heuristic analysis walksats running time deceptive
case  semerjian   monasson        cocco et al         

walksat performance n    

 

 

 

  

 

  

 

  

q    
q    
q    
q    
q      
 hidden
 hidden

 

  

 

  

 

  

walksat performance r    

  
median number flips    trials

median number flips    trials

  

 

 

  

q    
q    
q      
 hidden
 hidden

 

  

 

  

 

  

 

  

 

   

 

   

 
r

   

 

   

  
  

 

                                           
n

figure    left part figure shows walksats median running time    trials
n       r ranging      right part shows median running
time r       n ranging        

   threshold density
seen  appears characteristic density rc  q  value q q
running time dpll algorithms zchaff peaks  walksats running
time becomes exponential  sp ceases work  conjecture three
cases  key phenomenon density solutions       disappear 
leaving close hidden assignment  figure   shows measured values
rc  q   indeed quite close three algorithms  show analytic
upper bound rc  q  resulting setting max f               
expected number solutions     exponentially small 

   conclusions
introduced simple new way hide solutions   sat problems produces
instances hard satisfiable  unlike   hidden formulas proposed
achlioptas  jia moore  achlioptas et al         attraction hidden
assignment cancelled hiding complement  eliminate attraction
reweighting distribution clauses proposed achlioptas peres  achlioptas
  peres         indeed  going beyond value parameter q makes
q hidden formulas balanced  create deceptive formulas lead algorithms
wrong direction  experimentally  formulas hard harder dpll algorithms
   

fijia  moore    strain

  
upper bound
zchaff
sp
walksat

  
  

rc q 

 
 
 
 
 
 
   

   

   
q

   

   

figure    density rc  q  running time zchaff peaks  walksat peaks
exceeds     flips  sp stops working  conjecture events occur
density alternate solutions       disappear  leaving
close hidden assignment  shown analytic upper
bound described text 

  hidden formulas  i e   random   sat formulas without hidden assignment  local
search algorithms walksat  much harder   hidden   hidden formulas 
taking exponential rather polynomial time  formulas amenable
mathematical tools developed study random   sat  calculated
expected density solutions function distance hidden assignment 
used method differential equations show uc fails density
  hidden formulas 
close several exciting directions future work 
   confirm single threshold density rc  q  a  alternate solutions
far hidden assignment disappear  b  running time dpll algorithms
maximized  c  sp stops working  d  running time walksat becomes
exponential 
   prove simple dpll algorithms take exponential time r   rc  q   expectation
high probability 
   calculate variance number solutions function   giving
improved upper lower bounds distribution solutions rc  q  

acknowledgments
h j  supported nsf graduate fellowship  c m  d s  supported nsf
grants ccr          eia          phy          c m  thanks tracy conrad
rosemary moore support 
   

figenerating hard satisfiable formulas hiding solutions deceptively

references
achlioptas  d   beame  p     molloy  m          sharp threshold proof complexity 
proc  stoc  pp         
achlioptas  d   gomes  c   kautz  h     selman  b          generating satisfiable problem
instances  proc  aaai  pp         
achlioptas  d   jia  h     moore  c          hiding satisfying assignments  two better
one  proc  aaai  pp         
achlioptas  d     moore  c       a   almost graphs average degree    colorable  proc  stoc  pp         
achlioptas  d     moore  c       b   asymptotic order random k sat threshold 
proc  focs  pp         
achlioptas  d     peres  y          threshold random k sat  k  ln   o k   
proc  stoc  pp         
asahiro  y   iwama  k     miyano  e          random generation test instances
controlled attributes  dimacs series disc  math  theor  comp  sci      
barthel  w   hartmann  a   leone  m   ricci tersenghi  f   weigt  m     zecchina  r 
        hiding solutions random satisfiability problems  statistical mechanics
approach  phys  rev  lett               
chao  m     franco  j          probabilistic analysis two heuristics   satisfiability
problem  siam j  comput                    
cheeseman  p   kanefsky  r     taylor  w          really hard problems are 
proc  ijcai  pp         
cocco  s     monasson  r          heuristic average case analysis backtrack resolution random   satisfiability instances  theor  comp  sci               
cocco  s   monasson  r   montanari  a     semerjian  g          approximate analysis
search algorithms physical methods  percus  a   istrate  g     moore  c 
 eds    computational complexity statistical physics  oxford university press 
hogg  t   huberman  b     williams  c          phase transitions complexity  artificial
intelligence     
johnson  d   aragon  c   mcgeoch  l     shevon  c          optimization simulated
annealing  experimental evaluation  operations research                 
kautz  h   ruan  y   achlioptas  d   gomes  c   selman  b     stickel            balance
filtering structured satisfiable problems  proc  ijcai  pp         
kullmann  o          investigating behaviour sat solver random formulas 
tech  rep  csr          university wales swansea 
mezard  m     zecchina  r          random k satisfiability  analytic solution
new efficient algorithm  phys  rev  e             
mitchell  d   selman  b     levesque  h          hard easy distributions sat
problems  proc  aaai  pp         
   

fijia  moore    strain

morris  p          breakout method escaping local minima  proc  aaai 
pp       
selman  b   kautz  h     cohen  b          local search strategies satisfiability testing 
proc   nd dimacs challange cliques  coloring  satisfiability 
semerjian  g     monasson  r          study pure random walk random satisfiability
problems physical methods  lncs               
shaw  p   stergiou  k     walsh  t          arc consistency quasigroup completion 
proc  ecai  workshop binary constraints 
van gelder  a          problem generator mkcnf c  proc  dimacs  challenge archive 
zhang  l          zchaff   ee princeton edu chaff zchaff php 

   


