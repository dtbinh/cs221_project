journal of artificial intelligence research                 

submitted        published      

qualitative system identification from imperfect data
george m  coghill

g coghill abdn ac uk

school of natural and computing sciences
university of aberdeen  aberdeen  ab    ue  uk 

ashwin srinivasan

ashwin srinivasan in ibm com

ibm india research laboratory
   block c  institutional area
vasant kunj phase ii  new delhi         india 
and
department of cse and centre for health informatics
university of new south wales  kensington
sydney  australia 

ross d  king

rdk aber ac uk

deptartment of computer science
university of wales  aberystwyth  sy    db  uk 

abstract
experience in the physical sciences suggests that the only realistic means of understanding complex systems is through the use of mathematical models  typically  this has
come to mean the identification of quantitative models expressed as differential equations 
quantitative modelling works best when the structure of the model  i e   the form of the
equations  is known  and the primary concern is one of estimating the values of the parameters in the model  for complex biological systems  the model structure is rarely known
and the modeler has to deal with both model identification and parameter estimation  in
this paper we are concerned with providing automated assistance to the first of these problems  specifically  we examine the identification by machine of the structural relationships
between experimentally observed variables  these relationship will be expressed in the
form of qualitative abstractions of a quantitative model  such qualitative models may
not only provide clues to the precise quantitative model  but also assist in understanding the essence of that model  our position in this paper is that background knowledge
incorporating system modelling principles can be used to constrain effectively the set of
good qualitative models  utilising the model identification framework provided by inductive logic programming  ilp  we present empirical support for this position using a series
of increasingly complex artificial datasets  the results are obtained with qualitative and
quantitative data subject to varying amounts of noise and different degrees of sparsity 
the results also point to the presence of a set of qualitative states  which we term kernel
subsets  that may be necessary for a qualitative model learner to learn correct models  we
demonstrate scalability of the method to biological system modelling by identification of
the glycolysis metabolic pathway from data 

   introduction
there is a growing recognition that research in the life sciences will increasingly be concerned with ways of relating large amounts of biological and physical data to the structure
and function of higher level biological systems  experience in the physical sciences suggests
c
    
ai access foundation  all rights reserved 

ficoghill  srinivasan    king

that the only realistic means of understanding such complex systems is through the use of
mathematical models  a topical example is provided by the physiome project which seeks
to utilise data obtained from sequencing the human genome to understand and describe the
human organism using models that        include everything from diagrammatic schema 
suggesting relationships among elements composing a system  to fully quantitative  computational models describing the behaviour of the physiological systems and an organisms
response to environmental change  see http   www physiome org    this paper is concerned with a computational tool that aims to assist in the identification of mathematical
models for such complex systems 
broadly speaking  system identification can be viewed as the field of modelling dynamic systems from experimental data  soderstrom   stoica         we can distinguish
here between   a  classical system identification techniques  developed by control engineers and econometricians  and  b  machine learning techniques  developed by computer
scientists  there are two main aspects to this activity  first  an appropriate structure has to
be determined  the model identification problem   second  acceptably accurate values for
parameters in the model are to be obtained  the parameter estimation problem   classical
system identification is usually  but not always  used when the possible model structure is
known a priori  machine learning methods  on the other hand  are of interest when little or
nothing is known about the model structure  the tool described here is a machine learning
technique that identifies qualitative models from observational data  qualitative models are
non parametric  therefore all the computational effort is focussed on model identification
 there are no parameters to be estimated   the task is therefore somewhat easier than
more ambitious machine learning programs that attempt to identify parametric quantitative models  bradley  easley    stolle        dzeroski        dzeroski   todorovski       
todorovski  srinivasan  whiteley    gavaghan         qualitative model learning has a
number of other advantages  the models are quite comprehensible  system dynamics can
be obtained relatively easily  the space of possible models is finite  and noise resistance is
fairly high  on the down side  qualtitative model learners have often produced models that
are under  or over constrained  the models can only provide clues to the precise mathematical structure  and the models are largely restricted to being abstractions of ordinary
differential equations  odes   we attempt to mitigate the first of these shortcomings by
adopting the framework of inductive logic programming  ilp   see bergadano   gunetti 
      muggleton   raedt         properly constrained models are identified using a library of syntactic and semantic constraintspart of the background knowledge in the ilp
systemon physically meaningful models  like all ilp systems  this library is relatively
easily extendable  our position in this paper is that 
background knowledge incorporating physical  and later  biological  system modelling principles can be used to constrain the set of good qualitative models 
using some some classical physical systems as test beds we demonstrate empirically that 
 a small set of constraints  in conjunction with a bayesian scoring function  is sufficient
to identify correct models 
 correct models can be identified from qualitative or quantitative data which need not
contain measurements for all variables in the model  and they can be learned with
   

fiqualitative system identification

sparse data with large amounts of noise  that is  the correct models can be identified
when the input data are incomplete  incorrect  or both 
a closer examination of the performance on these test systems has led to the discovery of
what we term kernel subsets  minimal qualitative states that when present guarantee our
implementation will identify a model correctly  this concept may be of value to other model
identification systems 
our primary interests  as made clear at the outset  lie in biological system identification 
the completion of the sequencing of the key model genomes and the rise of new technologies
have opened up the prospect of modelling cells in silico in unprecedented detail  such models will be essential to integrate the ever increasing store of biological knowledge  and have
the potential to transform medicine and biotechnology  a key task in this emerging field
of systems biology is to identify cellular models directly from experimental data  in applying qualitative system identification to systems biology we focus on models of metabolism 
the interaction of small molecules with enzymes  the domain of classical biochemistry  
such models are the best established in systems biology  to this end  we demonstrate
that the approach scales up to identify the core of a well known  complex biological system
 glycolysis  from qualitative data  this system is modelled here by a set of    qualitative relations  with several unmeasured variables  the scale up is achieved by augmenting
the background knowledge to incorporate general chemical and biological constraints on
enzymes and metabolites 
the rest of the paper is organised as follows  in the next section we present the learning
approach ilp qsi by means of an example  the u tube  we also describe the details of
the learning algorithm in this section  in section   we apply the learning experiments to a
number of other systems in the same class as the u tube  present the results obtained  and
discuss the results for all the experiments reported thus far  section   extends the work
from learning from qualitative data to a set of proof of concept experiments to assess the
ability of ilp qsi to learn from quantitative data  the scalability of the method is tested
in section   by application to a large scale metabolic pathway  glycolysis  in section   we
discuss related work  and finally in section   we provide a general discussion of the research
and draw some general conclusions 

   qualitative system identification using ilp
in order to aid understanding of the method presented in this paper we will first present
a detailed description of the process as applied to an illustrative system  the u tube  the
u tube has been chosen because it is a well understood system  and is one that has been
used in the literature  muggleton   feng        say   kuru         the results emerging
from this set of experiments will allow us to draw some tentative conclusions regarding
qualitative systems identification 
in subsequent sections we will present the results of applying the method described
in this section to further examples from the same class of system  this will enable us to
generalise our tentative conclusions  we will also apply the method to a large scale biological
system to demonstrate the scalability of the method 
   

ficoghill  srinivasan    king

state
 
 
 
 
 
 

h 
     std  
     inc  
         dec  
         dec  
         std  
         inc  

h 
     std  
         dec  
     inc  
         inc  
         std  
         dec  

qx
     std  
         inc  
         dec  
         dec  
     std  
         inc  

qx
     std  
         dec  
         inc  
         inc  
     std  
         dec  

table    the envisionment states used for the u tube experiments  the qualitative values
are in the standard form used by qsim  positive values for the magnitude are
represented by the interval        negative values by the interval       and zero
by    the directions of change are self explanatory with increasing represented by
inc  decreasing by dec and steady by std 
    an illustrative system  the u tube
the u tube system  fig     is a closed system consisting of two tanks containing  or potentially containing  fluid  joined together at their base by a pipe  assuming there is fluid in
the system it passes from one tank to the other via the pipe  from the tank with the higher
fluid level to the tank with the lower fluid level  as a function of the difference in height  
if the height of fluid is the same in both tanks then the system is in equilibrium and there
is no fluid flow 
the u tube can be represented by a system of ordinary differential equations as follows 
dh 
dt
dh 
dt



  k   h   h    


   


  k   h   h    

a qualitative model may be obtained simply by abstracting from the real numbers  which
would normally be associated with equation    into the quantity space of the signs  a
common formalism used to represent qualitative models is qsim  kuipers         in this
representation models are conjunctions of constraints  each of which are two or three place
predicates representing abstractions of real valued arithmetic and functional operations  all
variables in a model have values represented by two element vectors consisting of  in the
most abstract case  the sign of both the magnitude and direction of change of the variable 
in order to accommodate this restriction on the number of variables in a constraint we may
rewrite equation   as follows 

h    h   h    



qx   k  h
   
dh 


dt   qx


dh 
dt   qx

where h  and h  are the height of fluid in tank   and tank   respectively  h is the
difference in the height of fluid in the tanks  and q x is the flow of fluid between the tanks 
this can be converted directly to qsim constraints as shown in fig    

   

fiqualitative system identification

tank  

tank  

delta h

h 

 

h

h 
dt

dt

h 
h 

 qx

 

qx

m 

deriv h  qx   
deriv h  qx   
add h  delta h  h    
m   delta h qx   
minus qx qx   

qx

figure    the u tube   left  physical   middle  qsim diagrammatic   right  qsim constraints  in the qsim version of the model delta h corresponds to h in the
physical model  in qsim  m       is the qualitative version of a functional relation
which indicates that there is a monotonically increasing relation between the two
variables which are its arguments  the m        constraint represents a family of
functions that includes both linear and non linear relations 

 

 
 

 

 

 

figure    the u tube envisionment graph 
appropriate qualitative analysis of the u tube will produce the states shown in table   
which are the states of the envisionment  these represent all the distinct qualitative states
in which the u tube may exist and fig    depicts all the possible behaviours  in terms of
transitions between states     this figure represents a complete envisionment of the system 
which is the graph containing all the qualitative states of the system and all the transitions
between them for a particular input value  in the case of the u tube presented here there
is no input  which is equivalent to a value of zero   on the other hand the behaviours
of a u tube may be observed under a number of experimental  initial  conditions  with
measurements being taken of the height of fluid in each tank and the flow between the
tanks  these can be converted  by means of a quantitative to qualitative converter  into a
set of qualitative observations  or states   if sufficient temporal information is available to
enable the calculation of qualitative derivatives  each observation will be a tuple stating the
magnitude and direction of change of the measured variable  these observations will also
contain the states in the complete envisionment of table    or some subset thereof  
   state   represents the situation where there is no fluid in the system  so nothing happens and it is not
interesting 

   

ficoghill  srinivasan    king

the u tube is a member of a large class of dynamic systems which are defined by their
states  state systems  in such systems the values of the variables at all future times are
defined by the current state of the system regardless of how that state was achieved  healey 
       this means that for simulation  any system state can act as an initial state  in the
current context it means that in order to learn the structure of such systems we need
only focus on the states themselves and may ignore the transitions between states  this
enables us to explore the power set of the envisionment to ascertain the conditions under
which system identification is possible  given these qualitative observations as examples 
background knowledge consisting of constraints on models  described later  and qsim
relations  the learning system  which we name ilp qsi  performs a search for acceptable
models  to a suitable first approximation  the basic task can be viewed as a discrete
optimisation problem of finding the lowest cost elements amongst a finite set of alternatives 
that is  given a finite discrete set of models s and a real valued cost function f   s    
find a subset h  s such that h    h h  s and f  h    min hi s f  hi     this problem
may be solved by employing a procedure that searches through a directed acyclic graph
representation of possible models  in this representation  a pair of models are connected in
the graph if one can be transformed into another by an operation called refinement  fig   
shows some parts of a graph for the u tube in which a model is refined to another by the
addition of a qualitative constraint  an optimal search procedure  the branch and bound
procedure  traverses this graph in some order  at all times keeping the cost of the best nodes
so far  whenever a node is reached where it is certain that it and all its descendents have
a cost higher than that of the best nodes  then the node and its descendents are removed
from the search 
there are a number of features apparent in the u tube model that are relevant to the
learning method utilised in this work  and discussed in section      that will be described
here since they regard general modelling issues relevant to the learning of qualitative models
of dynamic systems 
the first thing that may be noted in this regard is that the expressions in equation
  and the resulting qualitative constraints are ordered  that is  given the values for the
exogenous variables and the magnitude of the state variables  the height of fluid in the
tanks in this case  the equations can be placed in an order such that the variables on the
left hand side all may have their values calculated before they appear on the right hand
side of an equation    this particular form of ordering in known as causal ordering  iwasaki
  simon         a causally ordered system can be depicted graphically as shown in fig    
a causally ordered model contains no algebraic loops  in quantitative systems one tries
to avoid algebraic loops because they are hard to simulate  requiring additional simultaneous
equation solvers to be used 
a qualitative model combined with a qualitative reasoning  qr  inference engine will
provide an envisionment of the system of interest  that is  it will generate all the qualitatively distinct states in which the system may exist  in the case of the u tube there are six
such states as given in table    example behaviours resulting from these states are shown
in fig    
   this ordering is not required by qsim in order to preform qualitative simulation  however  the ability
to order equations in this manner can be utilised as a filter in the learning system in order to eliminate
models containing algebraic loops 

   

fiqualitative system identification

add  h   h    h  

add  h   h    h  
deriv  h  h   
mplus  h  f   

add h    h   h  

add  h   h    x  

add  h   h    h  
deriv  h  h   
mplus  h  f   
minus  x  f    
mplus  x  h   

add  h   h    x  
mplus  x  f    
mplus  h  x  

deriv h  x   

deriv  h  x   

  

deriv  h  h   

deriv  h  f   

deriv  h  f   
deriv  h  x  
add  h  x  h   

mplus  h  f   

deriv  h  f   
deriv  h  x  
add  h  x  h   
mplus  x  f    
minus  f   x   

mplus  h  f   

mplus  h  f   

mplus  h  f   
add  f   x  h   
deriv  h  f   

figure    some portions of the u tube lattice  with the target model in the box  
it may be noted that the differential equation model captures the essence of the explanation given in the first paragraph of this section  it is sufficient to explain the operation
of such a system  as well as to predict the way it will behave  and it contains only those
variables and constants necessary to achieve this task   i e  the model is parsimonious   
furthermore  examination of the causal diagram in fig    indicates that the causal
ordering is in a particular direction  from the magnitudes of the state variables to their
derivatives  the link between the derivatives and the magnitudes of the state variables is
through an integration over time  this is integral causality and is the preferred kind
   it is possible that for didactic purposes we may want to include more detail  for example a relation
between the intertank flow and the pressure difference  or between the height of fluid and the pressure 
there is no reason why we would expect such relations to be found  although in the context of an
adequate theoretical framework into which the model fits  the model provides pointers in that direction 
on the other hand  one can envisage simpler models existing which may be suitable for prediction but
inadequate for the required kind of explanation  see section   for more on this 

   

ficoghill  srinivasan    king

k

h 

h 

h

qx

h 

h 

figure    a causal ordering of the u tube model given in equation   
of causality in systems engineering modelling  and simulation generally  this is because
integration smooths out noise whereas differentiation introduces it 
all variables are either endogenous or exogenous  exogenous variables influence the system but are not influenced by it  well posed models do not have any flapping variables 
that is  endogenous variables that appear in only one constraint  because qsim includes
a deriv constraint linking the state variables directly to their derivatives  and all the systems in which we are interested are regulatory  containing feedback paths  all endogenous
variables must appear in at least two constraints 
well posedness and parsimony are mandatory properties of the model  the other properties are desirable but not always achievable and so may have to be relaxed  however  for
all the systems examined in this paper each of these properties holds 
a final feature of the u tube model is that it represents a single system  it is an
assumption implicit in all the learning experiments described in this paper that the data
measured belongs to a single coherent system  this is in keeping with general experimental
approaches where it is assumed that the measurements are related in some way by being
part of the same system  of course we may get this wrong and have to relax the requirement
because we discover that what we thought were related cannot actually be brought together
in a single model  this generalises the requirement for parsimony in line with einsteins
adage that a model should be as simple as possible and no simpler  in this case it
translates to minimising the number of disjoint sub systems identified 
    a qualitative solution space
in section     we shall present an algorithm for automatically constructing models from
data  with this method we utilise background knowledge consisting of qsim modelling
primitives combined with systems theory meta knowledge  e g  parsimony and causality  
later we shall also provide an analysis of the models learned and the states utilised to learn
them in order to ascertain which  if any  states are more important for successful learning 
one way to facilitate this analysis is to make use of a solution space to relate the qualitative
states to the critical points of the relevant class of systems  via the isoclines of the system   
   the critical points of a dynamic system are points where one or more of the derivatives of the state
variables is zero  the isoclines are contours of critical points 

   

fiqualitative system identification

 coghill        coghill  asbury  van rijsbergen    gray         as stated previously  a
qualitative analysis of the u tube will generate an envisionment containing six states  as
shown in table    and depicted in the envisionment graph given in fig     continuing with
h 
h 
h 

height

 

 

 

f      

 

 
 

time

 

 

h 

figure    the qualitative states of the u tube system presented on representative time
courses  left  and on the solution space  right   the state numbers refer to the
states of the u tube described above   state   represents the steady state which
is strictly speaking only reached at t     but is in practice taken to occur when
the two trajectories are sufficiently close  as shown here  

the u tube  there are two ways it can behave  ignoring state     captured in fig     either
the head of fluid in tank   is greater than that in tank    state     in the extreme tank
  is empty  state     or the head is greater in tank   than tank    state     fig     left 
shows the transient behaviour for the extreme case where tank   is empty  state     it can
be seen from this diagram that while the head starts in this condition its eventual end is
equilibrium  state     in this state equation   can be rewritten as 


    k   h   h    


   


    k   h   h    

by definition k must be non zero  so the only solution to this pair of equations is 
h    h  
this relation can be plotted on a graph as shown on the right hand side of fig     now
the qualitative states of the u tube may be placed on this solution space graph in relation
to the equilibrium line  this representation  similar in form to a phase space diagram  is
useful because it provides a global picture of the location of the qualitative states of an
envisionment relative to the equilibria or critical points of the system  it has also been
utilised in the construction of diagnostic expert systems  warren  coghill    johnstone 
       for further details of this means of analysing envisionments see the work of coghill
       and coghill et al         
   

ficoghill  srinivasan    king

bb i    f     given an initial element i from a discrete set s  a successor function    s    s   and a cost function
f   s     return h  s such that h contains the set of cost minimal models  that is for all h i j  h  f  hi    
f  hj     fmin and for all s   s h f  s      fmin  
   active    h i   i 
   worst    
   selected    
   while active    hi
   begin
 a  remove element  k  costk   from active
 b  if costk   worst
 c  begin
i  worst    costk
ii  selected     k 
iii  let p rune   active s t  for each j  p rune    f  j    worst where f  j  is the lowest cost
possible from j or its successors
iv  remove elements of p rune  from active
 d  end
 e  elseif costk   worst
i  selected    selected   k 
 f  branch     k 
 g  let p rune   branch s t  for each j  p rune    fmin  j    best where fmin  j  is the lowest cost
possible from j or its successors
 h  bound    branch p rune 
 i  for x  bound
i  add  x  f  x   to active
   end
   return selected

figure    a basic branch and bound algorithm  the type of active determines specialised
variants  if active is a stack  elements are added and removed from the front 
then depth first branch and bound results  if active is a queue  elements added
to the end and removed from the front  then breadth first branch and bound
results  if active is a prioritised queue then best first branch and bound results 

    the algorithm
the ilp learner used in this research is a multistage procedure  each of which addresses
a discrete optimisation problem  in general terms  this is posed as follows  given a finite
discrete set s and a cost function f   s     find a subset h  s such that h  
 s s  s and f  s    minsi s f  si     an optimal algorithm for solving such problems is the
branch and bound algorithm  shown in fig     the correctness  complexity and optimality
properties of this algorithm are presented in a paper by papadimitriou   steiglitz        
a specific variant of this algorithm is available within the software environment comprising
aleph  srinivasan         the modified procedure is in fig     the principal differences
from fig    are 
   the procedure is given a set of starting points h     instead of a single one  i in fig     
   

fiqualitative system identification

   a limitation on the number of nodes explored  n in fig     
   the use of a boolean function acceptable   h  b  e   f alse  t ru e  
acceptable k b e  is true  if and only if   a  hypothesis k explains the examples
e  given b in the usual sense understood in ilp  that is  b  k    e in the absence
of noise   and  b  hypothesis k is consistent with any constraints i contained in the
background knowledge  that is b ki         in practice  it is possible to merge these
requirements by encoding the requirement for entailing some or all of the examples
as a constraint in b 
   inclusion of background knowledge and examples  b and e in fig      these are
arguments to both the refinement operator   the reason for this will become apparent
shortly  and the cost function f  
the following points are relevant for the implementation used here 
 each qualitative model is represented as a single definite clause  given a definite
clause c  the qualitative constraints in the model  the size of the model  are obtained
by counting the number of qualitative constraints in c  this will also be called the
size of c 
 constraints  such as the restriction to well posed models  described below   are assumed to be encoded in the background knowledge 
 the initial set h  in fig    consists of the empty clause denoted here as   that is 
h       
 acceptable c  b  e  is t ru e for any qualitative model c that is consistent with the
constraints in b  given e 
 active is a prioritised queue sorted by f  
 the successor function used is a   this is defined as follows  let s be the size of
an acceptable model and c be a qualitative model of size s   with n   s  s     we
assume b contains a set of mode declarations in the form described by  muggleton 
       then  given a definite clause c  obtain a definite c    a  c  b  e  where a  
n 
na   hd     d  a
 c  b  e  s t  d     a  d  b  e i   n      c     a  c  b  e  is
obtained by adding a literal l to c  such that 
 each argument with mode  t in l is substituted with any input variable of type
t that appears in the positive literal in c or with any variable of type t that
occurs in a negative literal in c 
 each argument with mode t in l is substituted with any variable in c of type
t that appears before that argument or by a new variable of type t 
 each argument with mode  t in l is substituted with a ground term of type t 
this assumes the availability of a generator of elements of the herbrand universe
of terms  and
 acceptable c     b  e  is t ru e 
   

ficoghill  srinivasan    king

bba  b  e  h      f  n    given background knowledge b  b  examples e  e  a non empty set of initial elements
h  from a discrete set of possible hypotheses h  a successor function    h  b  e    h   a cost function
f   h  b  e     and a maximum number of nodes n  n  n     to be explored  return h  h such that
h contains the set of cost minimal models of the models explored 
   active   hi
   for i  h 
 a  add  i    to active
   worst    
   selected    
   explored     
   while  explored   n and active    hi 
   begin
 a 
 b 
 c 
 d 

 e 
 f 
 g 
 h 
 i 

remove element  k  costk   from active
increment explored
if acceptable k  b  e 
begin
i  if costk   worst
ii  begin
a  worst    cost
b  selected     k 
c  let p rune   active s t  for each j  p rune    f  j  b  e    worst where f  j  b  e  is the
lowest cost possible from j or its successors
d  remove elements of p rune  from active
iii  end 
iv  elseif costk   worst
a  selected    selected   k 
end
branch     k  b  e 
let p rune   branch s t  for each j  p rune    f  j  b  e    worst where f  j  b  e  is the lowest
cost possible from j or its successors
bound    branch p rune 
for x  bound
i  add  x  f  x  b  e   to active

   end
   return selected

figure    a variant of the basic branch and bound algorithm  implemented within the
aleph system  here b and e are sets of logic programs  and n the set of
natural numbers 

the following properties of  a  and  in turn of a   can be shown to hold  riguzzi 
      
 it is locally finite  that is   a  c  b  e  is finite and computable  assuming the
constraints in b are computable  
 it is weakly complete  that is  any clause containing n literals can be obtained
in n refinement steps from the empty clause 
   

fiqualitative system identification

 it is not proper  that is  c   can be equivalent to c 
 it is not optimal  that is  c   can be obtained multiply by refining different
clauses 
in addition  it is clear by definition that given a qualitative model c  acceptable c     b  e 
is t ru e for any model c     a  c  b  e   in turn  it follows that acceptable c     b  e 
is t ru e for any c    a  c  b  e  
 the cost function used  following muggleton        is f bayes  c  b  e    p c b  e 
where p c b  e  is the bayesian posterior probability estimate of clause c  given
background knowledge b and positive examples e  finding the model with the maximal posterior probability  that is  lowest cost  involves maximising the function  mccreath        
 
q c    logdh  c    p log
g c 
where dh is a prior probability measure over the space of possible models  p is the
number of positive examples  that is  p    e    and g is the generality of a model 
we use the approach used in the ilp system c progol to obtain values for these two
functions  that is  the prior probability is related to the complexity of models  more
complex models are taken to be less probable  a priori   and the generality of a model
is estimated using the number of random examples entailed by the model  given the
background knowledge b  the details of this are presented by muggleton in his paper
of       
we have selected this bayesian function to score hypotheses since it represents  to
the best of our knowledge  the only one in the ilp literature explicitly developed
for the case where data consist of positive examples only  as is the situation in this
paper  where examples are observations of system behaviour  system identification
from non behaviour does not represent the usual understanding of the task we are
attempting here  
it is evident that these choices make the branch and bound procedure a simple generateand score approach  clearly  the approach is only scalable if the constraints encoding
well posed models are sufficient to restrict acceptable models to some reasonable number 
we describe a set of such constraints that are sufficient for the models examined in this
paper  in the rest of the paper  the term ilp qsi will be taken to mean the aleph
branch and bound algorithm with the specific choices above 
      well posed models
well posed models were introduced in section      in the current implementation they are
defined as satisfying at least the following syntactic constraints 
   size  the model must be of a particular size  measured by the number of qualitative
relations for physical models in sections     and   or the number of metabolites for
the biological model in section     this size is pre specified 
   complete  the model must contain all the measured variables 
   

ficoghill  srinivasan    king

   determinate  the model must contain as many relations as variables  a basic principle
of systems theorythe reader may recall a version from school algebra  where a system
of equations contains as many equations as unknowns  
   language  the number of instances of any qualitative relation in the model must be
below some pre specified limit  this kind of restriction has been studied in greater
detail in the work of camacho        
and at least the following semantic constraints 
   sufficient  the model must adequately explain the observed data  by adequate  we
intend to acknowledge here that due to noise in the measurements  not all observations
may be logical consequences of the model     the percentage of observations that must
be explainable in this sense is a user defined value 
   redundant  the model must not contain relations that are redundant  for example  the relation add inf low  outf low  x   is redundant if the model already has
add outf low  inf low  x   
   contradictory  the model must not contain relations that are contradictory given
other relations present in the model 
   dimensional  the model must contain relations that respect dimensional constraints 
this prevents  for example  addition of relations like add inf low  outf low  amount 
that perform arithmetic on variables that have different units of measurement 
the following additional constraints which are here incorporated in the algorithm could be
ignored  because they are preferences rather than absolute rules   but all results presented
in this paper require them to be satisfied 
   single  the model must not contain two or more disjoint models  the assumption
is that if a set of measurements are being made within a particular context then the
user desires a single model that includes those measurement variables 
    connected  all intermediate variables should appear in at least two relations 
    causal  the model must be causally ordered  iwasaki   simon        with an integral
causality  gawthrop   smith         that is  the causality runs through the algebraic
constraints of the model from the magnitudes of the state variables to their derivatives 
and from the derivatives to the magnitudes through a deriv constraint only 
this list is not intended to be exhaustive  we fully expect that they would need to be augmented by other domain specific constraints  the biological system identification problem
described in section   provides an instance of this   the advantage of using ilp is that
such augmentation is possible in a relatively straightforward manner 
   strictly speaking  the model in conjunction with the background knowledge 

   

fiqualitative system identification

    experimental investigation of learning the u tube system
in this section we present a comprehensive experimental test of the learning algorithm
described in the previous section  we again focus on the u tube to illustrate the approach
and explain the results obtained  in a subsequent section we will present the results of
applying ilp qsi to learning the structure of a number of different systems of a similar
kind  the data utilised in these experiments is qualitative  it is assumed that either the
measurements themselves yield qualitative values or that they are quantitative time series
that have been converted to qualitative values  this latter may be necessary in situations
where the quantitative time series data are not available in sufficient quantity to permit
quantitative system identification to be performed 
the following is the general method applied to learning all the systems studied for this
paper 
      experimental aim
using the u tube system  investigate the model identification capabilities of ilp qsi using
qualitative data that are subject to increasing amounts of noise and are made increasingly sparse in order to ascertain the circumstances under which the target system may be
accurately identified  as a function of the number of qualitative observations available 
      materials and method
the model learning system ilp qsi seeks to learn qualitative structural models from qualitative data  therefore the focus of the experiments is on learning from qualitative data 
data there are no inputs  exogenous variables  to this system  the data required for
learning are combinations of the qualitative states  of which there are    from the envisionment shown in table   
method there are two distinct sets of experiments reported here  those based on noise
free data and those based on noisy data  the former assume that the data provided are
correct and are used to test the capability of ilp qsi in handling sparse data  the latter set
of experiments captures the situation where the qualitative data may be incorrect because
of measurement errors due to noise in the original signal  or through errors introduced in
a quantitative to qualitative transformation  which may occur in cases where the original
data is numerical  
noise free data  we use the following method for evaluating ilp qsis system identification
performance from noise free data 
for the system under investigation 
   obtain the complete envisionment from specific values of exogeneous variables 
 in the particular case of the u tube discussed in this section there are exogenous
variables and the envisionment states are as shown in table    as stated above  
   

ficoghill  srinivasan    king

   with non empty subsets of states in the envisionment as training data construct a
set of models using ilp qsi and record the precision of the result    the number of
possible non empty sets of states for the different test scenarios for the u tube is    
  n     where n is the number of states in the complete envisionment 
   plot learning curves showing average precision versus size of training data 
noisy data  we use the following method for evaluating ilp qsis system identification
performance from noisy qualitative data 
for the system under investigation 
   obtain the complete envisionment from specific values of exogeneous variables 
   replace non empty subsets of states in the envisionment with randomly generated
noise states  with each such combination of correct and random states  as training
data construct a set of models using ilp qsi and record the precision of the result   
given a complete envisionment of n states  replacing a random subset k     of these
with random states will result in a noisy envisionment consisting of n  k noisefree states and k random states  as with step   for noise free data  an exhaustive
replacement of all possible subsets of the complete envisionment with random states
will result in  n    noisy test sets 
   plot learning curves showing average precision versus size of training data 
      results
the results of performing these experiments  showing the precision of learning the target
model versus the number of states used  for both noise free and noisy data  are shown in
fig     it is evident that for both situations precision improves with the number of states
used and that the results from the experiments with noisy data have lower precision than
those with the noise free data  though the curves have the same general shape   both these
results are as one would expect 
with noise free data we find that it was not possible to identify the target model using
just one state as data  however it was possible to identify the target model using pairs of
states in     of cases  these states are 
                                                              
we refer to these as kernel sets  for the time being we merely report this finding and delay
a discussion of its significance until after reporting the results for the experiments on the
other systems in the class 
   this is the proportion of the models in the result that are equivalent to the correct model  thus  for each
training data set  the result returned by ilp qsi will have a precision between     and      the term
precision as used here has the meaning usually associated with it in the machine learning community
rather than that familiar in qualitative reasoning 
   as with the non noisy data  for each training data set  the result returned by ilp qsi will have a
precision between     and     

   

fiqualitative system identification

 

   

   

precision

   

   

   

   

   

   

clean
noisy

   

 
 

 

 

 

 

 

number of states

figure    precision of models obtained for the u tube 

   experiments on other systems
in this section we present the same experimental setup applied to a number of other systems 
coupled tanks  cascaded tanks and a mass spring damper  these systems are representative
of a class of system appearing in industrial contexts  e g  the cascaded tanks system has
been used as a model for diagnosis of an industrial ammonia washer system by warren
et al         as well as being useful analogs to metabolic and compartmental systems 
in each case the experimental method is identical to that utilised for the u tube as
described in section      for each system we give a description of the system and the target
model  the envisionment associated with the system  a statement of the data used in the
experiments  and a summary of the results obtained from the experiments 
    experimental aim
for three physical systems  coupled tanks  cascaded tanks and mass spring damper  a well
known example of a servomechanism   investigate the model identification capabilities of
ilp qsi using qualitative data that are subject to increasing amounts of noise and are
made increasingly sparse 
    materials and method
data qualitative data available consist of the complete envisionment arising from specific
values for input variables  the precise details of the data are given with each experiment 
method

the method used is the same as that for the u tube and described in section     
   

ficoghill  srinivasan    king

h 
     std  
     inc  
         dec  
         dec  
         inc  
         dec  
         std  
         dec  
         dec  
         dec  

state
 
 
 
 
 
 
 
 
  
  

h 
     std  
         dec  
     inc  
         inc  
         dec  
         std  
         dec  
         dec  
         dec  
         dec  

qx
     std  
         inc  
         dec  
         dec  
         inc  
         dec  
     inc  
         dec  
         std  
         inc  

qo
     std  
         dec  
     inc  
         inc  
         dec  
         std  
         dec  
         dec  
         dec  
         dec  

table    the envisionment states used for the coupled tanks experiments   the states are
labeled to be in accord with those for the u tube  since state   in the u tube does
not appear in the coupled tanks envisionment there is no state labeled   in this
table  
    the coupled tanks
this is an open system consisting of two reservoirs as shown in fig     essentially  it can
be seen as a u tube with an input and an output  the input  q i   flows into the top of tank
  and the output  qo   flows out of the base of tank    see fig     
tank  

tank  
qi

h 

h 

 
h

h

m 

dt

h 

h  

h 
qi
qx

 

m 

dt
h  

qx

 

qo

deriv h  h     
deriv h  h     
add h   delta h  h    
m   delta h qx   
m   h   qo   
add h    qo  qx   
add qx h    qi   

qo

figure    the coupled tanks   left  physical   middle  qsim diagram   right  qsim relations 
in these experiments we assume that we can observe  q i   qx   h    h    and qo   thus system
identification must discover a model with three intermediate variables  h      h   and h 
data there is one exogenous variable  namely the flow of liquid into tank    q i    in the
experiments described here the input flow is kept at zero  that is  q i   h   stdi   making
the system for this particular case just moderately more complex than the u tube  the
complete envisionment consists of    states  as shown in table   and fig      which means
there are      experiments in this set 

   

fiqualitative system identification

 

 

 

 

 

 

  

 

  

 

figure     coupled tanks envisionment graph 
      results
the precision graphs for the coupled tanks experiments are shown in fig      here again
results show the improvement in precision as the number states used increases and also the
deterioration in precision when noise is added  the effect of noise is worse when fewer states
are used than was the case for the u tube  though its effect is nullified when all states are
used 
 

   

   

precision

   

   

   

   

   

clean
noisy

   

   

 

 

 

 

 

 

 

 

 

 

  

number of states

figure     coupled tanks precision graphs 
for the noise free data it was again not possible to identify any models using a single
datum but utilising pairs of states yielded the target model in     of cases  the relevant
pairs of states  kernel sets  are 
                                      
   

ficoghill  srinivasan    king

whereas in the u tube experiments all the states in which the target model was successfully
learned were supersets of the pairs  in the coupled tanks case there are sets of three states
 which are not supersets of the pairs listed above  that result in successful identification of
the target model 
                                 
                                 
                                 
                                 
    cascaded tanks
this system is also an open system  however  flow through the system is always unidirectional  unlike the coupled tanks system   in principle  the system can be broken into
two sub systems each containing one reservoir  each with their own input and output 
an example of the system is shown in fig      liquid flows into tank    and then unidirectionally from tank   into tank    as is apparent from the figure  the flow is into the
top of tank   and out of the base of tank   
qi

h 

h 
qx

h 
m 

dt
h  

tank a

m 

dt
h  

qo

h 

qi

 

qx

 

qo

deriv h  h     
deriv h  h     
m   h   qx   
m   h   qo   
add h    qo  qx   
add qx h    qi   

tank b

figure     the cascaded tanks   left  physical   middle  qsim diagrammatic   right  qsim
relations 
we assume that we can observe  qi   h    h    and qx   thus system identification must
discover a model with two intermediate variables  h    and h     the numbered list of states
 or complete envisionment  for this case is shown in fig     and table   

data there is one exogenous variable  namely the flow of liquid into tank    q i    we
increase the complexity by allowing a steady positive input flow  that is  q i   h       stdi  
the complete envisionment consists of    states  as shown in fig     and table   which
means        experiments are required  
      results
the precision graphs for the cascaded tanks are shown in fig      the graphs are similar
in shape to the coupled systems  but showing generally lower precision with noisy data 
further examination shows that we are unable to identify the target model from fewer than
three states  the subset triples  which form the kernel sets in this case  from which the
   

fiqualitative system identification

 

  

 

 

 

  

 

 

  

  

  

 

 

 

figure     cascaded tanks envisionment graph 
state
 
 
 
 
 
 
 
 
 
  
  
  
  
  

h 
     inc  
     inc  
         dec  
         dec  
         dec  
         dec  
         std  
         std  
         std  
         std  
         inc  
         inc  
         inc  
         inc  

h 
     std  
         dec  
     inc  
         dec  
         std  
         inc  
     inc  
         dec  
         std  
         inc  
     inc  
         dec  
         std  
         inc  

qx
     inc  
     inc  
         dec  
         dec  
         dec  
         dec  
         std  
         std  
         std  
         std  
         inc  
         inc  
         inc  
         inc  

qo
     std  
         dec  
     inc  
         dec  
         std  
         inc  
     inc  
         dec  
         std  
         inc  
     inc  
         dec  
         std  
         inc  

table    the envisionment states used for the cascaded tanks experiments 

target model was identified are 
                                                                                      

   

ficoghill  srinivasan    king

 

clean
noisy

   

   

precision

   

   

   

   

   

   

   

 

 

 

 

 

 

  

  

  

number of states

figure     cascaded tanks precision graph 
    mass spring damper
the final physical system considered is an abstraction of a wide variety of servomechanisms
with a displacing force  an example of the system is shown in fig      in this situation  a
mass is held in equilibrium between two forces  if the equilibrium is disturbed  oscillatory
behaviour is observed  the motion of the mass is damped so that the oscillations do not
continue indefinitely  and will eventually return to the original equilibrium position  if an
external force is applied  for example pulling the mass down  its final resting place will be
displaced from the natural equilibrium point  see fig       the mass m has displacement
dispm from its rest position  and at any time  t  it is moving with velocity vel m and
accelerating at rate accm   we assume that we can observe the variables  disp m   velm   accm  
disp m m  h  
 

dt
damping

spring

vel m m 

h 

h
 

force

dt
vel
disp

a v sec

accm m 

h 

deriv dispm  velm   
deriv velm  accm   
m   dispm  h    
m   velm  h    
m   accm  h    
add h  h   h    
add h  h   force  

force

figure     the spring system  a  physical   b  qsim diagrammatic   c  qsim relations
and f orce  qualitative system identification must now find a model with four intermediate
variables  h    h    h  and h    as well as a intermediate relation add h    h   h     between
   

fiqualitative system identification

three of these variables  the input force  force  is exogenous  in the experiments here 
we only consider the case where there is a steady force being applied to the system  that
is  forcea   h       stdi   the complete envisionment for this case is shown in fig     
where the equilibrium point is represented by state    the precision graphs are shown in
 
  

  

  

  

 

 

  

  

  

  

  

  

  

  

  

  

 

 

 

  

 

 

  

  

  

  

 

 

  

  

figure     mass spring damper envisionment graph
fig      for this system the envisionment contains    states  which makes exhaustive testing
unrealistic  instead sets of clean and noisy states were randomly selected from the space of
possible experiments  nonetheless it can be observed that the average precision graphs are
in line with those obtained for the tanks experiments  however  the actual precision values
suggest that both sparse data and noise have less of an effect here than the other systems 
this may be due to the tight relationship between the two derivatives in the spring model 
making the system extremely constrained 
    discussion of results
an inspection of the experimental results reveals an expected pattern  in all cases the
precision curves  for both noisy and noise free experiments  have the same general shape 
experiments which utilise fewer states identify the target model less often than when a
greater number of states are used  however  a closer examination of the results reveals
that even when few states are used  pairs or triples  the target model may be consistently
found when particular combinations of states are used  in order to understand why this is
so requires us to look at the solution spaces for the systems concerned   
we will examine the u tube and coupled tanks together because they are very closely
related systems and both had zero input  the cascaded tanks system is slightly different
and had a non zero input and so will be discussed later in the section 
   we do not discuss the spring system here because of its complexity 

   

ficoghill  srinivasan    king

 

   

   

precision

   

   

   

   

   

   

clean data
noisy data

   

 
 

 

 

  

  

  

  

  

  

  

  

number of states

figure     mass spring damper precision graph
      the u tube and coupled tanks
the bare results  while interesting  do not give any indication of why the particular pairs or
triples highlighted should precisely identify the target model  in order to ascertain why 
we must examine the envisionment states given in tables   and    from these we can itemise
the relevant features of the sets of states as follows 
 for both the u tube and coupled tanks there is at least one critical point in each pair 
 for both these systems each pair of states contains one state for each branch in the
envisionment graph  fig      fig       and of these at least one is at the extreme of
its branch  that is  states where one tank is either empty or the state immediately
succeeding this  and the other tank is relatively full so that that the derivatives for
that height in each tank have opposite signs 
 for both systems all supersets of these minimal sets will precisely learn the target
model 
these observations lead us to suggest that for coupled systems the ability of the learning
system to identify the structure of a model is dependent on the data used including the
critical points and on having data that covers all the different types of starting point that
the system behaviours can have  this is in keeping with what systems theory would lead
us to expect  gawthrop   smith        
in order properly to appreciate what is indicated by these kernel sets and the relation
of the systems to each other we need to look at the solution spaces  coghill et al        
   

fiqualitative system identification

coghill        for the two systems  these are shown in fig      and their derivation is
similar to that given in section     and detailed in appendix a   from these we can get a
clear picture of where the kernel pairs and triples lie with respect to the critical points of
the system 
h  h   

h 

h   

h 

 

 

 

 

 

  

 

  

 

h   

 
 
 

 

 

h 

 

 

h 

figure     the solution spaces for the u tube and coupled tanks systems 
from the system diagrams provided in fig    and fig    it can be seen that the u tube
and coupled tanks systems differ only in the fact that the coupled tanks has an outlet orifice 
whereas the u tube does not  this accounts for the major difference in their solution spaces 
namely that the coupled tanks has two critical points  states   and    whereas the u tube
has only one  state     which is actually the steady state  this gives rise to the additional
states        and    which lie between the critical points    it can be observed that as the
outlet orifice from tank   in the coupled tanks system decreases in size the space between
the isoclines in the solution space will become narrower until it disappears when the orifice
closes  this can be seen more formally by comparing equations   and    in appendix a 
there it is clear that as k  approaches zero  equation   approximates equation     and when
k      the two equations are the same  
if we now look again at the sets of pairs we can observe that they are related in ways
that reflect the relationship between the two coupled systems  firstly  looking at the pairs 
for the u tube there are   pairs which include the critical point  steady state   state       
                    and         now noting from the discussion above that state   in the u tube
relates to either of states   or   in the coupled tanks then we find that the analogous pairs
exist in the kernel set for the coupled tanks                         and         this leaves one
pair from the coupled tanks pairs unaccounted for          however  this is no surprise since
that pair is taken to map to state   in the u tube  and it is the consistent finding that no
singleton state is sufficient to learn a model of the system 
   there are three states here because they differ only in the magnitude of the qx or qdir of h   and h    
neither of which appear explicitly in the solution space  readers may convince themselves of this by
comparing table   with the envisionment in table   

   

ficoghill  srinivasan    king

there are still   pairs in the u tube experiments from which we are able to learn reliably
the target model that do not have a corresponding coupled tanks pair  these are         
                and         a comparison with the triples for the learning of the coupled tanks
model reveals that these states are the pairs which are conjoined with either state       or
   to make up the triples  the inclusion of these states warrants further explanation since
they are the states which distinguish the closed u tube from the open coupled tanks  in all
three of these states the state variables both have the value h       dec i  a situation that
cannot occur in the u tube  combining this with the fact that the four pairs listed above
do not contain a critical point and are qualitatively identical in both systems leads one to
the conclusion that the additional information contained in these triple kernel sets enables
one to distinguish between the u tube and coupled tanks in such a case 
these results extend  strengthen and deepen those reported in coghill et al         and
garrett et al         
      the cascaded tanks
the cascaded tanks system is asymmetrical with the flow only being possible in one direction  the fact that the input is a positive steady flow makes the setup marginally more
complex in that regard than for the coupled systems  where there was no input flow 
the kernel sets from which a model of this system may be learned  presented in section
      are depicted schematically in fig     in order to explain the results obtained  if we
look at the first and middle columns of this diagram and ignore  for the time being  the
downstream tank  we can see that what is represented are two pairs of states  the tank
empty combined with the tank being at steady state  or the tank empty combined with the
state where the amount of fluid in the tank is greater than steady state  we have confirmed
experimentally that these are kernel sets from which a single tank model can be learned 
if we now ignore the upstream tank  apart from its outflow  and examine the middle
and third columns of the diagram we can see that these divide into two groups according to
whether the input to the downstream tank is steady or decaying  positive and decreasing  
for each of these there are two pairs of states  which are the same as for the upstream tank 
the tank empty combined with the tank being at steady state  or the tank empty combined
with the state where the amount of fluid in the tank is greater than steady state  in the
case of this tank it can be seen that the cross product of states appear in the kernel sets
because each case represents a valid possible situation 
these results lead to two major conclusions with regard to the cascaded tanks system 
   ilp qsi effectively identifies the individual components of the cascade and combines
them through the cascade point 
   the situation with the downstream tank  where the input was either a steady flow or a
decreasing flow  indicates that utilising a variety of inputs can aid in the identification
process 
the former conclusion may serve as a pointer to the possibility of incremental learning
of cascaded systems 
   

fiqualitative system identification

 

 

 

 

 

 

 

 

 

 

 

figure     a schematic representation of the triples of states from which the target model
for the cascaded tanks systems is learned 

   

ficoghill  srinivasan    king

   experiments with quantitative data
this part of the experimental testing of our system is a  proof of concept test  as has been
stated our system has been designed to learn qualitative models from qualitative data  as
such it is assumed that the conversion of any quantitative data has already been performed 
not least because the needed qualitative data analysis would require another research project
and is beyond the scope of this paper  however  in order to test the usability of our system
with quantitative data and to test its ability to go through the whole process from receiving
the data to producing the model  we have implemented a rudimentary data analysis package
to facilitate this  of course this is not exhaustive  but it will permit us to test the results
produced via such a process for consistency with those produced from the experiments with
qualitative data 
    experimental aim
using the four physical systems  investigate the model identification capabilities of ilpqsi using numeric traces of system behaviour that are subject to increasing amounts of
noise 
      quantitative to qualitative conversion
before proceeding to describe the experiments carried out  we present the method used
to convert numerical data into the qualitative form required by ilp qsi because this is
utilised in each set of experiments 
we have adopted a straightforward and simple approach to performing the conversion 
for a quantitative variable x  values at n real valued time series steps were numerically
differentiated by means of a central difference approach  shoup        such that 
 xi xi     xi   xi  
 





dxi
dt

 

d  x i
dt 


   xi  xi      xi    xi   

i    n   

a quantitative variable x is converted into a qualitative variable q   hqmag  qdiri  where
qmag                   is generated from x  and qdir   dec  std  inc  is generated from
dx dt  the qualitative derivative of q  q  is obtained in a similar manner but is generated
from from dx dt and d  x dt  respectively 
the data are typically noisyeither inherently  or because of the process of differentiation
and we perform some simple smoothing of the first and second derivatives using a blackman
filter  a relative of the moving average filter  see blackman   tukey         in each case 
the filter is actually applied to the result of a fast fourier transform  fft  and the result obtained by taking the real part of the inverse fft  we note here that this form of
smoothing is appropriate only when a sufficient number of time steps are present 
having obtained a  smoothed  numerical value x i for variable x at instant i  its qualitative magnitude qmag xi   is  in principle  simply obtained by the following 
qmag xi    



      

if xi    
 
if xi    


       otherwise
   

fiqualitative system identification

in practice  since floating point values are unlikely to be exactly zero  we have found
it advantageous to re apply the filtering process to data straddling zero to eliminate small
fluctuations around this value  despite these measures  in addition to generating correct
qualitative states  true positives  the conversion can produce errors  states generated may
not correspond to true states  false positives   and some true states may not be generated
 false negatives   fig     shows an example of this  the problem is  of course  exacerbated
further if the original quantitative data are noisy   the reason for these imperfect results
from noise free quantitative data are twofold  one is the smoothing process on small fluctuations around zero  but the main reason is that  as discussed above  creating a full qualitative
state involves numerical differentiation which introduces noise into the data for the derivatives that affects the ability of the process to convert from quantitative to qualitative with
absolute accuracy 
system
u tube
coupled
cascaded
spring

true
states
 
  
  
  

generated
states
 
  
 
  

true
positives
 
 
 
  

false
positives
 
 
 
  

false
negatives
 
 
 
 

figure     an example of the errors resulting from generating qualitative states from traces
of system behaviour  here  the traces were generated by the following initial
conditions  h         h        for all three tank systems  and disp m       
velm       for the spring 

    materials and method
numerical simulations of the four physical systems were constructed using the same general
relations as the qualitative models  once again the experiments were carried out utilising
both noise free and noisy data  as described in the rest of this section 
      data
the models used for the numerical simulations had the same structure as the qualitative
models  but with the substitution of a real valued parameter for each monotonic function
relation  this gives a linear relation between the two variables  more complex  non linear
functions might have been used  but linear functions provided a suitable approximation of
the known behavior of these systems  as shown graphically in fig      a  d   which is as
much as is required for this proof of concept study 
for a given set of function parameter values  initial conditions  and input value  a
quantitative model produces a single quantitative behaviour  this contrasts with qualitative
models that can produce a list of all possible behaviours for the model   parameter values
were chosen so that the models approached a steady state during the time period of the
test  the models were implemented in matlab     using the ode  s ode solver  each
   

ficoghill  srinivasan    king

 

 

tank a
tank b

   

tank a
tank b
   

   

   
 

level

level

   

   

   

   
 
   

   
   
   

 

 

  

   

   

   

   
   
time in seconds

   

   

   

 

   

 

 

  

   

   

   

   
   
time in seconds

   

   

   

   

  

tank a
tank b

displacement
velocity

  

   
  

displacement velocity

level

 

   

 

 

 

 
  

   
  

 

 

  

   

   

   

   
   
time in seconds

   

   

   

  

   

 

  

   

   

   

   
   
time in seconds

   

   

   

   

figure     a graph of example numeric behavior of  a  the u tube  top left   b  the coupled
tanks  top right   c  the cascaded tanks  bottom left  and  d  damped spring 
bottom right 

time point generated by the simulation was made available as part of the sampled data 
this ensures that the sampling rate is suitably fast with respect to the nyquist criterion 
it also guarantees that a sufficient number of data points are available as required by the
beckman filter 
      method
noise free data  we use the following method for evaluating ilp qsis system identification
performance from noise free data 
for each of the four test systems 
 a  obtain the system behaviour of the test system with a number of different initial
conditions and input values  convert each of these into qualitative states using
the procedure in section       
 b  using all the qualitative states obtained as training data construct a set of models
using ilp qsi and record the precision of the result  this is the proportion of
   

fiqualitative system identification

the models in the result that are equivalent to the correct model   thus  for each
training data set  the result returned by ilp qsi will have a precision between
    and     
the following details are relevant   a  the quantitative models were each put into three
separate initial conditions  so that the magnitude of the two state variables were set to        
       and         specifically  these were the initial values of the two tank levels for all three
tank systems  and the displacement and velocity for the spring  these values were not
crucial but were chosen for the initial conditions because they caused the numerical models
to converge on the steady state for each system in a reasonable number of iterations   b 
each initial condition gave rise to a system behaviour and hence a set of qualitative states 
in the second step above  qualitative states from all behaviours is used as training data 
this is because kernel subsets necessary for correct system identification usually contain
qualitative states from multiple quantitative behaviours   c  the conversion process results
in erroneous qualitative states  see section         thus  the training data used here contain
both false positives and false negatives 
noisy data  we use the following method for evaluating ilp qsis system identification
performance from noisy quantitative data 
for each of the four test systems 
 a  obtain the system behaviour of the test system with a number of different initial
conditions and input values 
 b  corrupt each system behaviour with additive noise 
 c  convert each corrupted behaviour into qualitative states using the procedure in
section       
 d  using all the qualitative states obtained as training data construct a set of models
using ilp qsi and record the precision of the result  this is the proportion of
the models in the result that are equivalent to the correct model   thus  for each
training data set  the result returned by ilp qsi will have a precision between
    and     
in the second step noise was added to the numerical data sets as follows  a gaussian noise
signal  with a  of     and  of      was generated using by the built in matlab function
normrnd and scaled to three orders of magnitude of the original noise  namely           and
     representing low  medium and high amounts of noise respectively   these scaled
noise variants were added to the numerical values of the system behaviour obtained from
each initial condition 
    quantitative experimental results
the process of converting from quantitative to qualitative states introduces errors  even
for noise free data  table   shows the proportion of correct qualitative states to the total
number of qualitative states that were obtained from the numerical signal  including noisy
states  the table shows this proportion for all four systems  under the different degrees
   

ficoghill  srinivasan    king

model
u tube

coupled

cascaded

spring

noise level
 
    
   
 
 
    
   
 
 
    
   
 
 
    
   
 

initial states
     
     
     
   
   
   
   
   
   
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
   
   
   
    
    
   
    
    
    
    
    
    
                 
                 
                 
                 

table    the input data for the numeric experiments  described as the proportion of the
number of clean states   the total number of converted states for different systems
and degrees of noise 

of noise  the numerical simulations were not intended to be exhaustive and do not cover
every possible such behaviour  so it is not surprising to observe that there is no case where
all the states of the complete envisionment are generated 
the results of the qualitative experiments detailed in the previous section indicate that
in order successfully to learn the target model data from all branches of the envisionment
are required  and the greater the number of such states used the greater the liklihood of
learning the target model structure  therefore in these experiments we utilised all the states
generated from the numerical simulations 
the results from the numerical data experiments are shown in fig      these experiments show that it is possible to learn models from clean and noisy numerical data even
when the qualitative states generated from the clean numerical data contain a number of
unavoidable data transformation errors  the results for each of the systems used are as
follows 
the spring system this system has    states in the complete envisionment and table  
shows that the quantitative to qualitative conversion process yields around    of those
states  it can be seen from fig     that learning from    states gives      precision
in learning this target model  even in the presence of noise  it is not surprising 
therefore  to find that the learning precision is perfect up to the highest noise level 
since the qualitative experiments were done by sampling  the slight downturn at the
highest noise level could be due to the large number of noisy states generated in this
   

fiqualitative system identification

 
   
   

utube
coupled tanks
cascaded tanks
spring

precision

   
   
   
   
   
   
   
 
 
    
   
   

amount of noise

figure     a comparison of the results from the numerical learning tests  averaged over all
three initial conditions  tests that attempted to learn from few states  such as
the cascaded tanks  are more likely to fail than those that have large numbers
of states  such as the spring  this is consistent with the kernel subset principle
introduced in section     since model learning is not precise without the presence
of certain key states in the input data 

experiment  hence we can say that these results are in keeping with the qualitative
experiments 
u tube   coupled tanks the complete envisonments for these systems contain   and   
states respectively  table   shows that the number of true states generated is less than
the complete envisionment  and significantly less than the number of noisy states in
each case  as one would expect from the results presented in fig    the u tube gives
better results than the coupled tanks  having a higher proportion of the envisionment
states present   ultimately  the ability to learn the model is completely curtailed
by the noise  though sooner in the case of the coupled tanks  which the qualitative
experiments show to be more sensitive to the presence of noise   this is consistent
with the results of the qualitative experiments 
the cascaded tanks in the qualitative learning experiments all the kernel subset triples
had state   included  this is the state representing the situation where both tanks
are empty to begin with  and is not one of the initial states included in the numerical
   

ficoghill  srinivasan    king

simulations  also  a perusal of fig     reveals that the introduction of noise radically
reduces the learning precision  and for   states  the average number of true states
generated by the qualitative to quantitative conversion process  it is zero  taking
account of all these facts it was to be expected that the cascaded tanks model would
not be successfully identified by these experiments  this is again consistent with the
findings of the qualitative experiments 

   application to biological system identification
the work reported thus far has been aimed at demonstrating the viability of ilp qsi and of
identifying the bounds of operation of the approach  in this section we examine scalability
of the method to identify a complex real world biological network  we use the glycolysis
pathway as a test case for identification 
    the test system  glycolysis
we chose to study the metabolic pathway of glycolysis as a test case  glycolysis is one of
the most important and ubiquitous in biology  it was also historically one of the first to be
discovered  and still presents a challenge to model accurately 
the qsim primitives are sufficient to model adequately the qualitative behaviour of
the glycolysis pathway  there are  however  two problems  first  few biologists would
understand such a model  as he or she would reason at a much higher level of abstraction  second  the computational complexity of the corresponding system identification task
for glycolsis  a qualitative model with     or more qsim relations  is  at least currently 
intractable  we address both these by modelling metabolic pathways in a more abstract
manner using biologically meaningful metabolic components  mc   a similar approach to
constructing complex qualitative models of the human heart was used in bratko  mozetic 
  lavrac         specifically  we note that in metabolic pathways  there are essentially two
types of object  metabolites  small molecules  and enzymes  larger molecules that catalyze
reactions   we use component models of each of these objects as described below  king 
garrett    coghill        
      modelling metabolites and enzymes
the concentrations of metabolites vary over time as they are synthesised or utilised by
enzymatically catalysed reactions  as a result their concentration at any given time point
is a function of   a  their concentration at the previous time point  and  b  the degree to
which they are used or created by various enzyme reactions 
when modelling enzymes  each enzyme is assumed to have at most two substrates and
at most two products  if there are two substrates or products these are considered to form
a substrate or product complex  such that the amount of the complex is proportional to
the amount of the substrates or products multiplied together  this models the probability
that both substrates  or products  will collide with the enzyme with sufficient timeliness to
be catalysed into the product complex  or substrate complex   the substrate complex is
converted into the product complex  which then disassociates into the product metabolites 
and vice versa  we shall use the phrase flow through the enzyme to denote the amount
   

fiqualitative system identification

of substrate complex formed minus the amount of product complex formed   see the work
of voit and radivoyevitch        for details of enzyme kinetics  

metabolite

metabolites 

metabolites 
e nzm

metab

 
s for
w

dt
mtb

m dt

m 

 

m 

p rev

sum

 

flowflow 

 
flow   flown

metabolitep 

metabolitep 

figure     the metabolic components  mcs  used in the biological experiments  with the
underlying qsim primitives 
quantitative  and corresponding qualitative representations of the metabolite and enzymes using qsim relations  are therefore 
enzymes 

metabolites 
n

x
dm
 
f lowi
dt
i  
deriv m etabolite mdt  
sum f low           f lown  
md t  

   

f lowi   f  

s
y

s  

m etabolites   g 

p
y

m etabolitep 

   

p  

prod m etabolite          m etabolites  s for  
prod m etabolite          m etabolitep  p rev  
m  s for  ds  
m  p rev  dp  
sub ds  dp  f low  
minus f low f lowminus  

here  s refers to the input metabolites to an enzymatic reaction  or its substrates  and p
refers to the products of an enzymatic reaction  the sum   and prod   predicates are simply
extensions of the add   and mult   predicates  over any number of inputs  fig     shows
how these constraints are grouped together as metabolic components  mcs   this permits
us to create more general constraints representing the metabolite and enzyme components
as follows 
enzyme  s    s     p    p    enzymef low 
metabolite metaboliteconc metabolitef low  enzymef low         enzymef lown   
   

ficoghill  srinivasan    king

  
  
  
  
  
  
  
  
  
   

 hexokinase  
 phosphoglucose isomerase  
 phosphofructokinase  
 aldolase  
 triose phosphate isomerase  
 glyceraldehyde   phosphate dehydrogenase  
 phosphoglycerate kinase  
 phosphoglycerate mutase  
 enolase  
 pyruvate kinase  

glc   atp  g p   adp 
g p  f p 
f p   atp  f  bp   adp
f  bp  dhap   g p
dhap  g p
g p   nad    bp   nadh 
  bp   adp   pg   atp 
 pg   pg 
 pg  pep
pep   adp  pyr   atp 

figure     the reactions included in our qualitative model of glycolysis  the reactions that
consume atp and nadh are not explicitly included 

here the enzyme predicate identifies the substrates and products  the first argument  and
returns a single variable representing the flow through the enzyme  the second argument  
the metabolite predicate relates the level and flow of metabolites  the first and second
arguments  with the flow through enzymes  the third argument  
      modelling glycolysis
using qualitative components representing metabolites and enzymes  we construct a qualitative model of glycolysis  our model uses    metabolites  namely  pyruvate  pyr   glucose  glc   phosphoenolpyruvate  pep   fructose   phosphate  f p   glucose   phosphate
 g p   dihydroxyacetone phosphate  dhap     phosphoglycerate   pg       bisphosphoglycerate
   bp   fructose     biphosphate  f  bp     phosphoglycerate   pg   glyceraldehyde  phosphate  g p   adp  atp  nad  and nadh  we have not included h   h   o  or orthophosphate as they are assumed to be ubiquitous  in addition  the restriction of substrates
and products to being at most three in number prevents their inclusion  
the qualitative state of glycolysis is defined by the set of qualitative states of the   
metabolites  table   is a representation of one such qualitative state  to understand this
state consider the first entry intended to represent the qualitative state of nad  that is 
nad concentration          dec    and nad flow           dec     the meaning
of this is that the concentration of nad is positive       and decreasing  dec   and the
rate of change of the concentration of nad  in analogy to the physical systems  the flow
of nad  is negative       and decreasing  dec   similar meanings apply to the other
metabolites  note that metabolic concentrations must be between   and   it cannot be
negative  and the   state is uninteresting 

using this representation  a possible model for glycolysis is shown in fig      the model describes constraints on the levels and flows of metabolites  thus  the constraint enzyme  g pc 
nadc      bpc  nadhc   enz f  states that the flow through enzyme    enz f  controls the transformation of the concentrations g pc and nadc into the levels   bpc and
nadhc  whereas the constraint metabolite nadc  nadc   enz f      states that the
   

fiqualitative system identification

metabolite
nad
nadh
atp
adp
pyr
glc
pep
f p
g p
dhap
 pg
  bp
f  pb
 pg
g p

concentration
         dec  
         inc  
         dec  
         dec  
         inc  
         dec  
         dec  
         dec  
         dec  
         dec  
         inc  
         std  
         inc  
         dec  
         inc  

flow
         dec  
         inc  
         dec  
         dec  
         dec  
         inc  
         dec  
         dec  
         dec  
         dec  
         std  
     inc  
         dec  
         dec  
         inc  

table    a legal qualitative state of the    metabolites observed during glycolysis 
enzyme  glcc  atpc   g pc adpc  enz f  
enzyme  g pc   f pc  enz f  
enzyme  f pc atpc   f  bpc adpc  enz f  
enzyme  f  bpc   g pc dhapc  enz f  
enzyme  dhapc   g pc  enz f  
enzyme  g pc nadc     bpc nadhc  enz f  
enzyme    bpc adpc    pgc atpc  enz f  
enzyme   pgc    pgc  enz f  
enzyme   pgc   pepc  enz f  
enzyme  pepc adpc   pyrc atpc  enz  f  
metabolite atpc atpf   enz  f      enz f      enz f      enz f      
metabolite adpc adpf  enz f      enz f      enz  f     enz f      
metabolite nadc nadf  enz f      
metabolite nadhc nadhf  enz f      
metabolite pyrc pyrf  enz  f      
metabolite glcc glcf  enz f      
metabolite pepc pepf  enz f      enz  f      
metabolite f pc f pf  enz f      enz f      
metabolite g pc g pf  enz f      enz f      
metabolite dhapc dhapf  enz f      enz f      
metabolite  pgc  pgf  enz f      enz f      
metabolite   bpc   bpf  enz f      enz f      
metabolite f  bpc f  bpf  enz f       enz f      
metabolite  pgc  pgf  enz f      enz f      
metabolite g pc g pf  enz f      enz f      enz f      

figure     a representation of a qualitative model of glycolysis  see text for details  

concentration  nadc  and flow  nadf  of the metabolite nad is controlled by flow through
the single enzyme number    enz f   glyceraldehyde   phosphate dehydrogenase   and that
this enzyme removes  signified by the    nad    would mean the enzyme flow adds the
corresponding metabolite  
   

ficoghill  srinivasan    king

    experimental aim
the specific system identification task we were interested in is  given qualitative observations of metabolic states  can ilp qsi identify a correct qualitative model for glycolysis 
    materials and method
our methodology is depicted in fig      where we describe two separate ways of identifying
biochemical pathways  we make the following assumptions 
   the data are sparse and not necessarily measured as part of a continuous time series 
this is realistic given current experimental limitations in metabolomics  and rules out
the possibility of numerical system identification approaches 
   only metabolites of known structure are involved in the model  the reason for this
is that we employ a chemoinformatic heuristic to decrease the number of possible
reactions  the heuristic is based on the reasonable assumption that any chemical
reaction catalysed by an enzyme only breaks a few chemical bonds  full details are in
the paper by king et al          this is the strongest assumption we make  even given
the rapid advance of metabolomics  nmr  mass spectroscopy  etc    it is not currently
realistic to assume that all the relevant metabolites in a pathway are observed and
their structure determined 
   only metabolites of known structure are involved in a particular pathway  this is
a restriction because current metabolomics technology can observe more compounds
than can be structurally identified 
   all reactions involve at most three substrates and three products 
   for the qualitative states  we can measure the direction of change in metabolite level
and first derivative  this requires sampling the level at least three times in succession 
      logical graph based constraints
we first considered the logical graph based  lg  nature of the problem  the specific domain of metabolism imposes strong constraints on possible lg based models  we used
these constraints in the following way 
   chemical reactions conserve matter and atom type  valdes perez         for glycolysis we generated all possible ways of combining the    metabolites to form matter and
atom type balance reactions     reactants and    products   this produced    
possible reactions where the substrates balanced the products in the number and type
of each element  the number compares well with the           possible reactions
which would naively be possible 
   typical biochemical reactions only make break a few bonds  and cannot arbitrarily
rearrange atoms to make new compounds  a reaction was considered plausible if it
broke   bond per reactant  this analysis was done originally by hand  and we have
subsequently developed a general computer program that can automate this task 
   

fiqualitative system identification

lg modelling

all possible
combinations of
metabolites
conservation of mass
and element type 

qr modelling

bonds broken

typical
biochemistry

qr system
identification

qr

 

glycolysis

glycolysis

figure     our metabolic system identification methodology 
of the     balanced reactions    were considered chemically plausible  of these   
reactions     are the actual reactions of glycolysis and   are decoy reactions 
      qualitative reasoning constraints
we used a simple generate and test approach to learning  for the first computational
experiment we used the    reactions of glycolysis and the   decoy reactions that were
considered chemically feasible  see fig      all these reactions  in the absence of evidence
to the contrary  are considered to be irreversible  we first generated all possible ways of
combining the    reactions which connected all the    main substrates in glycolysis  models
are non disjoint   this generated        possible models with     reactions   it was not
necessary to look for models with more reactions than that of the target  parsimony   as
the models can be generated in size order  the smallest number of reactions necessary to
include all    metabolites was of size    all of the        models involved the reaction 
glyceraldehyde   phosphate   nad      bisphosphoglycerate   nadh  reaction     so
we could immediately conclude that this reaction occurred in glycolysis 
   

ficoghill  srinivasan    king

we formed example qualitative states of glycolysis using our qr simulator  in a pseudo
random manner  to test these models  the states thus generated did not contain any noise 
the        possible models were then tested against these states  and if a model could
not generate a particular state it was removed from consideration  accuracy constraint  
note that the flows of the metabolites through each enzyme are not observed   they are
intermediate variables  all we observe are the overall levels and flows of the metabolites 
this makes the system identification task much harder 
for efficiency  we used the fast yap prolog compiler  we also formed compiled down
versions of the enzyme and metabolite mcs  input output look up tables   and compiled
down parts of qsim  we also adopted a resource allocation method that employed increasingly computationally expensive tests  i e  forming filter tests with exponentially increasing
numbers of example states 
      results
after several months of compute time on a    node beowulf cluster we reduced the       
possible models down to     a     fold reduction   these models included the target model
 glycolysis   plus    other models that could not be qualitatively distinguished from it  all
   models included the following six reactions  see fig      
   f p   atp  f  bp   adp
   f  bp  dhap   g p
   dhap  g p
   g p   nad    bp   nadh
    pg   pg
    pg  pep
these reactions form the core of glycolysis 
examining the    models also revealed that the correct model had the fewest cycles 
however we do not know if this is a general phenomenon 
we attempted to use the progol positive only compression measure to distinguish between these models  this is based on comparing the models on randomly generated states 
however  this was unsuccessful as no model covered any of the         random states we
generated  we believe this is due to the extremely large state space  however  a simple
modification of this approach does work  if we produce random states from glucogenesis
 glycolysis driven in the reverse direction   then the true model of glycolysis covers fewer
examples than any of the    alternatives  and so is identified as the true model  note that
this approach  unlike the use of progol positive only compression measure  requires that
new experimental data is obtained 
thus we have demonstrated that the method for learning qualitative models of dynamic
systems is scalable to handle a relatively large metabolic system  we have achieved this by
means of mcs that represent meaningful units in the domain  and which map directly to
the qsim constraints from which they are abstracted  they also enable us to present these
more complex models in a more user friendly manner  removing the need to understand
the structure of high order differential equations 
   

fiqualitative system identification

   related work
system identification has a long history within machine learning  we present below some
of the important signposts that were directly relevent to the work here  we focus on the
strand of research which deals with learning qualitative models of dynamic systems 
the earliest description of which we are aware concerning a computer program identifying a quantitative model to explain experimental data is the work by collins         there
a procedure is described that heuristically searches through equation structures  which are
linear combination of functions of the observed variables  better known is the bacon
system  langley         early versions of which largely concentrated on the parameter estimation problem  in particular selecting the most appropriate values for any exponents in
the equations  for example  given a class of algebraic equation structures bacon   was able
to reconstruct keplers model for planetary motion from data  while later work  for example the work of nordhausen   langley        attempted to extend this work to deal with
identifying both the algebraic structure and the relevant parameters  bacon highlighted
the importance of bias  mitchell  keller    kedar cabelli        in machine learning  both
in constraining the possible model structures and in the space of possible models conforming to those structures  other quantitative equation discovery systems in this lineage are 
coper  kokar         that uses dimensional analysis to restrict the space of equations 
fahrenheit ef  langley   zytkow        and e  that only examine the space of bivariate equations  abacus  falkenhainer   michalski        that can identify piecewise
equations  sds that uses type and dimensionality restrictions to constrain the space of
equations  the lagrange family of equation finders  dzeroski   todorovski        todorovski   dzeroski        todorovski et al         todorovski        which attempt to identify
models in the form of ordinary and partial differential equations  and ipm  langley  george 
bay    saito        with its extensions and developments  prometheus rpm  bridewell 
sandy    langley        asgharbeygi  bay  langley    arrigo         which incorporate
process descriptions  forbus        to aid the construction and revision of quantitative
dynamic models 
focussing specifically on non classical system identification for metabolic models  perhaps the most notable work on identification is that of arkin  shen  and ross        who
identified a graphical model of the reactions in a part of glycolysis from experimental data 
the work of reiser  king  kell  muggleton  bryant  and oliver        presents a unified
logical approach to simulation  deduction  and system identification  induction and abduction   an interesting recent approach  presented by koza  mydlowec  lanza  yu  and keane
        examines the identification of metabolic ode models using genetic programming
techniques  in this  the cellular system is viewed as an electrical circuit and the space of
possible circuits is searched by means of a genetic programming approach 
the earliest reported work on the identification of qualitative models is that of mozetic 
      and colleagues  who identified a model of the electrical activity of the heart  this work 
reported more fully in  bratko et al         remains a landmark effort in the qualitative
modelling of a complex biological system  however  as other researchers have noted  bratko 
muggleton    varsek         these results were obtained only for static models and did not
provide insight into how models of dynamic systems should be identified 
   

ficoghill  srinivasan    king

the first machine learning system for learning qualitative models of dynamic systems
was genmodel  coiera      a      b   genmodel did not need any negative examples of
system behaviour and models learned were restricted to qualitative relationships amongst
the observed variables only  that is  no intermediate  or hidden  variables were hypothesized   the model  obtained using the notion of a most specific generalization of observed
variables  in the sense of plotkin         was usually over constrained  that is  it contained
more constraints than necessary to characterize fully the dynamics of the system being
modeled  an updated version of genmodel developed by hau and coiera        showed
that dimensional analysis  bhaskhar   nigam        could be used as a form of directed
negative example generation  the new version could learn from from real valued experimental data  which were converted internally into a qualitative form   but still required all
variables to be known and measured from the outset  the system misq  entirely similar
in complexity and abilities to the earlier version of genmodel was developed by kraan 
richards  and kuipers         this was later re implemented in a general purpose relational learning program forte  richards   mooney         which allowed the hypothesis
of intermediate variables  richards  kraan    kuipers         the relational pathfinding
approach used by misq  through the auspices of forte  is a special form of inductive logic
programming  the general framework of which is much more powerful
bratko and colleagues were the first to view the problem of learning dynamic qualitative
models explicitly as an exercise in inductive logic programming  ilp  and first demonstrated the possibility of introducing intermediate  unobserved  variables in the models 
they used the ilp system golem  muggleton   feng        along with the qsim representation to produce a model of the u tube system  the model identified was equivalent to
the accepted model  in the sense that it predicted the same behaviour  but the structure
generated was not in a form that could help explain the behaviour  coghill   shen        
like genmodel  the model produced was over constrained  unlike genmodel  golem
required both positive and negative examples of system behaviour and was shown by hau
and coiera        to be sensitive to the actual negative examples used 
say and kuru        describe a program for system identification from qualitative data
called qsi  qsi first finds correlations between variables  and then iteratively introduces
new relations  and intermediate variables   building a model and comparing the output
of that model with the known states until a satisfactory model is found  say and kuru
characterized this approach as one of diminishing oscillation as it approaches the correct
model  like genmodel and misq  qsi does not require negative observations of system
behaviour  unlike those systems  it does not use dimensional analysis and there does not
appear to be any mechanism of incorportating such constraints easily within the program 
the importance of dimensional analysis is recognised though  the authors suggest that it
should be central to the search procedure 
thus  while the identification of quantitative models has had a longer history in machine
learning  learning qualitative models has also been the subject of notable research efforts 
in our view  misq  the version as implemented within forte  and qsi probably represent
the state of the art in this area  their primary shortcomings are these 
   

fiqualitative system identification

 it is not apparent from the description or experimental evaluation of misq whether
or not it is able to handle imperfect data  the correctness theorem presented only
applies for complete  noise free data  
 misq seeks the most constrained model that is consistent with the data  often 
exactly the opposite is sought  that is  we want the most parsiomonius model  
 qsi only deals with qualitative data and does not appear to include any easy mechanism for the incorporation of new constraints to guide its search 

   general discussion
in this paper we have presented a method for learning qualitative models of dynamic systems
from time series data  both qualitative and quantitative   in this section we discuss the
general findings and limitations  as well as suggesting a number of directions for developing
this research theme 
    computational limitations
a major limitation of the ilp qsi system in identifying glycolysis was the time taken
 several months on a beowulf cluster  to reduce the models from the        possible ones
generated using chemoinformatic constraints  to the single correct one using the qualitative
state constraints  while it would be preferable for this process to be faster  it is important
to note that identifying a system with    reactions and    metabolites from scratch is an
extremely hard identification task  we doubt that any human could achieve it  and we
believe it would be a challenge for all the system identification methods we are aware of 
it is difficult to compare system identification methods and we believe there is a need for
competitions such as those run by kdd to compare methods 
the computational time of identification is dominated by the time taken to test if a
particular model can produce certain observed states  examining        models is not
unusual for a machine learning program  but it is unusual for a program to take hours
to test if individual examples are covered  the slow speed of our identification method is
therefore not a problem with what is normally considered the learning method  i e  how
the search of the space of possible models is done   but rather  is intrinsic to the complex
relationship between a model and the states it defines  the cover test method is  in the worst
case  exponential in the maximum size of the model  note that our lack of an efficient  i e 
polynomial algorithm  to determine cover is not because we are using qualitative states  we
believe that the inherent difficulty of this task applies to both quantitative and qualitative
models  in some areas of mathematics moving from the discrete to the real domain can
simplify problems   this is the basis of much of the power of analysis  however  there
is currently little evidence that this is the case in system identification  and quantitative
models would seem to aggravate the problem  as cover tests are essentially deductions  can
a set of axioms and rules  computer program model  produce a particular logical sentence
 observed state   they are in general non computable  however  in real scientific systems 
as they are bounded in space and time  non computability is not a problem  however we
expect all system identification methods to struggle with the task  sadot  fisher  barak 
admanit  stern  hubbard    harel        
   

ficoghill  srinivasan    king

    kernel subsets
from our presentation of the results of the experimentation it is clear that certain subsets
of states  termed the kernel subsets  guarantee that the target model will be learned  from
the analysis of these kernel subsets of state sets  we hypothesise that the kernel sets reflect
the qualitative structure of the system of interest 
for a coupled system  in order to learn the structure of a system with a high degree of
precision  the data used should come from tests yielding qualitatively different behaviors 
i e  behaviors which would appear as distinct branches in an envisionment graph  however 
this hypothesis only provides a necessary  not a sufficient  condition for learning because it
does not identify which states in each branch are suitable starting points for an experiment 
for example consider the coupled tanks system  one could select states   and     these are
from different branches yet they do not form a kernel subset  on the other hand  it was
noted in presenting the results for this system that the key states in these kernel subsets
were states   and    these states are in different branches and represent the critical points
of the first derivative of the state variables of the system  this indicates the importance of
these states to the definition of a system 
if a test were set up in which all the state variables were at their critical points then the
test could be run for a very short time and the correct model structure identified  however 
it is probably impossible in practice to set up such a test  especially in the situation where
the structure of the system is completely unknown  an alternative is to set up multiple tests
with the state variables set to their extrema  from which initial conditions all the states
of the envisionment will eventually be passed through  however it still may be difficult to
set up such tests  and they could take a long time to complete  these two scenarios form
the ends of a spectrum within which the most practical experimental setting will lie  the
identification of the best strategies is an important area of research to which the present
work is clearly relevant 
on the other hand  for cascaded systems the kernel sets capture the asymmetry in the
structure  here again the extrema and critical points play an important role  but in this
case it is subordinate to the fact that ilp qsi automatically decomposes the system into
its constituent parts for learning  this fact points to an important conclusion for learning
larger scale complex systems  namely that the learning can be facilitated by  where possible 
decomposing the system into cascaded subsystems 
    future work
having validated ilp qsi on data derived from real biological systems  the next step is to
explore how successful it can be at modelling real experimental data  it would be relatively
straightforward to obtain data from water tanks and springs  but it would be much more
interesting to work on real biological data  for such work to be successful it is likely that
the quantitative to qualitative conversion process will need to be improved  although not
the focus of the work here  developing a more rigorous approach would be crucial in using
ilp qsi in a laboratory setting  narasimhan  mosterman    biswas         once this has
been done it will be much easier to use real experimental data for analysis by ilp qsi 
specifically  the improvements required are the ability to extract all the qualitative states
   

fiqualitative system identification

passed through during a numerical simulation  whilst minimizing noise  nevertheless  this
is not a direct limitation of our ilp qsi method 
the following possibilities would benefit from further investigation 
 the qr representation used could be changed from qsim to a more detailed and
flexible one such as morven  coghill   chantler        coghill        
 the hypotheses presented about kernel subsets  such as why they are formed from
some states and not others  need to be confirmed and analyzed further 
 the ability to map and explore the features of the model space would be of great
use in planning further enhancements and  alongside kernel subsets  will help give an
understanding of exactly which states will allow reliable learning 
 large scale complex systems are generally identified piece by piece  the results from
the cascaded tanks experiments indicate some circumstances under which this may
be most easily facilitatied  further investigation of this is warranted 
 as an alternative to the methods described in this paper  an incremental approach that
identifies subsystems of the complete system is an interesting avenue of investigation
 srinivasan   king        

   summary and conclusions
in this paper we have presented a novel system  named ilp qsi  which learns qualitative
models of dynamic processes  this system stands squarely in a strand of research that
integrates machine learning with qualitative reasoning and extends the work in that area
in the following ways 
the ilp qsi algorithm itself extends the work  it is a branch and bound algorithm that
makes use of background knowledge of  at least  three kinds in order to focus and guide
the search for well posed models of dynamic processes 
syntactic constraints  the model size is prespecified  models must be complete and
determinate  and must not proliferate instances of qualitative relations 
semantic constraints  the model must adequately explain the data  it must not contain
relations that are redundant or contradictory  and the relations in the model must
respect dimensional constraints 
system theoretic constraints  the model should be singular and not disjoint  all endogenous variables must appear in at least two relations  and the model should be
causally ordered 
we have thoroughly tested the system on a number of well known dynamic processes 
this has enabled us to ascertain that ilp qsi is capable of learning under a variety of
conditions of noisy and noise free data  this testing has also allowed us to identify some
conditions under which it is possible to learn an appropriate model of a dynamic system 
the conclusions from this aspect of the work are 
   

ficoghill  srinivasan    king

 learning precision is related to the richness  or sparcity  and noisiness of the data
from which the learning is performed 
 the target model is precisely learnt if the data used is a kernel subset 
 these kernels are made up of states from different branches in the envisionment graph 
 the system critical points play an important role in identifying the model structure 
 there is a spectrum of possibilities with regard to the setting up of suitable experiments to garner data from which to learn models of the physical or biological systems
of interest 
 cascaded parts of systems help to identify suitable points of decomposition for model
learning 
while ilp qsi is designed to learn a qualitative structural model from qualitative data 
it is sometimes the case that the original measurements are quantitative  albeit sparse and
possibly noisy   in order to ascertain how ilp qsi would cope with qualitative data generated from quantitative measurements we carried out a proof of concept set of experiments
from each of the physical process models previously utilised  the results from these were
in keeping with the results obtained from the qualitative experiments  this adds weight
to the conclusions regarding the viability of our approach to learning structural models of
dynamic systems under adverse conditions 
finally  in order to test the scalability of the method  we applied ilp qsi to a large
scale metabolic pathway  glycolysis  in this case the search space was deemed too large to
attempt learning the qsim primitives alone  however  knowledge of the domain enabled us
to group these primitives into a set of metabolic components from which models of metabolic
pathways can more easily be constructed  also  for this part of the research logical graph
based models were used to represent background domain knowledge  utilising these  we
were able to identify    possible structures for the glycolysis pathway  out of a possible
         of these the target model had the fewest cycles  though we do not know if this is a
general phenomenon  and minimally covered the data generated from the reverse pathway
of glucogenesis 
the overall conclusions of the this work are that qualitative reasoning methods combined
with machine learning  specifically ilp  can successfully learn qualitative structural models
of systems of high complexity under a number of adverse circumstances  however  the work
reported herein constitutes a step in a line of research that has only recently begun  and 
as with all interesting lines of research  it raises in its turn interesting questions that need
to be addressed 
acknowledgments
this work was supported in part by bbsrc epsrc grant bio       the authors would
like to thank stephen oliver and douglas kell for their helpful discussions on the biological
aspects of this paper  we would also like to thank simon garrett for many interesting and
fruitful interactions 
   

fiqualitative system identification

appendix a  the derivation of the solution space for the tanks systems
in this appendix we provide a summary of whence the solution spaces for the tanks systems
utilised in this project are constructed  further details regarding envisionments and their
associated solution spaces may be found in the work of coghill et al         and coghill
       
in order to facilitate this analysis we will need to make use of a quantitative version of
the system models  for ease of exposition we will make the additional assumption that the
systems are linear   
a   the u tube
a quantitative model of the u tube system is
dh 
  k h   h   
dt
dh 
  k h   h   
dt
by inspection of these two equations it is easy to see that  ignoring the trivial case where
k      the derivatives in these two equations are both zero when 
h    h  

   

that is 
dh 
dh 
 
  
dt
dt
this accounts for the relationship  depicted in fig      between h   and h  when the
derivatives are zero  from the envisionment table for the u tube  table   in section      we
see that the only state with zero derivatives is state    hence it is represented by this line 
h    h   

a   the coupled tanks
a quantitative model of the coupled tanks system is
dh 
  qi  k   h   h   
dt
dh 
  k   h   h     k   h 
dt
when

dh 
dt

   
   

    equation   can be rewritten as 
    qi  k   h   h   
  q i  k   h   k   h 

    in fact for the types of non linearity normally associated with systems of this kind the solution spaces
are qualitatively identical to those described here  although the analysis required to construct them is
slightly more complicated 

   

ficoghill  srinivasan    king

which can be re arranged to give
h   

qi
 h 
k 

when qi is zero this reduces to
h    h  
when

dh 
dt

   

    equation   can be rewritten as 
    k   h   h     k  h 
  k   h   k   h   k   h 
   k   k   h   k  h 

so
 k   k   h    k  h 
re arranging gives
h   

k 
h 
 k   k   

    

this accounts for the relations between h   and h  depicted in the solution space of fig 
   
a   the cascaded tanks
a quantitative model of the cascaded tanks system is 

when

dh 
dt

dh 
  q i  k   h 
dt

    

dh 
  k   h   k   h 
dt

    

    equation    can be re arranged as 
qi   k   h 

or
h   
when

dh 
dt

qi
k 

    equation    can be rewritten as 
k  h    k   h 

or
   

fiqualitative system identification

h   

k 
h 
k 

this accounts for the relations between h   and h  depicted in the solution space of fig 
   

h 

h      

 

 

  

 

h      

 
  

 
 
 

  

h 

 

 

  

 

figure     the solution space for the cascaded tanks system 

references
arkin  a   shen  p     ross  j          a test case of correlation metric construction of a
reaction pathway from measurements  science                
asgharbeygi  n   bay  s   langley  p     arrigo  k          inductive revision of quantitative
process models  ecological modelling            
bergadano  f     gunetti  d          inductive logic programming  from machine learning
to software engineering  mit press 
bhaskhar  r     nigam  a          qualitative physics using dimensional analysis  artificial
intelligence            
blackman  r  b     tukey  j  w          the measurement of power spectra  john wiley
and sons  new york 
bradley  e   easley  m     stolle  r          reasoning about nonlinear system identification  tech  rep  cu cs         university of colorado 
bratko  i   mozetic  i     lavrac  n          kardio  a study in deep and qualitative
knowledge for expert systems  mit press  cambridge  massachusetts 
   

ficoghill  srinivasan    king

bratko  i   muggleton  s     varsek  a          learning qualitative models of dynamic
systems  in muggleton  s   ed    inductive logic programming  pp          academic
press 
bridewell  w   sandy  j     langley  p          an interactive environment for the modeling
and discovery of scientific knowledge   tech  rep   institute for the study of learning
and expertise  palo alto  ca 
camacho  r          inducing models of human control skills using machine learning
algorithms  ph d  thesis  university of porto 
coghill  g  m          mycroft  a framework for constraint based fuzzy qualitative reasoning  ph d  thesis  heriot watt university 
coghill  g  m          fuzzy envisionment  in proc  of the third international workshop
on hybrid methods for adaptive systems  oulu  finland 
coghill  g  m   asbury  a  j   van rijsbergen  c  j     gray  w  m          the application of vector envisionment to compartmental systems   in proceedings of the first
international conference on intelligent systems engineering  pp          edinburgh 
scotland 
coghill  g  m     chantler  m  j          mycroft  a framework for qualitative reasoning  in proceedings of the second international conference on intelligent systems
engineering  pp        hamburg  germany 
coghill  g  m   garret  s  m     king  r  d          learning qualitative models of
metabolic systems  in proceedings of the european conference on artificial intelligence ecai     valencia  spain 
coghill  g  m     shen  q          on the specification of multiple models for diagnosis of
dynamic systems  ai communications                
coiera  e  w       a   generating qualitative models from example behaviours  tech  rep 
      university of new south wales  deptartment of computer science 
coiera  e  w       b   learning qualitative models from example behaviours  in proc 
third workshop on qualitative physics  stanford 
collins  j          a regression analysis program incorporating heuristic term selection  in
dale  e     michie  d   eds    machine intelligence    oliver and boyd 
dzeroski  s          learning qualitative models with inductive logic programming  informatica               
dzeroski  s     todorovski  l          discovering dynamics  in international conference
on machine learning  pp        
dzeroski  s     todorovski  l          discovering dynamics  from inductive logic programming to machine discovery  j  intell  information syst            
falkenhainer  b     michalski  r  s          integrating quantitative and qualitative discovery  the abacus system  machine learning                
forbus  k  d          qualitative process theory  artificial intelligence             
   

fiqualitative system identification

garrett  s  m   coghill  g  m   srinivasan  a     king  r  d          learning qualitative
models of physical and biological systems  in dzeroski  s     todorovski  l   eds   
computational discovery of communicable knowledge  pp          springer 
gawthrop  p  j     smith  l  p  s          metamodelling  bond graphs and dynamic
systems  prentice hall  hemel hempstead  herts  england 
hau  d  t     coiera  e  w          learning qualitative models of dynamic systems 
machine learning             
healey  m          principles of automatic control  hodder and stoughton 
iwasaki  y     simon  h  a          causality in device behavior  artificial intelligence 
         see also de kleer and browns rebuttal and iwasaki and simons reply to
their rebuttal in the same volume of this journal 
king  r  d   garrett  s  m     coghill  g  m          on the use of qualitative reasoning
to simulate and identify metabolic pathways   bioinformatics                     
kokar  m  m          coper  a methodology for learning invariant functional descriptions 
in mitchell  t   carbonell  j     michalski  r   eds    machine learning  a guide to
current research  pp          kluwer academic press 
koza  j  r   mydlowec  w   lanza  g   yu  j     keane  m  a          reverse engineering
and automatic synthesis of metabolic pathways from observed data using genetic
programming   tech  rep  smi            stanford university 
kraan  i  c   richards  b  l     kuipers  b  j          automatic abduction of qualitative
models  in proceedings of qualitative reasoning       qr    
kuipers  b          qualitative reasoning  mit press 
langley  p          data driven discovery of physical laws  cognitive science          
langley  p   george  d   bay  s     saito  k          robust induction of process models from
time series data   in proc  twentieth international conference on machine learning 
pp          washington  dc  aaai press 
langley  p     zytkow  j          data driven approaches to empirical discovery  artificial
intelligence             
mccreath  e          induction in first order logic from noisy training examples and fixed
example set sizes  ph d  thesis  university of new south wales 
mitchell  t  m   keller  r  m     kedar cabelli  s          explanation based generalization  a unifying view  machine learning          
mozetic  i          learning of qualitative models  in bratko  i     lavrac  n   eds   
progress in machine learning  proceedings of ewsl      nd european working session on learning  pp          sigma press 
muggleton  s          inverse entailment and progol  new gen  comput              
muggleton  s          learning from positive data  lecture notes in ai               
muggleton  s     feng  c          efficient induction of logic programs  in proc  of the
first conf  on algorithmic learning theory  ohmsha  tokyo 
   

ficoghill  srinivasan    king

muggleton  s     raedt  l  d          inductive logic programming  theory and methods 
journal of logic programming                
narasimhan  s   mosterman  p     biswas  g          a systematic analysis of measurement selection algorithms for fault isolation in dynamic systems  in proc  ninth intl 
workshop on principles of diagnosis  dx      pp         cape cod  ma 
nordhausen  b     langley  p          an integrated framework for empirical discovery 
machine learning           
papadimitriou  c     steiglitz  k          combinatorial optimisation  prentice hall 
edgewood cliffs  nj 
plotkin  g          automatic methods of inductive inference  ph d  thesis  edinburgh
university 
reiser  p   king  r   kell  d   muggleton  s   bryant  c     oliver  s          developing a
logical model of yeast metabolism  electronic transactions on artificial intelligence 
          
richards  b  l   kraan  i     kuipers  b  j          automatic abduction of qualitative
models  in proc  of the tenth national conference on artificial intelligence  aaai     pp          mit press 
richards  b  l     mooney  r  j          automated refinement of first order horn clause
domain theories  machine learning                
riguzzi  f          two results regarding refinement operators  in kramer  s     pfahringer 
b   eds    late breaking papers    th international workshop on inductive logic
programming  ilp     august             pp        munich  germany 
sadot  a   fisher  j   barak  d   admanit  y   stern  m  j   hubbard  e  j  a     harel  d 
        towards verified biological models   ieee acm trans  comput  biology and
bioinformatics             
say  a  c  c     kuru  s          qualitative system identification  deriving structure from
behavior  artificial intelligence            
shoup  t  e          a practical guide to computer methods for engineers  prentice hall
inc   englewood cliffs  n  j        
soderstrom  t     stoica  p          system identification  prentice hall 
srinivasan  a          the aleph manual  available at http   www comlab ox ac uk oucl 
research areas machlearn aleph  
srinivasan  a     king  r  d          incremental identification of qualitative models of
biological systems using inductive logic programming  j  machine learning research
to appear 
todorovski  l          using domain knowledge for automated modeling of dynamic systems
with equation discovery  ph d  thesis  faculty of electrical engineering and computer
science  university of ljubljana  slovenia 
todorovski  l   srinivasan  a   whiteley  j     gavaghan  d          discovering the structure of partial differential equations from example behavior  in proceedings of the
   

fiqualitative system identification

seventeenth international conference on machine learning  pp          san francisco 
todorovski  l     dzeroski  s          declarative bias in equation discovery  in proc    th
international conference on machine learning  pp          morgan kaufmann 
valdes perez  r  e          heuristics for systematic elucidation of reaction pathways   j 
chem  informat  comput  sci              
voit  e  o     radivoyevitch  t          biochemical systems analysis of genome wide
expression data  bioinformatics                    
warren  p   coghill  g  m     johnstone  a          top down and botton up development
of a fuzzy rule based diagnostic system  in proc  of the fourth international workshop
on hybrid methods for adaptive systems  aachen  germany 

   

fi