journal of artificial intelligence research                 

submitted        published      

a probabilistic framework for learning kinematic models
of articulated objects
jurgen sturm
cyrill stachniss
wolfram burgard

sturm informatik uni freiburg de
stachnis informatik uni freiburg de
burgard informatik uni freiburg de

department of computer science 
university of freiburg 
georges koehler allee           freiburg  germany

abstract
robots operating in domestic environments generally need to interact with articulated
objects  such as doors  cabinets  dishwashers or fridges  in this work  we present a novel 
probabilistic framework for modeling articulated objects as kinematic graphs  vertices in
this graph correspond to object parts  while edges between them model their kinematic
relationship  in particular  we present a set of parametric and non parametric edge models
and how they can robustly be estimated from noisy pose observations  we furthermore
describe how to estimate the kinematic structure and how to use the learned kinematic
models for pose prediction and for robotic manipulation tasks  we finally present how
the learned models can be generalized to new and previously unseen objects  in various
experiments using real robots with different camera systems as well as in simulation  we
show that our approach is valid  accurate and efficient  further  we demonstrate that our
approach has a broad set of applications  in particular for the emerging fields of mobile
manipulation and service robotics 

   introduction
service robots operating in domestic environments are typically faced with a variety of
objects they have to deal with or they have to manipulate to fulfill their task  a further
complicating factor is that many of the relevant objects are articulated  such as doors 
windows  but also pieces of furniture like cupboards  cabinets  or larger objects such as
garage doors  gates and cars  understanding the spatial movements of the individual parts
of articulated objects is essential for service robots to allow them to plan relevant actions
such as door opening trajectories and to assess whether they actually were successful  in
this work  we investigate the problem of learning kinematic models of articulated objects
and using them for robotic manipulation tasks  as an illustrating example  consider fig   
where a mobile manipulation robot interacts with various articulated objects in a kitchen
environment  learns their kinematic properties and infers their kinematic structure 
our problem can be formulated as follows  given a sequence of pose observations of
object parts  our goal is to learn a compact kinematic model describing the whole articulated object  this kinematic model has to define  i  the connectivity between the parts 
 ii  the number of degrees of freedom of the object  and  iii  the kinematic function for the
articulated object  as a result  we obtain a generative model which can be used by the
robot for generating and reasoning about future or unseen configurations 

c
    
ai access foundation  all rights reserved 

fisturm  stachniss    burgard

revolute

prismatic

figure    a service robot learns kinematic models of articulated objects in a kitchen environment 

the contribution of this paper is a novel approach that enables a real robot to learn
kinematic models of articulated objects from its sensor data  these models describe the
kinematics of the object and include the part connectivity  degrees of freedom of the objects 
and kinematic constraints  we utilize these models subsequently to control the motion of the
manipulator  furthermore  we show how a robot can improve model learning by exploiting
past experience  finally  we show how our framework can be generalized to deal with
closed chain objects  i e   objects that contain kinematic loops 
in the past  several researchers have addressed the problem to handle doors and drawers
 jain   kemp      a  klingbeil  saxena    ng        meeussen et al         wieland 
gonzalez aguirre  vahrenkamp  asfour    dillmann        mcclung  zheng    morrell 
       most of these approaches  however  are either entirely model free or assume substantial knowledge about the model and its parameters  whereas model free approaches
release designers from providing any a priori model information  the knowledge about objects and their articulation properties supports state estimation  motion prediction  and
planning 

   

fia probabilistic framework for learning kinematic models of articulated objects

pose
observations

model
fitting

candidate
link models

structure
selection

kinematic
graph

figure    schematic overview of our approach  the robot observes an articulated object in
different poses  it uses these observations to generate a set of candidate models 
and selects the kinematic structure that maximizes the posterior probability 

in our previous work  we introduced a simpler version of our probabilistic framework for
modeling articulated objects  presented estimators for fitting link models  and showed how
to efficiently find the kinematic structure for kinematic trees  sturm  pradeep  stachniss 
plagemann  konolige    burgard         as observations  we used a motion capture studio
and data from simulation  further  we used a stereo camera system for learning models
for kitchen furniture  sturm  konolige  stachniss    burgard         we described how
a manipulation robot can learn kinematic models from direct interaction with articulated
objects  and can improve over time by learning from experience  sturm  jain  stachniss 
kemp    burgard         in this work  we present a unified framework for learning kinematic models of articulated objects with an extended set of experiments  in contrast to
our previous work  we generalize our approach from kinematic trees to general kinematic
graph objects and add a strategy to efficiently find a locally optimal graph  with this  it
becomes possible to model articulated objects that contain kinematic loops  furthermore 
finding the effective number of degrees of freedom  dofs  of an articulated object directly
follows from our approach  a general software framework that implements the presented
approach is available online  under the bsd license  including source code  documentation 
and tutorials 
this paper is organized as follows  in section    we introduce our unified framework for
modeling the kinematics of articulated objects  in section    we present several extensions
including the exploitation of prior information  kinematic loops  and the estimation of
degrees of freedom  in section    we describe different options to perceive and control the
motion of articulated objects  we analyze our approach in an extensive set of experiments
both in simulation and on real robots and report our results in section    finally  we
conclude this article with a discussion of related work in section   

   a probabilistic framework for articulated objects
we define an articulated object to consist of multiple object parts that have one or more
passively actuated mechanical links between them  these links constrain the motion between the parts  for example  the hinge of a door constrains the door to move on an arc 
and the shaft of a drawer constrains the drawer to move on a line segment  the simplest
articulated object consists of two rigid parts with one mechanical link  more complex ob   http   www ros org wiki articulation

   

fisturm  stachniss    burgard

jects may consist of several articulated parts  like a door with a door handle  or a car with
several doors  windows  and wheels 
fig    gives a high level overview of our proposed system  a robot observes the pose
of an articulated object being manipulated  for the relative motion of any two parts  it
fits different candidate models that describe different mechanical links  from this set of
candidate link models  it selects the kinematic structure that best explains the observed
motion  i e   the kinematic structure that maximizes the posterior probability 
    notation
we assume that a robot  external to the object  observes the pose of an articulated object
consisting of p object parts  we denote the true pose of object part i              p  by a
vector xi  se     representing the  d pose of that part  including position and orientation  
where se       r   so    stands for the special euclidean group  further  we refer to
the full object pose  containing the poses of all parts  with the vector x  p    x            xp  t  
two object parts i and j are related by their relative transformation ij   xi   xj   we
use  and   for referring to the motion composition operator and its inverse   
we denote a kinematic link model between two object parts i and j as mij and its
associated parameter vector as ij  rkij   where kij  n  denotes the number of parameters
of the model describing the link  a kinematic graph g    vg   eg   consists of a set of
vertices vg               p   corresponding to the parts of the articulated object  and a set of
undirected edges eg  vg  vg describing the kinematic link between two object parts 
with each edge  ij   a corresponding kinematic link model mij with parameter vector ij
is associated 
all kinematic link models that we consider here  except for the trivial rigid link  have a
latent variable qij  cij  rd ij that describes the configuration of the link  for a door  this
can be the opening angle  cij stands for the configuration space of the link  the variable
dij represents the number of dofs of the mechanical link between the two parts 
while the object is being articulated  the robot observes the object pose  we denote the
n
n th pose observation of object part i as yi   correspondingly  we denote the n th pose
n
            yn   
observation of all parts as y  p and a sequence of n pose observations as dy    y  p
  p
n
further  we will refer to dzij    z ij           zij   as the sequence of relative transformations
zij   yi   yj that the robot has observed so far for the edge  ij  
fig   a depicts a graphical model of a simple articulated object that consists of two
object parts  we use here the so called plate notation to simplify the notation of the
graphical model  here  the nodes inside the rectangle  the plate  are copied for n times 
i e   for each time step t in which the object is observed  in each of these time steps  the
articulated object takes a particular configuration q   defining  together with the model
and its parameters  the noise free relative transformation    between the noise free pose
of the object parts x  and x    from that  the robot observes the noisy poses y  and y   
and infers from them a virtual measurement z     y    y    during model learning  the
robot infers from these observations the link model m   and link parameters     
   e g   if the poses x    x   r   are represented as homogeneous matrices  then these operators correspond
to matrix multiplication x   x    x  x  and inverse multiplication x    x     x     x    respectively 

   

fia probabilistic framework for learning kinematic models of articulated objects

m       

qt  
xt 

q
xt 

x 

x 

x 

x 
m       

t  
y t

y t

m       

zt  
t             t

 a  full graphical model

 b  reduced graphical model

 c  kinematic graph

figure     a  graphical model of an articulated object consisting of two parts x  and x   
being observed over t time steps  the model m        is shared between all time
steps   b  shows a simplified version of the same graphical model   c  shows the
corresponding kinematic graph 

a reduced version of this graphical model is depicted in fig   b  to improve readability 
we leave out some nodes  i e   the node corresponding to the relative transformation   
and the observation nodes y    y    and z     instead  we visualize the dependency between x 
and x  by a direct link and label it with the corresponding model  further  we collapse the
configuration of the link into a single node corresponding to the configuration of the whole
object  finally  we refer to the kinematic graph as the graph that models the connectivity
between object parts  as depicted in fig   c  
    problem definition
the problem that we consider here is to find the most likely kinematic graph g given a
sequence of pose observations dy of an articulated object  in bayesian terms  this means
that we aim at finding the kinematic graph g that maximizes the posterior probability of
observing the poses dy of the articulated object  i e  
g   arg max p g   dy   

   

g

however  finding the global maximum of the posterior p g   dy   is difficult  because it is a
highly non convex function over a high dimensional parameter space consisting of discrete
as well as continuous dimensions that encode the kinematic structure and the kinematic
properties  respectively 
therefore  in this section  we consider a simplified problem  we restrict the structure
space to kinematic trees only  and will focus on the general problem in section    kinematic
   

fisturm  stachniss    burgard

trees have the property that their individual edges are independent of each other  as a
result  we can estimate the link parameters independently of each other and also independent
of the kinematic structure  this means that for learning the local kinematic relationship
n
between object parts i and j  only their relative transformations dzij    z ij           zij   are
relevant for estimating the edge model  with this  we can rephrase the maximization
problem of     for kinematic trees now as
g   arg max p g   dz  

   

g

  arg max p   mij   ij      ij   eg     dz   
g
y
  arg max
p mij   ij   dzij   
g

   
   

 ij eg

the latter transformation follows from the mutual independence of the edges of kinematic
trees 
an important insight in our work is that the kinematic link models representing the
edges can be estimated independently from the actual structure of the kinematic tree  as
a result  the problem can be solved efficiently  first  we estimate the link models of all
possibles edges  ij   vg  vg  
 mij   ij     arg max p mij   ij   dzij   

   

mij  ij

these link models are independent of each other and independent of whether they are
actually part of the kinematic structure eg   second  given these link models  we estimate
the kinematic structure  this two step process is also visualized in fig    
solving     is still a two step process  mackay         at the first level of inference 
we assume that a particular model  e g   like the revolute model  is true  and estimate its
parameters  by applying bayes rule  we may write
ij   arg max p ij   dzij   mij  

   

ij

  arg max

p dzij   ij   mij   p ij   mij  
p dzij   mij  

ij

 

   

the term p ij   mij   defines the model dependent prior over the parameter space  that we
assume in our work to be uniform  and thus may be dropped  further  we can ignore the
normalizing constant p dzij   mij    as it is has no influence on the choice of the parameter
vector  this results in
ij   arg max p dzij   ij   mij   

   

ij

which means that fitting of a link model to the observations corresponds to the problem of
maximizing the data likelihood 

   

fia probabilistic framework for learning kinematic models of articulated objects

at the second level of inference  we need to compare the probability of different models
given the data and select the model with the highest posterior 
z
mij   arg max p mij   ij   dzij   dij  
   
mij

computing the exact posterior probability of a model is in general difficult  and therefore
we use in our work the bayesian information criterion  bic  for selecting the best model
according to     
as a result of this inference  we obtain for each edge  ij   vg  vg a model mij with
parameter vector ij   that best describes the motions in dzij observed between these two
parts  we denote this set of all possible link models with
m     mij   ij      ij   vg  vg   

    

given these maximum likelihood estimate for all links  we can now efficiently estimate
the kinematic structure eg  vg  vg   for this  we aim at finding the subset  that
maximizes the posterior probability of the resulting kinematic graph  i e  
z
eg   arg max p eg   m   dz   dm 
    
eg

we solve the equation again by maximizing the bic over all possible structures eg   using
the maximum likelihood estimate for m for approximating the integral 
with this  we provide an efficient way to solve      by first fitting all models to the data 
then selecting the best model for each link  and finally estimating the kinematic structure of
the whole articulated object  from section     to section      we will show how to solve the
model fitting problem of     and the model selection problem of     efficiently and robustly
from noisy observations  in section      we will then show how one can efficiently solve      
given the link models  in section      we will show how this solution for kinematic trees
can be generalized to general kinematic graphs  including kinematic structures containing
loops 
    observation model
in the beginning  we consider simple objects consisting of only p     rigid parts  and drop
the ij indices to increase readability  we consider the case that the robot has observed
a sequence of n relative transformations dz    z            zn   between two adjacent rigid
parts of an articulated object  we assume the presence of gaussian noise in each of the
measurements zn with zero mean and covariance z  r    
further  we assume that a small fraction of the observations are real outliers that cannot
be explained by the gaussian noise assumption alone  these outliers may be the result of
poor perception  bad data association  or other sensor failures that are hard to be modeled
explicitly  as these outliers are not related to the true value of    x   x  at all  we assume
that they come from a uniform prior  i e   we assume a constant likelihood p zoutlier     const 
one can think of this as a latent variable v         indicating whether an observation is an

   

fisturm  stachniss    burgard

inlier  v      or an outlier  v       further  we denote with  the probability of drawing
an outlier  i e   p v          our full observation model then becomes

   n     z   if v    
z
 
    
u
if v    
the resulting data likelihood for a single observation z thus is a mixture of a gaussian and
a uniform distribution with mixing constant  
p z              p z   v        p z   v      

    

note that in general neither the true transformation  nor the outlier ratio  are directly
observable  and thus need to be estimated from the data  for comparing models with
different outlier ratios  we assume a global prior of p    exp w  with w being a
weighting constant  and thereby favor models with fewer outliers over models with more
outliers  the resulting data likelihood of an observation z given its true value  thus
becomes 
p z       p z      p   

    

    candidate models
when considering the set of objects relevant for a service robot  one quickly realizes that
the joints in many objects belong to a few generic model classes  in particular  revolute
and prismatic joints are used most often  although a few objects are composed of other
mechanical linkages  for example spherical joints  screws  or two bar links  examples of
revolute joints include doors  door handles  and windows  this also includes the doors
of dishwashers  microwave ovens or washing machines  examples of articulated objects
belonging to the prismatic class include drawers  sliding doors  and window blinds  however 
there are also objects that have different mechanical linkages  such as garage doors or twobar office lamps  this motivates the use of a set of candidate models  that are well suited for
describing the kinematic properties of a particular class of articulated links  our candidate
set consists of parametrized and non parametrized models  in particular  it includes a model
for revolute joints  mrevolute    for prismatic joints  mprismatic    and rigid transformations
 mrigid    additionally  there may be articulations that do not correspond to these standard
motions  for which we consider a parameter free model  mgp    we model such joints using
a combination of dimensionality reduction and gaussian process regression 
in our framework  a model class defines the conditional probability distribution p   
q  m    and p q     m    by means of a forward kinematic function fm   q    
 
and the inverse kinematic function fm 
 z    q  this means that we assume that our link
models are deterministic  and we attribute all noise to measurement noise in the observations
of the object parts  i e   by means of the observation model p    z  defined in section     
since we have no prior information about the nature of the connection between the two
rigid parts  we do not aim to fit only a single model  but instead aim at fitting all of the
candidate models to the observed data  and then we select the best model from this set 

   

fia probabilistic framework for learning kinematic models of articulated objects

candidate model
m
rigid model
prismatic model
revolute model
gaussian process model

dofs
d
 
 
 
            

parameters
k
 
 
  
    d    n

table    overview over the different candidate models for articulated links 
    model fitting using maximum likelihood consensus
for estimating the parameters of any of the above mentioned models  we need to find a
parameter vector   rk that maximizes the data likelihood given the model  i e  
   arg max p dz   m    

    



in the presence of noise and outliers  finding the right parameter vector  that minimizes     
is not trivial  as least squares estimation is sensitive to outliers and thus not sufficient given
our observation model  therefore  we use the mlesac  maximum likelihood consensus 
algorithm as introduced by torr and zisserman         we estimate the initial kinematic
parameters from a minimal set of randomly drawn samples from the observation sequence
that we then refine using non linear optimization of the data likelihood 
the mlesac procedure for a model m works as follows  first  we generate a guess
for the parameter vector  in      from a minimal set of samples from dz   for this guess 
we then compute the data likelihood of the whole observation sequence dz as the product
over all data
p dz   m     

n
y

p zt   m    

    

t  

we repeat this sampling step for a fixed number of iterations  and finally select the parameter vector maximizing       on this initial guess  we apply non linear optimization on
the data likelihood to refine the parameter vector using broyden fletcher goldfarb shanno
 bfgs  optimization  which is a quasi newton method for function maximization  during
the maximization of the data likelihood  mlesac iteratively also estimates the outlier
ratio   using the expectation maximization algorithm 
in the following  we show for each of our link models how to  i  estimate the parameter
vector  from a minimal sample set of observations   ii  estimate a transformation z given
a configuration q  and  iii  estimate the configuration q given a transformation z  a brief
overview over all model candidates is given in table   
      rigid model
we parametrize a rigid link by a fixed relative transformation between two object parts 
thus  the parameter vector  has k     dimensions  during the sampling consensus step 
we draw a single observation z from the training data dz that gives us an initial guess for
   

fisturm  stachniss    burgard

the parameter vector   this parameter vector thus corresponds to the estimated fixed
relative transformation between the two parts  for the rigid transformation model  the
forward kinematics function equals the parameter vector as it corresponds to the estimated
fixed relative transform between the two parts 
fmrigid    q     

    

as the rigid model has zero dofs  d       an inverse kinematic function is not needed 
      prismatic model
prismatic joints move along a single axis  and thus have a one dimensional configuration
space  the prismatic model describes a translation along a vector of unit length e  r 
relative to some fixed origin a  se      this results in a parameter vector     a  e  with
k     dimensions 
for estimating these parameters  we sample two observations from the training data 
for this  we pick the transformation of the first sample as the origin a and the normalized
vector between them as the prismatic axis e 
a configuration q  r then encodes the distance from the origin a along the direction
of motion e  the forward kinematics function for the prismatic model mprismatic is
fmprismatic    q    a  qe 

    

let trans   be the function that removes all rotational components  the inverse kinematic
function then becomes
 
fm
prismatic    z     e  trans a   z    

    

where        refers to the dot product 
      revolute model
the revolute model describes the motion of a revolute joint  i e   a one dimensional motion
along a circular arc  we parametrize this model by the center of rotation c  se      and a
rigid transformation r  se      from the center to the moving part  this yields a parameter
vector     c  r  with k      dimensions 
for the revolute model  we sample three observations zi   zj and zk from the training
data  first  we estimate the plane spanned by these three points  its plane normal then
is parallel to the rotation axis  second  we compute the circle center as the intersection
of the perpendicular lines of the line segments between the three observations  together
with the rotation axis  this gives us the center of rotation c  finally  we estimate the rigid
transformation r of the circle from the first sample 
for the forward kinematic function  we obtain for revolute links
fmrevolute    q    c  rotz  q   r 

    

where rotz  q  denotes a rotation around the z axis by q  thus  q  r specifies the angle
of rotation  for estimating the configuration of a revolute joint we use
 
 
fm
revolute    z    rotz   z   c   r  

where rot 
z    gives the rotation around the z axis 
   

    

fia probabilistic framework for learning kinematic models of articulated objects

      gaussian process model
although rigid transformations in combination with revolute and prismatic joints might
seem at the first glance to be sufficient for a huge class of kinematic objects  many realworld objects cannot be described by a single shifting or rotation axis  examples for such
objects include garage doors or office table lamps  but also furniture whose joints have aged
and became loose 
therefore  we provide additionally a non parametric model which is able to describe
more general kinematic links  this model is based on dimensionality reduction for discovering the latent manifold of the configuration space and gaussian process regression for
learning a generative model  consider the manifold that is described by the observations
dz between two rigid bodies  depending on the number of dofs d of this link  the data
samples will lie on or close to a d dimensional manifold with    d    being non linearly
embedded in se     
there are many different dimensionality reduction techniques such as principal component analysis  pca  for linear manifolds  or isomap and locally linear embedding  lle 
for non linear manifolds  tenenbaum  de silva    langford        roweis   saul         in
our experiments  we used both pca and lle for dimensionality reduction  pca has the
advantage of being more robust against noise for near linear manifolds  while lle is more
general and can also model strongly non linear manifolds 
the general idea here is that we use the dimensionality reduction technique to obtain the
 
d
inverse kinematics function fm
gp   se      r   as a result  we can assign configurations
to each of the observations  i e  
 
fm
gp  z    q 

    

these assignments of observations to configurations can now be used to learn the forward
kinematics function fmgp      from the observations  except for linear actuators  we expect
this function to be strongly non linear 
a flexible approach for solving such non linear regression problems given noisy observations are gaussian processes  gps   one of the main features of the gaussian process
framework is that the observed data points are explicitly included in the model  therefore 
no parametric form of fmgp   rd  se     needs to be specified  data points can be added
to a gp at any time  which facilitates incremental and online learning  for this model  we
aim to learn a gp that fits the dependency
fmgp  q       z

    

for the unknown forward model underlying the articulated link under consideration  we
assume homoscedastic noise  i e   independent and identically  normally distributed noise
terms   n     z    for simplicity  we train    independent gaussian processes for the
free components of a homogeneous      transformation matrix  as a consequence of
this over parametrization  the predicted transformation matrices are not necessarily valid 
in practice  however  they are very close to valid transformation matrices  that can be
found using ortho normalization via singular value decomposition  in our approach  we use
the standard choice for the covariance function  the squared exponential  it describes the

   

fisturm  stachniss    burgard

relationship between two configurations qi and qj in configuration space by


 
 
t  
k qi   qj     f exp   qi  qj     qi  qj    
 

    

where f  is the signal variance  and     diag l            ld   is the diagonal matrix of the
length scale parameters  this results in a      d  dimensional hyper parameter vector
    f    l            ld    as gps are data driven  they require all training data when making predictions  therefore  we count all data samples as parameters of our model  so that
the number of parameters becomes k        d     n  where n    dz   is the number of
observations  we refer the interested reader to the text book by rasmussen and williams
       for more details about gp regression 
note that this gp link model directly generalizes to higher dimensional configuration
spaces  i e   with d      after the dimensionality reduction from observations in se    
to configurations in rd   we can again learn a gaussian process regression that learns the
mapping from the configuration space rd back to transformations in se      note that this
gp model that we present here is similar to the gplvm model introduced by lawrence
        in contrast to gplvm  we do not optimize the latent configurations for maximizing
the data likelihood  this would invalidate our inverse kinematics function       and limits
the gplvm model to map only from latent space to data space  with our approach  we can
also infer the configuration of new relative transformations not available during training 
    model evaluation
to evaluate how well a single observation z is explained by a model  we have to evaluate
p z   m     as the configuration is latent  i e   not directly observable by the robot  we
have to integrate over all possible values of q  i e  
z
p z   m      p z   q  m   p q   m    dq 
    
under the assumption that all dofs of the link are independent of each other  and that
no configuration state q is more likely than another  or equivalently  that p q   m    is
uniformly distributed   we may write
p q   m     n d  

    

where n    dz   is the number of observations so far  and thus the number of estimated
configurations in the d dimensional configuration space  with this       can be simplified
to
z
p z   m     n d p z   q  m    dq 
    
if we assume that p z   q  m    is an uni modal distribution  an approximation of the
integral is to evaluate it only at the estimated configuration q given the observation z using
the inverse kinematics function of the model under consideration  i e  
 
q   fm 
 z  

   

    

fia probabilistic framework for learning kinematic models of articulated objects

 using the forward
for this configuration  we can compute the expected transformation 
kinematics function of the model 
   fm   q  


    

 we can now efficiently compute
given the observation z and the expected transformation  
the data likelihood of      using the observation model from      as

p z   m     n d p z     

    

note that the approximation of the integral based on the forward and inverse kinematics
model corresponds to a projection of the noisy observations onto the model  finally  the
marginal data likelihood over the whole observation sequence becomes
y
p dz   m     
p z   m    
    
zdz

    model selection
after having fitted all model candidates to an observation sequence dz   we need to select
the model that explains the data best  for bayesian model selection  this means that we
need to compare the posterior probability of the models given the data
z
p dz   m   p    m p m 
p m   dz    
d 
    
p dz  
while the evaluation of the model posterior is in general difficult  it can be approximated
efficiently based on the bayesian information criterion  bic   schwarz         we denote
with k the number of parameters of the current model under consideration  and n the
number of observations in the training data  then  the bic is defined as
bic m      log p dz   m      k log n 

    

where  is the maximum likelihood parameter vector  model selection now reduces to
selecting the model that has the lowest bic  i e  
m   arg min bic m  

    

m

we refer the interested reader to the work of bishop        for further information on the
bic 
    finding the connectivity
so far  we ignored the question of connectivity and described how to evaluate and select a
model m for a single link between two parts of an object only  in this section  we extend
our approach to efficiently find kinematic trees for articulated objects consisting of multiple
parts 
we adopt the connectivity model from featherstone and orin        for modeling the
kinematic structure as an undirected graph g    vg   eg    the nodes vg in this graph
   

fisturm  stachniss    burgard

correspond to the poses of the individual object parts  while the edges eg correspond to
the links between these parts  we will now re introduce the ij indices  i e   use dzij to
refer to the observations of link  ij   and dz to refer to the observations of the whole
articulated object  dz thus contains the observations of all edges in the graph g  i e  
dz    dzij    ij   eg    in the previous section  we established an algorithm that fits and
selects for any given edge  ij  in this graph a corresponding link model mij with parameter
vector ij   given this  we now need to select the kinematic structure eg   i e   which of these
link models are actually present in the articulated object under consideration 
for the moment  we will consider only kinematic tree mechanisms  i e   mechanisms
without kinematic loops  now  we consider a fully connected graph with p vertices  i e   one
vertex for each object part of the articulated object  the set of possible kinematic trees
for the articulated object is now given by all spanning trees of this graph  the endeavor
of explicitly computing  evaluating  and reasoning with all kinematic trees  however  is not
tractable in practice 
we therefore seek to find the kinematic structure eg that maximizes the posterior as
stated previously in      
eg   arg max p eg   dz  

    

eg

  arg max p   mij   ij      ij   eg     dz  

    

eg

  arg max
eg

  arg max
eg

y

p mij   ij   dz  

    

log p mij   ij   dz   

    

 ij eg

x
 ij eg

note that because of the independence assumption of the individual links for kinematic
trees  the posterior of the kinematic model for the whole object in      can be written as the
product over the posteriors of the individual links in       after taking the logarithm in      
the structure selection problem takes a form that can be solved efficiently  the key insight
here is that the kinematic tree that maximizes      corresponds to the problem of selecting
the minimum spanning tree in a fully connected graph with edge costs corresponding to the
negative log posterior 
costij    log p mij    ij  dzij   

    

that we approximate with the bic value  the sum over these edge costs then corresponds
to the negative log posterior of the kinematic tree  and a minimum spanning tree thus maximizes the posterior of       the best kinematic structure can now be found efficiently  i e  
in o p  log p  time  using for example prims or kruskals algorithm for finding minimum
spanning trees  cormen  leiserson  rivest    stein        

   framework extensions
the approach described so far enables a robot to learn kinematic models of articulated
objects from scratch  in the following  we will consider three extensions  the first extension
   

fia probabilistic framework for learning kinematic models of articulated objects

enables a robot to exploit priors learned from previous interactions when learning new
models  second  we generalize our framework to general kinematic graphs  i e   consider
additionally objects that contain closed kinematic chains  third  we show that estimating
the number of dofs of articulated objects follows directly from our approach 
    learning and exploiting priors
using the approach described above  a robot always starts learning a model from scratch
when it observes movements of a new articulated object  from a learning perspective 
this may be seen as unsatisfactory since most articulated objects encountered in man made
environments belong to few different classes with similar parameters  for example  in a
specific office or kitchen  many cabinet doors will open in the same way  i e   have the
same radius and rotation axis  furthermore  in some countries the size of such furniture
is standardized  thus  a robot operating in such environments over extended periods of
time can significantly boost its performance by learning priors over the space of possible
articulated object models 
this section describes our approach for learning priors for articulated objects and a
means for exploiting them as early as possible while manipulating a previously unseen
articulated object  in addition to the previous section  we explicitly want to transfer model
information contained in already learned models to newly seen articulated objects  the key
idea here is to identify a small set of representative models for the articulated objects and
to utilize this as prior information to increase the prediction accuracy when handling new
objects 
to keep the notation simple  consider the case that we have previously encountered
two articulated objects consisting of two parts and thus a single link only  their observed
motion is given by two observation sequences dz   and dz     the question now is whether
both trajectories should be described by two distinct models m  and m  or by a joint
model m      in the first case  we can split the posterior as the two models are mutually
independent  i e  
p m    m    dz     dz       p m    dz    p m    dz     

    

in the latter case  both trajectories are explained by a single  joint model m    with
a parameter vector       that is estimated from the joint data dz    dz     for future
reference  we denote the corresponding posterior probability as
p m      dz     dz     

    

we can determine whether a joint model is better than two separate models by comparing the posterior probabilities from      and       i e  by evaluating
p m      dz     dz       p m    dz    p m    dz     

    

this expression can be efficiently evaluated by using the bic as follows  the joint model
is learned from n   n    n  data points  using k parameters  with a data likelihood of
l   p m      dz     dz      while the two separate models are learned from n  and n 

   

fisturm  stachniss    burgard

samples  using k   and k   parameters  and data likelihoods of l    p dz     m    and
l    p dz     m     respectively  accordingly  we check whether
bic m      dz     dz       bic m    dz       bic m    dz    

    

i e   whether
  log l   k log n     log l  l      k   log n    k   log n   

    

informally  merging two models into one is beneficial if the joint model can explain the data
equally well  i e   l  l  l     while requiring only a single set of parameters 
if more than two trajectories are considered  one has to evaluate all possible assignments
of these trajectories to models and select the assignment with the highest posterior  as this
quickly becomes intractable due to combinatorial explosion  we use an approximation and
consider the trajectories sequentially and in the order the robot observes them  we check
whether merging the new trajectory with one of the existing models leads to a higher
posterior compared to adding a new model for that trajectory to the set of previously
encountered models 
after having identified a set of models as prior information  we can exploit this knowledge
for making better predictions when observing a so far unseen articulated object  consider
the situation in which a partial trajectory of a new object has been observed  to exploit the
prior information  we proceed exactly as before  we compute and compare the posteriors
according to       treating the newly observed data points as a new model or respectively
merging them into one of the w previously identified models by evaluating
p mnew   m            mw     max p m            mj new           mw   
j       w

    

if the newly observed data is merged with an existing model  the parameter vector is
estimated from a much larger dataset dz j dz new instead of dz new which leads to a better
estimation  note that this step is carried out after each observation of the new sequence 
thus  if the currently manipulated object ceases to be explained by the known models  the
method instantaneously creates a new model  after successful object manipulation  this
model serves as additional prior information for the future 
    closed kinematic chains
although most articulated objects have the connectivity of kinematic trees  there exist
mechanisms containing closed kinematic chains  featherstone   orin         an intuitive
example of a closed loop system is a robot that opens a door with its manipulator  while
both the robot and the door can be described individually as a kinematic tree using our
approach  the combined system of the robot  the door and the floor creates a kinematic loop 
another example is a humanoid robot that has multiple contact points  e g   by standing
on both feet  or a robot that manipulates an object with two arms  sentis  park    khatib 
       to describe such closed loop systems  we need to extend our approach 
recall that for finding the kinematic structure in section      we established the correspondence for finding the graph that maximizes the posterior probability  for that  we
needed to compute the data likelihood of the graph based on edge constraints  which was
   

fia probabilistic framework for learning kinematic models of articulated objects

easy for kinematic trees  in this case  all links can be evaluated independently of each other 
however  computing the data likelihood of a kinematic graph based on edge constraints is
more difficult  this results from the more complex  joint  prediction of the poses of the
object parts involved in such a kinematic loop  in general  the chained up predictions of the
relative transformations between the object parts will not lead to a globally consistent prediction  which is needed to compute the overall data likelihood in case of closed kinematic
chains 
this problem  however  is closely related to loop closing in the graph based formulation
of the simultaneous localization and mapping  slam  problem  lu   milios        dellaert 
      frese        grisetti  stachniss    burgard         for this type of problem  closedform solutions exist only for very simple cases  a popular solution for the general case
are iterative optimization approaches to deal with the underlying non linear least squares
problem 
to obtain a consistent pose estimation for the whole graph  we use the optimization
engine hog man by grisetti  kummerle  stachniss  frese  and hertzberg         originally
designed to solve the slam problem  to generate the input graph for hog man  we
proceed as follows  we add a vertex for each object part representing its initial pose
x             x n   that we estimate for an  arbitrary  spanning tree of the graph  then  for each
link model mij in our graph g  we add an edge that constrains the relative transformation
  in slam  this corresponds to an
between x i and x j to the expected transformation 
ij
observation   the optimization approach will then compute a set of new poses x            xn
that is in line with the constraints in the sense that it is the best prediction in terms of
the squared error that can be obtained given the links  in slam  this corresponds to the
corrected trajectory of the robot  
for the pose observations yi   we assume gaussian noise with zero mean and covariance
y   i e  
yi   xi   
  n     y   

    
    

the data likelihood for a single object part being observed at pose y while being expected
at pose x given the kinematic graph g and a configuration q then becomes


 
t  
p yi   g  q   exp   xi   yi   y  xi   yi    
    
 
using this  the global data likelihood of an articulated object in a particular configuration
can be computed as the product over the likelihoods of all individual object parts  i e  
y
p y  p   g  q   
p yi   g  q  
    
i      p

as the configuration q of the articulated object is latent and thus not known  we need to
integrate over all possible configurations  i e   calculate
z
p y  p   g    p y  p   g  q p q   g dq 
    

   

fisturm  stachniss    burgard

similar to       we approximate this integral by evaluating it only at the most likely configuration q of the articulated object  we assume that the configurations q are uniformly
distributed  i e   then p q   g   n d   where n is the number of pose observations and
d is the total number of dofs of the articulated object  the data likelihood for a pose
observation y  p then becomes
p y  p   g   n d p y  p   g  q  

    
n

            y   of a whole articulated
the data likelihood of an observation sequence dy    y  p
  p
object then is
y
i
p dy   g  
n d p y  p
  g  qi  
    
i      n

  n nd

y

i
p y  p
  g  qi   

    

i      n

this data likelihood can now be used to select the best kinematic structure  note that
in principle  all possible graphs need to be evaluated  which is super exponential in the
number of object parts  and polynomial in the number of template models  in contrast 
finding the exact solution in the case of kinematic trees has a polynomial complexity of only
o mp     obviously  the massive set of possible graph structures can only be fully evaluated
for small articulated objects and few template models 
in the absence of an efficient and exact solution  we propose an efficient approximation
that is able to find the locally best graph from an initial guess using a randomized search
strategy in polynomial time  the idea is that given the spanning tree as an initial solution
we only evaluate the graphs in the neighborhood of the current structure  i e   graphs whose
topology is similar to the current one  e g   by adding or removing one edge at a time  as
we will see in the experimental section  this heuristic is able to find the optimal  or nearoptimal  graph structure in most of the cases  additionally  we can guarantee that this
randomized search strategy never gets worse than the initial solution  i e   in our case the
spanning tree 
    finding the number of dofs
the current configuration of an articulated object is given by the stacked vector of all
individual configurations of its articulated links  i e  


q 
 q 
   
qlinks       
    
   
qdlinks
  the question now is  whether the articulated object actually has as many dofs as the
sum of dofs of its individual links might suggest  clearly  in the case that the articulated
object is a kinematic tree  the dofs d object
p of the articulated object directly equals the
sum over the dofs of its links d links    ij eg d ij as all of its links can be actuated
   

fia probabilistic framework for learning kinematic models of articulated objects

 a 

 b 

figure    example of an open and a closed kinematic chain  whereas the open chain in  a 
has three dofs  the closed chain  b  has also only a single dof 

independently of each other  however  for articulated objects containing loops  finding the
number of dofs of an articulated object is not trivial 
for an example  consider the object in fig   a which consists of four object parts and
a total of three dofs  in contrast  the object in fig   b consists of four object parts 
connected by four revolute links in the form of a loop  each of the four links has a single
dof  and therefore the configuration vector defining the configuration of all of its links
is qlinks    q    q    q    q     r    yet  the overall system has only a single dof  when the
first joint is brought into a particular configuration  the other joints are fixed as well  as a
result of the loop closure  this means that the object configuration qobject  r has only
a single dimension  and thus the object configuration space is a one dimensional manifold
embedded in the four dimensional link configuration space 
finding a mapping between the high dimensional link configuration space rd links and
a lower dimensional object configuration space rd object can for example be achieved using
pca for linear manifolds  and lle or isomap for non linear manifolds  in the case of
pca  this results in finding a projection matrix p  rd object d links describing the mapping
qobject   p qlinks

    

recall from       that the number of dofs has a strong influence on the data likelihood
of a configuration  because a higher dimensional configuration space results in a lower
likelihood for a single configuration  as a result  a model with fewer dofs is preferred over
a model with more dofs  at the same time  if additional parameters need to be estimated
for the dimension reduction  then these parameters are also model parameters and thus
need to be considered during model selection 
informally speaking  if a kinematic graph with fewer dofs explains the data equally
well  it will have a higher data likelihood and thus it be favored in the structure selection
step  in the experimental section  we will see that we can use this to accurately and robustly
estimate the dofs of various articulated objects 

   

fisturm  stachniss    burgard

   perception of articulated objects
for estimating the kinematic model of an articulated object  our approach needs a sequence
            yn   that includes the poses of all p parts of the
of n pose observations dy    y  p
  p
object  for our experiments  we used different sources for acquiring these pose observations 
marker based perception  as described in section      domain specific but marker less perception as described in section      and perception based on the internal forward kinematic
model of a manipulator using its joint encoders as described in section     
    marker based perception
for observing the pose of an articulated object  we used in our experiments three different
marker based systems  each with different noise and outlier characteristics  a motion capture
studio with low noise and no outliers  artoolkit markers with relatively high noise and
frequent outliers  and opencvs checkerboard detector with moderate noise and occasional
outliers 
      motion capturing studio
we conducted our first experiments in a phasespace motion capture studio at willow
garage  in collaboration with pradeep and konolige  sturm et al          this tracking
system uses several high speed cameras installed on a rig along the ceiling  and active led
markers attached on the individual parts of the articulated object  the data from the
phasespace device is virtually noise  and outlier free  the noise of the phasespace system
is specified to be y pos         m and y orient      
      artoolkit markers
additionally  we used the passive marker based system artoolkit for registering the  d
pose of objects by fiala         this system has the advantage that it requires only a
single camera  and can be used without any further infrastructure  the artoolkit markers
consist of a black rectangle and an error correcting code imprinted on a  x  grid inside
the rectangle for distinguishing the individual markers  we found that the noise with this
system strongly depends on the distance and the angle of the marker to the camera  with
a marker size of      m and in a distance of   m from the camera  we typically obtained
noise values of y pos        m and y orient       
      checkerboard markers
opencvs checkerboard detector provides a much higher pose accuracy  the detector
searches the camera images for strong black and white corners at sub pixel accuracy  bradski   kaehler         with this system  we typically obtained measurement noise around
y pos         m and y orient     with marker sizes of      m side length in   m distance from the camera  one can distinguish different markers with this system by using
checkerboards with varying numbers of rows and columns 

   

fia probabilistic framework for learning kinematic models of articulated objects

figure    marker less pose estimation using a stereo camera  for each segmented plane 
we iteratively fit a rectangle  left image   the right two images show observed
tracks of a cabinet drawer and a cabinet door 

    marker less pose estimation
in contrast to using artificial markers  it is also possible to estimate the object pose directly 
for example  from dense depth images acquired by a stereo camera system  we recently
developed such a system in collaboration with konolige  sturm et al          using a
marker less camera based tracking system has several advantages  first  it does not rely
on artificial markers attached to the articulated objects  and second  it does not require
expensive range scanners which have the additional disadvantage that they poorly deal
with moving objects  making them inconvenient for learning articulation models  however 
we recognize that in general the registration of arbitrary objects in point clouds is still an
open issue  therefore  we restrict ourselves here to fronts of kitchen cabinets  this does not
solve the general perception problem  but provides a useful and working solution for mobile
manipulation robots performing service tasks in households  in our concrete scenario  the
perception of articulated drawers and doors in a kitchen environment requires the accurate
detection of rectangular objects in the depth image sequences 
from the stereo processing system  we obtain in each frame a disparity image d 
r         that contains for each pixel  u  v  its perceived disparity d u  v   r  for more
details on the camera system  in particular on the choice of a suitable texture projection
pattern  we refer the interested reader to the recent work of konolige         the relationship between  d pixels in the disparity image and  d world points is defined by the
projection matrices of the calibrated stereo camera  and can be calculated by a single matrix
multiplication from the pixel coordinates and disparity 
we apply a ransac based plane fitting algorithm for segmenting the dense depth
image into planes  the next step is to find rectangles in the segmented planes  we start
with a sampled candidate rectangle and optimize its pose and size iteratively  by minimizing
an objective function that evaluates how accurately the rectangle candidate matches the
points in the segmented plane  after the search converges  we determine the quality of the
found rectangle by evaluating its pixel precision and recall  an example of the iterative
pose fitting is given in the left image of fig     the rectangle candidate started in the lower
left of the door  and iteratively converged to the correct pose and size of the door 

   

fisturm  stachniss    burgard

articulated object

position of
end effector

arm control

cartesian
equilibrium
point generation

y  t

model fitting and
selection
m  

xcep
t

xt   jt

model prediction

figure    overall control structure  sturm et al          the robot uses the trajectory of
its end effector to estimate a model of the articulated object  subsequently  it
uses this model for generating the next cartesian equilibrium point 

finally  for a sequence of depth images d  n   the detected rectangles need to be integrated into a set of consistent tracks  one for each visible rectangle  as a result  we obtain a
            yn   that we can use for model estimation and model
set of pose sequences dy    y  p
  p
selection  the middle and right image in fig    show the tracks that we obtained when
observing a drawer and a door in a kitchen cabinet  more details on this approach have
recently been described by sturm et al         
    perception using the joint encoders of a mobile manipulation robot
next to visual observation of articulated objects  a mobile manipulation robot can also
estimate the kinematic model while it physically interacts with the articulated object  by
evaluating its joint encoders  the robot can compute the pose of its gripper by using the
forward model of its manipulator  when the robot establishes firm contact with the handle
of a cabinet door  the position of its end effector directly corresponds to the position of the
door handle  as a result  the robot can both sense the position of the handle as well control
it by moving the manipulator 
the approach described in this section was developed in collaboration with jain and
kemp from the healthcare robotics lab at georgia tech  the robot that we use for this
research is a statically stable mobile manipulator named cody  it consists of two arms from
meka robotics and an omni directional mobile base from segway  as an end effector 
it uses a hook inspired by prosthetic hooks and human fingers  and is described in more
detail in the recent work of jain and kemp      a   furthermore  we used a pr  robot
from willow garage for additional experiments  using a standard   dof gripper with two
fingers  located in our lab 
fig    shows a block diagram of our approach  the robot observes the pose of its
end effector in cartesian space  denoted by y  se      while operating the mechanism 
the robot records the trajectory y  t over time as a sequence of poses  from this partial
trajectory  it continuously estimates the kinematic model of the articulated object  that the
robot uses in turn to predict the continuation of the trajectory  sturm et al         

   

fia probabilistic framework for learning kinematic models of articulated objects

to actively operate an articulated object with a robot  we use a trajectory controller that
updates the cartesian equilibrium point based on the estimated jacobian of the kinematic
model of the articulated object  this controller uses the kinematic model to generate
cartesian equilibrium point  cep  trajectories in a fixed world frame  attached to the initial
location of the handle  at each time step t  the controller computes a new equilibrium point
xcep
as
t
mechanism
xcep
  xcep
  vthook  
t
t    vt

    

where vtmechanism is a vector intended to operate the mechanism  and vthook is a vector
intended to keep the hook from slipping off the handle  the controller computes
vtmechanism   l mechanism

jt
kjt k

    

as a vector of length l mechanism        m along the jacobian of the learned kinematic
function of the mechanism  i e  
fi
jt   fm   q fiq qt  
    
for vthook   we use a proportional controller that tries to maintain a force of   n between
the hook and the handle in a direction perpendicular to jt   this controller uses the force
measured by the wrist force torque sensor of the robot  we refer the reader to the work of
jain and kemp      b  for details about the implementation of equilibrium point control 
and how it can be used to coordinate the motion of a mobile base and a compliant arm
 jain   kemp        
the positional accuracy of the manipulator itself is very high  i e   y pos       m 
however  by using a hook as the end effector  the robot cannot sense the orientation of the
handle  as the manipulator is mounted on a mobile base  the robot can move around  and
thus the positional accuracy of the sensed position of the hook in a global coordinate system
 and thus including localization errors of the base  reduces to about y pos       m 

   experiments
in this section  we present the results of a thorough evaluation of all aspects of our approach 
first  we show that our approach accurately and robustly estimates the kinematic models of
typical household objects using markers  second  we show that the same also holds for data
acquired with the marker less pose estimation using our active stereo camera system  third 
we show that our approach also works on data acquired with different mobile manipulation
robots operating various pieces of furniture in domestic environments 
    microwave oven  office cabinet  and garage door
for our first experiments  we use pose observations from three typical objects in domestic
environments  the door of a microwave oven  the drawers of an office cabinet  and a garage
door  the goal of these experiments is to show that our approach both robustly and
accurately estimates link models  as well as the correct kinematic structure of the whole
   

fisturm  stachniss    burgard

articulated object  in addition  we show that the range of the configuration space can be
obtained during model estimation 
the motion of the microwave oven and the cabinet was tracked using a motion capture
studio in collaboration with pradeep and konolige  sturm et al          and the garage
door using checkerboard markers  for each object  we recorded     data samples while
manually articulating each object  for the evaluation  we carry out    runs  for each run 
we sampled n      observations that we use for fitting the model parameters  we used the
remaining observations for measuring the prediction accuracy of the fitted model     folds
cross validation  
      model fitting
the quantitative results of model fitting and model selection are given in table    as
can be seen from this table  the revolute model is well suited for predicting the opening
movement of the microwave door  error below       m  while the prismatic model predicts
very accurately the motion of the drawer  error below        m   which is the expected
result  note that also the revolute model can also explain the motion of the drawer with an
accuracy of        m  by estimating a rotary joint with a large radius  it should be noted
that the flexible gp model provides roughly the same accuracy as the parametric models
and is able to robustly predict the poses of both datasets         m for the door  and
       m for the drawer   in the case of the simulated garage door  however  all parametric
models fail whereas the gp model provides accurate estimates 
the reader might wonder now why the gp model alone does not suffice  as the gp model
can represent many different types of kinematic models  including revolute and prismatic
ones  however  even if the gp model fits all data  it is not the best choice in terms of the
resulting posterior likelihoods  the gp model can  in some cases  be overly complex 
and then over fit the data at hand  this high complexity of the gp model is penalized
by the bic  in contrast  the specialized models have a smaller number of free parameters 
and are therefore more robust against noise and outliers  furthermore  they require less
observations to converge  these experiments illustrate that our system takes advantage of
the expert designed parametric models when appropriate while keeping the flexibility to
also learn accurate models for unforeseen mechanical constructions 
the learned kinematic models also provide the configuration range c of the articulated
object  for visualization purposes  we can now sample configurations from this range  and
project them to object poses using the learned forward function  fig     fig     and fig   
illustrate the learned configuration range for the door of the microwave oven  the garage
door  and the two drawers of the office cabinet  respectively 
      model and structure selection
after fitting the model candidates to the observed data  the next goal is to select the model
that best explains the data  which corresponds to finding the model that maximizes the
posterior probability  or minimizes the bic score  
the right image in fig    shows the resulting graph for the microwave oven dataset 
with the bic score indicated at each edge  as expected  the revolute model is selected 

   

fia probabilistic framework for learning kinematic models of articulated objects

dataset 

rigid
model

prismatic
model

revolute
model

gp
model

microwave
 z pos          m 
z orient         

pos  error  
orient  error  
 

       m
     
     

       m
     
     

       m
    
     

       m
    
     

drawer
 z pos          m 
z orient         

pos  error  
orient  error  
 

       m
    
     

       m
    
     

       m
    
     

       m
    
     

garage door
 z pos          m 
z orient         

pos  error  
orient  error  
 

       m
     
     

       m
     
     

       m
     
     

       m
    
     

table    prediction errors and estimated outlier ratios of the articulation models learned
of a microwave oven  an office cabinet  and a real garage door 

 a 

microwave oven

door

x 

x 

rigid
bic m      

         

prism 
bic m  
  

        

bic mrev 
      

     

bic mgp
      

     
 b 

figure    visualization of the kinematic model learned for the door of a microwave oven 
 a  configuration range   b  kinematic graph  the numbers on the edges indicate
the bic score of the corresponding model candidate 

because it has the lowest bic score  correspondingly  the right image in fig    shows the
bic scores for all edges for the garage door dataset  where the gp model gets selected 
a typical articulated object consisting of multiple parts is a cabinet with drawers as
depicted in fig     in this experiment  we track the poses of the cabinet itself  x     and its
two drawers  x  and x     during the first    samples  we opened and closed only the lower
drawer  accordingly  a prismatic joint model mprism 
is selected  see top row of images
  
in fig      when also the upper drawer gets opened and closed  the rigid model mrigid
is
  
prism 
prism 
prism 
replaced by a prismatic model m     and m  
is replaced by m     resulting in the
kinematic tree eg                     note that it is not required to articulate the drawers
one after each other  this was done only for illustration purposes 
   

fisturm  stachniss    burgard

building

garage door

x 

x 

rigid
bic m      

      

prism 
bic m  
  

      

bic mrev 
      

      

bic mgp
      

     

 a 

 b 

figure    visualization of the kinematic model learned for a garage door   a     uniformly
sampled configurations   b  kinematic graph 

      multi dimensional configuration spaces
to illustrate that our approach is also able to find models with higher dimensional configuration spaces with d      we let the robot monitor a table that was moved on the floor  the
robot is equipped with a monocular camera tracking an artoolkit marker attached to the
table  in this experiment  the table was only moved and was never turned  lifted  or tilted
and therefore the configuration space of the table has two dimensions  fig     shows four
snapshots during learning  initially  the table is perfectly explained as a rigid object in the
room  top left   then  a prismatic joint model best explains the data since the table was
moved in one direction only  top right   after moving sideways  the best model is a   dof
gaussian process model that follows a simple curved trajectory  bottom left   finally  the
full planar movement is explained by a   dof gaussian process model  bottom right   that
can model movements that lie on  d surfaces 
      additional examples
we ran similar experiments on a large set of different articulated objects that typically
occur in domestic environments  including office cabinets  office doors  desk lamps  windows 
kitchen cabinets  fridges and dishwashers and a garage door  four examples are given in
fig      videos of these  and all other  experiments are available on the homepage of the
corresponding author    these videos show both the original movie as well as an overlay
of the inferred kinematic model  for these experiments  we attached checkerboards of
different sizes to all movable parts  and used both a consumer grade video camera and a
low cost laptop webcam for acquiring the image data  our software also visualizes the
learned articulation models in  d and back projects them onto the image to allow for easy
visual inspection  the detected poses of the checkerboards are visualized as red green blue
coordinate axes systems  and selected links between them are indicated using a colored
connection  the software also displays the configuration range by generating poses in the
   http   www informatik uni freiburg de  sturm

   

fia probabilistic framework for learning kinematic models of articulated objects

cabinet

drawer  

drawer  

x 

x 

x 

rigid
bic mij    
prism 
bic mij
  

     

     

     

    

    

    

bic mrev     

    

    

    

bic mgp
ij    

     

     

     

ij

 a 

 b 
cabinet

drawer  

drawer  

x 

x 

x 

rigid
bic mij    
prism 

     

      

      

  

    

    

    

bic mrev     

    

    

    

bic mgp
ij    

     

     

     

bic mij

ij

 c 

 d 

figure    incrementally estimating a model of two drawers of a cabinet   a  initially  only
the lower drawer is opened and closed   b  corresponding kinematic graph   c 
both drawers are opened and closed independently   d  corresponding kinematic
graph 

estimated range  for revolute joints  it additionally indicates the rotation axis using a line
and a surrounding circle 
from visual inspection of the objects in fig      one can see how accurate the model
estimation works in conjunction with marker based tracking  the motion of the drawers of
the cabinet is well matched  and the rotation axes of the door hinge and the door handle
are estimated very close to their true position  the upper part of the garage door moves in
a slider in the ceiling  while the lower part is connected via a revolute joint  the resulting
motion is clearly neither revolute nor prismatic  and consequently our approach selects the
gp model  the desk lamp consists of two bar links that keep the light housing always
upright  or  loosely speaking  rigid in orientation   but move in the positional domain along
a circle  this link type can be well explained by the gp model  the existence of these
objects shows the necessity to supply a domestic service robot with such a general  nonparametric model that can deal with a wide variety of different articulated objects  it should
be noted that the majority of articulated objects in domestic environments will consist of
revolute and prismatic joints which can be more robustly estimated using parametrized
models  this motivates our approach that enables a robot to fit both parametric and

   

fisturm  stachniss    burgard

figure     learning a model for a table moving on the ground plane  the arrows indicate
the recovered manifold of the configuration space 

nonparametric models at the same time and compare them in terms of posterior likelihoods
in a consistent model selection framework 
another interesting object is a car  as its doors and windows have both tree  and chainlike elements  in fig      we observed the motion of the drivers door and window  after
the first few observations  our approach estimates the structure to be rigid  and links both
the door and the window in parallel to the car body  after we open the window to the
half  our approach attaches the drivers window to the door  and selects a prismatic model 
surprisingly to us  when we open the window further  and thus acquire more observations  
our approach switches to a revolute model for the drivers window associated with a large
radius  r       m   by looking carefully at the data and the car  we can confirm that the
window indeed moves on a circular path  which is due to its curved window glass  finally 
after the driver closes the door  also a revolute model for the link between the car body and
the door is selected 

   

fia probabilistic framework for learning kinematic models of articulated objects

x 
prismatic
x 

x 
revolute

prismatic
x 
x 

x 
revolute
 a  office cabinet

 b  room door

x 
gp

x 
x 

x 

gp

gp
x 

 c  garage door

 d  desk lamp

figure     visualization of the learned articulation models for several further domestic
objects   a  cabinet with two drawers   b  room door including handle   c 
garage door   d  desk lamp with two bar links 

we conclude from these results  that our approach is able to estimate the kinematic
parameters and the kinematic structure of different household objects at high accuracy  i e  
the prediction error of the learned models is around       m and   for objects tracked in
a motion capture studio  and around       m and   for checkerboard markers  at this
accuracy  the learned models are well suited for mobile manipulation tasks 
    evaluation of marker less model estimation
the goal of our next set of experiments is to show that the kinematic models can be learned
in certain environments without requiring artificial markers  in particular  we focus here
on kitchen environments with rectangular cabinet fronts  and employ our pose detector
described previously  sturm et al         
   

fisturm  stachniss    burgard

x 
x 
rigid
x 

x 

rigid

prismatic
rigid

x 

x 

 a 

 b 

x 
x 
x 

rigid

revolute

x 

revolute
revolute

x 
 c 

x 
 d 

figure     snapshots of the learning process when incrementally observing the motion of a
car door and its window from camera images  due to the shape of the glass the
drivers window actually moves on a circular arc with radius r       m  images
taken after  a       b       c      and  d      pose observations 

in a first experiment carried out in a motion capture studio  we evaluated our detector
and found that it detected the cabinet drawer in more than     of the images up to a
distance of     m from the camera 
we evaluated the robustness of our articulation model learner on detailed logfiles of both
a door        m      m  and a drawer        m       m  of a typical kitchen interior  we
repeatedly opened and closed these objects in approximately   m distance of the robot 
in total  we recorded       and       images  we downsampled these logs stochastically
to     images  and ran pose estimation  model estimation  and structure selection for   
times  the outcome of the model selection process  and the accuracy of the selected model
is depicted in fig     for the door dataset 

   

fia probabilistic framework for learning kinematic models of articulated objects

 a 

 b 

figure     articulation model learned from observing a drawer  a  and a door  b  

p model 

 

rigid
prismatic
revolute

    
   
    

error in position
error in orientation

    
    
    
    
    
 

  
 
 
 
 
 
  

  
  
  
number of observations  door 

  

orientation error  deg 

position error  m 

 

  

figure     evaluation of the articulation models learned for a cabinet door  averaged over
   runs  the plot at the top shows the probability of the articulation model templates  the plot at the bottom shows the prediction error and standard deviation
of the learned model 

for both datasets  we found that roughly for the first    observations  mostly the rigid
model is selected  as no substantial motion of the drawer or door was yet detected  the
more observations are added to the track  the higher the error between the  rigid  model

   

fisturm  stachniss    burgard

figure     images showing the robot cody at georgia tech operating the five mechanisms
using the approach described in section      the objects are  from left to right  
a cabinet door that opens to the right  a cabinet door that opens to the left  a
dishwasher  a drawer  and a sliding cabinet door  images courtesy of jain and
kemp 

predictions and the observations becomes  as a result  the prismatic and revolute models
are selected more frequently  after    observations  model selection has converged in all
cases to the true model 
the models learned of the drawer datasets have a predictive accuracy of approximately
     m and     and      m and     for the door dataset  although the predictive accuracy of
the learned models is slightly lower in comparison with the marker based tracking systems
due to the higher noise of the tracking system  the learned models are at this accuracy
usable for a mobile manipulator operating these objects 
    operating articulated objects with mobile manipulators
in this section  we show that real robots can utilize our approach to learn the kinematic
models of objects for active manipulation  here  control of the arm was done using the
equilibrium point control as described in section      which was the result of a collaboration
with jain and kemp  sturm et al          the experiments were conducted on two different
platforms  the robot cody and a pr  robot 

   

fia probabilistic framework for learning kinematic models of articulated objects

      task performance
we evaluated the performance of our approach on five different mechanisms using the robot
cody  a cabinet door that opens to the right  a cabinet door that opens to the left  a
dishwasher  a drawer  and a sliding cabinet door  we performed eight trials for each mechanism  the robot started approximately   m from the location of the handle  we manually
specified the grasp location by selecting a point in a  d point cloud recorded by the robot 
an orientation for the hook end effector  and the initial pulling direction  the task for the
robot was to navigate up to the mechanism and operate it  while learning the articulation
model using the methods described in section      we deemed a trial to be successful if
the robot navigated to the mechanism and opened it through an angle greater than    for
revolute mechanisms or     m for prismatic mechanisms 
fig     shows the robot after it has pulled open each of the five mechanisms in one of
the respective trials  the robot successfully opened the   rotary mechanisms in    out of
   trials and the   linear mechanisms in all    trials  the robot was able to open the doors
more than      and to estimate their radii on average with an error below      m  further 
the robot pulled open the drawer and the sliding cabinet repeatedly on average over      m 
overall the robot was successful in    out of    trials         
all three failures were due to the robot failing to hook onto the handle prior to operating
the mechanism  most likely due to odometry errors and errors in the provided location of
the handle  in our experiments  we did not observe that the model learning caused any
errors  in principle  however  the hook could slip off the handle if a wrong model had been
estimated 
      model fitting and selection from end effector trajectories
fig    and fig     show examples of the pr  robot operating several articulated objects
common to domestic environments  i e   a fridge  a drawer  a dishwasher door  the tray of a
dishwasher  and the valve of a heater  for these experiments  we did not use feedback control
as described in section     but tele operated the manipulator manually  first  we recorded a
set of trajectories by guiding the manipulator to operate various articulated objects  during
execution  we played these trajectories back using a different implementation of equilibrium
point control available on the pr  platform  and recorded the end effector trajectories of the
robot  we used these trajectories subsequently to learn the kinematic models  finally  we
visualized these models by superimposing them on images taken by a calibrated wide angle
camera mounted on the head of the robot  see fig      in our experiments  our approach
always selected the correct model candidate  one can easily verify by visual inspection that
our approach estimates the kinematic properties  like the rotation axis or the prismatic
axis  very accurately 
these experiments show that robots can successfully learn accurate kinematic models of
articulated objects from end effector trajectories by using our approach  with the pr   we
achieved an average predictive accuracy of the learned models below       m  in terms of
residual error of the observed trajectory with respect to the learned model   which is more
than sufficient for using our models for mobile manipulation tasks in domestic settings 

   

fisturm  stachniss    burgard

revolute

 a  cabinet door

revolute

 b  dishwasher door

prismatic

 c  dishwasher tray

revolute

 d  valve of a heater

figure     a pr  robot learns the kinematic models of different pieces of furniture by
actuating them using its manipulator  objects from top to bottom  fridge 
cabinet door  drawer  dishwasher door  dishwasher tray  water tap  valve of a
heater 

   

fi   

   

   

   

 

 

    

    

    

    
    

    
x  m 

 

    

    
x  m 

z  m 

y  m 

a probabilistic framework for learning kinematic models of articulated objects

 

figure     these plots show the observed trajectories and the   recovered models when
minimizing the overall bic using our approach  trajectories assigned to the
same model are depicted in the same color 

prediction error  m 

without learned prior models
with learned prior models
   

   

   

 
 

   

   
   
   
   
   
   
   
ratio of the observed trajectory vs  the full trajectory

   

 

figure     this graph shows the average prediction error  line  and standard deviation
 shaded area  of the learned model on the full trajectory with and without prior
information 

   

fisturm  stachniss    burgard

    improving model estimation based on experience
in the experiments described in the previous section  we learned the kinematic models
for the kitchen furniture independent of each other  by using the approach described in
section     on data from cody  we exploit the correlation between the models of different
objects by searching for the set of model clusters that maximize the posterior probability 
fig     shows the result of this experiment  the colors indicate the cluster to which the
trajectories have been assigned to  our approach correctly recognized that the robot had
operated   different mechanisms and assigned the    different trajectories correctly to the
corresponding models 
we measured the average prediction error with and without learning prior models  see
fig       using leave one out cross validation and a randomized ordering of the trajectories 
we found that the prior models reduce the prediction error considerably  especially if the
new trajectory is only partially observed  when     to     of the new trajectory have
been observed  the prediction error is reduced by a factor of three and more  as a result 
the robot comes up with a substantially more accurate model early and can utilize this
knowledge to better control its manipulator 
throughout all experiments on cody  we used a fixed noise term of z pos       m  this
accounts for inaccuracies in the observation of the end effector position  due to variations
in the hooking position  and small errors in the kinematic forward model and robot base
localization  we found in repeated experiments that in the range between     m  z pos 
    m  the results are similar to our previous results obtained with z pos       m  only
for significantly smaller values of z pos more models are created  for example due to small
variations of the grasping point and other inaccuracies  for much larger values  observations
from different mechanisms are clustered into a joint model  thus  our results are insensitive
to moderate variations in the observation noise z pos  
this experiment illustrates that our approach enables a mobile robot to learn from
experience or exploit prior information when manipulating new objects  the experience
increases the prediction accuracy by a factor of approximately three 
    detecting kinematic loops
in our final set of experiments  we evaluated our approach on objects containing kinematic
loops  the goal of these experiments is to show that our approach can estimate correctly
both the kinematic connectivity  as well as the correct number of dofs 
for that purpose  we used the first four segments of a yardstick  this results in an
open kinematic chain consisting of three revolute joints  see top left image of fig       this
object has three dofs  as all revolute joints are independent of each other  in a second
experiment  we taped the fifth segment of the yardstick together with the first one  this
creates an kinematic loop  see top right image of fig      the resulting object consists of
four revolute joints each having a single dof  the resulting mechanism has effectively only
a single dof  we articulated the objects manually  and recorded object pose datasets with
 dy         samples each using checkerboard markers 
the second and the third row of fig     visualize the learned kinematic model for
the open and the closed kinematic model  respectively  while the fourth row shows the
kinematic structure of the learned model  from this figure  it can be seen that our ap   

fia probabilistic framework for learning kinematic models of articulated objects

proach correctly recognizes that the open kinematic chain consists of three revolute links
rev 
rev 
 mrev 
     m     m      having three dofs q    q    q    q    in total  for the closed kinematic
rev 
rev 
rev 
chain  our approach selects four revolute links  mrev 
     m     m     m      and correctly
infers that the object only exhibits a single dof q    q    
we also analyzed the progression of model selection while the training data is incorporated  the left plot of fig     shows the dofs of the learned kinematic model for the
open kinematic chain  note that we opened the yardstick segment by segment  therefore
the number of dofs increases step wise from zero to three  the right plot shows the estimated number of dofs for the closed kinematic chain  our approach correctly estimates
the number of dofs to one already after the first few observations 
in more detail  we have analyzed the evolution of the bic scores and the runtime of the
different approaches for the closed kinematic chain in fig      the plot in the top shows
the evolution of the bic scores of all possible kinematic structures  we have colorized
the curves corresponding to the spanning tree solution  solid red   heuristic search  dashed
blue  and the global optimum  dotted green   the spanning tree solution that we use as
the starting point for our heuristic search is on average       worse in terms of bic than
the optimal solution  in contrast  the bic of the heuristic search is only      worse  and
equals the optimal solution in       of the cases  the time complexity of computing the
spanning tree is independent of the number of training samples  see bottom plot in fig     
in contrast to that  the evaluation of kinematic graphs requires for each kinematic structure
under consideration the evaluation of whole object poses  and thus is linear in the number
of training samples n  the heuristic search only evaluates kinematic graphs along a trace
through the structure space  as a result  for the yardstick object with p     object parts 
the heuristic search requires on average       less time than the full evaluation 
we conducted similar experiments on other objects containing kinematic loops and
reduced dofs  two examples are depicted in the first row of fig      an artificial object
consisting of four parts but only a single revolute joint  and a common domestic step ladder
consisting of two revolute joints with only a single  shared dof  in all cases  our approach
was able to correctly estimate both the kinematic parameters and the correct number of
dofs 
with these experiments  we have shown that our approach is able to detect closed
chains in articulated objects  and correctly estimates the correct number of dofs  as loop
closures  or reduced dofs  reduce the configuration space of an object significantly  this is
valuable information for a mobile manipulator  for example while reasoning about possible
configurations of an object 
      evaluation of model selection robustness
finally  we investigated the influence of the choice of the observation noise variable z on the
model selection process on artificial data  for this analysis  we sampled noisy observations
true         on the resulting
from a revolute model with a true observation noise of z pos
observation sequence  we fitted the candidate models  and selected the best model  we
repeated this experiment for    independent runs and evaluated the mean and the standard
deviation  when the number of training samples n is kept fixed  then a higher noise
assumption favors the selection of simpler models  and vice versa  fig     illustrates this

   

fisturm  stachniss    burgard

x 
revolute

x 

revolute

revolute

x 

x 
revolute
x 

x 
revolute

q  q  q       
x 
mrev 
  

x 

x 

x 

revolute

revolute
x 

q  q  q       
x 

x 

mrev 
mrev 
  
  

mrev 
  

x 

x 

x 

mrev 
mrev 
mrev 
  
  
  

figure     open kinematic chain with three dofs  left column  and closed kinematic chain
with only a single dof  right column   first row  images of the objects  second
and third row  learned kinematic models from two different perspectives  fourth
row  learned graphical model  showing the connectivity and the dofs of the
learned kinematic model  the selected kinematic model is visualized by bold
edges  the dofs are given by the boldly type set configuration variables 

   

fia probabilistic framework for learning kinematic models of articulated objects

open kinematic chain

closed kinematic chain
dofs

dofs

 

 

 

 

 

 

 

 

 

 

  

   

   

 

   

 

  

training samples n

   

   

   

training samples n

figure     estimated number of dofs for the open and the closed kinematic chain object
 see fig       left  open kinematic chain  right  closed kinematic chain 

spanning tree

search heuristic

global optimum

bic

      
 

time  s 

      
   
   
   
  
 

 

  

  

  

  

   

   

   

   

   

   

training samples n

figure     top  bic scores of all possible kinematic structures for the closed kinematic
chain  as depicted in the top right image of fig      bottom  computation
times as a function of the number of training samples 

   

fisturm  stachniss    burgard

x 
x 
rigid
x 

revolute
x 

rigid
revolute

revolute

x 

x 
x 

q  q  q       
x 

x 

x 

q  q       
x 

x 

x 

x 

rigid

mrot 
  

m
mrigid
     

mrot 
mrot 
  
  

figure     an articulated object consisting of a single revolute joint  left   and a stepladder
consisting of two revolute joints  right  

   

fia probabilistic framework for learning kinematic models of articulated objects

     

bic

     
     

   
 

gaussian process model
revolute model
prismatic model
rigid model

selected model
      

     

    

   

   

observation noise z position

figure     bic score as a function of the assumed observation noise  a low noise assumption favors the selection of more complex models  and vice versa 

dependency  for n      and an assumed noise level of z pos        the gp model is
selected  between       z pos       the revolute model yields the best trade off between
model complexity and data likelihood  above      z pos   the rigid model best explains
the observations as the noise level of this magnitudes hides the underlying model 
with this experiment  we demonstrated that our model selection procedure is robust over
large intervals of the observation noise assumption  i e   even though the true observation
true         our approach selected the revolute model when the noise
noise was set to z pos
assumption was in between       z pos       thus robust over a whole magnitude  we
also performed more experiments on synthetic data to verify that our estimators are robust
against normally distributed noise and that the mlesac based estimators are additionally
robust against uniformly distributed outliers 
    open source availability
the source code  documentation  code samples  and tutorials are fully available as opensource  licensed under bsd  we also provide a step by step guide to repeat these experiments using a consumer grade laptop and a webcam   

   related work
in this paper  we have combined several techniques that come from different fields  i e  
system identification for fitting kinematic models  information theory for model comparison
and structure selection  computer vision for estimating and tracking objects  service robotics
and control for actually manipulating articulated objects with mobile manipulators  in the
   http   www ros org wiki articulation

   

fisturm  stachniss    burgard

following  we will review related approaches  contrast them with our approach  and highlight
our contributions 
    kinematic model fitting
calibrating kinematic models of manipulation robots to sensor data has a long history in
system identification  a good overview of existing techniques can be found in the work
of hollerbach  khalil  and gautier         he  zhao  yang  and yang        recently
analyzed the identifiability of parameters for serial chain manipulators  and proposed a
generic approach for calibration  pradeep  konolige  and berger        recently presented a
system implementation of sensor actuator calibration for a complex service robot consisting
of two arms  a laser scanner and several cameras  in all of these works  the kinematic
model is specified in advance  and it is typically expected that an initial parameter set is
available  by taking multiple pose observations of the robot in different configurations 
the error between prediction and observation can be computed  and finally the parameter
vector can optimized by using non linear  iterative least squares methods 
in our case  neither the kinematic model nor an initial parameter set is available  but
needs to be estimated from the observations alone  in particular when the observations are
disturbed by noise and outliers  sample consensus methods have been proven to provide
robust estimates  fischler   bolles        torr   zisserman        nister        rusu 
marton  blodow  dolha    beetz         in our model estimators  we use mlesac as
first described by torr and zisserman        which is  in contrast to least squares fitting
 robust against reasonable amounts of outliers in the training data 
    kinematic structure selection
estimating kinematic structure from observations has been studied intensively before  however  without subsequently using these models for robotic manipulation  taycher  fisher 
  darrell        kirk  obrien    forsyth        yan   pollefeys        ross  tarlow   
zemel        pekelny   gotsman         taycher et al         address the task of estimating the underlying topology of an observed articulated body  their focus lies on recovering
the topology of the object rather than on learning a generative model  also  compared to
their work  our approach can handle links with more complex link models  e g   multiple
dofs and non parametric models  kirk et al         extract human skeletal topologies using  d markers from a motion capture system  however assuming that all joints are revolute 
yan and pollefeys        present an approach for learning the structure of an articulated
object from feature trajectories under affine projections  other researchers have addressed
the problem of identifying different object parts from image data  ross et al         use
multi body structure from motion to extract links from an image sequence and then fit an
articulated model to these links using maximum likelihood learning 
there exist several approaches where tracking articulated objects is the key motivation
and often an a priori model is assumed  krainin  henry  ren  and fox         for example 
described recently an approach for tracking articulated objects such as a manipulator using
a depth camera with a texture projector  however  they require a geometric model of the
manipulator  kragic  petersson  and christensen        describe an integrated navigation
system for mobile robots which includes a vision based system for the detection of door
   

fia probabilistic framework for learning kinematic models of articulated objects

handles that enables the robot to successfully open doors  anguelov  koller  parker  and
thrun        model doors as line segments that rotate around a hinge  em is then used to
find the model parameters both from  d range data and images  nieuwenhuisen  stuckler 
and behnke        describe an approach where a mobile robot increases its localization
accuracy by learning the positions of doors 
although learning the structure of general bayesian networks has been proven to be
np complete  chickering         many approximate methods have been proposed that can
solve the structure search problem efficiently  such methods include greedy search  iterated hill climbing  genetic algorithms and ant colony optimization  chickering        daly
  shen         in some cases  the size of the search space can be reduced significantly by
evaluating a number of statistical independence tests  margaritis   thrun        bromberg 
margaritis    honavar         in this paper  we consider special bayesian networks representing kinematic structures  this allows us to exploit the mutual independence of the edges
of kinematic trees for efficiently recovering the kinematic structure  for closed kinematic
chains  we use a greedy search heuristic similar as in the work of chickering        
estimating both the structure and the models requires to trade off data fit with model
complexity  this corresponds to a bayesian model selection problem  as described by
mackay         we approach this problem in our work using the bayesian information
criterion  bic  introduced by schwarz         the bic provides a method for selecting
between alternate model hypotheses  based on their data likelihood and model complexity 
in this paper  we use the bic both to select the kinematic models for the individual links
as well as for multi part articulated objects 
    pose estimation
many approaches for estimating the pose of objects from sensory data have been proposed in
the past  but solving the general problem is still an ongoing research effort  marker based
approaches using active or passive markers have the advantage of being easy to use and
providing full  d pose information  but require artificial markers to be attached upon the
object parts of interest  early work in the area of articulated object tracking was presented
by lowe        under the assumption that the object model  and a good initialization 
is known  nieuwenhuisen et al         use a  d laser range finder for detecting doors in
an office environment and storing them on a map  tilting lasers or line stripe systems
provide dense  d point clouds and have been used for localizing doors and door handles 
but cannot deal with moving objects  rusu  meeussen  chitta    beetz        quigley 
batra  gould  klingbeil  le  wellman    ng         camera based approaches can provide
higher frame rates  a good survey on the state of the art in camera based pose estimation
techniques can be found in the work of lepetit and fua         in our context  the work
of murillo  kosecka  guerrero  and sagues        and andreopoulos and tsotsos       
on visual door detection and pose estimation is of particular relevance  stereo systems
that employ matching algorithms to produce dense results provide  d point clouds at video
frame rates  but suffer from occasional dropouts in areas with low texture or illumination
 konolige        brox  rosenhahn  gall    cremers        wedel  rabe  vaudrey  brox 
franke    cremers         this can be overcome by active camera systems that add texture

   

fisturm  stachniss    burgard

to the scene using a projector led  two examples of such systems have been described by
konolige        and fox and ren        
in our work  we use several different approaches for estimating the pose of an articulated
object for showing that our approach is not specific to a specific data source  in particular 
we use marker based pose estimation from monocular camera  marker less pose estimation
from stereo data  and proprioceptive tracking using the robots joint encoders 
    operating articulated objects
several researchers have addressed the problem of operating articulated objects with robotic
manipulators  a large number of these techniques have focused on handling doors and drawers  klingbeil et al         kragic et al         meeussen et al         petrovskaya   ng 
      parlitz  hagele  kleint  seifertt    dautenhahn        niemeyer   slotine       
andreopoulos   tsotsos        rusu et al         chitta  cohen    likhachev         the
majority of these approaches  however  assumes an implicit kinematic model of the articulated object  meeussen et al         describe an integrated navigation system for mobile
robots including vision  and laser based detection of doors and door handles that enables
the robot to successfully open doors using a compliant arm  diankov  srinivasa  ferguson 
and kuffner        formulate door and drawer operation as a kinematically constrained
planning problem and propose to use caging grasps to enlarge the configuration space 
and demonstrate this on an integrated system performing various fetch and carry tasks
 srinivasa  ferguson  helfrich  berenson  romea  diankov  gallagher  hollinger  kuffner 
  vandeweghe         wieland et al         combine force and visual feedback to reduce
the interaction forces when opening kitchen cabinets and drawers  in contrast to our work 
these approaches make strong assumptions on the articulated objects  and do not deal with
the problem of inferring their kinematic structure  therefore  they neither deal with unknown objects  nor improve their performance through learning  katz and brock       
have enabled a robot to first interact with a planar kinematic object on a table in order
to visually learn a kinematic model  and then manipulate the object using this model to
achieve a goal state  in contrast to our work  their approach assumes planar objects and
learns only  d models  jain and kemp      b        recently presented an approach that
enabled a robot to estimate the radius and location of the axis for rotary joints that move
in a plane parallel to the ground  while opening novel doors and drawers using equilibrium
point control  recently  we combined  in collaboration with jain and kemp  the model
learning approach with the equilibrium point controller  sturm et al          this enabled
the robot to operate a larger class of articulated objects  i e   objects with non vertical
rotation axes 

   conclusion
in this paper  we presented a novel approach for learning kinematic models of articulated
objects  our approach infers the connectivity of rigid parts that constitute the object
including the articulation models of the individual links  to model the links  our approach
considers both  parametrized as well as parameter free representations  in extensive studies
on synthetic and real data  we have evaluated the behavior of model estimation  model
selection  and structure discovery  we have shown that our approach is applicable to a
   

fia probabilistic framework for learning kinematic models of articulated objects

wide range of articulated objects  and that it can be used in conjunction with a variety of
different sensor modalities  our approach enables mobile manipulators to operate unknown
articulated objects  learn their models  and improve over time 
despite the promising results presented in this paper  there are several open research
questions that remain for future investigation  in our current approach  we learn the kinematic models from static pose observations  it would be interesting to include the velocities
or accelerations of object or body parts  this would allow the robot to learn the dynamic
parameters as well and enable it to plan time optimal motion trajectories  a dynamical
model would enable the robot to accurately execute motions at higher speeds  furthermore 
a robot that can measure forces and torques while actuating an object could additionally
learn friction and damping profiles and include this information in the learned model as
well  the robot could benefit from this information to assess  for example  whether a door
or drawer is jammed 

   acknowledgments
the authors gratefully acknowledge the help of advait jain and charlie kemp from georgia
tech  in particular for collaboration and joint development of the online model estimation
and control approach as described in section      and for evaluating the approach on their
mobile manipulation robot cody as described in section      further  the authors would like
to thank vijay pradeep and kurt konolige from willow garage who inspired the authors to
work on this subject  and contributed to the experiments with the motion capture device as
reported in section      additional thanks go to kurt konolige for the joint development of
the marker less perception algorithm from stereo data as outlined in section     as well as the
evaluation presented in section      this work has partly been supported by the european
commission under grant agreement numbers fp         first mm  fp         tapas 
fp  ict        radhar  and by the dfg under contract number sfb tr   

references
andreopoulos  a     tsotsos  j  k          active vision for door localization and door
opening using playbot  in proc  of the canadian conf  on computer and robot vision
 crv   pp      washington  dc  usa 
anguelov  d   koller  d   parker  e     thrun  s          detecting and modeling doors with
mobile robots  in proc  of the ieee int  conf  on robotics   automation  icra  
pp           
bishop  c          pattern recognition and machine learning  information science and
statistics   springer 
bradski  g     kaehler  a          learning opencv  computer vision with the opencv
library  oreilly media  inc 
bromberg  f   margaritis  d     honavar  v          efficient markov network structure
discovery using independence tests  journal of artificial intelligence research  jair  
   
   

fisturm  stachniss    burgard

brox  t   rosenhahn  b   gall  j     cremers  d          combined region  and motionbased  d tracking of rigid and articulated objects  ieee transactions on pattern
analysis and machine intelligence                
chickering  d  m          learning bayesian networks is np complete  in fisher  d  
  lenz  h   eds    learning from data  artificial intelligence and statistics v  pp 
        springer verlag 
chickering  d  m          learning equivalence classes of bayesian network structures 
journal of machine learning research  jmlr             
chitta  s   cohen  b     likhachev  m          planning for autonomous door opening with
a mobile manipulator  in proc  of the ieee int  conf  on robotics   automation
 icra  anchorage  ak  usa 
cormen  t  h   leiserson  c  e   rivest  r  l     stein  c          introduction to algorithms  mit press 
daly  r     shen  q          learning bayesian network equivalence classes with ant colony
optimization  journal of artificial intelligence research  jair              
dellaert  f          square root sam  in proc  of robotics  science and systems  rss  
pp         cambridge  ma  usa 
diankov  r   srinivasa  s   ferguson  d     kuffner  j          manipulation planning with
caging grasps  in proc  of ieee ras intl  conf  on humanoid robots  humanoids 
daejeon  korea 
featherstone  r     orin  d          dynamics  in siciliano  b     khatib  o   eds   
handbook of robotics  pp        springer  secaucus  nj  usa 
fiala  m          artag  a fiducial marker system using digital techniques  in proc  of the
ieee conf  on computer vision and pattern recognition  cvpr  
fischler  m     bolles  r          random sample consensus  a paradigm for model fitting
with application to image analysis and automated cartography  commun  acm      
       
fox  d     ren  x          overview of rgb d cameras and open research issues  in
proceedings of the workshop on advanced reasoning with depth cameras at robotics 
science and systems conference  rss  zaragoza  spain 
frese  u          treemap  an o logn  algorithm for indoor simultaneous localization and
mapping  autonomous robots                 
grisetti  g   kummerle  r   stachniss  c   frese  u     hertzberg  c          hierarchical
optimization on manifolds for online  d and  d mapping  in proc  of the ieee int 
conf  on robotics and automation  icra  anchorage  ak  usa 
grisetti  g   stachniss  c     burgard  w          non linear constraint network optimization for efficient map learning  trans  intell  transport  sys                  
   

fia probabilistic framework for learning kinematic models of articulated objects

he  r   zhao  y   yang  s     yang  s          kinematic parameter identification for
serial robot calibration based on poe formula  ieee transactions on robotics         
        
hollerbach  j   khalil  w     gautier  m          model identification  in siciliano  b    
khatib  o   eds    handbook of robotics  pp          springer  secaucus  nj  usa 
jain  a     kemp  c       a   behavior based door opening with equilibrium point control  in proc  of the rss workshop on mobile manipulation in human environments
seattle  wa  usa 
jain  a     kemp  c       b   pulling open novel doors and drawers with equilibrium point
control  in proc  of ieee ras intl  conf  on humanoid robots  humanoids  paris 
france 
jain  a     kemp  c          pulling open doors and drawers  coordinating an omnidirectional base and a compliant arm with equilibrium point control  in proc  of the
ieee int  conf  on robotics   automation  icra  anchorage  ak  usa 
katz  d     brock  o          manipulating articulated objects with interactive perception 
in proc  of robotics  science and systems  rss   pp         pasadena  ca  usa 
kirk  a   obrien  j  f     forsyth  d  a          skeletal parameter estimation from
optical motion capture data  in proc  of the int  conf  on computer graphics and
interactive techniques  siggraph  
klingbeil  e   saxena  a     ng  a          learning to open new doors  in proc  of the
rss workshop on robot manipulation seattle  wa  usa 
konolige  k          small vision systems  hardware and implementation  in proc  of the
int  symp  on robotics research  pp         
konolige  k          projected texture stereo  in proc  of the ieee int  conf  on robotics
  automation  icra  anchorage  ak  usa 
kragic  d   petersson  l     christensen  h          visually guided manipulation tasks 
robotics and autonomous systems                     
krainin  m   henry  p   ren  x     fox  d          manipulator and object tracking for in
hand model acquisition  in proc  of the ieee int  conf  on robotics   automation
 icra  anchorage  ak  usa 
lawrence  n          probabilistic non linear principal component analysis with gaussian
process latent variable models  j  mach  learn  res               
lepetit  v     fua  p          monocular model based  d tracking of rigid objects  foundations and trends in computer graphics and vision         
lowe  d          fitting parameterized three dimensional models to images  ieee transactions on pattern analysis and machine intelligence             
   

fisturm  stachniss    burgard

lu  f     milios  e          globally consistent range scan alignment for environment
mapping  autonomous robots            
mackay  d          information theory  inference  and learning algorithms  cambridge
university press 
margaritis  d     thrun  s          bayesian network induction via local neighborhoods 
in proc  of the conf  on neural information processing systems  nips   pp         
mit press 
mcclung  a   zheng  y     morrell  j          contact feature extraction on a balancing
manipulation platform  in proc  of the ieee int  conf  on robotics   automation
 icra  
meeussen  w   wise  m   glaser  s   chitta  s   mcgann  c   patrick  m   marder eppstein 
e   muja  m   eruhimov  v   foote  t   hsu  j   rusu  r   marthi  b   bradski  g  
konolige  k   gerkey  b     berger  e          autonomous door opening and plugging
in with a personal robot  in proc  of the ieee int  conf  on robotics   automation
 icra  anchorage  ak  usa 
murillo  a  c   kosecka  j   guerrero  j  j     sagues  c          visual door detection
integrating appearance and shape cues  robotics and autonomous systems        
pp         
niemeyer  g     slotine  j  j          a simple strategy for opening an unknown door  in
proc  of the ieee int  conf  on robotics   automation  icra  albuquerque  nm 
usa 
nieuwenhuisen  m   stuckler  j     behnke  s          improving indoor navigation of
autonomous robots by an explicit representation of doors  in proc  of the ieee
int  conf  on robotics   automation  icra  anchorage  ak  usa 
nister  d          preemptive ransac for live structure and motion estimation  mach  vision
appl                  
parlitz  c   hagele  m   kleint  p   seifertt  j     dautenhahn  k          care o bot  
  rationale for human robot interaction design  in proc  of the int  symposium on
robotics  isr  seoul  korea 
pekelny  y     gotsman  c          articulated object reconstruction and markerless motion capture from depth video  computer graphics forum                 
petrovskaya  a     ng  a          probabilistic mobile manipulation in dynamic environments  with application to opening doors  in proc  of the int  conf  on artificial
intelligence  ijcai  hyderabad  india 
pradeep  v   konolige  k     berger  e          calibrating a multi arm multi sensor robot 
a bundle adjustment approach  in int  symp  on experimental robotics  iser  new
delhi  india 
   

fia probabilistic framework for learning kinematic models of articulated objects

quigley  m   batra  s   gould  s   klingbeil  e   le  q   wellman  a     ng  a         
high accuracy  d sensing for mobile manipulation  improving object detection and
door opening  in proc  of the ieee int  conf  on robotics   automation  icra 
kobe  japan 
rasmussen  c     williams  c          gaussian processes for machine learning  the
mit press  cambridge  ma 
ross  d   tarlow  d     zemel  r          unsupervised learning of skeletons from motion 
in proc  of the european conf  on computer vision  eccv  marseille  france 
roweis  s     saul  l          nonlinear dimensionality reduction by locally linear embedding  science                       
rusu  r  b   meeussen  w   chitta  s     beetz  m          laser based perception for door
and handle identification  in proc  of the int  conf  on advanced robotics  icar 
munich  germany 
rusu  r  b   marton  z  c   blodow  n   dolha  m     beetz  m          towards  d point
cloud based object maps for household environments  robot  auton  syst           
       
schwarz  g          estimating the dimension of a model  the annals of statistics        
sentis  l   park  j     khatib  o          compliant control of multi contact and center of
mass behaviors in humanoid robots  ieee trans  on robotics                 
srinivasa  s   ferguson  d   helfrich  c   berenson  d   romea  a  c   diankov  r   gallagher  g   hollinger  g   kuffner  j     vandeweghe  j  m          herb  a home
exploring robotic butler  autonomous robots              
sturm  j   konolige  k   stachniss  c     burgard  w          vision based detection for
learning articulation models of cabinet doors and drawers in household environments 
in proc  of the ieee int  conf  on robotics   automation  icra  anchorage  ak 
usa 
sturm  j   pradeep  v   stachniss  c   plagemann  c   konolige  k     burgard  w         
learning kinematic models for articulated objects  in proc  of the int  joint conf  on
artificial intelligence  ijcai  pasadena  ca  usa 
sturm  j   jain  a   stachniss  c   kemp  c     burgard  w          operating articulated objects based on experience  in proc  of the ieee international conference on
intelligent robot systems  iros  taipei  taiwan 
taycher  l   fisher  j     darrell  t          recovering articulated model topology from
observed rigid motion  in proc  of the conf  on neural information processing systems
 nips  vancouver  canada 
tenenbaum  j   de silva  v     langford  j          a global geometric framework for
nonlinear dimensionality reduction   science                       
   

fisturm  stachniss    burgard

torr  p  h  s     zisserman  a          mlesac  a new robust estimator with application
to estimating image geometry  computer vision and image understanding           
wedel  a   rabe  c   vaudrey  t   brox  t   franke  u     cremers  d          efficient
dense scene flow from sparse or dense stereo data  in proc  of the european conf  on
computer vision  eccv  marseille  france 
wieland  s   gonzalez aguirre  d   vahrenkamp  n   asfour  t     dillmann  r         
combining force and visual feedback for physical interaction tasks in humanoid robots 
in proc  of ieee ras intl  conf  on humanoid robots  humanoids  paris  france 
yan  j     pollefeys  m          automatic kinematic chain building from feature trajectories of articulated objects  in proc  of the ieee conf  on computer vision and
pattern recognition  cvpr  washington  dc  usa 

   

fi