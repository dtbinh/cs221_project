journal of artificial intelligence research                  

submitted        published      

an analysis of phase transition in nk landscapes
yong gao
joseph culberson

ygao cs ualberta ca
joe cs ualberta ca

department of computing science
university of alberta
edmonton  alberta  canada  t g  h 

abstract
in this paper  we analyze the decision version of the nk landscape model from the
perspective of threshold phenomena and phase transitions under two random distributions 
the uniform probability model and the fixed ratio model  for the uniform probability
model  we prove that the phase transition is easy in the sense that there is a polynomial
algorithm that can solve a random instance of the problem with the probability asymptotic
to   as the problem size tends to infinity  for the fixed ratio model  we establish several
upper bounds for the solubility threshold  and prove that random instances with parameters
above these upper bounds can be solved polynomially  this  together with our empirical
study for random instances generated below and in the phase transition region  suggests
that the phase transition of the fixed ratio model is also easy 

   introduction
the nk landscape is a fitness landscape model devised by kauffman         an appealing
property of the nk landscape is that the ruggedness of the landscape can be tuned
by changing some parameters  over the years  the nk landscape model itself has been
studied from the perspectives of statistics and computational complexity  weinberger       
wright  thompson    zhang         in the study of genetic algorithms  nk landscape
models have been used as a prototype and benchmark in the analysis of the performance of
different genetic operators and the effects of different encoding methods on the algorithms
performance  altenberg        hordijk        jones        
in the field of combinatorial search and optimization  one of the interesting discoveries
is the threshold phenomena and phase transitions  roughly speaking  a phase transition in
combinatorial search refers to the phenomenon that the probability that a random instance
of the problem has a solution drops abruptly from   to   as the order parameter of the
random model crosses a critical value called the threshold  closely related to this phase
transition in solubility is the hardness of solving the problems  there has been strong empirical evidence and theoretical arguments showing that the hardest instances of the problems
usually occur around the threshold and instances generated with parameters far away from
the threshold are relatively easy  since the seminal work of cheeseman et al   cheeseman  kanefsky    taylor         many np complete combinatorial search problems have
been shown to have the phase transition and the associated easy hard easy pattern  cook
  mitchell        culberson   gent        freeman        gent  macintyre  prosser   

c
    
ai access foundation and morgan kaufmann publishers  all rights reserved 

figao   culberson

walsh        kirkpatrick   selman        mitchell  selman    levesque        vandegriend
  culberson        
in this paper  we analyze the nk landscape model from the perspective of threshold
phenomena and phase transitions  we establish two random models for the decision problem
of nk landscapes and study the threshold phenomena and the associated hardness of the
phase transitions in these two models 
the rest of the paper is organized as follows  in section    we introduce the nk fitness
landscape and our probabilistic models  the uniform probability model and the fixed ratio
model  in section   and section    the threshold phenomena and phase transitions in
nk landscapes are analyzed  for the uniform probability model  we prove that the phase
transition of the uniform probability model is easy in the sense that there is a polynomial
algorithm that can solve a random instance of the problem with the probability asymptotic
to   as the problem size tends to infinity  for the fixed ratio model  we establish two upper
bounds for the solubility threshold  and prove that random instances with parameters above
these upper bounds can be solved polynomially  this  together with our empirical study
for random instances generated below and in the phase transition region  suggests that
the phase transition of the fixed ratio model is also easy  in section    we report our
experimental results on typical hardness of the fixed ratio model  in section    we conclude
our investigation and discuss implications of our results 

   nk landscapes and their probabilistic models
an nk landscape f  x   

n
p

fi  xi    xi     is a real valued function defined on binary strings

i  

of fixed length  where n     is a positive integer and x    x         xn          n   it is the sum
of n local fitness functions fi      i  n  each local fitness function fi  xi    xi    depends
on the main variable xi and its neighborhood  xi    pk   x         xn    xi    where pk  x 
denotes the set of all subsets of size k from x  the most important parameters of an nk
landscape are the number of variables n  and the size of the neighborhood k     xi    
in an nk landscape  the neighborhood  xi   can be chosen in two ways  the random
neighborhood  where the k variables are randomly chosen from the set  x         xn    xi   
and the adjacent neighborhood  where k variables with indices nearest to i  modulo n  are
chosen  for example  for any even integer k  the k variables in  xi   can be defined as
x  n i k   mod n         x  n i  k   mod n    once the variables in the neighborhood are deter 
 
mined  the local fitness function fi is determined by a fitness lookup table which specifies
the function value fi for each of the  k   possible assignments to the variables xi and  xi   
throughout this paper  we consider nk landscapes with random neighborhoods  to
simplify the discussion  we further assume that the local fitness functions take on binary
values  given an nk landscape f   the corresponding decision problem is stated as follows 
is the maximum of f  x  equal to n  an nk landscape decision problem is insoluble if there
is no solution for it 
it has been proved that the nk landscape model is np complete for k     e g  
weinberger        wright et al          the proofs were based on a reduction from sat to
the decision problem of nk landscapes  to study the typical hardness of the nk landscape
decision problems in the framework of thresholds and phase transitions  we introduce two

   

fiphase transition in nk landscapes

random models  in both of the models defined below  the neighborhood set  xi   of a
variable xi is selected by randomly choosing without replacement k     xi    variables
from x  xi   
definition      the uniform probability model n  n  k  p   in this model  the fitness value
of the local fitness function fi  xi    xi    is determined as follows  for each assignment
y  dom fi           k     let fi  y      with the probability p and fi  y      with the
probability    p  where this is done for each possible assignment and each local fitness
function independently 
definition      the fixed ratio model n  n  k  z   in this model  the parameter z takes
on values from      k      if z is an integer  we specify the local fitness function fi  xi    xi   
by randomly choosing without replacement z tuples of possible assignments y    y         yz  
from dom fi           k     and defining the local fitness function as follows 

   if y  y  
fi  y   
   else 
for a non integer z         z     z      where  z  is the integer part of z  we choose
randomly without replacement       n  local fitness functions and determine their fitness
values according to n  n  k   z    the rest of the local fitness functions are determined according to n  n  k   z       
in the theory of random graphs  there are two related random models g n  p  where
each of the n n  
possible edges is included in the graph independently with probability
 
p  and g n  m  where exactly m edges are chosen randomly and without replacement from
the set of n n  
possible edges  it is well known that for most of the monotone graph
 
properties  results proved in g n  p   or g n  m   also hold asymptotically for g n  n p 
m
 correspondingly  g n  n
   where n   n n  
  however  we cannot expect that similar
 
relations exist between the two random models of nk landscapes defined above unless the
parameter k tends to infinity  as a result  the asymptotic behaviors of the two nk landscape
models are significantly different for fixed k 
we conclude this section by establishing a relation between the decision problem of nk
landscapes and the sat problem  a decision problem of the nk landscape
f  x   

n
x

fi  xi    xi    

i  

is the maximum of f  x  equal or greater than n   can be reduced to a  k    sat problem
as follows 
z
v
    for each local fitness function fi  xi    xi     construct a conjunction ci  
cij
j  

of clauses with exactly k     variable distinct literals from the set of variables  xi    xi    
where z is the number of zero values that fi takes and cij is such that for any assignment
yj        k   that falsifies cij   we have fi  yj       
n
v
    the  k    sat is the conjunction   
ci  
i  

   

figao   culberson

x
 
 
 
 
 
 
 
 

y
 
 
 
 
 
 
 
 

z
 
 
 
 
 
 
 
 

fi
 
 
 
 
 
 
 
 

clauses
xyz

x  y  z
x  y  z
x  y  z

table    a local fitness function and its equivalent   clauses 

table   shows an example of the fitness assignment of a local fitness function fi   fi  x  y  z 
and its associated equivalent   sat clauses  it is easy to see that for any assignment s to
the variables x  y  z  fi  s      if and only if the assignment satisfies the formula
x  y  z  x  y  z  x  y  z  x  y  z 

   analysis of the uniform probability model
in the uniform probability model n  n  k  p   the parameter p determines how many zero
values a local fitness function can take  we are interested in how the solubility and hardness
of the nk landscape decision problem change as the parameter p increases from   to    it
turns out that for fixed p      the decision problem is asymptotically trivially insoluble 
this is quite similar to the phenomena in the random models of the constraint satisfaction
problem observed by achlioptas et al         
to gain some more insight into the problem  we consider the case where p   p n  is a
function of the problem size n with lim p n       our analysis shows that the solubility of
n

the problem depends on how fast p n  decreases 
    if
 

lim p n n  k       

     

n

the problem is still asymptotically trivially insoluble because with the probability asymptotic to    there is at least one local fitness function that always has a fitness value   
    on the other hand if p n  decreases fast enough  i e  
 

lim p n n  k       

     

n

the problem can be decomposed into a set of independent sub problems  in either case the
problem can be solved in polynomial time  the case of       is not difficult to prove  but
to prove the case of        we need to make use of the following concepts and results 
definition      the connection graph of an nk landscape instance f  x   

n
p
i  

is a graph g   g v  e  satisfying
   

fi  xi    xi   

fiphase transition in nk landscapes

    each vertex v  v corresponds to a local fitness function  and
   there is an edge between vi   vj if and only if the corresponding local fitness functions
fi   fj share variables  i e   the neighborhoods  xi   and  xj   of xi and xj have a non empty
intersection  and both of them have at least one zero value 
definition      let f  x   

n
p

fi  xi    xi    be an nk landscape instance with the con 

i  

nection graph g   g v  e   let g         gl be the connected components of g  since the
vertices of g correspond to local fitness functions  we can regard gi as a set of local fitness
functions  for each    i  l  let ui  x    x         xn   be the set of variables that appear
in the definition of the local fitness functions in gi  
it is easy to see that  u       ul   excluding independent vertices forms a disjoint partition
of  a subset of  the variables x    x         xn    and that the local fitness functions in gi
only depend on the variables in ui   furthermore  the nk decision problem is soluble if and
only if for each    i  l  there is an assignment si         ui   to the variables in ui such
that for each local fitness function g  gi   g s      
theorem     summarizes the result on the uniform probability model 
 

theorem      for any p n  such that lim p n n  k   exists  k fixed there is a polynon

mial time algorithm that successfully solves a random instance of n  n  k  p  with probability
asymptotic to   as n tends to infinity 
 

 

proof  we consider two cases  lim p n n  k       and lim p n n  k       
n

    the case of lim p n n
n

 
 k  

n

    

let ai be the event that fi  y      for each possible assignment y        k   and let
n
s
a 
ai be the event that at least one of the ai s occurs  we have
i  

lim p r a       lim p r 

n

n

n
 

aci  

i  

     lim     p n  
n

k  

 n  

 

it can be shown that if k is fixed and lim p n n  k        then lim p r a       it follows
n
n
that with probability asymptotic to one  there is at least one local fitness function which
takes on values   for any possible assignments  we can therefore show that in this case  the
nk decision problem is insoluble by checking the local fitness functions one by one  and
this only takes linear time 
 
    the case of lim p n n  k       
n
consider an algorithm that first finds the connected components gi      i  l of the
connection graph g of the nk model  and then uses brute force to find an assignment
si         ui   to the variables in ui such that for each local fitness function g  gi  
g s       the time complexity of this algorithm is o n    n   m n k p    where m n  k  p   
max  ui       i  l  is the maximum size of the subsets  ui      i  l  associated with the
   

figao   culberson

connected components of the connection graph  to prove the theorem  we only need to show
 
that m n  k  p   o log n   in the following  we will show that for lim p n n  k       
n
we have
lim p r m n  k  p    k         
n

consider the connection graph g   g v  e  of the nk model  it is a random graph and
there is an edge between two nodes if and only if the two corresponding local fitness functions
share variables and both of the local fitness functions take at least one zero as their fitness
value  however  under this definition the edge probabilities are not independent  if vx  e
then we know that fx has at least one zero and so the probability that xw is in e is greater
than if there were no other edge on x 
to deal with this we resort to the following proof construction  let cm    v            vm  
be a subset of v of size m  let  be an ordering  permutation  of v        vm   we say that
cm is variable connected with respect to the ordering   denoted as c cm      if for each
i     i  m there is either
   a j   i such that f j  and f i  share a variable  or
   a j     j  i such that the variable xj is one of the k random variables in fi  
lemma if the induced subgraph g cm   is connected then there exists at least one ordering
 of v        vm such that c cm     
as proof  consider the ordering of vertices of any depth first search of a connected
subgraph  in this case  the connections are all by case   
the expected number of permutations  for which c cm     is
ec   e      c cm          m pr c cm     
we then observe
 that the expected number of connected induced graphs on m vertices is
n
less than pm
  m ec   where p  is the probability that fi takes at least one value zero  we
show this value goes to zero in the limit if m   k      finally  since if there is a connected
subgraph on m vertices then there must be one for each i   m  it follows that the largest
connected component has size at most  k     
for a randomly generated permutation  of cm   let ci be the set of the first i vertices
of the permutation  for i    define pi to be the probability that f i  shares at least one
variable with f j  for some j   i given that c ci             i      let p        a one
vertex subgraph is always connected  
for i     we have pi   pr j   i  f i  and f j  share variables  given c ci      or
one of the k random variables in f i  is in  x        xm     xi    
pr c cm       

m
y

pi  

i  

finally  for i     we note that ci  has at most  i    k distinct other variables  if ci 
is connected then the number of variables may be less than this  thus 
nk i  m
k

n 
k

pi    
   

 

fiphase transition in nk landscapes

the combinatorial part reduces to
 n  k i      m         n  k i      m  k     
 n            n  k 


n  ki  m     k

 
n 
so  pr c cm      is


m
y


 

i  

n  ki  m    
n 

k  

  m 
km   m    k

   
n 
 m   
 
 o
  m  k fixed 
n


 m 
noting that pm

o
n  k      we see that the expected number of connected subgraphs of
 
size m is bounded by
 
 m   
m
 
m n
m  k   
p 
ec  o n n
m
n
which goes to zero if m    k     it follows that m n  k  p  is less than  k    with probability
asymptotic to    this completes the proof 

   analysis of the fixed ratio model
as has been discussed in the previous section  the uniform probability model n  n  k  p  of
nk landscapes is asymptotically trivial  part of the cause of this asymptotic triviality lies in
the fact that if the parameter p does not decrease very quickly with n  then asymptotically
there will be at least one local fitness function that takes the value   for all the possible
assignments  making the whole decision problem insoluble  in this section  we study the
fixed ratio model n  n  k  z   in this model  we require that each local fitness function has
fixed number of zero values so that the trivially insoluble situation in the uniform probability
model is avoided  we note that the same idea has been used in the study of the flawless
csp  gent et al         
recall that in the fixed ratio model  we choose the neighborhood structure for each local
fitness in the same way as in the uniform probability model n  n  k  p   to determine the
fitness value for a local fitness function fi   we randomly without replacement select exactly
z tuples  s         sz   from       k     and let fi  sj       for each    j  z and fi  s      for
every other s        k    
for the fixed ratio model  we are interested in how the probability of an instance of
n  n  k  z  being soluble changes as the parameter z increases from   to  k     it is easy to
n
p
see that the property there exists an assignment x such that f  x   
fi  xi    xi      n
i  

   

figao   culberson

is monotone in the parameter z  the number of tuples at which a local fitness function takes
zero  actually  we have the following lemma on the property of the solubility probability
of the fixed ratio model 
lemma      for the fixed ratio model  if z    z    then
p r n  n  k  z   is soluble   p r n  n  k  z   is soluble  
furthermore  we have

p r n  n  k  z is soluble   

   if z    
   if z    k    

based on the above lemma and in parallel to the study of the threshold phenomena in
other random combinatorial structures such as   coloring of random graphs and random
  sat  we suggest the following conjecture 
conjecture      there exists a threshold zc such that

   if z   zc  
lim p r n  n  k  z is soluble   
n
   if z   zc  
conjectures like this are the starting point of the study of phase transition in many
random combinatorial structures such as   coloring of random graphs and random sat 
but the existence of the thresholds is still an open question  achlioptas        cook  
mitchell         however  bounding the thresholds has been an important topic in the
study of phase transition  achlioptas              dubois        franco   gelder       
franco   paul        frieze   suen        kirousis  p kranakis  d krizanc    y stamation 
       in this section  we will establish two upper bounds on the threshold of the parameter
zc   and theoretically prove that random instances generated with the parameter z above
these upper bounds can be solved with probability asymptotic to   by polynomial  even
linear  algorithms 
characterizing the sharpness of the thresholds is also of great interest in the study of
the phase transition  after proving that every monotone graph property has a threshold
behavior  friedgut   kalai         friedgut        established a necessary and sufficient
condition for a monotone graph property to have sharp threshold  which has been used to
prove the sharpness of the thresholds of   colorability and   sat problems  friedgut       
achlioptas         for the fixed ratio model discussed in this paper  we suspect that it will
exhibit a coarse threshold behavior  and would like to leave a detailed investigation into
this problem as a future research direction 
    the upper bound of z      
the derivation of this upper bound is based on the concept of a conflicting pair of local
fitness functions  we say that two local fitness functions fi and fj conflict with each other
if
   fi and fj share at least one variable x  and
   

fiphase transition in nk landscapes

   for any assignment s        n   we have fi  s fj  s      
it is obvious that an instance of the nk decision problem is insoluble if there exists a pair
of conflicting local fitness functions 
based on the second moment method in the theory of probability  alon   spencer 
       we can prove the following upper bound result  as it takes linear time to check if
there is a pair of conflicting local fitness functions  we can see that the fixed ratio model
n  n     z  is linearly solvable when z       
theorem      define a to be the event that there is a conflicting pair of local fitness
functions in n  n     z   for the fixed ratio model n  n     z  with z           we have
lim p r a     
n

and thus the problem is insoluble with probability asymptotic to   
proof  without loss of generality  we may write f as where fi has   zeroes in its fitness
value assignment for    i  n  and   zeroes for n      i  n  let iij be the indicator
function of the event that fi and fj conflicts with each other  i e  

   if fi and fj conflicts with each other 
iij  
   else 
p
iij   we claim that lim p r s          
and s  
 i jn

n

by chebyschevs inequality  we have
p r s       p r  s  e s    e s  
v ar s 

 
 e s    

     

since for each    i  n  fi has exactly   zeros in its fitness value assignment  we know
that two local fitness function fi   fj      i  j  n  conflict with each other if and only if
they have exactly one common variable x such that one of the following is true     fi  s   
  or     fj  s      or    for all the assignments s such that x     respectively x       and
   fi  s      or     fj  s      or    for all the assignments s such that x     respectively x  
   
since the probability that two local fitness functions share at least one variable is equal
to


n  n 
 

 
   
n  n   
 
 

we have


p r iij       

 

 
      
n

 

n  n 
 
   
n  n 
 
 

 

 

 

  

 

         i  j  n 

   

     

figao   culberson

and hence 
x

e s   

x

e iij    

 i jn

p r iij        n  

 i jn

p

we now consider the variance of s  since s  

iij   we have

 i jn

p
v ar s   

p

v ar iij      

i j

 e iij ilm    e iij  e ilm   

 i j    l m 

 

 e s   

let

p
a   

and

p

 
a   

v ar iij  

i j

 e s   

 e iij ilm    e iij  e ilm   

 i j    l m 

 e s   

 

it is easy to see that lim a       to prove lim a       we consider two cases 
n
n
case    i    j    m    l  in this case  the two random variables iij and ilm are actually
independent  it follows that e iij ilm    e iij  e ilm       
case     i  j      l  m   but they have one in common  say j   l  in this case  we have
    
 
e iij ilm    e iij  e ilm     p r iij     p r ijm     iij       
n
 
    
 
 
  
p r ijm     iij       
n
n
given that fi and fj conflict with each other  the conditional probability that fj and fm
conflict with each other is still in   n    
  pairs of i and i
sincepthere are only cn
ij
jm satisfying the condition in case    we know
that
 e iij ilm    e iij  e ilm    is in  n   and therefore  lim a       it follows
n

 i j    l m 

that

v ar s 
    
n  e s    

lim p r s       lim

n

since the event  s      implies that there exists a conflicting pair of local fitness functions 
the theorem follows 
      sat sub problems in n  n     z  and a tighter upper bound
in this subsection  we establish a tighter upper bound z         for the threshold of the fixed
ratio model n  n     z  by showing that asymptotically n  n     z  contains an unsatisfiable
  sat sub problem with probability   for any value of z greater than        this also
gives us a polynomial time algorithm which determines that n  n     z  is insoluble with
probability asymptotic to   for z         
   

fiphase transition in nk landscapes

recall from section   that each instance of n  n     z  has an equivalent   sat instance 
the idea is to show that with probability asymptotic to    an instance of n  n     z  will
contain a set of specially structured   clauses  called a t   module  definition       franco
  gelder        
m    m            m p      t    p     
where
m     u   u   z    u   u   z    

mp     up   up  zp    up   up  zp    
mp    up  u   zp   up  u   zp   
mp      up    up    zp     up    up    zp     

m p     u p   u p  z p    u p   u p  z p    
m p    u p  u   z p   u p  u   z p  
m p      u   u   z p     u   u   z p     
m p      u   up    z p     u   up    z p     
and u         u p     z         z p   are binary variables  notice that a t   module can be reduced to a   sat problem containing two contradictory cycles and hence is unsatisfiable 
the result is proved in two steps  in the first step  it is shown that for z         the
average number of t   modules contained in n  n     z  tends to infinity as n increases  in
the second step  we use a result established by alon and spencer        on the second
moment method to prove that for z         the probability that n  n     z  contains at least
one t   module tends to   
let us start with the first step to show that the average number of t   modules contained
in n  n     z  tends to infinity as n increases 
definition      given a t   module m and an nk landscape instance f  

n
p

fi   k      a

i  

sequence of local fitness functions
g    g         gt     f         fn  
is said to be a possible match pm  if for each    m  t  the main variable of gm is one of
the three variables that occur in the   module mm   a subsequence  h         hl   of a possible
match g is legal if for any    m   j  l  hm    hj  
lemma      let f  x   

n
p

fi  xi    xi    be an instance of n  n     z  and m be a t   

i  

t
module  then the number of possible matches
 for the t   module m is     further  the

number of legal possible matches is           t  

   

figao   culberson

proof  for each    m  t  there are exactly   possible choices for gm  
fi   xi     xi      fi   xi     xi      fi   xi     xi     
where xi    xi    and xi  correspond to the three variables that occur in the   module mm  
therefore  there are  t possible matches for the t   module 
to prove the second conclusion  we divide the t   module into   parts m    m    m    m    
where m     mm      m  p   m     mm   p      m   p      and m   
 m p   m p     m p      letting l    l    and l  be the number of legal possible matches for
m    m    m  respectively  since the literals in m  are variable distinct from the literals in
m    we have that the number of legal possible matches  l  for the t   module m satisfies
l  l   l    l  l   
we now estimate the order of l    to this end  we consider the probability space    p   
where  is the set of sequences  g         gp   of local fitness functions that possibly match m 
and p is the uniform probability distribution  then  the number of legal possible matches
is
l        p r a random sample from  is legal 
     
let g    g         gp   be a random sample from  and xgm denote the main variable of the
local fitness function gm   then we have
 
p r xgm    um      p r xgm    um        p r xgm    zm       
 
where  u  denotes the variable corresponding to the literal u 
let bm       m  p be the event that the first m local fitness functions g         gm in
the possible match g    g         gp   are mutually distinct  since in m  only consecutive
  modules share variables  we have
bm     g         gm     gi    gi        i  m     
let bm   p r gm    gm    bm     m     and b       notice that b      then  we have
p r g    g         gp  is legal    p r bp  
  p r g     g    g     g         gp     gp  
  p r b   p r g     g    b     p r g     g    b       p r gp    gp    bp   

     

  b  b     bp
recalling that xgm denotes the main variable of the local fitness function gm   we have
bp   p r gp     gp   xgp     up     bp      p r gp     gp   xgp      up     bp   
  p r gp     gp   bp    xgp     up     p r xgp     up     bp     
p r gp     gp   bp    xgp      up     p r xgp      up     bp   
 
ap       ap  
 
 
 
     ap  
 
   

     

fiphase transition in nk landscapes

where ap   p r xgp     up     bp     for ap   we have
p r bp    xgp     up   
p r bp   
 
 
 p r bp    xgp     up    xgp     up    
p r bp   

ap  

  p r bp    xgp     up    xgp      up     
     
 
 
 p r xgp     up     bp    xgp     up      p r bp    xgp     up    
p r bp   
  p r xgp     up     bp    xgp      up      p r bp    xgp      up     


 
 
 
 
p r bp    xgp     up       p r bp    xgp      up    
p r bp     
 
the last equation in the above formula is because that given bp  and xgp     up   
 or xgp      up      we have two  three  respectively  choices in selecting the local fitness
function gp    consider the two terms p r bp    xgp     up     and p r bp    xgp    
 up     in        we have
p r bp    xgp     up    
  p r gp     gp    bp    xgp     up      p r bp    xgp     up    
 
  pr xgp     up      bp     p r bp   
 
 
  ap   p r bp   
 

     

and
p r bp    xgp      up    
  p r gp     gp    bp    xgp      up      p r bp    xgp      up    
  p r xgp      up      bp     p r bp   

      

      ap     p r bp   
by plugging       and        into        we get


p r bp     
 
 
ap  
ap        ap     
 
p r bp     
 
 bp 
this  together with        gives us
bp     

 
 
 bp 

      

it is not difficult to show that the sequence  bp   is decreasing and lower bounded by   
letting lim bp   b and taking the limit on both sides  we get
p

b  
   

 
 
 b

      

figao   culberson

and thus  b  
thus 


   
   

in our case  b  


    
 

b      bp 

since b       it follows that bp  b  

to prove that the expected number of legal possible matches l  for m  is in 

    
 

and

  p
    
 
 

from        we know that the number of legal possible matches is greater than
  p
  p
 
 
 
 
 
 
 p
 
 
 
 

let p   bp 


    
 



      
 p 
    
 
 

  bp  b  from        and         we have
p   bp  b  

which means that the series

p
p

bp   b
 dp        d     
 bbp 

m is convergent  it follows that

m  

    

p
 
         
 
b
b

converges to a finite positive constant c  therefore 
b     bp    b           b   p  


p 
  
  bp    
    
b
b
  p
    
c
 

      

for sufficient large p and some constant c 
we can show that the number of legal possible matches l  for m  is in
similarly 
   p   
    

  recalling that the number of legal possible matches l for the t   module
 
satisfies l  l   l    l  l    the second conclusion follows 
the following lemma calculates the probability that a matching local fitness function
implies the matched   module 
lemma      given a   module x  y  w  x  y  w  and a local fitness function g such
that the main variable xg of g is one of the three boolean variables  x    y    w   let z  
             be the parameter in the fixed ratio model n  n     z   then the probability
that g contains the   module is
 

 
 
 

p   
        
      
n 
  
  
 

   

fiphase transition in nk landscapes

proof  since xg is already one of the variables in the   module  the probability that
 
the other two variables are also in the   module is n 
 
     
now  assume that the variables of the local fitness function g are the same as the
variables in the   module  from the definition of the fixed ratio model  g has two zeros
in its fitness value assignment with probability        and has three zeros in its fitness
assignment with probability   note that the local fitness function g implies the   module
x  y  w  x  y  w if and only if
g x  y  w      and

g x  y  w      

from the definition of the fixed ratio model  this happens with the probability
 
 


            
 

 

the lemma follows 
with the above preparation  we can now prove that the average number of t   modules
contained in n  n     z  tends to infinity 
theorem      let at be the number of t   modules contained in n  n     z  and t  
 ln  n   then  if z                
lim e at      

n

      



proof  from lemma      there are more than          t legal possible matches for a fixed
t   module  from lemma      we know that each possible legal match g    g         gt  
implies the t   module with probability pt    from the proof of theorem      in  franco  
gelder         there are
 t  nt   n  t     t
      

n 
 
 
possible t   modules  where nt     nt    
  let r     
          
   and write p   
 
r  we have
 n 
   
e at    

 

 

 
 

 t

    
p    t  nt   n  t     t
 
  t
 
    
r   t  nt   n  t     t 
t
n 
 
 
  t
  t t t
n
  n  n  t     t
 
    
 

r 

n 
n t
 
  n  t     
 
 
  t t t

t
    
  n  n  t     t
n
 
r 
  n  t     
 
 n n     t
n 
  

 
t
         r t     o
  
 n
n
   

      

figao   culberson

where the fourth equation in        is due to the fact that for any positive integer n and q
 
such that q   n    we have nq eq   n  nq  nq   it follows that lim e at      if
n

     



  r     

      

solving the inequality        gives us           that is  z                 this proves
theorem     
based on the chebychevs inequality  to prove that n  n     z  contains t   modules with
probability    we need to show that the variance of at   the number of contained t   modules 
is o e at     for this purpose  we follow franco and gelders approach  lemma      franco
  gelder        to apply the second moment method  alon   spencer        
lemma       alon   spencer        ch      cor      given a random structure e g   a
random cnf formula   let w be the set of substructures under consideration  a w  be the
set of substructures sharing some clauses with w  w   let iw     when w is in the random
structure and   otherwise  if
    elementsp
of w are symmetric 
       e 
iw      and
ww
p
   
p r w   w    o    for each w  w  
wa w 

then as n    the probability that the random structure contains a substructure tends to
  
to use the above lemma to study the   sat sub problem in nk landscapes  we view
the random structure to be a random instance of n  n     z   and w to be the set of all
t   modules which are symmetric by their definitions sections   and     franco   gelder 
      
theorem      if z                 then n  n     z  is asymptotically insoluble with
probability   
proof 
let at be the number of t   modules implied by n  n     z  and t   o ln  n  
theorem     shows that lim e at       by lemma      it is enough to show that for
n
each w  w  
x
p r w   w    o e at    
      
wa w 

where p r w   w  is the conditional probability that n  n     z  implies the t   module w
given that it implies w  and a w  is the set of all t   modules sharing some clauses with w 
suppose that w shares q     q   t clauses with w  and that these q clauses are
distributed among q   modules  further  let q  be the number of   modules whose two
clauses are both shared and q    q  q  the number of   modules that only has one clause
shared 
let t  be a   module in w that shares exactly one clause with a   module t  in w 
we claim that the conditional probability that t  is implied by n  n     z  given that w is
implied by n  n     z   is
 
 
   o    
      
 
n
   

fiphase transition in nk landscapes

without loss of generality  assume that t     xyu  xy u  and t     xyu  xy u  
since w is implied by n  n     z   there is a local fitness function g   g  x    y    u   that implies
t    the conditional probability that t  is implied  is less than or equal to p    p  where
p  is the conditional probability that g also implies the clause x  y  u given that g implies
t    and p  is the conditional probability that the clause x  y  u is implied by other local
fitness functions  by the definition of n  n     z   we have that p         since a local fitness
function implies x  y  u only if it has the same variables with g   g  x    y    u    we have
that p    o  n     the claim is proved  it follows that  for sufficiently large n 
 tq

 q  
    
 
q 
p r w   w   c
p 
  

      
 
 
where p  is defined in lemma     and c is a fixed constant 
let aq q q   w  be the set of t   modules that share q clauses with w such that these q
clauses are distributed over q different   modules  as before  q  is the number of   modules
whose two clauses are both shared and q    q  q  the number of   modules that only has
one clause shared  we claim that
 aq q q   w      a q q    w   q   

      

where a q q    w  is the set of t   modules that share all the  q clauses in the q   modules
with w  let m    m         mt   be a t   module in which all the clauses mi      i  q
are shared with w  let m    m         mt   be a t   module in which all the clauses in
mi      i  q  are shared and each of the   modules mi   q       q    q  has only one
clause shared  since for each of the q    modules  we have   ways to choose the non shared
clauses  there are  q  such t   modules m in aq q q   w  that correspond to one t   module
m in a q q     the claims follow  from formula      and      in  franco   gelder       
and         it follows that
 
o t  tq   tq  q 
  n
 
  q  p     
n 
 aq q q   w     o   
      
tq
  tq 
q
 
n
 
  q   p     
n  

 
 
 
let r     
          
   and write p    n 
r  then  we have
     
 aq q q   w  p r w   w 


o t  tq   tq  q        tq   q 
     n
   
p       
n
 
 
  tq
o t 
 
    
    tq n  tq 
r

n  tq
n
 

      

 


o t   
         r  tq
n  n

o t 

e at           r  q   q  p    
n



and
 aq q q   w  p r w   w   o   e at        
   



  r  q   q   p     

      

figao   culberson

therefore 
x
x
p r w   w   
 aq q q   w  p r w   w 
q q q 

wa w 

 

t
x

t
x
x x
x x o t 


q
e at           r    
o   e at           r  q  
n
q
q

q   qp  

q   q p  

 

 

      
since      



  r      for z          we have
x
wa w 

p r w   w  

o t   
e at     t  e at    r  p   
n

      

  o e at    
this completes the proof of theorem     

   experiments
our study of the threshold phenomena in nk landscapes started with an experimental
investigation  many of the theoretical results in the previous section are motivated by
the observations made in our experiments  in this section  we describe the approach and
methods we used in the experimental study  and report the results and observations we
have made 
in our experiments  an instance of the nk landscape decision problem is converted to an
equivalent   sat problem  and then the   sat problem is solved using robertos relsatan
enhanced version of the famous davis putnam algorithm for sat problems implemented in
c      the source code of relsat can be found at http   www cs ubc ca  hoos satlib  
in the experiments  we generated random instances of the nk landscape decision problem from the random model n  n     z   as a result  the equivalent sat problem for each
random nk landscape instance is a   sat problem with n variables and  on average  zn
clauses  by definition  the parameter z is between   and    for z     the   sat instance
can be solved easily by setting the literals that correspond to the main variables of the
local fitness function to true  as z increases  we get more and more clauses and the   sat
problem becomes more and more constrained  the aims of the experiments are threefold    investigating if there exists a threshold phenomenon in the random nk landscape
model      locating the threshold of the parameter z  and    determining if there are any
hard instances around the threshold 
    experiments on the fixed ratio model
in this part of the experiments  we generate     random instances of n  n     z  for each
of the parameters n             and z                          these instances are then
converted to   sat instances and solved by relsat  figure   shows the fraction of insoluble
instances as a function of the parameter z  it can be seen that there exists a threshold
phenomenon and the threshold is around       this shows that our upper bound z        
is very tight 
   

fiphase transition in nk landscapes

 

   

   

   

n    
n     
n     
n     
n     
n      
n      
n      
z     

   

   

   

   

   

   

 
   

    

   

    

   

    

 

figure    fractions of insoluble instances y axis  as a function of z  x axis  

in figure    we plot the square root of the average search cost as a function of the
parameter n  the figure indicates that the average search is in o n    for any parameter
z  we have also observed that more than    percent of the insoluble instances are solved
quickly in the preprocessing stage of relsat  this indicates that there must be some small
structures that make the instances insoluble  more detailed experimental results can be
found in gaos thesis  gao        
    experiments on the   sat sub problem
this is the part of the experiments that motivated our theoretical analyses in section     
the idea can be explained as follows  let
f  x   

n
x

fi  xi    xi   

i  

be an instance of the decision problem of nk landscape and
 
 
   c  c     cn
the equivalent   sat problem where ci is the set of   clauses equivalent to the local fitness
function fi   for each i  there is a set of   clauses di  possibly empty  implied by ci   for
example  if ci has three   clauses   x  y  z    x  y  z    x  y  z    then the set of   clauses di
would be   x  z    x  y    the conjunction of di   denoted by   is a   sat problem  it is
obvious that the original   sat problem  is satisfiable only if the   sat sub problem  is
satisfiable  in the experiment  we generate instances of the nk landscape n  n     z   convert
   

figao   culberson

  
z     
z     
z     
z     
z     

  

  

  

  

  

 

 

 

 

 

 

 

 

 

 
 

x   

figure    square root of the average search cost  y axis  in seconds  as a function of n
 x axis  

 

   

   

   

n    
n     
n     
n     
n     
n      
n      
n      
z     

   

   

   

   

   

   

 
   

    

   

    

   

    

 

figure    fractions of insoluble instances y axis  as a function of z  x axis  for   sat
sub problems 

them to the equivalent   sat problems  and extract the   sat sub problems  these   sat

   

fiphase transition in nk landscapes

  
z     
z     
z     
z     
z     

  

  

  

  

  

  

 

 

 

 

 

 

 

 

 

 
 

x   

figure    square root of the average search cost  y axis  in seconds  as a function of n
 x axis  for   sat sub problems 

problems are then solved by the relsat solver  if the   sat problem is unsatisfiable  then
the original nk landscape instance is also insoluble 
the experimental settings are the same as those in the experiment on the original
problem  the results are shown in figures      in parallel to the figures     of the results
on the original   sat problems in section      we see that the patterns of insoluble fractions
and search cost are similar to those we found in the original   sat problems  there is a
soluble insoluble phase transition occurring around       but the fraction of unsatisfiable
instances is lower than the fraction in the original   sat problems 
we also observed that the average search cost for the   sat sub problems remains the
same as that for the original   sat problems  this tells us that the difficulty of solving a
soluble instance of nk landscape is almost the same as that of solving a   sat problem  and
hence is easy  therefore  on average the nk landscape n  n     z  is also easy at parameters
below the threshold where almost all of the instances are soluble 

   implications and conclusions
one of the questions that arises about this work is its implications to the design and analysis of genetic algorithms  nk landscapes were initially conceived as simplified models
of evolutionary landscapes which could be tuned with respect to ruggedness and epistatic
interactions  kauffman         in the study of genetic algorithms  nk landscape models
have been used as a prototype and benchmark in the analysis of the performance of different genetic operators and the effects of different encoding methods on the algorithms

   

figao   culberson

performance  altenberg        hordijk        jones         kauffman        points out
that the parameters that primarily affect a number of ruggedness measures are n and k 
nevertheless  the fact that for k    the discrete nk landscape is np complete  wright
et al         when the neighbors are arbitrarily chosen could be construed as implying that
random landscapes with fixed k are in practice hard 
the results in this paper should serve as a cautionary note that this may not be the
case  our analyses show that for fixed k the uniform probability model is trivially solvable
as the problem size tends to infinity  for the fixed ratio model  we have derived two upper
bounds for the threshold of the solubility phase transition  and proved that the problem
with the control parameter above the upper bounds can be solved in polynomial time with
probability asymptotic to   due to the existence of easy sub problems such as   sat  a
series of experiments has also been conducted to investigate the hardness of the problem
with the control parameters around and below the threshold  from the experiments  we
have observed that the problem is also easy around and below the threshold 
our proofs hold only for the decision version of the problem where the component functions are discrete on         the proofs are obtained by noticing that the clustering of
functions  or clauses  on selected subsets of variables implies that the overall problem is
decomposable into independent subproblems  or that the problem contains small substructures that identify the solution  the subproblems are the components of the connection
graph defined in section   and the   sat sub problems studied in section      it is currently unclear to us to what extent our analysis can be extended to the optimization version
of the nk model  and we would like to study this problem further in the future 
in response to the question what are the implications for gas  we suggest the following
speculative line of enquiry  for the discrete model we use  the soluble instances are readily
solved by a standard algorithmic approach based on recognizing the components of the
connection graph   this should not be a surprise for us as it has been pointed out by
heckendorn  rana  and whitley        that even relatively old algorithms such as davisputnam which are deterministic and exact are orders of magnitude faster than gas     a
similar connectivity can be developed for real valued distributions  for example by capping
the minimum value which we allow a sub function to take  we can speculate that the
clustering imposed by fixed values of k would also generate localized structures when real
values are applied and when considering optimization instead of decision  but perhaps with
fuzzy boundaries  in fact  this observation is just the flip side of limited epistasis  genetic
algorithms  or their variants such as the probabilistic model building algorithms  larranaga
  lozano         designed to mimic natural evolution  are supposed to take advantage of
this situation  so  to the extent that nk landscapes are an accurate reflection of the
features exploited by evolutionary algorithms  we pose the following question  is it possible
to identify these fuzzy components if they exist  and in doing so design an algorithm that
exploits the same landscape features that the evolutionary algorithms do  but far more
efficiently  as we have done for the uniform discrete decision problem 
these landscapes were designed with the intent of studying limited interactions  and our
results can also be seen as a confirmation that indeed limited epistasis leads to easier problems  in another domain  that of the more traditional research into search and optimization 
   we thanks an anonymous referee for pointing out to us the work of heckendorn  et al   heckendorn
et al        

   

fiphase transition in nk landscapes

there is a need for test bed problems with real world connections which are tunable with
respect to difficulty  nk landscapes might have been such a domain for generating   sat
instances  it is disappointing that for restricted k the instances generated are easy with
high probability 

acknowledgments
this research supported in part by natural sciences and engineering research council
grant no  ogp      we thank the anonymous reviewers for their comments 

references
achlioptas  d          threshold phenomena in random graph colouring and satisfiability  ph d  thesis  department of computer science  university of toronto  toronton 
canada 
achlioptas  d          a survey of lower bounds for random   sat via differential equations 
theoretical computer science              
achlioptas  d   kirousis  l   kranakis  e   krizanc  d     molloy  m          random
constraint satisfaction  a more accurate picture  in proceedings of cp    pp     
     springer 
alon  n     spencer  j          the probabilistic method  wiley  new york 
altenberg  l          nk fitness landscapes  in back  t   fogel  d     michalewicz  z 
 eds    handbook of evolutionary computation  oxford university press  new york 
cheeseman  p   kanefsky  b     taylor  w          where the really hard problems are  in
proceedings of the   th international joint conference on artificial intelligence  pp 
        morgan kaufmann 
cook  s     mitchell  d          finding hard instances of the satisfiability problem  a
survey  in du  gu    pardalos  eds    satisfiability problem  theory and applications 
vol     of dimacs series in discrete mathematics and theoretical computer science 
american mathematical society 
culberson  j     gent  i          frozen development in graph coloring  theoretical computer science                    
dubois  o          upper bounds on the satisfiability threshold  theoretical computer
science                    
franco  j     gelder  a          a perspective on certain polynomial time solvable classes
of satisfiability  discrete applied mathematics  to appear 
franco  j     paul  m          probabilistic analysis of the davis putnam procedure for
solving satisfiability  discrete applied mathematics          
freeman  j          hard random   sat problems and the davis putman procedure  artificial
intelligence             

   

figao   culberson

friedgut  e          sharp thresholds of graph properties and the k sat problem  j  amer 
math  soc            
friedgut  e     kalai  g          every monotone graph property has a sharp threshold 
proc  amer  math  soc            
frieze  a     suen  s          analysis of two simple heuristics on a random instance of
k sat  j  of algorithm                 
gao  y          threshold phenomena in nk landscapes  masters thesis  department of
computing science  university of alberta  edmonton  alberta  canada 
gent  i   macintyre  i   prosser  p and smith  b     walsh  t          random constraint
satisfaction  flaws and structure  tech  rep  apes          apes research group 
heckendorn  r   rana  s     whitley  d          polynomial time summary statistics for a
generalization of maxsat  in gecco    proceedings of the genetic and evolutinary
computation conference  pp          morgan kaufmann 
hordijk  w          a measure of landscapes  evolutionary computation                
jones  t          evolutionary algorithms  fitness landscapes and search  ph d  thesis 
university of new mexico  albuquerque  nm 
kauffman  s          adaptation on rugged fitness landscapes  in stein  d   ed    lectures
in the sciences of complexity  santa fe institute studies in the sciences of complexity 
pp          addison wesley 
kauffman  s          the origins of order  self organization and selection in evolution 
oxford university press  inc 
kirkpatrick  s     selman  b          critical behavior in the satisfiability of random
boolean expressions  science                
kirousis  l   p kranakis  d krizanc    y stamation         approximating the unsatisfiability threshold of random formulas  random structures and algorithms         
       
larranaga  p     lozano  j          estimation of distribution algorithms  a new tool for
evolutinary computation  kluwer academic publishers  new york 
mitchell  d   selman  b     levesque  h          hard and easy distributions of sat problems 
in proceedings of the   th natl  conf on artificial intelligence  pp          aaai
press 
vandegriend  b     culberson  j          the gn m phase transition is not hard for the
hamiltonian cycle problem  journal of artificial intelligence research            
weinberger  e  d          np completeness of kauffmans nk model  a tunable rugged
fitness landscape  tech  rep             santa fe institute  santa fe 
wright  a  h   thompson  r  k     zhang  j          the computational complexity of nk
fitness functions  ieee transactions on evolutionary computation                

   

fi