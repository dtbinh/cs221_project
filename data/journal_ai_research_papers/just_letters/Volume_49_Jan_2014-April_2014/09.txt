journal of artificial intelligence research                  

submitted        published      

symmetric subgame perfect equilibria
in resource allocation
ludek cigler
boi faltings

ludek cigler epfl ch
boi faltings epfl ch

artificial intelligence laboratory
ecole polytechnique federale de lausanne
ch      lausanne  switzerland

abstract
we analyze symmetric protocols to rationally coordinate on an asymmetric  efficient
allocation in an infinitely repeated n  agent  c resource allocation problems  where the
resources are all homogeneous  bhaskar proposed one way to achieve this in   agent   resource games  agents start by symmetrically randomizing their actions  and as soon as
they each choose different actions  they start to follow a potentially asymmetric convention that prescribes their actions from then on  we extend the concept of convention
to the general case of infinitely repeated resource allocation games with n agents and c
resources  we show that for any convention  there exists a symmetric subgame perfect
equilibrium which implements it  we present two conventions  bourgeois  where agents
stick to the first allocation  and market  where agents pay for the use of resources  and
observe a global coordination signal which allows them to alternate between different allocations  we define price of anonymity of a convention as a ratio between the maximum
social payoff of any  asymmetric  strategy profile and the expected social payoff of the
subgame perfect equilibrium which implements the convention  we show that while the
price of anonymity of the bourgeois convention is infinite  the market convention decreases
this price by reducing the conflict between the agents 

   introduction
in many situations  agents have to coordinate their use of some resource  one wireless channel can only be used by one device  one parking slot may only be occupied by one vehicle 
etc  the problem is that often  the agents have identical preferences  everyone prefers to
access rather than yield  similarly  everyone prefers to have a parking slot rather than leave
their car at home  however  if multiple agents try to use one resource simultaneously  they
collide and everyone loses 
consider a simple example  two agents want to access a single resource  we can describe
the problem as a game  both agents have two actions  yield  y   and access  a   if agent
 yields  it gets a payoff of    when agent  accesses the resource while the other agent
yields  it gets a payoff of    but if both agents access the resource at the same time  they
both incur a cost      
the normal form of such a game looks as follows 

y
a
c
    
ai access foundation  all rights reserved 

y
    
    

a
    
  

ficigler   faltings

this is a symmetric game  but the two efficient nash equilibria  ne  are asymmetric 
either one agent yields and the other one accesses the resource  or vice versa  the only
symmetric equilibrium outcome is the mixed ne where both agents access the resource
 
with probability pr a         
  however  this mixed equilibrium is not efficient  because
the expected payoff of both agents is   
asymmetric equilibria of symmetric games are undesirable for two reasons  first  they
are not fair  in our example  only one agent can access the resource  second  coordinating
on an asymmetric equilibrium is difficult  imagine that the agents are all identical and
anonymous  i e  they cannot observe their own identity  nor the identity of any other agent 
we cannot prescribe a different strategy for each of the agents  agents in some peer to peer
file sharing networks are assumed to be anonymous  chothia   chatzikokolakis         as
well as agents in some wireless sensor networks  durresi  paruchuri  durresi    barolli 
      
consider the following example  millions of wireless sensors are produced all by the
same pipeline  we take two of them randomly  and put them in a room  there is only one
frequency on which the sensors can transmit their measurements  how can each sensor know
when to transmit and when to stay quiet  the factory could program half of the sensors
to transmit in odd slots  and the other half to transmit in the even slots  nevertheless  it
would be just as likely to have an odd even pair of sensors  as it would be to have a pair
where the sensors transmit at the same time 
aumann        proposed the notion of correlated equilibria which fixes some of our issues
with the nash equilibria in the resource allocation game above  a correlated equilibrium
 ce  is a probability distribution over the joint strategy profiles in the game  a correlation
device samples this distribution and recommends an action for each agent to play  the
probability distribution is a ce if agents do not have an incentive to deviate from the
recommended action  the correlation device takes away the burden of coordination from
the anonymous agents  they can all follow the same strategy  do what the correlation
device has told me 
what if such smart correlation device  which can send each agent a different private
signal  is not available  can we still reach a correlated equilibrium outcome  one in which
anonymous agents can play identical strategies  and yet achieve an efficient and fair allocation  in our previous work  cigler   faltings         we have proposed an algorithm
that allows agents to learn a correlated equilibrium outcome through repeated play  we
considered a special case of a resource allocation problem  we proposed to use a global
coordination signal and multi agent learning to reach a symmetric  fair and efficient outcome  wang et al         later implemented this approach in an actual wireless network
and achieved throughput   higher than standard aloha protocols  
how does the coordination signal from our previous work  cigler   faltings        differ
from the smart correlation device assumed by aumann         firstly  it is public and
cannot send private signals to the agents  such private signals are necessary for anonymous
agents to implement the desirable correlated equilibrium in a single stage resource allocation
game  the anonymous agents all have to follow the same strategy for each given public signal
value  secondly  the coordination signal is not specific to the game  the only requirement
is that it is ergodic  i e  it regularly sends each of its possible values  an example of such
   

fisymmetric subgame perfect equilibria in resource allocation

signal is the day of the week  the decimal value of a price of a certain stock  or even a noise
on some frequency 
however  our previous solution had a major limitation  the learning algorithm itself was
not an equilibrium of the repeated game  a selfish agent could force everyone else to yield
by accessing all the time  securing the resource for herself  therefore  in this paper  we focus
on learning algorithms which are themselves equilibria of the repeated game  we propose a
distributed algorithm to find an allocation of a set of resources which is not only symmetric
and fair  but also an equilibrium  we draw inspiration from the works of bhaskar       
and kuzmics  palfrey  and rogers        on symmetric equilibria for symmetric repeated
games 
assume that agents play an infinitely repeated game  and they discount future payoffs
with a common discount factor           a strategy for an agent is a mapping from
any history of the play to a probability distribution over the actions  our goal is to find a
symmetric subgame perfect equilibrium  a subgame perfect equilibrium is a strategy profile
 vector of strategies for every agent  which is a ne in any history  including those that
cannot occur on the equilibrium path 
the symmetric subgame perfect equilibria that we study have the following form  the
agents start by choosing their actions randomly  all according to a given probability distribution  as soon as they play an  asymmetric  pure strategy nash equilibrium of the
game  they adopt a convention  that prescribes their actions deterministically from then
on  bhaskar        gives two examples of conventions for symmetric   agent    action
games 
bourgeois agents keep using the action they played in the last round 
egalitarian agents play the action of their opponent from the last round 
in this paper  we extend the notion of convention to arbitrary resource allocation problems with n agents and c homogeneous resources  and we show that for any convention 
there exists a symmetric subgame perfect equilibrium that reaches this convention  we give
a closed form expression to calculate the subgame perfect equilibrium for the bourgeois convention  and show that for a small number of resources c  this convention leads to zero
expected payoff  this means that the price of anonymity of the bourgeois convention is  
we present the market convention as a generalization of the egalitarian convention of
bhaskar         the main idea is that    agents pay a price for each successful access
of a resource  and    before each round of the game  they observe a global coordination
signal k              k   based on which they decide whether and which resource they access 
the agents have a decreasing marginal utility from accessing more often  the price helps
to decrease the demand for the resources  while the global coordination signal effectively
increases the capacity k times  we show that compared to the bourgeois convention  the
market convention improves the expected payoff  its price of anonymity is therefore finite 
this paper is structured as follows  in section    we review some basic notions from game
theory  and we present the general definitions of conventions and their implementations  in
section    we formally define the resource allocation game of n players and c resources  and
show that for any convention  there exists a symmetric subgame perfect equilibrium which
implements it  in section   we present two concrete examples of a convention  bourgeois and
   

ficigler   faltings

market conventions and discuss their properties  in section   we discuss the relationship of
this work to the work on folk theorems in game theory  finally  section   concludes 

   preliminaries
in this section  we will first introduce some basic concepts of game theory that we are going
to use throughout the paper  then  we will define the notion of price of anonymity  finally 
we will give the general definition of a convention and its implementation 
    game theory
game theory is the study of interactions among independent  self interested agents  an
agent who participates in a game is called a player  each player has a utility function
associated with each state of the world  self interested players take actions so as to achieve
a state of the world that maximizes their utility  game theory studies and attempts to
predict the behaviour  as well as the final outcome of such interactions  leyton brown and
shoham        give a more complete introduction to game theory 
the basic way to represent a strategic interaction  game  is using the so called normal
form 
definition     normal form game  a finite  n  person normal form game is a tuple
g    n  a  u   where
 n is a set of n players 
 a   a   a          an   where ai is a set of actions available to player i  each vector
a    a    a            an    a is called an action profile 
 u    u    u            un    where ui   a  r is a utility function for player i that assigns
each action vector a certain utility  payoff  
in this paper  we will be studying symmetric games  in such games  the players are
anonymous  and the only thing that influences the outcome is the number of agents who
took a certain action 
definition     symmetric game  we say that a normal form game g    n  a  u  is a
symmetric game  if for any permutation of the vector of players    n  n  it holds that
for any strategy vector                     n   and any i  n 
ui                  n     u i                        n     
besides playing a single deterministic action  the player can also choose her action
randomly from a certain probability distribution 
definition     mixed strategy  a mixed strategy selects a probability distribution over
the entire action space  i e  i   ai    a mixed strategy profile is a vector of mixed
strategies for each player  for a mixed strategy i   we define its support supp i   as
supp i      ai  ai   i  ai         
   

fisymmetric subgame perfect equilibria in resource allocation

given a game specified using its normal form  how should the players choose their
strategy  when players know the strategies of the others  they can choose their action
quite easily  just pick the strategy that maximizes the payoff given what everyone else is
playing 
definition     best response  we say that a mixed strategy i of player i is a best
response to the strategy profile of the opponents i if for any strategy i   
ui  i   i    ui  i    i   
as we mentioned earlier  one of the basic goals of game theory is to predict an outcome
of a strategic interaction  such outcome should be stable  therefore  it is usually called
an equilibrium  one requirement for an outcome to be an equilibrium is that none of the
players has an incentive to change their strategy  i e  all players play their best response to
the strategies of the others  this defines perhaps the most important equilibrium concept 
the nash equilibrium 
definition     nash equilibrium  a strategy profile                     n   is a nash
equilibrium  ne  if for every player i  her strategy i is a best response to the strategies
of the others i  
correlated equilibrium extends the notion of nash equilibrium  in the canonical interpretation  it assumes that there is a central correlation device which samples the space of
possible outcomes of the game according to some probability distribution  and then recommends an action to play to each player  no player has an incentive to deviate from the
recommended action  the formal definition is as follows 
definition     correlated equilibrium  given an n  player game g    n  a  u   a
correlated equilibrium is a tuple  v       where v is a tuple of random variables v  
 v    v            vn   with domains d    d    d            dn     is a joint probability distribution
over v                      n   is a vector of mappings i   di   ai   and for each player i and
every mapping  i   di   ai it is the case that
x

 d ui     d        d             n  dn    

dd

x


 d ui     d         d              n  dn    

dd

in an equilibrium  each agent chooses the best strategy for himself  oftentimes  the end
result is not the best for the agents as a whole  to analyze the overall utility of a game
outcome to all of the agents  we define its social payoff 
definition     social payoff   for a  mixed  strategy p
vector                  n    we define
its social payoff as the sum of utilities of all the players  n
i   ui                  n   
    repeated game
in a repeated game  the same players play a given game  for example specified by its normal
form  repeatedly  we call the normal form game that is being played in each round the
stage game 
   

ficigler   faltings

   

   

definition     future discounted payoff   given an infinite sequence of payoffs ri   ri        
for player i and a discount factor             the future discounted payoff of player i is
ei   


x

 j 

 j ri  

j  

definition     infinitely repeated game  let g    n  a  u  be a normal form game 
an infinitely repeated version g of the game g with discounting is a game where the players
play the normal form game g for an infinite number of rounds  the payoff of player i in
game g is defined as its future discounted reward ri    
in this paper  we will study symmetric equilibria of an extended version of the repeated
game  so called augmented game  we assume that in every round of the game  the players
can observe a common coordination signal  on which they can condition what strategy
they will use  in general  this coordination signal is just a random integer taken from set
               k      in practice  it can be any piece of information observable by everyone 
price of a certain stock at a given time  temperature in the room  day of the week  etc 
such a signal will allow agents to coordinate more efficiently  while at the same time it is
more realistic than a general correlation device which recommends actions to the agents  as
is assumed in the definition of correlated equilibria 
definition      augmented repeated game  let g    n  a  u  be a normal form
game  let k                   k     be a set of coordination signals  an augmented infinitely
repeated version g of the game g with discounting is a game where players play the normal
form game g for an infinite number of rounds  in each round t  the players observe a
coordination signal kt  k  the coordination signal is chosen from a uniform distribution
over k  the players discount future payoff with a discount factor  
w l o g   we always assume that repeated games are augmented  since in an ordinary
repeated game  we can just assume that there is only one coordination signal  therefore  in
the rest of the paper  whenever we refer to a repeated game or its strategy etc   we always
assume that the game is augmented with a coordination signal 
definition      history of a repeated game  let g be an infinitely repeated game
with discounting  we define the history ht of the play in round t    as

t 
t 
ht      a     a             a n    k               at 
    a            an    kt   
where ati is the action taken by player i in round t  and kt is the signal that the players
observe in round t 
definition      strategy of a repeated game  a strategy in the repeated game of a
player i is a function i from the history ht and a currently observed coordination signal kt
to a probability distribution over the action space 
i    ht   kt      ai   
we can define the nash equilibrium of the repeated game in the same way as for the
stage game  we can treat the repeated game as if it was just a normal form game where
players commit to their strategy for the entire game up front  
   

fisymmetric subgame perfect equilibria in resource allocation

definition      nash equilibrium of a repeated game  a strategy profile   
                 n   is a nash equilibrium of the infinitely repeated game if for each player
i 
ei  i   i    ei   i   i  
   
for any alternative strategy of the repeated game  i   here ei   i   i    ht   kt   is the future
discounted payoff of player i when she adopts strategy i and the other players adopt a
strategy vector i  
in the following text  we will use the notion of future discounted social payoff 
definition      future discounted social payoff   given a strategy profile  of the
infinitely repeated game g  the future discounted social payoff is defined as
e     

n
x

ei    

   

i  

for the repeated games  there exists a stronger notion of equilibria  which is a refinement
of the standard nash equilibrium definition 
definition      subgame perfect equilibrium  let g be an infinitely repeated game
with a discount factor           a strategy vector                     n   is a subgame perfect
equilibrium of the game g if for each player i 
ei   i   i    ht   kt    ei    i   i    ht   kt  
for any strategy  i   history ht and coordination signal kt  
in the subgame perfect equilibrium  players play a best response strategy given any
history of the play  including the histories which cannot occur if they follow the equilibrium
strategy from the beginning  the notion of subgame perfect equilibria eliminates this way
non credible threats  or equilibria in which a player threatens someone else with a strategy
which the player might be prefer to avoid if it was supposed to be executed 
    price of anonymity
in section    we have seen that in the simple resource allocation game  the symmetric
equilibrium leads to a significantly lower payoff than the asymmetric equilibria  symmetry
of the equilibria is a natural requirement when players are all the same  i e  anonymous 
how much social payoff do we have to sacrifice for the requirement of symmetry  inspired
by the price of anarchy of koutsoupias and papadimitriou         we propose the price
of anonymity as a measure of how efficient a given symmetric strategy vector is  the term
price of anonymity was used previously in a different context by bonnet   raynal        
for a given symmetric strategy vector of the stage game   we calculate the ratio between
the social payoff of the most efficient  potentially asymmetric  nash equilibrium of the
game  and the social payoff of strategy vector   the formal definition is as follows 
   

ficigler   faltings

definition      price of anonymity of a nash equilibrium  let g be a symmetric
game  let                     n   be a symmetric nash equilibrium  that is i  j   i   j   
and let  be a  mixed  nash equilibrium of the game g with the maximum social payoff 
we define the price of anonymity of strategy vector  as follows 
rg      

e   
 
e  

definition      price of anonymity of a stage game  let g be a symmetric game 
   be a symmetric nash equilibrium with minimal social payoff  and
let                      n
let  be a  mixed  nash equilibrium of the game g with the maximum social payoff  we
define the price of anonymity of the game g as follows 
rg   

e   
 
e    

for infinitely repeated games  we define the price of anonymity for their subgame perfect
equilibria 
definition      price of anonymity of a repeated game  let g be a symmetric game 
let                     n   be a symmetric subgame perfect equilibrium with minimal social
payoff  and let  be a subgame perfect equilibrium of the game g with the maximum social
payoff  we define the price of anonymity of the game g as follows 
rg   

e  
 
e   

    conventions and implementations
as we have shown for the example of the   agent    resource allocation game in section   
there exist symmetric games that have nevertheless only asymmetric efficient equilibria  if
we allow for a central coordination device  the agents can play a symmetric and efficient
correlated equilibrium that selects randomly from the set of efficient nash equilibria  without such a device  in the stage game  there is no way to reach a symmetric efficient outcome
in an equilibrium 
however  if the agents play the game repeatedly  they can use the history of the play
to condition their strategy  if two agents have different histories  they can take different
actions in the future  in the first round of the game though  the history is empty for
everyone  therefore  a symmetric strategy for the players has to randomize in order to ever
reach a point when the histories of the agents are distinct 
bhaskar        considered the problem of playing asymmetric outcomes of the stage
game using a symmetric strategy of the repeated game  his work considers games with  
players and   actions  such as the   resource allocation game  the idea is that the two players start by playing randomly  using the same probability distribution over actions  they
randomize until they reach a round t where they happen to play some pure strategy nash
equilibrium  that is  they take a different action each   we call this round the asynchrony
round  then  the agents start following a so called convention  a convention maps the
asymmetric pure strategy nash equilibrium to a  potentially asymmetric  strategy vector
that the agents then adopt 
   

fisymmetric subgame perfect equilibria in resource allocation

we have already mentioned the two basic conventions proposed by bhaskar         the
bourgeois and egalitarian convention  in the   resource allocation game  in the asynchrony
round  one agent chooses action a and the other one chooses y   we will call the agent who
chose a in the asynchrony round the winner  the other agent is the loser  the bourgeois
convention guarantees that the agents will keep playing this ne forever after  this way 
the winner will be forever guaranteed a higher payoff than the loser  in the egalitarian
convention  the players alternate between the two pure strategy nash equilibria  that way
the payoffs of the winner and a loser will be closer 
in the infinitely repeated game with discounting  the social payoff will depend on two
things  the discount factor   and the probability of a collision  that is the probability that
the players both play action a  when there is a big difference between the winner and loser
payoff  the losers will fight back harder  so they will play their most preferred action a
with higher probability  this will increase the probability of a collision  in the egalitarian
convention  the payoffs to the loser are closer to the winner  therefore  the agents will
collide less often  and they will also reach the asynchrony faster 
as another example of a convention  kuzmics et al         analyze the nash demand
game  the nash demand game is a game of n players who choose between n actions
labeled            n   if all the players choose a distinct action  each player receives a payoff
equal to the label of her chosen action  if there are any two players who chose the same
action  every player  including those who chose an action alone  receives zero payoff  in a
pure strategy nash equilibrium  all the players choose a different action  naturally  each
player prefers the equilibrium where she is the one who chose action n  
in the nash demand game  we can also define bourgeois and egalitarian conventions 
kuzmics et al         define three notions of payoff symmetry 
ex ante all agents have the same expected payoffs before the game starts 
ex post all agents have the same expected payoffs when asynchrony occurs  regardless of
who was the winner  
strong ex post all agents have the same payoff along any realization of the play 
the bourgeois convention is only ex ante payoff symmetric  since once asynchrony occurs  the winner gets a higher payoff than the loser  the egalitarian convention is strong
ex post payoff symmetric  in fact  kuzmics et al         show that in the nash demand
game  if a convention is socially efficient  it must be strong ex post payoff symmetric  the
intuition is that in order to maximize social efficiency  we want to reach asynchrony as fast
as possible  this is only possible if agents choose their actions uniformly at random  they
will only do that if they are indifferent between which action they choose at the moment
asynchrony occurs 
we will now formally define the convention for an augmented repeated game of n agents 
definition      convention  let g    n   a  u 
and let g be the repeated version of game g  we
that maps a vector of pure strategy nash equilibria
a    a    a            ak   to a vector of strategies of the
   

be a symmetric normal form game
define a convention as a function 
of the game g for each signal value
repeated game g  such that for any

ficigler   faltings

permutation    n  n of the set of players 
   a              ak         a    a            ak   

   

that is  the convention of a permutation is a permutation of a convention  here i denotes
the strategy for player i   the strategies can be different for each coordination signal value 

we use the notation  a     a              a n     and   a           a            n    a  to
denote the permutation of the history vector using   and the permutation of the strategy
vectors respectively 
our definition of convention generalizes the definition bhaskar        gave for symmetric
games of   players and two actions     bhaskar defined a convention as a mapping from
a set of nash equilibrium action profiles              to a set of strategies in which the
players alternate the strategy profiles      and      in some order  in our definition  a
convention maps any nash equilibrium of the stage game to any strategy profile  provided
that it satisfies the permutation condition 
intuitively  a convention prescribes each agent a potentially different role  the problem
for anonymous agents is to learn their role  we will call the learning algorithm they will
use an implementation of a convention 
definition      implementation  let g be an infinitely repeated game  and let  be a
convention defined for this game  an implementation  of a convention  is a strategy
vector of the infinitely repeated game  that is a function that assigns
    ht   kt      a             an   
and that satisfies the following conditions 
let ht be the history of the game at time t 
   if the players have already played some pure strategy nash equilibrium for all coordination signals k  k in some round t    t  t  is the round in which they played
the ne for the last signal   follow the strategy prescribed by the convention  for the
history ht   ht   that is  the history from round t      onwards  
   otherwise  let kt be the signal observed in the current round  and let vector a  
 a    a            ak   such that ak is the action vector from the last round when the signal
k was observed  if signal k was not observed yet  we define ak      then  the actions
of the players in the current round t only depend on vector a  abusing the notation 
we can write   ht   kt       a  kt     and for any permutation                   n   
               n   

      a   kt             n   a   kt            a  kt              n    a  kt    
that is the strategy for the current round only depends on the actions a played in the
last round each signal was observed  and on the current coordination signal 
in section    we will be concerned with equilibrium strategies for the resource allocation
game  that is  we will look at its symmetric subgame perfect equilibria  to construct
such equilibria  we define the concepts of an equilibrium convention  and its equilibrium
implementation 
   

fisymmetric subgame perfect equilibria in resource allocation

definition      equilibrium convention  let g be an infinitely repeated game  and let
 be some convention  we say that the convention  is an equilibrium convention when for
every vector of pure strategy nash equilibria a    a            ak     a  is a vector of subgameperfect equilibria of the game g 
definition      equilibrium implementation  let g be an infinitely repeated game  
some equilibrium convention  and  an implementation of convention   we say that  is
an equilibrium implementation if it is a subgame perfect equilibrium 

   resource allocation game
in this section  we will first formally define the resource allocation game  and discuss its
nash equilibria  we will then show that for any equilibrium convention of the resource
allocation game  there exists an equilibrium implementation 
    definitions
we will first define the resource allocation game  and restricted notions of uniform convention and uniform implementation 
definition      resource allocation game  a resource allocation game gn c is a game
of n agents  each agent i can access one of c identical resources  the agent chooses its
action ai from ai    y  a    a            ac    where action ai   y means to yield  and action
ai   ac means to access resource c  because all resources are identical  we can define a
special meta action ai   a  to take action a means to choose to access  and then to choose
the resource uniformly at random from the set of available resources 
the payoff function for agent i is defined as follows 

 
if ai   y



 
if ai    y 
ui  a            ai           an     
   
j
   i  aj    ai



     otherwise
this game has a set of pure strategy nes where c agents each access a resource ci and
n  c agents do not  there is also a symmetric mixed strategy ne in which each agent
decides to play action a with probability
s
 
   
  
pr ai         min c     n  
    
   
      
note that for high enough values of c  all agents will always choose to access   
since we assume that the resources are identical  when the agents start following a
convention  their expected future payoff shouldnt depend on which resource they have
   the resource allocation game as defined here is an instance of a class of games known as potential games
 monderer   shapley         in an  exact  potential game  there exists a potential function    a  r
  
such that ai  ai   a i   ai  ai  
 a i   ai     a  i   ai     ui  a i   ai    ui  a  i   ai   

   

ficigler   faltings

accessed in the nash equilibrium  we will therefore restrict ourselves to so called uniform
conventions 
definition      uniform convention  let gn c be a resource allocation game  and gn c
its infinitely repeated version  let  be a convention  we say that the convention  is a
uniform convention  if the following holds  let a    a    a            ak   be a vector of purestrategy nash equilibria for each coordination signal  let for each player i  ci the number
of signals for which player i accesses some resource in action vector a  then
i  j   ci   cj   ei   a     ej   a   
that is  if the number of signals for which the two players access some resource is the
same  their expected payoff in the remainder of the game has to be the same too 
definition      losers  winners  claimed and unclaimed resources  let gn c be
an infinitely repeated resource allocation game  let ht be the history of play in round t  and
let ak    ak    ak            akn   be the action vector played in the last round when signal k was
observed 
 player i is a winner for signal k if aki   ai and for all other players j    i  akj    ai  
 player i is a loser for signal k otherwise 
 resource c is claimed for signal k  if there exists exactly one player i such that aki   ac  
 resource c is unclaimed for signal k otherwise 
if signal k was never observed before  all the players are losers and all the resources are
unclaimed for signal k 
definition      uniform implementation  let gn c be an infinitely repeated resource
allocation game  let  be some uniform convention  a uniform implementation  is defined
as follows  let ht be the history of the game at time t  let kt be the signal observed in the
current round 
   if the players have already played some pure strategy nash equilibrium for all coordination signals follow the strategy prescribed by the convention  
   otherwise  let n be the number of losers for signal kt   and let c be the number of
unclaimed resources for signal k  the strategy prescribed by implementation  in
round t is then the following 
for an action vector a such that there are co occupied resources  and na agents who access some resource 
the exact potential function of the resource allocation game is
 a     co      na  co   
exact potential games are also referred to as congestion games  rosenthal         finite versions
of such games are always guaranteed to have a pure strategy nash equilibrium  moreover  agents can
reach a pure strategy nash equilibrium by starting from an arbitrary action vector a  and iteratively
playing best response action  one by one  when the players are anonymous and update their strategies
simultaneously  as we study in this paper  this doesnt hold  hence  the theory of potential games cannot
be applied to the scenario we study in this paper 

   

fisymmetric subgame perfect equilibria in resource allocation

agents follow implementation 

asynchrony

initial state

agents follow
convention 

n  
c  

n  
c  

n  
c  

n  
c  

figure    learning to play a convention in a resource allocation game with n     agents
and c     resources  under each state  we denote the number of losers in the
current state n  and the number of unclaimed resources c  winners are denoted
as black circles  losers as light grey circles  in the asynchrony state  there are
  winners and one loser  arrows indicate the possible transitions between the
states  once the players reach the asynchrony state  they start following the
convention from the next round on 

 if player i is a winner for signal kt   she will access the same resource as she did
the last time signal kt was observed 
 if player i is a loser  she will access choose to access an unclaimed resource r
p
with probability     n c 
    the probability of accessing a claimed resource
c
is zero 
in the remainder of this section  instead of studying general strategies for the repeated
game  we will limit ourselves to strategies which are a uniform implementation 
figure   shows how the agents learn to follow a convention when n     and c     
assume that the players adopt a convention   and they use its implementation   initially 
they are all losers  and the implementation prescribes the same strategy to all of them 
once an agent accesses some resource alone  she becomes a winner and will access the same
resource until the agents reach an asynchrony round  a state where each resource is accessed
by exactly one agent  
definition      expected payoff functions ea and ey   let gn c be an infinitely
repeated resource allocation game  let  be some uniform convention and  its equilibrium
implementation  let ht be the history of the game in round t  such that some k  k  the
nash equilibrium has not been reached  and so the convention has not been activated yet  
let nk the number of losers for signal k  k and ck the number of unclaimed resources
for signal k  k  let p    pn   c            pnk  ck   be the access probability of the losers for
   

ficigler   faltings

each signal k  k  let kt be the currently observed coordination signal  let w  nw   be the
expected payoff of a new winner  player who was a loser in previous rounds and becomes
winner in round t  given that there are nw new winners in round t  let l  nw   be the
expected payoff of a player who stays a loser  when there are nw new winners in round t 
assume that player  is a loser for signal kt   we define her expected payoff functions ea
and ey when she takes action a  or y   for signal kt   and adopts the strategy prescribed
by the implementation  for other signals 
ea  p  kt     
min n c 

x

 pr  wins   nw winners a w  nw     pr  loses   nw winners a     l  nw    

nw   







k
x


 



  pr   winners a     
e
 p 
k 
 
 p
e
 p 
l 
 
  

p
 e
 p 
l  
n
 c
n
 c
a
a
y
l
l
l
l

k
l  
l  k

   
min n c 

ey  p  k    

x

pr nw winners y    l  nw  

nw   





k
x

 
ey  p  k   
 pnl  cl ea  p  l        pnl  cl  ey  p  l  
  pr   winners y   


k

   

l  
l  k

    existence of an equilibrium implementation
we are now ready to prove that for any uniform equilibrium convention  there exists its
equilibrium implementation 
lemma    for any signal k  k  the functions ea and ey are continuous in p  h    ik  
proof  the probabilities pr nw winners a  and pr nw winners y   are continuous  the
functions ea and ey are sums of products of continuous functions  so they must be themselves continuous 
lemma    functions ea and ey are well defined for any k  k and p  h    ik  
proof  for fixed p   and   the functions ea and ey define a system of  k linear equations 
we can write this system as  i  a e   b  where e    ea             ea k   ey             ey k   is
a vector of variables corresponding to the payoff functions  b  r k and i is  k   k unit
matrix  the matrix a is defined as follows  the first k rows correspond to variables ea k
and the second k rows correspond to variables ey k  
the elements in row k corresponding to ea k are defined as 

for l   k
pr   winners a  pnk  ck    k



 
for l   k   k
ak l   

pr  
winners a 
p
 


p
for l  k  l    k

nk  ck
nl  cl

k


pr   winners a  pnk  ck    k      pnl  cl   for k   l   k  l    k   k
   

fisymmetric subgame perfect equilibria in resource allocation

the elements in row k   k corresponding to ey k are defined as 

ak k l


pr   winners y  pnk  ck   



 
  
pr  
winners y  pnk  ck   



pr   winners y  pnk  ck   


k

k

k

for
for
for
 pnl  cl
     pnl  cl   for

l  k  k
l k
l  k  l    k
k   l   k  l    k   k

this system of equations has a unique solution if the matrix a is non singular  this is
equivalent to saying that det a       
pk
the matrix a is diagonally dominant  that is aii  
j   j  i  aij    this is because
p k
          and the rows of the matrix a sum to l   ak l     pr   winners a  pnk  ck   for
p
    k  k  and  k
l   ak k l     pr   winners y  pnk  ck   for k   k   k   k 
it is known that diagonally dominant matrices are non singular  taussky         therefore  a unique solution e of the system exists and the functions ea   ey are well defined for
a fixed p   and  
lemma    there exists p such that for any k  k  one of the following is true 
   pk     and ey  p   k    ea  p   k  
   pk     and ea  p   k    ey  p   k  
       pk     and ea  p   k    ey  p   k  
such p defines a symmetric best response strategy for the losers 
proof  fix  and   we will show that for an arbitrary p and every signal k  k  there
exists p k which satisfies one of the three conditions of the lemma   above 
for contradiction  assume that for p k      ey  p    k   ea  p    k  and for p k     
ea  p    k   ey  p    k   then from the fact that both functions ea and ey are well defined
and continuous for    pk     they must intersect for some     p k     
from this  there must exist a vector p where for all k  k  the conditions of the
lemma   are satisfied 
corollary    let gn c be an infinitely repeated resource allocation game  for any uniform
equilibrium convention  of the game gn c   there exists an equilibrium implementation   
to illustrate the different equilibrium payoffs agents can get when they adopt different
conventions  consider the resource allocation game with n     agents and c      to
simplify the presentation  assume that k       assume that before round t  the resource
has been claimed yet  so there are n     losers and c     unclaimed resource  if some
agent becomes a winner in round t  the agents adopt an extended uniform convention that
prescribes their strategies from then on 
for comparison  assume that the agents can adopt either a convention     or a convention

    if they adopt convention     the winners have an expected payoff w       and the losers
an expected payoff l      on the other hand  if they adopt convention     the winners
 

have an expected payoff w       and the losers an expected payoff l      
   

ficigler   faltings

 a  convention  

 b  convention  

figure    example of expected payoff functions for resource allocation game with n    
agents  c     resources  cost of collision      and discount factor        
  and e   are expected payoff
given the access probability p  the function ea
y
functions of accessing and yielding  when the agents use an extended convention
  and e   are expected payoff functions when the agents use an
    similarly  ea
y
extended convention     convention   has an expected winner payoff w      
and expected loser payoff l      convention   has an expected winner payoff
 

w      and expected loser payoff l      
in the equilibrium implementation   of the convention     the agents access
the resource with probability p    and their expected payoff is e       in the
equilibrium implementation   of the convention     the agents access the resource
with probability p    p    and their expected payoff is e    e      

  and e   for the convention    and e  
figure   shows the expected payoff functions  ea
 
y
a
 

and ey for the convention      depending on the access probability p  we can see that the
equilibrium implementation payoff e  of the convention   is higher than the equilibrium
payoff e  of the convention     even though the sum of the winner and loser payoffs is higher
for convention     this is because the loser receives a positive payoff when the agents adopt
a convention     the agents are less likely to fight to become a winner  and they access
the resource with a lower probability p    p    this way  there will be less collisions  and
the agents will receive a higher expected social payoff when they adopt the convention    

    calculating the equilibrium
while the symmetric subgame perfect equilibrium is guaranteed to exist  in order to actually
play it  the agents need to be able to calculate it  it is not always possible to obtain the
   

fisymmetric subgame perfect equilibria in resource allocation

closed form of the probability of accessing a resource  therefore  we will show how to
calculate the equilibrium strategy numerically 
let p be a probability vector and k a signal  let p      p    p            pk              pk    i e 
vector p with pk set to    let p      p    p            pk              pk    from lemma   we know
that either ey  p    k    ea  p    k   or ea  p    k    ey  p    k  or the two functions intersect
for some    pk     furthermore  we know that ea  p    k    w  c  since the probability
of successfully claiming a resource is   when everyone else yields  and also ey  p    k      
therefore  ey  p    k    ea  p    k  iff w  c      
w l o g  we will assume that w  c       algorithm   shows then how to calculate the
probability vector 
algorithm   calculating the equilibrium probabilities
for each subset s                 k  do
let  be a system of equations
i 
  s   contains two equations for e p  i   one corresponding to ea  p  i   one to
ey  p  i   see equations   and    
j  s  we set pj        contains only one equation for e p  j   corresponding to
ea  p  j  
so  is a system of  k   s  equations with  k   s  variables 
solve numerically the system of equations  
if there exists a solution to  for which i 
  s     pi    then
we have found a solution
break 
end if
end for
the numerical algorithm has a complexity exponential in k  and is therefore only suitable for small k  in section        we will show conditions under which the access probabilities are easy to compute and define a  equilibrium of the repeated game  that is  no
agent can gain more than  factor more by deviating from the prescribed strategy 

   actual conventions
in the previous section  we have shown that we can find a symmetric way to reach any
convention  provided the agents access the resources with a certain probability  we have
also shown how to calculate the resource access probability in every stage of the game  in
this section  we would like to show specific examples of the conventions that agents can
adopt  and discuss their properties 
    bourgeois convention
the bourgeois convention is the simplest one  once an agent has accessed a resource
successfully for the first time  he will keep accessing it forever  we say that the agent has
claimed the resource  we dont need any coordination signal to implement it  so we can set
k      
   

ficigler   faltings

we will describe the decision problem from the point of view of agent   assume that
there are n agents and c resources  at round t  let ct be the number of resources which
have not been claimed yet  and nt    n c  ct the number of players who have not claimed
a resource yet  assume that other players besides  use the following strategy 
 if a player has claimed a resource previously  she will keep accessing it 
 if a player hasnt claimed any resource yet  she is a loser   she will choose to access
with probability pct and then choose the actual resource to access uniformly at random 
definition      expected payoff function of the bourgeois convention  let p   
 p    p            pc   be a probability vector  such that pc is the probability with which any of
the losers will access when there are c unclaimed resources  we define the expected payoff
function to player  should she choose to access  play a  that is choose to access and then
choose the resource uniformly at random  or yield  play y    respectively 



p n 
 
p n 
ea  p  c       

     
   
c
 
c
c
x
pr  loses and nw   l a   e p  c  l  
 


l  

ey  p  c      

c
x

pr nw   l y    e p  c  l  

l  

in both equations  e p  c    max  ea  p  c   ey  p  c   
lemma    for any p and    c  c  e p  c     
proof  no matter what is the strategy of the opponents  if agent  chooses to always yield 
its payoff will be   
lemma    let p be a probability vector which defines the strategies of the other losers  and
let ct be the number of unclaimed resources in round t  if c  ct   ea  p  c    ey  p  c  
then c  ct   e p  c      
proof  when there are ct unclaimed resources in round t  in every following round t   t
there will be c  ct unclaimed resources  in bourgeois convention  agents never release
claimed resources   if the agent  is indifferent between actions y and a in every round
following round t  that means that it is indifferent between a strategy of the subgame that
prescribes y in every round and any other strategy  the  expected  payoff of the strategy
that prescribes always y is    therefore  the expected payoff of any other subgame strategy
must be   as well 
for the purpose of our problem  all the unclaimed resources are identical  therefore the
only parameter of the losers strategy is the probability with which the agents decide to
access  the resource itself is then chosen uniformly at random  lemma   shows a necessary
condition on p for agent  to be indifferent  the following lemma shows that such p exists
and is unique 
   

fisymmetric subgame perfect equilibria in resource allocation

lemma    assumeat timer
t there are
 ct unclaimed resources  let for all c  ct unclaimed
  
resources be pc   c    n       
the probability with which the losers play a  then
 

for all c  ct unclaimed resources  agent  is indifferent between yielding and accessing 
for a given c  such probability is unique on the interval     c  
proof  from lemma   we know that when agent  is indifferent  i e  ea  p  c    ey  p  c   
it must be that e p  c      for all    c  ct  
from definition     the expected profit to agent  from playing a and then following
best response strategy  with zero payoff  is




pc n 
 
pc n 
ea  p  c      

     
   
c
 
c
   
    pr  loses and nw     a   e p  c  
here pc is the probability with which the other losers access  we want ea  p  c   
ey  p  c       this holds if pc is defined as in the lemma above 
function ea is decreasing in pc on the interval     c   while function ey is constantly   
therefore  their intersection is unique on an interval     c  
lemma    assume that all the opponents who havent claimed any resource access a resource with probability p   pc   then it is best response for agent  to access 
proof  the probability that agent  claims successfully a resource after playing a is

p n 
pr claim some resource a       
   
c
this probability increases as p decreases  therefore the expected profit of playing a is
increasing as p decreases  whereas the profit of playing y stays   
theorem    define an agents strategy  as follows  if there are c unclaimed resources 
play a with probability pc    min     pc    where pc is defined in lemma     then a joint
strategy profile                     n   where c  c    is a subgame perfect equilibrium of the
infinitely repeated resource allocation game 
proof  from lemma    if pc      any agent is indifferent between playing y and playing a 
therefore will happily follow strategy    from lemma    if pc       pc   it is best response
for any agent to play a  just as the strategy  prescribes 
theorem    for all c  n  if pc   pc   e p  c      
proof  we will proceed by induction 
for c      the expected payoff is trivially e p          because there are no free resources 
let j   c  e p  j      and pc   pc   if agent  plays y   the expected payoff is clearly  
 it will be   now and   in the future by the induction hypothesis   if agent  plays a  the
expected payoff is  by definition     

pc n 
 

ea  p  c       
c
 


c
    


x
pc n 
pr  loses and nw   l a   e p  c  l 
     
       
c
l  

   

ficigler   faltings

because of the way the pc is defined  and from the induction hypothesis e p  j      for
j   c  we get
ea  p  c     pr  loses and nw     a   e c    
   pr  loses and nw     a   max ea  p  c   ey  p  c  

    

since   pr  loses and nw     a       it must be that ea  p  c      
theorem     if pc   pc   e p  c      
proof  from lemma   we know that when pc   pc   it is a best response to access  so
e p  c    ea  p  c   from lemma   we know that for all j  e p  j      if pc   pc   by
definition    we see that e p  c      
theorem    shows that if we have enough resources so that pc     the expected payoff
for the agents  even when they access all the time  will be positive 
given the number of agents n   discount factor  and collision cost   the necessary
number of resources c for the expected payoff to be positive is 
c   
 

 
r
n 

  
 
     

    

figure   illustrates the value of c depending on n     and  respectively  figure  a shows
how the number of resources c increases as n increases  naturally  more agents need more
resources 
figure  b shows on the other hand that with an increasing discount factor   the necessary number of resources drops  this is because for high   the agents are almost indifferent
between winning now and winning later  in section        we will explore this idea in more
detail  we will show that for high enough delta  a strategy which prescribes the agents to
access with a constant probability until they reach the asynchrony is an  equilibrium of
the resource allocation game 
finally  figure  c shows an increasing number of resources which are necessary for the
bourgeois convention to have positive payoff  as the collision cost  increases  the increase
is almost linear in   this is because the higher the cost of collision  the lower the expected
payoff of accessing ea   for the bourgeois convention to have positive expected payoff  we
need ea     for all    p    
let us now look at the price of anonymity for the bourgeois convention  as defined in
definition     
theorem     the price of anonymity of the bourgeois convention is infinite 
proof  the highest social payoff any strategy profile  can achieve in an n  agent  c resource
allocation game  n  c  is
c
max e      
 
    
 
this is achieved when in every round  every resource is accessed by exactly one agent  such
strategy profile is obviously asymmetric 
   

fisymmetric subgame perfect equilibria in resource allocation

  

  

   

  
  

   

  
c 

c 
  

c 
   

  
 
 
 

  

 
 

  
n

  

  

 
 

   


 a  n

 

 
 

  


 b  

   

 c  

figure    minimum number of resources c needed for the expected payoff of bourgeois
convention to be positive  depending on n     and   one parameter is varying 
the other parameters are set to n                     for varying n   the
dashed line shows when c   n  

   
n  
n  
 

   
r
 

   

 
   

   

   

   

   

   

   

   

   

figure    market convention  price of anonymity for c      k   n          and varying  

if each agent knew which part of the bourgeois convention to play at the beginning of the
game  this convention would be socially efficient  however  when the agents are anonymous 
they have to learn which part of the convention they should play through randomization 
for the bourgeois convention for small c relative to n   this randomization is such that
the agents are indifferent between accessing some resource and yielding  and their expected
payoff of both is zero  therefore  its price of anonymity is infinite 
    market convention
we saw that the bourgeois convention leads to zero expected social payoff for a small
number of resources  we would like to improve the expected payoff here  in the bourgeois
convention  the agents receive zero expected payoff because the demand for resources is
too high compared to the supply  we need to decrease the demand  while increasing the
   

ficigler   faltings

   
n  
n  

 
r

   

 
 

 

 

 

 

 

figure    market convention  price of anonymity for c      k   n          and varying  

supply  this is often achieved through markets  shneidman et al         present some of
the reasons why markets might be appropriate for resource allocation 
we assume the following 
 agents can observe k    coordination signals 
 agents have a decreasing marginal utility when they access a resource more often 
 they pay a fixed price per each successful access  to the point that each agent prefers
to access a resource only for one signal out of k  in practice  this could be implemented by a central authority that observes the convergence rate of the agents  and
dynamically increases or decreases the price to achieve convergence 
such assumptions define what we call market convention  where the winners only access their claimed resource for the signals they observed when they first claimed it  the
price the agents have to pay serves to decrease the demand  the coordination signal effectively increases the supply of resources k times  because the resource allocation may be
different for each of the signal values 
we know that we can implement this convention for c    resources using symmetric
play  see section     for small k  we can also use algorithm   to calculate the access
probabilities  for the ease of exposition  we will first describe the market convention for
c     resource  then we will generalize the description to c     resources 
      one resource
when each agent only accesses the resource for one signal  we need k   n signals to make
sure everyone gets to access once 
in the n  agent    resource case  imagine there are still n agents playing and  n  n 
agents who have already claimed the resource for some signal  imagine that the n agents
observe one of the n signals for which no resource has been claimed 
   

fisymmetric subgame perfect equilibria in resource allocation

assume that all agents access the resource with probability pn   the expected payoff of
accessing a resource for agent  is



 
ea  pn   n         pn  
   

n  




n
         pn  n     
ea  pn   n 
n   n  n 
n 



    

the expected payoff of yielding for agent  is

ey  pn   n      n    pn     pn  n  e n    


n
ey  pn   n 
      n    pn     pn  n 
n   n  n 

    

when pn      accessing a resource will always lead to a collision  so the payoff of
accessing will be negative  when pn      accessing a resource will always claim it  so the
payoff of accessing will be positive  in the equilibrium  the agents should be indifferent
between accessing and yielding  therefore  we want to find pn such that ea  pn   n   
ey  pn   n    e n  
finding a closed form expression for pn is difficult  but we can use algorithm   to
calculate this probability  as well as the expected payoff e n   numerically  albeit in practice
only for small k  
figures   and   show the price of anonymity of the market convention  as defined in
definition     for varying discount factor   and varying cost of collision   respectively 
from section      the price of anonymity for c     is   in contrast  for the market
convention this price is in both cases finite and relatively small 
      multiple resources
assume now that c     in any given round  we will denote c     c    c            ck   the
vector of resources which have not been claimed yet for each value of the coordination
signal k                 k   we will denote n the number of players who have not claimed any
resource yet for any signal value  finally  let p     pn c    pn c            pn ck   be the vector of
probabilities  where pn ck denotes the probability that a loser will access some resource for
signal k  k  given that ck resources are available 
from corollary    we know that for the market convention  there exists an equilibrium
implementation  but what does it look like exactly  in order to be able to express it  albeit
only numerically   we need to define the expected payoff functions the players receive for
each action 
   

ficigler   faltings

for number of losers n  observed coordination signal k and vectors p and c  we can
define expected payoff functions when a player  takes action a and y   respectively 
ea  p  c  n  k     pr  wins a   w       pr  wins a      
min ck  n 

 

x

pr  loses  nw winners a   e p   ck  nw   ck    n  nw  

nw   

  pr nw     a  


 ea  p  c  n  k 
k



  pr nw     a   
k 

k
x
l  
l  k

    



 pn cl ea  p  c  n  l        pn cl  ey  p  c  n  l  


min n c 

ey  p  c  n  k    

x

pr nw winners y    e p   ck  nw   ck    n  nw  

nw   


  pr nw     y   



k
x

 
ey  p  c  n  k   
 pn cl ea  p  c  n  l        pn cl  ey  p  c  n  l  


k
l  
l  k

    
in the equations above  e p  c  n  is the expected payoff before the players observe the
coordination signal  it is defined as
e p  c  n    

k
  x
e p  c  n  k  
k
k  


the winner payoff w is defined as w        k   
  this is because the winner will
access for only one signal  once in the current round  and than in any future round with
probability k   
what are the probabilities that there will be nw winners in each of the cases  we will
start with the simplest case  pr nw winners y    given that there are n agents  including
agent    ck resources and all agents except  play action a with probability pk  
the problem of calculating this probability is very similar to the well known balls andbins problem  raab   steger         in the balls and bins problem we assume that we
have n balls who are each randomly assigned into one of the c bins  the goal is to find a
probability that i bins will have exactly one ball in them  we will express this probability
as  n  c  i  
there are ni ways to pick some i balls  place them into some i bins so that each bin
has one ball  and place the remaining n  i balls into the remaining c  i bins randomly 

  
c n
ni   
 i    c  i ni
i
i
   

    

fisymmetric subgame perfect equilibria in resource allocation

there are a total of cn ways to arrange n balls into c bins  therefore  the probability
 n  c  i  is the total number of ways to place n balls in c bins so that exactly i have one
ball can be then obtained from the generalized inclusion exclusion principle 
 
 n  c  i     n
c
 
  n
c
 

min c n 

x

ji

   

j i
min c n 

x

ji

   

j i

 
j
nj
i

   
j
c n
 j    c  j nj
i
j
j

    



  min c n 
nj
x
n  c
ji c  i  c  j 
   
 
j  i  n  j  
cn i
j i

 
 ci
in the simplification above  we use the absorption identity ji jc   ci ji
 
how can we use the function  to calculate pr nw winners y    the n    agents  other
than   decide to play action a with probability pk   and then choose the resource to access
randomly  the agents who choose to access a resource correspond to the balls and bins
problem  therefore 
pr nw winners y     

n 
x


n  i
pk      pk  n i   i  c  nw   
i

i  

    

to calculate the probability pr  wins a   we can proceed as follows  we assume w l o g
that  accesses resource    there will be some i agents  out of n     who will choose action
a  we then need all of them to choose other resource than    therefore 
pr  wins a    

n 
x
i  




n 
  i
i
n i
 pk      pk  
 
c
i

    

finally  to calculate the probability pr  loses  nw winners a   we can use again the
balls and bins problem  given that there are    i  n    agents who choose action a 
there will be    j  i agents who choose the same resource as agent   the remaining
 i  j  agents face the same balls and bins problem for c    bins    bin is already occupied
by agent    therefore 
pr  loses  nw winners a    

n 
i    j 
x n   
x
i
 
  ij
 
  i  j  c     nw  
pik     pk  n i
i
j
c
c
i  

j  

    
now that we have expressed the expected payoff functions ea and ey explicitly  we can
use algorithm   to calculate the equilibrium access probabilities and expected payoffs 
figures   and   show the price of anonymity of the market convention for c      k    
and n   c  k      when the discount factor  grows  the price of anonymity decreases
   

ficigler   faltings

   

price of anonymity

   

   

   

   

   

 
   

   

   

   

   


   

   

   

   

figure    market convention  price of anonymity for n      c      k             and
varying  

   
   

price of anonymity

   
   
   
   
 
   
   
   
 

 

 

 

 

 



figure    market convention  price of anonymity for n      c      k             and
varying  

 note that in figure   the y axis is logarithmic   this is because for small   the benefit
of winning the resource right away is much higher than the payoff of winning later  on
the other hand  as  gets closer to    the agents dont care whether they win now or later 
since the market convention guarantees that everyone will be able to access some resource
for some signal value  when      the expected payoff of winner and losers will be the
same  also  as      the cost the agents have to pay for learning the convention decreases
compared to the payoff they obtain after they have learnt it 
when  increases  the price of anonymity increases  the cost of collision has a direct
effect on the expected payoff functions ea and ey   therefore  the expected equilibrium
   

fisymmetric subgame perfect equilibria in resource allocation

payoff will be higher if the cost is lower  changing the  has no effect on the optimal
asymmetric outcome though  since the agents dont have to pay any cost because there are
no collisions 
       equilibrium
calculating the equilibrium access probabilities for the market convention is difficult  we
need to use a numerical algorithm  and as the number of signals k grows  the number of
equations grows exponentially  therefore  we would like to find access probabilities which
are easy to compute and for which the agents incentive to deviate is too small  indeed 
game theory is often interested in  equilibria  in which no agent can improve her payoff by
more than      
the market pricing ensures that each agent only wants to access a resource for one signal
value  it also doesnt depend on the access probabilities of the agents  only on their utility
functions  once the agents converge to the asynchrony round  i e  a pure strategy ne of
the resource allocation for every signal value   their future expected payoff will be
k  
 
 

    

and no agent can improve her payoff by deviating since the players are playing a psne of
the stage game in each round 
if the agents who havent claimed their resource yet play action a with a constant
probability     pconst      the expected time before the reach the asynchrony is finite 
 from the properties of the balls and bins problem  see section      or raab   steger 
       we can prove the following theorem 
theorem     suppose that in the n  agent  c resource allocation game  the agents adopt
the market convention with the following implementation  the agents who havent claimed
any resource yet play action a with a constant probability pconst  we call this the constantprobability implementation   let e   be the expected payoff for each agent in this case for
a given discount factor   let e      be the expected payoff of the best response strategy to
this convention and implementation 
then for any       there exists           such that for all           
e  
      
e     

    

proof  because of the market pricing  each agent only wants to access one resource for one
value of the coordination signal  so the best response payoff e   is
e      

k  
 
 

    

no matter what strategy do the other agents play 
when the agents adopt the market convention with the constant probability implementation  then in every round until they converge to a psne  they receive a payoff between
      the collision cost  and    after they reach the psne  their expected payoff is
k  
 
   

    

ficigler   faltings

as stated above  we can therefore say that
e   


x
i  

i
   i
  k   
pr agents reach psne in i steps    
 
 



    

we can define a random variable x such that x   i if the agents reach a psne after
exactly i steps  from the properties of the expected value  we can ee that
 
 
      e  x     k    e  x
e   
 
    
 
the function  x      x is a convex function  from jensens inequality         we know
that
 
e  x   e x   
    
therefore 

      e x    k     e x 
e  

 
e     
k  

    

the expected time e x  to reach the psne is finite and doesnt depend on   so we can
treat is as a constant  because  e x  is continuous in   monotonous and lim   e x      
we can see that for a given       there exists           such that for all           
e  
      
e     

    

by ensuring that each agent only wants to access some resource for one signal value 
the market convention makes the cooperative strategy from our previous work  cigler  
faltings        almost rational 
    expected convergence time
in this section  we will analyze what is the expected number of rounds the agents need to
converge to a perfect allocation of resources  one where all resources are used by exactly one 
and there are no collisions   we will first prove an upper bound on the expected number
of steps to the convergence for the bourgeois convention  and then present experiments for
the market convention 
      bourgeois convention
in order to prove the convergence of the bourgeois convention  we will describe its execution
as a markov chain  a markov chain describing the execution of the bourgeois convention in
n  agent  c resource allocation game is a chain whose state at round t is xt                 c  
where xt   c means that there are c unclaimed resources at round t 
we are interested in the expected number of rounds it will take to this markov chain to
reach state   if it started in state c  this is called the expected hitting time 
   

fisymmetric subgame perfect equilibria in resource allocation

definition      norris         hitting time  let  xt  t  be a markov chain with state
space i  given a probability space      pr   the hitting time of a subset a  i is a random
variable h a                       given by
h a      inf t      xt     a 
in general  the expected hitting time of a set of states a can be found by solving a
system of linear equations 
theorem     the vector of mean hitting times k a   e h a      kia   i  i  is the minimal
non negative solution to the system of linear equations
 a
ki     p
for i  a
    
a for i 
kia       j a
p
k
 a
ij j
 
solving them analytically for our markov chain is however difficult  fortunately  when
the markov chain has only one absorbing state i      and it can only move from state i to
j if i  j  we can use the following theorem to derive an upper bound on the hitting time
 proved by rego        
theorem     let a        if
i      e xt    xt   i   
for some       then


kia   log i  

i



 

in order to use the theorem     we need to calculate the expected state e xt    xt   c  
lemma     let xt   c  and let there be n    n  c   c agents who have not claimed a
n 
that a resource i will be claimed in
resource yet  let us denote q n  c    pc  n     pc
round t if the agents play the subgame perfect equilibrium strategy vector described above 
then the next expected state is
e xt    xt   c         q n  c    c
proof  for a resource i  we can denote wi the random variable  where wi     if the resource
i has been claimed in round t  and wi     otherwise  the random variable wi is bernoullidistributed with probability q n  c  
the next expected state is then
  c
 
c
x
x
e xt    xt   c    c  e
wi   c 
e wi         q n  c    c 
    
i  

i  

because e wi     q n  c  
in the following lemmas  we will denote
   

  
 
      
   

    

ficigler   faltings

lemma     for a given collision cost  and discount factor   there exists a constant
         such that for c    n  p     
proof  according
to the definition of the subgame perfect equilibrium strategy  p    c 

 
n 
 
  
we want p      which is equivalent to

 
n 
c  
   
    


  n 
 
 
    
c
    
we know that c    n  so



n 
  n 
 
 
  
 e  
c
n

    

if we therefore set  such that e     the access probability p     
lemma     for given  and   there exists          such that for any c 
e xt    xt   c          c

proof  we will prove the lemma for two cases  when p  
   andwhen
 p     
first  let us prove the case p      that is p   c     n     therefore  q n  c   

 
   n    n    it can be shown that for any n 


q n  c      

 
  n     log  

n 

now let p      from lemma    it must be that c     n  then



n 
c
  n 
 
q n  c        
  
 
n
c
n
because q n  c  is increasing with c 
now

  

 
n

n 

   e  

    

    

    

for fixed     the  and  are constants  so we can set  as
    min   e    log   

    

from above  this proves the lemma 
theorem     the expected time for the agents to converge to a resource allocation where
all the resources are claimed is o log c  
   

fisymmetric subgame perfect equilibria in resource allocation

proof  we have shown how we can express the expected convergence time as expected
hitting time of a certain markov chain 
from lemma    we saw that there exists  such that for any c 
e xt    xt   c          c 
we can now combine this result with theorem    to show that the expected hitting
time from the state c to state   is


 
 
 
kn   dlog   ce    o
 log c   o log c  
    
 


because  is a constant 

      market convention
for the market convention  it is unfortunately very difficult to express the expected number
of convergence steps in a closed form expression  however  we can use linear programming
to calculate the expected number of convergence steps for a given parameters n   c  k  
and  
the markov chain for the market convention for k signals and c resources looks as
follows  its state at time t is vt                 c k   where vtk denotes how many resources
have not been claimed for signal k  the initial state v  is such that v k   c for all
k              k   if n  c  k pthe final state is when vtk     for all k  when n   c  k 
the final states are such that k       k  vtk   c  k  n  
the transition probabilities between two states vi and vj   vi    vj   are the following 
suppose k   vjk   vik and l    k   vjl    vil   let us denote c    vik   i e  the number of
unclaimed resources in state vi for signal k  and n    n   c  vik   the number of agents
who have not claimed any resource for signal k in state vi  
pr vt  

n  
  x n m
  vj  vt   vi     
p     pk  nm   m  c  vik  vjk  
k
m k

    

m  

otherwise if vj    vi   pr vt     vj  vt   vi        
figure   shows the expected number of rounds to converge for varying discount factor
  generally  we would expect the access probability to increase with increasing   since
the profit from winning the resource increases  this should then increase the convergence
time  however  in our experiments the influence of  on the convergence time is negligible 
although we can observe a slight increase as  increases  figure   shows the convergence for
varying collision cost   for  close to    the convergence time remains stable  however  for
very high cost   the convergence time increases linearly with   in this case  the high cost
of collision drives the resource access probability low  because agents try to avoid collisions
at all costs 
figure    shows the expected convergence when we increase number of resources c and
number of agents n proportionally  the increase in convergence time is still sub linear to
the increase in c 
   

ficigler   faltings

   

convergence steps

    
    
    
    
   
    
    
 

   

   

   

   

 



figure    market convention  expected number of convergence steps given n      c     
k             and varying  

  
  

convergence steps

  
  
  
  
  
  
  
   
  

 

  

 

  


 

  

 

  

figure    market convention  expected number of convergence steps given n      c     
k             and varying  

   

fisymmetric subgame perfect equilibria in resource allocation

  
  

convergence steps

  
  
 
 
 
 
 
 
 

   

 

   

 
c

   

 

   

 

figure     market convention  expected number of convergence steps given k             
       and varying number of resources c and agents n      c 

c f  
bourgeois
egalitarian 
market

ex post fair
 x  
no
x
x

efficient
x
no
x
 

equilibrium
no
x
x
x

table    properties of conventions
    convention properties
we compare the properties of the following conventions  c f    a channel allocation
algorithm presented in our previous work  cigler   faltings         bourgeois and egalitarian
conventions  presented by bhaskar         and market convention  presented in above 
we compare the conventions according to the following properties 
ex post fairness is the expected payoff to all agents the same even after asynchrony 
efficiency does the convention maximize social welfare among all possible conventions 
equilibrium does the convention have an equilibrium implementation 
table   summarizes the properties of the conventions  the c f   convention is only
approximately ex post fair  the fairness is improving as the number of coordination signals
increases  but some agents might have a worse payoff than others  on the other hand 
it is efficient  at least with no discounting         however  it is not an equilibrium
   fair asymptotically  as n   
   only for   agents    resource games 

   

ficigler   faltings

of the repeated game  the bourgeois convention is neither fair nor efficient  in fact the
expected payoff to the agents is    for a small number of resources   it is has an equilibrium
implementation though  since the agents are indifferent between being a winner and a loser 
the egalitarian convention is fair  efficient and has an equilibrium implementation  however 
it is only defined for games of   agents and   resource  finally  the market convention is fair
and also has an equilibrium implementation  it is clearly more efficient than the bourgeois
convention  nevertheless  finding the most efficient convention remains an open problem 

   folk theorems and symmetric equilibria
in the previous sections  we have analyzed a special kind of symmetric equilibria of the
resource allocation game  the agents first followed a markovian implementation  and as
soon as they play a pure strategy ne  they adopted a convention  for an infinitely repeated
game with discounting  the set of nash equilibria can be characterized using the so called folk
theorem  while their name indicates that they have been known and used well before they
were first published  we will follow the version described by fudenberg and maskin        
informally  the folk theorem states that in the infinitely repeated game  for every feasible
and individually rational payoff vector of the stage game  there exists a nash equilibrium
of the repeated game where the average payoffs per round correspond to the stage game
payoff vector 
a payoff vector is individually rational if it pareto dominates the minimax payoff of the
stage game  for player i  the minimax payoff is
vi    min max ui  i   i   
i

i

    

to simplify the notation  fudenberg and maskin        normalize the payoffs so that
                        let
for the minimax payoffs   v    v            vn
u      v            vn    a            an    a         an s t  u a            an      v            vn    
v    convex hull of u 
v       v            vn    v  vi     for all i  
the set v is the set of feasible payoffs in the stage games  that is  payoffs which can be
achieved by playing some mixed or correlated strategy   the set v  is the subset of feasible
payoffs which are also individually rational 
theorem      fudenberg   maskin        for any  v            vn    v    if the discount
factor  is close enough to    there exists a nash equilibrium of the infinitely repeated game
with discounting where  for all i  the average payoff to player i is vi  
the idea of the proof is as follows  the agents cycle through a prescribed sequence of
game outcomes so that they achieve the desired payoffs  if one player deviates  the others
punish him by playing the minimax strategy forever after 
our focus so far has been on finding symmetric equilibrium strategies  the folk theorem doesnt say anything about whether the equilibrium strategy will be symmetric  even
if the payoff vector is symmetric  nevertheless  we can define another class of symmetric
   

fisymmetric subgame perfect equilibria in resource allocation

strategies of the infinitely repeated game  than the one based on conventions and their
implementations  the strategies have the following form  the players follow a symmetric
 mixed  strategy of the stage game  if one player deviates from this strategy  other players
punish her by following the minimax strategy  for the resource allocation game  the minimax payoff is                   and is achieved in the mixed strategy nash equilibrium  from
the folk theorem  such strategy can be sustained as the nash equilibrium of the repeated
game  though not necessarily a subgame perfect equilibrium  
a symmetric strategy of the stage resource allocation game is a vector of access probabilities q    q    q            qc   where qc is the probability that each agent will access resource c 
we are interested in finding access probability vector q which achieves the highest expected
payoff 
for a given access probability vector q  the expected payoff that an agent receives is as
follows 
c
x



e q    
qj      qj  n              qj  n      
    
j  

theorem     for a resource allocation game with n     agents and c     resource  the
resource access probability which maximizes the expected payoff of the stage game is
q  

 
 

 
        

    

proof  we calculate the derivative of expected payoff function from equation    for n    
and c     
e q 
      q          
q
setting the first derivative equal to    we get
q  

 
 

 
        

since the second derivative is
   e q 
            
 q
the probability q  is a local maximum of the expected payoff function e q  
corollary    for a resource allocation game with n     agents and c     resource  the
highest expected payoff of a symmetric strategy in the stage game is
e  

 
 

 
        

    

corollary    for a resource allocation game with n     agents and c     resource  the
price of anonymity of the strategy which accesses with the optimal access probability q  is
            
   

ficigler   faltings

 

  

folk theorem
market convention

r  
  

 

  

 

 

 

 

 

 



figure     price of anonymity of the symmetric strategy following from the folk theorem 
compared to the price of anonymity of the market convention for n      c    
and varying cost of collision  

for the general case of resource allocation game with n agents and c resources  we
can
    given the constraint
pc find the probability vector which maximizes the equation
 
j   qj     using the method of lagrangian multipliers  
p
   our goal is to maximize e q    q            qc   such that q    c
i   qi     and qi     where q  is the
probability that an agent yields  the lagrangian function is then
 q    q            qc        e q    q            qc      

q   

c
x

 
qi     

i  

the first partial derivatives are

   
q 

e
  
 
qi
qi

    
    

               qi  n    qi             n          qi  n          for    i  c

   q   


c
x

  

    
    

i  

a necessary condition for a solution to be a maximum
is that the partial derivatives of the lagrangian
p
function are    therefore        and q        c
i   qi   for qi      i  c we can find the solution to

    using a numerical root finding algorithm  if there is no point where the partial derivatives are
qi
zero  we have to compare e q  for a  finite  number of extreme points 

   

fisymmetric subgame perfect equilibria in resource allocation

figure    compares the price of anonymity of the folk theorem based symmetric strategy
with the price of anonymity of the market convention  for n     agents and c     resource 
since the price of anonymity of the folk theorem strategy doesnt depend on the discount
factor   it only needs to be high enough for the strategy to be an equilibrium   we only show
the graph for varying collision cost   the price of anonymity of the folk theorem strategy
is an order of magnitude higher than the price of anonymity of the market convention 

   conclusions
in this paper  we considered symmetric protocols to rationally coordinate on an asymmetric 
efficient allocation infinitely repeated resource allocation game with discounting of n agents
and c resources  we assumed that the agents are identical  and that the resources are
homogeneous  we based our work on the idea of bhaskar         we let the agents choose
their actions randomly  after which they adopt a certain convention  we generalize the work
of bhaskar to an arbitrary resource allocation problem with n agents and c resources  we
show that for any convention  there exists a symmetric subgame perfect equilibrium that
implements it  we presented two such conventions for the repeated resource allocation
game  bourgeois and market convention  we defined the price of anonymity as the ratio
between the expected social payoff of the best asymmetric strategy profile and the expected
social payoff of a given symmetric nash equilibrium  we showed that while the price of
anonymity for the bourgeois convention is infinite  at least for small number of resources  
the price of anonymity of the market convention is finite and relatively small  this is because
the market convention reduces the demand by imposing a price on successful access  while
at the same time increasing the supply by having the agents condition their strategy on
a global coordination signal k              k   this way  the conflict between the agents is
reduced  we also showed analytically that when the agents adopt the bourgeois convention 
they will converge to a perfect resource allocation in polynomial time 
for the market convention  calculating the equilibrium access probabilities is difficult 
we need to use a numerical algorithm  whose complexity is exponential in the number of
coordination signals k  however  the market mechanism already makes sure that no agent
wants to access some resource for more than one coordination signal  therefore  we showed
that the cooperative solution where agents access the resources with constant probability
is an  equilibrium  given that the discount factor  is high enough 
in the future work  we would like to investigate whether there exist more efficient conventions than the market convention  i e  conventions with smaller price of anonymity   in
general  finding an optimal convention is an np hard problem  balan  richards    luke 
       but for a more restricted set of infinitely repeated resource allocation games  we might
be able to find the optimal convention  similar to the thue morse sequence  richman       
used by kuzmics et al         in the nash demand game 

acknowledgements
we are particularly thankful to david parkes for giving the first author the unique opportunity to spend a few weeks in his lab at harvard  davids openness and unparalleled
knowledge is what really helped originate this work  we would also like to thank kate
   

ficigler   faltings

larson for reading the draft of this paper and helping make the theoretical analysis much
more readable 

references
aumann  r          subjectivity and correlation in randomized strategies  journal of
mathematical economics              
balan  g   richards  d     luke  s          long term fairness with bounded worst case
losses  autonomous agents and multi agent systems               
bhaskar  v          egalitarianism and efficiency in repeated symmetric games  games
and economic behavior                 
bonnet  f     raynal  m          the price of anonymity  optimal consensus despite
asynchrony  crash  and anonymity  acm trans  auton  adapt  syst              
      
chothia  t     chatzikokolakis  k          a survey of anonymous peer to peer filesharing  in embedded and ubiquitous computingeuc      workshops  pp         
springer 
cigler  l     faltings  b          reaching correlated equilibria through multi agent learning  in the   th international conference on autonomous agents and multiagent
systems volume    pp          international foundation for autonomous agents
and multiagent systems 
durresi  a   paruchuri  v   durresi  m     barolli  l          a hierarchical anonymous
communication protocol for sensor networks  in embedded and ubiquitous computing
euc       pp            springer 
fudenberg  d     maskin  e          the folk theorem in repeated games with discounting
or with incomplete information  econometrica                 
jensen  j  l          sur les fonctions convexes et les inegalites entre les valeurs moyennes 
acta mathematica                 
koutsoupias  e     papadimitriou  c          worst case equilibria  in proceedings of the
  th annual conference on theoretical aspects of computer science  stacs    pp 
        berlin  heidelberg  springer verlag 
kuzmics  c   palfrey  t     rogers  b          symmetric players in repeated games  theory
and evidence  
leyton brown  k     shoham  y          essentials of game theory  a concise  multidisciplinary introduction  morgan   claypool  san rafael  ca 
monderer  d     shapley  l  s          potential games  games and economic behavior 
               
norris  j  r          markov chains  cambridge series in statistical and probabilistic
mathematics   cambridge university press 
   

fisymmetric subgame perfect equilibria in resource allocation

raab  m     steger  a          balls into bins a simple and tight analysis  vol       of
lecture notes in computer science  chap      pp          springer berlin heidelberg 
berlin  heidelberg 
rego  v          naive asymptotics for hitting time bounds in markov chains  acta informatica                 
richman  r  m          recursive binary sequences of differences  complex systems         
       
rosenthal  r  w          a class of games possessing pure strategy nash equilibria  international journal of game theory              
shneidman  j   ng  c   parkes  d  c   auyoung  a   snoeren  a  c   vahdat  a     chun  b 
        why markets could  but dont currently  solve resource allocation problems
in systems  in in usenix     proceedings of the   th usenix workshop on hot
topics in operating systems  p    
taussky  o          a recurring theorem on determinants  the american mathematical
monthly                  
wang  l   wu  k   hamdi  m     ni  l  m          attachment learning for multi channel
allocation in distributed ofdma networks  parallel and distributed systems  international conference on            

   

fi