journal of artificial intelligence research                  

submitted       published      

protecting moving targets with multiple mobile resources
fei fang
albert xin jiang
milind tambe

feifang usc edu
jiangx usc edu
tambe usc edu

university of southern california
los angeles  ca       usa

abstract
in recent years  stackelberg security games have been successfully applied to solve resource allocation and scheduling problems in several security domains  however  previous
work has mostly assumed that the targets are stationary relative to the defender and the
attacker  leading to discrete game models with finite numbers of pure strategies  this paper
in contrast focuses on protecting mobile targets that leads to a continuous set of strategies
for the players  the problem is motivated by several real world domains including protecting ferries with escort boats and protecting refugee supply lines  our contributions include 
 i  a new game model for multiple mobile defender resources and moving targets with a
discretized strategy space for the defender and a continuous strategy space for the attacker 
 ii  an efficient linear programming based solution that uses a compact representation for
the defenders mixed strategy  while accurately modeling the attackers continuous strategy using a novel sub interval analysis method   iii  discussion and analysis of multiple
heuristic methods for equilibrium refinement to improve robustness of defenders mixed
strategy   iv  discussion of approaches to sample actual defender schedules from the defenders mixed strategy   iv  detailed experimental analysis of our algorithms in the ferry
protection domain 

   introduction
in the last few years  game theoretic decision support systems have been successfully deployed in several domains to assist security agencies  defenders  in protecting critical infrastructure such as ports  airports and air transportation infrastructure  tambe        gatti 
      marecki  tesauro    segal        jakob  vanek    pechoucek         these decision support systems assist defenders in allocating and scheduling their limited resources
to protect targets from adversaries  in particular  given limited security resources it is not
possible to cover or secure all target at all times  and simultaneously  because the attacker can observe the defenders daily schedules  any deterministic schedule by the defender
can be exploited by the attacker  paruchuri  tambe  ordonez    kraus        kiekintveld 
islam    kreinovich        vorobeychik   singh        conitzer   sandholm        
one game theoretic model that has been deployed to schedule security resources in such
domains is that of a stackelberg game between a leader  the defender  and a follower  the
attacker   in this model  the leader commits to a mixed strategy  which is a randomized
schedule specified by a probability distribution over deterministic schedules  the follower
then observes the distribution and plays a best response  korzhyk  conitzer    parr        
decision support systems based on this model have been successfully deployed  including
armor at the lax airport  pita  jain  marecki  ordonez  portway  tambe  western 
c
    
ai access foundation  all rights reserved 

fifang  jiang    tambe

paruchuri    kraus         iris for the us federal air marshals service  tsai  rathi 
kiekintveld  ordonez    tambe         and protect for the us coast guard  shieh 
an  yang  tambe  baldwin  direnzo  maule    meyer        
most previous work on game theoretic models for security has assumed either stationary
targets such as airport terminals  pita et al          or targets that are stationary relative to
the defender and the attacker  e g   trains  yin  jiang  johnson  kiekintveld  leyton brown 
sandholm  tambe    sullivan        and planes  tsai et al          where the players can
only move along with the targets to protect or attack them   this stationary nature leads
to discrete game models with finite numbers of pure strategies  in this paper we focus
on security domains in which the defender needs to protect a mobile set of targets  the
attacker can attack these targets at any point in time during their movement  leading to a
continuous set of strategies  the defender can deploy a set of mobile escort resources  called
patrollers for short  to protect these targets  we assume the game is zero sum  and allow
the values of the targets to vary depending on their locations and time  the defenders
objective is to schedule the mobile escort resources to minimize attackers expected utility 
we call this problem multiple mobile resources protecting moving targets  mrmt  
the first contribution of this paper is a novel game model for mrmt called mrmtsg  
mrmtsg is an attacker defender stackelberg game model with a continuous set of strategies for the attacker  in contrast  while the defenders strategy space is also continuous  we
discretize it in mrmtsg for three reasons  firstly  if we let the defenders strategy space
to be continuous  the space of mixed strategies for the defender would then have infinite
dimensions  which makes exact computation infeasible  secondly  in practice  the patrollers
are not able to have such fine grained control over their vehicles  which makes the actual
defenders strategy space effectively a discrete one  finally  the discretized defender strategy space is a subset of the original continuous defender strategy space  so the optimal
solution calculated under our formulation is a feasible solution in the original game and
gives a lower bound guarantee for the defender in terms of expected utility for the original continuous game  on the other hand  discretizing the attackers strategy space can be
highly problematic as we will illustrate later in this paper  in particular  if we deploy a
randomized schedule for the defender under the assumption that the attacker could only
attack at certain discretized time points  the actual attacker could attack at some other
time point  leading to a possibly worse outcome for the defender 
our second contribution is cass  solver for continuous attacker strategies   an efficient
linear program to exactly solve mrmtsg   despite discretization  the defender strategy
space still has an exponential number of pure strategies  we overcome this shortcoming by
compactly representing the defenders mixed strategies as marginal probability variables 
on the attacker side  cass exactly and efficiently models the attackers continuous strategy
space using sub interval analysis  which is based on the observation that given the defenders
mixed strategy  the attackers expected utility is a piecewise linear function  along the way
to presenting cass  we present dass  solver for discretized attacker strategies   which
finds minimax solutions for mrmtsg games while constraining the attacker to attack at
discretized time points  for clarity of exposition we first derive dass and cass for the
case where the targets move on a one dimensional line segment  we later show that dass
and cass can be extended to the case where targets move in a two dimensional space 
   

fiprotecting moving targets with multiple mobile resources

our third contribution is focused on equilibrium refinement  our game has multiple
equilibria  and the defender strategy found by cass can be suboptimal with respect to uncertainties in the attackers model  e g   if the attacker can only attack during certain time
intervals  we present two heuristic equilibrium refinement approaches for this game  the
first  route adjust  iteratively computes a defender strategy that dominates earlier strategies  the second  flow adjust  is a linear programming based approach  our experiments
show that flow adjust is computationally faster than route adjust but route adjust is more
effective in selecting robust equilibrium strategies 
additionally  we provide several sampling methods for generating practical patrol routes
given the defender strategy in compact representation  finally we present detailed experimental analyses of our algorithm in the ferry protection domain  cass has been deployed
by the us coast guard since april      
the rest of the article is organized as follows  section   provides our problem statement 
section   presents the mrmtsg model and an initial formulation of the dass and cass for
a one dimensional setting  section   discusses equilibrium refinement  followed by section
  which gives the generalized formulation of dass and cass for two dimensional settings 
section   describes how to sample a patrol route and section   provides experimental
results in the ferry protection domain  section   discusses related work  followed by section
   which provides concluding remarks  and section     which discusses future work  at the
end of the article  appendix a provides a table listing all the notations used in the article 
and appendix b provides the detailed calculation for finding the intersection points in the
  d case 

   problem statement
one major example of the practical domains motivating this paper is the problem of protecting ferries that carry passengers in many waterside cities  packed with hundreds of
passengers  these may present attractive targets for an attacker  for example  the attacker
may ram a suicide boat packed with explosives into the ferry as happened with attacks on
french supertanker limburg and uss cole  greenberg  chalk    willis         in this
case  the intention of the attacker can only be detected once he gets very close to the ferry 
small  fast and well armed patrol boats  patrollers  can provide protection to the ferries
 figure   a    by detecting the attacker and stopping him with the armed weapons  however  there are often limited numbers of patrol boats  i e   they cannot protect the ferries
at all times at all locations  we first focus on the case where ferries and patrol boats move
in a one dimensional line segment  this is a realistic setting and also simplifies exposition  
we will discuss the two dimensional case in section   
    domain description
in this problem  there are l moving targets  f    f         fl   we assume that these targets
move along a one dimensional domain  specifically a straight line segment linking two terminal points which we will name a and b  this is sufficient to capture real world domains
such as ferries moving back and forth in a straight line between two terminals as they do
in many ports around the world  an example is the green line shown in figure   b   we
will provide an illustration of our geometric formulation of the problem in figure      the
   

fifang  jiang    tambe

 a 

 b 

figure     a  protecting ferries with patrol boats   b  part of the map of new york harbor commuter ferry routes  the straight line linking st  george terminal and
whitehall terminal indicates a public ferry route run by new york city department of transportation 

targets have fixed daily schedules  the schedule of each target can be described as a continuous function sq   t  d where q           l is the index of the target  t          is a
continuous time interval  e g   representing the duration of a typical daily patrol shift  and
d          is the continuous space of possible locations  normalized  with   corresponding
to terminal a and   to terminal b  thus sq  t  denotes the position of the target fq at a
specified time t  we assume sq is piecewise linear 
the defender has w mobile patrollers that can move along d to protect the targets 
denoted as p    p         pw   although capable of moving faster than the targets  they have a
maximum speed of vm   while the defender attempts to protect the targets  the attacker will
choose a certain time and a certain target to attack   in the rest of the paper  we denote the
defender as she and the attacker as he   the probability of attack success depends on
the positions of the patrollers at that time  specifically  each patroller can detect and try
to intercept anything within the protection radius re but cannot detect the attacker prior
to that radius  thus  a patroller protects all targets within her protective circle of radius
re  centered at her current position   as shown in figure     
















figure    an example with three targets  triangles  and two patrollers  squares   the
protective circles of the patrollers are shown with protection radius re   a patroller
protects all targets in her protective circle  patroller p  is protecting f  and p 
is protecting f   

   

fiprotecting moving targets with multiple mobile resources

symmetrically  a target is protected by all patrollers whose protective circles can cover
it  if the attacker attacks a protected target  then the probability of successful attack is a
decreasing function of the number of patrollers that are protecting the target  formally  we
use a set of coefficients  cg   to describe the strength of the protection 
definition    let g           w   be the total number of patrollers protecting a target fq  
i e   there are g patrollers such that fq is within radius re of each of the g patrollers  then
cg         specifies the probability that the patrollers can successfully stop the attacker  we
require that cg   cg  if g   g    i e   more patrollers offer better protection 
as with previous work in security games  tambe        yin et al         kiekintveld 
jain  tsai  pita  ordonez    tambe         we model the game as a stackelberg game  where
the defender commits to a randomized strategy first  and then the attacker can respond to
such a strategy  the patrol schedules in these domains were previously created by hand 
and hence suffer the drawbacks of hand drawn patrols  including lack of randomness  in
particular  informed randomness  and reliance on simple patrol patterns  tambe        
which we remedy in this paper 
    defender strategy
a pure strategy of the defender is to designate a movement schedule for each patroller 
analogous to the targets schedule  a patrollers schedule can be written as a continuous
function ru   t  d where u           w is the index the patroller  ru must be compatible
with the patrollers velocity range  a mixed defender strategy is a randomization over the
pure strategies  denoted as f  
    attacker strategy
the attacker conducts surveillance of the defenders mixed strategy and the targets schedules  he may then execute a pure strategy response to attack a certain target at a certain
time  the attackers pure strategy can be denoted as hq  ti where q is the index of target
to attack and t is the time to attack 
    utility function
we assume the game is zero sum  if the attacker performs a successful attack on target fq
at location x at time t  he gets a positive reward uq  x  t  and the defender gets uq  x  t  
otherwise both players get utility zero  the positive reward uq  x  t  is a known function
which accounts for many factors in practice  for example  an attacker may be more effective
in his attack when the target is stationary  such as at a terminal point  than when the target
is in motion  as the targets position is decided by the schedule  the utility function can be
written as uq  t   uq  sq  t   t   we assume that for each target fq   uq  t  can be represented
as a piecewise linear function of t 
    equilibrium
since our game is zero sum  the strong stackelberg equilibrium can be calculated by finding
the minimax maximin strategy  fudenberg   tirole        korzhyk et al          that is 
   

fifang  jiang    tambe

we can find the optimal defender strategy by finding a strategy that minimizes the maximum
of attackers expected utility 
definition    for single patroller case  the attacker expected utility of attacking target fq
at time t given defender mixed strategy f is
atteuf  fq   t        c  f  fq   t  uq  t 

   

uq  t  is the reward for a successful attack  f  fq   t  is the probability that the patroller
is protecting target fq at time t and c  is the protection coefficient of single patroller  we
drop the subscript if f is obvious from the context  as c  and uq  t  are constants for a given
attackers pure strategy hq  ti  atteu fq   t  is purely decided by  fq   t   the definition
with multiple patrollers will be given in section      we further denote the attackers
maximum expected utility as
atteum
f   max atteuf  fq   t 
q t

   

so the optimal defender strategy is a strategy f such that the atteum
f is minimized  formally
f  arg minf   atteum
f 

   

    assumptions
in our problem  the following assumptions are made based on discussions with domain
experts  here we provide our justifications for these assumptions  while appropriate for the
current domain of application  relaxing these assumptions for future applications remains
an issue for future work  and we provide an initial discussion in section    
 the attackers plan is decided off line  i e   the attacker does not take into account the
patrollers current partial route  partial pure strategy  in executing an attack  this
assumption is similar to the assumption made in other applications of security games
and justified elsewhere  an  kempe  kiekintveld  shieh  singh  tambe    vorobeychik        pita  jain  ordonez  portway  tambe  western  paruchuri    kraus 
      tambe         one key consideration is that given that attackers have limited
resources as well  for them to generate and execute complex conditional plans that
change based on on line observations of defenders pure strategy is both difficult
and risky 
 a single attacker is assumed instead of multiple attackers  this assumption arises
because performing even a single attack is already costly for the attacker  thus 
having coordinating attackers at the same time will be even harder and therefore
significantly less likely for the attacker 
 the game is assumed to be zero sum  in this case  the objectives of the defender and
attacker are in direct conflict  preventing an attack with higher potential damage is
a bigger success to the defender in our game 
   

fiprotecting moving targets with multiple mobile resources

 the schedules for the targets are deterministic  for the domains we focus on  potential
delays in the targets schedules are usually within several minutes if any  and the
targets will try to catch up with the fixed schedules as soon as possible  therefore 
even when delays occur  the deterministic schedule for a target can be viewed as a
good approximation of the actual schedule 

   models
in this section  we introduce our mrmtsg model that uses a discretized strategy space for
the defender and a continuous strategy space for the attacker  for clarity of exposition  we
then introduce the dass approach to compute a minimax solution for discretized attacker
strategy space  section       followed by cass for the attackers continuous strategy space
 section       we first assume a single patroller in sections     through     and then
generalize to multiple patrollers in section     
    representing defenders strategies
in this subsection  we introduce the discretized defender strategy space and the compact
representation used to represent the defenders mixed strategy  we show that the compact
representation is equivalent to the intuitive full representation  followed by several properties
of the compact representation 
since the defenders strategy space is discretized  we assume that each patroller only
makes changes at a finite set of time points t    t    t         tm    evenly spaced across the
original continuous time interval  t      is the starting time and tm     is the normalized
ending time  we denote by t the distance between two adjacent time points  t   tk   
tk   m     we set t to be small enough such that for each target fq   the schedule sq  t 
and the utility function uq  t  are linear in each interval  tk   tk     for k              m     i e  
the target is moving with uniform speed and the utility of a successful attack on it changes
linearly during each of these intervals  thus  if t  is a breakpoint of sq  t  or uq  t  for any
q  it can be represented as t    tk  where k  is an integer 
in addition to discretization in time  we also discretize the line segment ab that the
targets move along into a set of points d    d    d         dn   and restrict each patroller to be
located at one of the discretized points di at any discretized time point tk   note that d is not
necessarily evenly distributed and the targets locations are not restricted at any tk   during
each time interval  tk   tk      each patroller moves with constant speed from her location di
at time tk to her location dj at time tk     only movements compatible with the speed limit
vm are possible  the points d    d         dn are ordered by their distance to terminal a  and
d  refers to a and dn refers to b  since the time interval is discretized into m points  a
patrollers route ru can be represented as a vector ru    dru       dru            dru  m      ru  k 
indicates the index of the discretized distance point where the patroller is located at time
tk  
as explained in section    we discretized the defenders strategy space not only for
computational reasons  it is not even clear whether an equilibrium exists in the original
game with continuous strategy space for both players  the discretization is made also
because of the practical constraint of patrollers 
   

fifang  jiang    tambe

for expository purpose  we first focus on the case with a single defender resource and
then generalize to larger number of resources later  for a single defender resource  the
defenders mixed strategy in full representation assigns a probability to each of the patrol
routes that can be executed  since at each time step a patroller can choose to go to at most
n different locations  there are at most n m possible patrol routes in total and this number
is achievable if there is no speed limit  or vm is large enough   the exponentially growing
number of routes will make any analysis based on full representation intractable 
therefore  we use the compact representation of the defenders mixed strategy 
definition    the compact representation for a single defender resource is a compact
way to represent the defenders mixed strategy using flow distribution variables  f  i  j  k   
f  i  j  k  is the probability of the patroller moving from di at time tk to dj at time tk    
the complexity of the compact representation is o m n      which is much more efficient
compared to the full representation 
proposition    any strategy in full representation can be mapped into a compact representation 
proof sketch  if there are h possible patrol routes r    r         rh   a mixed defender
strategy can be represented in full representation as a probability vector  p r        p rh   
where p ru   is the probability of taking route ru   taking route ru means the patroller
moves from dru  k  to dru  k    during time  tk   tk      so the edge eru  k  ru  k    k is taken
when route ru is chosen  then the total probability of taking edge ei j k is the sum of
probabilities of all the routes ru where ru  k    i and ru  k        j  therefore  given
any strategy in full presentation specified by the probability vector  p r        p rh     we
can construct a compact representation consisting of a set of flow distribution variables
 f  i  j  k   where
x
f  i  j  k   
p ru   
   
ru  ru  k  i and ru  k    j

figure   shows a simple example illustrating the compact representation  numbers on
the edges indicate the value of f  i  j  k   we use ei j k to denote the directed edge linking
nodes  tk   di   and  tk     dj    for example  f            the probability of the patroller moving
from d  to d  during time t  to t    is shown on the edge e      from node  t    d    to node
 t    d     while a similar compact representation was used earlier by yin et al          we
use it in a continuous setting 
note that different mixed strategies in full representation can be mapped to the same
compact representation  table   shows two different mixed defender strategies in full representations that can be mapped to the same mixed strategy in compact representation as
shown in figure    the probability of a route is labeled on all edges in the route in full
representation  adding up the numbers of a particular edge ei j k in all routes of a full
representation together  we can get f  i  j  k  for the compact representation 
theorem    compact representation does not lead to any loss in solution quality 
   

fi

protecting moving targets with multiple mobile resources






 






figure    compact representation  x axis shows time intervals  y axis the discretized
distance points in the one dimensional movement space 

r     d    d    d   




r     d    d    d   




full representation  
r     d    d    d   
r     d    d    d   


r     d    d    d   



full representation  
r     d    d    d   
r     d    d    d   

r     d    d    d   





table    two full representations that can be mapped into the same compact representation
shown in figure   

proof sketch  the complete proof of the theorem relies on the calculations in section
    and      here we provide a sketch  recall our goal is to find an optimal defender
strategy f that minimizes the maximum attacker expected utility atteum
f   as we will
show in the next subsections   fq   t  can be calculated from the compact representation
 f  i  j  k    if two defender strategies under the full representation are mapped to the same
compact representation  f  i  j  k    they will have the same  function and then the same
atteu function according to equation    thus the value of atteum
f is the same for the
two defender strategies  so an optimal mixed defender strategy in compact representation
is still optimal for the corresponding defender strategies in full representation 
we exploit the following properties of the compact representation 
property   
forpany time interval  tk   tk      the sum of all flow distribution variables
pn
n
equals to   
i  
j   f  i  j  k      
property    the sum of flows that go into a particular node equals the sum
p of flows that
go out of the node  denote the sum for node  tk   di   by p i  k   then p i  k    n
j   f  j  i  k 
pn
     j   f  i  j  k   each p i  k  is equal to the marginal probability that the patroller is at
location di at time tk  
p
property    combining property   and    n
i   p i  k      
   

fifang  jiang    tambe

    dass  discretized attacker strategies
in this subsection  we introduce dass  a mathematical program that efficiently finds minimax solutions for mrmtsg  based games under the assumption that the attacker will attack
at one of the discretized time points tk   in this problem  we need to minimize v where v
is the maximum of attackers expected utility  here  v is the maximum of atteu fq   t  for
any target fq at any discretized time point tk  
from equation      we know that atteu fq   t  is decided by  fq   t   the probability
that the patroller is protecting target fq at time t  given the position of the target sq  t   we
define the protection range q  t     max sq  t re   d     min sq  t  re   dn     if the patroller
is located within the range q  t   the distance between the target and the patroller is no
more than re and thus the patroller is protecting fq at time t  so  fq   t  is the probability
that the patroller is located within range q  t  at time t  for the discretized time points
tk   the patroller can only be located at a discretized distance point di   so we define the
following 

definition    i i  q  k  is a function of two values  i i  q  k      if di  q  tk    and
otherwise i i  q  k      

in other words  i i  q  k      means that a patroller located at di at time tk can protect target fq   note that the value of i i  q  k  can be calculated directly from the input
parameters  di   sq  t  and re   and stored in a look up table  in particular  i i  q  k  is not
a variable in the formulations that follow  it simply encodes the relationship between di
and the location of target fq at tk   the probability that the patroller is at di at time tk is
p i  k   so we have
 fq   tk    

x


atteu fq   tk    

   c 

i i i q k   

p i  k  

x
i i i q k   


p i  k  uq  tk   

   

   

equation     follows from equations     and      expressing attackers expected utility for
discretized time points  finally  we must address speed restrictions on the patroller  we set
all flows corresponding to actions that are not achievable to zero   that is  f  i  j  k      if
 dj  di     vm t  thus  dass can be formulated as a linear program  this linear program

   besides the speed limit  we can also model other practical restrictions of the domain by placing constraints
on f  i  j  k  

   

fiprotecting moving targets with multiple mobile resources

solves for any number of targets but only one defender resource 
min

z

   

f  i j k  p i k 

f  i  j  k          

i  j  k

   

f  i  j  k      

i  j  k such that  dj  di     vm t

   

p i  k   

n
x

f  j  i  k     

i  k    

    

f  i  j  k  

i  k   m

    

k

    

q  k

    

j  

p i  k   

n
x
j  

n
x

p i  k      

i  

z  atteu fq   tk   

constraint   describes the probability range  constraint   describes the speed limit  constraints      describes property    constraint    is exactly property    property   can
be derived from property   and    so it is not listed as a constraint  constraint      shows
the attacker chooses the strategy that gives him the maximal expected utility among all
possible attacks at discretized time points  where atteu   is described by equation     
    cass  continuous attacker strategies
in this subsection  we generalize the problem to one with continuous attacker strategy set
and provides a linear programming based solution cass  cass efficiently finds optimal
mixed defender strategy under the assumption that the attacker can attack at any time
in the continuous time interval t           with this assumption  dasss solution quality
guarantee may fail  if the attacker chooses to attack between tk and tk     he may get
a higher expected reward than attacking at tk or tk     consider the following example 
with the defenders compact strategy between tk and tk   shown in figure    here the
defenders strategy has only three non zero flow variables f        k         f        k        
and f        k         indicated by the set of three edges e      e    k   e    k   e    k    a
target fq moves from d  to d  at constant speed during  tk   tk      its schedule is depicted
by the straight line segment sq   the dark lines l q and l q are parallel to sq with distance
re   the area between them indicates the protection range q  t  for any time t   tk   tk     
consider the time points at which an edge from e   intersects one of l q   l q   and label them
r   r             in figure     intuitively  these are all the time points at which a defender
as qk
patrol could potentially enter or leave the protection range of the target  to simplify the
  and t
 
notation  we denote tk as qk
k   as qk   for example  a patroller moving from d 
  to    because
to d   or equivalently  taking the edge e    k   protects the target from qk
qk
          during which the distance to the target is less or
e    k is between l   and l   in  qk
qk
r and  r     for
equal than protection radius re   consider the sub intervals between each qk
qk
r              since within each of these five sub intervals  no patroller enters or leaves the
   

fifang  jiang    tambe

protection range  the probability that the target is being protected is a constant in each
sub interval  as shown in figure   a  





 



 




 









figure    an example to show how a target moving from d  to d  during  tk   tk     is pror    r      a patroller either always protects the target
tected  in a sub interval  qk
qk
or never protects the target  equivalently  the target is either always within the
protective circle of a patroller or always outside the circle 

suppose uq  t  decreases linearly from   to   during  tk   tk     and c         we can then
calculate the attackers expected utility function atteu fq   t  for  tk   tk      as plotted in
figure   b   atteu fq   t  is linear in each sub interval but the function is discontinuous at
               because of the patroller leaving or entering the protection
the intersection points qk
qk
r from the left as 
range of the target  we denote the limit of atteu when t approaches qk
r
lim atteu fq   t    atteu fq   qk
 

r
tqk

similarly  the right limit is denoted as 
r 
lim atteu fq   t    atteu fq   qk
 

r 
tqk

   
if fq is the only target  an attacker can choose to attack at a time immediately after qk
getting an expected utility that is arbitrarily close to       according to equation      we
  
can get atteu fq   tk          and atteu fq   tk             both lower than atteu fq   qk
  
thus  the attacker can get a higher expected reward by attacking between tk and tk    
violating dasss quality guarantee 
however  because of discontinuities in the attackers expected utility function  a maximum might not exist  this implies that the minimax solution concept might not be welldefined for our game  we thus define our solution concept to be minimizing the supremum
of atteu fq   t  

   

fiprotecting moving targets with multiple mobile resources





    

    
    
    
    

    
    
  






 



 
 



 a  probability that the target is protected
is a constant in each sub interval 








 


 b  the attackers expected utility is linear
in each sub interval 

figure    sub interval analysis in  tk   tk     for the example shown in figure    
definition    the supremum of attackers expected utility is the smallest real number
that is greater than or equal to all elements of the infinite set  atteu fq   t    denoted as
sup atteu fq   t  
the supremum is the least upper bound of the function atteu fq   t   so for cass
model  equation   should be modified as
atteum
f   sup atteuf  fq   t 

    

q t

so a defender strategy f is minimax if atteum
f is maximized  i e  
f  arg minf   sup atteuf    fq   t 
  
  
in the above example  the supremum of attackers expected utility in  tk   tk     is atteu fq   qk
      in the rest of the paper  we will not specify when supremum is used instead of maximum as it can be easily inferred from the context 
how can we deal with the possible attacks between the discretized points and find an
optimal defender strategy  we generalize the process above  called sub interval analysis 
to all possible edges ei j k   we then make use of the piecewise linearity of atteu fq   t 
and the fact that the potential discontinuity points are fixed  which allows us to construct
a linear program that solves the problem to optimality  we name the approach cass
 solver for continuous attacker strategies  
we first introduce the general sub interval analysis  for any target fq and any time
interval  tk   tk      we calculate the time points at which edges ei j k and l q   l q intersect 
denoted as intersection points  we sort the intersection points in increasing order  denoted
r   r           m   where m
 
as qk
qk
qk is the total number of intersection points  set qk   tk and
m

qkqk

  

r    r      r           m  
  tk     thus  tk   tk     is divided into sub intervals  qk
qk
qk

lemma    for any given target fq   atteu fq   t  is piecewise linear in t  furthermore 
there exists a fixed set of time points  independent of the defenders mixed strategy  such
that atteu fq   t  is linear between each adjacent pair of points  specifically  these points
r defined above 
are the intersection points qk
   

fifang  jiang    tambe

r    r     for a target f   a feasible edge e
proof  in each sub interval  qk
q
i j k is either
qk
 
 
totally above or below lq   and similarly for lq   otherwise there will be a new intersection
point which contradicts the definition of the sub intervals  if edge ei j k is between l q and
l q   the distance between a patroller taking the edge and target fq is less than re   meaning
the target is protected by the patroller  as edge ei j k is taken with probability f  i  j  k  
the total probability that the target is protected   fq   t   is the sum of f  i  j  k  whose
corresponding edge ei j k is between the two lines in a sub interval  so  fq   t  is constant
in t in each sub interval and thus the attackers expected utility atteu fq   t  is linear in
each sub interval according to equation   as uq  t  is linear in  tk   tk      discontinuity can
only exist at these intersection points and an upper bound on the number of these points
for target fq is m n    
r    r      and  
define coefficient arqk  i  j  to be c  if edge ei j k is between l q and l q in  qk
qk
otherwise  according to equation     and the fact that  fq   t  is the sum of f  i  j  k  whose
r    r     
corresponding coefficient arqk  i  j    c    we have the following equation for t   qk
qk


n x
n
x

    
atteu fq   t      
arqk  i  j f  i  j  k   uq  t 
i   j  

piecewise linearity of atteu fq   t  means the function is monotonic in each sub interval and
the supremum can be found at the intersection points  because of linearity  the supremum
r    r     can only be chosen from the one sided limits of the endpoints 
of atteu in  qk
qk
 r   

r 
  and atteu fq   qk
   furthermore  if uq  t  is decreasing in  tk   tk     
atteu fq   qk
the supremum is
 r   
r 
  and otherwise it is atteu fq   qk
   in other words  all other attackers
atteu fq   qk
r  
r or  r     thus  cass
r
strategies in  qk   qk   are dominated by attacking at time close to qk
qk
adds new constraints to constraints     which consider attacks to occur at t   tk   tk     
we add one constraint for each sub interval with respect to the possible supremum value
in this sub interval 

min

z

    

f  i j k  p i k 

subject to constraints             
 r   

r 
z  max atteu fq   qk
   atteu fq   qk

  

    

k           m    q           l   r           mqk  
this linear program stands at the core of cass and we will not differentiate the name
for the solver and the name for the linear program in the following  all the linear constraints included by constraint    can be added to cass using algorithm    the input
of the algorithm include targets schedules  sq    the protection radius re   the speed limit
vm   the set of discretized time points  tk   and the set of discretized distance points  di   
function calint l q   l q   vm   in line   returns the list of all intersection time points between
  and
all possible edges ei j k and the parallel lines l q   l q   with additional points tk as qk
m

  

r    r     in line   returns the coefficient
tk   as qkqk   function calcoef l q   l q   vm   qk
qk
r
r
matrix aqk   aqk can be easily decided by checking the status at the midpoint in time  set

   

fiprotecting moving targets with multiple mobile resources

r    r       and denote the patrollers position at t
tmid    qk
mid when edge ei j k is taken as
qk
ei j tmid   thus arqk  i  j    c  if ei j tmid  q  tmid    lines    add a constraint with respect
 r   

r 
to the larger value of atteu fq   qk
  and atteu fq   qk
  to cass for this sub interval
r  
r
 qk   qk    it means when the attacker chooses to attack fq in this sub interval  his best
r    r     
choice is decided by the larger value of the two side limits of atteu in  qk
qk

algorithm    add constraints described in constraint   
input  sq   re   vm    tk     di   
for k             m    do
for q             l do
l q  sq   re   l q  sq  re  
m

  

             qk
 calint l q   l q   vm   
qk
qk
for r             mqk do
r    r     
arqk  calcoef l q   l q   vm   qk
qk
if uq  t  is decreasing in  tk   tk     then
r 
add constraint z  atteu fq   qk
 
end
else
 r   
add constraint z  atteu fq   qk
 
end
end
end
end

theorem    cass computes  in polynomial time  the exact solution  minimax  of the
game with discretized defender strategies and continuous attacker strategies 
proof  according to lemma    atteu fq   t  is piecewise linear and discontinuity can
r   these intersection points divide the time space
only occur at the intersection points qk
into sub intervals  because of piecewise linearity  the supremum of atteu fq   t  equals to
the limit of an endpoint of at least one sub interval  for any defenders strategy f that is
feasible  a feasible z of the linear program       is no less than any of the limit values at the
intersection points according to constraint    and values at the discretized time points tk
according to constraint     and thus v can be any upper bound of atteu fq   t  for f   as z
is minimized in the objective function  z is no greater than the supremum of atteu fq   t 
given any defender strategy f   and further z will be the minimum of the set of supremum
corresponding to all defender strategies  thus we get the optimal defender strategy f  
the total number of variables in the linear program is o m n      the number of constraints represented in algorithm   is o m n   l  as the number of intersection points is at
most   m    n   for each target  the number of constraints represented in constraints
    is o m n      thus  the linear program computes the solution in polynomial time 
corollary    the solution of cass provides a feasible defender strategy of the original
continuous game and gives exact expected value of that strategy 
   

fifang  jiang    tambe

    generalized model with multiple defender resources
in this subsection  we generalize dass and cass to solve the problem with multiple defender resources  when there are multiple patrollers  the patrollers will coordinate with
each other  recall the protection coefficient cg in definition    a target is better protected
when more patrollers are close to it  within radius re    so the protection provided to a
target is determined when all patrollers locations are known  thus it is not sufficient to
calculate the probability that an individual edge is taken as in the single patroller case 
under the presence of multiple patrollers  we need a more complex representation to explicitly describe the defender strategy  to illustrate generalization to the multiple defender
resources case  we first take two patrollers as an example  if there are two patrollers  the
patrol strategy can be represented using flow distribution variables  f  i    j    i    j    k    here
the flow distribution variables are defined on the cartesian product of two duplicated sets
of all feasible edges  ei j k    f  i    j    i    j    k  is the joint probability of the first patroller
moving from di  to dj  and the second patroller moving from di  to di  during time tk to
tk     i e   taking edge ei   j   k and ei   j   k respectively  the corresponding marginal distribution variable p i    i    k  represents for the probability that the first patroller is at di  and
the second at di  at time tk   protection coefficients c  and c  are used when one or two
patrollers are protecting the target respectively 
so the attackers expected utility can be written as
atteu fq   t         c      fq   t    c      fq   t     uq  t 
   fq   t  is the probability that only one patroller is protecting the target fq at time t
and    fq   t  is the probability that both patrollers are protecting the target  for attacks
that happen at discretized points tk   we can make use of i i  q  k  in definition   and
i i    q  k    i i    q  k  is the total number of patrollers protecting the ferry at time tk  
x
   fq   tk    
p i    i    k 
i   i   i i   q k  i i   q k   
x
   fq   tk    
p i    i    k 
i   i   i i   q k  i i   q k   

constraints for attacks occurring in  tk   tk     can be calculated with an algorithm that
looks the same as algorithm    the main difference is in the coefficient matrix arqk and
the expression of atteu  we set the values in the coefficient matrix arqk  i    j    i    j    as c 
if both edges ei   j   k and ei   j   k are between l q and l q   and c  if only one of the edges
r    r     is
protects the target  the attackers expected utility function in  qk
qk
x
atteu fq   t       
arqk  i    j    i    j   f  i    j    i    j    k    uq  t 
i   j   i   j 

for a general case of w defender resources  we can use  f  i    j         iw   jw   k   to represent the patrol strategy 
definition    the compact representation for multiple defender resources is a compact way
to represent the defenders mixed strategy using flow distribution variables  f  i    j         iw   jw   k   
 f  i    j         iw   jw   k   is the joint probability that patroller moving from diu at time tk to
dju at time tk   for u           w  
   

fiprotecting moving targets with multiple mobile resources

given the generalized compact representation  we get the following equations for calculating the attackers expected utility function and the protection probability 


w
x
atteu fq   t      
cq  q  fq   t   uq  t 
q  

q  fq   tk    

x
i       iw  

w
p

p i            iw   k 
i iu  q k  q

u  

q is the number of patrollers protecting the target  we can modify algorithm   to apply
for the multiple defender resource case  set arqk  i    j         iw   jw   as cq if q of the edges
 eiu  ju  k   are between l q and l q  
we conclude the linear program for generalized cass for multiple patrollers as follows 
min

z

    

f  i   j       iw  jw  k  p i       iw  k 

f  i    j            iw   jw   k       i            iw   j            jw such that u   dju  diu     vm t
    
n
n
x
x
p i            iw   k   
   
f  j    i            jw   iw   k      i            iw   k    
j    

jw   

n
x

n
x

    
p i            iw   k   

   

j    

f  i    j            iw   jw   k   i            iw   k   m

jw   

    
n
x
i    

   

n
x

p i            iw   k       k

    

iw   

z  atteu fq   tk    q  k
z

 r   
r 
max atteu fq   qk
   atteu fq   qk
    k  q  r

    
    

the number of variables in the linear program is o m n  w   and the number of constraints is o m n w    it is reasonable to examine potentially more efficient alternatives 
we summarize the results of such an examination below concluding that using the current
linear program would appear to currently offer our best tradeoff in terms of solution quality and time at least for the current domains of application  although as discussed below 
significant future work might reveal alternatives approaches for other future domains 
the first question to examine is that of the computational complexity of the problem
at hand  generating optimal patrolling strategies for multiple patrollers on a graph  unfortunately  despite significant attention paid to the topic  currently  the complexity remains
unknown  more specifically  the question of computational complexity of generating patrols
for multiple defenders on graphs of different types has received significant attention  letchford        korzhyk et al          these studies illustrate that in several cases the problem
is np hard  in some cases the problem is known to be polynomial time  but despite significant effort  the problem complexity in many cases remains unknown  letchford   conitzer 
   

fifang  jiang    tambe

       unfortunately  our graph turns out to be different from the cases considered in their
work  indeed  the dass model can be explained as a game with homogeneous defender
resources patrolling on a graph  similar to the cases that have already been considered 
however  prior results cannot explain the complexity of our game as the structure of our
graph does not fit any of the prior graphs 
given that computational complexity results are not directly available  we may examine
approaches to provide efficient approximations  here we provide an overview of two such
approaches  providing experimental results in section         our first approach attempts
to provide a more compact representation in the hope of providing a speedup  to that end 
we apply an intuitive approach that uses individual strategy profile for each patroller and
then calculates a best possible mixed strategy combination  unfortunately  this approach
is inefficient in run time even for the dass model and may result in a suboptimal solution 
thus  although more compact  this approach fails to achieve our goal  we explain this
approach next 
assume each patroller independently follows her own mixed strategy  denote the individual mixed strategy for patroller u as fu  iu   ju   tk    and the probability that a target is
protected by q players can be represented as a polynomial expression of  fu  iu   ju   tk    of
order q  then our optimization problem is converted to minimizing objective function z
with non linear constraints  assume we have two patrollers  and for a potential attack at
target q at time tk   we denote the probability that patroller u is protecting the target as
 u    u is linear in fu   and the attackers expected utility for this attack can be represented
as
atteu fq   tk         c                              c         uq  tk  
so a constraint z  atteu fq   tk   is quadratic in f   due to the fact that the joint probability
is represented by the product of the individual probability of each patroller  these constraints are not ensured to have a convex feasible region and there is no known polynomial
algorithms for solving this kind of non convex optimization problems  we attempt to solve
the problem by converting it into a mathematical program with a non convex objective function and linear constraints  i e   instead of minimizing z with constraints z  atteu fq   tk   
we incorporate the constraints into the objective function as
z   max atteu fq   tk   
q k

    

the results in section       show that when we solve this mathematical program in matlab using function fmincon with interior point method for the dass model  the algorithm
fails to get to a feasible solution efficiently and even when enough time is given  the solution
can still be suboptimal as it may get stuck at a local minimum  to conclude  although this
approach is more compact and helps in saving memory  it is inefficient in run time and may
result in loss in solution quality 
our second approach takes a further step to reduce the run time complexity  making
it a polynomial approximation algorithm  but it can lead to a high degradation in solution quality  in this approach  we iteratively compute the optimal defender strategy for a
newly added resource unit given the existing strategies for the previous defender resources 
namely  we first calculate f   i    j    tk   as if only one patroller is available and then calculate
   

fiprotecting moving targets with multiple mobile resources

f   i    j    tk   given the value of f   i    j    tk    in this way  we need to solve w linear programs
with complexity o m n     so this approach is much faster compared to the former one  unfortunately  this approach fails to capture the coordination between the patrollers effectively
and thus may result in a high degradation in solution quality  for example  suppose there
are only two targets of constant utility u   one target stays at terminal a and the other one
stays at terminal b  further  suppose the protection coefficient is always   when a target
is protected by one or more patrollers  when two patrollers are available  the optimal solution would be each protect one of the targets all the way  so both targets are protected
with probability   and the expected utility function for the attacker is    if the defender
strategy is calculated for each patroller sequentially as discussed above  the solution would
be protect each target with probability     for both players  making the attackers expected
utility      u   in other words  we reach a suboptimal solution  wasting resources when
both patrollers end up protecting the same target with probability       in this case  we
can already see that there is a      probability that a target is unprotected when clearly
an optimal solution existed that protected all targets with probability    thus  even with
just two patrollers this solution leads to a potentially significant loss in expected utility 
therefore  this solution clearly appears to be inadequate for our purposes 
given the above discussion  it would appear that a fast approximation may lead to
significant losses in solution quality or may not be efficient enough  fortunately for current
application domains  such as the current deployment of cass for protecting ferries  e g  
the staten island ferry in new york   the number of defender resources are limited  the
lack of resources is the main reason that optimization using security games becomes critical 
as a result  our current approach of cass is adequate for current domains such as ferry
protection  further research about scale up is an issue for future work 

   equilibrium refinement
a game often has multiple equilibria  since our game is zero sum  all equilibria achieve
the same objective value  however  if an attacker deviates from his best response  some
equilibrium strategies for the defender may provide better results than others 
consider the following example game  there are two targets moving during  t    t     no
further discretization   one moves from d  to d  and the other moves from d  to d   see
figure   a    suppose d   d    d   d    d and re      d  there is only one patroller
available and the protection coefficient c       both targets utility functions decrease
from    to   in  t    t     see figure   b    in one equilibrium  f        f             i e   the
patroller randomly chooses one target and follows it all the way  in another equilibrium 
f        f             i e   the patroller either stays at d  or at d    in either equilibrium 
the attackers best response is to attack at t    with a maximum expected utility of   
however  if an attacker is physically constrained  e g   due to launch point locations  to
only attack no earlier than t  and t        where    is the only intersection time point and
      t    t        against both defender strategies he will choose to attack either of the
targets at t    the attackers expected utility is uq  t      in the first equilibrium because
there is     probability that the patroller is following that target  however in the second
equilibrium  he is assured to succeed and get a utility of uq  t    because the distance between
the chosen target and d   or d    is larger than re at t    i e   the chosen target is unprotected
   

fifang  jiang    tambe

at t    in this case  the defender strategy in the first equilibrium is preferable to the one in
the second  indeed  the first defender strategy dominates the second one  by which we mean
the first is equally good or better than the second no matter what strategy the attacker
chooses  we provide a formal definition of dominance in section     




 



  



  
 








 







 a  two targets moves with schedules s 
and s   

 





 b  utility function is the same for both
targets and is decreasing linearly over
time 

figure    an example to show one equilibrium outperforms another when the attacker is
constrained to attack in  t    t    if t        
our goal is to improve the defender strategy so that it is more robust against constrained
attackers while keeping the defenders expected utility against unconstrained attackers the
same  this task of selecting one from the multiple equilibria of a game is an instance of
the equilibrium refinement problem  which has received extensive study in game theory
 van damme        fudenberg   tirole        miltersen   srensen         for finite
security games  an  tambe  ordonez  shieh  and kiekintveld        proposed techniques
that provide refinement over stackelberg equilibrium  however there has been little prior
research on the computation of equilibrium refinements for continuous games 
in this section  we introduce two equilibrium refinement approaches  route adjust
 section      and flow adjust  section       both approaches can be applied to improve
any feasible defender strategy and when they are applied to an optimal defender strategy
in an existing equilibrium  we will get new equilibria with more robust optimal defender
strategies 
for expository simplicity  we still use the single resource case as an example  but both
methods are applicable to the multiple resources case  the results shown in evaluation
section experimentally illustrates these two refinement methods can significantly improve
the performance 
    route adjust
given that f is the defender strategy of one equilibrium of the game  if we can find a defender
strategy f   such that for any attacker strategy  q  t   the defenders expected utility under
f   is equal to or higher than the one under f   and the one under f   is strictly higher than
the one under f for at least one specific attacker strategy  we say that f   dominates f  
intuitively  the defender should choose f   instead of f as f   is at least as good as f for any
   

fiprotecting moving targets with multiple mobile resources

attacker strategy and can achieve better performance for some attacker strategies  so an
equilibrium with strategy f   is more robust to unknown deviations on the attacker side  we
give the formal definition of dominance as follows 
definition    defender strategy f dominates f   if q  t  defeuf  fq   t   defeuf    fq   t  
and q  t  defeuf  fq   t    defeuf    fq   t   or equivalently in this zero sum game  q  t 
atteuf  fq   t   atteuf    fq   t   and q  t  atteuf  fq   t    atteuf    fq   t  
corollary    defender strategy f dominates f   if q  t   fq   t       fq   t  and q  t 
 fq   t        fq   t  
definition   simply restates the commonly used weak dominance definition in game
theory for this specific game  corollary   follows from equation     
in this section  we introduce the route adjust approach which gives a procedure for
finding a defender strategy f   that dominates the given defender strategy f     route adjust
provides final routes using these steps   i  decompose flow distribution f   into component
routes   ii  for each route  greedily find a route which provides better protection to targets 
 iii  combine the resulting routes into a new flow distribution  f     which dominates f   if
f   is different from f    the detailed process is listed in algorithm    we illustrate this
approach using a simple dominated strategy shown in figure   
to accomplish step  i   we decompose the flow distribution by iteratively finding a route
that contains the edge with minimum probability  as shown in figure    we first randomly
choose a route that contains edge e        as f                 is the minimum among all flow
variables  we choose r     d    d    d     and set p r      f                  then for each
edge of the route r  we subtract     from the original flow  resulting in a residual flow  we
continue to extract routes from the residual flow until there is no route left  denote by z
the number of non zero edges in the flow distribution graph  then z is decreased by at least
  after each iteration  so the algorithm will terminate in at most z steps and at most z
routes are found  the result of step  i  is a sparse description of a defender mixed strategy
in full representation  as we will discuss in section    this decomposition constitutes one
method of executing a compact strategy 
for step  ii   we adjust each of the routes greedily  to that end  we first introduce the
r and the coefficient
dominance relation of edges and routes  using the intersection points qk
r
matrix aqk  i  j  defined in section     
definition    edge ei j k dominates edge ei   j    k in  tk   tk     if arqk  i  j   arqk  i    j     
q      l  r      mqk   and q  r such that arqk  i  j    arqk  i    j     
the dominance relation of edges is based on the comparison of protection provided to
the targets in each sub interval  in the following dominance relation of routes  we denote
the edge eru  k  ru  k    k as e u  k  to simplify the notation   
definition    route ru    dru               dru  m     dominates ru     dru                dru   m     if
k           m     e u  k    e u    k  or e u  k  dominates e u    k  and k such that e u  k 
dominates e u    k  
route ru dominates ru  if each edge of ru is either the same as or dominates the
corresponding edge in ru  and at least one edge in ru dominates the corresponding edge
in ru   
   

fifang  jiang    tambe

algorithm    route adjust
input  a mixed defender strategy f
output  an updated mixed defender strategy f  
 i  decompose f into multiple routes by iteratively finding a route that contains
the edge with minimum probability 
 a  initialize the remaining flow distribution f   f and route set s    
initialize probability distribution over routes p ru        u 
 b  while max f i  j  k      do
i  set  i    j    k      arg mini j k f i j k    f i  j  k  
ii  set fmin   f i    j    k    
iii  find an arbitrary route ru  such that ru   k       i  and ru   k     
j   i e   edge ei   j   k  is in the route  and f ru   k   ru   k     k      
k  i e   all edges in the route has non zero remaining flow  
iv  add ru  to s and set p ru      fmin  
v  set f i  j  k    f i  j  k   fmin if ru   k       i and ru   k    j 
end
 ii  adjust each route in s greedily to get a new set of routes s   and the corresponding new probability distribution p   
 a  initialize the new set s      and new probability distribution p   ru       
u 
 b  while s     do
i  pick a route ru from s 
ii  adjust ru to get new route ru    for a given ru and a specified
k    set ru   k    ru  k  if k    k    set ru   k      i  such that    
e u    k      and e u    k    meet the speed constraint     ru  dominates ru with the choice of i       ru  is not dominated by a route
with any other choice of i    if no such i  exists  set ru   k      ru  k   
iii  add ru to s   and set p   ru      p ru   
iv  remove ru from s 
end
 iii  reconstruct a new compact representation f   from s   and p  according to
equation   

   

fiprotecting moving targets with multiple mobile resources

        
p r      

        
p r     



















 


















        
p r      

 














figure    step  i   decomposition  every time a route containing the minimal flow variable
is subtracted and a residual graph is left for further decomposition  the original flow distribution is thus decomposed into three routes r    r    and r  with
probability          and     respectively 

denote the original route to be adjusted as ru and the new route as ru    a greedy
way to improve the route is to replace only one node in the route  if we want to replace
the node at time tk   then we have ru   k    ru  k   k    k  and dru  k   in the original
route is replaced with dru   k     so the patrollers route changes only in  tk     tk       thus 
only edges e u  k      and e u  k    in the original route are replaced by e u    k      and
e u    k    in the new route 
we are trying to find a new route ru  that dominates the original route to provide equal
or more protection to the targets  so the selection of ru   k    needs to meet the requirements
specified in algorithm    the first one describes the speed limit constraint  the second
one actually requires the changed edges e u    k      and e u    k    are either equal to or
dominate the corresponding edges in the original route  and dominance relation exist for at
least one edge   the third requirement attains a local maximum  if such a new node does
not exist for a specified k    we return the original route ru  
we can iterate this process for the new route and get a final route denoted by ru  after
several iterations or when the state of convergence is reached  when the state of convergence
is reached  the resulting route ru  keeps unchanged no matter which k  is chosen for the
next iteration 
for the example in figure    assume the only targets moving schedule is d   d   d   
d   d    d   d    d  re      d and utility function is constant  we adjust each route
for only one iteration by changing the patrollers position at time t    i e   ru      as t  is
the last discretized time point  only edge e u     may be changed  for r     d    d    d    
we enumerate all possible patrollers positions at time t  and choose one according to the
three constraints mentioned above  in this case  the candidates are d  and d    so the
corresponding new routes are r   unchanged  and r     d    d    d    respectively  note that
edge ed   d     dominates ed   d     because the former one protects the target all the way in
 t    t    and thus r  dominates r    so d  is chosen as the patrollers position at t  and r 
   

fifang  jiang    tambe

is chosen as the new route  the adjustment for all routes with non zero probability after
decomposition is shown in table   
ru
r     d    d    d   
r     d    d    d   
r     d    d    d   

p ru   after decomposition
   
   
   

adjusted routes
 d    d    d      r 
 d    d    d      r 
 d    d    d      r 

table    step  ii   adjust each route greedily 

r 
r 
r 
r 

ru
   d    d    d   
   d    d    d   
   d    d    d   
   d    d    d   

p   ru   after adjustment
 
   
 
   

composed flow distribution




 




table    step  iii   compose a new compact representation 
the new routes we get after step  ii  are same as the original routes or dominate the
original routes  that is  whenever a route ru is chosen according to the defender mixed
strategy resulting from step  i   it is always equally good or better to choose the corresponding new route ru  instead  because ru  provides equal or more protection to the
targets than ru   suppose there are h possible routes in the defender strategy after step
 i   denoted as r         rh   after adjusting the routes  we get a new defender strategy
 p   r     p   r          p   rh    in full representation  see table     some routes are taken with
higher probability  e g  p   r                       and some are with lower probability
 e g  p   r         compared to the original strategy  for step  iii   we reconstruct a new
compact representation according to equation    this is accomplished via a process that
is the inverse of decomposition and is exactly the same as how we map a strategy in full
representation into compact representation  for the example above  the result is shown in
table   
theorem    after steps  i  iii   we get a new defender strategy f   that dominates the
original one f   if f   is different from f    
proof  we continue to use the notation that the decomposition in step  i  yields the
routes r         rh   for each flow distribution variable in the original distribution f    i  j  k   it
is decomposed into h sub flows  fu   i  j  k   according to the route decomposition  fu   i  j  k   
p ru   if i   ru  k   j   ru  k      and fu   i  j  k      otherwise  thus we have the following
equation 
xh
f    i  j  k   
f    i  j  k 
    
u   u
x
 
fu   i  j  k 
    
u ru  k  i ru  k    j

after adjust each route separately  each non zero sub flow fu   i  j  k  on edge e u  k  is moved
to edge e u    k  as route ru is adjusted to ru    reconstructing the flow distribution f  
   

fiprotecting moving targets with multiple mobile resources

can also be regarded as adding up all the sub flows after adjustment together on each edge 
that means  f   is composed of a set of sub flows after adjustment  denoted as  fu   i    j     k   
the subscript u represents for the index of the original route to indicate it is moved from
edge e u  k   so fu   i    j     k    fu   ru  k   ru  k       k   if i    ru   k  and j     ru   k      
otherwise fu   i    j     k       similarly to equation     we have the following equation for f    
f    i    j     k   
 

xh

f    i    j     k 
u   u

x
u   ru   k  i   ru   k    j  

    
fu   i    j     k 

    

based on how the adjustment is made  ru  is same as or dominates ru and thus e u    k 
is same as or dominates e u  k   so if edge e u  k  protects target fq at time t  the
corresponding edge e u    k  after adjustment also protects target fq at time t 
recall from section     that  fq   t  is the sum of f  i  j  k  whose corresponding edge
ei j k can protect the target fq at time t  we denote by     fq   t  and     fq   t  the probabilities of protection corresponding to f   and f   respectively  according to equation    
    fq   t  can be viewed as the sum of all the non zero sub flows fu   i  j  k  where the corresponding e u  k  protects the target fq at time t  if fu   i  j  k  is a term in the summation
to calculate     fq   t   it means e u  k  protects fq at t and thus the corresponding e u    k 
protects fq at t  so the corresponding sub flow fu   ru   k   ru   k       k  in f   is also a term in
the summation to calculate     fq   t   it leads to the conclusion     fq   t       fq   t   note
that if q  t      fq   t        fq   t   then all routes kept unchanged in step  ii  as otherwise
it contradicts with the fact that the new route dominates the original route  according to
corollary    we have f   dominates f   if it is different from f    
in the example in figure    f             is decomposed into two non zero terms f              
    and f                   along with routes r  and r   see figure     after adjustment  we
get the corresponding subflows f                    f                    recall that the targets
schedule is d   d   d    the flow distribution after adjustment  see table    gives more
protection to the target in  t    t     since the flow is equal from t  to t   and therefore the
protection is the same   overall the new strategy dominates the old strategy 
therefore  if we apply route adjust to the optimal defender strategy calculated by cass
we get a more robust equilibrium  while step  iii  allows us to prove theorem    notice
that at the end of step  ii   we have a probability distribution over a set of routes from
which we can sample actual patrol routes  for two or more defender resources  a generalized
version of definition   can be used to define the dominance relation on the edge tuple
 ei   j   k        eiw  jw  k   with coefficient matrix for multiple patrollers arqk  i    j         iw   jw   
there are other ways to adjust each route  instead of adjusting only one node in the
route  we can adjust more consecutive nodes at a time  for example  we can adjust both
ru   k    and ru   k       by checking edges e u    k       e u    k    and e u    k        however 
we need to tradeoff the performance and the efficiency of the algorithm  this tradeoff will
be further discussed in section   
    flow adjust
whereas route adjust tries to select an equilibrium that is robust against attackers playing
suboptimal strategies  the second approach  flow adjust  attempts to select a new equilibri   

fifang  jiang    tambe

um that is robust to rational attackers that are constrained to attack during any time interval  tk   tk      as we will discuss below  flow adjust focuses on a weaker form of dominance 
which implies that a larger set of strategies are now dominated  and thus could potentially
be eliminated  compared to the standard notion of dominance used by route adjust  however flow adjust does not guarantee the elimination of all such dominated strategies  we
denote by defeukf the defender expected utility when an attacker is constrained to attack
during time interval  tk   tk     when the attacker provides his best response given the defender strategy f   formally  defeukf   minq     l  t tk  tk      defeuf  fq   t    we give the
following definition of local dominance 
definition     defender strategy f locally dominates f   if defeukf  defeukf     k  
corollary    defender strategy f locally dominates f   if
min
q     l  t tk  tk    

 defeuf  fq   t   

min
q     l  t tk  tk    

 defeuf    fq   t    k 

or equivalently in this zero sum game 
max
q     l  t tk  tk    

 atteuf  fq   t   

max
q     l  t tk  tk    

 atteuf    fq   t    k 

corollary   follows from the fact that the attacker plays a best response given the
defender strategy  and it means that f locally dominates f   if the maximum of attacker
expected utilities in each time interval  tk   tk     given f is no greater than that of f    
compared to definition    which gives the standard condition for dominance  local
dominance is a weaker condition  that is  if f dominates f   then f locally dominates f    
however the converse is not necessarily true  intuitively  whereas in definition   the attacker
can play any  possibly suboptimal  strategy  here the attackers possible deviations from
best response are more restricted  as a result  the set of locally dominated strategies
includes the set of dominated strategies  from definition     if f locally dominates f     and
the attacker is rational  i e   still playing a best response  but constrained to attack during
some time interval  tk   tk      then f is preferable to f   for the defender  a further corollary
is that even if the rational attacker is constrained to attack in the union of some of these
intervals  f is still preferable to f   if f locally dominates f     one intuition for the local
dominance concept is the following  suppose we suspect the attacker will be restricted to
a  unknown  subset of time  due to some logistical constraints  such logistical constraints
would likely make the restricted time subset to be contiguous or a union of a small number
of contiguous sets  since such sets are well approximated by unions of intervals  tk   tk      
local dominance can serve as an approximate notion of dominance with respect to such
attackers 
flow adjust looks for a defender strategy f   that locally dominates the original defender
strategy f     to achieve this  we simply adjust the flow distribution variables f  i  j  k  while
keeping the marginal probabilities p i  k  the same  figure   shows an example game with
two discretized intervals  t    t    and  t    t     only the first interval is shown   suppose the
maximal attacker expected utility is  u  in this equilibrium and is attained in the second
   we dont require that there exists at least one k such that defeukf   defeukf    

   

fiprotecting moving targets with multiple mobile resources

interval  t    t     if the attackers utility for success is a constant u  in the first interval
 t    t     then the defender strategy in  t    t    could be arbitrarily chosen because the attackers
expected utility in  t    t    in worst case is smaller than that of the attackers best response in
 t    t     however  if a attacker is constrained to attack in  t    t    only  the defender strategy
in the first interval will make a difference  in this example  there is only one target moving
from d  to d  during  t    t     the schedule of the ferry is shown as dark lines and the parallel
lines l   and l   with respect to protection radius re       d   d    are shown as dashed
lines  the marginal distribution probabilities p i  k  are all     and protection coefficient
c       in f     the defenders strategy is taking edges e      and e      with probability
    and the attackers maximum expected utility is u    which can be achieved around time
 t    t      when neither of the two edges e      and e      are within the targets protection
range  if we adjust the flows to edge e      and e        as shown in figure   b   the attackers
maximum expected utility in  t    t    is reduced to    u  as edge e      is within the targets
protection range all the way  so a rational attacker who is constrained to attack between
 t    t    will get a lower expected utility given defender strategy f   than given f     and thus
the equilibrium with f   is more robust to this kind of deviation on the attacker side 

 

 








 




 


 a  f     the patroller is taking
edges e      and e      with
probability     










 b  f     the patroller is taking
edges e      and e      with
probability     

figure    an example of flow adjust  an rational attacker who is constrained to attack in
 t    t    will choose to attack around time  t    t      to get utility u  given f   and
attack around t  or t  to get utility    u  given f    

so in flow adjust  we construct m    new linear programs  one for each time interval
 tk   tk       k            m    to find a new set of flow distribution probabilities f  i  j  k   
to achieve the lowest local maximum in  tk   tk      with unchanged p i  k    and p i  k       
   

fifang  jiang    tambe

the linear program for an interval  tk   tk      is shown below 
min v

f  i j k  

f  i  j  k         if  dj  di     vm  t
n
x

p i  k       
f  j  i  k     i           n 
j  

p i  k     

n
x

f  i  j  k     i           n 

j  

v  atteu  fq   tk    q           l   k   k    k      
 r   

r 
v  max atteu  fq   qk
    atteu  fq   qk 

  

q           l   r           mqk  
while the above linear program appears similar to the linear program of cass  they have
significant differences  unlike cass  the marginal probabilities p i  k    here are known
constants and are provided as input and as mentioned above  there is a separate program
for each  tk   tk       thus  we get f  i  j  k    such that the local maximum in  tk   tk      is
minimized  denote the minimum as vk    from the original flow distribution f     we get
atteuf    fq   t  and we denote the original local maximum value in  tk   tk      as vk    as
the subset  f    i  j  k     of the original flow distribution f   is a feasible solution of the linear
program above  we have vk   vk    noting that the equality happens for the interval from
which the attackers best response is chosen 
note that any change made to f  i  j  k  in an interval  tk   tk      will not affect the
performance of f in other intervals as the marginal probabilities p i  k  are kept the same 
i e   changing f  i  j  k    based on the linear program above is independent from any change
to f  i  j  k   k    k    so we can solve the m    linear programs independently  after
calculating f  i  j  k    for all k       m     we can get the new defender strategy f   by
combining the solutions f  i  j  k    of the different linear programs together  as vk   vk   
we have
max
q     l  t tk  tk     

atteuf    fq   t  

max
q     l  t tk  tk     

atteuf    fq   t 

for all k       m     i e   f   locally dominates f    
on the other hand  while we have restricted the strategies to have the same p i  k  
there may exist another strategy f   with a different set of p i  k  that locally dominates f    
finding locally dominating strategies with different p i  k  from the original is a topic of
future research 
although the two refinement approaches we provide do not necessarily lead to a nondominated strategy under the corresponding dominance definition  these two approaches
are guaranteed to find a more robust  or at least indifferent  equilibrium when faced with
constrained attackers compared to the original equilibrium we obtain from cass  clearly 
these two refinement approaches do not exhaust the space of refinement approaches 
other refinement approaches are possible that may lead to other equilibria that are better
   

fiprotecting moving targets with multiple mobile resources

than  e g  dominate  the one found by cass  however  it is likely that different defender
strategies resulting from different equilibrium refinements are not comparable to each other
in terms of dominance  i e   with some constrained attackers  one equilibrium might turn
out to be better and with other constrained attackers  another equilibrium might be better 
their computational costs may differ as well  thus  understanding this space of refinement
approaches in terms of their computational cost and output quality  and determining which
approach should be adopted under which circumstances is an important challenge for future
work 

   extension to two dimensional space
both dass and cass presented in section   are based on the assumption that both the
targets and the patrollers move along a straight line  however  a more complex model is
needed in some practical domains  for example  figure   shows a part of the route map of
washington state ferries  where there are several ferry trajectories  if a number of patroller
boats are tasked to protect all the ferries in this area  it is not necessarily optimal to simply
assign a ferry trajectory to each of the patroller boat and calculate the patrolling strategies
separately according to cass described in section    as the ferry trajectories are close to
each other  a patrolling strategy that can take into account all the ferries in this area will be
much more efficient  e g   a patroller can protect a ferry moving from seattle to bremerton
first  and then change direction halfway and protect another ferry moving from bainbridge
island back to seattle 

figure    part of route map of washington state ferries
in this section  we extend the previous model to a more complex case  where the targets and patrollers move in a two dimensional space and provide the corresponding linearprogram based solution  again we use a single defender resource as an example  and generalize to multiple defenders at the end of this section 
    defender strategy for   d
as in the one dimensional case  we need to discretize the time and space for the defender
to calculate the defenders optimal strategy  the time interval t is discretized into a set
of time points t    tk    let g    v  e  represents the graph where the set of vertices v
corresponds to the locations that the patrollers may be at  at the discretized time points in
t   and e is the set of feasible edges that the patrollers can take  an edge e  e satisfies
   

fifang  jiang    tambe

the maximum speed limit of patroller and possibly other practical constraints  e g   a small
island may block some edges  
    dass for   d
when the attack only occurs at the discretized time points  the linear program of dass
and described in section   can be applied to the two dimensional settings when the distance
in constraint   is substituted with euclidean distance in   d space of nodes vi and vj  
min

v

    

f  i j k  p i k 

f  i  j  k           i  j  k

    

f  i  j  k       i  j  k such that   vj  vi      vm t

    

p i  k   

n
x

f  j  i  k      i  k    

    

f  i  j  k   i  k   m

    

j  

p i  k   

n
x
j  

n
x

p i  k       k

    

i  

v  atteu fq   tk    q  k

    

note that f  i  j  k  now represents the probability that a patroller is moving from node vi to
vj during  tk   tk      recall in figure      a patroller protects all targets within her protective
circle of radius re   however  in the one dimensional space  we only care about the straight
line ab  so we used q  t     max sq  t   re   d     min sq  t    re   dn    as the protection
range of target fq at time t  which is in essence a line segment  in contrast  here the whole
circle needs to be considered as the protection range in the two dimensional space and the
extended protection range can be written as q  t     v    x  y      v  sq  t     re    this
change affects the value of i i  q  k  and thus the value of atteu  fq   tk   in constraint    
    cass for   d
when the attacking time t can be chosen from the continuous time interval t   we need to
analyze the problem in a similar way as in section      the protection radius is re   which
means only patrollers located within the circle whose origin is sq  t  and radius is re can
protect target fq   as we assume that the target will not change its speed and direction
during time  tk   tk      the circle will also move along a line in the   d space  if we track the
circle in a   d space where the x and y axes indicate the position in   d and the z axis is
the time  we get an oblique cylinder  which is similar to a cylinder except that the top and
bottom surfaces are displaced from each other  see figure      when a patroller moves
from vertex vi   v   to vertex vj during time  tk   tk      she protects the target only when
she is within the surface  in the   d space we described above  the patrollers movement
can be represented as a straight line 
   

fiprotecting moving targets with multiple mobile resources

d





v



v

  





  

r

figure     an illustration of the calculation of intersection points in the two dimensional
setting  the x and y axes indicates the position in   d and the z axis is the
time  to simplify the illustration  z axis starts from time tk   in this example 
there are two intersection points occurring at time points ta and tb  

intuitively  there will be at most two intersection points between the patrollers route
in   d space and the surface  this can be proved by analytically calculating the exact
time of these intersection points  assume the patroller is moving from v     x    y    to
v     x    y    and the target is moving from sq  tk      x    y    to sq  tk        x    y    during
 tk   tk      an illustration is shown in figure      to get the time of the intersection points 
we solve a quadratic equation with these coordination parameters and protection radius
re   we present the detailed calculation in appendix b  if a root of the quadratic equation
is within the interval  tk   tk      it indicates that the patrollers route intersects with the
surface at this time point  so there will be at most two intersection points  once we find all
these intersection points  the same analysis in section     applies and we can again claim
lemma    so we conclude that we only need to consider the attackers strategies at these
r as in the one dimensional case to denote
intersection points  we use the same notation qk
the sorted intersection points and get the following linear program for the   d case 
min

v

    

f  i j k  p i k 

subject to constraints             
 r   

r 
v  max atteu fq   qk
   atteu fq   qk

  

    

k           m    q           l   r           mqk  
algorithm   can still be used to add constraints to the linear program of cass for the
  d case  the main difference compared to cass in the   d case is that since euclidean
distance in   d is used in constraint    we need to use the extended definition of q  t  in
  d when deciding the entries in the coefficient matrix arqk  i  j  
for multiple defender resources  again the linear program described in section     is applicable when the extended definition of q  t  is used to calculate atteu and constraint   
   

fifang  jiang    tambe

is substituted with the following constraint 
f  i    j            iw   jw   k       i            iw   j            jw such that u  kvju  viu k   vm t 

   route sampling
we have discussed how to generate an optimal defender strategy in the compact representation  however  the defender strategy will be executed as taking a complete route  so
we need to sample a complete route from the compact representation  in this section  we
give two methods of sampling and show the corresponding defender strategy in the full
representation when these methods are applied 
the first method is to convert the strategy in the compact representation into a markov
strategy  a markov strategy in our setting is a defender strategy such that the patrollers
movement from tk to tk   depends only on the location of the patroller at tk   we denote
by  i  j  k  the conditional probability of moving from di to dj during time tk to tk   given
that the patroller is located at di at time tk   in other words  i  j  k  represents the chance
of taking edge ei j k given that the patroller is already located at node  tk   di    thus  given
a compact defender strategy specified by f  i  j  k  and p i  k   we have
 i  j  k    f  i  j  k  p i  k   if p i  k      

    

 i  j  k  can be an arbitrary number if p i  k       we can get a sampled route by first
determining where to start patrolling according to p i      then for each tk   randomly choose
where to go from tk to tk   according to the conditional probability distribution  i  j  k  
the distribution from this sampling procedure matches the given marginal variables as each
edge ei j k is sampled with probability p i  k  i  j  k    f  i  j  k   this sampling method
actually leads to a full representation where route ru    dru       dru            dru  m     is sampled
q  
with probability p ru         m
k    ru  k   ru  k       k   the product of the probability of
the initial distribution and the probability of taking each step  this method is intuitively
straightforward and the patrol route can be decided online during the patrol  i e   the
position of the patroller at tk   is decided when the patroller reaches its position at tk  
which makes the defender strategy more unpredictable  the downside of the method is
that the number of routes chosen with non zero probability can be as high as n m   for
  d case  the patroller is located at node vi at time tk   the sampling process is exactly
the same when  i  j  k  is used to denote the probability of moving from vi to vj during
 tk   tk     
the second method of sampling is based on the decomposition process mentioned in
section      step  i    as we discussed above for the first sampling method  sampling is
essentially restoring a full representation from the compact representation  as shown in
table    there are multiple ways to assign probabilities to different routes and the decomposition process of route adjust constructively defines one of them  so we can make use
of the information we get from the process  and sample a route according to the probability
assigned to each decomposed route  the number of routes chosen with non zero probability
is at most n   m   much less than the first method and thus it becomes feasible to describe
the strategy in full representation  by only providing the routes that are chosen with positive probability  different sampling approaches may be necessitated by different application
   

fiprotecting moving targets with multiple mobile resources

requirements  some applications might require that the defender obtain a strategy in full
representation and only be presented a small number of pure strategies  however  for other
applications  a strategy that can be decided on line  potentially with a hand held smartphone such as in  luber  yin  fave  jiang  tambe    sullivan        may be preferred 
therefore  based on the needs of the application  different sampling strategies might be
selected 

   evaluation
we use different settings in the ferry protection domain and compare the performance in
terms of the attackers expected utility atteu fq   t   as it is a zero sum game  a lower
value of atteu indicates a higher value of defenders expected utility 
we will run experiments both for   d and   d setting  we will evaluate the performance
of cass and show the sampling results  we will also evaluate the improvement of the two
refinement approaches for   d  section     shows our results for the   d setting  section
    for the   d setting 
    experiments for one dimensional setting
for   d setting  we first evaluate the performance of the solvers and then show how much
the performance can be improved by using the refinement methods  we also show sampled
routes for an example setting and evaluate cass for varying number of patrollers 
      experimental settings
we used the following setting for the experiments in one dimensional case  this is a complex
spatio temporal game  rather than a discrete security game as in most previous work  there
are three ferries moving between terminals a and b and the total distance ab      the
simulation time is    minutes  the schedules of the ferries are shown in figure     where
the x axis indicates the time and the y axis is the distance from terminal a  ferry   and
ferry   are moving from a to b while ferry   is moving from b to a  the maximum speed
for patrollers is vm       min and the protection radius is re        experiments in the
one dimensional case are using   patrollers  where c         and c          except in
section       where we report on experiments with different numbers of patrollers 

d  distance

 

   

 
 

ferry 
ferry 
ferry 

  

t  time

  

  

figure     schedules of the ferries

   

fifang  jiang    tambe

      performance of solvers
we compare the strategies calculated by cass with dass and a baseline strategy  in the
baseline strategy  the two patrollers choose a ferry with a probability of      uniformly
random  and move alongside it to offer it full protection  leaving the other two unprotected
 strategy observed in practice   first we wished to stress test cass by using more complex
utility functions than in the realistic case that follows  therefore  we tested under   different
discretization levels  details about discretization levels are included in table    with random
utilities  and at each discretization level  we created    problem instances  the problem
instances are different across levels  in this ferry protection domain  the utility function for
each ferry usually depends on the ferrys position  so each instance has utilities uniformly
randomly chosen between         at discretized distance points  an example is shown in
figure    a   the chosen discretization levels have ensured that uq  t  is linear in t in each
time interval  tk   tk     for each target fq   in figure    a   the x axis indicates the distance d
from terminal a  the y axis indicates the utility of a successful attack if the ferry is located
at distance d  in figure    b   x axis plots the four discretization levels and y axis plots the
average attacker expected utility if he plays best response over the    instances for baseline 
dass and cass  cass is shown to outperform dass and baseline and the differences
are statistically significant  p          note that different sets of instances are generated
for different discretization levels  so we cannot compare the results across levels directly 
however  it is helpful in better understanding the models  from the figure  we find the
solution quality of dass varies a lot and sometimes can be worse than the naive strategy
 e g   level     this is because dass calculates an optimal solution that considers only the
attacks at the discretized time points  in figure    b   the solution quality is measured by
atteu m   which is calculated as the maximum over the continuous attacker strategy set 
the gap between the optimal objective function of dass and the actual atteu m given the
optimal solution of dass may vary for different strategies and different discretization levels 
another interesting observation is that the average solution quality of cass is almost the
same for all discretization levels  despite the difference in instance sets  this result implies
that the improvement of a finer discretization may be limited for cass 
level
 
 
 
 

t  minutes 
  
 
   
 

m
 
 
  
  

d
   
    
     
   

n
 
 
 
  

table    details about discretization levels  in the experiments mentioned in this section 
the distance space is evenly discretized  parameterized by d   di    di  

next we turn to more realistic utility function in this ferry domain  which is of u  shape
or inverse u  shape  figure    a  shows a sample utility curve where the attacker gains
higher utility closer to the shore  we fix the utility at the shore as     vary the utility in
the middle  denoted as umid    which is the value on the floor of the u  shape or the top of
the inverse u  shape and evaluate the strategies  in figure    b   umid is shown on x axis
   

fiprotecting moving targets with multiple mobile resources

 

ave atteum 

u  utility

  

 

 
 

   
d  distance

 

 a  randomized attacker utility function

naive
dass
cass

 
 
 
 

level  level  level  level 

 b  average solution quality of different
strategies

figure     performance under different randomized utility function settings  the utility
function in this set of experiments is a function of the distance to terminal a 
the utility function is piece wise linear and the value at discretized distance
points di is chosen randomly between        

  
sup atteu 

u  utility

  
 
 
 
 

   
d  distance

 
 
 

 

 a  realistic attacker utility function with
umid    

  

naive
dass
cass

 

  
umid

  

  

 b  solution quality of different strategies

figure     performance under different realistic utility function settings  the utility function is u shape or inverse u shape  the utility around distance     is denoted
as umid   we compare the defender strategy given by dass and cass with the
baseline when umid is changing from   to    

and we compare performance of the strategies in terms of attackers expected utility when
he plays best response on the y axis  we conclude that    the strategy calculated by cass
outperforms the baseline and dass     dass may actually achieve worse results than the
baseline 
among all these different experiment settings of discretization and utility function  we
choose one instance and provide a more detailed analysis for it  we refer to this instance
as example setting in the following of this section  in this example setting  discretization
level   is used and the utility curve is as shown in figure    a   other parameters involved
are described in section        figure    compares the attacker expected utility function
when dass and cass is used respectively  the x axis indicates the time t  and the y axis
indicates the attackers expected utility if he attacks ferry   at time t  for the strategy calculated by dass  the worst performance at discretized time points is       atteu f         
however  the supremum of atteu f    t   t          can be as high as       atteu f          
   

fifang  jiang    tambe

 

atteu

 
 
 
 
 

dass
cass
  
  
t  time

  

figure     the attackers expected utility function given the defender strategy calculated by
dass vs cass under example setting  the expected utilities at the discretized
time points are indicated by squares for cass and dots for dass  the maximum
of atteu under cass is          less than the maximum of atteu under
dass  which is      

which experimentally shows that taking into consideration the attacks between the discretized time points is necessary  for the strategy calculated by cass  the supremum of
atteu f    t  is reduced to      
      improvement using refinement methods
we compare the refinement approaches described in section   and analyze the tradeoff
between performance improvement and runtime  three approaches are considered for comparison  route adjust  flow adjust and a variation of route adjust  denoted by route adjust  
in step  ii  of route adjust  we replace every node in the route one by one in sequence   in
step  ii  of route adjust   we replace every consecutive pair of nodes in the route in sequence 
we first show results for the example setting  in figure    a   we compare the atteu fq   t 
function of the defender strategy given by cass and of the one after route adjust for ferry
   it shows for an attack aiming at any target at any time  the defender strategy after
route adjust refinement is equally good or better than the one in the original equilibrium 
and thus the defender performs equally or better no matter how the attacker is constrained
in time  i e   the defender strategy after route adjust dominates the original strategy  figure
   b  is the comparison between atteu function of the defender strategy after route adjust
and the one after route adjust  for ferry    the one after route adjust  does not dominate
the one after route adjust but overall the former appears to perform better than the latter
more frequently and by larger amounts  if we use the average value of atteu function as a
metric of performance  we will show that route adjust  is better than route adjust in this
example setting later in table    figure    c  shows the comparison between the atteu
function of the defender strategy given by cass and that of the defender strategy after
   in supplementary experiments  we also tested route adjust with more iterations  e g   repeating the
process of replacing every node in sequence five times  the extra benefit is insignificant while the
runtime increases proportionally to the number of iterations  in light of this  we choose to replace each
node only once in the experiments reported in this article 

   

fi 

 

 

 

atteu

atteu

protecting moving targets with multiple mobile resources

 

cass
routeadjust

 
 

  

t  time

  

 
 
 

  

 a  atteu function of ferry   after
route adjust  one node at a time 

routeadjust
routeadjust 
  

t  time

  

  

 b  atteu function of ferry   after
route adjust   two nodes at a time 

atteu

 
 
 
 
 

cass
flowadjust
  

t  time

  

  

 c  performance of flow adjust

figure     performance of equilibrium refinement approaches 
flow adjust for ferry    the strategy given by cass is not dominated by the one after
flow adjust under definition    but if we investigate the maximum of atteu in each time
interval  tk   tk      as shown in table    we find that the defender strategy after flow adjust
locally dominates the original strategy 
we list the worst case performance and the average performance of atteu function over
all ferries in this example setting for four defender strategies  cass  route adjust  routeadjust   flow adjust  in table    from which we conclude that    the worst case performance
of all strategies of flow adjust is the same  which means the defender achieves exactly same
expected utility towards an unconstrained rational attacker     the average performance
of flow adjust is slightly better than the cass  but is outperformed by route adjust and
route adjust   while it takes much less time to run compared to the other two     in this
example setting  when we adjust two consecutive nodes at a time  the performance is better
than adjusting only one node at a time  but the difference is not significant and it is much
more expensive in terms of run time 
strategies
cass
route adjust
route adjust 
flow adjust

worst case performance
    
    
    
    

average performance
    
    
    
    

runtime  minutes 
    
     
    

table    comparison of different refinement approaches in terms of average performance
and runtime  only the runtime for the refinement process is calculated 

   

fifang  jiang    tambe

time interval  tk   tk    
      
      
      
       
        
        
        

maximum
before
      
      
      
      
      
      
      

maximum
after
      
      
      
      
      
      
      

time interval  tk   tk    
        
        
        
        
        
        
        

maximum
before
      
      
      
      
      
      
      

maximum
after
      
      
      
      
      
      
      

table    the maximum of attackers expected utility in each time interval decreases after
flow adjust is used 

figure    a  and figure    b  shows the maximum and the average improvement of
route adjust  route adjust  and flow adjust  averaged over all the    instances of level  
with randomized utilities that have been used for figure    b   and figure    c  shows the
average runtime  the maximum improvement is the largest difference between the atteu
function given defender strategy calculated by cass and the one after refinement  the
average improvement is the average difference between the two functions  the standard
deviations over all instances are shown as error bars  figure    confirms that all the refinement approaches improve the defender strategy calculated by cass in terms of both the
maximum performance and average performance and thus provide better defender strategies given possible constrained attackers  route adjust  achieves the most improvement 
then route adjust  and flow adjust the least  flow adjust achieves much less improvement
compared to the other two approaches  one explanation for this is that the constraints are
very strong as they require all marginal probabilities to be unchanged so it is likely that
little changes are made to the original defender strategy  the difference between routeadjust  and route adjust is not as significant  in terms of run time  flow adjust is the least
expensive  route adjust the second and route adjust  the most  route adjust  is significantly more expensive compared to the other two  so we conclude that route adjust is a
better choice considering the tradeoff between improvement and the runtime 
      sampled routes
we first convert the defender strategy under the example setting into a markov strategy
and sample      pair of patrol routes  the defender strategy used here is the one after
route adjust  in each sample  a pair of routes is chosen step by step for the two patrol
boats according to the joint conditional probability distribution   i   j   i   j   k    the
routes for the two patrol routes are chosen simultaneously as they are coordinating with
each other  we cannot show each pair separately for all      samples  instead  figure
   a  shows the frequency of being taken out of the      samples of each edge  the x axis
indicates the time and the y axis is the distance to terminal a  the width of the each edge
indicates the frequency of being chosen by at least one patroller  although figure    a 
does not precisely depict the samples  it provides a rough view of how the routes are taken
by the patrol boats 
   

fiprotecting moving targets with multiple mobile resources

   

routeadjust
routeadjust 
flowadjust

 

ave improvement

max improvement

   

   
 
   

routeadjust
routeadjust 
flowadjust

   
   

 

 

runtime  minutes 

 a  average of maximal improvement

 b  average of average improvement
routeadjust
routeadjust 
flowadjust

  
  
  
  
 

 c  average of runtime

figure     comparison of refinement approaches 

figure    b  shows the pair of routes that is of highest probability when we use the
decomposition method of sampling  the solid lines show the patrol boats routes and the
dashed lines show the ferries schedules  we get      different pair of patrol routes in total
in the decomposition process and the shown pair of routes is chosen with probability       

 

d  distance

d  distance

 
   
   
   
   
 
 

 

  

  

  

  

   
   

   
 
 

  

t  time

patrol boat  
patrol boat  

   

 

  

  

  

  

  

t  time

 a 

 b 

figure     results for sampling under the example setting   a  frequency of each edge is
chosen when the first sampling method based on markov strategy is used   b 
decomposed routes with highest probability superimposed on ferry schedules
when the second sampling method based on decomposition is used 

   

fiattacker eu

 
 

log runtime  seconds  

fang  jiang    tambe

  patroller
  patrollers
  patrollers
  patrollers

 
 

 
 
 

 

attacker eu

 

 b  runtime of level  
log runtime  seconds  

 a  solution quality of level  
 

  patroller
  patrollers
  patrollers
  patrollers

 

  patroller
  patrollers
  patrollers

 
 
 
 

 c  solution quality of level  

 
 

  patroller
  patrollers
  patrollers

 
 
 
 

 d  runtime of level  

figure     performance with varying number of patrollers 

      number of patrollers
figure    a  shows the improvement in performance of cass with increasing number of
patrollers under discretization level    the x axis shows the number of patrollers and the
y axis indicates the average of attackers maximal expected utility  i e   the expected reward
when he plays his best response  the results are averaged over    random utility settings
of discretization level    with fewer patrollers  the performance of the defender varies a lot
depending on the randomized utility function  as indicated by standard deviation shown as
the error bar   but the variance gets much smaller with more patrollers  which means the
defender has sufficient resources for different instances  figure    b  shows the run time for
cass  the y axis indicates the average of natural logarithm of runtime  not surprisingly 
the run time increases when the number of patrollers increases 
figure    c  and    d  show the average performance and run time of cass with discretization level    using the same set of utility settings as used in level    only results for
  to   patrollers are shown  the program runs out of memory for   patrollers as there are
n   m           flow distribution variables and at least n   m        constraints  note
that the average solution quality of level   is better than the result of level    e g   the
average attacker eu for   patroller is      in level   and      in level     which indicates
a higher level of granularity can improve the solution quality  however  granularity clearly
affect the ability to scale up  which means that we need to consider the tradeoff between the
solution quality and the memory used and one way to combat the scaling up problem is to
reduce the level of granularity  nonetheless  the number of patrollers we have encountered
in real world scenarios such as at new york is of the order of   or    so cass is capable at
least for key real world scenarios 
   

fiprotecting moving targets with multiple mobile resources

      approximation approach for multiple defender resources
we tested the first approximation approach for multiple defender resources described in
section     for the example setting  we used the fmincon function with interior point
method in matlab to minimize the non linear objective function  equation      table
  lists different run time and the value of the objective function achieved given different
iteration number  denoted as maxiter    the function is not ensured to provide a feasible
solution when the iteration number is not large enough  as shown in the first two rows 
we compared the result with our lp formulation of dass  which was implemented in
matlab using linprog function  dass can be solved within       seconds and provides
an optimal solution atteum        this approximation approach is outperformed in both
run time efficiency and solution quality  this approach fails to provide a feasible solution
efficiently and even when sufficient time is given  more than     times the run time of the
lp formulation   the maximum attacker expected utility is     larger than the optimal
solution  this is mainly because the new formulation in the approximation approach is no
longer linear or convex  making it difficult to find a global maximum 
m axiter
    
     
      

run  time sec 
    
     
    

atteum
infeasible
infeasible
      

table    performance of approximation approach 

    experiments for two dimensional setting
the settings in   d space are more complex even with single patroller  here we show
an example setting motivated by the ferry system between seattle  bainbridge island and
bremerton as shown in figure    in this example setting  three terminals  denoted as a b
and c  are non collinear in the   d space as shown in the figure    a   ferry   and ferry
  are moving on the trajectory between terminal b and c  denoted as trajectory    and
ferry   and ferry   are moving on the trajectory between terminal b and a  denoted as
trajectory     the schedules of the four ferries are shown in figure    b   where the x axis
is the time and the y axis is the distance from the common terminal b  ferry   moves
from c to b  ferry   moves from b to c  ferry   moves from b to a and ferry   moves
from a to b  similar to the one dimensional scenario in ferry domain  we assume the utility
is decided by the ferrys position and the utility function is shown in figure    c   the
x axis is the distance from the common terminal b and the y axis is the utility for the two
trajectories respectively  the   d space is discretized into a grid as shown in figure    d 
with x       and y     indicating the interval in the x axis and y axis  a patroller will
be located at one of the intersection points of the grid graph at any discretized time points 
the simulation time is    minutes and m       i e   tk    tk     minutes  the speed limit
for the patroller is ve        and all the available edges that a patroller can take during
 tk   tk     are shown in figure    d   only one patroller is involved  the protection radius
is set to re        and protection coefficient is c        
   

fifang  jiang    tambe

c

 

y

distance from terminal b

terminals in  d
trajectory  
b

 

trajectory  
 

a
 

   

 

   

x

ferry schedules
 

   
   
   
 
 

  

edges available
 

ferry trajectory 
ferry trajectory 

 

y

utility

  

 b  ferry schedules

utility function
 

  

time

 a  three terminals
  

ferry 
ferry 
ferry 
ferry 

   

 

 
 
 
 

   

   

   

   

 
 

 

   

 

   

x

distance from terminal b
 c  utility function

 d  available edges

figure     an example setting in two dimensional space
figure    a  compares the performance of dass and cass for ferry    ferry   is chosen
because in both strategies  the attackers best response is to attack ferry    the x axis is
the time t  and the y axis is the attacker expected utility of attacking ferry   at time t  the
maximum of atteu of cass is             lower compared to the result of dass  which
is         figure    b  and    c  show two sampled route given the strategy calculated
by cass on the   d map where the dashed lines represents for the ferry trajectories  the
patroller starts from the node with text start and follows the arrowed route  and ends at
the node with text end at the end of the patrol  she may stay at the nodes with text
stay  the patrol routes are shown in a intuitive way but can be ambiguous  the exact
route should be listed as a table with time and position  the routes are sampled based on
the converted markov strategy  and the total number of patrol routes that may be chosen
with non zero probability is             

   related work
in this section we discuss literature related to our work  we will first discuss work on
the computation of game theoretic patrolling strategies  then discuss work on continuous
games  and finally discuss work on equilibrium refinement 
as mentioned in the introduction  stackelberg games have been widely applied to security domains  although most of this work has considered static targets  e g   korzhyk
et al         krause  roper    golovin        letchford   vorobeychik        kiekintveld
   

fiprotecting moving targets with multiple mobile resources

sampled route by cass

 

stay

 
y

atteu

 

 
 

stay
staystart
end

 

dass
cass

 

 

  
  
t  time

  

 

   

 

   

x

 a  solution quality of dassand cass for
ferry  

 b  sampled route   superimposed on ferry
trajectories

sampled route by cass
staystart

y

 

stay
end

 

 
 

   

 

   

x
 c  sampled route   superimposed on ferry
trajectories

figure     experimental results under two dimensional settings

et al          agmon  kraus  and kaminka        proposed algorithms for computing
mixed strategies for setting up a perimeter patrol in adversarial settings with mobile robot
patrollers  similarly  basilico  gatti  and amigoni        computed randomized leader strategies for robotic patrolling in environments with arbitrary topologies  even when both
of the players are mobile  e g   in hider seeker games  halvorson  conitzer    parr        
infiltration games  alpern        or search games  gal         the targets  if any  were assumed to be static  tsai et al         applied stackelberg games to the domain of scheduling
federal air marshals on board flights  the targets  i e   flights  in this domain are mobile 
but the players are restricted to move along the targets to protect or attack them  this
stationary nature leads to discrete game models with finite numbers of pure strategies 
bosansky  lisy  jakob  and pechoucek        and vanek  jakob  hrstka  and pechoucek
       studied the problem of protecting moving targets  however  they both considered
a model in which the defender  the attacker and targets have discretized movements on a
directed graph  such discretization of attacker strategy spaces can introduce suboptimality
in the solutions  as we have shown with dass  we  in our work  generalize the strategy space of the attacker to the continuous realm and compute optimal strategies even in
such a setting  furthermore  while we provide an efficient and scalable linear formulation 
bosansky et al  presented a formulation with non linear constraints  which faced problems
scaling up to larger games even with a single defender resource 
   

fifang  jiang    tambe

yin et al         considered the domain of patrolling in public transit networks  such
as the la metro subway train system  in order to catch fare evaders  because the players
ride along trains that follow a fixed schedule  the domain is inherently discrete and they
modeled the patrolling problem as a finite zero sum bayesian game  yin et al  proposed a
compact representation for defender mixed strategies as flows in a network  we adapt this
compact representation idea to a continuous domain  in particular  in our domain we need
to model the interaction between the defenders flow and attackers continuous strategy
space  our proposed sub interval analysis used spatio temporal reasoning to efficiently
reduce the problem into a finite lp 
games with continuous strategy spaces have been well studied in game theory  much of
the economics literature has focused on games whose equilibria can be solved analytically
 and thus the question of computation does not arise   for example the classical theory
of auctions  see e g   krishna         recent computational approaches for the analysis
and design of auctions have focused on discretized versions of the auction games  e g  
thompson   leyton brown        daskalakis   weinberg         there has been research
on efficiently solving two player continuous games with specific types of utility functions 
such as zero sum games with convex concave utility functions  owen        and separable
continuous games with polynomial utility functions  stein  ozdaglar    parrilo        
johnson  fang  and tambe        studied a continuous game model for protecting forests
from illegal logging  in their model the target  i e   the forest  is stationary  and with further
simplifying assumptions  e g   the forest having a circular shape  they were able to solve
the game efficiently  in contrast to existing work  our game model has moving targets in a
continuous domain  and the resulting utility functions are discontinuous and thus existing
approaches are not applicable  our cass algorithm solves the game optimally without
needing to discretize the attackers strategy space 
there is an extensive literature on equilibrium refinement  however most existing work
on the computation of equilibrium refinement focuses on finite games  for simultaneousmove finite games  solution concepts such as perfect equilibrium and proper equilibrium
were proposed as refinements of nash equilibrium  fudenberg   tirole         miltersen
and srensen        proposed an efficient algorithm for computing proper equilibria in finite zero sum games  for finite security games  an et al         proposed a refinement
of stackelberg equilibrium and techniques for computing such refinements  the resulting
defender strategy is robust against possibilities of constrained capabilities of the attacker 
these existing approaches rely on the finiteness of action sets  and is thus not applicable to
our setting  simon and stinchcombe        proposed definitions of perfect equilibrium and
proper equilibrium for infinite games with continuous strategy sets  however they did not
propose any computational procedure for the resulting solution concepts  exact computation of equilibrium refinements of continuous games such as mrmtsg remains a challenging
open problem 

   conclusion
this paper makes several contributions in computing optimal strategies given moving targets and mobile patrollers  first  we introduce mrmtsg   a novel stackelberg game model
that takes into consideration spatial and temporal continuity  in this model  targets move
   

fiprotecting moving targets with multiple mobile resources

with fixed schedules and the attacker chooses his attacking time from a continuous time
interval  multiple mobile defender resources protect the targets within their protection
radius  and bring in continuous space in our analysis  second  we develop a fast solution
approach  cass  based on compact representation and sub interval analysis  compact representations dramatically reduce the number of variables in designing the optimal patrol
strategy for the defender  sub interval analysis reveals the piece wise linearity in attacker
expected utility function and shows there is a finite set of dominating strategies for the attacker  third  we propose two approaches for equilibrium refinement for casss solutions 
route adjust and flow adjust  route adjust decomposes the patrol routes  greedily improves
the routes and composes the new routes together to get the new defender strategy  flowadjust is a fast and simple algorithm that adjusts the flow distribution to achieve optimality
in each time interval while keeping the marginal probability at the discretized time points
unchanged  additionally  we provide detailed experimental analyses in the ferry protection
domain  cass has been deployed by the us coast guard since april      

    future work
there are several important avenues for future work  these include   i  use a decreasing
function to model the protection provided to the targets instead of using a fixed protection
radius   ii  handle practical constraints on patrol boat schedule as not all are easily implementable   iii  efficiently handle more complex and uncertain target schedules and utility
functions 
here we provide an initial discussion about the relaxation of the assumptions that we
listed in section   and used throughout the paper 
 if we allow for complex and uncertain target schedules  we may model the problem as
a game where the targets follow stochastic schedules  our framework may still apply
but may need to be enriched  e g   using approaches such as use of mdps to represent
defender strategies  see jiang  yin  zhang  tambe    kraus         coordinating
multiple such defenders then becomes an important challenge  it may be helpful in
such cases to appeal to more of the prior work on multi agent teamwork  given the
significant uncertainty in such cases leading to more need for on line coordination
 tambe        stone  kaminka  kraus    rosenschein        kumar   zilberstein 
      yin   tambe        
 if we focus on environments where multiple attackers can coordinate their attacks 
then we may need to further enhance our framework  prior results from korzhyk 
conitzer  and parr        over stationary targets and discrete time would be helpful
in addressing this challenge  although the case of moving targets in continuous space
and time in such cases provides a very significant challenge  combining with the
previous item for future work  a complex multiple defender multiple attacker scenario
would appear to be a very significant computational challenge 

   

fifang  jiang    tambe

acknowledgments
we thank the uscg officers  and particularly craig baldwin  joe direnzo and francis
varrichio and officers at sector new york  for their exceptional collaboration  the views
expressed herein are those of the author s  and are not to be construed as official or reflecting
the views of the commandant or of the u s  coast guard  this research is supported by
us coast guard grant hshqdc    d       and muri grant w   nf            we
also thank the anonymous reviewers for valuable suggestions 
a preliminary version of this work appears as the conference paper  fang  jiang   
tambe         there are several major advances in this article   i  whereas the earlier work
confined targets to move in   d space  we provide a significant extension of our algorithms
 dass and cass  in this article to enable the targets and the patrollers to move in  d space  we also provide detailed experimental results on this   d extension   ii  we
provide additional novel equilibrium refinement approaches and experimentally compare
their performance with the equilibrium refinement approach offered in our earlier work 
this allows us to offer an improved understanding of the equilibrium refinement space   iii 
we discuss several sampling methods in detail to sample actual patrol routes from the mixed
strategies we generate  a discussion that was missing in our earlier work   iv  we provide
detailed proofs that were omitted in the previous version of the work 

   

fiprotecting moving targets with multiple mobile resources

appendix a  notation table

notation
mrmt
mrmtsg
l
fq
a  b
t
d
sq  t 
w
pu
vm
re
cg
uq  t 
m
n
tk
di
t
ru
ru  k 
f  i  j  k 
p i  k 
ei j k
p ru  
atteu fq   t 
q  t 
 fq   t 
i i  q  k 
l q  l q
r
qk
r
atteu fq   qk
 
mqk
arqk  i  j 
e u  k 

meaning
the problem of multiple mobile resources protecting moving targets
game model with a continuous set of strategies for the attacker for mrmt 
number of ferries 
ferry with index q 
terminal points 
continuous time interval or a finite set of time points 
continuous space of possible locations or a set of distance points 
ferry schedule  position of the target fq at a specified time t 
number of patrollers 
patroller with index u 
speed limit of patroller 
protection radius of patroller 
probability that the attacker can be stopped with g patrollers 
positive reward of a successful attack on target fq at time t for the attacker 
number of discretized time points 
number of discretized distance points 
discretized time point 
discretized distance point 
distance between two adjacent time points 
patrol route for patroller pu   under discretization of the defenders strategy space 
ru can be described as a vector 
the patroller is located at dru  k  at time tk  
flow distribution variable  probability that the patroller moves from di to dj
during time  tk   tk     
marginal distribution variable  probability that the patroller is located at di tk  
the directed edge linking nodes  tk   di   and  tk     dj   
probability of taking route ru  
attacker expected utility of attacking target fq at time t 
protection range of target fq at time t
probability that the patroller is protecting target fq at time t 
whether a patroller located at di at time tk is protecting target fq  
lines of sq  t   re  
the rth intersection point in  tk   tk     with respect to target fq  
r  
left right side limit of atteu fq   t  at qk
number of intersection points in  tk   tk     with respect to target fq  
r    r        otherwise 
c  if patroller taking edge ei j k can protect target fq in  qk
qk
short for eru  k  ru  k    k  
table    summary of notations involved in the paper 

   

fifang  jiang    tambe

appendix b  calculation of intersection points in cass for   d settings
we calculate the time where the patrollers route intersects with the protection range for
a target when the patroller is moving from v     x    y    to v     x    y    and the target
is moving from sq  tk      x    y    to sq  tk        x    y    during  tk   tk      the patrollers
position at a given time t   tk   tk     is denoted as  x  y  and the targets position is denoted
as  x  y   then we have
t  tk
 x   x      x   
tk    tk
t  tk
 x   x      x   
x  
tk    tk

t  tk
 y   y      y 
tk    tk
t  tk
y  
 y   y      y 
tk    tk

x 

y 

    
    

at an intersection point  the distance from the patrollers position to the targets position
equals to the protection radius re   so we are looking for a time t such that
 x  x      y  y     re 

    

by substituting the variables in equation    with equations       and denoting
 x   x      x   x   
 
tk    tk
 y   y      y   y   
a   
 
tk    tk
a   

b    x   x   
b    y   y   

equation    can be simplified to
 a  t  a  tk   b        a  t  a  tk   b       re   

    

denote c    b   a  tk and c    b   a  tk   and we can easily get the two roots of this
quadratic equation  which are
p
  a  c    a  c        a  c    a  c       a     a     c     c    re   
ta b  
 
    
  a     a    
ta or tb is the time of a valid intersection point if and only if it is within the time interval
under consideration   tk   tk      

references
agmon  n   kraus  s     kaminka  g  a          multi robot perimeter patrol in adversarial
settings  in ieee international conference on robotics and automation  icra   pp 
         
alpern  s          infiltration games on arbitrary graphs  journal of mathematical analysis and applications              
   

fiprotecting moving targets with multiple mobile resources

an  b   kempe  d   kiekintveld  c   shieh  e   singh  s  p   tambe  m     vorobeychik  y 
        security games with limited surveillance  in proceedings of the twenty sixth
aaai conference on artificial intelligence  pp           
an  b   tambe  m   ordonez  f   shieh  e     kiekintveld  c          refinement of strong
stackelberg equilibria in security games  in proceedings of the twenty fifth aaai
conference on artificial intelligence  aaai   pp         
basilico  n   gatti  n     amigoni  f          leader follower strategies for robotic patrolling in environments with arbitrary topologies  in proceedings of the  th international conference on autonomous agents and multiagent systems  aamas  volume    pp       
bosansky  b   lisy  v   jakob  m     pechoucek  m          computing time dependent
policies for patrolling games with mobile targets  in the   th international conference
on autonomous agents and multiagent systems  aamas    volume    pp         
conitzer  v     sandholm  t          computing the optimal strategy to commit to  in
proceedings of the  th acm conference on electronic commerce  ec     pp       
daskalakis  c     weinberg  s  m          symmetries and optimal multi dimensional mechanism design  in proceedings of the   th acm conference on electronic commerce 
ec     pp         
fang  f   jiang  a  x     tambe  m          optimal patrol strategy for protecting moving
targets with multiple mobile resources  in proceedings of the      international conference on autonomous agents and multi agent systems  aamas     pp         
fudenberg  d     tirole  j          game theory  mit press 
gal  s          search games  academic press  new york 
gatti  n          game theoretical insights in strategic patrolling  model and algorithm in
normal form  in proceedings of the   th european conference on artificial intelligence
 ecai   pp         
greenberg  m   chalk  p     willis  h          maritime terrorism  risk and liability  rand
corporation monograph series  rand center for terrorism risk management policy 
halvorson  e   conitzer  v     parr  r          multi step multi sensor hider seeker games 
in ijcai 
jakob  m   vanek  o     pechoucek  m          using agents to improve international
maritime transport security  intelligent systems  ieee               
jiang  a  x   yin  z   zhang  c   tambe  m     kraus  s          game theoretic randomization for security patrolling with dynamic execution uncertainty  in proceedings
of the      international conference on autonomous agents and multi agent systems 
aamas     pp         
johnson  m  p   fang  f     tambe  m          patrol strategies to maximize pristine forest
area  in proceedings of the twenty sixth aaai conference on artificial intelligence
 aaai   pp         
   

fifang  jiang    tambe

kiekintveld  c   islam  t     kreinovich  v          security games with interval uncertainty  in proceedings of the      international conference on autonomous agents
and multi agent systems  aamas     pp         
kiekintveld  c   jain  m   tsai  j   pita  j   ordonez  f     tambe  m          computing
optimal randomized resource allocations for massive security games  in proceedings
of the  th international conference on autonomous agents and multiagent systems
  volume    aamas     pp         
korzhyk  d   conitzer  v     parr  r          complexity of computing optimal stackelberg
strategies in security resource allocation games  in proceedings of the   th national
conference on artificial intelligence  aaai   pp         
korzhyk  d   conitzer  v     parr  r          security games with multiple attacker resources  in proceedings of the twenty second international joint conference on artificial intelligence   volume volume one  ijcai    pp          aaai press 
krause  a   roper  a     golovin  d          randomized sensing in adversarial environments  in proceedings of the   nd international joint conference on artificial
intelligence  ijcai   pp           
krishna  v          auction theory  academic press 
kumar  a     zilberstein  s          anytime planning for decentralized pomdps using
expectation maximization  in proceedings of the twenty sixth conference on uncertainty in artificial intelligence  pp         
letchford  j          computational aspects of stackelberg games  ph d  thesis  duke
university 
letchford  j     conitzer  v          solving security games on graphs via marginal probabilities  in proceedings of the twenty seventh aaai conference on artificial intelligence  aaai   pp         
letchford  j     vorobeychik  y          computing optimal security strategies for interdependent assets  in the conference on uncertainty in artificial intelligence  uai  
pp         
luber  s   yin  z   fave  f  d   jiang  a  x   tambe  m     sullivan  j  p          gametheoretic patrol strategies for transit systems  the trusts system and its mobile app
 demonstration   in international conference on autonomous agents and multiagent
systems  aamas  demonstrations track   pp           
marecki  j   tesauro  g     segal  r          playing repeated stackelberg games with unknown opponents  in proceedings of the   th international conference on autonomous
agents and multiagent systems  aamas     pp         
miltersen  p  b     srensen  t  b          computing proper equilibria of zero sum games 
in proceedings of the  th international conference on computers and games  cg   
pp         
owen  g          game theory   rd ed    academic press 
   

fiprotecting moving targets with multiple mobile resources

paruchuri  p   tambe  m   ordonez  f     kraus  s          security in multiagent systems
by policy randomization  in proceedings of the fifth international joint conference on
autonomous agents and multiagent systems  aamas     pp         
pita  j   jain  m   marecki  j   ordonez  f   portway  c   tambe  m   western  c   paruchuri 
p     kraus  s          deployed armor protection  the application of a game theoretic model for security at the los angeles international airport  in proceedings of the
 th international joint conference on autonomous agents and multiagent systems 
industrial track  aamas     pp         
pita  j   jain  m   ordonez  f   portway  c   tambe  m   western  c   paruchuri  p    
kraus  s          using game theory for los angeles airport security   ai magazine 
         
shieh  e   an  b   yang  r   tambe  m   baldwin  c   direnzo  j   maule  b     meyer 
g          protect  a deployed game theoretic system to protect the ports of the
united states  in proceedings of the   th international conference on autonomous
agents and multiagent systems   volume    aamas     pp       
simon  l  k     stinchcombe  m  b          equilibrium refinement for infinite normal form
games  econometrica                   
stein  n  d   ozdaglar  a     parrilo  p  a          separable and low rank continuous
games  international journal of game theory                 
stone  p   kaminka  g  a   kraus  s     rosenschein  j  s          ad hoc autonomous
agent teams  collaboration without pre coordination  in proceedings of the   th aaai
conference on artificial intelligence  pp           
tambe  m          towards flexible teamwork  journal of artificial intelligence research           
tambe  m          security and game theory  algorithms  deployed systems  lessons
learned  cambridge university press 
thompson  d  r  m     leyton brown  k          computational analysis of perfectinformation position auctions  in proceedings of the   th acm conference on electronic commerce  ec     pp       
tsai  j   rathi  s   kiekintveld  c   ordonez  f     tambe  m          iris   a tool for
strategic security allocation in transportation networks  in the eighth international
conference on autonomous agents and multiagent systems   industry track  aamas
    pp       
van damme  e          stability and perfection of nash equilibria  springer verlag 
vanek  o   jakob  m   hrstka  o     pechoucek  m          using multi agent simulation
to improve the security of maritime transit  in proceedings of   th international
workshop on multi agent based simulation  mabs   pp      
vorobeychik  y     singh  s          computing stackelberg equilibria in discounted stochastic games  in proceedings of the twenty sixth conference on artificial intelligence  aaai   pp           
   

fifang  jiang    tambe

yin  z   jiang  a  x   johnson  m  p   kiekintveld  c   leyton brown  k   sandholm  t  
tambe  m     sullivan  j  p          trusts  scheduling randomized patrols for
fare inspection in transit systems  in proceedings of the twenty fourth conference
on innovative applications of artificial intelligence  iaai   pp           
yin  z     tambe  m          continuous time planning for multiagent teams with temporal
constraints  in proceedings of the twenty second international joint conference on
artificial intelligence   volume volume one  ijcai    pp          aaai press 

   

fi