journal artificial intelligence research                  

submitted        published      

nominals  inverses  counting  conjunctive queries
or  infinity friend 
sebastian rudolph

rudolph kit edu

aifb  karlsruhe institute technology  de

birte glimm

birte glimm comlab ox ac uk

oxford university computing laboratory  uk

abstract
description logics knowledge representation formalisms provide  example 
logical underpinning w c owl standards  conjunctive queries  standard
query language databases  recently gained significant attention expressive
formalism querying description logic knowledge bases  several different techniques
deciding conjunctive query entailment available wide range dls  nevertheless 
combination nominals  inverse roles  number restrictions owl   owl  
dl causes unsolvable problems techniques hitherto available  tackle problem
present decidability result entailment unions conjunctive queries dl
alchoiqb contains three problematic constructors simultaneously  provided
queries contain simple roles  result shows decidability entailment
 unions of  conjunctive queries logic underpins owl   dl believe
presented results pave way progress towards conjunctive query
entailment decision procedures description logics underlying owl standards 

   introduction
present decidability result entailment unions conjunctive queries
expressive description logic alchoiqb  article extended version conference paper status qio  conjunctive query entailment decidable  proceedings
  th international conference principles knowledge representation reasoning  kr        may             glimm   rudolph        
description logics  dls  family logic based knowledge representation formalisms
 baader  calvanese  mcguinness  nardi    patel schneider         dls correspond
function free two variable fragment first order logic  fol  often extended
counting quantifiers  e g   xn y r x  y    dls closely related   variable  guarded fragment since dl formulae naturally result guarded formulae
translated fol  line restriction   variables  dl formulae contain
unary binary predicates  called concepts roles dls  constructors
building complex expressions usually chosen key inference problems 
concept satisfiability  decidable  dl knowledge base  kb  consists tbox 
contains intensional knowledge concept definitions general background
knowledge  essentially fol theory   abox  contains extensional knowledge
used describe individuals  a set ground facts   using database metaphor 
tbox corresponds schema  abox corresponds data  contrast
c
    
ai access foundation  rights reserved 

firudolph   glimm

databases  however  dl knowledge bases  fol general  adopt open world semantics 
i e   represent information domain incomplete way 
standard dl reasoning services include testing concepts satisfiability retrieving
certain instances given concept  latter retrieves  knowledge base consisting abox tbox    abox  individuals instances given
 possibly complex  concept expression c  i e   individuals
entail instance c  underlying reasoning problems well understood 
computational complexity standard reasoning tasks given knowledge base
input range ptime complete dls limited expresivity dl lite
 calvanese  de giacomo  lembo  lenzerini    rosati         el  baader         elp
 krotzsch  rudolph    hitzler          nexptime complete expressive dls
sroiq  kazakov        
despite high worst case complexity standard reasoning problems
expressive dls sroiq  highly optimized implementations available 
e g   fact    tsarkov   horrocks         pellet  sirin  parsia  cuenca grau  kalyanpur    katz         hermit  motik  shearer    horrocks         systems
used wide range applications  e g   biology  sidhu  dillon  chang    sidhu 
       bio informatics  wolstencroft  brass  horrocks  lord  sattler  turi    stevens        
medicine  golbreich  zhang    bodenreider         information integration  calvanese 
de giacomo  lenzerini  nardi    rosati      b   geography  goodwin         geology  jet
propulsion laboratory         defense  lacy  aviles  fraser  gerber  mulvehill    gaskill 
       configuration  mcguinness   wright         prominently  dls known
use logical underpinning ontology languages  e g   oil  daml oil 
w c standard owl    bechhofer  van harmelen  hendler  horrocks  mcguinness  patelschneider    stein         successor owl    w c owl working group        
three species owl    owl lite  owl dl  owl full  owl   extends
owl   adds three sublanguages  called owl   profiles   owl el  owl ql 
owl rl  owl lite corresponds dl shif standard reasoning
tasks exptime complete  owl   dl corresponds dl shoin  
standard reasoning tasks nexptime complete  owl   dl extends dl
sroiq  owl full standard reasoning tasks longer decidable  new
ql  el  rl profiles restrictive owl dl profiles trades
different aspects owls expressive power return different computational and or
implementational benefits  owl el corresponds dl el     baader  brandt   
lutz        basic reasoning problems performed time polynomial
respect size input knowledge base  owl   ql based dl lite
family description logics  data complexity conjunctive query entailment
ac    thus  conjunctive query answering implemented using standard relational
database technology  owl   rl enables implementation polynomial time reasoning
algorithms using rule extended database technologies 
data intensive applications  querying kbs plays central role  instance retrieval
is  aspects  rather weak form querying  although possibly complex concept
expressions used queries  query tree like relational structures 
dl concept cannot express arbitrary cyclic structures  property known
tree model property considered important reason decidability
   

finominals  inverses  counting  conjunctive queries

modal description logics  gradel        vardi        heavily exploit
variant property establish decidability result  conjunctive queries  cqs 
unions conjunctive queries  ucqs  well known database community
constitute expressive query language capabilities go well beyond standard
instance retrieval  fol terms  cqs ucqs formulae positive existential
fragment  free variables query  not bound existential quantifier  called
answer variables distinguished variables  whereas existentially quantified variables
called non distinguished 
query contains distinguished variables  query answer true false
query called boolean query  given knowledge base k boolean ucq
q  query entailment problem deciding whether q true false w r t  k  i e  
decide whether model k provides suitable assignment variables
q  query distinguished variables  answers query tuples
individual names  constants  knowledge base entails query
obtained replacing free variables individual names answer tuple 
answers called certain answers  problem finding answer tuples
known query answering  present decidability result query entailment 
decision problem  restriction since query answering easily reduced
query entailment illustrate detail section   
    related work
conjunctive queries first mentioned context description logics  dls 
levy rousset         first account conjunctive queries main topic given
calvanese  de giacomo  lenzerini      a   particular recent years  problem
decidability conjunctive query entailment complexity problem different
logics gained significant attention  dls shiq shoq decidability
  exptime completeness problem known  glimm  horrocks  lutz    sattler 
    a  glimm  horrocks    sattler      b  lutz        eiter  lutz  ortiz    simkus 
       conjunctive query entailment already   exptime hard relatively weak
dl alci  lutz         initially attributed inverse roles  recently 
shown  however  transitive roles together role hierarchies dl sh
make conjunctive query entailment   exptime hard  eiter et al          techniques
glimm et al  shiq shoq  glimm et al       a      b  reduce query entailment
standard reasoning task knowledge base satisfiability checking dl extended
role conjunctions  alternative technique so called knots technique  ortiz 
simkus    eiter      b   instance mosaic technique originating modal
logic  technique gives worst case optimal algorithms shiq several
sub logics  further  automata based decision procedures positive existential
path queries  calvanese  eiter    ortiz               positive existential path queries
generalize unions conjunctive queries and  therefore  decision procedures kind
query provides decision procedures unions conjunctive queries  particular
recent extension  calvanese et al         close conjunctive query entailment
decision procedure owl    corresponds dl sroiq  covers
   

firudolph   glimm

sriq  sroq  sroi  use three problematic constructors nominals 
inverses  number restrictions is  however  covered 
regarding data complexity  i e   complexity respect abox  the data 
only  cq entailment usually conp complete expressive logics  example  dls
ale shiq case  glimm et al       a  holds cq
entailment two variable guarded fragment counting  pratt hartmann        
latter work quite closely related since many description logics translated
two variable guarded fragment counting  i e   results pratt hartmann
hold shiq simple roles  roles transitive transitive
subrole  query  given restriction query  shoq shoi
shown conp complete data complexity w r t  conjunctive query entailment
 ortiz  calvanese    eiter      a  
query entailment answering studied context databases
incomplete information  rosati      b  van der meyden        grahne        
setting  dls used schema languages  expressivity considered dls
usually much lower expressivity dl alchoiqb consider
reasoning usually tractable  example  constructors provided logics
dl lite family  calvanese  de giacomo  lembo  lenzerini    rosati        chosen
standard reasoning tasks ptime regarding combined complexity
query entailment ac  respect data complexity  thus  tbox reasoning
done independently abox abox stored accessed using standard
database sql engine  another tractable dl el  baader         conjunctive query
entailment el is  however  tractable complexity increases conp complete
 rosati      b   moreover el    baader et al          still tractable extension el 
query entailment even undecidable  krotzsch  rudolph    hitzler         mainly
el     one use unrestricted role compositions  allows encoding
context free languages  conjunctive queries used check intersection
languages  known undecidable problem  since logics used
databases incomplete information considerable less expressive alchoiqb 
techniques developed area transfer setting 
given query entailment  computationally  harder task than  example 
knowledge base satisfiability  surprising decidability latter task
necessarily transfer problem cq entailment  undecidability results transferred fol since many dls directly translated
equivalent fol theory  example  known conjunctive query entailment
undecidable two variable fragment first order logic l   rosati      a  
rosati identifies relatively small set constructors cause undecidability  most
notably role negation axioms  i e   axioms form x   r x  y  p  x  y   r  p
binary predicates   pratt hartmann        recently established decidability cq entailment two variable guarded fragment counting  gc     worth noting
pratt hartmann assumes background theory  that knowledge base
case  constant free formulae form    x p  x    used simulate constants nominals  considered guarded  result covers  therefore 
dl alchiqb applicable case  input knowledge base  the
background theory  contains nominals  individual constants  
   

finominals  inverses  counting  conjunctive queries

implemented dl reasoners  e g   kaon    pellet  racerpro   provide
interface conjunctive query answering  although kaon  racerpro consider
named individuals abox assignments variables  restriction
queries longer standard fol semantics decidability obviously
issue since conjunctive query answering restriction reduced standard
instance retrieval replacing variables individual names abox
testing entailment conjunct separately  pellet goes beyond provides
interface conjunctive queries fol semantics restriction queries
kind tree shape  restriction decidability known since cqs
expressed normal concepts  possibly adding role conjunctions  
    contributions overview
given results  show great interest problem conjunctive query entailment expressive dls  interesting dls shif  shoin  
sroiq underpin widely adopted standards owl lite  owl   dl  owl  
dl  respectively  decidability conjunctive query entailment established
owl lite  main obstacle devising decision procedure combination inverse
roles  i   nominals  o   number restrictions counting quantifiers  f stands functionality  n unqualified number restrictions  q qualified number restrictions  
complications arising combination constructors caused major
hurdle development implementable algorithms knowledge base satisfiability
shoin extensions thereof  horrocks sattler        devised tableau based
decision procedure since extended sroiq  meanwhile alternative
approaches resolution  kazakov   motik         hypertableau based procedures
 motik et al         available implemented 
key obstacle establishing decision procedure existence potentially
infinitely many new nominals  i e   elements uniquely identifiable model
kb  example  consider kb k given fig     concept form  o 
interpreted singleton set  containing interpretation constant
o  simplicity  assume constant always interpreted itself  e g  
interpretation o  axiom form  o    v f s f   o   
understood follows  constant o    must two elements  say d  d   
f  o    d     s d    d     f  o    d    holds  note o  occurs first element
f  o    d    since inverse role  f   used  thus  interpretation kb must contain
three elements o    o    o    must interconnected following way  paths
f



f

shape lead o  o  well o  o  o 
o    moreover  role f defined functional  meaning every element
one f  successor  applies individuals oi   forces existence
s cycle  observe cyclic boolean query  s x  y   s y  z   s z  x   checks
existence cycle cannot answered applying standard techniques
replacing variables individual names  oi   rewriting query equivalent
   http   kaon  semanticweb org
   http   www racer systems com

   

firudolph   glimm

 o    v f s f   o   
 o    v

f s f   o

 o   

  

f

f




 o    v f s f   o   

 o   


f

 o   

func f  

figure    example knowledge base k representation model  three
elements s cycle so called new nominals 

tree shaped query  elements cycle behave nominals 
names them 
tackle problem conjunctive query entailment expressive dl contains three problematic constructors simultaneously prove decidability  unions
of  conjunctive queries  challenging part establish finite representability
countermodels case query given input entailed knowledge base 
results hold shoiq knowledge bases  i e   roles declared transitive 
provided queries contain simple roles  roles neither transitive
transitive subrole   essentially restriction placed roles
occur number restrictions since otherwise standard reasoning tasks become
undecidable  restriction  use standard techniques eliminating transitivity  kazakov   motik         hence  show decidability conjunctive query
entailment owl dl  queries simple roles 
believe work valuable understanding  general  structure
models dls contain nominals  inverse roles  number restrictions  furthermore 
devise non trivial extensions standard techniques unraveling  believe
prove useful working expressive dls 
paper organized follows  section    give birds eye view techniques
ideas used establish decidability  section    give necessary definitions
introduce standard notations  sections         present main results
use section   show models satisfy query finitely
represented conclude section   

   big picture
going technical details  describe overall line argumentation
establishing decidability conjunctive query entailment alchoiqb 
    decidability via finitely representable countermodels
let k alchoiqb knowledge base let q conjunctive query question 
i e   aim determine whether
k    q 
clearly  alchoiqb fragment first order predicate logic equality  k
translated fol sentence f ol k   likewise find fol sentence f ol q 
   

finominals  inverses  counting  conjunctive queries

q existentially quantified formula  hence  checking entailment
equivalent determining whether first order theory f ol k  entails f ol q  
result completeness theorem fol  godel         consequences finite fol
theory recursively enumerable  provides us procedure terminates
k    q  hence  establish decidability providing another algorithm terminates
iff entailment hold i e   so called countermodel
model k     q 
provide algorithm showing that  whenever countermodel
exists all  countermodel finitely representable  precisely 
encoded word rep i  finite length finite alphabet  whereby
encoding rep property every finite word effectively checked
whether represents countermodel given knowledge base query 
consequence thereof  create desired algorithm enumerates words 
checks countermodel  terminates soon found one 
    finite representability bounding nominals blocking
outline going show always finitely representable
countermodel  one all  taking arbitrary countermodel
cautiously transforming countermodel finitely representable  cautiously
means make sure transformation preserve two properties
   model underlying knowledge base k    entailing considered
query q 
result overall transformation going regular model  i e   structure
substructures certain sense periodically repeated  common practice
dl theory construct kind models arbitrary ones blocking techniques 
whereby certain element configurations occurring twice original model detected
new model generated infinitely stringing together finite substructure
delimited two configurations 
case consider  technique cannot applied directly original countermodel  due intricate interplay nominals  inverse roles cardinality
constraints arbitrary even infinite number domain elements
forced behave nominals  elements usually referred new
nominals dl setting  fol  nominals often called kings new nominals
called court  case  presence infinitely many new nominals model
may prevent existence repeated configurations needed blocking 
overcome difficulty first applying transformation means
original countermodel converted countermodel finitely many new nominals  guarantees subsequent blocking based transformation applicable
yield desired regular  and thus finitely representable  model 
    bounding nominals transformations forest quasi models
argumentation  introduce notion forest quasi models  structures
satisfying originally considered knowledge base weakened form it 
   

firudolph   glimm

return concession  exhibit proper forest structure easier handle
manipulate 
employ two techniques turn proper models forest quasi models vice
versa  model unraveled yielding forest quasi model  forest quasi model
collapsed obtain proper model  techniques preserve certain structural properties 
strategy construct countermodel finitely many nominals consists
following three steps 
take arbitrary countermodel unravel it 
transform obtained forest quasi model substituting critical parts wellbehaved ones 
collapse obtained structure  proper  model 
mentioned critical parts giving rise new nominals 
least largely avoided  we care finite set critical parts
remaining  
central question is  mysterious well behaved substitutes come from 
fortunately  plethora critical parts brings remedy  use infinite
sets critical parts construct well behaved ones infinite approximation process
 this infinity friend   thereby obtain parts present
structure before  well compatible hence used
reorganization 
informally introduced main line argumentation  move
technical details 

   preliminaries
first define syntax semantics roles  go shoiqb concepts 
individuals  knowledge bases  actually use full expressivity shoiqb 
convenient umbrella dls working define less
expressive dls interest restrictions shoiqb 
definition    syntax shoiqb   let nc   nr   ni countable  infinite 
pairwise disjoint sets concept names  role names  individual names  respectively 
call    nc   nr   ni   signature  set rol s  shoiqb roles  or roles
short  nr  r   r nr    roles form r called inverse roles  role
inclusion axiom form r v r  roles  transitivity axiom form
trans r  r role  role hierarchy h finite set role inclusion transitivity
axioms 
role hierarchy h  define function inv roles inv r     r r nr
inv r     r   role name nr   further  define vh smallest transitive
reflexive relation roles r v h implies r vh inv r  vh inv s  
write r h r vh vh r  role r transitive w r t  h  notation r  vh r 
   

finominals  inverses  counting  conjunctive queries

role exists r vh s  vh r  trans s  h trans inv s   h  role
called simple w r t  h role r r transitive w r t  h r vh s 
r rol s  simple role  boolean role expressions u defined follows 
u     r   u   u u u   u u 
use   denote standard boolean entailment set roles r rol s  role
expressions  let r rol s   u boolean role expression r  inductively define 
r   r r r  r    r otherwise 
r   u r    u   r    u otherwise 
r   u u v r   u r   v   r    u u v otherwise 
r   u v r   u r   v   r    u v otherwise 
boolean role expression u safe    u  
given signature    nc   nr   ni    set shoiqb concepts  or concepts
short  smallest set built inductively symbols using following
grammar  ni   nc   n in    simple role  u role safe
boolean role expression 
c            o      c   c  u c    c  c   
 
u c   u c     n s c     n s c 
alternatively  safeness characterized follows  boolean role expression u
safe if  transforming disjunctive normal form  disjunct contains least
one non negated role  intuitively  implies safe role expression never relate
individuals direct role relation other 
definition    semantics shoiqb concepts   interpretation    i     consists
non empty set   domain i  function   maps every concept name
nc subset ai   every role name r nr binary relation ri  
every individual name ni element ai   role name r nr  

interpretation inverse role  r   consists pairs h   
h     ri  
semantics shoiqb concepts signature defined follows 
 r i
 i
 c i
 u c i
 u c i
   n s c i
   n s c i

 
 
 
 
 
 
 

  ri
 r  u r   i   r i r i
 r  r   i   r i r i



 
  o  i    oi  
  c
 c u d i   c di
 c d i   c di

 

 

    h  u   c  
    h    u   c  
      si    c   n 
      si    c   n 

  m   denotes cardinality set si    c  defined
      h    si   c   
concept c negation normal form  nnf  negation occurs front concept
names use nnf c  denote negation normal form concept c 
 
   

firudolph   glimm

concept transformed linear time equivalent one nnf pushing
negation inwards  making use de morgans laws duality existential
universal restrictions  at most at least number restrictions form
  n r c   n r c respectively  horrocks  sattler    tobies        
definition    syntax semantics axioms knowledge bases   functionality
restriction expression func f   f role  c  concepts  general concept
inclusion  gci  expression c v d  introduce c abbreviation
c v v c  finite set gcis functionality restrictions called tbox 
 
 
 abox  assertion expression form c a   r a  b   r a  b     b   
  b 
c concept  r role  a  b ni individual names  abox finite set
assertions  knowledge base k triple  t   h  a  tbox  h role hierarchy 
abox 
use con k   rol k   nom k  denote  respectively  set concept names 
roles  including inverses   individual names occurring k  closure cl k  k
smallest set containing nnf c d  c v   sub concept c
c cl k   nnf c  c cl k   role f functional k k contains
functionality axiom func f   inverse functional k k contains functionality
axiom func inv f    
let    i     interpretation  satisfies role inclusion axiom r v
ri si   satisfies transitivity axiom trans r  ri transitive binary relation  role
hierarchy h satisfies role inclusion transitivity axioms h  interpretation
satisfies functionality restriction func f   if            h    f      
satisfies gci c v c di   satisfies tbox satisfies functionality
restriction gci   interpretation satisfies assertion c a  ai c  
 
 
r a  b  hai   bi ri   r a  b  hai   bi
  ri     b ai   bi    
  b ai    bi  
satisfies abox satisfies assertion a  say satisfies k satisfies
  h  a  case  say model k write    k  say k
consistent k model 
 
knowledge base k clear context  simply say role f  inverse 
functional instead saying f  inverse  functional k 
names dls indicate constructors supported  basic dl alc
supports boolean concept constructors gcis  role hierarchies  functionality
restrictions et cetera  transitivity axioms added  use instead alc  inverse
roles indicated letter i  role inclusion axioms h  nominals  i e   concepts
form  o  ni   o  functionality restrictions f  qualified number restrictions 
i e   concepts form   n s c   n s c  q  safe boolean role expressions
b  number restrictions limited concepts form   n s     n s    use
letter n  
mostly refer particular dls paper  dl shoiq obtained
shoiqb disallowing boolean role expressions  dls shiq  shoq  shoi
obtained shoiq disallowing nominals  inverse roles  number restrictions
 incl  functionality restrictions   respectively  finally  dl alcoifb obtained
shoiqb disallowing transitivity axioms  we use alc instead name
dl indicate this   role inclusion axioms  concepts form   n s c   n s c 
   

finominals  inverses  counting  conjunctive queries

    conjunctive queries unions conjunctive queries
introduce boolean conjunctive queries since basic form queries
concerned with  later define non boolean queries show
reduced boolean queries  finally  unions conjunctive queries disjunction
conjunctive queries 
definition    syntax semantics conjunctive queries   let    nc   nr   ni  
signature nv countably infinite set variables disjoint nc   nr   ni  
term element nv ni   let nc concept name  r nr role
name  t  t  terms  atom expression a t  r t  t    refer two
types atoms concept atoms role atoms respectively  boolean conjunctive query
q non empty set atoms  use var q  denote set  existentially quantified 
variables occurring q term q  denote set variables individual names
occurring q  usual  use   q  denote cardinality q  simply
number atoms q  use  q  size q  i e   number symbols necessary
write q 
let    i     interpretation  total function   term q  evaluation
 a    ai individual name occurring q  a t   r t  t    atoms  write
   a t   t  ai  
   r t  t      t    t     ri  
if  evaluation      atoms q  write    q  say
satisfies q write    q exists evaluation    q  call
match q i 
let k knowledge base q conjunctive query     k implies    q  say
k entails q write k    q 
 
query entailment problem defined follows  given knowledge base k
query q  decide whether k    q 
definition    unions conjunctive queries   union boolean conjunctive queries
formula q        qn   disjunct qi boolean conjunctive query 
knowledge base k entails union boolean conjunctive queries q        qn   written
k    q        qn   if  interpretation    k 
   qi   n 
 
clarify connection query entailment query answering 
query answering  let variables conjunctive query typed  variable either
existentially quantified  also called non distinguished   free  also called distinguished
answer variables   let q query n variables  i e     var q     n   v            vm
 m n  answer variables  answers k q m tuples  a             
individual names that  models k     q satisfies  vi     aii
  m  recall use nom k  denote set individual names
occurring k  in form nominals abox individuals   hard see  cf 
chandra   merlin        answers k q computed testing 
   

firudolph   glimm

 a              nom k m   whether query q v       vm  a       am   obtained q replacing
occurrence vi ai   entailed k  set certain answers
q set m tuples  a              k    q v       vm  a       am     let
k     nom k   number individual names occurring k  since k finite  clearly
k finite  hence  deciding tuples belong set answers checked
k entailment tests 
algorithm present paper decides query entailment  reasons
devising decision procedure query entailment instead query answering twofold  first  query answering reduced query entailment shown above  second 
contrast query answering  query entailment decision problem studied
terms complexity theory 
    simplifying assumptions
following  make several assumptions without loss generality 
simplify presentation decision procedure 
      shoiq alchoiqb simplified alcoifb knowledge bases
following  work alcoifb knowledge bases  nevertheless  results
hold shoiq knowledge bases queries simple roles query
alchoiqb knowledge bases  i e   knowledge base contains safe boolean role
expressions  transitivity  restriction alcoifb without loss generality 
show now 
provided query contains simple roles  use elimination techniques
transitivity  kazakov   motik        reduce shoiq knowledge base alchoiq
knowledge base extended signature  eliminate qualified number restrictions role inclusion axioms transforming alchoiqb knowledge base
alcoifb knowledge base equivalent original one extension
signature  rudolph  krotzsch    hitzler         repeat formal proof here 
rather give informal argument reduction works 
assume knowledge base negation normal form  i e   gcis
form   v c c concept nnf  now  consider concept expression form
  n r c r role c concept  means least n distinct rneighbors satisfying c  however  situation enforced introducing n new roles
r            rn deemed r superrole  ri v r  pairwise
disjoint    v  ri u rj      side conditions  concept expression
replaced r   c u       u rn  c 
somewhat dual argumentation possible concept expressions form   n r c
restricting number r neighbors satisfying c n  extend
signature introducing new roles r            rn   time  let cover outgoing
r links following sense  whenever r link leads domain element
satisfies c  one roles r            rn leads there  indeed  safe boolean role
expressions allow expressing correspondence via concept description  r u r  u
      u rn   c  easy see  concept expression replace
additionally demand roles r            rn functional 
   

finominals  inverses  counting  conjunctive queries

 o  v r a

v r a

v s b

func f  

func g  

b vc td

c v f e

v g e

e v b  o 

r
 o 
e



r


f

b
c e



r


g

b
de



r


f

b
c e



r


g

b
de

r




f

b
c e

g



figure    knowledge base running example representation model
knowledge base 

finally consider role hierarchy statement r v s  stating whenever two domain
elements     connected role r  interconnected via s  clearly 
statement reformulated as  two domain elements connected r
s  this  turn  equivalently rephrased saying domain element
r u s neighbor or  expressed gci    v  r u s   
transformations applied alchoiqb knowledge base  whereby
cardinality constraints role inclusion axioms eliminated  leaves us
equivalent alcoifb knowledge base extension signature 
figure   displays alcoifb knowledge base according model 
refer running example throughout paper 
furthermore  assume abox internalized  e g   c a  replaced
equivalent gci  a  v c  r a  b   a  v r  b   etc    thus  effectively decide query
entailment respect tbox since knowledge bases setting empty
abox 
alcoifb tbox  always possible transform equivalent tbox
  signature extension gcis   one following simplified
forms 
l
g
ai v
bj    o    v u b   v u b   func f   
   
a i  b j  concept names  andindividual name  u safe boolean
f role
expression  f role       interpret ai   j      interpret bj
  alcoifb knowledge base k    t   a  simplified simplified empty 
every alcoifb knowledge base  form  transformed polynomial time desired form using standard structural transformation 
iteratively introduces definitions compound sub concepts  kazakov   motik        
thus  assume remainder knowledge base rewritten simplified
alcoifb knowledge base 
   

firudolph   glimm

      connected constant free queries
assume queries connected  precisely  let q conjunctive query 
say q connected if  t  t  term q   exists sequence t            tn
t    t  tn   t  and      n  exists role name r r ti   ti     q
r ti     ti   q  collection q            qn queries partitioning q q   q        qn  
term qi   term qj         j n  qi connected 
lemma    let k knowledge base  q conjunctive query  q            qn partitioning
q  k    q iff k    qi   n 
proof given tessaris        and  lemma  clear restriction
connected queries indeed without loss generality since entailment q decided
checking entailment qi time  follows  therefore assume queries
connected without notice 
unions conjunctive queries  assume variable names disjunct
different variable names disjuncts  always achieved
naming variables apart  assume disjunct ucq connected conjunctive query  without loss generality since ucq contains unconnected
disjuncts always transformed conjunctive normal form  decide entailment resulting conjunct separately conjunct union connected
conjunctive queries  glimm et al       a   note that  due transformation conjunctive normal form  resulting number unions connected conjunctive queries
test entailment exponential size original query 
assume queries contain constants  individual names  occur
position variables  presence nominals without loss generality 
individual name occurring q  extend knowledge base k axioms
 a  na na nc fresh concept name  replace occurrence q
fresh variable xa nv add concept atom na  xa   q 
      general notation
throughout paper  concept names role expressions written upper case 
roles individual names written lower case  unless stated otherwise  use
b concept names  c possibly complex concepts  r roles  f
functional inverse functional roles  u v safe boolean role expressions 
nominals used tbox axioms occur complex concepts  sub 
superscripts might appended necessary  stated otherwise  use q  possibly
subscripts  connected boolean conjunctive query  k simplified alcoifb
knowledge base  interpretation  i        evaluations 

   model construction
section  introduce interpretations models kind forest shape 
main notion forest is  however  weak since allow arbitrary
relations tree elements roots  without relations  call result
strict forest  exploit nice properties trees forests following sections 
   

finominals  inverses  counting  conjunctive queries

replace parts interpretations give rise infinite number new nominals 
since even models alcoifb knowledge base kind forest shape
really forests  introduce approximations models nominals longer
interpreted singleton sets  call structures quasi interpretations quasi models
interpretations form real forests  further  provide way
unraveling arbitrary model forest quasi model knowledge base
way collapsing forest quasi models back real models knowledge
base still kind forest shape 
definition    forest  quasi  interpretations  quasi  models   tree nonempty  prefix closed subset   w  w    call w  successor w w    w c
c in  denotes concatenation  call w  predecessor w w   w  c
c in  w  neighbor w w  successor w vice versa  empty
word called root tree  use  w  denote length w 
forest f subset r   r countable  possibly infinite set elements
that  r  set  w      w  f   tree  pair      f called
root f      w        w    f   call      w    successor    w      w 
successor w       w    predecessor    w      w  predecessor w 
     w    neighbor    w       w    successor    w  vice versa  node    w 
ancestor node      w        w prefix w  descendant
    w  prefix w 
forest interpretation knowledge base k interpretation    i    
satisfies following conditions 
fi  forest roots r 
fi  total surjective function   nom k  r     o        
iff oi        
fi  role r rol k   h   w        w   i ri   either
 a  w   w     
 b     w  neighbor      w    
   k  say forest model k  single root  call tree
interpretation tree model k  respectively 
let k alcoifb knowledge base  nomfree k   denote alcifb
knowledge base obtained k replacing nominal concept  o  nom k 
fresh concept name   forest quasi interpretation k interpretation
j    j   j   nomfree k  satisfies following properties 
fq  j forest roots r 
fq  total surjective function   nom k  r     o        
iff      noj
fq  role r rol k   h   w        w   i ri   either
 a  w   w     
   

firudolph   glimm

 b     w  neighbor      w    
note condition fq  allows elements    w  j w       w  noj  
call j strict condition fq   fq  b  allowed  j    nomfree k  say
j forest quasi model k 
branching degree d w  node w tree number successors w  let
   i     forest  quasi  interpretation k  k d w  k
   w    say branching degree k 
 
remainder  use concept name   mean fresh concept name
introduced nomfree k  nominal concept  o  nom k   elements
extension concept called nominal placeholders  please note that 
forest quasi interpretations j   several elements    w  w   
   w  noj  
following  define notion isomorphism forest interpretations  note
demand structural identity w r t  concepts roles w r t 
successor relation 
definition    isomorphism forest interpretations   let i    two forest inter 
pretations k                   pairs h      i  h        isomorphic
w r t  k  written h     
 k h        iff
 

   h      ri iff h        ri r rol k  
 

   ai iff i  ai        con k  
 

     oi iff i    oi        nom k  
say   isomorphic w r t  k  written 
 k     bijection
 
  that          h     
 k h          i  
successor   iff      successor      
 
clear context  omit subscript k
 k   extend definition
obvious way forest quasi interpretations  i e   omitting condition   defining
isomorphism respect k    nomfree k  
forest quasi models have  intuitively  purpose intermediate step arbitrary models k forest models k  identifying interpretation
concept knowledge base k  root interpretation  
obtain interpretation would model k apart functionality restrictions
nominals might violated  show later eliminate relations forest back roots violate functionality restrictions
eventually obtain forest model forest quasi model 
another useful property quasi interpretations that  simplified alcifb knowledge bases  checked locally whether interpretation actually model
k 
definition    local k consistency   let    i     interpretation simplified
alcifb knowledge base k   define local satisfaction concepts
occur simplified alcifb axioms follows 
   

finominals  inverses  counting  conjunctive queries

   a            con k  
 a  i    



 b  i    

f

ai aii   n  i     



ai otherwise 
f
ai aii   n  i      ai otherwise 

   u safe boolean role expression rol k   con k  
 a  i     u a   h    u i       a 
i      u a otherwise 
 b  i     u a if    h    u   i       a  i      u a
otherwise 
   f rol k   i     func f           h    f       i      func f  
otherwise 
element locally satisfies gci c v c  alcifb concepts i     c
implies i     d  locally satisfies functionality restriction func f   i     func f   
element locally k consistent locally satisfies axiom k 
 

lemma     let k simplified alcifb knowledge base    i     interpretation k  model k iff element locally k consistent 

proof  simplified alcifb knowledge bases  axioms form v u b
v u b involve checking neighbors element and  since b concept name
simplified knowledge bases  immediate satisfaction b checked locally
neighbor question 
knowledge base k nominals  use local k consistency 
need additional global condition ensures nominals interpreted singleton
sets  following immediate consequence lemma    extra condition  
nominals 
proposition     let k simplified alcoifb knowledge base    i    
interpretation k  model k iff
   element locally k consistent and 
   nom k   exactly one element oi    

   

firudolph   glimm

show obtain forest quasi model model k using
adapted version unraveling 
definition     unraveling   let k consistent alcoifb knowledge base  
 i     model k  let choose function returns  concept c   u b
cl k  element  u b i element c  h  c  u
c  b  
without loss generality  assume that  concepts c    u   b    c   
u   b  cl k  c i c i   choose c            choose c           
h   
  h    i         
unraveling element   denoted  i     interpretation
obtained follows  define set  i   sequences
smallest set
sequence 
  n n   sequence 
  n sequence 
n     hn   n  f functional role f   n      n   
n     choose c  n   c   u b cl k  
fix set f    bijection   f
 i  f forest 
 ii          
 iii     w      w c  f w c successor w     w c       w  n  
n    
forest f bijection exist prefix closed set root   thus 
map notion sequences forests 
nom k   let nc fresh concept name     w  f   set
tail   w    n    w      n   now  define unraveling interpretation
j    j   j   j   f and     w  j   define interpretation
concept role names follows 
 a  nom k   noj       w  j   tail   w  oi   
 b  concept name con k   aj       w  j   tail   w  ai   
 c  role name r rol k   h   w      w   i rj iff w  neighbor w 
htail   w   tail   w   i ri  
let r subset contains exactly oi  
nom k   let u set containing unraveling starting r 
union interpretations u called unraveling i  denoted  i  
unions interpretations defined natural way 
 
   

finominals  inverses  counting  conjunctive queries

e



bc
e

bd
e

f



bc
e

g

bc
e






r

bd
e

f

bd
e

f

g

bc
e

g

bc
e



  

 

r


bd
e
g

bc
e
f
  

r


r

r

r





r

bd
e
g

 

f
  

 

bd
e
g

f
  

e
  
 
e
  
 
e
  
 

 

figure    unraveling model displayed figure   
figure   shows unraveling example knowledge base model  dotted
lines non root elements labeled indicate copy whole tree
appended since stop unraveling nominal placeholders 
might helpful think function tail homomorphism  up signature
extension  elements unraveling j elements original model i 
indeed  tail satisfies following properties     w         w    j  
tail   w    oi iff    w  noj   nom k  
tail   w  ai iff    w  aj   con k  
htail   w   tail      w   i ri iff h   w         w   i rj   r rol k  
unravelings first step process transforming arbitrary model k
forest model since resulting model forest quasi model k  show
next lemma 
lemma     let k consistent alcoifb knowledge base    i     model
k  j    j   j      i  strict forest quasi model k 
proof  let k    nomfree k   construction  j satisfies conditions fq  fq 
forest quasi models strictness condition  since j obtained model
k  definition unravelings starting oi  
nom k   condition  a  unravelings  is  nom k   one root
     j      noj   thus  j satisfies property fq  j forest
quasi interpretation k  show j model k  demonstrating
   w  j locally k   consistent  since assume knowledge bases simplified 
consider axioms form     
   

firudolph   glimm


f

let ax axiom form ai v bj assume
   w    ai  j  

condition  b  unravelings  w   tail   w    ai  i and  since    k 
w bji j  condition  b  unravelings     w  bjj
required 
axioms form  o  k rewritten k    consider v
v separately  let ax form v nom k  assume
   w  aj   condition  b   w   tail   w  ai and  since    k 
w  oi    condition  a  unravelings     w  noj
required  v nom k   assume    w  noj   condition  a  
w   tail   w   oi   and  since    k  w ai   condition  b 
unravelings     w  aj required 
let ax axiom form v u b assume    w  aj   condition  b   w   tail   w  ai and  since    k  w 
hw   w  u w  b   let       w    h   w         w   i u j
      w   
  b j   condition  c  unravelings  hw   w  u
w    tail      w    condition  b  w 
  b   contradiction 
let ax axiom form v u b assume    w  aj   condition  b   w   tail   w  ai and  since    k  least one
w  hw   w  u w  b   case one
element  let w  w    choose c  w    then  definition sequences 
neighbor    w       w  tail   w      w    let    w      n   i e   n   w  
distinguish two cases 
   element w  w    n    definition bijection   w  
w  c  definition j  condition  c   since hw   w  u  
h   w      w   i u j   then  since b concept name w  b  
condition  b     w    b j   proves claim 
   element w  w     n    definition sequences bijection
     w        n w    now  definition j  in particular
properties  b   c    h   w      w   i u j and  since b concept
name     w    b j   proves claim 
let ax axiom form func r  r rol k   assume  contrary
shown     w  two distinct neighbors    w        w   
h   w      w   i  h   w      w   i rj   since function introduced unraveling
bijection  two distinct sequences s  s     w      s     w      s 
tail   w          tail   w                 since h   w      w   i  h   w      w   i
rj get  due condition  c   htail   w     i  htail   w     ri   contradiction since    k 
since    w  arbitrarily chosen  element domain j
locally k   consistent required j    k  lemma    
lemma     let k consistent alcoifb knowledge base     i     model k 
j    j   j      i  unraveling i  j branching degree bounded
 cl k   

   

finominals  inverses  counting  conjunctive queries

proof  let number axioms k  axiom simplified knowledge base
contain one existential restriction and  due definition function
choose used unraveling  are  sequence s  elements
              sequence s  since mapping
forest j sequences bijection  j forest branching degree m 
following steps  traverse forest quasi model order elements
smaller tree depth always smaller order elements greater tree depth 
elements tree depth ordered lexicographically  bounded branching
degree unravelings guarantees that  finite number steps  go
next level forest process nodes eventually  further  merge nodes
that  finally  nominal placeholders  in extension   interpreted
nominals without violating functionality restrictions  fact 
merge nominal placeholders  elements related nominal placeholder
inverse functional role since  definition semantics  elements
correspond element model  order identify elements  define
notion backwards counting paths follows 
definition     paths bcps   let    i     interpretation  call         n
path   n if      n  hi   i   rii role ri rol k  
length  p  path p           n n    element path length
u

un 

   write             n denote path   n hi   i   uii
    n ui safe boolean role expression 
let k alcoifb knowledge base    i     forest model  a forest quasimodel  k  path p          n descending path root     
that    n       wi   and      n   wi      wi     
path p backwards counting path  bcp  n   oi  n noi   nominal
nom k  and      n  hi   i   fii inverse functional role
rol k   path p descending bcp bcp descending path  given
f 

fn

bcp p             n   n   oj  n   noj    call sequence f  fn
path sketch p 
 
please note element domain j already counts  descending  bcp
oj  noj   nom k  
define order guarantees iterative parsing process 
process nodes  merge nodes required that  finally  nominal
placeholders interpreted nominals without violating functionality restrictions 
definition     ordering   convenience without loss generality  assume
set individual names ni ordered  let k consistent alcoifb knowledge
base j forest quasi interpretation k  extend order elements j


follows  let w    wp c   cn    w    wp c   cm
  wp longest
common prefix w  w    w    w  either n   n   c     c    
               j   let o  nom k  smallest nominal        noj 
o  nom k  smallest nominal        noj         w           w    either
 i   w       w     ii   w       w    o    o   ii   w       w     o    o  w    w   
   

firudolph   glimm

following  merging elements unraveling and  process  create
new roots form  w    elements form    w  elements form
 w  w       ww     extend  therefore  order elements form follows 
   w    w          w    w          w  w            w  w     
 
roughly speaking  proceed follows order transform quasi forest model
j forest model i  work way downwards trees level level along
descending bcps use defined order purpose  definition
semantics  elements start descending bcp or  precisely  start
bcps identical path sketches  correspond element forest
model produce  traversal forest quasi model  distinguish
two situations   i  encounter element    w  starts descending bcp
seen another element starts descending bcp path
sketch  case  promote    w  become new root node form  w   
shift subtree rooted    w  it   ii  encounter node    w  starts
descending bcp  already seen node      w    starts descending bcp
path sketch root form    w       case  delete
subtree rooted    w  identify    w     w          w  f  successor
predecessor inverse functional role f   delete f  successors    w     
subtrees order satisfy functionality restriction  use notion collapsing
admissibility characterize models predecessor    w  satisfies
atomic concepts deleted successor      w     ensures local consistency
preserved  virtue notion  characterize forest quasi models
collapsed proper models irrespective whether obtained unraveling
model not 
order keep domain forest promoting element    w  new root 
build new domain elements form  w       w  elements
form  w  w    descendants    ww       w  
definition     equivalence relation collapsings   let k alcoifb knowledge base  k    nomfree k   j    j   j   forest quasi interpretation k 
define smallest equivalence relation j satisfies           start
descending bcps identical path sketches 
let j strict forest quasi interpretation k  j     j    j      j      w   
j
 
smallest element w     starts descending bcp  call j  initial
collapsing j      w    focus j   
let ji collapsing j  i   wi   ji focus ji   obtain collapsing
ji      ji     ji     focus  i     wi     j ji according following two
cases 
   element      ji      smaller focus  i   wi  
      i   wi    ji i obtained ji renaming element  i   wi wi   
ji  i wi   wi    
   element      ji      smaller focus  i   wi  
      i   wi    let      smallest element 
   

finominals  inverses  counting  conjunctive queries

 a  ji     ji      i   wi wi      wi        w    w   c w    c in  w 
   i   wi   predecessor  i   wi    h i   wi      i   wi  i f ji
inverse functional role f rol k  h   c       i f ji    
 b  concept name con k     w  ji        w  aji   iff    w 
aji  
 c  role name r rol k       w          w    ji     h     w          w   i
rji   iff
i  h     w          w   i rji
ii       w    predecessor  i   wi   ji  i e       wi   w  c
c in        w            h     w      i   wi  i rji  
focus  i     wi     ji   smallest descending bcp  i   wi      i     wi     
collapsing ji   let safe ji   restriction ji elements    w 
   w  jj j i  j denote non disjoint union interpretations
safe ji   obtained subsequent collapsings ji j   interpretation obtained
j interpreting nom k       noj denoted collapse j   called
purified interpretation respect j  collapse j      k  call collapse j   purified
model k 
 
figures     illustrate first collapsing steps unraveling depicted
figure    apart nominal placeholder concepts  concept interpretations
shown figures  assumed indicated figure    edges
descending bcps shown red color  dashed lines figure   indicate levels
tree because  within tree  order nodes processed depends firstly
level  within level  assume order increases left right 
numbers next nodes figure   indicate  elements used focus element
collapsing step order  initial collapsing  figure    focus
first non root element starts bcp  indicate black border around
node black triangle pointing focus 
first collapsing step rename elements promote focus figure  
root  focus element highlighted figure   starts bcp path sketch
different ones started smaller elements  rename elements
obtain new root  figure     now  focus nominal placeholder since nominal
placeholder bcps  root path sketch use second case
definition     resulting collapsing depicted figure   
finally  obtain collapsing unraveling shown figure   one depicted
figure   
show collapsing unraveling results forest model
k  aim is  however  show something general  want collapse
unravelings forest models  forest quasi models obtained
another way  unfortunately  case collapsing forest quasi model
results forest model k since elements merge collapsing process
necessarily satisfy atomic concepts  define  therefore  following
admissibility criterion characterizes forest quasi models collapsed
forest models 
   

firudolph   glimm





r

r



h
 

r
 

 
f

f
r
g








f

r



g

g

 
f
g

r

h

g


r

r


 
g



r



f



r


f



figure    initial collapsing un  figure    first collapsing step
raveling depicted figure   
rename elements promote
focus figure   root 

r

r


f

r
r

r

r

f





h

r



g

g



f


f



r

r

g



g

g






n

f



g

f





r







figure    collapsing obtained figure    collapsing obtained using
one depicted figure   
second case definition   
collapsing figure   

definition     collapsing admissibility   let j forest quasi interpretation
alcoifb knowledge base k  j collapsing admissible exists function
ch    cl k  j   j
   concept c   u b cl k  c j   h  ch c   i u j
ch c    b j   moreover  functional role f h  ch c   i f j
ch c    successor  
   concept c   u b cl k  elements     c j start descending
bcps identical path sketches  h  ch c   i
  h     ch c     i 
 
lemma     let k alcoifb knowledge base  unraveling j model
k collapsing admissible 
   

finominals  inverses  counting  conjunctive queries

b
b
b
b
b
 o  e f c e g e f c e g e f c e g



r






r




r




r

r

r
  
 

figure    result collapsing unraveling fig     infinitely many new root
elements displayed top line 

proof  define function ch directly function choose used unraveling follows  c cl k     w  j    w            n
choose c  tail   w            set ch c     w        w       w               n    
        n   sequence    w               n    otherwise 
well defined since function unravelings total bijective required
admissibility since elements start bcps identical path sketches always
generated element i  first condition collapsing admissibility holds
since unravelings  always add         n   set sequences unless pair
hn   n  interpretation functional role  case  function ch uses
predecessor instead successor  still admissible 
lemma     let k consistent alcoifb knowledge base  j    j   j   strict forest
quasi model k branching degree b collapsing admissible  collapse j  
forest model k branching degree b 
proof  let k    nomfree k   since j forest quasi model k assumption  j    k   
first show collapsing ji j forest quasi model k  i e   ji    k   
show collapsing ji   produced admissible collapsing ji
collapsing admissible  finally  show that  nom k   exactly one
node j form           noj   implies proposition   
collapse j   forest model k 
start first claim  initial collapsing immediate since j
forest quasi model k  particular  j  locally k   consistent  assume ji
locally k   consistent collapsing  i   wi   focus ji   show ji   locally
   

firudolph   glimm

k   consistent  since k  simplified assumption  consider axioms
form     
ji   obtained according first case definition     rename elements
domain order create new root node local k   consistency immediate 
assume  thus  ji  
according second case definition    
obtained
f
axioms form ai v bj  o   rewritten k    hold
immediately due condition   b collapsings 
let ax axiom form v u b assume    w  aj  
interesting elements predecessor  i   wi    focus  i   wi         however 
 i   wi        and  since j collapsing admissible   i   wi        satisfy
atomic concepts respect con k   further  interpretation atomic concepts
changed due   b  implies local k   consistency kind axioms 
let ax axiom form v u b assume    w  aji     concentrate three interesting cases direct neighborhoods elements change 
   start case focus  i   wi   corresponding u  successor
   w   i e       wi   wc c in  h   w    i   wi  i u ji    i   wi   b ji  
since       i   wi   equivalence class assumption      
starts bcp path sketch  i   wi         i   wi   satisfy
atomic concepts respect con k   condition    c ii  ensures
     required u  successor    w  ji    
   assume    w          h         c i u ji      c  b ji      c 
  ji    
j
i  
    
   u b 
  due   a  focus  i   wi   predecessor  i   wi   
 
h i   wi     i   wi  i f ji inverse functional role f rol k  h         c i
 f  ji   since f inverse functional ji is  assumption  locally k   consistent 
successor  i   wi ci    i   wi   h i   wi     i   wi ci  i  f  ji  
similarly  element      w    h           w   i  f  ji   then 
since ji collapsing admissible   i   wi    ch u b   i   wi        c 
ch u b         h i   wi     i   wi   i
  h         c i since  i   wi        start
descending bcps identical path sketches  particular  h i   wi     i   wi   i u ji
 i   wi    b ji   then  condition    c ii   h       i   wi   i u ji     condition   b   i   wi    b ji     and  thus        u b ji   required 
   assume  i   wi   predecessor  i   wi    h i   wi      i   wi  i f ji
inverse functional role f rol k  h   c       i f ji   causing deletion
   c  descendants  one which  say    v  connected      
h         v i u ji    v  b ji   now  inverse functional role
g h         v i g ji   strictness collapsing admissibility ji
ensure existence c  h         c i u ji    c  b ji and 
consequently  h         c i u ji      c  b ji     h         v i g ji
inverse functional role g  strictness initial collapsing implies
   v  started descending bcp and  due defined order  must
focus root itself  contradicts  however  initial
assumption    v  descendant      done 
cases  elements ji   required successors 
   

finominals  inverses  counting  conjunctive queries

let ax axiom form func f   f rol k   concentrate relations
predecessor  i   wi    focus      since otherwise local k   consistency
immediate  predecessor exists focus since process elements ascending order starting non root nodes  assume h i   wi      i   wi  i f ji   case
h i   wi         i f ji   due    c ii  assume      successor    c  ji
h   c       i f ji   case     c 
  ji   according   a together
 
local k  consistency ji   implies  i   wi    element ji  
h i   wi         i f ji    
show ji   produced admissible collapsing ji admissible collapsing  assumption  initial collapsing admissible  let ji
admissible collapsing chi required function  distinguish two cases 
   let ji   produced according first case collapsings  define function
chi   ji   follows  c cl k  ji     set chi    c       
     i wi   w     chi  c       i   wi wi     i   wi   focus ji     chi  c   
otherwise  since change names elements leave interpretation
concepts roles before  function required admissibility 
   let ji   produced according second case collapsings  define function
chi   ji   follows  c cl k  
 a  ji  
    i   wi            i   wi    predecessor focus
 i   wi    set chi    c            ji       chi  c    
well defined since successors       i   wi    deleted ji    
 b          i   wi    predecessor focus  chi    c       
     i   wi    chi  c         c     c 
  ji       chi  c    otherwise 
 c     i   wi    predecessor focus  set chi    c                
chi  c       i   wi       chi  c    otherwise 
elements apart predecessor focus  i   wi    root     
replaces  i   wi    interpretation concepts roles remains
properties   b   c function required   i   wi     change
function cases  i   wi   returned       returned  since
 i   wi         admissible  similarly  successor    c       contained ji      i   wi    used instead  admissible since  case 
h i   wi     i   wi   i
  h         c i argued axioms form v u b 
show that  nom k   exactly one node j form
          noj   nominal placeholders descending bcps definition and 
nominal placeholder becomes focus  merged root
equivalence class definition lower order  root exists
property fq  forest quasi interpretations 
interpretation j obtained building non disjoint union safe parts
collapsings  contain elements neither renamed deleted 
thus  j contain nominal placeholders required  considering one element
   w  j   find successors root neighbors
   

firudolph   glimm

   w  ji j   shown  ji locally k   consistent
therefore    w  consistent neighborhood  hence j forest quasi model k 
now  interpreting nom k        j        noj   collapse j   
obtain forest model k  set roots              j   
bounded branching degree immediate consequence construction since
never add successors construction starting forest quasi interpretation
j bounded branching degree assumption 
since unravelings model k strict forest quasi models k branching degree bounded  cl k   lemma     unravelings collapsing admissible
lemma     immediate consequence lemma    collapsing unraveling
yields forest model branching degree bounded  cl k   
corollary     let k alcoifb knowledge base interpretation
   k  purified interpretation collapse  i   forest model k branching
degree b bounded  cl k   
since number roots might still infinite purified models  could 
now  obtained result unraveling arbitrary model  take
elements bcps roots instead taking nominals creating new roots
collapsing process  next sections  however  show transform
unraveling counter model query remains collapsing admissible
end collapsed forest model finite number
roots still counter model query  transformation much
convenient work real  strict  trees forests  use  strict  forest
quasi interpretations 
next sections  use following alternative characterization result
collapsing  comes handy subsequent proofs 
start defining so called pruning forest quasi interpretation  is 
roughly speaking  structure obtained deleting nodes  erased
course collapsing process anyway 
definition     pruning   let j strict forest quasi model alcoifb knowledge
base k collapsing admissible let j    j            j defined definition    
pruning j  written prune j    obtained restricting j set j
defined follows  contains hw    w  w  j hw  w    w  j
hw  w    w  focus ji  
 
use equivalence relation elements start descending bcps
identical path sketches definition    construct interpretation pruning
identifying equivalent nodes  known factorization 
definition     factorization   let k alcoifb knowledge base  j strict forest
quasi interpretation k collapsing admissible  l   prune j   
factorization l  denoted l    defined forest quasi interpretation    m    
        l   
   

finominals  inverses  counting  conjunctive queries

con k           al   
r rol k   rm    h             h    rl   
nom k   om      nol  
 
note interpretation nominals well defined as  definition 
 instances  equivalence class 
ready establish wanted correspondence  collapsing forest
quasi interpretation essentially obtained first pruning factorizing it 
lemma     let j strict forest quasi model alcoifb knowledge base k
let j collapsing admissible  collapse j  
  prune j      moreover new roots
collapse j   correspond  equivalence classes contain j  elements start
descending bcps j  
proof  considering first claim  note definition collapsing procedure 
every  w  w    collapse j   exactly one pair w    w  w   w  w 
 w    w  w    prune j     moreover  case   construction assures collapse j   contains one element every  equivalence class prune j      hence mapping
  collapse j   prune j     w  w        w    w  w     bijection and  consequence construction  isomorphism 
second claim direct consequence construction collapsing 

   quasi entailment quasi models
section  provide characterization forest quasi models mirrors query
entailment corresponding proper models  argumentation 
talk initial part tree  i e   part left branches cut
fixed length  forest interpretation    i     n in  therefore denote
cutn  i  interpretation obtained restricting pairs    w 
 w  n 
following lemma ensures case purified models  find finitely
many unraveling trees depth n look different 
lemma     let k consistent alcoifb knowledge base  purified
interpretation    k and  every n in  finitely many
non isomorphic trees depth n 
proof  since k model assumption  corollary    guarantees
purified model k  particular  forest model branching degree bounded
size cl k  
compute maximal number non isomorphic trees depth n
domain i  denote bound tn   argumentation close one used
levy rousset        definition tree blocking 
   

firudolph   glimm

let c    cl k   r    rol k    first consider trees depth n       c
choices different subsets concepts cl k   n      concept level  
trigger generation new successor number successors
  c  assume  now  single role name r rol k 
node level smaller n root tree depth n   exactly
c   non isomorphic sub trees
c successors node  case  o  c tn 
depth n  taking account node necessarily c successors 
c   number nonchoose number   c  get bound o  c ctn 
isomorphic sub trees depth n  finally  since one choice r roles 
c  r    abbreviate  c cr x rc rewrite
get bound o  c  ctn 
n 
n
obtained bound tn   o x tn   a    unfolding yields tn   o  x  a     a   t   a  
n
n
n
bounded o  xa    c  a     o  x c  a    expanding abbreviated symbols 
n
obtain bound tn o   c cr   rc    
considerations  introduce notion anchored n components 
meant certain substructures forest quasi interpretations  first
place  substructures contain connected set nodes w   situated closely
together original structure  closeness witnessed fact elements w   descendants node distance n   moreover
nodes   w     anchored n component may  but need to 
contain finite number descending bcps starting    
definition     anchored components   let j forest quasi interpretation j  
interpretation c called anchored n component j witness c
created restricting j set w j obtained follows 
let j subtree j started let j n    cutn  j    select
subset w   j n closed predecessors 
every   w     let p finite set  possibly empty  descending bcps p starting
  let w  contain nodes p p  

set w   w     w   w   
 
think forest quasi model j query q  following definition
lemma employ notion anchored n components come notion quentailment  short quasi entailment   criterion reflects query entailment world
forest quasi models 
definition     quentailment   let q conjunctive query   q    n j
forest quasi model alcoifb knowledge base k  say j quentails q  written
j   q  if  v   var q   j contains connected anchored n components c            c 
c
according functions   v   following hold 
q  every x v   least one ci    x    
q  a x  q   x  aj i 
   

finominals  inverses  counting  conjunctive queries

q  every r x  y  q ci    x     y 
h      rj  
q  if  x v   connected anchored n components ci cj
 x    j  x  
sequence cn            cnk n    nk   j
sequence             k     k     well nm  x 
    k 
that  every     k 
cnm contains descending bcp p  started  
cnm   contains descending bcp p  started m    
p  p  path sketch 
union conjunctive queries u   q        qh   say j quentails u  written
j   u  j   q q  q            qh   
 
note anchored component may contain none  one several instantiations
variable x v   intuitively  definition ensures  find matches query parts
fitted together identifying bcp equal elements yield complete query match 
lemma     let u   q        qh union conjunctive queries k alcoifb
knowledge base 
   model k   i    u implies    u 
   strict forest quasi model j k collapsing admissible  collapse j      u
implies j   u 
proof 
   let q disjunct u  i    q  v   var q   c            c 
connected anchored n components witnessing quentailment  use function
tail definition    exploit properties homomorphism  note tail
maps nodes  i  individual i  start descending bcps
path sketches  due condition q  definition     implies 
every x v every    x    j  x   tail       tail      hence 
total function   v defined letting  x    whenever tail    
 x       well defined  show query
match q examining atoms q 
every unary atom a x   definition quentailment ensures
exist ci ci  x  aj   then  definition tail 
follows  x    tail   ai  
likewise  every binary atom r x  y   definition quentailment ensures
exists ci       ci    x     y 
well h      rj   again  definition tail  follows h x    y i  
htail      tail    i ri  
   

firudolph   glimm

   prove this  employ alternative characterization collapsings established
 
 
 
lemma     let      i       prune j    let   v match
q     use construct anchored n components functions needed
show j quentails q 
let v v contain variables maps singleton  equivalence class 
define v    v            vm   finest partitioning v that 
x  v   x partition whenever r x  y  q r rol k  
next  assign every partition v   v set qv   query atoms containing
variables v     construct every v   anchored n component cv  
function v    initialized yielding inputs  follows 
every x v     let cv   contain j  element  x        note
 
consists  equivalence classes elements j   i e     
 
one  equivalence classes   moreover  set v    x    v    x     
every r x  y  qv     v    x        let cv   contain additional element    y  h    rj  existence assured definition
collapsing via factorization  elements descending bcp
prune j   starting  existence assured since       singleton class  
moreover set v    y    v    y        
likewise  every r x  y  qv   x   v    y        let cv   contain
additional element    x  h     rj  existence assured definition collapsing via factorization  elements shortest descending
bcp prune j   starting    existence assured since       singleton
class   moreover set v    x    v    x        
furthermore construct  query atom contains variables v  
anchored n component ca function  again initialized always return
  follows 
  r x  y   let ca contain two nodes        x 
   y  h      rj  existence assured definition via factorization 
well prune j   descending bcp starting   shortest
prune j   descending bcp starting    
  a x   let ca contain node  x  aj  existence
assured definition via factorization  well shortest prune j   descending bcp starting  
let c contain cv   ca defined far  note c already satisfies conditions
q  q  definition     add anchored n components
order satisfy condition q  well  let c  initially empty  x v
 x  non singleton equivalence class two c   c c  x 
   x   that  since    equivalence class  x  
sequence             k j  nodes         k every
i   start descending bcp path sketch  enhance c  one
anchored component per contains corresponding descending
   

finominals  inverses  counting  conjunctive queries

 x   

r

r



 o 
e




bc
e

f

 x   

g

 x   

r




bd
e

 x    f

r

r



bc
e

bd
e

g

 x   

r



bc
e
g

f





e
r

c 


   x   
r


   x   

c 

bc
e

r



bd
   x      x   
e

f

g

bc
e

bd
f
   x   
e

f

r

bc
   x   
e



e
  
 

r




bd
e

r




bc
e

g

bc
e

g

bc
e

bd
e

f

bd
e

f

bd
e

f

r
  

 



g

g
  

e
  
 

g
  

 

 

e
  
 

  

 

figure    correspondence entailment quentailment 
bcps  then  construction  elements cc  constitute necessary anchored
n components justify j quentails q and  thus  j quentails u 

example correspondence  query  entailment quentailment 
consider conjunctive query
q    r x    x     s x    x     f  x    x     s x    x     
match query example model figure   displayed upper
part figure    witnesses    q  lower part  anchored components c 
c  according functions     establish  i    q 

   limits forest transformations
introducing following constructions detail  try provide highlevel explanation convey intuition behind subsequent steps  mentioned before 
one major obstacles decision procedure conjunctive query entailment
   

firudolph   glimm

dls including inverses  nominals  cardinality restrictions  or alternatively functionality   potentially infinitely many so called new nominals  domain elements
identified linked proper nominal via bcp 
however  show every model knowledge base satisfy
conjunctive query  i e   every countermodel   nice countermodel
finitely many new nominals  in subsequent section  argue ensures
existence procedure terminates query entailed knowledge
base question   provide construction transforms arbitrary countermodel
nice one first unraveling quasi forest model  substituting new
nominals uncritical elements finally collapsing result back proper model 
this  find appropriate substitutes new nominals 
substitutes fit environment without introducing new nominals 
due global cardinality constraints bcps impose elements  existence infinitely many new nominals implies witnessing bcps must get
longer longer  looking finite distance neighborhood 
new nominals look non nominal domain elements  state affairs
exploited essentially constructing new domain elements environment limits 
way  new domain elements characterized property
approximated arbitrary precision already present domain elements possibly without present domain   see following new
domain elements serve substitutes looking for 
definition     limits model   let    i     model
alcoifb knowledge base k  tree interpretation j said generated  written 
j c    isomorphic restriction  i    elements     cw       cw 
 i     c   h  h in 
set limits  written lim i  set tree interpretations j
every k in  infinitely many cutk  l 
  cutk  j  
l c  
 
figure    displays one limit element example model 
following lemma gives useful properties limits  besides rather obvious compatibility considerations respect knowledge base satisfaction  claim  
lemma    provides us pleasant useful insight root node limit
never part bcp all 
lemma     let k alcoifb knowledge base  k    nomfree k   purified model
k  n fixed natural number  following hold 

   let l  tree interpretation infinitely many l   
cutn  l  lc  then  least one limit j lim cutn  j  
 
l   
   every j lim locally k   consistent apart root      
   analogy  consider fact real number approximated sequence rational
numbers  even irrational 

   

finominals  inverses  counting  conjunctive queries






bc
e



bd
e

f

bd
e



bc
e

g

bc
e

g

bc
e



bd
e

f

bd
e

f

bd
e

f

bd
e

bc
e

g

bc
e

g

bc
e

g

bc
e

g




 

r
  

r

r

r



r

f

  

f
 

  

f
 

  

f
 

  

bc
e
f

 

  

 

figure     one limit model fig   
   every j lim holds root      bcp    w  j  
   j lim contains node starting two backwards counting paths path sketches
s  s    element unraveling holds  direct neighborhood
isomorphic starts descending bcp path sketch s 
starts descending bcp path sketch s   
   every j lim collapsing admissible 
proof 
   let b branching degree i  let dn  by assumption infinite  set
l 
  cutn  l  l c   let jn contain l 
starting k   n  iteratively increase k construct sets jk dk
tree interpretations lk   way  inductively prove properties 
induction hypothesis know dk infinite lk lk
 
cutk  m  jk   lemma     finitely many non isomorphic
tree interpretations depth k     branching degree b  partition
jk finitely many sets jk             jk m every two m  m  jk i
satisfy cutk    m 
  cutk    m     likewise  define classes dk             dk m
dk   dk         dk m dk i l c l jk i   now 
dk infinite  one dk i must infinite well set dk     dk i
jk     jk i   hence  know dk   infinite lk  
lk  
  cutk    m  jk    
thus  established infinite sequence ln   ln           li
  cuti  lj  
j   i  without loss generality  assume isomorphic nodes named
identically  i e   even li   cuti  lj   j   i  define j
 non disjoint  union li   way established structure j
cutk  j     lk know every k infinitely many  namely
elements dk   cutk  l 
  lk l c   hence j limit
element desired properties 
   let    w  w    node j   choose cut w     l 
 
cut w     j   l c  by definition  even infinitely many
   

firudolph   glimm

choose from   l contains node whose direct neighborhood isomorphic
   w   however  l contained  i       k assumption 
locally k   consistent hence is  therefore    w  locally k   consistent j  
   assume contrary  i e   j lim bcp root     
   w  j    w  noj nom k   since functionality
definition bcps  bcp uniquely identifies one domain individual 
definition lim i  however  infinitely many satisfying cut w   l 
 
cut w   j   j c infinite number individuals
counting path oi   contradiction 
   choose k maximum length two bcps  definition limit 
contains element cut w  k  l 
  cut w  k  j   l c   now 
let   l element  with respect isomorphism  corresponds
j   then    origin two descending bcps path sketches s 
s    let tail            since path sketches descending bcps uniquely identify one
domain individual  every node unraveling starts descending bcp
path sketch s  must caused   well  furthermore  as
direct neighborhoods isomorphic specific design choose function
definition    renders successors non isomorphic   successors
uniquely correspond neighbors   turn successors    
turn implies that  every successor   one finds successor  
isomorphic direct neighbourhood  yet  synchronicity argument inductively
applied thereby iterated bcp  thus  obtain starts
descending bcp path sketch s   
   define function ch    cl k  j   j essentially proof
lemma     namely referring function choose  given element j
starts bcp length   j   choose   cut      l 
  cut      j  
l c     l contained  i       proceed define ch c   
demonstrated proof lemma    

defined limit elements convenient building blocks restructuring forest
quasi interpretations  following definition provides first hints inside
structure one existing node  and successors  safely exchanged limit
element 
definition     n secure replacement   let k alcoifb knowledge base  model
k  j forest quasi model k j   strict tree quasi interpretation
j   lim called n secure replacement
cutn   j      isomorphic cutn  j     
every anchored n component j   witness     isomorphic anchored
n component j witness  
   

finominals  inverses  counting  conjunctive queries

e







 
  

bc
e

bd
e

f

bd
e


 



bc
e

g

bc
e

g

bc
e



bd
e

f

bd
e

f

bd
e

f

bd
e

bc
e

g

bc
e

g

bc
e

g

bc
e

g

r
 



r

r



r



f

  

f
 

  

f
 

  

f
 






r

  

bc
e
f

 

  



bd
e
g



r

bc
e

bd
e

f



bc
e

g

bc
e



bd
e

f

bd
e

f

bc
e

g

bc
e

g

bc
e

r

r

r

f
  



r





 



  


r



r

 

bd
e
g

f
  

 

bd
e
g

f
  

e
  
 
e
  
 
e
  
 

 

 

figure     forest quasi model  right  according   secure replacement  left  
j n secure replacement lim i  call n replaceable w r t  i  otherwise
call n irreplaceable w r t  i 
 
figure    displays   secure replacement considered unraveling example
model 
defined elements forest quasi model eligible replaced
limit element  make sure many elements  actually defined
terms original model  exempt replaced 
lemma     every purified model alcoifb knowledge base k contains
finitely many distinct elements start bcp cause n irreplaceable nodes
unraveling i 

proof  assume converse  let purified model k contain infinite set elements
giving rise n irreplaceable nodes  i   must l 
infinite set d  every d  d  generates l cutn  l 
  l  since
lemma     finitely many non isomorphic choices l     set d 
used guide construction specific limit element j lim according lemma
      now  element    w  j starting bcp  let l  w  length
shortest bcp starting    w   then  let k maximum l  w 
individuals    w  j start bcp  w  n  construction  d 
contains one element d   generating l cutk  l 
  cutk  j    actually infinitely many  
choice k lemma       conclude j n secure replacement
irreplaceable  i  node caused d   contradicts fact d   d 
know  elements forest quasi model replaced suitable limit
element  following definition exactly tells us  replacement carried out 
respective element successors deleted limit element  together
successors  inserted position 
   

firudolph   glimm

e



bc
e

bd
e

f



bc
e

g

bc
e

bd
e

f

bd
e

f



bc
e

g

bc
e

g

bc
e



bd
e

f

bd
e

f

bd
e

f

bd
e

bc
e

g

bc
e

g

bc
e

g

bc
e

g





  

 

r

f

  

r


r

r


r

r



r






r

f

  

 

f
 

  

f
 

e
  
 
e
  
 

  

bc
e
f

 

  

 

figure     result replacing element   secure replacement depicted figure     inserted component highlighted 

definition     replacement step   let k alcoifb knowledge base  model
k  j forest quasi model k  i e   j    k    nomfree k   let    w  j
n replaceable w r t  j   according n replacement    w  lim root
     
define result replacing    w  j   interpretation r
 

j
  
  
j
j
 
 
r   j
red     ww        w     red           ww      w        
 

 
 
j
con k     ar    aj j
red       ww        w    
j
 
  
 
  
r rol k     rr    rj j
red red   h   ww       ww  i   h   w       w  i
 
rj  
 

figure    displays result carrying replacement step example 
following lemma assures replacement described above  new
anchored n components introduced  instead anchored n components present
n secure transformation present completely contained inserted limit
element 
lemma     let k alcoifb knowledge base  model k  j forest quasimodel k  i e   j    k    nomfree k   let    w  j n replaceable w r t  i  let
j   n replacement    w  root      r result replacing    w 
j     following hold 
   cutn   j      w    isomorphic cutn   r     w    
   

finominals  inverses  counting  conjunctive queries

   n    r locally k   consistent 
   whenever r contains anchored n component c  one j j   contains
anchored n component isomorphic c 
proof 

   direct consequence definitions       

   make case distinction element wise investigating local consistency r
 note k k  simplified local consistency node    v  r
depends node direct neighbors  
v   ww  w       direct neighborhood    v  r isomorphic direct neighborhood    w    j    recall      root
j      lemma       j   locally k   consistent except possibly       hence
   v  locally k   consistent r 
v    ww  w    i e      v  affected replacement 
direct neighborhood    v  changed replacement and  therefore 
neighborhoods    v  j r coincide  j locally k   consistent
assumption     v  r 
v   w  case  direct neighborhood    v  changed remained
isomorphic  follows preceding statement        
   let      w    witness c  distinguish three cases 
    w prefix w    then  clearly c completely contained j    
    w  prefix w  let c   structure obtained restricting c
elements form    ww     renaming every element    ww    
   w           root j     c   anchored n component
j   witness       now  definition replacing  j must contain
isomorphic copy c   witness    w   since part c  consisting
nodes      w    w prefix w    altered
replacement  conclude j must contain isomorphic copy c 
neither above  then       w    subtree rooted      w    contained
j part j affected replacement  then  clearly
c contained j  

ready defining whole process restructuring forest quasi model
essentially substituting many nodes possible appropriate limit elements 
definition     n secure transformation   let model alcoifb knowledge
base k j unraveling i  interpretation j   called n secure transformation
j obtained  possibly infinitely  repeating following step 
choose one unvisited w r t  tree depth minimal node    w  n replaceable
w r t  i  replace    w  one n secure replacements lim mark    w 
visited 
 
   

firudolph   glimm

b
b
e f c e g e





bd
e

f

bd
e



bc
e

g

bc
e

g

bc
e



bd
e

f

bd
e

f

bd
e

f

bd
e

bc
e

g

bc
e

g

bc
e

g

bc
e

g

r

r

r
 

r





  



r

bc
e

r





r







r

f

  

f
 

  

f
 

  

f
 

  

bc
e
f

 

  

 

figure     result collapsing forest quasi model displayed figure    
note well defined every node visited formerly
irreplaceable node ever becomes replaceable  hence every k in  initial segment
cutk  j   current intermediate structure j already isomorphic initial segment
cutk  j     j   bounded number replacement steps  due fact involved
structures bounded branching degree 
now  whole effort might still look bit contrived pointless  however 
following lemma establishes bunch properties end allow us deduce
existence well behaved countermodel whenever all 
show process unraveling  n secure transformation collapsing preserves property model knowledge base  with right choice n 
preserves property entailing conjunctive query  moreover  model conversion process ensures resulting model contains finitely many new nominals
 witnessed bound length bcps   figure    illustrates properties
example model  note two new nominals left whereas collapsing original
unraveling yields infinitely many 
lemma     let purified model alcoifb knowledge base k  j unraveling i  j   n secure transformation j   following hold 
   j   strict forest quasi model k 
   j   collapsing admissible 
   collapse j     model k 
   natural number j   contain node whose shortest
descending bcp length greater m 
   

finominals  inverses  counting  conjunctive queries

   j   contains anchored n component c  j contains anchored n component
isomorphic c 
   if  union conjunctive queries u   q        qh   j    u n  
maxq q       qh     q   j      u 
   if  union conjunctive queries u   q        qh       u
n   maxq q       qh     q   collapse j         u 
proof 
   let k    nomfree k   due lemma     j strict forest quasi model
k  lemma       replacement step preserves local k   consistency results  thus  forest quasi model k  since n replacement strict tree
quasi interpretation strictness preserved  induction follows every interpretation produced n secure transformation procedure strict forest quasimodel k  every node j     direct predecessor direct successors
changed finitely many replacement steps local k   consistency
depends solely neighbors  hence j   locally k   consistent 
   lemma     j collapsing admissible  lemma      every limit is  moreover  obvious proofs propositions  possible define
respective ch functions recurring original choose function i  hence every
two elements  even different  unravelings limits start descending bcps
identical path sketches correspond element whence
separate ch functions compatible other  therefore  replacing element unraveling yields strict forest quasi model collapsing admissible 
applying argument inductively yields every intermediate strict forest
quasi model n secure transformation collapsing admissible  finally 
according ch function stabilizes finitely many replacement steps  together
neighborhood considered elements   j   collapsing admissible 
   follows two previous facts             together lemma    
   consider set causing n irreplaceable nodes j   lemma    
finite  obtain d  removing start descending
bcps 
d    let dbcp   denote set descending bcps starting choose

   max 


min


 p 

pdbcp  

assume   shortest descending bcp length greater
m  obviously      d    must    w  generated   nreplaceable  however  n secure transformation n replaceable elements
replaced elements start descending bcps due
lemma      
   

firudolph   glimm

   prove induction replacement steps n secure transformation
process showing true every intermediate replacement result r   
claim j   follows fact that  every considered c  which
always finite   finite part cut   j     relevant every   
bounded number replacement steps cut   r      cut   j    
every intermediate r   
base case  zero replacement steps carried out   find r    j   claim
trivially true 
assume claim established r shown r 
created replacing    w  r j      lemma       know
one following case 
r contains c  yet  apply induction hypothesis conclude
j contains c claimed 
j    contains c  but  since c finite  already contained cutk  j     
k and  j    limit element  find one cutk   i      
cutk  j       since purified  find    w  j corresponds   i e  
j contains isomorphic copy  i    turn contains isomorphic
copy c 
   actually straightforward consequence preceding proposition
definition quentailment 
indirect proof  suppose j    u n   maxq q       qh     q  j     u 
latter witnessed j     q q  q            qh    definition  latter assures
existence adequate anchored n components j     then  applying preceding
proposition         obtain isomorphic copies anchored n components contained j which  definition  means j   q and  therefore  j   u 
hence  contradiction  proves claim 
   prove indirectly  assume     u  n   maxq q       qh     q   collapse j       
u  witnessed collapse j        q q  q            qh   
then  lemma       follows j     q  previous proposition        
conclude j   q  turn implies    q lemma       implies    u 
contradiction 

able establish first milestone way showing finite representability countermodels 
theorem     every alcoifb knowledge base k k     u  forest model
k finitely many roots     u  moreover  bounded branching degree 

   

finominals  inverses  counting  conjunctive queries

proof  let u   q        qh   since inconsistent knowledge base entails every query 
assume k consistent and  since k     u  model k     u 
choose n   maxq q       qh     q  let j   obtained carrying n secure
transformation  i  let     collapse j      know   model k  via
lemma             u  by lemma       
lemma       know fixed natural number shortest
descending bcp started node j   shorter m  note
finitely many path sketches length m  means every node j   starts
descending bcp assigned one path sketch  however  entails
finitely many elements  i e    equivalence classes    contain
j    elements starting descending bcps j     implies  via lemma       contains
finitely many roots 
fact   bounded branching degree direct consequence fact
initial unraveling bounded branching degree  replacement change
branching degree collapsings assured lemma    

   finite representations models
section  show construct finite representation forest model
knowledge base finite number roots  show
finite representations used check query entailment  order this  use
technique similar blocking techniques used tableau algorithms  see  e g  
horrocks   sattler         tableau algorithm builds so called completion graph
finite representation model  completion graph essentially structure
forest quasi models  contains root nodes nominals occurring input
knowledge base plus root nodes new nominals start bcps   new
old  nominal root tree  relations occur direct neighbors within
tree  elements within tree root  roots  initial completion
graph contains nodes nominals occurring input knowledge base  concepts
expanded according set expansion rules  new nodes added graph
expanding existential restrictions  new nominals added so called nn rule
whenever element within tree relationship inverse functional role
root node represents nominal input knowledge base  i e   bcp
created  order obtain finite representation  tableau algorithms usually employ
cycle detection mechanism  called blocking  otherwise depth trees
number new nominals might grow infinitely  logics expressive alcoifb 
blocking usually requires two pairs elements  notation   non root  node n
predecessor n  blocks node predecessor m    hn    ni
  hm    mi  order
obtain real model finite representation  part n copied
appended infinitely often  use similar technique obtain finite representation
forest model  since want preserve non entailment  working pairs
elements sufficient  instead  take length n query account use
isomorphic trees depth n define blocking  technique first employed
deciding query entailment alcn role conjunctions  levy   rousset       
recently extended logics alchiq  alchoq  alchoi  ortiz       
   

firudolph   glimm

ortiz et al       a  extends  result  dls shiq  shoq  shoi  i e  
transitivity  long query contains simple roles 
forest quasi interpretations  use isomorphisms forest interpretations
parts them 
definition     isomorphism forest interpretations   let k alcoifb
 
 
knowledge base    i           i     two forest interpretations k  without
loss generality  assume root        extension
unique concept n occur con k     called isomorphic
 
w r t  k  written 
 k     iff bijection   that 
  successor   iff      successor             
 

h      ri iff h          i ri       r rol k  
 

ai iff    ai con k   n            
 

  oi iff      oi nom k  
 
usually  omit subscript k
 k assume clear context 
definition     n blocking   let n fixed natural number    i    
   w    w    forest interpretation alcoifb knowledge base k 
n blocking tree w r t     w   denoted blockni    w   interpretation obtained
restricting elements     ww       w    n                  n blocking tree
blockni    w  n blocks n blocking tree blockni    ww   
   blockni    w  blockni    ww    disjoint domains except root elements 
   bijection elements blockni    w  elements blockni    ww   
witnesses blockni    w 
  blockni    ww    
   descendant    wv     w   inverse functional role f root
     h   wv       i f  
node    v  n blocked     v  either directly indirectly n blocked      v 
indirectly n blocked  one ancestors n blocked     v  directly n blocked none
ancestors n blocked    v  leaf n blocking tree blockni    ww   
n blocked  case say    v   directly  n blocked    ww   
bijection witnessing
  
without loss generality  assume n blocking trees used minimal
w r t  order elements  cf  definition     
forest interpretation    i     k n representation k
   finite 
   contains indirectly n blocked nodes 
   nom k   one element form      oi  
    i  
   

finominals  inverses  counting  conjunctive queries

   element directly n blocked locally k consistent 
 
note n     restrictive standard pairwise blocking since two trees
depth one need isomorphic blocking occurs  whereas standard blocking
already occurs two isomorphic pairs nodes  dls expressive alcoifb 
however  n greater    at least trees depth    want transform
n representations models knowledge base  show knowledge
base n representation fixed n and  afterwards  use
n representation build model knowledge base 
lemma     let k consistent alcoifb knowledge base u   q        qh union
conjunctive queries n fixed natural number greater max ih  qi    k     u 
n representation k satisfy u 
proof  assumption  k consistent k     u  then  theorem     forest
model k finitely many roots branching degree bounded  cl k   
q  q            qh   holds     q  show find n representation r i 
use similar argumentation lemma    show finitely many
non isomorphic n blocking trees  denote bound tn   let c    cl k    r  
 rol k     finite  number roots i  root annotated
special concept n assumption  n       c choices  n     
element   c successors   relations roots 
roots  c m choices concepts  use  cm bound choice
concepts roots clearly bounds choice non roots well  non root
node level smaller n root tree depth n   node
sub tree relations root  assuming single
cm   number non isomorphic
role name r rol k   get bound o  c cmtn 
sub trees depth n relations roots  since one
cm  r    abbreviate  c  cm r
choice r roles  get bound o  c  cmtn 
x cmr rewrite obtained bound tn   o x tn   a    unfolding
n
n 
n
n
n
yields tn   o  x  a     a   t   a   bounded o  xa    c  a     o  x c  a   
n
expanding abbreviated symbols  obtain bound tn o   c  cm r   cmr    
together fact obtained collapsing relations elements
within tree root collapsings never inverse functional roles  shows
n representation tree rooted node     
depth greater tn   two nodes    w     ww    blockni    w 
n blocks blockni    ww     simply discard indirectly n blocked nodes
obtain desired n representation 
since     q n representation restriction i  non entailment q clearly
preserved 
please note would obtain bound fixed bound
number new nominals  roots  beforehand cannot use standard tableau
algorithms obtain result  reason number new nominals
 roots  tableau algorithms depends length longest path blocking
   

firudolph   glimm

occurs  n blocking trees  however  consider relations back
roots  means blocking occurs later roots have 
hand  delaying blocking may lead introduction new roots  due
cyclic argument  termination cannot guaranteed tableau algorithms unless
fixed bound number new nominals beforehand  reason
tableau algorithm entailment conjunctive queries simple roles
query calvanese et al         sound  complete  terminating shiq  shoq 
shoi knowledge bases  guaranteed terminate shoiq knowledge
bases  transitivity  i e   dl instead alc impact
this  
show  obtain model knowledge base k nrepresentation k  use technique directly inspired tableau algorithms
resembles process building tableau complete clash free completion
graph  particular tableau algorithm ortiz et al   ortiz        ortiz et al       a 
similar uses tree blocking 
definition     models n representations   let r    r   r   n representation
 
 
alcoifb knowledge base k  let               
sequence pairs elements

r
 
   s  denote length s  sequence s  set last  s   
 

 

 

 

m  
last  s        m  
denote sequence             
  m    
m  
set r induced elements  denoted elem r   inductively defined follows 

       r  




elem r  

elem r        w  r   n blocked  successor last  s  
  elem r  
elem r        w  r   directly n blocked   r  
 
successor last  s     elem r  
define interpretation    i     induced r follows 
  elem r  
con k   ai iff last  s  ar  
nom k     oi iff last  s     
s  s  r rol k   ri  
 hs  s    s     
 hs  s      s   
 hs  s    s   
 hs  s     

 

 


hlast  s   last  s   i rr  
hlast  s   last  s   i rr  



hlast  s  

 
h  last  s  i

rr  
rr   
 

interpretation nominals well defined since n representations forest interpretations k  hence  unique root nominal  pairs       
never appended sequences elem r  
   

finominals  inverses  counting  conjunctive queries

lemma     let k consistent alcoifb knowledge base  u   q        qh union
conjunctive queries  n   fixed natural number greater max ih  qi    r
n representation k r     u  model k     u 
proof essentially one ortiz et al       a   adapted case 
work completely interpretations  n representations correspond completion
graphs models tableaux case 
proof  let interpretation induced r  since n representations contain
relations element within tree root inverse functional role definition 
functionality restrictions violated i  further  since k simplified r forest
interpretation k elements apart  directly  n blocked ones locally
k consistent  quite straightforward element induced interpretation
locally k consistent  together restriction nominals  property     implies
model k  essentially principle one used prove
tableaux constructed completion graphs proper representations models
input knowledge base 
assume  contrary shown     u  disjunct
q  q            qh   match q    q  use construct match
q r shifting mapping variables parts direct counterpart
r upwards 
define match graph g q undirected graph containing node
 x    x var q  containing edge hs  s 
s  s  atom r x  y  q   x    s   y    s    call nodes
g correspond roots root nodes g  i e   nodes    
call nodes tree nodes  note restriction g tree nodes set trees
refer g            gk tree depth smaller n 
x var q   x      root node g   set  x    last     
note root node r 
gi  g            gk    distinguish two situations 
   gi contains node last  s     last  s   i e   gi contains path within
n blocking tree copy path starting node blocks   due
use n blocking  single tree gi never cover one n blocking
tree use nodes two n blocking trees  leaving one
entering next one less n steps   node s  gi  s       s 
x var q   x    s    set  x     last  s      s  gi
 s     s  x var q   x    s    set  x    last  s    
   gi contains node last  s     last  s   i e   gi contains path lies
completely within n blocking tree path outside n blocking tree
n blocking tree   node gi x var q   x    s  set
 x    last  s  
definition   induced model r  n blocking  immediately
that  a x  q   x  ar   show that  r x  y  q  h x    y i rr  
proves r    q  distinguish three cases 
   

firudolph   glimm

    x    r    x           r   distinguish three cases
 y  
 

 a   y      root   y               r and  since match
q definition induced interpretation r 
h x    y i   h    rr  
 

 b   y  successor  x  i  i e    y            n blocked
 y             c  r c in  again  since match q
definition induced interpretation r 
h x    y i   h    rr  
 

 c   y  neither root   y         r   successor  x 
 
  y           r     y  belongs graph match component gi  y    last   y    y     last   y     since isomorphism
n blocking trees takes relations root nodes account
parts direct counterparts r  h x    y i rr  
 

    x       r   cases  y        r
above  assume  therefore   y    s   s         definition i 
means either   s      s    s        r   assume s    s     
opposite case analogous  definition match graph g  component
gi g contains s    distinguish two cases 
 a  component gi contains node last  s     last  s  
interesting case last   y      last   y    i e     s     x   
 last  s    y    last  s     since last  s       last  s     last  s   
node directly n blocks last  s    and  definition bijection
  witnesses isomorphism   x     last  s  
predecessor  y    last  s    and  definition r  h x    y i
rr  
 b  component gi contains node last  s     last  s    x   
last   x    y    last   y    definition r  immediately
h x    y i rr  
case  h x    y i rr   implies r    q contradicting initial
assumption 
lemma    guarantees that  case k     q  always finite n representation
r k r     q lemma    guarantees r transformed
model k     q  suffices show enumerate  finite 
n representations k check whether entail disjunct union conjunctive
queries  together semi decidability result fol  get following theorem 
theorem     let k alcoifb knowledge base u   q        qh union
conjunctive queries  question whether k    u decidable 

   

finominals  inverses  counting  conjunctive queries

   conclusions
solved long standing open problem deciding conjunctive query entailment
presence nominals  inverse roles  qualified number restrictions  shown
problem decidable providing decision procedure proving correctness 
since approach purely decision procedure  computational complexity
problem remains open 
result shows decidability entailment unions conjunctive queries
shoiq sroiq  underlying owl dl owl    disallow non simple roles
binary query predicates  thereby reached first important milestone towards
tackling problem conjunctive queries owl   dl owl   dl 
entailment unions conjunctive queries closely related problem
adding rules dl knowledge base  e g   form datalog rules  augmenting
dl kb arbitrary datalog program easily leads undecidability  levy   rousset 
       order ensure decidability  interaction datalog rules
dl knowledge base usually restricted imposing safeness condition  dl log
framework  rosati      a  provides least restrictive integration proposed far
rosati presents algorithm decides consistency dl log knowledge base
reducing problem entailment unions conjunctive queries  notably  rosatis
results      a  thm      imply consistency alchoiqb knowledge base
extended  weakly safe  datalog rules decidable entailment unions
conjunctive queries alchoiqb decidable  established 
corollary     consistency alchoiqb log knowledge bases  both fol
semantics non monotonic semantics  decidable 
another related reasoning problem query containment  given schema  or tbox 
two queries q q     q contained q   w r t  iff every interpretation
satisfies q satisfies q     well known query containment w r t 
tbox reduced deciding entailment unions conjunctive queries w r t 
knowledge base  calvanese et al       a   decidability unions conjunctive query
entailment alchoiqb implies  therefore  decidability query containment w r t 
alchoiqb tbox 
two obvious avenues future work  embark extending
results order allow non simple roles query predicates  non trivial task
current approach heavily relies certain locality query matches 
relinquished considering non simple roles  hand  eager
determine associated computational complexities provide techniques form
basis implementable algorithms 

acknowledgments
stay oxford collaboration started  sebastian rudolph supported
scholarschip german academic exchange service  daad   continuative work
subject enabled funding expresst project german research
foundation  dfg  
   

firudolph   glimm

birte glimm supported epsrc project hermit  reasoning large
ontologies 
thank three anonymous reviewers numerous helpful comments 
thank ian pratt hartmann  unknowingly  smashing graphomata  maria magdalena ortiz de la fuente establishing competitive atmosphere  yevgeny kazakov
breath taking discussions black holes  boris motik motivating considerations
value academic life  last least god providing us extraordinary
weather notably infinity 

references
baader  f          terminological cycles description logic existential restrictions 
proceedings   th international joint conference artificial intelligence
 ijcai        pp         
baader  f   brandt  s     lutz  c          pushing el envelope  proceedings
  th international joint conference artificial intelligence  ijcai        morgan
kaufmann  los altos 
baader  f   calvanese  d   mcguinness  d  l   nardi  d     patel schneider  p  f         
description logic handbook  cambridge university press 
bechhofer  s   van harmelen  f   hendler  j   horrocks  i   mcguinness  d  l   patelschneider  p  f     stein  l  a          owl web ontology language reference  tech 
rep   world wide web consortium  http   www w  org tr      rec owl ref           
calvanese  d   de giacomo  g   lembo  d   lenzerini  m     rosati  r          dl lite 
tractable description logics ontologies  veloso  m  m     kambhampati  s 
 eds    proceedings   th national conference artificial intelligence  aaai
       pp          aaai press the mit press 
calvanese  d   de giacomo  g   lembo  d   lenzerini  m     rosati  r          tractable
reasoning efficient query answering description logics  dl lite family 
journal automated reasoning                 
calvanese  d   de giacomo  g     lenzerini  m       a   decidability query
containment constraints  proceedings   th acm sigact sigmod
symposium principles database systems  pods        pp          acm press
addison wesley 
calvanese  d   de giacomo  g   lenzerini  m   nardi  d     rosati  r       b   description
logic framework information integration  proceedings  th international
conference principles knowledge representation reasoning  kr       
calvanese  d   eiter  t     ortiz  m          answering regular path queries expressive description logics  automata theoretic approach  proceedings   th
national conference artificial intelligence  aaai       
calvanese  d   eiter  t     ortiz  m          regular path queries expressive description
logics nominals  proceedings   st international joint conference
artificial intelligence  ijcai        pp          aaai press the mit press 
   

finominals  inverses  counting  conjunctive queries

chandra  a  k     merlin  p  m          optimal implementation conjunctive queries
relational data bases  proceedings  th acm symposium theory
computing  stoc        pp        acm press addison wesley 
eiter  t   lutz  c   ortiz  m     simkus  m          query answering description logics
transitive roles  proceedings   st international joint conference
artificial intelligence  ijcai        pp          aaai press the mit press 
glimm  b   horrocks  i   lutz  c     sattler  u       a   conjunctive query answering
description logic shiq  journal artificial intelligence research             
glimm  b   horrocks  i     sattler  u       b   unions conjunctive queries shoq 
proceedings   th international conference principles knowledge
representation reasoning  kr        aaai press the mit press 
glimm  b     rudolph  s          status qio  conjunctive query entailment decidable 
proceedings   th international conference principles knowledge
representation reasoning  kr        pp          aaai press the mit press 
godel  k          uber die vollstandigkeit des logikkalkuls  ph d  thesis  universitat wien 
golbreich  c   zhang  s     bodenreider  o          foundational model anatomy
owl  experience perspectives  journal web semantics        
goodwin  j          experiences using owl ordnance survey  proceedings
 st owl experiences directions workshop  owled        vol     
ceur workshop proceedings  ceur  http   ceur ws org   
gradel  e          modal logics robustly decidable   paun  g   rozenberg 
g     salomaa  a   eds    current trends theoretical computer science  entering
  th century  vol     pp          world scientific 
grahne  g          problem incomplete information relational databases  lecture
notes computer science  springer verlag 
horrocks  i     sattler  u          tableaux decision procedure shoiq  proceedings
  th international joint conference artificial intelligence  ijcai       
horrocks  i     sattler  u          tableau decision procedure shoiq  journal
automated reasoning                 
horrocks  i   sattler  u     tobies  s          reasoning individuals description
logic shiq  mcallester  d   ed    proceedings   th conference automated deduction  cade        no       lecture notes artificial intelligence 
pp          springer verlag 
jet propulsion laboratory  c  i  o  t          semantic web earth environmental
terminology  sweet    http   sweet jpl nasa gov  
kazakov  y          riq sroiq harder shoiq  proceedings
  th international conference principles knowledge representation
reasoning  kr        aaai press the mit press 
kazakov  y     motik  b          resolution based decision procedure shoiq 
journal automated reasoning                 
   

firudolph   glimm

krotzsch  m   rudolph  s     hitzler  p          conjunctive queries tractable fragment
owl      proceedings  th international semantic web conference  iswc
       vol       lecture notes computer science  pp          springer verlag 
krotzsch  m   rudolph  s     hitzler  p          elp  tractable rules owl   
proceedings  th international semantic web conference  iswc        vol 
     lecture notes computer science  pp          springer verlag 
lacy  l   aviles  g   fraser  k   gerber  w   mulvehill  a     gaskill  r          experiences
using owl military applications  proceedings  st owl experiences
directions workshop  owled        ceur  http   ceur ws org   
levy  a  y     rousset  m  c          carin  representation language combining horn
rules description logics  proceedings   th european conference artificial intelligence  ecai        pp         
levy  a  y     rousset  m  c          combining horn rules description logics
carin  artificial intelligence                   
lutz  c          complexity conjunctive query answering expressive description
logics  proceedings international joint conference automated reasoning
 ijcar        pp          lecture notes computer science 
mcguinness  d  l     wright  j  r          industrial strength description logic based
configuration platform  ieee intelligent systems         
motik  b   shearer  r     horrocks  i          hypertableau reasoning description logics  submitted journal  http   www hermit reasoner com publications 
msh  hypertableau journal pdf 
ortiz  m          extending carin description logics sh family  proceedings logics artificial intelligence  european workshop  jelia        pp 
        lecture notes artificial intelligence 
ortiz  m   calvanese  d     eiter  t       a   data complexity query answering
expressive description logics via tableaux  journal automated reasoning         
     
ortiz  m   simkus  m     eiter  t       b   conjunctive query answering sh using
knots  proceedings      description logic workshop  dl        ceur
 http   ceur ws org   
pratt hartmann  i          data complexity two variable fragment counting
quantifiers  forthcoming information computation  http   arxiv org abs      
     
rosati  r       a   dl log  tight integration description logics disjunctive datalog 
proceedings   th international conference principles knowledge
representation reasoning  kr        pp       
rosati  r       b   decidability finite controllability query processing
databases incomplete information  proceedings   th acm sigact
sigmod symposium principles database systems  pods        pp         
acm press addison wesley 
   

finominals  inverses  counting  conjunctive queries

rosati  r       a   limits querying ontologies  proceedings   th international conference database theory  icdt        vol       lecture notes
computer science  pp          springer verlag 
rosati  r       b   conjunctive query answering el  proceedings     
description logic workshop  dl        ceur workshop proceedings 
rudolph  s   krotzsch  m     hitzler  p          terminological reasoning shiq
ordered binary decision diagrams  proc    rd national conference artificial
intelligence  aaai        pp          aaai press the mit press 
sidhu  a   dillon  t   chang  e     sidhu  b  s          protein ontology development using
owl  proceedings  st owl experiences directions workshop  owled
       vol      ceur workshop proceedings  ceur  http   ceur ws org   
sirin  e   parsia  b   cuenca grau  b   kalyanpur  a     katz  y          pellet  practical
owl dl reasoner  journal web semantics        
tessaris  s          questions answers  reasoning querying description logic 
phd thesis  university manchester 
tsarkov  d     horrocks  i          fact   description logic reasoner  system description 
proceedings international joint conference automated reasoning  ijcar
       vol       lecture notes computer science  pp           springer verlag 
van der meyden  r          logical approaches incomplete information  survey 
logics databases information systems  pp          kluwer academic publishers 
vardi  m  y          modal logic robustly decidable   descriptive complexity
finite models  proceedings dimacs workshop  vol     dimacs  series
discrete mathematics theoretical computer science  pp          american
mathematical society 
w c owl working group        
owl   web ontology language document
overview  tech  rep   world wide web consortium  http   www w  org tr      
rec owl  overview           
wolstencroft  k   brass  a   horrocks  i   lord  p   sattler  u   turi  d     stevens  r 
        little semantic web goes long way biology  proceedings
 th international semantic web conference  iswc       

   


