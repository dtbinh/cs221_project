journal of artificial intelligence research                  

submitted        published      

combining spatial and temporal logics 
expressiveness vs  complexity
david gabelaia
roman kontchakov
agi kurucz

gabelaia dcs kcl ac uk
romanvk dcs kcl ac uk
kuag dcs kcl ac uk

department of computer science  kings college london
strand  london wc r  ls  u k 

frank wolter

frank csc liv ac uk

department of computer science  university of liverpool
liverpool l    zf  u k 

michael zakharyaschev

mz dcs kcl ac uk

department of computer science  kings college london
strand  london wc r  ls  u k 

abstract
in this paper  we construct and investigate a hierarchy of spatio temporal formalisms
that result from various combinations of propositional spatial and temporal logics such as
the propositional temporal logic pt l  the spatial logics rcc    brcc    s u and their
fragments  the obtained results give a clear picture of the trade off between expressiveness
and computational realisability within the hierarchy  we demonstrate how different combining principles as well as spatial and temporal primitives can produce np   pspace  
expspace    expspace complete  and even undecidable spatio temporal logics out of
components that are at most np  or pspace complete 

   introduction
qualitative representation and reasoning has been quite successful in dealing with both
time and space  there exists a wide spectrum of temporal logics  see  e g   allen       
clarke   emerson        manna   pnueli        gabbay  hodkinson    reynolds       
van benthem         there is a variety of spatial formalisms  e g   clarke        egenhofer
  franzosa        randell  cui    cohn        asher   vieu        lemon   pratt 
       in both cases determining the computational complexity of the respective reasoning
problems has been one of the most important research issues  for example  renz and nebel
       analysed the complexity of rcc    a fragment of the region connection calculus rcc
with eight jointly exhaustive and pairwise disjoint base relations between spatial regions
introduced by egenhofer and franzosa        and randell and his colleagues         nebel
and burckert        investigated the complexity of allens interval algebra  numerous results
on the computational complexity of the point based propositional linear temporal logic pt l
over various flows of time were obtained by sistla and clarke        and reynolds       
       in many cases these investigations resulted in the development and implementation
of effective reasoning algorithms  see  e g   wolper        smith   park        egenhofer
  sharma        schwendimann        fisher  dixon    peim        renz   nebel       
hustadt   konev        
c
    
ai access foundation  all rights reserved 

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

space

 

x

x

x

x

x

 
f
 

 

 

 

 

time

figure    topological temporal model 
the next apparent and natural step is to combine these two kinds of reasoning  of
course  there have been attempts to construct spatio temporal hybrids  for example  the
intended interpretation of clarkes              region based calculus was spatio temporal 
region connection calculus rcc  randell et al         contained a function space x  t 
for representing the space occupied by object x at moment of time t  muller      a 
developed a first order theory for reasoning about motion of spatial entities  however  all
of these formalisms turn out to be too expressive from the computational point of view 
they are undecidable  moreover  as far as we know  no serious attempts to investigate and
implement partial  say  incomplete  algorithms capable of spatio temporal reasoning with
these logics have been made 
the problem of constructing spatio temporal logics with better algorithmic properties and analysing their computational complexity was first attacked by wolter and zakharyaschev      b   see also the popular and extended version  wolter   zakharyaschev 
      of that conference paper  as well as  bennett   cohn        bennett  cohn  wolter 
  zakharyschev        gerevini   nebel        
the main idea underlying all these papers is to consider various combinations of wellbehaved spatial and temporal logics  the intended spatio temporal structures can be
regarded then as the cartesian products of the intended time line and topological  or some
other  spaces that are used to model the spatial dimension  figure   shows such a product
 of the flow of time f   hn   i and the two dimensional euclidean space t  with a moving
spatial object x  the moving object can be viewed either as a  d spatio temporal entity
 in this particular case  or as the collection of the snapshots or slices of this entity at each
moment of time  for a discussion see  e g    muller      b  and references therein  in this
paper  we use the snapshot terminology and understand by a moving spatial object  or 
more precisely  interpret such an object as  any set of pairs hx  ti where  for each point t
   

ficombining spatial and temporal logics  expressiveness vs  complexity

of the flow of time  x is a subset of the topological spacethe state of the spatial object at
moment t 
the expressive power  and consequently the computational complexity  of the combined
spatio temporal formalisms obviously depends on three parameters 
   the expressivity of the spatial component 
   the expressivity of the temporal component  and
   the interaction between the two components allowed in the combined logic 
regardless of the chosen component languages  the minimal requirement for a spatiotemporal combination to be useful is its ability to
express changes in time of the truth values of purely spatial propositions 

 pc 

typical examples of logics meeting this spatial propositions truth change principle are the
combinations of rcc   and allens interval calculus  bennett et al         gerevini   nebel 
      and those combinations of rcc   and pt l introduced by wolter and zakharyaschev
     b  that allow applications of temporal operators to boolean combinations of rcc   relations  languages satisfying  pc  can capture  for instance  some aspects of the continuity
of change principle  see  e g   cohn        such as
 a  if two images on the computer screen are disconnected now  then they either remain
disconnected or become externally connected in one quantum of the computers time 
another example is the following statement about the geography of europe 
 b  kaliningrad is disconnected from the eu until the moment when poland becomes
a tangential proper part of the eu  after which kaliningrad and the eu will be
externally connected forever 
however  languages meeting  pc  do not necessarily satisfy our second fundamental
spatial object change principle according to which we should be able to
express changes or evolutions of spatial objects in time 

 oc 

in logical terms   pc  refers to the change of truth values of propositions  while  oc  to
the change of extensions of predicates  see fig    where x at moment t denotes the state
of x at moment t      here are some examples motivating  oc  
 c  continuity of change  the cyclones current position overlaps its position in an hour 
 d  two physical objects cannot occupy the same space  if tomorrow object x is at the
place where object y is today  then y will have to move by tomorrow 
 e  geographic regions change  the space occupied by europe never changes 
 f  geographic regions change  in two years the eu will be extended with romania and
bulgaria 
 g  fairness conditions on regions  it will be raining over every part of england ever and
ever again 
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

space

 

x

x
x

x

x
t

t

t
 f

 
t

t  

t  

time

figure    temporal operators on regions 
 h  mutual exclusion  if earth consists of water and land  and the space occupied by
water expands  then the space occupied by land shrinks 
it should be clear that to represent these statements we have to refer to the evolution of
spatial objects in time  say  to compare objects x and x it is not enough to only take
into account the change of the truth values of propositions speaking about spatial objects 
the main aim of this paper is to investigate the trade off between the expressive power
and the computational behaviour of spatio temporal hybrids satisfying the  pc  and  oc 
principles and interpreted in various spatio temporal structures  our purpose is to show
what computational obstacles one can expect if the application domain requires this or that
kind of interactions between temporal and spatial operators 
the spatio temporal logics we consider below are combinations of fragments of pt l
interpreted over different flows of time with fragments of the propositional spatial logic s u
 equipped with the interior and closure operators  the universal and existential quantifiers
over points in space as well as the booleans  interpreted in topological spaces  this choice
is motivated by the following reasons 
 the component logics are well understood and established in temporal and spatial
knowledge representation  all of them are supported by reasonably effective reasoning
procedures 
 by definition  implicit or explicit temporal quantification is necessary to capture  oc  
and fragments of pt l are the weakest languages with such quantification we know of 
   

ficombining spatial and temporal logics  expressiveness vs  complexity

allens interval calculus  for example  does not provide means for any quantification
over intervals  it is certainly suitable for spatio temporal hybrids satisfying  pc   see
bennett et al         gerevini   nebel        but there is no natural conservative
way of combining it with spatial formalisms to meet  oc   on the other hand  it is
embedded in pt l  blackburn         a natural alternative to pt l would be the
extension of allens calculus by means of quantification over intervals introduced by
halpern and shoham         but unfortunately this temporal logic turns out to be
highly undecidable 
 although the logic s u was originally introduced in the realm of modal logic  see
below for details   the work of bennett         nutt         renz        and wolter
and zakharyaschev      a  showed that it can be regarded as a unifying language
that contains many spatial formalisms like rcc    brcc   or the   intersections of
egenhofer and herring        as fragments 
apart from the choice of component languages and the level of their interaction  the expressive power and the computational complexity of spatio temporal logics strongly depend
on the restrictions we may want to impose on the intended spatio temporal structures and
the interpretations of spatial objects 
 we can choose among different flows of time  say  discrete or dense  infinite or finite 
 and among different topological spaces  say  arbitrary  euclidean or aleksandrov  
 at each time point we can interpret spatial objects as arbitrary subsets of the topological space  as regular closed  or open  ones  as polygons  etc 
 to represent the assumption that everything eventually comes to an end  we only
do not know when  one can restrict the class of intended models by imposing the
finite change assumption which states that no spatial object can change its spatial
configuration infinitely often  or the more liberal finite state assumption according
to which every spatial object can have only finitely many possible states  although it
may change its states infinitely often  
the paper is organised as follows  in section   we introduce in full detail the component
spatial and temporal logics to be combined later on  in particular  besides the standard
spatial logics like rcc   or the   intersections of egenhofer and herring         we consider
their generalisations in the framework of s u and investigate the computational complexity  for example  we show that the maximal fragment of s u dealing with regular closed
spatial objects turns out to be pspace complete  while a natural generalisation of the
  intersections is still in np  in section   we introduce a hierarchy of spatio temporal logics
outlined above  provide them with a topological temporal semantics  and analyse their computational properties  first we show that spatio temporal logics satisfying only the  pc 
principle are not more complex than their components  then we consider maximal combinations of s u with  fragments of  pt l meeting both  pc  and  oc  and see that this
straightforward approach does not work  the resulting logics turn out to be undecidable 
finally  we systematically investigate the trade off between expressivity and complexity of
spatio temporal formalisms and construct a hierarchy of decidable logics satisfying  pc 
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

and  oc  whose complexity ranges from pspace to  expspace  these and other results  possible implementations as well as open problems are discussed in section    for the
readers convenience most important  un decidability and complexity results obtained in
this paper are summarised in table   on page      all technical definitions and detailed
proofs can be found in the appendices 

   propositional logics of space and time
we begin by introducing and discussing the spatial and the temporal formalisms we are
going to combine later on in this paper 
    logics of space
we will be dealing with a number of logics suitable for qualitative spatial representation
and reasoning  the well known rcc    brcc   and s u   as well as certain fragments of the
last one  the intended interpretations for all of these logics are topological spaces 
a topological space is a pair t   hu  ii in which u is a nonempty set  the universe of
the space  and i is the interior operator on u satisfying the standard kuratowski axioms 
for all x  y  u  
i x  y     ix  iy 

ix  iix 

ix  x

and iu   u 

the operator dual to i is called the closure operator and denoted by c  for every x  u  
we have cx   u  i u  x   thus  ix is the interior of a set x  while cx is its closure 
x is called open if x   ix and closed if x   cx  the complement of an open set is
closed and vice versa  the boundary of a set x  u is defined as cx  ix  note that x
and u  x have the same boundary 
      s u
our most expressive spatial formalism is s u i e   the propositional modal logic s  extended with the universal modalities  the pedigree of this logic is quite unusual  s  was
introduced independently by orlov         lewis  in lewis   langford         and godel
       without any intention to reason about space  orlov and godel understood it as
a logic of provability  in order to provide a classical interpretation for the intuitionistic
logic of brouwer and heyting  and lewis as a logic of necessity and possibility  that is  as
a modal logic  besides the boolean connectives and propositional variables  the language of
s  contains two modal operators  i  it is necessary or provable  and c  the dual of i  it is
possible or consistent   in other words  the formulas of s  can be defined as follows 


   

p

  

    u  

  i 

   

where the p are variables  set c   i   we denote the modal operators by i and c
 rather than the conventional   and    because we understand  following an observation
made by several logicians in the late thirties and early forties  stone        tarski       
tsao chen        mckinsey         s  as a logic of topological spaces  if we interpret the
propositional variables as subsets of a topological space  the booleans as the standard settheoretic operations  and i and c as  respectively  the interior and the closure operators
   

ficombining spatial and temporal logics  expressiveness vs  complexity

on the space  then an s  formula is modally consistent if and only if it is satisfiable in a
topological spacei e   its value is not empty under some interpretation  
more precisely  a topological model is a pair of the form m   ht  ui  where t   hu  ii
is a topological space and u  a valuation  is a map associating with every variable p a set
u p   u   then the valuation u is inductively extended to arbitrary s  formulas by taking 
u      u  u    

u   u       u      u     

u i     iu    

expressions  of the form     are interpreted as subsets of topological spaces  that is why we
will call them spatial terms  in particular  propositional variables of s  will be understood
as spatial variables 

the language of s u extends s  with the universal and the existential quantifiers  

and    respectively  known in modal logic as the universal modalities   given a spatial
  to say that the part of space  represented by   is not empty  there is
term    we write  
  means that  occupies the whole space  all points belong to    
at least one point in      
by taking boolean combinations of such expressions we arrive at what will be called spatial
formulas  a bnf definition looks as follows  



     

 



        

    spatial formulas can be either true or false in
     
where the  are spatial terms  set  
topological models  the truth relation m    a spatial formula  is true in a topological
model mis defined in the standard way 

 m     

iff

u      u  

 m    

iff

m      

 m        

iff

m      and m       

say that a spatial formula  is satisfiable if there is a topological model m such that m     
the seemingly simple query language s u can express rather complex relations between
sets in topological spaces  for example  the formula
  q   p    
  p   cq    
 p   
 iq
 

says that a set q is dense in a nonempty set p  but has no interior  here       is an
abbreviation for   u     
the following folklore complexity result has been proved in different settings  see  e g  
nutt        areces  blackburn    marx        
theorem       i  s u enjoys the exponential finite model property  i e   every satisfiable
spatial formula  is satisfiable in a topological space whose size is at most exponential in
the size of  
 ii  satisfiability of spatial formulas in topological models is pspace complete 
   moreover  according to mckinsey        and mckinsey and tarski         any n dimensional euclidean
space  for n     is enough to satisfy all consistent s  formulas 
   formally  the language of s u as defined above is weaker than the standard one  say  that of goranko
and passy         however  one can easily show that they have precisely the same expressive power 
see  e g    hughes   cresswell        or  aiello   van benthem      b  

   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

one way of proving this theorem is first to observe that every satisfiable spatial formula
is satisfied in an aleksandrov model  i e   a model based on an aleksandrov topological
spacealias a standard kripke frame for s   see  e g   mckinsey   tarski        goranko
  passy        
we remind the reader that a topological space is called an aleksandrov space  alexandroff        if arbitrary  not only finite  intersections of open sets are open  a kripke frame
 or simply a frame  for s  is a pair the form g   hv  ri  where v is a nonempty set and
r a transitive and reflexive relation  i e   a quasi order   on v   every such frame g induces
the interior operator ig on v   for every x  v  
ig x    x  x   y  v  xry  y  x   
in other words  the open sets of the topological space tg   hv  ig i are the upward closed
 or r closed   subsets of v   the minimal neighbourhood of a point x in tg  that is the
minimal open set to contain x  consists of all those points that are r accessible from x  it
is well known  see  e g   bourbaki        that tg is an aleksandrov space and  conversely 
every aleksandrov space is induced by a quasi order 
now  to complete the proof  it suffices to recall that s  is pspace hard  ladner 
      and use  say  the standard tableau technique to establish the exponential finite model
property and construct a pspace satisfiability checking algorithm for spatial formulas 
although being of the same computational complexity as s   the logic s u is more
expressive  a standard example is that spatial formulas can distinguish between arbitrary
and connected  topological spaces  consider  for instance  the formula
  cp   p    
  p   ip    
p
 p   
 

   

saying that p is both closed and open  nonempty and does not coincide with the whole space 
it can be satisfied only in a model whose underlying topological space is not connected  while
all satisfiable s  formulas are satisfied in connected  e g   euclidean  spaces 
another example illustrating the expressive power of s u is the formula
  p   cp    
  p   cp 
p   
 

   

defining a nonempty set p such that both p and p have empty interiors  in fact  the second
and the third conjuncts say that p and p consist of boundary points only 
      rcc   as a fragment of s u
in qualitative spatial representation and reasoning  it is quite often assumed that spatial
terms can only be interpreted by regular closed  or open  sets of topological spaces  see 
e g   davis        asher   vieu        gotts         one of the reasons for imposing this
restriction is to exclude from consideration such pathological sets as p in      recall that a
set x is regular closed if x   cix  which clearly does not hold for any set p satisfying     
another reason is to ensure that the space occupied by a physical body is homogeneous
in the sense that it does not contain parts of different dimensionality  for example  the
   we remind the reader that a topological space is connected if its universe cannot be represented as the
union of two disjoint nonempty open sets 

   

ficombining spatial and temporal logics  expressiveness vs  complexity

 
x

ix

cix

 
figure    regular closure 
subset x of the euclidean plane in fig    consists of three parts  a  d ellipse with a hole  a
 d circle  and a  d curve connecting them  this curve disappears if we form the set cix 
which is regular closed because cicix   cix  for every x and every topological space 
in this paper  we will consider several fragments of s u dealing with regular closed sets 
from now on we will call such sets regions  perhaps  the best known language devised
for speaking about regions is rcc   which was introduced in the area of geographical
information systems  see egenhofer   franzosa        smith   park        and as a
decidable subset of region connection calculus rcc  randell et al          the syntax of
rcc   contains eight binary predicates 
 dc x  y    regions x and y are disconnected 
 ec x  y    x and y are externally connected 
 eq x  y    x and y are equal 
 po x  y    x and y partially overlap 
 tpp x  y    x is a tangential proper part of y  
 ntpp x  y    x is a nontangential proper part of y  
 the inverses of the last twotppi x  y   and ntppi x  y   
which can be combined using the boolean connectives  for example  given a spatial database
describing the geography of europe  we can query whether the united kingdom and the
republic of ireland share a common border  the answer can be found by checking whether
the rcc   formula ec uk  roi  follows from the database 
the arguments of the rcc   predicates are called region variables  they are interpreted
by regular closed setsi e   regionsof topological spaces  the satisfiability problem for
rcc   formulas under such interpretations is np complete  renz   nebel        
the expressive power of rcc   is rather limited  it only operates with simple regions and does not distinguish between connected and disconnected ones  regions with and
without holes  etc   egenhofer   herring         nor can rcc   represent complex relations between more than two regions  consider  for example  three countries  say  russia 
lithuania and poland  such that not only each one of them is adjacent to the others  but
there is a point where all the three meet  to express this fact we may need a ternary
predicate like
ec  russia  lithuania  poland  
   
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

to analyse possible ways of extending the expressive power of rcc    it will be convenient to view it as a fragment of s u  that rcc   can be embedded into s u was first shown
by bennett         observe first that  for every spatial variable p  the spatial term
cip

   

is interpreted as a regular closed set in every topological model  so  with every region
variable x of rcc   we can associate the spatial term  x   cipx   where px is a spatial
variable  and then translate the rcc   predicates into spatial formulas by taking 
   
  i 
ec x  y      
x u  y     
x u i y   
   
dc x  y      
x u  y   
   
   
eq x  y      
x    y     
y    x   
   
   
  i 
po x  y      
x u i y     
x    y     
y    x   
   
   
   
tpp x  y      
x    y     
y    x     
x   i y   
   
   
ntpp x  y      
x   i y     
y    x  

 tppi and ntppi are the mirror images of tpp and ntpp  respectively   the first of these
formulas  for instance  says that two regions are externally connected iff the intersection of
the regions is not empty  whereas the intersection of their interiors is  it should be clear
that an rcc   formula is satisfiable in a topological space if and only if its translation into
s u defined above is satisfiable in a topological model 
this translation also shows that in rcc   any two regions can be related in terms of
truth falsity of atomic spatial formulas of the form
    u     
 
 
 

  i  u i    
 
 
 

   
 
        

and

   
 
    i     

where    and    are spatial terms of the form      for example  the first of these formulas
says that the intersection of two regions is empty  whereas the last one states that one region
is contained in the interior of another one  in other words  rcc   can be regarded as part
of the following fragment of s u  
 

    cip 



       u   




     

 

  i   u i  


         

       i    

         

here we distinguish between two types of spatial terms  those of the form   will be
called atomic region termsthey represent the  regular closed  regions we want to compare 
spatial terms of the form  are used to relate regions to each other  note that their extensions
are not necessarily regular closed  
actually  the fragment introduced above is a bit more expressive than rcc    for example  it contains  appropriately modified  formula     which can be satisfied only in disconnected topological spaces  while all satisfiable rcc   formulas are satisfiable in any
euclidean space  renz         however  it will be convenient for us not to distinguish
between these two spatial logics  first  it will turn out that the same technical results regarding their computational complexity hold for them even when combined with temporal
   

ficombining spatial and temporal logics  expressiveness vs  complexity

logics  and second  the more intuitive and concise language of rcc   is more suitable for
illustrations  for instance  we do not distinguish between the region variable x and the
    u     
region term  x and use dc           as an abbreviation for  
 
 
the definition above suggests two ways of increasing the expressive power of rcc  
 while keeping all regions regular closed  
 i  by allowing more complex region terms    and
 ii  by allowing more ways of relating them  i e   more complex terms    
      brcc   as a fragment of s u
the language brcc   of wolter and zakharyaschev      a   see also balbiani  tinchev   
vakarelov        extends rcc   in direction  i   it uses the same eight binary predicates
as rcc   and allows not only atomic regions but also their intersections  unions and complements  for instance  in brcc   we can express the fact that a region  say  the swiss
alps  is the intersection of two other regions  switzerland and the alps in this case  
eq swissalps  switzerland u alps  

   

we can embed brcc   to s u by using almost the same translation as in the case of rcc   
the only difference is that now  since boolean combinations of regular closed sets are not
necessarily regular closed  we should prefix compound spatial terms with ci  this way we
can obtain  for example  the spatial term
ci  switzerland u alps 
representing the swiss alps  in the same manner we can treat other set theoretic operations 
which leads us to the following definition of boolean region terms 
 

   

cip

  ci 

  ci    u      

in other words  boolean region terms denote precisely the members of the well known
boolean algebra of regular closed sets   the union t is expressible via intersection and
 
complement in the usual way   to simplify notation  given a spatial term    we write 
to denote the result of prefixing ci to every subterm of    in particular 
 
 
 


   
p   cip 
   ci 
and   u     ci    u     
 
note that  is  equivalent to  a boolean region term  for every spatial term    now the
swiss alps from the example above can be represented as switzerland u alps  
it is of interest to note that boolean region terms do not increase the complexity of
reasoning in arbitrary topological models  the satisfiability problem for brcc   formulas is
still np complete  however  it becomes pspace complete if all intended models are based
on connected spaces   on the other hand  brcc   allows some restricted comparisons of
more than two regions as  e g   in      nevertheless  as we shall see below  ternary relations
like     are still unavailable in brcc    they require different ways of comparing regions 
cf   ii  
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

      rc
egenhofer and herring        proposed to relate any two regions in terms of the   intersections   matrix specifying emptiness nonemptiness of all  nine  possible intersections
of the interiors  boundaries and exteriors of the regions  recall that  for a region x  these
three disjoint parts of the space hu  ii can be represented as
ix 

x   u  ix 

and

u  x 

respectively  by generalising this approach to any finite number of regions  we obtain the
following fragment rc of s u  
 

    boolean region terms 



     




     

  i 
 

  



    u    

         

in other words  in rc we can define relations between regions in terms of emptiness nonemptiness of sets formed by using arbitrary set theoretic operations on regions and their
interiors  however  nested applications of the topological operators are not allowed  an
example where such applications are required can be found in the next section  
clearly  both rcc   and brcc   are fragments of rc  moreover  unlike brcc    the
language of rc allows us to consider more complex relations between regions  for instance 
the ternary relation required in     can now be defined as follows 
   
  i 
  i 
  i 
ec  x  y  z     
x u  y u  z     
x u i y     
y u i z     
z u i x   

another  more abstract  example is the formula
   u    u    i 
 
 
i
i   u    u i j u  j   u    u  k u i k   u    u i n



which says that
regions               i meet somewhere inside the region occupied jointly by all
 i              j   but outside the regions  j              k and not inside  k              n  
although rc is more expressive than both rcc   and brcc    reasoning in this language is still of the same computational complexity 
theorem      the satisfiability problem for rc formulas in arbitrary topological models
is np complete 
this result will be proved in appendix a  lemma a   shows that every satisfiable rcformula can be satisfied in a model based on the aleksandrov space that is induced by a
disjoint union of n broomsi e   quasi orders of the form depicted in fig     topological
spaces of this kind have a rather primitive structure satisfying the following property 
 rc  only the roots of n brooms can be boundary points  and the minimal neighbourhood
of every boundary pointi e   the n broom containing this pointmust contain at
least one internal point and at least one external point 
   

ficombining spatial and temporal logics  expressiveness vs  complexity

b

b
b
b
 

hh
y




j
 
h

 
hhj
hj b


depth  
depth  

figure    n broom  for n      
for example  spatial formula     cannot be satisfied in a model with this property  and so
it is not in rc 
by lemma a    the size of such a satisfying model is polynomial  in fact  quadratical 
in the length of the input rc formula  and so we have a nondeterministic polynomial time
algorithm  actually  the proof is a straightforward generalisation of the complexity proof
for brcc   given by wolter and zakharyaschev      a   the only difference is that in the
case of brcc   it is sufficient to consider only   brooms  which were called forks   this
means  in particular  that ternary relation    which is satisfiable only in a model with an
n broom  for n   is indeed not expressible in brcc   
remark      in topological terms  n brooms are examples of so called door spaces where
every subset is either open or closed  however  the modal theory of n brooms defines a
wider and more interesting topological class known as submaximal spaces in which every
dense subset is open  submaximal spaces have been around since the early     s and have
generated interesting and challenging problems in topology  for a survey and a systematic
study of these spaces see  arhangelskii   collins        and references therein 
      rc max
one could go even further in direction  ii  and impose no restrictions whatsoever on the
ways of relating boolean region terms  this leads us to the maximal fragment rc max of
s u in which spatial terms are interpreted by regular closed sets  its syntax is defined as
follows 
 

    boolean region terms 



     




     

  
 

    u  


  i 

        

to understand the difference between rc and rc max   consider the rc max  formula
  
 
 
 
   
 


 
q  u i q    
q  u i q    c i q  u q  u i q 
 

   

 
it says that the boundary of q  is not empty and that
 every neighbourhood of every
point
  in this boundary contains an internal point of q  that belongs to the boundary of
q   compare with property  rc  above   the simplest aleksandrov model satisfying this
formula is of depth    it is shown in fig    
the price we have to pay for this expressivity is that the complexity of rc max is the
same as that of full s u  
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

q  q 

q  q 

q  q 

b
b
 
j



j


j b


b

depth  








q  q 


 
j


j
j 

q  q  b

depth  
depth  

figure    model satisfying formula     
theorem      the satisfiability problem for rc max  formulas is pspace complete 
the upper bound follows from theorem     and the lower bound is proved in appendix a  where we construct a sequence of rc max  formulas such that each of them is
satisfiable in an aleksandrov space of cardinality at least exponential in the length of the
formula  the first formula of the sequence is similar to     above 
it is of interest to note  however  that rc max is still not expressive enough to define such
pathological sets as p in     which is clearly not regular closed 
to conclude this section  we summarise the inclusions between the spatial languages
introduced above 
rcc  

 

brcc  

 

rc

 

rc max

 

s u  

for more discussions of spatial logics of this kind we refer the reader to the paper  pratthartmann        
    temporal logics
as was said in the introduction  the temporal components of our spatio temporal hybrids
are  fragments of  the propositional temporal logic pt l interpreted in various flows of time
which are modelled by strict linear orders f   hw   i  where w is a nonempty set of time
points and   is a  connected  transitive and irreflexive  precedence relation on w  
the language pt l is based on the following alphabet 
 propositional variables p    p           
 the booleans  and   and
 the binary temporal operators u  until  and s  since  
the set of pt l formulas is defined in the standard way 


   

p

 



       

    u   

    s    

pt l models are pairs of the form m   hf  vi such that f   hw   i is a flow of time
and v  a valuation  is a map associating with each variable p a set v p   w of time
points  where p is supposed to be true   the truth relation  m  w       for an arbitrary
pt l formula  and w  w   is defined inductively as follows  where  u  v  denotes the open
interval  w  w   u   w   v  
   

ficombining spatial and temporal logics  expressiveness vs  complexity

  m  w     p

w  v p  

iff

  m  w     

 m  w       

iff

  m  w         

 m  w       and  m  w        

iff

  m  w       u  
all u   w  v  

iff

there is v   w such that  m  v       and  m  u       for

  m  w       s  
all u   v  w  

iff

there is v   w such that  m  v       and  m  u       for

a pt l formula  is satisfied in m if  m  w      for some w  w  
we took the operators u and s as primitive simply because all other important temporal
operators can be defined via them  for example   f  sometime in the future  and  f
 always in the future  are expressible via u as
 f      u  

 f     f  

   is the logical constant true  which means that
  m  w      f 

iff

there is v   w such that  m  v      

  m  w      f 

iff

 m  v      for all v   w 

as our intended flows of time are strict linear orders  the next time operator
definable via u by taking
    u 



is also

  is the logical constant false  which perfectly reflects our intuition  if f is discrete then
  m  w     

iff

 m  w          

where w     is the immediate successor of w in f  the reader should not have problems in
defining the past versions of  f    f and  
the following results are due to sistla and clarke        and reynolds              
theorem      the satisfiability problem for pt l formulas is pspace complete for each
of the following classes of flows of time  all strict linear orders  all finite strict linear orders 
hn   i  hz   i  hq   i  hr   i 
note  however  that reasoning becomes somewhat simpler if we take  f    f and their
past counterparts  but no   u and s  as the only temporal primitives  denote by pt l 
the corresponding fragment of pt l  then  according to the results of ono and nakamura
        sistla and clarke         and wolter         we have 
theorem      the satisfiability problem for pt l   formulas is np complete for each of
the classes of flows of time mentioned in theorem     
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

   combinations of spatial and temporal logics
in this section we introduce and discuss various ways of combining logics of space and time 
first we construct spatio temporal logics satisfying only the  pc  principle  see the introduction  and show that they inherit good computational properties of their components 
being encouraged by these results  we then consider maximal combinations of s u with
 fragments of  pt l meeting both  pc  and  oc  and see that such a straightforward approach does not work  we end up with undecidable logics  this leads us to a systematic
investigation of the trade off between expressivity and computational complexity of spatiotemporal formalisms  the result is a hierarchy of decidable logics satisfying  pc  and  oc 
whose complexity ranges from pspace to  expspace 
    spatio temporal logics with  pc 
we begin our investigation of combinations of the spatial and temporal logics introduced
above by considering the language pt l s u   in which the temporal operators can be applied
to spatial formulas but not to spatial terms  this way of temporalising a logic was first
introduced by finger and gabbay         a precise syntactic definition of pt l s u   terms
 and pt l s u   formulas  is as follows 


    p




     

  
 

    u  


  i 

      

     u  

    s     

note that the definition of pt l s u   terms coincides with the definition of spatial terms
in s u which reflects the fact that pt l s u   cannot capture the change of spatial objects
in time  we have imposed no restrictions upon the temporal operators in formulasso the
combined language still has the full expressive power of pt l   clearly  s u is a fragment
of pt l s u    
in a similar way we can introduce spatio temporal logics based on all other spatial
languages we are dealing with  rcc    brcc    rc and rc max   for example  the temporalisation pt l brcc    of brcc    denoted by st   in the hierarchy of wolter and
zakharyaschev       allows applications of the temporal operators to rcc   predicates but
not to boolean region terms  these languages can be regarded as fragments of pt l s u  
in precisely the same way as their spatial components were treated as fragments of s u  
we illustrate the expressive power of pt l rcc    by formalising sentences  a  and  b 
from the introduction 
dc image    image     dc image    image     ec image    image    

dc kaliningrad  eu  u tpp poland  eu  
 f

 a 
 b 


tpp poland  eu   ec kaliningrad  eu   

sentences  c  h  cannot be expressed in this language  or even in pt l s u     they require
comparisons of states of spatial objects at different time instants 
the intended semantics of pt l s u    and all other spatio temporal logics considered
in this paper  is rather straightforward  a topological temporal model  a tt model  for short 
is a triple of the form m   hf  t  ui  where f   hw   i is a flow of time  t   hu  ii a
   

ficombining spatial and temporal logics  expressiveness vs  complexity

topological space  and u  a valuation  is a map associating with every spatial variable p
and every time point w  w a set u p  w   u the space occupied by p at moment
w  see fig     the valuation u is inductively extended to arbitrary pt l s u   terms  i e  
spatial terms  in precisely the same way as for s u   we only have to add a time point as a
parameter 
u    w    u  u   w  

u   u     w    u     w   u     w  

u i  w    iu   w  

the truth values of pt l s u   formulas are defined in the same way as for pt l 

  m  w      

  m  w     

iff
iff

u   w    u  
 m  w       

  m  w         

iff

 m  w      

  m  w       u  
all u   w  v  

iff

there is v   w such that  m  v       and  m  u       for

  m  w       s  
all u   v  w  

iff

there is v   w such that  m  v       and  m  u       for

and

 m  w        

and as in the pure temporal case  the operators  f    f    as well as their past counterparts
can be defined in terms of u and s 
a pt l s u   formula  is said to be satisfiable if there exists a tt model m such that
 m  w      for some time point w 
the following optimal complexity result will be obtained in appendix b   
theorem      the satisfiability problem for pt l s u   formulas in tt models based on
arbitrary flows of time   arbitrary  finite flows of time  hn   i  hz   i  hq   i  or hr   i  is
pspace complete 
the proof of this theorem is based on the fact that the interaction between spatial and
temporal components of pt l s u   is very restricted  in fact  for every pt l s u   formula 
one can construct a pt l formula  by replacing every occurrence of a  spatial  subformula
  in  with a fresh propositional variable p   then  given a pt l model n   hf  vi for
 

 and a moment of time w  we take the set
     n  w     p      
     n  w     p  
w     



of spatial formulas  it is not hard to see that if w is satisfiable for every w in f  then there
is a tt model satisfying  and based on the flow f  now  to check whether  is satisfiable 
it suffices to use a suitable nondeterministic algorithm  see  e g   sistla   clarke       
reynolds              which guesses a pt l model for  and then  for each time point w 
to check satisfiability of w   this can be done using polynomial space in the length of  
theorem      together with theorem      shows that all spatio temporal logics of the
form pt l l   for l   rcc    brcc    rc  rc max    are also pspace complete over the
standard flows of time 
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

now let us consider temporalisations of spatial logics with the  np complete  fragment pt l  of pt l  by theorems     and      both pt l   s u   and pt l   rc max   are
pspace complete  however  for simpler  np complete  spatial components we obtain a
better result 
theorem      the satisfiability problem for pt l   rc  formulas in tt models based on
each of the classes of flows of time mentioned in theorem     is np complete 
the proof is essentially the same as that of theorem      but now nondeterministic
polynomial time algorithms for the component logics are available  it follows from theorem     that pt l   rcc    and pt l   brcc    are np complete as well 
    maximal combinations with  pc  and  oc 
as we saw in the previous section  the computational complexity of spatio temporal logics
without  oc  is the maximum of the complexity of their components  which reflects the
very limited interaction between spatial and temporal operators in languages without any
means of expressing  oc  
a maximalist approach to constructing spatio temporal logics capable of capturing
both  pc  and  oc  is to allow unrestricted applications of the booleans  the topological
and the temporal operators to form spatio temporal terms 
denote by pt l  s u the spatio temporal language given by the following definition 


    p




     

  
 

     u  


  i

      

    u  

    u   

    s    
    s    

expressions of the form  will be called spatio temporal terms  unlike the previous section 
these terms can be time dependent  the definition of expressions of the form  is the
same as for pt l s u    they will be called pt l  s u  formulas  all of the languages from
section      including pt l s u    are clearly fragments of pt l  s u  
as before  we can introduce the temporal operators  f    f    as well as their past
counterparts applicable to formulas  moreover  these operators can now be used to form
spatio temporal terms  for example 
 f      u  

 f     f 

and



   u  

where  denotes the empty set and   the whole space 
spatio temporal formulas are supposed to represent propositions speaking about moving
spatial objects represented by spatio temporal terms  the truth values of propositions in
spatio temporal structures can vary in time  but do not depend on points of spacesthey
are defined in precisely the same way as in the case of pt l s u    but how to understand
temporalised terms 
the meaning of  should be clear  at moment w  it denotes the space occupied by 
at the next moment w      see fig      for example  we can write




 i cyclone
 
u i cyclone
   

 c 

ficombining spatial and temporal logics  expressiveness vs  complexity

to say that regions cyclone and
the introduction   the formula

cyclone

overlap  thereby formalising sentence  c  from

eq eu  eu t romania t bulgaria 

 f 

says that in two years the eu  as it is today  will be extended with romania and bulgaria 
note that eq eu  eu t romania t bulgaria  has a different meaning because the eu
may expand or shrink in a year  it is also not hard to formalise sentences  d    e  and  h 
from the introduction 
eq x  y    eq y  y   

 d 

 f eq europe  europe  

 e 

eq earth  w t l   ec w  l   p w  w    p l  l  

 h 

where p x  y  x is a part of y denotes the disjunction of eq x  y    tpp x  y   and
ntpp x  y   
the intended interpretation of terms of the form  f     f   and their past counterparts 
is a bit more sophisticated  it reflects the standard temporal meanings of propositions
 f x    and  f x     for all points x in the topological space 
 at moment w  term  f  is interpreted as the union of all spatial extensions of  at
moments v   w 
 at moment w  term  f  is interpreted as the intersection of all spatial extensions of
 at moments v   w 
for example  consider fig    with moving spatial object x depicted on it at three consecutive
moments of time  it does not change after t       then  f x at t is the union of x and
x at t and  f x at t is the intersection of x and x at t  i e   x  
as another example  take the spatial object rain  then
  f rain at moment w occupies the space where it will be raining at some time points
v   w  which may be different for different places    f rain at w occupies the space
where it will always be raining after w 
  f  f rain at w is the space where it will be raining ever and ever again after w 
while  f  f rain comprises all places where it will always be raining starting from
some future moments of time 
this interpretation shows how to formalise sentence  g  from the introduction 
p england   f  f rain  

 g 

now  what can be the meaning of rain u snow  similarly to the readings of  f  and
 f  above  we adopt the following definition 
 at moment w  the spatial extension of   u   consists of those points x of the topological
space for which there is v   w such that x belongs to   at moment v and x is in  
at all u whenever w   u   v 
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

the past counterpart of ui e   the operator since scan be used to say that the part of
russia that has been remaining russian since      is not connected to the part of germany
 konigsberg  that became russian after the second world war  kaliningrad  
dc russia s russian empire  russia s germany  
the models m   hf  t  ui for pt l  s u are precisely the same topological temporal
models we introduced for pt l s u    however  now we need additional clauses defining
extensions of spatio temporal terms 

  
 
 u   u     w   
u     v  
u     u   
v w

 u   s     w   

  

u w v 

u     v  

v w

 


u     u   

u v w 

then we also have 
u  f   w   

 

u   v 

and

u  f   w   

v w

 

u   v  

v w

and  for discrete f 
u   w    u   w      
the truth values of pt l  s u  formulas are computed in precisely the same way as in the
case of pt l s u    a pt l  s u  formula  is called satisfiable if there exists a tt model
m such that  m  w      for some time point w 
at first sight it may appear that the computational properties of the constructed logic should not be too badafter all  its spatial and temporal components are pspacecomplete  it turns out  however  that this is not the case 
theorem      the satisfiability problem for pt l  s u  formulas in tt models based on
the flows of time hn   i or hz   i is undecidable 
without going into details of the proof of this theorem  one might immediately conjecture that it is the use of the infinitary operators u   f and  f in the construction of
spatio temporal terms that makes the logic over expressive  moreover  the whole idea of
topological temporal models based on infinite flows of time may look counterintuitive in
the context of spatio temporal representation and reasoning  unlike  say  models used to
represent the behaviour of reactive computer systems  
there are different approaches to avoid infinity in tt models  the most radical one is to
allow only finite flows of time  a more cautious approach is to impose the following finite
change assumption on models  based on infinite flows of time  
fca no term can change its spatial extension infinitely often 
this means that under fca we consider only those valuations u in tt models hf  t  ui
that satisfy the following condition  for every spatio temporal term    there are pairwise
disjoint intervals i            in of f   hw   i such that w   i       in and the state of 
remains constant on each ij   i e   u   u    u   v  for any u  v  ij   it turns out  however 
   

ficombining spatial and temporal logics  expressiveness vs  complexity

that in the case of discrete flows of time fca does not give us anything new as compared
to arbitrary finite flows of time  more precisely  one can easily show that the satisfiability
problem for pt l  s u  formulas in tt models satisfying fca and based on hn   i or
hz   i is polynomially reducible to satisfiability in tt models based on finite flows of time 
and the other way round  note also that for the flows of time mentioned above  fca can
be captured by the formulas  f  f eq   f     and its past counterpart for hz   i   for
every spatio temporal term   
a more liberal way of reducing infinite unions and intersections to finite ones is to
adopt the finite state assumption 
fsa every term may have only finitely many possible states  although it may
change its states infinitely often  
say that a tt model hf  t  ui satisfies fsa if  for every spatio temporal term    there are
finitely many sets a            am in the space t such that  u   w    w  w      a            am   
such models can be used  for instance  to capture periodic fluctuations due to season or
climate changes  say  a daily tide  similarly to fca finitising the flow of time  fsa
virtually makes the underlying topological space finite  the following proposition will be
proved in appendix b 
proposition      a pt l  s u  formula is satisfiable in a tt model with fsa and based
a flow of time f iff it is satisfiable in a tt model based on f and a finite  aleksandrov  
topological space 
unfortunately  none of these approaches works for pt l  s u we still have 
theorem       i  the satisfiability problem for pt l  s u  formulas in tt models based
on  arbitrary  finite flows of time is undecidable 
 ii  the satisfiability problem for pt l  s u  formulas in tt models based on the flows
of time hn   i or hz   i and satisfying fsa is undecidable 
the next time operator  does not look so harmful as the infinitary u   f    f   and
still can capture some aspects of  oc   see formulas  c    d    f  and  g  above   so let
us consider the fragment pt l  s u of pt l  s u with spatio temporal terms of the form 


   

p

  

    u  

  i

 

 

in other words  pt l  s u does not allow applications of temporal operators different from
 to form spatio temporal terms  but they are still available as formula constructors   this
means that we can compare the states of a spatial object x over a bounded set of time
points only  for any time point t and any natural numbers n  m     we can compare at t
the state of x at t   n with its state at t   m 
this fragment is definitely less expressive than full pt l  s u   for instance  according
to lemma b    pt l  s u  formulas do not distinguish between arbitrary tt models and
those based on aleksandrov topological spaceswe will call them aleksandrov tt models 
on the other hand  the set of pt l  s u  formulas satisfiable in aleksandrov models is
a proper subset of those satisfiable in arbitrary tt models  consider  for example  the
pt l  s u  formula
    ip   i  p  
 
f
f
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

one can readily see that it is true in every aleksandrov tt model  but its negation can be
satisfied in a topological model  for it suffices to take the flow f   hn   i and the topology
t   hr  ii with the t
standard interior operator i on the real line  select a sequence xn of
open sets such that nn xn is not open  e g   xn      n    n   and put u p  n    xn  
however  even this seemingly weak interaction between topological and temporal operators turns out to be dangerous 
theorem      the satisfiability problem for pt l  s u  formulas in tt models based on
the flows of time hn   i or hz   i is undecidable  it is undecidable as well for tt models
satisfying fsa or based on  arbitrary  finite flows of time 
theorem     might suggest considering the fragment pt l   s u with  f and its past
counterpart  p as the only temporal primitives applicable both to formulas and terms 


    p




     

  
 

    u  


  i

       

   f 

   f 

   p  

   p  

yet again the result is negative 
theorem      the satisfiability problem for pt l   s u  formulas in tt models  with or
without fsa  based on the flows of time hn   i or hz   i is undecidable  it is undecidable
as well for tt models based on  arbitrary  finite flows of time 
these undecidability results  the strongest ones  theorems     and      to be more
precise  will be proved in appendix b   by a reduction of posts correspondence problem
which is known to be undecidable  post         as we will see from the proofs  these
theorems actually hold for the future fragments of the corresponding languages 
    decidable spatio temporal logics with  pc  and  oc 
an important lesson we learn from  the proofs of  the negative results of section     is that
full s u is too expressive for computationally well behaved combinations with fragments of
pt l  on the other hand  as was said in section        qualitative spatial representation and
reasoning often requires extensions of spatial variables to be regular closed  i e   regions  
this restriction is very important for constructing decidable spatio temporal logics with
 pc  and  oc   first  the undecidability proofs from appendix b   do not go through
in this case  and second  as will be shown below  decidable combinations of pt l and
some of the fragments of s u introduced in section     do exist  in fact  we will construct
a hierarchy of decidable spatio temporal logics of different computational complexity by
imposing various restrictions on regions themselves  the ways they can be compared  and
the interactions between spatial and temporal constructors 
we begin by considering the simplest combination of pt l and rcc   capturing  pc 
and  oc   this logic called pt lrcc    it was introduced under the name st 
  by wolter
and zakharyaschev        operates with spatio temporal region terms of the form
 

   

cip

  ci  

to relate these terms  we are allowed to use the eight binary predicates of rcc    then arbitrary temporal operators and boolean connectives can be applied to produce pt l  rcc  
   

ficombining spatial and temporal logics  expressiveness vs  complexity

formulas  typical examples of such formulas are  a    b    d  and  e  above  note that
 c  can be regarded as a pt l  rcc   formula as well  two regions overlap iff they are
neither disconnected nor externally connected   on the other hand   f    h  and  g  are
not pt lrcc   formulas because the first two use the t operation on region terms and  g 
uses temporal operators  f and  f on region terms 
as before  pt l  rcc   formulas are interpreted in topological temporal models  or
tt models   however  only discrete flows of time do make sense for this language  although
the interaction between topological and temporal operators is similar to that in pt l  s u
 clearly  pt lrcc   is a fragment of pt ls u    we have the following rather unexpected
and encouraging result 
theorem      the satisfiability problem for pt l  rcc   formulas in tt models based on
hn   i  hz   i or  arbitrary  finite flows of time is pspace complete 
this theorem will be proved in appendix c    the idea of the proof is similar to that of
theorem      we consider the spatial and the temporal parts of a given formula separately 
however  to take into account the interaction between these parts  we use the so called
completion property of rcc    cf  balbiani   condotta        with respect to a certain
class c of models  given a satisfiable set  of rcc   formulas and a model in c satisfying
a subset of   one can extend this partial model to a model in c satisfying the whole  
what happens if we extend the expressive power of the spatial component by allowing
boolean operators on spatio temporal region terms  i e   jump from rcc   to brcc   
define spatio temporal boolean region terms by taking
 

   

cip

  ci 

  ci    u        ci  

denote by pt l  brcc   the language obtained from pt l  rcc   by allowing spatiotemporal boolean region terms as arguments of the rcc   predicates  this language was
called st   by wolter and zakharyaschev         formulas  a  f  and  h  belong to
pt l  brcc    but  g  uses the  f and  f operators on regions and so is not in pt l 
brcc   
now  another surprise is that the replacement of rcc   with brcc   in our temporal
context results in an exponential jump of the computational complexity  remember that
both rcc   and brcc   are np complete  
theorem      the satisfiability problem for pt l  brcc   formulas in tt models based
on the flows of time hn   i or hz   i is expspace complete  it is expspace complete
as well for models satisfying fsa or based on  arbitrary  finite flows of time 
the expspace upper bound  see appendix c    is proved by a polynomial embedding of pt l  brcc   into the one variable fragment qt l  of first order temporal logic 
which is known to be expspace complete  hodkinson  kontchakov  kurucz  wolter   
zakharyaschev         to construct this embedding  we first show that pt l  brcc   is
complete with respect to aleksandrov tt models  in fact  we prove that every satisfiable
formula of the more expressive logic pt l  s u introduced in section     can be satisfied
in an aleksandrov tt model  see lemma b   and the discussion above   lemma c   then
shows that to satisfy a pt l  brcc   formula  it suffices to take an aleksandrov tt model
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

based on a partial order of depth    by lemma c    the width of the partial order can be
bounded by    just as in the case of brcc     and therefore unions of forks  or   brooms 
are enough to satisfy pt l  brcc   formulas  these aleksandrov tt models based on
unions of forks can be encoded by means of unary predicates of qt l   
the expspace lower bound is proved in appendix c   by encoding the corridor
tiling problem  it can also be established by a direct polynomial embedding of qt l  into
pt lbrcc    to illustrate the idea  consider the qt l   formula x  p  x  p  x   saying
that  for every point of the space  either it is in p now or will be there tomorrow  the same
statement can be expressed in pt l  brcc   by the formula eq p t p  e   dc e  e  
where the last conjunct makes e empty 
now let us make one more step in space and extend brcc   to rc  thus obtaining the
spatio temporal language pt l  rc with the following syntax 
 

    cip



     




     

  ci 

  i 
 

  ci    u        ci  

  



    u    

      

     u  

    s     

the reader should not be surprised now  although the authors were  that the extra expressivity results in one more exponential gap 
theorem       the satisfiability problem for pt l  rc formulas in tt models based on
the flows of time hn   i or hz   i is  expspace complete  it is  expspace complete
as well for models satisfying fsa or based on  arbitrary  finite flows of time 
the lower bound is established in appendix c   and the upper bound in appendix c   
perhaps  it is proper time now to have a closer look at the emerging landscape  what
exactly causes these exponential jumps   can we locate more precise borders in the ladder
pspaceexpspace expspace 
by analysing the proof of theorem      see appendix c     we note that not so much
can be added to rcc    in fact  the maximal spatio temporal logic  denoted by pt lrc    
for which this proof goes through is based on spatio temporal terms of the form
  ci  

 

    cip



     



      u    

  i 

   

  i  

on the other hand  even the addition of predicates of the form eq x  y t z  is enough
to make the logic expspace hard  see remark c     thus  pt l  rcc    or rather
its extension pt l  rc     is located pretty close to the border between pspace and
expspace spatio temporal logics 
the following fragment rc  of rc indicates where the border between expspace
and  expspace may lie 
 

    boolean region terms 



     

   



    i 

  



      u    u m

    u    

   

  u

   

ficombining spatial and temporal logics  expressiveness vs  complexity

intuitively  the  and the  are spatial terms interpreted by regular closed and regular open 
sets  respectively  the interior of a region is regular open  the complement of a regular closed
set is regular open  and vice versa   regular closed sets are closed under unions and regular
open ones are closed under intersections   thus   can be regarded as a generalisation of
region terms and  as a generalisation of the interiors of regions  in other words  rc  is
the fragment of rc in which only the following ways of relating regions are available 
 there is a point where some regions meet 
 a region intersects the interior of another one 
 the interior of a region is not empty 
it is readily checked that brcc   is a fragment of rc    moreover  it is a proper fragment
because     belongs to the latter but not to the former  the formula

 



   n orthkorea
 
u southkorea     dmzone
   
 saying that the demilitarised zone between the north korea and the south korea consists
of the border between them along with some adjacent territories  shows that rc  is a
proper subset of rc 
brcc     rc    rc 
although rc  extends brcc    it gives rise to the spatio temporal logic of the same
computational complexity 
theorem       the satisfiability problem for pt l  rc   formulas in tt models based on
the flows of time hn   i or hz   i is expspace complete  it is expspace complete as
well for models satisfying fsa or based on  arbitrary  finite flows of time 
the lower bound follows immediately from theorem     and the proof of the upper
bound is similar to that of theorem      see appendix c     again  due to the restriction
on possible ways of relating regions  we can polynomially bound the width n of n brooms
that are required to satisfy pt lrc   formulas  cf  lemma c     in fact  we need formulas
similar to     in order to increase complexity to  expspace 
the constructed hierarchy of decidable spatio temporal logics still leaves at least one
important question  do there exist decidable spatio temporal logics that allow applications
of the temporal operators u   f    f to region terms and what is their complexity  consider
the languages pt l  l  for l   brcc    rc    rc   which differ from pt l  l only in
the definition of spatio temporal region terms 
 

   

cip

  ci 

  ci    u        ci    u        ci    s      

the following two theorems provide a positive  though partial  answer to this question 
theorem       the satisfiability problem for pt l  brcc   and pt l  rc   formulas
in tt models based on hn   i or hz   i and satisfying fsa  or based on  arbitrary  finite
flows of time is expspace complete 
   remember that a set x is regular open if icx   x 

   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

theorem       the satisfiability problem for pt l  rc formulas in tt models based
on hn   i or hz   i and satisfying fsa  or based on  arbitrary  finite flows of time is
 expspace complete 
the upper bounds mentioned in these two theorems are proved in appendices c   and
c    respectively  the lower bounds follow from the results for pt lbrcc    theorem     
and pt l  rc   theorem       
to appreciate the following theorem  the reader should recall that both pt l  and rc 
are np complete 
theorem       the satisfiability problem for pt l  brcc   and pt l  rc   formulas
in tt models based on hn   i or hz   i and satisfying fsa  or based on  arbitrary  finite
flows of time is expspace complete 
actually it is a consequence of the expspace hardness of qt l  with the sole temporal
operator  f  see hodkinson et al         
unfortunately  very little is known about the complexity of our spatio temporal languages interpreted in tt models based on dense or arbitrary flows of time  in fact  the only
result we know of can be proved using the recent work  hodkinson        hodkinson et al  
      
theorem       the satisfiability problem for pt l  brcc   and pt l  rc   formulas
in tt models satisfying fsa and based on hq   i  hr   i or arbitrary flows of time belongs
to  exptime and is expspace hard 

   conclusion
we have provided an in depth analysis of the computational complexity of various spatiotemporal logics interpreted in cartesian products of flows of time and topological spaces 
some of these results are collected in table    the design of the languages was driven by the
idea to cover the most basic features of spatio temporal hybrids combining standard logics
of time and mereotopology  with the aim being to see how complex reasoning with these
hybrids could be  we did not try to fine tune the languages for real world applications  on
the contrary  we tried to keep them as pure and representative as possible and determine
computational challenges which any multi dimensional approach to reasoning about space
and time would face  with this research objective in mind  we discuss now some conclusions
that can be drawn from table   
the conclusion to be drawn from the undecidability results is easy  do not try to
implement a sound  complete and terminating algorithm which is supposed to decide the
satisfiability problem for pt l  s u   pt l  s u or pt l   s u you will never succeed 
if decision procedures are required  then alternative languages have to be devised 
the interpretation of the complexity results for decidable logics is not so transparent 
it is well known that such results do not provide us with immediate conclusions regarding
the behaviour of implemented systems  for example  sometimes algorithms running in
exponential time in the worst case perform better on practical problems than worst case
optimal algorithms that run in polynomial time  indeed  the complexity results should be
analysed together with their proofsif significant conclusions are required  cf  nebel        
   

filanguage

n a

spatial component l

flow
rcc  

pt l l 

n  z q  r 
finite
or
arbitrary
n  z

pt l   l

rc

rc max

np

pspace

pspace

 thm      

 thm      

np

pspace

 thm      

 thm      

pspace
 thm      

pspace
 thm      


finite
 expspace
or
 pspace
n  z fsa

expspace

 expspace

 thm      

 thm       

 

 


finite
 expspace expspace
  expspace
or
 np
 expspace
 thm       
n  z fsa
arbitrary 

or
  exptime
  exptime
 
q  r
 np
 expspace
with fsa

undecidable
 thm      

undecidable
 thm      



n  z

s u

 thm      

np

n  z

pt l  l

brcc  

n  z q  r 
finite
or
arbitrary

pt l  l

pt l   l 

of time

l

combining spatial and temporal logics  expressiveness vs  complexity

 

 

 

undecidable

 

 thm      


finite
 expspace expspace
or
 pspace
 thm       
n  z fsa

arbitrary 
  exptime
or
  exptime

expspace
q  r
 pspace
 thm       
with fsa

 expspace

 

 thm       

 

undecidable
 thm      

 

 

table    complexity of the satisfiability problem for spatial and spatio temporal logics 

   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

only the proofs show where the sources of the complexity are and whether they could be
relevant for practical problems and the implementation of algorithms 
in this respect our proofs are actually rather informative  the decidability proof for
pt l s u   immediately provides us with a modular algorithm combining any known procedures for the components  the expspace completeness results for pt l  brcc  
 with fsa  and pt l  brcc   show an extremely close link between the spatio temporal
languages and the one variable fragment of first order temporal logic  the algorithmic
problems investigated in the context of first order temporal logic are  therefore  of the same
character as those we deal with in the spatio temporal context  thus  the experience of
working with algorithms for  fragments of  first order temporal logics  hodkinson  wolter 
  zakharyaschev        degtyarev  fisher    konev        kontchakov  lutz  wolter   
zakharyaschev        about which we have a pretty good knowledge by now almost directly
translates to insights into possible algorithms for spatio temporal logics  the pspacecompleteness result for pt l  rcc   is obtained by means of a reduction  modulo rcc  
reasoning  to pt l  so we can conclude from the proof that it will be sufficient to have
good solvers for rcc   and pt l to obtain a reasonable prover for pt l  rcc    the
interaction between the two components turned out to be rather weak 
in conclusion  the complexity proofs clearly show the algorithmic problems to be solved
when dealing with the spatio temporal logics presented in this paper  in particular  devising
algorithms for these logics should be conceived as part of the more general enterprise of
developing algorithms for propositional and the one variable fragment of first order temporal
logic 
here are some comments on and explanations of the most important results in table   
   the undecidability result for pt l  s u   pt l  s u and pt l   s u solves a major
open problem of wolter and zakharyaschev         it shows that  while s u is a
suitable candidate for efficient pure spatial reasoning  bennett        renz   nebel 
      aiello   van benthem      a   its temporal extensions satisfying both  pc 
and  oc  are not suitable for practical spatio temporal representation and reasoning 
   logics like pt l  brcc   may turn out to be undecidable when interpreted in
arbitrary topological temporal models  one of the main origins of their expressive
power is a possibility to form infinite intersections and unions of regions  however  we
can tame the computational behaviour of these logics by imposing natural restrictions
on the classes of admissible models such as fsa 
   the pspace upper bound for pt l  rcc   and the expspace lower bound for
pt l  brcc   solve two other major open problems of wolter and zakharyaschev
        it is of interest to note that the spatial fragments of pt l  rcc   and
pt l  brcc   have the same computational complexity  both are np complete
over arbitrary topological spaces  thus the additional boolean connectives on spatial
regions interacting with the next time operator  can make the logic substantially
more complex 
   the  expspace completeness result for pt l  rc with fsa and pt l  rc is another example when a seemingly tiny increase of expressiveness results in a significant
jump of complexity 
   

ficombining spatial and temporal logics  expressiveness vs  complexity

   pspace completeness of pt l  rcc   is a particularly good news  since it shows
that this combination of pt l and rcc   has the same computational complexity
as pt l itself  for which surprisingly fast systems have been implemented  schwendimann        hustadt   konev         this gives us hope that practical algorithms
for pt lrcc   can be implemented  indeed  the proof shows that it may be possible
to encode the satisfiability problem for pt lrcc   into the satisfiability problem for
pt l and then use pt l provers  we note that this complexity result has been conjectured by demri and dsouza        and that our proof uses some ideas of balbiani
and condotta        
   on the other hand  the expspace lower bounds for pt l  brcc   with fsa and
pt lbrcc   do not necessarily mean that reasoning with these logics is hopeless  in
fact  we show that both of them can be regarded as fragments of the one variable firstorder temporal logic  for which tableau  and resolution based decision procedures have
been developed and implemented  degtyarev et al         kontchakov et al         
of course  there are many directions of further research in spatio temporal knowledge representation and reasoning  here we mention only some of them that are closely related to
the logics we have considered above 
 in this paper  we confined ourselves to considering linear flows of time  it may be
of interest  however  to investigate the computational properties of spatio temporal
logics based on the branching time paradigm  see  e g   clarke   emerson       
emerson   halpern        in order to model uncertainty about the future  recent
results by hodkinson  wolter and zakharyaschev              give hope that such
logics can be decidable 
 we confined ourselves to considering only mereotopological formalisms for the spatial
dimension  it would be also of interest to consider spatial logics of directions  ligozat 
       shape  galton   meathrel         size  zimmermann         position  clementini  di felice    hernandez         or even their hybrids  gerevini   renz        
we note that some results in this direction have been recently obtained by balbiani
and condotta        and demri and dsouza        
 another interesting and important perspective in both spatial and spatio temporal
representation and reasoning is to move from arbitrary topological spaces to those
induced by metric spaces and introduce explicit and or implicit numerical parameters 
first encouraging steps in this direction have been made in the work  kutz  sturm 
suzuki  wolter    zakharyaschev        
we conclude the paper with a number of open problems 
   what is the precise computational complexity of pt l  brcc   with fsa over
dense flows of time and arbitrary strict linear orders 
   are logics of the form pt l  l and pt l   l  for l   rc  brcc    rcc    
decidable without fsa 
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

   are combinations of pt l and pt l  with rc max  satisfying both  pc  and  oc  
decidable 
   is pt l  s u undecidable over dense flows of time and arbitrary strict linear orders 
   is pt l  rcc   with fsa decidable in pspace 

acknowledgments
the work on this paper was partially supported by u k  epsrc grants no  gr r         
gr r          gr s         and gr s          the work of the third author was also
partially supported by hungarian foundation for scientific research grants t      and
       
special thanks are due to the referees of the first version of this paper whose remarks 
criticism and constructive suggestions have led to many days of intensive and exciting
research  new results and  hopefully  a better paper 

appendix a  complexity of spatial logics
in this appendix we prove theorems     and      in these proofs we use the fact that s u
 as well as its fragments  is complete with respect to  finite  aleksandrov topological spaces
 mckinsey   tarski        goranko   passy         recall from p      that an aleksandrov
 topological   model is a pair of the form m   hg  vi  where g   hv  ri is a quasi order
and v is a map from the set of spatial variables into  v   it will be more convenient for us
to unify notation for spatial formulas and spatial terms and write  m  x      instead of
x  v     for  a spatial term and x a point in v   in particular  by the definition of the
interior and closure operators in aleksandrov spaces 
 m  x     i

iff

 m  x     c

iff


y  v xry   m  y       

y  v xry   m  y       

by the length     of a formula  we understand the number of subformulas and subterms occurring in  
proof of theorem      the proof follows from lemmas a   and a   below which show
together that every satisfiable rc formula can be satisfied in an aleksandrov model of size
polynomial  in fact  quadratical  in the length of the input formula  in other words  rc has
the polynomial finite model property   thus  we have a nondeterministic polynomial time
algorithm for the satisfiability problem 
q
in fact  lemma a   shows that rc is complete with respect to a subclass of aleksandrov
spaces  namely  finite disjoint unions of finite brooms  recall from p      that a broom is
a partial order b of the form h r   v    ri  where r is the reflexive closure of  r   v 
 see fig      we call r the root of b and points in v  the leaves of b  they are also referred
to as points of depth   and    respectively  a broom b is said to be a  broom      if
 v       in particular  we call a broom finite if it is an n broom  for some n    
   

ficombining spatial and temporal logics  expressiveness vs  complexity

lemma a    every satisfiable rc formula is satisfied in an aleksandrov model based on
a finite disjoint union of finite brooms 
proof  as is well known  if an rc formula  is satisfiable then it can be satisfied in a finite
aleksandrov model m   hg  vi  g   hv  ri  define a new relation r  on v by taking r 
to be the reflexive closure of r   v   v     where
v     x  v   y  xry   yrx  

and v    v  v   

 without loss of generality we may assume that v      and no y  v  has more than one
proper r predecessor   let g    hv  r  i and m    hg    vi  clearly  g  is a partial order as
required  we prove that  for every rc formula  
m    

iff

m      

   

first we show that  for every boolean region term   and every x  v  
 m    x      

iff

 m  x       

    

by definition   m    x     p iff  m  x     p  for every spatial variable p  it is readily seen that
for every y  v  and every spatial term    we have  m    y      iff  m  y        now  if   is
a boolean region term then     ci for some spatial term    and we clearly have 

 m  x     ci iff y  v xry and z  v  yrz   m  z       

iff y  v  xr  y and  m  y     

iff y  v  xr  y and  m    y     

iff y  v  xr  y and  m    y     i
iff

 m    x     ci 

next  we extend      to spatial terms of the form i  where   is a boolean region term  if
 m  x     i  then  m  y       whenever xry  and so  by r   r  we have  m    x     i  
conversely  suppose  m    x     i   take any y with xry and any z  v  with yrz  we
claim that  m  z        indeed  if x  v  then this follows by ih from xr  z  if x  v 
then zrx  since  m    x        by ih and     ci   we obtain  m  z        now  m  y      
follows by yrz and     ci   thus   m  x     i  
finally  we can easily extend      to arbitrary spatial terms and formulas of rc because
both are constructed from spatial terms of the form   and i   with   a boolean region term 
using operators that do not depend on the structure of the underlying partial order  thus
we have     
q
lemma a    every satisfiable rc formula  is satisfied in an aleksandrov model based
on a disjoint union of at most     many      brooms 
proof  remember that every rc formula  is  equivalent to  a boolean combination of
 
       

      the spatial term
spatial formulas from some set      
 
m    for each  

   in the following proof we consider

  as an abbreviation for  
 as primary and  
 
 

   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

 is also a boolean  or rather set theoretic  combination of some               k   i              i  m  
where the  i and the   i are boolean region terms 
it follows from lemma a   that  is satisfied in an aleksandrov model m   hg  vi 
  
where g   hv  ri is a finite disjoint union of finite brooms  for every  
 with

m        fix a point x  v such that  m  x         we may assume that the x are
    
pairwise distinct and that the roots of all brooms are the points of the form x for  

    
therefore  g is a disjoint union of      many finite brooms b   for  

      and each
let us construct a new model m  as follows  for each broom b    

      we pick
 a leaf y   of b  if any  such that  m  y          
 a leaf y   of b  if any  such that  m  y         
and remove the other leaves of b   denote by b  the resulting broom  clearly  it is a           and m    hg    vi 
broom  let g    hv     r  i be the disjoint union of all b    for  

it is easy to see that g  is as required 
    
now  to show that  is satisfied in m    it suffices to prove that  for all  


m      

iff

  
m     

    

by definition of m    for all leaves y of g  and all spatial terms   
 m    y     

iff

 m  y      

  
next  for every root x of b   every  
 and every       we have  m  x        iff
there is a leaf y such that x ry and  m  y        simply because     ci  for some    it
follows from the construction of m  that  m  x        iff  m    x         for every      
it also follows that  m  x      i  implies  m    x      i   conversely  if  m    x      i   but
 m  x       i  then there is a leaf y such that x ry and  m  y        which is a contradiction 
since intersection and complement do not depend on the structure of the underlying frame 
we have  m    x       iff  m  x         for every root x of b   which proves      
q

proof of theorem      the pspace upper bound follows from theorem      the proof
of pspace hardness is by reduction of the validity problem for quantified boolean formulas
which is known to be pspace complete  stockmeyer         we will slightly modify the
proof of ladner         that shows the pspace hardness of s    in order to take into
account that the variables in rc max  formulas are always prefixed by ci 
we may assume that quantified boolean formulas are of the form
   q  p        qn pn    
where qi       and   is a boolean formula with variables p            pn   as is well known 
all possible truth assignments to p            pn can be arranged as the leaves of a full binary
tree of depth n  the left subtree of the root contains all truth assignments with p  true
and the right subtree those with p  false  then we branch on p    then p    and so on  we
can determine whether  is valid by pruning this full binary tree  whenever qi is   then
we keep both subtrees at the ith level  and whenever qi is  then only one of them  if this
   

ficombining spatial and temporal logics  expressiveness vs  complexity

  
q     p     p    p  

r

i
  

  
q     p     p 

  
q     p     p 

r
 

  
q     p 

r

r
 

i
  

 

 
 
q  p  p
  r   r      
 
 

 
 
  r  r
 

r   r q     p 
yh
h
hh
h

 

r  r

q     p 

q 

 





hh

r rq
h

 

 

figure    an aleksandrov model that may satisfy    for    p  p  p     
way we can end up with a tree such that all its leaves evaluate   to true  then  is valid 
otherwise not 
we will generate the leaves of this binary tree in aleksandrov models with the help of
an rc max  formula  more precisely  we will construct an rc max  formula  such that
 its length is polynomial in the length of   and
  is satisfied in an aleksandrov model iff  is valid 
take fresh spatial variables q            qn   and put  for i              n 
   
q  u q 
if i     



   

i  
qi  u qi u qi    
if     i   n 







qn  u qn  
if i   n 
now consider the variables p          pn of 
variables  and let    be the result of
 as spatial
replacing every occurrence of pi with pi in     put
 
 




 

 
  
 
 
 

    
 
 
  
i     i t i   
i     i u i     
n    
qi  

qi  

where  for i              n 
 
i   c i u pi

and

 
i    c i u i pi  

clearly   is an rc max  formula and its length is polynomial in the length of  
suppose first that  is valid  then fig    shows the structure of a possible aleksandrov
model satisfying   
the converse direction is similar to that of ladners proof         suppose that  is
satisfied
in an aleksandrov model m  then  for each necessary sequence of truth values for
 
p            pn   there is a point in m reflecting this sequence  we do not use the structure
of the spatial terms i here   since  by the last conjunct of       holds in m at all these
points  we obtain that the quantified boolean formula  must be valid 
q
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

appendix b  spatio temporal logics based on s u
in this appendix we prove theorems               and     as well as proposition      then
theorems     and     are immediate corollaries of theorem      but first  some general
results are established to be used later on 
we remind the reader that by an aleksandrov tt model we mean a tt model based on an
aleksandrov  topological  space  every such model can be regarded as a triple of the form
k   hf  g  vi  where f   hw   i is a flow of time  g   hv  ri a quasi order  and v is a map
associating with every spatial variable p and every time point w  w a set v p  w   v  
as in appendix a  instead of x  v   w  we write  k  hw  xi      to unify notation for
spatio temporal formulas and terms 
given a spatio temporal formula   we denote by sub  the set of all its subformulas
and by term  the set of all spatio temporal terms occurring in  
lemma b     i  if a pt l  s u  formula  is satisfied in a tt model with fsa and based
on a flow of time f  then  is satisfied in an aleksandrov tt model with fsa and based
on f 
 ii  if a pt l  s u  formula  is satisfied in a tt model based on a flow of time f  then
 is satisfied in an aleksandrov tt model based on f as well 
moreover  in both cases we can choose an aleksandrov tt model k   hf  g  vi satisfying
  with f   hw   i and g   hv  ri  in such a way that for all w  w   x  v and
spatio temporal terms    the set
aw x     y  v   xry and  k  hw  yi       
contains an r maximal point    provided of course that aw x       
proof  the proof uses the stonejonssontarski representation of topological boolean
algebras  in particular  topological spaces  in the form of general frames  see  e g   goldblatt 
     or chagrov   zakharyaschev        
 i  suppose that  is satisfied in a tt model m   hf  t  ui with fsa and based on a
topological space t   hu  ii  denote by v the set of all ultrafilters over u   for any two
ultrafilters x    x   v   put x  rx  iff a  u  ia  x   a  x     it is easy to see that r
is a quasi order on v   define an aleksandrov tt model k   hf  g  vi by taking g   hv  ri
and v p  w     x  v   u p  w   x   we show by induction on the construction of a
spatio temporal term  that  for all w  w and x  v  
 k  hw  xi     

iff

u   w   x 

    

the basis of induction and the case of the booleans are trivial  the case of    i   is
standard  consult goldblatt       or chagrov   zakharyaschev        
case      u     assume that  k  hw  xi       u     then there is v   w such that
 k  hv  xi       and  k  hu  xi       for all u in the interval  w  v   by ih  u     v   x and
u     u   x for all u   w  v   since
 
u   u     w   u     v  
u     u  
u w v 

   a point z is said to be r maximal in a  v if  for every z    a  we have z   rz whenever zrz    

   

ficombining spatial and temporal logics  expressiveness vs  complexity

we shall have u   u     w   x if we show that
 
u     u   x 
u     v  

    

u w v 

in view of fsa  we can find time points u            ul   w  v  such that
 
u     u  
u     u         u     ul    
u w v 

which yields      because ultrafilters are closed under finite intersections 
conversely  let u   u     w   x  by fsa  there are time points v          vl such that

  
 
u     u   
u   u     w   
u     vi   
 il

u w vi  

and since x is an ultrafilter 
u     vi   

 

u     u   x 

u w vi  

for some i     i  l  therefore  by ih   k  hvi   xi       and  k  hu  xi       for all
u   w  vi    hence  k  hw  xi       u    
case      s   is considered analogously 
now  we show that  for all w  w and spatio temporal terms   

 k  w      

iff

u   w    u 

    then  k  hw  yi      for all y  v   and so  by ih  u   w   y
suppose that  k  w      
for all y  v   but then u   w    u   conversely  if u   w    u then u   w   y for all
  
y  v   from which  by ih   k  w      
it follows immediately that  is satisfied in k  it should be also clear that k satisfies
fsa  this proves  i   the existence of r maximal points in sets of the form aw x   where
w  w   x  v and  is a spatio temporal term  follows from a result of fine         see
also  chagrov   zakharyaschev        theorem        

 ii  the construction is the same as in  i   first we show by induction that  for every
spatio temporal term  of pt l  s u    k  hw  xi      iff u   w   x  this time  however 
instead of u and s we need the inductive step for  
case         we have  k  hw  xi        iff there exists an immediate successor w  of
w such that  k  hw    xi        iff  by ih  there is an immediate successor w  of w such that
u      w     x  it remains to recall that u      w    u      w    whenever w  is the immediate
successor of w and u      w     whenever w has no immediate successor 
the remaining part of the proof is the same as in  i  
q
proof of proposition      the implication    follows immediately from the definition 
   suppose that a pt ls u  formula  is satisfied in a tt model with fsa and a flow
of time f   hw   i  then  by lemma b    i    is satisfiable in an aleksandrov tt model
m   hf  g  vi with fsa and based on a quasi order g   hv  ri  in view of fsa  for
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

every   term   there are finitely many sets a            ak  v such that  v   w    w 
w      a            ak    therefore  there are finitely many time points w            wm  w such
that  for every w  w   there is wi      i  m  with v   w    v   wi   for all   term  
now we use the lemmon filtration  see  e g   chagrov   zakharyaschev        to construct
a tt model based on a finite aleksandrov topological space  first  define an equivalence
relation  on v by taking x  y if
 m  hwi   xi     

iff

 m  hwi   yi      

for all i     i  m  and   term  

denote by  x  the equivalence class of x  v   the set v   of pairwise distinct equivalence
classes is clearly finite  define a binary relation s on v   by taking  x s y  if
 m  hwi   yi     i

whenever  m  hwi   xi     i 

for all i     i  m  and   term  

clearly  s is well defined  reflexive and transitive  and so g    hv     si is a finite quasiorder  let v   p  w      x    x  v p  w    for every spatial variable p and every w  w  
consider the tt model m    hf  g    v  i  first we show that for all   term   x  v
and w  w  
 m  hw  xi     
iff
 m    hw   x i      
the basis of induction follows from the definition of v    the cases of intersection and complement are trivial  and those of temporal operators follow by ih 
suppose that  m  hw  xi     i and  x s y   then there is a moment wi such that
 m  hw  zi      iff  m  hwi   zi        for all   term  and z  v   by the definition of s 
we have  m  hwi   yi        and so  m  hw  yi        finally  by ih   m    hw   y i        and
since y was arbitrary  we obtain  m    hw   x i     i  
conversely  let  m    hw   x i     i and xry  then  x s y   and so  m    hw   y i       
from which  by ih   m  hw  yi        thus   m  hw  xi     i  
finally  by a straightforward induction on the structure of   one can show that
 m  w     

iff

 m    w      

for all   sub  and w  w   it follows that  is satisfied in m   

q

b   temporalisations of s u
lemma b    let  be a finite set of s u  formulas  then there is a finite quasi order g
such that every satisfiable subset    is satisfied in some aleksandrov model based on g 
proof  for every satisfiable     fix a model based on a finite quasi order g   hv   r i
and satisfying   let n   max  v          is satisfiable  and let g be the disjoint
union of n full n ary  transitive  trees of depth n whose nodes are clusters of cardinality
n  it is not difficult to see that every g is a p morphic image of g  therefore  every
satisfiable    is satisfied in an aleksandrov model based on g 
q
proof of theorem      pspace hardness follows from theorem     or      we show
the matching upper bound 
let  be a pt l s u   formula  since  is a pt l  s u  formula  by lemma b    ii   it
is satisfiable in a tt model iff it is satisfiable in an aleksandrov tt model based on the same
   

ficombining spatial and temporal logics  expressiveness vs  complexity

  of  we associate a fresh propositional
flow of time  with every  spatial  subformula  

variable p and denote by  the pt l formula that results from  by replacing all its
  with p  
subformulas of the form  
we claim that  is satisfiable in an aleksandrov

tt model over a flow of time f   hw   i iff

 there exists a temporal model n   hf  ui satisfying  and 
     n  w     p      
     n  w     p   of spatial
 for every w  w   the set w     


formulas is satisfiable 

the implication    is obvious  conversely 
s suppose that we have a temporal model n
satisfying the conditions above  let    ww w   by lemma b    there is a finite
quasi order g such that  for every w  w   we have hg  vw i    w for some valuation
vw   it should be clear that  is satisfied in the aleksandrov tt model hf  g  vi  where
v p  w    vw  p   for every spatial variable p and every w  w  
now  to devise a decision procedure for pt l s u   which uses polynomial space in the
length of the input formula  one can take the corresponding nondeterministic pspace
algorithm for pt l  sistla   clarke        reynolds              and modify it as follows 
the algorithm constructs a pure temporal model n   hf  ui for  and every time it
produces a state for a time instant w  w   it additionally checks whether the set w of
spatial formulas is satisfiable  by theorem      this extra test can also be performed by a
pspace algorithm  which does not increase the complexity of the combined algorithm  q
proof of theorem      the proof is essentially the same as that of theorem      but now
nondeterministic polynomial time algorithms for the component logics are available 
q
b   undecidability of pt l  s u and pt l   s u
note that although our spatio temporal languages contain no propositional variables  we
 p can be regarded as a proposition 
still can simulate them  for a spatial variable p  formula  
 p  for a spatial
thus  in what follows by a propositional variable p we mean the formula  
variable p  note the different typefaces used to denote propositional and spatial variables  
proof of theorem      the proof is by reduction of the undecidable posts        correspondence problem or pcp  for short  it is formulated as follows  given a finite alphabet
a and a finite set p of pairs hv    u  i           hvk   uk i of nonempty finite words


ff


ff
vi   bi            bili  
ui   ci            ciri
 i              k 
over a  an instance of pcp  decide whether there exist an n    and a sequence i            in
of indices such that
vi       vin   ui       uin  
    
where  is the concatenation operation  we will construct  using only future time temporal
operators  a pt l  s u  formula a p such that
 i  the length of a p is a polynomial function in the size of both a and p  
 ii  if a p is satisfiable in a tt model based on hn   i then there exist an n    and a
sequence i            in of indices such that      holds 
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

 iii  if there exist an n    and a sequence i            in of indices such that      holds then
a p is satisfiable in a tt model with fsa and based on hn   i 
 iv  a p is satisfiable in a tt model based on hn   i iff a p is satisfiable in a tt model
based on a finite flow of time 
the case of hz   i follows immediately  by lemma b    ii   it suffices to consider only
aleksandrov tt models for a p  
we build a p using spatial variables lefta and righta  a  a   left  right and stripe  as
well as propositional variables pairi   for every pair hvi   ui i     i  k  and range 
the variable range is required to relativise temporal operators  f and  f in order to
ensure that we can construct a model based on a finite flow of time  the variable stripe is
used to introduce a new strict closure operator in aleksandrov spaces by taking  for every
spatio temporal term   


s   stripe   c stripe u c   u stripe   c stripe u c    
denote by sn a sequence of n operators s  other abbreviations we need are      which
stands for          u          and   
f  which replaces    f  
the formula a p is defined as the conjunction
a p   range  stripe  pair  eq  left  right  
where
range   range   f range   f  range   f range  


 
 
 
range

pair

 pair

pair
 
 
pair     
f
i
i
j
f
 ik


  stripe  stripe   
 f range   


 
  left
   f range 
 

right
 
a
a  

stripe  
eq

 i jk

  
f

aa

left is the conjunction of           for all i with    i  k 
 
g


 

  
lefta  
f   lefta u leftb   f   left 
aa

a  b
a ba

 

    




  
f pairi    lefta   lefta    

    

aa

 left      
 
f  left   sleft  

  
f
  
f

    

  left  
pairi   
 
 
   sj left u sj   left    left i
 
pairi 
b



sli left 

li j

j li
left

pairi   
i  

    

   

    
    

   left u sleft   
 f pairi   

   

left 
s
i    

    

ficombining spatial and temporal logics  expressiveness vs  complexity
b

b

b

b

yn  b
 
  
 
 
 

b

b

b

 
 
 

 
 
 

 
 
 

b

b

b

yn     b
yn  b
 
  
 
 
 

yn     b
yn  b
 
  
 
 
 

yn     b
yn  b 

 
  
 
 
li
 
  
b
y 
pairi 
 

b

b

 
 
 

 
 
 

b

b

b

trb


li
  

b
btr


li
  

trb

bili 
vi 

   
 
 

br

bi  

br

bili 

   
 
 

vi 
rb

br

bi  

rb

br

bili 

   
 
 


 
 
l
 
 i 
b

rb

rb

br

bi  

trb

rb

rb

br

bili 

vi 

   
 
 

vi 
rb

rb

pairi 
 

b   left
r   left
t   left u sleft

rb

pairi 
 
range

pairi 
 

br

bi  

 

   

figure    model satisfying left   for n     
where
ileft   leftbi u s leftbi u s leftbi u    u sleftbi        
 

 

 



li

 remember that li is the length of the word vi    the conjunct right is defined by replacing
in left all occurrences of left with right  lefta with righta  for a  a   li with ri and ileft
with iright   which is defined similarly   note that pairi occurs in both left and right   
let us prove that a p is as required  suppose that  m        a p   for an aleksandrov
tt model m   hhn   i   g  vi with g   hv  ri  since  m        eq   we can find an n  
   n     such that
 
  left
 m  n      range 
 
    
a  righta   
aa

in view of range   we have  m  j     range for all j     j  n   let i            in be the
sequence of indices such that  for    j  n   we have  m  j        pairij  pair ensures
that there is a unique sequence of this sort   we claim that      holds for this sequence 
since stripe holds in m at    we have  for every y  v    m  h   yi     stripe iff
 m  hj  yi     stripe for all j     j  n   denote by rs the transitive binary relation
on v defined by taking xrs y if there is z  v such that xrzry and  m  h   xi     stripe
holds iff  m  h   zi      stripe  then we clearly have that  for every j     j  n   and every
xv 
 m  hj  xi     s

iff

there is y  v such that xrs y and  m  hj  yi      

call a sequence hy            yl i of  not necessarily distinct  points from v an rs  path in
v left  j  of length l if y            yl  v left  j  and y  rs y  rs       rs yl   for every sequence
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

z            zl of points from v left  j  we define
leftwordj  z            zl     ha            al i  
where the ai are the  uniquely determined by       symbols from a with  m  hj  zi i     leftai  
we will show now that  for every j     j  n   the following holds 


ff
 a  there exists an rs  path y            ynj in v left  j  of length nj   li         lij such
that
leftwordj  y            ynj     vi         vij  
 b  every rs  path in v left  j  is of length  nj  


ff
 c  for every rs  path y            ynj in v left  j   we have
leftwordj  y            ynj     vi         vij  
indeed  for j      we have  a  by  m        pairi  and        b  by      and       and
 c 

 by      ff now assume inductively that  a  c  hold for some j     j   n   let
y            ynj be a maximal rs  path in v left  j   first  by       y            ynj  v left  j      


ff
second  since  m  j  ynj      left u sleft and  m  j     pairij          now implies that
ff


there exist ynj              ynj  lij   such that y            ynj  lij   is an rs  path in v left  j      
as required in 
 a   for  b  and
ff  c   observe first that for every rs  path hy            yl i in
v left  j       y            yllij   is an rs  path in v left  j   by       so l  nj   must
hold  if l   nj   then leftwordj  y            yllij       vi          vij by the induction hypothesis  and so leftwordj    y            yllij       vi          vij by       on the other hand 
leftwordj    yllij                yl     vij   by       and so we have leftwordj    y            yl    
vi         vij  vij     as required 
we can repeat the argument above for the right side as well  for every sequence
z            zl of points from v right  j   define
rightwordj  z            zl     ha            al i  
where the ai are the uniquely determined elements of a such that  m  hj  zi i     rightai  
we then have  for every    j  n  


ff
 a    there is an rs  path y            ymj in v right  j  of length mj   ri         rij such that
rightwordj  y            ymj     ui         uij  
 b    every rs  path in v right  j  is of length  mj  


ff
 c    for every rs  path y            ymj in v right  j   we have
rightwordj  y            ymj     ui         uij  
   

ficombining spatial and temporal logics  expressiveness vs  complexity

now  by      and       we have v left  n     v right  n    by  a   there exists an rs path hy            yl i in v left  n   such that l   nn and leftwordn  y            yl     vi         vin  
by  b     we have nn  mn   similarly  using  a    and  b   we obtain mn  nn   from which
nn   mn   hence  by  c     rightwordn  y            yl     ui         uin   since  by      
leftwordn  y            yl     rightwordn  y            yl   
we finally obtain vi         vin   ui         uin   as required 
conversely  suppose there is an n    and a sequence i            in for which      holds 
we will show that a p is satisfiable in an aleksandrov tt model m   hhn   i   hn  i   vi
with fsa  let nj   li         lij and mj   ri         rij for every j     j  n   by our
assumption  nn   mn and we have
vi         vin   ha            ann i   ui         uin  
define a valuation v by taking
 v range  j  is true iff    j  n  
 v stripe  j      m   m        j  n   
 v pairi   j     is true iff i   ij and    j  n  
 v lefta   j     k      k  nj   ak   a  for a  a and    j  n  
 v righta   j     k      k  mj   ak   a  for a  a and    j  n  
s
s
v righta   j  
v lefta   j  and v right  j   
 v left  j   
aa

aa

one can easily check that under this valuation we have  m        a p and m satisfies
fsa  it is also readily seen that a p is satisfiable in a tt model based on hn   i iff it is
satisfiable in a tt model based on a finite flow of time 
q
proof of theorem      we show this by modifying formulas from the proof of theorem      first  we replace stripe with
 

  
f   stripe    f stripe    f   stripe    f stripe  

then  left is the conjunction of               for all i with    i  k 
 
g


 

  
lefta  
f   lefta u leftb   f   left 
aa

a  b
a ba

 

      



  
f pairi    lefta    f lefta    

      

aa

 left      
 
f  left   sleft  

  
f
  
f

      


  left     sli left   
pairi   
f
 
  left u   left        sj left u sj   left    left i
pairi 
 
f
f
b

li j

j li
left

pairi   f  
i  

 f

      

   

      
      

left 
   left u sleft      s
pairi   
f
i    

   

      

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

where the ileft are defined exactly as in the proof of theorem      formula right is modified
in a similar way 
q
remark b    in fact  the set of pcp instances without solutions is not recursively enumerable and therefore  the proofs above show that the sets of pt l  s u and pt l   s u formulas which are true in all models based on hn   i  hz   i or finite flows of time are not
recursively enumerable either  therefore  these logics are not recursively axiomatisable 

appendix c  spatio temporal logics based on rc
in this appendix we establish lower and upper complexity bounds for a wide range of
decidable spatio temporal combinations and  in particular  prove theorems          we
begin with a straightforward generalisation of lemma a   to the spatio temporal case 
lemma c     i  if a pt l  rc formula  is satisfiable in a tt model with fsa and based
on a flow of time f then  is satisfiable in an aleksandrov tt model based on f and a finite
disjoint union of finite brooms 
 ii  if a pt l  rc formula  is satisfiable in a tt model based on a flow of time f then 
is satisfiable in an aleksandrov tt model based on f and a  possibly infinite  disjoint union
of  brooms 
proof   i  by lemma b    i    is satisfiable in an aleksandrov tt model based on f and a
finite quasi order g  the rest of the proof is similar to that of lemma a    further details
are left to the reader 
 ii  by lemma b    ii    is satisfiable in an aleksandrov tt model based on f and a
quasi order g   hv  ri  the rest of the proof again is similar to that of lemma a    we
only note that although g can be infinite  still for every x  v there is a y  v  such that
xry  this is guaranteed by the condition that the set aw x   has a maximal point 
q
observe that aleksandrov spaces are essentially infinite in case  ii  of lemma c   and a
generalisation of lemma a   does not go through  first  we can easily enforce a topological
space to be infinite using the pt l  rcc   formula

  
f nttp p  p  

moreover  the formula
 
 
   

  p
p  
 
u i p      
f    p  


  
f 



 
  

 
p u i p   i p u p u p

is satisfied in an aleksandrov tt model based on a single  broom  but cannot be satisfied
in an aleksandrov tt model based on a union of n brooms for any finite n 
on the other hand  aleksandrov tt models based on disjoint unions of n brooms  where
n is bounded by the width of the formula  are enough for spatio temporal logics based on
rc    recall that spatial terms  of pt l  rc   and pt l  rc    are defined as follows


     

   



    i 

  



      u    u m

    u    

   

  u

   

ficombining spatial and temporal logics  expressiveness vs  complexity

where the   are spatio temporal boolean region terms of pt l  brcc    and pt l 
brcc    respectively   it is not hard to see that  for every tt model m   hf  t  vi with
f   hw   i  t   hu  ii and every w  w   we have
v   w    civ   w 

and

v   w    icv   w  

    

i e   the  are always interpreted by regular closed sets  whereas the  by regular open ones 
we define the width w   of a pt l  rc   formula  as the maximal number m of
   u    u 
conjuncts in its subformulas of the form  
 
m    if such subformulas exist  and put
w       otherwise 
lemma c     i  if a pt l  rc   formula  is satisfiable in a tt model with fsa and
based on a flow of time f then  is satisfiable in an aleksandrov tt model based on f and a
finite disjoint union of w   brooms 
 ii  if a pt l  rc   formula  is satisfiable in a tt model based on a flow of time f
then  is satisfiable in an aleksandrov tt model based on f and a  possibly infinite  disjoint
union of w   brooms 
proof  by lemma c    we may assume that  is satisfied in an aleksandrov tt model m  
hf  g  vi  where f   hw   i and g   hv  ri is a disjoint union of brooms  in  i   the union
and the brooms are finite   without loss of generality we may assume that  is composed
       
     
 using temporal operators and the booleans  from formulas of the set      
 
n
where every i has one of the following forms
  u    u m  

u

or

 

    

and the i    and  are as defined above 
  
    we fix a point x
for every  
 and every w  w with  m  w      
 w  v such
that  m  hw  x w i        we may assume that the x w are pairwise distinct and that the
    
roots of all the brooms are the points of the form x w for some w  w and  

  
therefore  g is a disjoint union of brooms b w   for  
 and w  w  
let us construct a model m    hf  g    v  i as follows  given a broom b w   we delete
some of its leaves depending on the form of    three cases are possible 
case      u    u m   take m leaves y            ym of b w such that  m  hw  yi i     i and
x w ryi for i              m and remove all leaves different from y            ym  
case     u   take a leaf y of b w such that  m  hw  yi      and x w ry and remove
all other leaves  note that  by       we have  m  hw  yi       and therefore  m  hw  yi       
case      take a leaf y of b w such that x w ry and remove all other leaves  by      
we have  m  hw  yi       
denote by b  w the resulting broom  clearly  it is a w   broom  let g    hv     r  i be
 
  
the disjoint union of all b w   for  
 and w  w   it should be clear that g is as
 
required  finally  we define v by taking for every spatial variable p  every w  w and
every x  v    
x  v   p  w 
   we treat

iff

there is y  v   of depth   such that xr  y and y  v p  w  

 as an abbreviation 
 as primitive and  
 

   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

    
to show that  is satisfied in m    we first prove that  for all w  w and all  


 m    w      

iff

  
 m  w      

it is readily proved by induction that we have  m    hw  xi      iff  m  hw  xi        for all
points x  v   of depth    all w  w and all spatio temporal terms   
  
then  by the construction  we also have that  for all formulas  
 and all w  w  
 


  implies
 m  w       implies  m   w         so it remains to show that  m  w      
 
 
  for all  
  
 m   w      
 and all w  w   suppose that we have  m   hw  xi      and
    consider three possible cases for   
 m  w      
case      u    u m   then  for every i     i  m  there is yi  v   of depth   such
that xr  yi and  m    hw  yi i     i   but then  m  hw  yi i     i and  by        m  hw  xi     i  
 
therefore   m  hw  xi        contrary to  m  w      
 
case     u   then there is y  v of depth   such that xr  y   m    hw  yi      and 
by        m    hw  yi       thus  m    hw  yi        but then  m  hw  yi        contrary to
 
 m  w      
case      then there is y  v   of depth   with xr  y and  by        m    hw  yi       
 
but then  m  hw  yi        contrary to  m  w      
now  by a straightforward induction we can easily show that  for all w  w and all
formulas  built from  using the temporal operators and the booleans 
 m    w     

iff

 m  w      

it follows that  is satisfied in m   

q

c   lower complexity bounds  i 
proof of theorem       lower bound  the proof is by reduction of an arbitrary problem in  expspace to the satisfiability problem of pt l  rc  let a be a  single tape 
deterministic  turing machine such that a halts on every input  accepting or rejecting it  
f  n 
and a uses    
cells of the tape on any input of length n  for some polynomial f   given
any such turing machine a and an input x for it  we will construct a pt l  rc formula
a x  using only future time temporal operators  such that
 i  the length of a x is polynomial in the size of a and x 
 ii  if a x is satisfiable in a tt model based on hn   i then a accepts x  and
 iii  if a accepts x then a x is satisfiable in a tt model with fsa and based on hn   i 
the case of hz   i as a flow of time  with or without fsa  follows immediately  the case
of finite flows of time can be proved by relativising the temporal operators of a x  say 
by a propositional variable range as in the proof of theorem     in appendix b   and in
the proof of the lower bound of theorem     below   we can obtain a formula  a x such
that  a x is satisfiable in an aleksandrov tt model based on hn   i iff it is satisfiable in an
aleksandrov tt model based on the same quasi order but on a finite flow of time  so this
way all the lower bound results of this theorem follow 
   

ficombining spatial and temporal logics  expressiveness vs  complexity

given a turing machine a  polynomial f   and input x   hx            xn i as above  let
d   f  n  
exp    d    d   d and exp    d    exp    d    exp   d   
then we have
  

f  n 

 exp    d  

    

our plan is as follows  first  we will show that yardsticks of length exp    d   similar to
those used by stockmeyer       or halpern and vardi        can be encoded by pt l  rcformulas of length polynomial in d  these yardsticks will be used to define a temporal
operator exp   d    then  using this operator  we will encode the computation of a on
input x 
by lemma c    ii   if a pt lrc formula a x is satisfied in a tt model based on a flow
of time hn   i  then it is satisfied in an aleksandrov tt model m   hhn   i   g  ui  where
g   hv  ri is a disjoint union of  brooms  take such a model m and suppose that the
pt l  rc formula 

 


aux
    
  
f   aux 


is true in m at moment    since region aux does not change over time  we can divide all
points

 in v into three disjoint sets  external  boundary and internal points with respect to
aux i e   those satisfying








ep aux    aux  
bp aux    aux u i aux
and
i aux  
respectively  note that every boundary point has a non boundary r successor  so boundary
points can only be of depth    in what follows

 we simply speak about external and boundary
points not mentioning with respect to aux  
we define the exp   d  operator by a pt l  rc formula of length polynomial in d as
follows 
 a  first  we encode yardsticks of length d  we will use different formulas for yardsticks
on external points and for yardsticks on boundary points 
 b  then  with the help of d yardsticks  we encode yardsticks of length exp    d   we
will again use different formulas for external and boundary points 
 c  next  with the help of exp    d  yardsticks on both boundary and external points  we
encode yardsticks of length exp    d  on boundary points 
 d  finally  with the help of exp    d  yardsticks on boundary points  we define a polynomial length exp   d  operator applicable to propositional variables 
step  a   suppose that      and the following formula hold in m at   


 
ext

  
f   bp aux      d   f   ep aux      d
where
  d  



    


l

 

 d 
j delim 
 
delim   d delim  u
delim   
j  

   recall that      stands for          u           we assume that u and t bind stronger than  

   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

ext results from 
and   d
  d by replacing each occurrence of delim  with ext delim   


take a boundary point z  suppose that v  n is such that  m  hv  xi     delim    by
  d   for every time moment w  v 


 m  hw  zi     delim 
iff
w  v  mod d  


that is  on z  delim  holds once inevery
 d time instants  starting from v by the second

conjunct of       external points of aux behave similarly with respect to ext delim   
step  b   to encode yardsticks of length exp    d   recall first that every number a    d
can be represented in binary by asequence
a        ad  of bits  we will mark the bits of

binary numbers by a region term bit  as
 follows  given a boundary point z and a time
moment v such that  m  hv  zi     delim    we say that an interval  w  w   d      for some
w   v   j  d  j  n  encodes a number a    d on z  if for every i   d 


 m  hw   i  zi     bit 
iff
ai     

recall that the binary representation b        bd  is the successor of a        ad  modulo
the following holds  for all i     i   d  we have ai   bi iff aj      for some j  i   j
we will use the d intervals starting from v to encode    d numbers in such a way
consecutive intervals encode consecutive  modulo  d   numbers  starting from   
so  suppose that            and the following formula hold in m at   


ext
ext


   
  
f   ep aux      d u   d  
f   bp aux      d u   d

 d if
  d 
that

    

where
  d

 

  d

 







 

lwr   delim  t bit  u lwr 
u
 



 




  
zr   bit  u delim  t zr 
u delim   delim  u zr   



 

lwr  
bit   d bit   

ext and  ext result from 
and both   d
  d and   d   respectively  by attaching prefix ext to all
  d
of their spatial variables  save aux  


take a boundary point z  suppose that v  n is such
 that  m  hv  zi     delim   
then  by the last conjunct of   d   we have  m  hv  zi     delim    since  by  a   delim 
holds once in every d time instants on z  delim  marks the starting moment of each
d interval  then  by the first conjunct of   d   for every i     i   d  we have 




 m  hv   i  zi     lwr 
iff
 m  hv   j  zi     bit    for all j  i   j   d 

therefore    d says that consecutive    d numbers  starting with    are encoded by consecutive d intervals  starting from v   similarly to the first conjunct of   d   its second conjunct
ensures that  for every i     i   d 
 


 m  hv   i  zi     zr 
iff
 m  hv   j  zi     bit    for all j  i  j   d 
   since
apply the u operator

we cannot

  to form
 spatio temporal
 terms 
 auxiliary regions

 are
 used instead 

lwr   delim  t bit  u lwr  ensures that lwr  behaves as bit  u delim    this
equality term can indeed be regarded as a fixed point characterisation of the u operator 
note

 also that


we do not need to require  as we should do for the fixed point characterisation  lwr     f delim  to
be true because the eventuality is already enforced by   d  

   

ficombining spatial and temporal logics  expressiveness vs  complexity



so  by the last conjunct of   d   delim  holds on z once in every exp    d    d   d time
instants  starting
 from v  by
 the second conjunct of       external points behave similarly
with respect to ext delim   
step  c   now we construct yardsticks of length exp    d   using the exp    d  yardsticks
constructed in  b   suppose that          and the following formulas hold in m at   

  
f   bp aux   






ext delim 
   
   ep aux  t bp aux    
f   ext delim 


  
f   ep aux      d  bit     


  
f   bp aux      d u   d  


    
    
    

where   d is defined similarly to   d and
  d  bit   

 



jm  bit 







 

 

delim  u bit 
t ext delim  u jm  bit   









 
bit   i bit 
u lwr  
bit   j  d bit   


  i  aux u ext delim      jm  bit   
ext

  d
j  d bit 



take a boundary point z  suppose v is a time moment such that  m  hv  zi     delim   
then  by the last conjunct of   d    m  hv  zi     delim    we know from  b  that delim 
holds on z once in every exp    d  time instants starting from v  so  by   d and the first
conjunct of   d we intend to express that consecutive    exp   d  numbers  starting with
   are encoded by consecutive
 exp    d  intervals starting from v  if we could do this then 
by the last conjunct of   d   delim  would hold on z once in every exp    d  time instants
starting from v  the only problem  and the only
from step  b   is that to mark
 difference

exp   d 
the bits of    
binary numbers by a term bit    we need to show that the  polynomial


length  term j  d bit  actually defines exp   d  bit   in the sense that  for every w  v 
 m  hw  zi     j  d bit 



ff


 m  w   exp    d   z      bit   

iff

    

suppose first that  m  hw  zi     j  d bit    then 
by      
yw
 there is an external r successor


of z  of depth    such that  m  hw  yw i     ext delim    and so  m  hw  yw i     jm  bit   
on the other hand  it is not hard to see that if  m  hw  zi      j  d bit    then there
 is
 
 
an external r successor yw of z  of depth    such that  m  hw  yw i     ext delim  but


  i     jm bit  
 m  hw  yw
 
 


in both cases  it is readily checked that if  m  hw  yi     ext delim    for some external
point y  then  by      


 m  hw  yi     jm  bit 



ff


 m  w   exp    d   y      bit   

iff

now      follows by the first conjunct of   d  
step  d   we are now in a position to define a polynomial length exp   d  operator j  d
applicable to propositional variables  recall that a propositional variable p stands for spatial
 p  where p is a spatial variable associated with p  now  for every propositional
formula  
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

variable p we intend to apply the new operator to  we introduce a fresh spatial variable
jm  p  suppose that          and the following formulas hold in m at   



  
f   bp aux  u delim   
 
 



  
   
f   p    p
f     d  p  

    
    

where   d  p  is obtained by replacing bit    jm  bit  and ext delim  in   d  bit    with p 
jm  p and delim    respectively  let




  bp aux  u
delim      jm  p  
j  d p    
we claim that  for every time moment w and every propositional variable p 
 m  w     j  d p

 m  w   exp    d      p 

iff

    

suppose first that  m 
point z such

 w     j  d p  then  by       there is a boundary
that  m  hw  zi     delim    and therefore  m  hw  zi     jm  p   on the other hand 

if  m  w      j  d p  then there is a boundary point z   with  m  hw  z   i     delim  but




 m  hw  z   i     jm  p   in both cases  it is readily checked that if  m  hw  zi     delim   
for some boundary point z  then  by the second conjunct of      


 m  hw  zi     jm  p



ff
 
 m  w   exp    d   z      p  

iff

now      follows by the first conjunct of      
finally  we are in a position to define the pt l  rc formula a x that encodes the
computation of turing machine a on input x  let a be the tape alphabet  with the blank
symbol b  a  and s the set of states  with two halt states syes and sno in s  of a  we use
the symbol  
  a to mark the left end of the tape  we know that the space used by a on
f  n 
input x   hx            xn i is       which is  exp    d  by       so we can represent each
configuration of the computation of a on x as a finite word
h  a            ai    hs  ai i   ai             am   b          bi
of length exp    d   where a            am  a and hs  ai i  s  a represents the current state
and the active cell  the transition function  of a takes triples of the form hai   hs  aj i   ak i
 for ai  a      aj   ak  a  s  s   syes   sno    to similar triples  for instance 
 ai   hs  aj i   ak     hai   aj   hs    ak ii
means that  when being in state s and reading symbol aj   the new state should be s  and
the head should move one cell to the right  we also assume that  for all ai  a     and
aj   ak  a  we have  ai   hsyes   aj i   ak     hai   aj   ak i and  ai   hsno   aj i   ak     hai   aj   ak i
meaning that the head is removed after a is being halted 
now  for every   a       s  a   we introduce a fresh propositional variable p  
let a x be the conjunction of                and an instance of       for each p   as well
   

ficombining spatial and temporal logics  expressiveness vs  complexity

 

   

exp    d  many l j
exp   d 
 l 

c
c
r
c
c
c 
h
 
y
 

hh 



i

 
 


ep aux 
i aux

hh


  
r    rd
bp aux 

 

   

j
exp    d  many lexp   d  
exp   d 
lexp   d  


c
r
c
c
c
c 
h
 
y
 

hh 



i

 
 

ep aux 
i aux

hh


  rd

 

rexp   d  
   

 

 

bp aux 

 z
exp    d  many  exp    d       brooms

 

 

figure    structure of yardsticks 
as the following formulas 
 

  
f p  p  

    

 a  sa
  

p   phs   x  i   px         pxn  pb u p          
  
f



af

head 

 


phs ai  

    
    

hs aisa

 

  
f



af




head  p  j  d p    p  j  d p     p  j  d p         

     
h          i


  
f 

 

af



head  af head  af head  pa  j  d pa  

    

aa  

 f

 

phsyes  ai   f

aa

 

phsno  ai  

    

aa

suppose first that a x holds in m at time moment    by          and       the consecutive
configurations of the computation of a on input x are properly encoded along the time
axis   for instance  p holds once in every exp    d  time moments   finally       says that
a accepts input x 
conversely  suppose that a accepts input x  we will define an aleksandrov tt model
m   hhn   i   g  ui with fsa that satisfies a x   let the partial order g   hv  ri be a
disjoint union of exp    d  many  exp    d       brooms  see fig     
v    ri   i   exp    d     lij   i   exp    d   j  exp    d   
zry

iff

z y

or z   ri   y   lij   for some i  j 

suppose that the number of steps in the computation of a on x is m  then m will have
a prefix of length n   m  exp    d  after which the final configuration  without a halting
state  repeats to infinity  for w  n  let
exp   d 

u w  aux     li

   

  i   exp    d   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

then it is easy to see that the boundary points are the ri   and the external points are the
lij   for i   exp    d   now put  for every w  n 
u w  delim       li

exp   d 

 iw

 mod exp    d    

exp   d 
u w  delim       li
exp   d 
u w  delim       li
u w  ext delim       liv  
u w  ext delim       liv  

 iw

 mod exp    d    

 iw

 mod d   

vw

 mod exp    d    i   exp    d   

vw

 mod d   i   exp    d   

the valuations for the other variables should be clear  we then have


exp   d 
 m  hw  zi     delim 
iff z   ri or z   li
for some i  w  mod exp    d   


exp   d 
 m  hw  zi     delim 
iff z   ri or z   li
for some i  w  mod exp    d   


v
 m  hw  zi     ext delim 
iff z   ri or z   li for some v  w  mod exp    d  
and i   exp    d  
and so on  as required  it is not hard to see that m satisfies fsa and  m        a x  

q

proof of theorem      lower bound  the proof is by reduction of the  n  corridor tiling
problem which is known to be expspace complete  chlebus        van emde boas        
the problem can be formulated as follows  given an instance t   ht  t    t    ni  where t is
a finite set of tile types  t    t   t and n      decide whether there is an m  n such that
t tiles the m   n  grid  or corridor  in such a way that t  is placed onto h    i  t  onto
hm      i  and the top and bottom sides of the corridor are of some fixed colour  say  white 
suppose t   ht  t    t    ni is given  our aim is to construct  using only future time
temporal operators  a pt l  brcc   formula t such that
 i  the length of t is a polynomial function of  t   and n 
 ii  if t is satisfiable in a tt model based on hn   i then there is m  n such that t tiles
the m   n  corridor 
 iii  if there is m  n such that t tiles the m   n  corridor  then t is satisfiable in a
tt model with fsa and based on hn   i 
 iv  t is satisfiable in a tt model based on hn   i iff it is satisfiable in a tt model based
on a finite flow of time 
the case of hz   i follows immediately 
recall that  by lemma c    ii   if t is satisfied in a tt model then it is satisfied in
an aleksandrov tt model m   hhn   i   g  vi  where g   hv  ri is a disjoint union of brooms  to explain the meaning of t s subformulas  we assume that such a model m is
given  throughout the proof we use only a restricted subset of rcc   predicates  for spatiotemporal terms   and   constructed from spatial variables using only the complement  the
intersection and the next time operator   we need eq         as well as two abbreviations
p           eq          tpp          ntpp         and e     dc         standing for  
   

ficombining spatial and temporal logics  expressiveness vs  complexity

m   n

 

 m        n

count
range

 



 

 



 

 



 

 



 

 



 

 

 



 



 

 



 

 

 



 



 

  



 

  



 

  



 

  



 

  



 

  



 

  

   



 

figure    counting formulas for m     and n     
is a part of    and   is nonempty  respectively  clearly  this language forms a subset of
pt l  brcc    in fact  as we show in remark c   below  the proof goes through for an
even more restricted subset of the langauge  
our first step in the construction of t  which will contain  among many others  spatial
variables t for all t  t   is to write down formulas forcing a sequence y    y            ym n  
of distinct points  of depth    from v   for some m  n  such that  for each i   m   n  
 m  hi  yi i     t for a unique tile type t  t   if i   k   n   j  for some k   m  j    n  
then we will use yi  at time i  to encode the pair hk  ji of the m   n  grid  thus  the up
neighbour hk  j    i of hk  ji will be coded by the point yi   at time i      while its right
neighbour hk      ji by yi  n at moment i    n  see fig      
let q            qn  be pairwise distinct propositional variables and
d

n 
j   qd        qn 
 

where dn        d  is the binary representation of j    n   q i   qi and q i   qi   for each i 
suppose that the formula



 
count     count u       
    
f count    f count  
is true in m at    where count is a fresh propositional variable and  is the following
counting formula  the length of which is polynomial in n 

 

    
 

qi  qk 
 
qi  qk 
 qi  qi  
  n       
k n

i k

i k

k i n

then there is an m  n such that count is true before moment  m        n and false starting
from  m    n   the sequence                  n   is repeated m   times along the time line 
i e   while count is true  let
range    f  count      
clearly  range is true before moment m   n and then always false  see fig     
let equ  p            pn  and e            en  be fresh distinct spatial variables  and
d

n 
j   pd   u    u pn 
 

where dn        d  is the binary representation of j    n   p i   pi and p i   pi   for each i 
suppose that      and
l 
 
 


 

  
e

 
  
eq
equ 
q

eq e
 
p
 

    
i
i
i
i
f
f
f eq pi   pi
i n

i n

i n

   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

are true in m at    then  by the first two conjuncts of       for all i  n and y  v of
depth    there is j    n such that  m  hi  yi     equ iff  m  i     j and  m  hi  yi     j   by
the last conjunct of       we then have


 m  hi  yi     equ iff j    n  m  i     j and  m  hk  yi     j   for all k  n     
we can generate the required sequence of points yi using the formulas 
range    
 range  e tile  
 f

g  l
  
eq
tile 
equ
u
t
u
no
t
in
future
 
f
tt

 

  
f p no t in future 

    
    

tt
t


u no t in future  

    

tt

where tile and the no t in future  for all t  t   are fresh spatial variables  indeed  suppose
the conjunction of          holds at time   in m  then  by the first conjunct of      and
       m        range    and  by the second conjunct of        m  h   y  i     tile for some
y   v   we may assume that y  is of depth    then  by       we have
 a     m  h   y  i     equ  and  by      m  hk  y  i       for all k  n 
 b    for all t  t    m  h   y  i     no t in future and  by        m  hk  y  i     t for all k     
next  by       we have  m        range    and  by       there is y   v  again  of depth
   such that  m  h   y  i     tile  in particular  we have 
 a     m  h   y  i     equ  and  by      m  hk  y  i       for all k  n 
 b    for all t  t    m  h   y  i     no t in future and  by        m  hk  y  i     t for all k     
by  b      m  h   y  i     t  for all t  t   and thus y     y    now we consider y  at moment  
and use the same argument to find a point y   v  which is different from y  by  b      and
so forth  see fig      this gives us points y    y            ym n    of depth    from v we need 
our next aim is to write down formulas that could serve as pointers to the up and right
neighbours of a given pair in the corridor  at this moment we do not bother about its top
border   consider the formulas

tile  
  
    
f eq up 

 
 f eq right  equ u no equ u tile  
    

 
 f eq no equ u tile  tile t  equ u no equ u tile  
    
where up  right and no equ u tile are fresh spatial variables 
i  j   m   n  
  m  hi  yj i     up
  m  hi  yj i     right

iff

j   i     
iff

j   i    n  
   

we claim that  for all

ficombining spatial and temporal logics  expressiveness vs  complexity

b   t for all
q q  no equ u

range

v
  

y  

q

q

q

equ
q

q

q

q

  

y  

q

q

equ
q

q

q

q

  

y 

q

equ
q

q

q

q

  

q
y  equ

q

q

q

  

y 

q

q

q

equ
q
right

equ
q
right

equ
q
right

equ
q
right

equ
q
right

  

y 

q
q

equ
q
right

  

y 

q

  

y 

equ
q
right

  

y 

q

q

  

y 

q

up
q

  

y 

up
q

  

r
y  equ
tile
 



 

q



equ
r
tile

q

q

q

q

q

up
q



equ
q
right

up
r
q equ
b
tile
up
r
q
q
q equ
b
b
tile
up
r
q
q equ
b
b
b
tile
up
r
q equ
b
b
b equ
b
tile
equ
r
b
b
b equ
b
b
tile
b
b
b equ
b
b
b

q

q

b

b

equ
b

b

b

b

equ
b

b

b

b

equ
b

 

 

 

 

 

 

 

 

 

  

  

  



 
right

 

up
r
q
q
q equ
tile
up
r
q
q
q equ
b
b
b equ
b
b
b
b
tile
up
q
q equ
b
b
b equ
b
b
b
b equ
b
r
tile
up
r
q equ
b
b
b equ
b
b
b
b equ
b
b
tile
equ
r
b
b
b equ
b
b
b
b equ
b
b
b
tile
b
b
b equ
b
b
b
b equ
b
b
b
b

b

 



 



 



 



 



 



 



 

tt
tile



 



 



 



up

   
s


up

 
c  right

     

 z

 

      corridor

 

figure     satisfying t   n      in a tt model based on space with       points 
the former is obvious  let us prove the latter  to show that  m  hi  yj i     right  for
j   i    n   we first observe that  m  hj  yj i     equ and  m  hi  yj i     equ by     it follows
from  m  hj  yj i     tile by      that  m  hj     yj i     no equ u tile  then  applying
      from right to left  sufficiently many times  we obtain  m  hi  yj i     no equ u tile 
 m  hi     yj i      no equ u tile  and so  m  hi  yj i     right 
conversely  suppose that  m  hi  yj i     right for some yj   then  m  hi  yj i     equ and 
by     note that i    n    m        n   and so count is still true at i    n   
 m  hi    n   yj i     equ 

  

we have  m  hi  yj i     no equ u tile  then applying       from left to right  sufficiently
many times we arrive at  m  hi    n     yj i     no equ u tile which together with   
gives  m  hi    n   yj i     tile  but then j   i    n  
it should be noted that at every time point the extension of no equ u tile coincides with
the extension of the term equ u tile on elements of the sequence y            ym n   and that     
is indeed the fixed point characterisation of this u operator 
finally  the formulas below ensure that every point of the m   n  corridor is covered by
at most one tile  h    i is covered by t    hm      i by t    the top and bottom sides are white
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

and that the colours on adjacent edges of adjacent tiles match 
 
 
  
f e  t u t   

    

t t  t
t  t 





p tile  t       


range

 


range

p
tile 
t
 
 
 
 
f
f


 

n
  
p tile  t  
f     

    
    

tt
up t  white


 

  


p
tile 
t
 
 
f

    

tt
down t  white

 



 
n
t
in
future
 
  


e
t

p
up 
no
   
f

    

t t  t

up t   down t   

 



 
 
e
t

p
right 
no
t
in
future
  
f

    

t t  t
right t   left t   

let t be the conjunction of           suppose that t holds at   in m  then there
is m  n such that  m  m   n        range and  for every i  m   n    m  i     range 
then we define a map    m   n  t by taking
  k  j    t

iff

 m  hi  yi i     t and i   k   n   j 

we leave it to the reader to check that  is a tiling of m   n   as required 
for the other direction  suppose that there is a tiling  of the m   n  corridor by t   for
some m      then t is satisfied in the aleksandrov tt model m   hhn   i   hv  ri   vi 
where v    y            ym n      r is the minimal reflexive relation on v  
v t  i     yi  v     k  j    t and i   k   n   j  
and the other variables of t are interpreted as shown in fig      clearly  m satisfies
fsa  moreover  t is satisfiable in tt models over finite flows of time iff it is satisfiable in
tt models over hn   i  details are left to the reader 
q
remark c    it may be of interest to note that the language used in the proof above is
rather limited  in fact  it is enough to extend the pspace complete logic pt l  rcc  
with predicates of the form eq         t       where the  i are atomic spatio temporal region
terms  to make it expspace hard  to show this  we transform the pt lbrcc   formula
t constructed above in the following way  first  we take a fresh spatial variable u  denoting

the universe  and add to t the conjunct   
f eq u  u   next  for every spatio temporal
boolean region term   of t   we introduce a spatial variable neg    the complement of  
 
with respect to u   add to t conjuncts   
f eq u    t neg      f dc    neg     and replace
every occurrence of   in the resulting formula with neg    finally  for every spatio temporal
term of the form    u      we introduce a fresh spatial variable    and      add the conjuncts
 
 
  
f p    and             f p    and             f p      neg    t    and     

   

ficombining spatial and temporal logics  expressiveness vs  complexity

and replace occurrences of    u    with    and      one can readily see that  i  the length of
the resulting formula  t is linear in the length of t and  ii   t is satisfiable in a tt model
based on hn   i  with fsa  iff t is satisfiable in a tt model based on hn   i  with fsa  
c   upper complexity bounds  i   quasimodels for pt l  rc
in this appendix we define quasimodels for pt l  rc in the spirit of the paper  hodkinson
et al         in order to establish the upper complexity bounds of theorems      and      
we remind the reader that spatio temporal terms of pt l  rc are of the form 
  i 



     

 

    cip

  

  ci 

    u    
  ci    u        ci    u        ci    s      

and that pt l  rc forms a sublanguage of pt l  rcit differs from the latter only in
the definition of spatio temporal region terms 
 

   

cip

  ci 

  ci    u        ci  

let  be a pt l  rc formula  recall from p      that by sub  we denote the set of
all subformulas of  and by term  the set of all its spatio temporal terms including those
of the form  and    a type t for  is a subset of term  such that
 for every   u    term  
 for every   term  

  u    t

 t

iff

iff

   t and    t 


  t 

clearly  the number     of different types for  is bounded by   term    
a broom type b for  is a pair hht  i   ti  where ht  i is a broom  with t   being its
leaves  and t a labelling function associating with each x  t a type t x  for  such that
the following conditions hold 
 bt   t x     t y   for each pair of distinct points x  y  t    
 bt   for every x  t    
 for every ci    u      term   ci    u      t x  iff     t x  and     t x  
 and for every ci   term   ci   t x  iff   
  t x  
 bt   for every i   term  
 bt   for every    term  

i   t x 
   t x 

iff
iff

   t y  for every y  t   x  y 
y  t   with x  y and    t y  

broom types b    hht      i   t  i and b    hht      i   t  i for  are said to be isomorphic if
 for every x   t     there is x   t   such that t   x      t   x    and
 for every x   t     there is x   t   such that t   x      t   x    
clearly  given two isomorphic broom types b  and b    we also have t   r      t   r     where
r  and r  are the roots of b  and b    respectively 
a quasistate for  is a pair hs  mi  where s is a boolean saturated subset of sub  and m a
disjoint union hht  i   ti of broom types b            bn for  such that the following conditions
hold 
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

 qs   bi and bj are not isomorphic  for i    j 
   sub  
  s
 qs   for every  
 

iff

  t x  for every x  t  
   

clearly  the number     of quasistates for  is bounded by   
   sub    
fix a flow of time f   hw   i  a basic structure for  is a pair hf  qi  where q is a
function associating with each w  w a quasistate q w    hsw   mw i for  such that  for
each w  w  
 for every   u    sub     u    sw iff there is v   w such that    sv and
   su for all u   w  v  
 for every   s    sub     s    sw iff there is v   w such that    sv and
   su for all u   v  w  
let hf  qi be a basic structure for   where q w    hsw   mw i and mw   hhtw   w i   tw i
for w  w   denote by tw  the set of all leaves in htw   w i and by tw  the set of all roots
of brooms in it  a   run through hf  qi is a function r giving for each w  w a point
r w   tw    a coherent and saturated   run through hf  qi is a function r giving for each
w  w a point r w   tw  such that the following conditions hold 
 for every ci    u       term   ci    u       tw  r w   iff there is v   w such that
    tv  r v   and     tu  r u   for all u   w  v  
 for every ci    s       term   ci    s       tw  r w   iff there is v   w such that
    tv  r v   and     tu  r u   for all u   v  w  
say that a quadruple q   hf  q  r  ci is a quasimodel for  based on f if hf  qi is a basic
structure for   r   r   r    with r  being a set of   runs and r  a set of coherent and
saturated   runs through hf  qi  and c the reflexive closure of a subset of r   r  such
that
 qm   w   w   sw   
 qm   for every w  w and every x  tw   there is r  r with r w    x 
 qm   for all r  r   r  if r c r  then r w  w r   w  for all w  w  
 qm   for all r  r  w  w and x  tw    if r w  w x then there is r   r  such that
r   w    x and r c r   
a quasimodel q is said to be finitary if the set r of runs is finite 
lemma c    a pt l  rc formula  is satisfiable in an aleksandrov tt model based on
a flow of time f and a  finite  disjoint union of  finite  brooms iff there is a  finitary 
quasimodel for  based on f 
proof     let  be a pt l  rc formula and q   hf  q  r  ci a quasimodel for   where
f   hw   i and q w    hsw   hhtw   w i   tw ii for w  w   we construct an aleksandrov
tt model m   hf  g  vi by taking g   hr  ci and  for each spatial variable p and w  w  
v p  w     r   cip  tw  r w    
   

ficombining spatial and temporal logics  expressiveness vs  complexity

clearly  if q is finitary then g is finite  thus  it remains to prove that  is satisfied in m 
first  we show by induction on the construction of a region term    term  that  for
every w  w and every r  r 
 m  hw  ri      

iff

   tw  r w   

    

the basis of induction      cip  let  m  hw  ri        then there is r   r such that
r c r  and  m  hw  r  i     ip  by  qm    r w  w r   w   take any y  tw    r   w  w y  by
 qm    there is a run r    r  such that r  c r   and r    w    y  then  m  hw  r   i     p
and  by the definition of v  cip  tw  r    w   and  by  bt       tw  r w   
conversely  if    tw  r w   then  by  bt    there is y  tw  with r w  w y and
   tw  y   by  qm    there is r    r    r c r     such that r    w    y  then cip  tw  r    w  
and  by the definition of v   m  hw  r   i     p  therefore   m  hw  ri       
the induction steps for     ci     ci    u       ci    u      and ci    s      are similar 
but instead of the definition of v  we use  bt   for the cases of the booleans and coherence
and saturatedness of r   for the cases of temporal operators 
next  we extend      to arbitrary spatio temporal terms   term  
case    i   suppose that  m  hw  ri     i   take any y  tw   r w  w y  if y  tw 
then  by  qm    there is r   r  such that r c r  and r   w    y  if y 
  tw  then clearly
y   r w  and take r    r  we have  m  hw  r  i        which  by ih  implies    tw  r   w   
therefore     tw  y  for every y w r w  and  by  bt    i   tw  r w   
conversely  if i   tw  r w   then  by  bt       tw  y   for every y w r w   take any
run r   r such that r c r    by  qm    r w  w r   w   and so    tw  r   w    from which 
by ih   m  hw  r  i        hence   m  hw  ri     i  
cases      u   and   follow from ih by the definition of type 
finally  we show by induction on the construction of   sub  that  for every w  w  
 m  w     

iff

  sw  

    

    suppose  m  w      
    take any x  t   by  qm    there is r  r
case     
w
such that r w    x  then  m  hw  ri      and  by ih    tw  r w    therefore  by  qs   
   s   conversely  let  
   s   take any run r  r  by  qs    we have   t  r w   
 
w
w
w
  
from which  by ih   m  hw  ri        hence   m  w      
cases         and   follow from ih by the boolean saturatedness of the sw  
it follows from      and  qm   that  is satisfiable in m 

   let  be a pt l  rc formula and suppose that  is satisfied in an aleksandrov
tt model m   hf  g  vi  where f   hw   i and g   h  i is a disjoint union of brooms 
denote by   and   the leaves and the roots of brooms in g  respectively  with every
pair hw  xi  w   we associate the type
t w  x       term     m  hw  xi        
fix a w  w and define a binary relation on  as follows  for x  x       let x w x  iff
t w  x    t w  x    and  for z  z        let z w z   iff the brooms generated by z and z   are
isomorphic  i e  
x     z  x  x      z    x   x w x     
x      z    x   x     z  x  x w x     
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

clearly  w is an equivalence relation on   denote by  x w the w  equivalence class of x
and define a map fw by taking  for each x   
 
 x w  
x     
fw  x   
h z w    x w i   x    and z    such that z  x 
since g is a disjoint union of brooms  fw is well defined  now put
tw    fw  x    x    
u w v

iff

x  y  

tw  fw  x     t w  x  

such that x  y  u   fw  x  and v   fw  y  

for x   

by definition of fw   htw   w i is a union of brooms and tw is well defined  consider the
structure hsw   mw i  where
mw   hhtw   w i   tw i

and

sw      sub     m  w       

it is readily seen that for each of the brooms of mw we have  bt   and that mw satisfies
 qs    moreover  as fw is a p morphism from h  i onto htw   w i  we also have  bt  
 bt   and  qs    so  by taking q w    hsw   mw i for each w  w we obtain a basic structure
hf  qi for  satisfying  qm   
it remains to define appropriate runs through hf  qi  for k         let rk be the set of
all maps r   w   fw  x  for x  k   clearly  r  and r  are sets of    and coherent and
saturated   runs  respectively  put r   r   r  and for r  r   r  r c r  iff r w  w r   w 
for all w  w   then  qm   holds by definition  let v  w and y  tv   then there
is x   such that fv  x    y  clearly  r contains the run r   w   fw  x   which proves
 qm    finally  let r  r  v  w and y  tv  be such that r v  v y  there are some
z  x   such that fw  z    r w   for every w  w   and fv  x    y  we clearly have z  x
and x      then take the run r    w   fw  x   by definition  r c r    which proves  qm   
thus  q   hf  q  r  ci is a quasimodel for   note that if g is finite then r is finite as
well and therefore  q is finitary 
q
we are now in a position to establish the upper complexity bounds of the satisfiability
problem for pt l  rc  and pt l  rc formulas in tt models based on hn   i  hz   i or
arbitrary finite flows of time 
proof of theorem       upper bound  we consider the cases of hn   i and hz   i 
the case of arbitrary finite flows of time and that of tt models with fsa and based on
hn   i and hz   i will follow from theorem      
one can readily check that as for the propositional temporal logic pt l  we have the
following polynomial reductions for pt l  rc 
 satisfiability in tt models based on hz   i can be polynomially reduced to satisfiability
in tt models based on hn   i 
 satisfiability in tt models based on hn   i can be polynomially reduced to satisfiability
of formulas without past time temporal operators 
   

ficombining spatial and temporal logics  expressiveness vs  complexity

so  in what follows we consider the simplest case of the satisfiability problem  that is for
pt l  rc formulas without past time temporal operators in tt models based on hn   i 
we present a nondeterministic  expspace satisfiability checking algorithm which is
similar to that of sistla and clarke         first  one can prove  with the help of lemmas c    ii  and c    an analogue of  hodkinson et al         theorem     which states
that a pt l  rc formula  is satisfiable in tt model based on hn   i iff there are l    l   n
such that

 
l       
    l    term                   
and a balloon like quasimodel q   hhn   i   q  r  ci for  with q l    n    q l    l    n 
for every n  n  although theorem    of  hodkinson et al         was proved for the
monodic fragment of first order temporal logic  the basic idea of extracting a balloon like
quasimodel from an arbitrary one works for pt l  rc as well  the only difference is that
quasistates now are more complex  they can be regarded as sets of sets of types for   not
just sets of types  and thus  both l  and l  are triple exponential in the length     of  
then a quasimodel q can be guessed in  expspace by an algorithm which is very similar
to that in the proof of  hodkinson et al         theorem      
q
proof of theorem       upper bound  the proof is similar to that of theorem      
again  one can show that all the cases are polynomially reducible to the case of satisfiability
of pt l  rc formulas without past time temporal operators in tt models with fsa and
based on hn   i  to take the fsa into account  we can prove  using lemmas c    i 
and c    analogues of theorems    and    of  hodkinson et al         which state that a
pt l  rc formula  is satisfiable in a tt model with fsa and based on hn   i iff there
is a finitary balloon like quasimodel for  based on hn   i  the condition of finiteness for
the set of runs can also be ensured by an algorithm similar to that of theorem      
q
c   upper complexity bounds  ii  
embedding into first order temporal logic
in this appendix we introduce the first order temporal language qt l and use some known
complexity results for fragments of qt l to obtain upper complexity bounds for spatiotemporal logics based on rc   and therefore  on brcc    
the alphabet of qt l consists of individual variables x    x            predicate symbols
p    p            each of which is of some fixed arity  the booleans  the universal x and existential x quantifiers for each variable x  and the temporal operators u  s  with their
derivatives    f    f   etc    note that our language contains neither constant symbols
nor equality  we simply do not need them to obtain our complexity results  
qt l is interpreted in first order temporal models of the form m   hf  d  ii  where
f   hw   i is a flow of time  d a nonempty set  the domain of m  and i a function
associating with every moment of time w  w a first order structure
d
e
i w 
i w 
i w    d  p    p           
i w 

the state of m at moment w  where each pi
is a relation on d of the same arity as pi  
an assignment in d is a function a from the set of individual variables to d  given such
an assignment and a qt l formula   we define the truth relation  m  w    a  by taking
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

u   cip

x b
depth  
depth  

e   cip

 

xn 
b

x b

 

xnb

u
e
e
u
   
 

yh
h


i
 

h  

hh

  u
h
b

 

pj   db  pj   db        pjn   db  pjn  db  
 

 

x b

db

figure     representing n broom b with region cipj by a point in a first order model 
i w 

  m  w    a pi  x            xm   iff ha x             a xm  i  pi

 

 

  m  w    a x  iff  m  w    a   for every assignment a  in d which differ from a
only on x 
plus the standard clauses for the booleans and temporal operators  we say that a qt lformula  is satisfied in m if  m  w    a  for some w  w and some assignment a in d 
if all free variables of  are among x            xm   then instead of  m  w    a  we often write
 m  w      d            dm    where di   a xi   for all i     i  m 
denote by qt l  the one variable fragment of qt l  i e   the set of all qt l formulas
which contain at most one individual variable  say  x  without loss of generality we may
assume that all predicate symbols of qt l  are at most unary 
now we define an embedding of spatio temporal languages based on rc  into qt l   
recall that  by lemma c    i   if a pt l  rc   formula  of width n is satisfied in a
tt model with fsa then  is also satisfiable in an aleksandrov tt model based on the same
flow of time and a finite disjoint union of n brooms  similarly  if a pt l  rc   formula 
of width n is satisfiable then  is also satisfiable in an aleksandrov tt model based on the
same flow of time and possibly infinite disjoint union of n brooms 
to cover both cases  let  be a pt l  rc   formula of width n  we show how to
construct a qt l   formula n of length linear in     such that every aleksandrov tt model
based on a  finite  union of n brooms satisfying  gives rise to a first order temporal model
 with finite domain  respectively  satisfying n and vice versa  thus  we polynomially
reduce the satisfiability problem for spatio temporal languages to that for qt l   
suppose that  is satisfied in an aleksandrov tt model m   hf  g  vi  where f   hw   i
and g is a  finite or infinite  disjoint union of n brooms  with every n broom b of g we
associate an element db of the first order domain d  then  for every spatial variable pj in  
we fix n different unary predicate symbols pj   x           pjn  x  with the following meaning 
pji  x  is true on db  d at moment w  w iff the i th leaf of b  xib in fig      belongs to
i
region cip at w  define n distinct translations n      i  n  encoding the truth values
of spatio temporal region terms of  on leaves of g by taking  for a spatial variable pj and
terms    and     
i

 cipj  n   pji  x  
i

i

i

 ci    n        n  
i

i

i

i

 ci    u      n        n u      n  

i

i

 ci    u      n        n       n  
i

i

 ci    s      n        n s      n  
   

ficombining spatial and temporal logics  expressiveness vs  complexity

next we extend these n translations to arbitrary spatio temporal terms of   first we
 
introduce a translation n to encode the truth value of arbitrary spatio temporal terms in
the roots of the n brooms of g  for a region term    let
 n

   

n
 

 

k

   n  

k  
 

the formula above shows  in particular  that n is redundant for region terms since their
 
truth values in the roots can be computed as defined by n   for a spatio temporal term
of the form i   where   is a region term  we take
 n

 i  

n
 

 

k

   n

and

i

i

 i  n      n

for all i     i  n 

k  

and then  for spatio temporal terms   and      
i

i

    n       n

i

i

i

   u    n       n      n

and

for all i     i  n 

finally  we define the translation n of subformulas of   for a spatio temporal term   
n

    


 n

  x    



n
 

k

x    n

k  

and  for spatio temporal formulas   and    
    n    n  

       n    n   n  

   u    n    n u  n  

   s    n    n s  n  

clearly  the length of n is linear in both n and     
lemma c    a pt l  rc   formula  of width n is satisfiable in an aleksandrov tt model
based on a  finite  disjoint union of n brooms iff n is satisfiable in a first order temporal
model  with a finite domain  based on the same flow of time 
proof     suppose that  is satisfied in an aleksandrov tt model m   hf  g  vi  where
   
n
f   hw   i  g   hv  ri is a disjoint
 unionffof n brooms

   n ffb   hwb   rb i  wb    xb   xb           xb  
 
 
and rb is the reflexive closure of   xb   xb           xb   xb    see fig      
construct a first order temporal model n   hf  d  ii by taking d to be the set of all
db for n brooms b in g and  for every w  w  
d
e
i w 
i w 
i w 
i w 
i w    d  p             p n   p             p n          
where for each spatial variable pj in  and each i     i  n 
i w 

pji



ff
   db  d    m  w  xib      pj   

    for brevity  in this definition we follow the syntax of pt l  rc rather than pt l  rc   

   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

note that d is finite whenever g is finite 
now  by induction on the construction of a spatio temporal region term   of   it can
easily be shown that for every w  w   every n broom b in g and every i     i  n 


ff
i
    
 n  w        n  db   iff  m  w  xib        
next       can be extended to arbitrary spatio temporal terms  of  and i     i  n 
i

 n  w        n  db  

ff


iff  m  w  xib       

    

the cases for i     i  n  trivially follow from      and the fact that leaves have no
successors but themselves  consider now i      the case      holds simply because region
terms are interpreted by regular closed sets 


ff


ff
 m  w  x b       
iff
 m  w  xkb         for some k     k  n 
    
if    i  then  on one hand 


ff
 m  w  x b      i 

iff



ff
 m  w  xkb        

for all k     k  n 

 

and on the other  by the definition of n  
 

 n  w      i  n  db  

iff

k

 n  w        n  db   

for all k     k  n 

which together with      and ih yields       the cases of the booleans are trivial 
finally  we show that for every   sub   we have
 n  w      n

iff

 m  w      

  
case     
   n
 n  w       

k

iff

db  d k                 n   n  w        n  db  


ff
b in g k                 n   m  w  xkb      

iff

  
 m  w      

iff

the remaining cases are trivial  it follows that n is satisfied in n 
   assume that  is satisfied in a first order temporal model n   hf  d  ii  where
f   hw   i and  for every w  w  
d
e
i w 
i w 
i w 
i w 
i w    d  p             p n   p             p n          
with every point d  d we associate an n broom bd   hwbd   rbd i so that the sets wbd  
for d  d  are pairwise disjoint and each contains n     distinct elements x bd           xnbd  
construct an aleksandrov tt model m   hf  g  vi by taking
 g to be the disjoint union of n brooms  bd   d  d  

 
i
 v pj   w    xibd    n  w      cipj  n  d      i  n and d  d  
   

ficombining spatial and temporal logics  expressiveness vs  complexity

clearly  if d is finite then g is finite as well 
by a straightforward induction one can show that for all w  w   d  d  spatio temporal
region terms    spatio temporal terms    subformulas  of   and all i     i  n 


ff
i
iff
 m  w  xibd       
 i      
 n  w        n  d 


ff
in
i
 n  w          d 
iff
 m  w  xbd       
 n  w      n

iff

 m  w      

for example 
 

 n  w      i  n  d 

iff
iff
iff

k

 n  w        n  d   for all k     k  n
ff


 m  w  xkbd         for all k     k  n
ff


 m  w  x bd      i  
q

it follows that  is satisfied in m 
now we obtain the upper complexity bounds for combinations of pt l and rc   

proof of theorem       upper bound  follows from lemmas c    ii  and c   together
with the results on the complexity of the one variable fragment of qt l  halpern   vardi 
      sistla   german        hodkinson et al               
q
proof of theorem       upper bound  similar to the proof above 

q

proof of theorem       upper bound  the proof follows from lemmas c    i  and c  
together with the upper complexity bound of the guarded monodic  and so the one variable 
fragment of qt l  hodkinson        
q
c   lower complexity bounds  ii   embedding first order temporal logic
we are now in a position to prove theorem      and establish the lower complexity bounds
for spatio temporal logics based on brcc    and so for those based on rc  as well   denote
by qt l   the one variable fragment of qt l with sole temporal operator  f   we define a
polynomial embedding of qt l   into pt l   brcc    note that a similar embedding of
the full one variable fragment qt l  into pt l  brcc   can be regarded as an alternative
way to prove the lower complexity bound of theorem      
a qt l    formula is said to be a basic q formula if it is of the form x  x   where
 x  is quantifier free and contains no propositional variables  a qt l    sentence  is in qnormal form if it is built from basic q formulas using the booleans and temporal operator
 f   in other words  sentences in q normal form do not contain nested quantifiers and use
only unary predicate symbols  the following observation should not come as a surprise  see 
e g   hughes   cresswell        
lemma c    for every qt l    sentence  one can effectively construct a qt l    sentence

b in q normal form such that  is satisfiable in a first order temporal model with a flow of
time f  and having finite domain  iff 
b is satisfiable in a first order temporal model based
on f  and having finite domain   moreover  the length of 
b is linear in the length of  
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

proof  without loss of generality we may assume that  contains no occurrences of   to
transform  into its q normal form  we first introduce a fresh unary predicate symbol pi  x 
for every propositional variable pi in  and replace each occurrence of pi with x pi  x  
denote the resulting formula by     for every subformula  of   define a formula    by
taking inductively
 p  x      p  x  
          

 x      px  x  
                   

where px  x  is a fresh unary predicate symbol  let

 

  
x px  x   x px  x  

b   x    
f

  f       f     

x px  x   x   




 

xsub 

one can readily show by induction that 
b is satisfiable in a first order temporal model based
on f  and having finite domain  iff  is satisfiable in a first order temporal model based on
f  and having finite domain   moreover  
b is in q normal form 
q
now  given a qt l    formula  in q normal form  denote by  the result of replacing
all occurrences of basic q formulas x  x  in  with eq        where   is a region term
representing the whole space  for instance  ciu t ciu for a fresh spatial variable u   and
the translation  of quantifier free formulas  x  is defined by taking 
 p  x     cip 

     ci    

          ci   u     

  f     ci f    

where p  x  is a unary predicate symbol and p a spatial variable standing for p  x   clearly 
 belongs to pt l   brcc   
lemma c    a qt l    sentence  in q normal form is satisfiable in a first order temporal
model based on a flow of time f and having finite domain iff  is satisfiable in a tt model
based on f and satisfying fsa 
proof     suppose that  is in q normal form and m   hf  d  ii is a first order temporal


ff
i w 
model  where f   hw   i and  for all w  w   i w    d  p              let  m  w        for
some w   w   construct an aleksandrov tt model m    hf  g  vi by taking g   hd  ri 

i w   
where r    hd  di   d  d  and v pi   w    hw  di   d  pi
  note that the topological
space tg   hd  ig i induced by g is discrete  i e   for all x  d 
ig x   cg x   x 
it follows by induction that for every quantifier free qt l    formula   every w  w and
every d  d we have
 m  w      d 

iff

 m    hw  di       

therefore  for every basic q formula x  x  and every w  w    m  w     x  x  iff
 m    w     eq        it follows by induction that  m    w         
   

ficombining spatial and temporal logics  expressiveness vs  complexity

   suppose that  is satisfied in a tt model based on f   hw   i  by lemma c    i  
is satisfied in an aleksandrov tt model m   hf  g  vi  where g   hv  ri is a disjoint
union of brooms  denote by v   v the set of leaves of g and define a first order temporal
model m    hf  v    ii by taking  for each w  w  


ff
i w 
i w 
i w    v    p         
and
pi
  v pi   w   v   


clearly  for every x  v   we have ig x  v    cg x  v    x  v    where tg   hv  ig i is
the topological space induced by g  so we obtain by induction that for every quantifier free
qt l    formula   all w  w and all d  v 
 m    w      d 

iff

 m  hw  di       

a regular closed set x  v in tg coincides with v iff it contains v    so  for all basic
q formulas x  x  and all w  w    m    w     x  x  iff  m  w     eq        it follows
by induction that  is satisfied in m   
q
proof of theorem       lower bound  by lemmas c   and c   the satisfiability problem for qt l    formulas in first order temporal models with finite domains and based on
hn   i  hz   i or arbitrary finite flows of time is polynomially reducible to satisfiability of pt l   brcc   formulas in tt models with fsa  since the former is known to
be expspace hard  hodkinson et al         for hn   i and hz   i  the latter is also
expspace hard in these cases  it should be noted that the result of hodkinson and
his colleagues        can readily be extended to the case of arbitrary finite flows of time
 by reduction of a finite version of the corridor tiling problem   this gives us the lower
complexity bound for pt l   brcc   in the case of finite flows of time 
q
c   pspace complete spatio temporal logic
in this appendix we prove theorem      in fact  we show that the satisfiability problem for
pt l  rc   an extension of pt l  rcc  is decidable in pspace  where rc   is the
sublanguage of s u with spatial terms  restricted to the following 
 

    cip 



     



    i 



      t  

 

i  
 

  
 

  t  

 

 t  

as before  we denote by  spatial terms representing regular closed sets  regions  and by
 those representing regular open sets  the interiors of regions   clearly  this definition is
equivalent to the definition on p       where we did not make an explicit distinction between
 and    it is easy to see that rc   contains rcc    but is less expressive than brcc   
spatio temporal terms  of pt l  rc   are constructed from region terms of the form
 

   

cip

 

ci 

in the same way as spatial terms of rc     finally  pt l  rc    formulas are composed from
  using the booleans and the temporal operators 
atomic formulas of the form  
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

we will reduce the satisfiability problem for pt lrc   to that for pt l  this reduction
will be done in a number steps 
let f   hw   i be a flow of time  as in the formulation of theorem      and  a
pt l  rc    formula  we begin by removing the next time operator from the subterms of  
to this end  let      and for each variable p from the set
 

 

 p   cicip  term     

we introduce a fresh spatial variable p    and then put
 

  
  cicip  cip     
       
  
 
 

 
p f
p 

where   is the result of replacing each occurrence of cicip in   with cip  and
    t      next  for each p from
   
    t       
 
 
 
 
 
        stands for  
 

 

 p   cicip  term     

we introduce a fresh spatial variable p    and set
 
 
       
  
p  f

 


  cicip  cip     
 

p   

where   is the result of replacing each occurrence of cicip in   with cip    by repeating
this process sufficiently many times we can obtain a formula
 

  
  cicip  cip     
 
 

 
    

e    
  
p f
p

where  is a suitable set of spatial variables  and  contains no  in region terms  that
is   is a pt l rc     formula   note that  is such that if a spatial variable p occurs in
 then either cicip 
  term  or p      it should be clear that the length of 
e is
linear in the length of   and  is satisfiable in a tt model based on f iff 
e is satisfiable in
a tt model based on f 
thus  it suffices to reduce the satisfiability problem for pt l  rc    formulas of the
form      to the satisfiability problem for pt l formulas  let us now recall the function
 from appendix b   which maps pt l s u   formulas  in particular  pt l rc     formulas 
    let   
      p   where p
to pt l formulas  namely  for every atomic rc    formula  

 is
a fresh propositional variable  then  given the pt l rc     formula    define  to be the
  in it with   
     
result of replacing every occurrence of  
as is shown in the proof of
theorem       is satisfiable in a tt model over f   hw   i iff
 s   there exists a temporal model n   hf  ui satisfying  and 
 s   for every w  w   the set
     n  w     p     term       
     n  w     p     term   
w     
    





of rc    formulas is satisfiable 
   

ficombining spatial and temporal logics  expressiveness vs  complexity

to preserve satisfiability of not only  but the whole  
e we have to ensure somehow that
 s   the points satisfying w do have predecessors and successors satisfying w  and
w     respectively 
in the remainder of the appendix we first describe an encoding of the satisfiability
problem for sets of rc    formulas of the form      in boolean logic  which will be used as
part of our final reduction  then we prove a completion property of rc    cf  balbiani  
condotta        in the class of exhaustive models that contain sufficiently many points of
every type  roughly  the completion property says that  given a set  of the form      and
an exhaustive model satisfying some subset of   one can extend the valuation of the model
to satisfy the whole   this property will make it possible to solve problem  s   above  it is
worth noting that a similar construction works for stronger languages such as brcc    but
then  to enjoy the completion property  sets      may need exponentially many formulas  in
the number of spatial variables  and  therefore  the reduction to pt l will be exponential
as well  for rc   it suffices to consider sets      with a quadratic number of formulas  which
results in a quadratic reduction 
c     properties of rc    formulas
for any finite set     p            pn   of spatial variables  let

 

atfm  
 
   is an rc    term with variables from   
clearly  every rc    formula with spatial variables from  is a boolean combination of spatial
formulas from atfm   it should be also clear that  atfm             
as the width of rc    formulas is     see p      for the definition   by lemmas a   and
c    ii   an rc    formula is satisfiable iff it is satisfiable in an aleksandrov topological model
based on a disjoint union of   brooms  alias forks  in what follows we will regard every such
model m as a disjoint union of fork models m   hf  vi  where f   hw  ri  w    x    x    x    
r is the reflexive closure of  hx    x  i  hx    x  i  and v a valuation of the spatial variables 
given      we say that fork models m    hf  v  i and m    hf  v  i are    equivalent and
write m    m    if v   cip    v   cip  for every p     
given some   atfm and   atfm   we say that  is an f consequence of  and
write    f  if m     implies m     for every fork model m based on f   is said to be
closed  under
f consequences  if  for
   we have    whenever    f  

  every   atfm
c
    
   atfm
let c    
     then    is satisfiable iff  is closed and satisfiable 
this means  in particular  that to check whether the set w in      is satisfiable  it is enough
     n  w     p     term   
to consider only the closure of   

now we characterise   f in terms of the boolean consequence relation     as we know
from appendix c    spatial formulas can be embedded into the one variable fragment of
first order logic  more precisely  it can easily be shown that first order translations of
formulas from atfm are  equivalent to  formulas of the form  which are actually krom
formulas  see  e g   borger  gradel    gurevich        
 
  
 
  
   t        x       
  
 x         
 
 
 
 
 
  
 
  
   t        x       
  
 x         
 
 
 
 

   

    
    

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

 

  

   t        x       
  
 
 
 
 

 

  

 x       

 

  

 x       

 
  
 x              

where


i 

 
pji  x  
if    cipj  
 
pji  x   if    icipj

and 

i 

 
pji  x  
if    icipj  
 
pji  x   if    cipj  

for i        

it follows from the proof of lemma c   that an rc    formula  is satisfied in an aleksandrov
  is satisfied in
model m based on a disjoint union of forks iff its first order

 translation
ff 
 
 
 
 
a first order model where every fork f   hw  ri of m  w   x   x   x   x rx  and x  rx   
is encoded by a domain element df with pji  x  being true on df iff  m  xi      cipj   for
i         see fig       since in the definition of closed sets we only consider aleksandrov
models based on a single fork f  the domains of respective first order models contain a single
element df   this means that          can be encoded by the boolean formulas
 
 
      
 
 
 
 
   t      
  
            
 
 
 
 
 
 
   t      
  
           
 
 
 

 

   t      
  
    
 
 





 

 

    



 
 
      



where
 
qji  
if    cipj  
  
qji   if    icipj
i

 
qji  
if    icipj  
  
qji   if    cipj  
i

and

for i        

thus  with every   atfm we can associate the conjunction  of the   translations of
formulas in  such that the following holds 
claim c    for every   atfm      f 

iff

       

to construct the closure of   atfm and to check whether  is satisfiable  we can
use the following resolution like inference rules 
  

  

   t   
 
 

  i  t   
 
 

   

   t   
 
 
 

 
 

 
 



    t  


  

  i  t   
 
 
    t   
 
 

   


t    

   t   
 
 
 

   

    t   
 
 
  i  t   
 
 


 

         i  
for
            


   i       i  

together with the equivalences 
     
 i  
 

     
 i  
 

    t       
  i  t    
 
 
 

    t       
  i  t    
 
 
 

where     cip for some p      and   are of the form   or i   and   and   of the form
i  or    it is readily checked that the above rules are sound  and so if  is derivable from  
then  is not satisfiable  on the other hand  if  is not satisfiable then  can be regarded
   

ficombining spatial and temporal logics  expressiveness vs  complexity

as an unsatisfiable set of binary and unary propositional clauses and  using the standard
resolution procedure  one can construct a derivation of the empty clause from  which 
in turn  can be mimicked by applications of the above rules  and equivalences  to derive
 from   moreover  since the propositional resolution is subsumption complete  see  e g  
slagle  chang    lee         we can also derive all consequences of   thereby obtaining its
closure 
now we encode the above rules and equivalences as boolean formulas with variables p  
   atfm   for instance     and    are encoded by
for  



    
 
   t   
   t      
  i  t      
 

and
 
 
 
 
 
 
respectively  denote by  the conjunction of all such formulas for spatial variables from
  then we have the following 
claim c    for every   atfm    is closed and satisfiable iff the boolean formula
h  
i
 
p
p 
    
 
  atfm 
 


  
 

is satisfiable 
finally  to ensure  s    we need the following completion property of rc    
lemma c     let  be a closed subset of atfm       and       atfm    then
 i    is closed and  ii  for every fork model m    if m       then there is a fork model m
such that m    m and m     
proof  claim  i  is clear  to show  ii   we define the characteristic formula  of m  on  
by taking 
 
 
qji   if  m    xi       cipj  


  
lji
and
lji  
qji  
if  m    xi      cipj  
p    i    
j

 

if m       then it follows immediately from the definitions that     is satisfiable  our
aim is to show that    is also satisfiable  which would mean that there is a fork model
m as required  suppose otherwise  then       we can regard  as a set of unary and
   according
binary clauses and  as a clause with         literals lji   the negations of the lji
to the subsumption theorem  slagle et al          by applying the standard resolution rule
to    we can derive a clause lj  i   lj  i  which subsumes   i e   its both literals occur in
   since  is closed  we have lj  i   lj  i  among the clauses of  and as the ljk ik are the
i
 k  translations of spatial terms for spatial variables from     we conclude that lj  i   lj  i 
is indeed among the clauses of     contrary to     being satisfiable 
q
c     the polynomial translation of pt l  rc   into pt l
now we are in a position to define a polynomial  at most quadratic  translation  of
pt l  rc   into pt l  starting with a given formula   we construct the pt l  rc   formula 
e of the form      
 

  
  cicip  cip     

e    
  
  
p  f
p

   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

where  is a pt l rc     formula  let      p    p     and let  denote the smallest
set of spatial variables containing     and all spatial variables occurring in    given

   atfm
    the formula from atfm  
 
   denote by  
 obtained from   by replacing
 
 
every occurrence of p   with p     consider the pt l formula


 





 
  
p   f 



 
  
p  f

 



 


   
       
  

  atfm
 


lemma c     for every pt l  rc    formula   
e is satisfiable in a tt model based on
f   hw   i iff  is satisfiable in a temporal model based on f 
proof     let  m  w        
e construct a temporal model n   hf  vi by taking  for

   atfm  
    
v p      w  w    m  w      
it is easy to see that  n  w         
   let  n  w        for some w   w   for every w  w   set
   atfm
w     
    n  w     p   

let w   for w  w   be a set of all non  equivalent fork models m with m    w   by
claim c    the w are closed and satisfiable  so the sets w are nonempty  we use the
elements of the w as building blocks for exhaustive states in the tt model we are going to
construct in order to satisfy  
first we show that each element of w has a successor in w   and a predecessor in
w   provided that w has a successor and predecessor  respectively   more precisely  we
say that a pair of fork models m   hf  vi and m    hf  v  i is suitable and write m  m  if
v cip      v   cip   for every p    
 succ  let m  w   m   hf  vi  and let w  w have a successor w      by the third
conjunct of    we have
w  atfm 

 

     atfm  
  
    n  w     p    

 

     atfm  
  
    n  w         p   

therefore 
w    atfm

 

   atfm
  
    n  w     p     

now  by m  w   we have m    w  atfm    so if we define a fork model m    hf  v  i by
taking v   p    v p     for all p    and arbitrary otherwise   then m     w    atfm
follows  since w   is closed  by lemma c     we can find a fork model m     hf  v   i such
that m    m  and m      w     it follows that m  m   and m   is  equivalent to some
fork model in w    i e   we may assume that m    w     
 pred   similarly  for every m  m   m   hf  vi  and every w  w with a predecessor
w     there is m     hf  v   i such that m    w  and m    m 
it should be clear that for every fork model m  w and every w  w   we can define a
function rm w that gives for each u  w a fork model rm w  u   u such that rm w  w    m
   

ficombining spatial and temporal logics  expressiveness vs  complexity

and rm w  u   rm w  u       whenever u     is a successor of u  let  be the set of all such
functions rm w   for w  w and m  w  
we are now ready to define an aleksandrov tt model m   hf  g  vi satisfying  
e let
g   hw  ri be a disjoint union of    many forks fr   hwr   rr i  wr    x r   x r   x r    x r rr x r
and x r rr x r   for each r    and let v p  w     xir  w    r w   xir      cip   for all p  
and w  w   we show by induction on the construction of   sub  that  for every w  w  
 m  w     

iff

 n  w       

    suppose that  m  w      
  but  n  w      p   then  
 
case     
  w and  since

    it follows that
w is closed  by claim c   and  being true at w   we have w    f  
    and so there is r   such that r w    m 
there is a fork model m  w with m     
    conversely  if  n  w     p

contrary to  m  w      
 then  by construction   m  w        
the cases of the booleans and temporal operators are trivial 
as the second conjunct of 
e is satisfied by construction  we obtain  m  w        
e
q

references
aiello  m     van benthem  j       a   logical patterns in space  in barker plummer 
d   beaver  d  i   van benthem  j     scotto di luzio  p   eds    words  proofs and
diagrams  pp       csli publications  stanford 
aiello  m     van benthem  j       b   a modal walk through space  journal of applied
non classical logics                  
alexandroff  p          diskrete raume  matematicheskii sbornik                 
allen  j          maintaining knowledge about temporal intervals  communications of the
acm             
areces  c   blackburn  p     marx  m          the computational complexity of hybrid
temporal logics  logic journal of the igpl            
arhangelskii  a     collins  p          on submaximal spaces  topology and its applications             
asher  n     vieu  l          toward a geometry of common sense  a semantics and a
complete axiomatization of mereotopology  in mellish  c   ed    proceedings of the
  th international joint conference on artificial intelligence  ijcai      pp     
     morgan kaufmann 
balbiani  p     condotta  j  f          computational complexity of propositional linear
temporal logics based on qualitative spatial or temporal reasoning  in armando  a 
 ed    proceedings of frontiers of combining systems  frocos        vol       of
lecture notes in computer science  pp          springer 
balbiani  p   tinchev  t     vakarelov  d          modal logics for region based theories of
space  manuscript 
bennett  b          spatial reasoning with propositional logic  in proceedings of the  th
international conference on knowledge representation and reasoning  pp       
morgan kaufmann 
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

bennett  b          modal logics for qualitative spatial reasoning  logic journal of the
igpl          
bennett  b     cohn  a          multi dimensional multi modal logics as a framework
for spatio temporal reasoning  in proceedings of the hot topics in spatio temporal
reasoning workshop  ijcai     stockholm 
bennett  b   cohn  a   wolter  f     zakharyschev  m          multi dimensional modal
logic as a framework for spatio temporal reasoning  applied intelligence             
blackburn  p          fine grained theories of time  in aurnague  m   borillo  a   borillo 
m     bras  m   eds    proceedings of the  th european workshop on semantics of
time  space  and movement and spatio temporal reasoning  pp          chateau
de bonas  france  groupe langue  raisonnement  calcul  toulouse 
borger  e   gradel  e     gurevich  y          the classical decision problem  perspectives
in mathematical logic  springer 
bourbaki  n          general topology  part    hermann  paris and addison wesley 
chagrov  a     zakharyaschev  m          modal logic  vol     of oxford logic guides 
clarendon press  oxford 
chlebus  b          domino tiling games  journal of computer and system sciences     
       
clarke  b          a calculus of individuals based on connection  notre dame journal of
formal logic             
clarke  b          individuals and points  notre dame journal of formal logic           
clarke  e     emerson  e          design and synthesis of synchronisation skeletons using
branching time temporal logic  in kozen  d   ed    logic of programs  vol      of
lecture notes in computer science  pp        springer 
clementini  e   di felice  p     hernandez  d          qualitative representation of positional information  artificial intelligence             
cohn  a          qualitative spatial representation and reasoning techniques  in brewka 
g   habel  c     nebel  b   eds    ki     advances in artificial intelligence  vol      
of lecture notes in computer science  pp       springer 
davis  e          representations of commonsense knowledge  morgan kaufmann 
degtyarev  a   fisher  m     konev  b          monodic temporal resolution  in baader 
f   ed    proceedings of the   th international conference on automated deduction  cade      vol       of lecture notes in artificial intelligence  pp         
springer 
demri  s     dsouza  d          an automata theoretic approach to constraint ltl  in
agrawal  m     seth  a   eds    proceedings of the   nd conference on foundations
of software technology and theoretical computer science  fst tcs        vol      
of lecture notes in computer science  pp          springer 
egenhofer  m     franzosa  r          point set topological spatial relations  international
journal of geographical information systems            
   

ficombining spatial and temporal logics  expressiveness vs  complexity

egenhofer  m     herring  j          categorizing topological relationships between regions 
lines and points in geographic databases  tech  rep   university of maine 
egenhofer  m     sharma  j          assessing the consistency of complete and incomplete
topological information  geographical systems          
emerson  e     halpern  j          decision procedures and expressiveness in the temporal
logic of branching time  journal of computer and system sciences          
fine  k          logics containing k   part i  journal of symbolic logic             
finger  m     gabbay  d          adding a temporal dimension to a logic system  journal
of logic  language and information            
fisher  m   dixon  c     peim  m          clausal temporal resolution  acm transactions
on computational logic  tocl           
gabbay  d   hodkinson  i     reynolds  m          temporal logic  mathematical foundations and computational aspects  volume    oxford university press 
galton  a     meathrel  r          qualitative outline theory  in dean  t   ed    proceedings
of the   th international joint conference on artificial intelligence  ijcai      pp 
          morgan kaufmann 
gerevini  a     nebel  b          qualitative spatio temporal reasoning with rcc   and allens interval calculus  computational complexity  in proceedings of the   th european
conference on artificial intelligence  ecai     pp          ios press 
gerevini  a     renz  j          combining topological and size constraints for spatial
reasoning  artificial intelligence           
godel  k          eine interpretation des intuitionistischen aussagenkalkuls  ergebnisse
eines mathematischen kolloquiums          
goldblatt  r          metamathematics of modal logic  part i  reports on mathematical
logic          
goranko  v     passy  s          using the universal modality  gains and questions  journal
of logic and computation         
gotts  n          an axiomatic approach to topology for spatial information systems  tech 
rep         school of computer studies  university of leeds 
halpern  j     shoham  y          a propositional modal logic of time intervals  in proceedings of the  st annual ieee symposium on logic in computer science  lics    
pp          ieee computer society 
halpern  j     vardi  m          the complexity of reasoning about knowledge and time i 
lower bounds  journal of computer and system sciences             
hodkinson  i          complexity of monodic packed fragment over linear and real time  to
appear in annals of pure and applied logic  available at http   www doc ic ac uk 
  imh papers cxmonlin pdf 
hodkinson  i   kontchakov  r   kurucz  a   wolter  f     zakharyaschev  m          on
the computational complexity of decidable fragments of first order linear temporal
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

logics  in reynolds  m     sattar  a   eds    proceedings of time ictl       pp 
      ieee computer society 
hodkinson  i   wolter  f     zakharyaschev  m          decidable fragments of first order
temporal logics  annals of pure and applied logic             
hodkinson  i   wolter  f     zakharyaschev  m          monodic fragments of first order
temporal logics           a d  in nieuwenhuis  r     voronkov  a   eds    logic
for programming  artificial intelligence and reasoning  vol       of lecture notes in
artificial intelligence  pp       springer 
hodkinson  i   wolter  f     zakharyaschev  m          decidable and undecidable fragments of first order branching temporal logics  in proceedings of the   th annual
ieee symposium on logic in computer science  lics        pp          ieee
computer society 
hughes  g     cresswell  m          a new introduction to modal logic  methuen  london 
hustadt  u     konev  b          trp        a temporal resolution prover  in baader 
f   ed    proceedings of the   th international conference on automated deduction
 cade      vol       of lecture notes in computer science  pp          springer 
kontchakov  r   lutz  c   wolter  f     zakharyaschev  m          temporalising tableaux 
studia logica            
kutz  o   sturm  h   suzuki  n  y   wolter  f     zakharyaschev  m          logics of
metric spaces  acm transactions on computational logic            
ladner  r          the computational complexity of provability in systems of modal logic 
siam journal on computing            
lemon  o     pratt  i          on the incompleteness of modal logics of space  advancing complete modal logics of place  in kracht  m   de rijke  m   wansing  h    
zakharyaschev  m   eds    advances in modal logic  volume    pp          csli
publications  stanford 
lewis  c     langford  c          symbolic logic  appleton century crofts  new york 
ligozat  g          reasoning about cardinal directions  journal of visual languages and
computing          
manna  z     pnueli  a          the temporal logic of reactive and concurrent systems 
springer 
mckinsey  j          a solution of the decision problem for the lewis systems s  and s  
with an application to topology  journal of symbolic logic            
mckinsey  j     tarski  a          the algebra of topology  annals of mathematics     
       
muller  p       a   a qualitative theory of motion based on spatio temporal primitives 
in cohn  a   schubert  l     shapiro  s   eds    proceedings of the  th international
conference on principles of knowledge representation and reasoning  kr     pp 
        morgan kaufmann 
   

ficombining spatial and temporal logics  expressiveness vs  complexity

muller  p       b   space time as a primitive for space and motion  in guarino  n   ed   
proceedings of the international conference on formal ontology in information systems  fois     vol     of frontiers in artificial intelligence and applications  pp 
      ios press 
nebel  b     burckert  h          reasoning about relations  a maximal tractable subclass
of allens interval algebra  journal of the acm           
nebel  b          artificial intelligence  a computational perspective  in brewka  g   ed   
principles of knowledge representation  pp          csli publications 
nutt  w          on the translation of qualitative spatial reasoning problems into modal
logics  in burgard  w   christaller  t     cremers  a   eds    advances in artificial intelligence  proceedings of the   rd annual german conference on artificial
intelligence  ki     vol       of lecture notes in computer science  pp         
springer 
ono  h     nakamura  a          on the size of refutation kripke models for some linear
modal and tense logics  studia logica             
orlov  i          the calculus of compatibility of propositions  mathematics of the ussr 
sbornik               in russian  
post  e          a variant of a recursively unsolvable problem  bulletin of the ams     
       
pratt hartmann  i          a topological constraint language with component counting 
journal of applied non classical logics             
randell  d   cui  z     cohn  a          a spatial logic based on regions and connection 
in nebel  b   rich  c     swartout  w   eds    proceedings of the  rd international
conference on principles of knowledge representation and reasoning  kr     pp 
        morgan kaufmann 
renz  j          a canonical model of the region connection calculus  in cohn  a   schubert 
l     shapiro  s   eds    proceedings of the  th international conference on principles of knowledge representation and reasoning  kr     pp          morgan
kaufmann 
renz  j     nebel  b          spatial reasoning with topological information  in freksa  c  
habel  c     wender  k   eds    spatial cognitionan interdisciplinary approach
to representation and processing of spatial knowledge  vol       of lecture notes in
computer science  pp          springer 
renz  j     nebel  b          on the complexity of qualitative spatial reasoning  artificial
intelligence             
renz  j          a canonical model of the region connection calculus  journal of applied
non classical logics             
renz  j     nebel  b          efficient methods for qualitative spatial reasoning  journal
of artificial intelligence research             
reynolds  m          the complexity of the temporal logic with until over general linear
time  journal of computer and system science             
   

figabelaia  kontchakov  kurucz  wolter    zakharyaschev

reynolds  m          the complexity of the temporal logic over the reals  submitted 
available at http   www csse uwa edu au  mark research online cort htm 
schwendimann  s          a new one pass tableau calculus for pltl  in de swart  h   ed   
proceedings of the international conference on automated reasoning with analytic
tableaux and related methods  tableaux      vol       of lecture notes in artificial intelligence  pp          springer 
sistla  a     clarke  e          the complexity of propositional linear temporal logics 
journal of the association for computing machinery             
sistla  a     german  s          reasoning with many processes  in proceedings of the
second ieee symposium on logic in computer science  lics     pp          ieee
computer society 
slagle  j   chang  c  l     lee  r          completeness theorems for semantic resolution
in consequence finding  in proceedings of the  st international joint conference on
artificial intelligence  ijcai     pp          william kaufmann 
smith  t     park  k          an algebraic approach to spatial reasoning  international
journal of geographical information systems            
stockmeyer  l          the complexity of decision problems in automata theory and
logic  ph d  thesis  mit 
stockmeyer  l          classifying the computational complexity of problems  journal of
symbolic logic          
stone  m          application of the theory of boolean rings to general topology  transactions of the ams             
tarski  a          der aussagenkalkul und die topologie  fundamenta mathematicae     
       
tsao chen  t          algebraic postulates and a geometric interpretation of the lewis
calculus of strict implication  bulletin of the ams             
van benthem  j          temporal logic  in gabbay  d   hogger  c     robinson  j   eds   
handbook of logic in artificial intelligence and logic programming  vol     pp     
     oxford scientific publishers 
van emde boas  p          the convenience of tilings  in sorbi  a   ed    complexity  logic
and recursion theory  vol      of lecture notes in pure and applied mathematics 
pp          marcel dekker inc 
wolper  p          the tableau method for temporal logic  an overview  logique et analyse 
           
wolter  f          properties of tense logics  mathematical logic quarterly             
wolter  f     zakharyaschev  m       a   spatial reasoning in rcc   with boolean region
terms  in horn  w   ed    proceedings of the   th european conference on artificial
intelligence  ecai        pp          ios press 
wolter  f     zakharyaschev  m       b   spatio temporal representation and reasoning
based on rcc    in cohn  a   giunchiglia  f     seltman  b   eds    proceedings of
   

ficombining spatial and temporal logics  expressiveness vs  complexity

the  th conference on principles of knowledge representation and reasoning  kr
       pp       morgan kaufmann 
wolter  f     zakharyaschev  m          qualitative spatio temporal representation and
reasoning  a computational perspective  in lakemeyer  g     nebel  b   eds    exploring artificial intelligence in the new millenium  pp          morgan kaufmann 
zimmermann  k          measuring without measures  the delta calculus  in frank  a    
kuhn  w   eds    proceedings of the  nd international conference on spatial information theory  cosit   vol      of lecture notes in computer science  pp       
springer 

   

fi