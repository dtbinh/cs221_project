journal artificial intelligence research                  

submitted       published      

research note

finding path harder finding tree

christopher meek

meek microsoft com

microsoft research 
redmond  wa            usa

abstract

consider problem learning optimal path graphical model data show
problem np hard maximum likelihood minimum description length
approaches bayesian approach  hardness result holds despite fact
problem restriction polynomially solvable problem finding optimal tree
graphical model 
   introduction

problem learning graphical models received much attention within artificial intelligence community  graphical models used represent approximate joint
distributions sets variables graphical structure graphical model represents dependencies among set variables  goal learning graphical model
learn graphical structure parameters approximate joint distribution data  note  present negative hardness result learning optimal
path graphical models 
path graphical models interesting class graphical models respect learning  due fact that  many situations  restricting attention class path
models justified basis physical constraints temporal relationships among
variables  one example problem identifying relative positions loci
segment dna  e g   boehnke  lange   cox         addition  one might interested
obtaining total order set variables purposes visualization
 e g     hellerstein        
main positive results hardness learning graphical models learning
tree graphical models  presented maximum likelihood  ml  criterion
 edmonds        chow   liu        adapted bayesian criterion heckerman 
geiger    chickering         two np hardness results learning graphical models
appeared literature  np hardness finding optimal bayesian
network structure in degree greater equal two using bayesian optimality
criterion  chickering        problem finding ml optimal polytree  dasgupta 
      
note  present proof hardness finding optimal path graphical
models maximum likelihood  ml  criterion  minimum description length  mdl 
criterion  bayesian scoring criterion  unlike ml hardness result dasgupta 
provide explicit construction polynomial sized data set reduction and  unlike
bayesian hardness result chickering         use common  uninformative  prior 

c      ai access foundation morgan kaufmann publishers  rights reserved 

fimeek

   optimal graphical models

one primary goals learning graphical model obtain approximate joint
distribution set variables data  note  focus directed graphical
models set discrete variables fx            x g  one component directed graphical
model directed graphical structure describes dependencies variables 
directed graphical model represents family distributions factor according
graphical structure g directed graphical model  specifically 
n

p  x            x    
g

n

p  x jpa
n

  



g

 x   




pa  x   denotes possibly empty set parents vertex x graph g 
subscript g omitted clear context  common methods guiding
choice distribution family distributions maximum likelihood estimation
bayesian estimation  given graphical structure set cases variables
 also prior distribution distributions case bayesian approach  
methods provide approximate joint distribution  details graphical models
estimation see heckerman        
leaves open question one choose appropriate graphical structure  remainder section  present maximum likelihood  ml  criterion 
minimum discrimination length  mdl  criterion  bayesian criterion evaluating
directed graphical models given set cases d  value variable x denoted
x value set variables pa x   denoted pa x    number cases
x   x pa x     pa x   denoted n  x   pa x    total number
cases denoted n  
one important property common scoring criteria scores factor according graphical structure model  is  score graph g data
set written sum local scores variables
g





















score g  d   





x localscore x   pa x    






local score variable x function counts x pa x  
data set number possible assignments variables x pa x    thus
structure graphical model determines particular variables counts
needed computation local score variable 
log maximum likelihood scoring criterion graphical model


score

ml

x localscore

 g  d   

ml









 x   pa x   






localscore

ml

 x   pa x      n h  x jpa x   










   

h  x jpa x    empirical conditional entropy x given parents 
equal
n  x   pa x    n  x   pa x   
log
 
n
n  pa x   
   






x













xi  pa xi

   

fifinding path harder finding tree

one practical shortcoming ml score comparing two models graphical
structure g g  g contains proper subset edges g  ml score
never favor g  thus  using ml score choose among models without restricting
class graphical structures  fully connected structure guaranteed maximal
score  problematic due potential poor generalization error using
resulting approximation  problem often called overfitting  using principle
best restrict class alternative structures consideration suitable
manner 
minimum description length score viewed penalized version ml
score

score

dl

 g  d    score

log n

 g  d 

x localscore
ml

 

 

dl

 g  d 



localscore

dl

 x   pa x     




  pa x       x  
 

localscore



ml

p



   log n

   

     pa x       x         y   used denote number possible
distinct assignments set variables number assignments empty
set variables           penalty term leads parsimonious models  thus 
alleviating overfitting problem described above 
finally  bayesian score requires prior alternative models and  model 
prior distributions  commonly used family priors directed graphical models described cooper   herskovits         approach  one assumes uniform
prior alternative graphs  p  g        uninformative  prior distributions 
assumptions lead following scoring function 




score



bayes

 g  d    log p  djg    log p  g 
 
localscore
 x   pa x   

x

bayes







localscore

bayes

 x   pa x     


log





 

pa xi

   x      
   
x
 
     n  pa x     
 






n  x   pa x    




   

xi

although apparent mdl score  bayesian score built in
tendency parsimony alleviates problems overfitting  hardness results
presented extended variety alternative types priors including
bde prior empty prior model  see heckerman et al        
problem finding optimal directed graphical model given class structures g data problem finding structure g   g maximizes score g  d  
   

fimeek

   np hardness finding optimal paths

section  consider problem finding optimal directed graphical model
class structures restricted paths  directed graphical structure
path one vertex in degree zero vertices in degree one 
show problem finding optimal path directed graphical model np hard
commonly used scoring functions described section    demonstrate hardness
finding optimal paths problem needs formulated decision problem 
decision problem version finding optimal path directed graphical model follows
optimal path  op  decision problem  path graphical model
score greater equal k data set d 
section prove following theorem 
theorem   optimal path problem np hard maximum likelihood score 
minimum description length score bayesian score 

prove this  reduce hamiltonian path  hp  decision problem op decision
problem 
hamiltonian path  hp  decision problem  hamiltonian path
undirected graph g 
hamiltonian path undirected graph g non repeating sequence vertices
vertex g occurs path pair adjacent vertices
sequence edge g  let undirected graph g   hv  e vertex set
v   fx            x g edge set e  
hp decision problem np complete  loosely speaking  means hp
decision problem computationally dicult variety problems known
algorithm exists runs time polynomial function size input 
theorem   indicates op decision problem least dicult np complete
problem  information hp decision problem np completeness see
garey   johnson        
reduce hp decision problem g op decision problem constructing
set cases following properties 
n

  x       x  


 i 

j

localscore x        localscore x       

 ii 

localscore x   fx g    fff  g

 iii 





j

ff fi

j

localscore x   fx g    localscore x   fx g 

 iv 

localscore x   fx g    iff fx   x

 v 

j







j



   

j

j

g e

fifinding path harder finding tree

data set  problem existence hamiltonian path equivalent
existence path graphical model score equal k      jv j   
jv j   n number vertices undirected graph g  thus  reduce
hp problem op problem one needs eciently construct polynomial sized data
set properties  words  construction  general hp decision
problem transformed op decision problem  size input
op problem polynomial function size input hp problem 
one find algorithm solve op problem polynomial time np complete
problems solved polynomial time 
construct data set graph g assuming variable ternary satisfy
condition  i   pair vertices x x  i   j   edge g 
add following   cases every variable x  k    i  j   zero 


j

k

x        x
     
     
     
     
     
     
     
     



 

x x          x
 
     
 
     
 
     
 
     
 
     
 
     
 
     
 
     




j

 

x

j

 
 
 
 
 
 
 
 

x          x
     
     
     
     
     
     
     
     
j

n

pair vertices x x  i   j   edge g  add
following   cases 


j

x        x
     
     
     
     
     
     
     
     



 

x x          x
 
     
 
     
 
     
 
     
 
     
 
     
 
     
 
     




j

 

x

j

 
 
 
 
 
 
 
 

x          x
     
     
     
     
     
     
     
     
j

n

set cases constructed described above  pairwise counts pair variables
x x connected edge g


j

x



x

j

 
 
 
    n   n        n      n   
 
  n   
 
 
  n   
 
 
 
   

fimeek

pairwise counts pair variables x x connected edge g


j

x



x

j

 
 
 
    n   n        n      n   
 
  n   
 
 
 
  n   
 
 

condition  ii  satisfied marginal counts variable identical 
two types pairwise count tables  thus  two values given type
pairwise localscore  using two pairwise count tables equations         
one easily verify local scores two tables satisfy condition  iii   follows
symmetry two types pairwise tables condition  ii  condition  iv 
satisfied  follows construction condition  v  satisfied  furthermore 
set cases eciently constructed size polynomially bounded
size graph g proving result 
   conclusion

note  show problem finding optimal path graphical models nphard variety common learning approaches  negative result learning optimal
path graphical models stands contrast positive result learning tree graphical
models  hardness result highlights one potential source hardness  is 
one make easy problem dicult choosing inappropriate subclass models 
perhaps  carefully choosing broader class models tree graphical models one
identify interesting classes graphical models problem finding optimal
model tractable 
another interesting class graphical models described note class
undirected graphical models  e g   lauritzen         methods learning undirected
graphical models closely related methods described section    fact 
case undirected path models  scoring formulas described section   identical
common approaches  therefore  np hardness result directed path
models presented note applies problem learning undirected path models 
finally  important note good heuristics exist problem finding
weighted hamiltonian paths  karp   held         heuristics used identify
good quality path models rely fact optimal tree model easily
found score least large path model 
references

boehnke  m   lange  k     cox  d          statistical methods multipoint radiation
hybrid mapping  american journal human genetics                
chickering  d          learning bayesian networks np complete  fisher  d     lenz 
h   eds    learning data  pp           springer verlag 
chow  c     liu  c          approximating discrete probability distributions dependence trees  ieee transactions information theory              
   

fifinding path harder finding tree

cooper  g     herskovits  e          bayesian method induction probabilistic
networks data  machine learning             
dasgupta  s          learning polytrees  proceedings fifteenth conference
uncertainty artificial intelligence  stockholm  sweden  pp           morgan kaufmann 
edmonds  j          optimum branching  j  res  nbs    b          
garey  m     johnson  d          computers intractability  guide theory
np completeness  w h  freeman  new york 
heckerman  d          tutorial learning bayesian networks  jordan  m   ed   
learning graphical models  pp           kluwer academic publishers 
heckerman  d   geiger  d     chickering  d          learning bayesian networks 
combination knowledge statistical data  machine learning              
karp  r     held  m          traveling salesman problem minimum spanning trees 
part ii  mathematical programming          
lauritzen  s          graphical models  oxford university press 
ma  s     hellerstein  j          ordering categorical data improve visualization 
proceedings ieee symposium information visualization  pp        

   


