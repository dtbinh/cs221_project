journal of artificial intelligence research                  

submitted       published     

structured knowledge representation for image retrieval
eugenio di sciascio
francesco m  donini
marina mongiello

disciascio poliba it
donini poliba it
mongiello poliba it

dipartimento di elettrotecnica ed elettronica  politecnico di bari
via re david             bari italy

abstract
we propose a structured approach to the problem of retrieval of images by content and
present a description logic that has been devised for the semantic indexing and retrieval of
images containing complex objects 
as other approaches do  we start from low level features extracted with image analysis
to detect and characterize regions in an image  however  in contrast with feature based approaches  we provide a syntax to describe segmented regions as basic objects and complex
objects as compositions of basic ones  then we introduce a companion extensional semantics for defining reasoning services  such as retrieval  classification  and subsumption  these
services can be used for both exact and approximate matching  using similarity measures 
using our logical approach as a formal specification  we implemented a complete clientserver image retrieval system  which allows a user to pose both queries by sketch and queries
by example  a set of experiments has been carried out on a testbed of images to assess the
retrieval capabilities of the system in comparison with expert users ranking  results are
presented adopting a well established measure of quality borrowed from textual information
retrieval 

   introduction
image retrieval is the problem of selecting  from a repository of images  those images fulfilling to the maximum extent some criterion specified by an end user  in this paper  we
concentrate on content based image retrieval  in which criteria express properties of the
appearance of the image itself  i e   on its pictorial characteristics 
most of the research in this field has till now concentrated in devising suitable techniques
for extracting relevant cues with the aid of image analysis algorithms  current systems result
effective when the specified properties are so called low level characteristics  such as color
distribution  or texture  for example  systems such as ibms qbic  can easily retrieve 
among others  stamps containing the picture of a brown horse in a green field  when asked
to retrieve images of stamps with brown central area over a greenish background 
nevertheless  present systems fail at treating correctly high level characteristics of an
image  such as  retrieve stamps with a galloping horse  first of all  most systems cannot
even allow the user to specify such queries  because they lack a language for expressing highlevel features  usually  this is overcome with the help of examples  retrieve images similar
to this one  however  examples are quite ambiguous to interpret  which are the features
   see e g   http   wwwqbic almaden ibm com cgi bin stamps demo
c
    
ai access foundation and morgan kaufmann publishers  all rights reserved 

fidi sciascio  donini   mongiello

in the example that should appear in retrieved images  this ambiguity produces a lot of
false positives  as any one can experience 
even if relevant features are pointed out in the example  the system cannot tell whether
what is pointed out is the color distribution  or its interpretation  after all  a galloping
brown horse produces a color distribution which is more similar to a running brown fox than
to a galloping white horse  in this aspect  image retrieval faces the same problems of object
recognition  which is a central problem in robotics and artificial vision  the only effective
solution overcoming this problem is to associate to a query some significant keywords  which
should match keywords attached in some way to images in the repository  here ambiguities
in image understanding are just transferred to text understanding  as now a brown portrait
of crazy horse  the famous indian chief  could be considered relevant 
resorting to human experts to specify the expected output of a retrieval algorithm can 
in our opinion  only worsen these ambiguities  since it makes the correctness of an approach
to depend from a subjective perception of what an image retrieval system should do  what
is needed is a formal  high level specification of the image retrieval task  this need motivates
the research we report here 
    contributions of the paper
we approach the problem of image retrieval from a knowledge representation perspective 
and in particular  we refer to a framework already successfully applied by woods and
schmolze        to conceptual modeling and semantic data models in databases  calvanese 
lenzerini    nardi         we consider image retrieval as a knowledge representation
problem  in which we can distinguish the following aspects 
interface  the user is given a simple visual language to specify  by sketch or by example 
a geometric composition of basic shapes  which we call description  the composite shape
description intuitively stands for a set of images  all containing the given shapes in their
relative positions   it can be used either as a query  or as an index for a relevant class of
images  to be given some meaningful name 
syntax and semantics  the system has an internal syntax to represent the users
queries and descriptions  and the syntax is given an extensional semantics in terms of sets
of retrievable images  in contrast with existing image retrieval systems  our semantics is
compositional  in the sense that adding details to the sketch may only restrict the set of
retrievable images  syntax and semantics constitute a semantic data model  in which the
relative position  orientation and size of each shape component are given an explicit notation through a geometric transformation  the extensional semantics allows us to define
a hierarchy of composite shape descriptions  based on set containment between interpretations of descriptions  coherently  the recognition of a shape description in an image is
defined as an interpretation satisfying the description 
algorithms and complexity  based on the semantics  we prove that subsumption
between descriptions can be carried out in terms of recognition  then we devise exact and
approximate algorithms for composite shapes recognition in an image  which are correct with
respect to the semantics  ideally  if the computational complexity of the problem of retrieval
was known  the algorithms should also be optimal with reference to the computational
complexity of the problems  presently  we solved the problem for exact retrieval  and
   

fistructured knowledge representation for image retrieval

propose an algorithm for approximate retrieval which  although probably non optimal  is
correct 
experiments  while the study of the complexity of the problem is ongoing  the syntax 
semantics  and sub optimal algorithms obtained so far are already sufficient to provide the
formal specification of a prototype system for the experimental verification of our approach 
the prototype has been used to carry out a set of experiments on a test database of images 
which allowed us to verify the effectiveness of the proposed approach in comparison with
expert users ranking 
we believe that a knowledge representation approach brings several benefits to research
in image retrieval  first of all  it separates the problem of finding an intuitive semantics for
query languages in image retrieval from the problem of implementing a correct algorithm
for a given semantics  secondly  once the problem of image retrieval is semantically formalized  results and techniques from computational geometry can be exploited in assessing
the computational complexity of the formalized retrieval problem  and in devising efficient
algorithms  mostly for the approximate image retrieval problem  this is very much in the
same spirit as finite model theory has been used in the study of complexity of query answering for relational databases  chandra   harel         third  our language borrows from
object modeling in computer graphics the hierarchical organization of classes of images
 foley  van dam  feiner    hughes         this  in addition to an interpretation of composite shapes which one can immediately visualize  opens our logical approach to retrieval of
images of  d objects constructed in a geometric language  paquet   rioux         which is
still to be explored  fourth  our logical formalization  although simple  allows for extensions
which are natural in logic  such as disjunction  or  of components  although alternative
components of a complex shape are difficult to be shown in a sketch  they could be used
to specify moving  i e   non rigid  parts of a composite shape  this exemplifies how our
logical approach can shed light to extensions of our syntax suitable for  e g   video sequence
retrieval 
    outline of the paper
the rest of the paper is organized as follows  in the next section  we review related work
on image retrieval  in section   we describe our formal language  first its syntax  then its
semantics  and we start proving some basic properties  in the following section  we analyze
the reasoning problems and the semantic relations among them  and we devise algorithms
that can solve them  then in section   we illustrate the architecture of our system and
propose some examples pointing out distinguishing aspects of our approach  in section  
we present a set of experiments to assess retrieval capabilities of the system  last section
draws the conclusions and proposes directions for future work 

   related work
content based image retrieval  cbir  has recently become a widely investigated research
area  several systems and approaches have been proposed  here we briefly report on some
significant examples and categorize them in three main research directions 
   

fidi sciascio  donini   mongiello

    feature based approaches
largest part of research on cbir has focused on low level features such as color  texture 
shape  which can be extracted using image processing algorithms and used to characterize
an image in some feature space for subsequent indexing and similarity retrieval  in this
way the problem of retrieving images with homogeneous content is substituted with the
problem of retrieving images visually close to a target one  hirata   kato        niblak
et al         picard   kabir        jacobs  finkelstein    salesin        flickner et al  
      bach  fuller  gupta  hampapur  horowitz  humphrey  jain    shu        celentano
  di sciascio        cox  miller  minka    papathomas        gevers   smeulders        
among the various projects  particularly interesting is the qbic system  niblak et al  
      flickner et al          often cited as the ancestor of all other cbir systems  which
allows queries to be performed on shape  texture  color  by example and by sketch using as
target media both images and shots within videos  the system is currently embedded as a
tool in a commercial product  ultimedia manager  later versions have introduced an
automated foreground background segmentation scheme  here the indexing of an image is
made on the principal shape  with the aid of some heuristics  this is an evident limitation 
most images do not have a main shape  and objects are often composed of various parts 
other researchers  rather than concentrating on a main shape  which is typically assumed located in the central part of the picture  have proposed to index regions in images 
so that the focus is not on retrieval of similar images  but of similar regions within an
image  examples of this idea are visualseek  smith   chang         netra  ma
  manjunath        and blobworld  carson  thomas  belongie  hellerstein    malik 
       the problem is that although all these systems index regions  they lack of a higher
level description of images  hence  they are not able to describe  and hence query for 
more than a single region at a time in an image 
in order to improve retrieval performances  much attention has been paid in recent
years to relevance feedback  relevance feedback is the mechanism  widely used in textual
information systems  which allows improving retrieval effectiveness by incorporating the
user in the query retrieval loop  depending on the initial query the system retrieves a set
of documents that the user can mark either as relevant or irrelevant  the system  based on
the user preferences  refines the initial query retrieving a new set of documents that should
be closer to the users information need 
this issue is particularly relevant in feature based approaches  as on one hand  the user
lacks of a language to express in a powerful way her information need  but on the other
hand  deciding whether an image is relevant or not takes just a glance  examples of systems
using relevance feedback include mars  rui  huang    mehrotra         drawsearch
 di sciascio   mongiello        and pichunter  cox et al         
    approaches based on spatial constraints
this type of approach to the problem of image retrieval concentrates on finding the similarity of images in terms of spatial relations among objects in them  usually the emphasis
is only on relative positions of objects  which are considered as symbolic images or icons 
identified with a single point in the  d space  information on the content and visual appearance of images are normally neglected 
   

fistructured knowledge representation for image retrieval

chang  shi  and yan        present the modeling of this type of images in terms of
 d strings  each of the strings accounting for the position of icons along one of the two
planar dimensions  in this approach retrieval of images basically reverts to simpler string
matching 
gudivada and raghavan        consider the objects in a symbolic image associated
with vertexes in a weighted graph  edges  i e   lines connecting the centroids of a pair of
objects  represent the spatial relationships among the objects and are associated with a
weight depending on their slope  the symbolic image is represented as an edge list  given
the edge lists of a query and a database image  a similarity function computes the degree of
closeness between the two lists as a measure of the matching between the two spatial graphs 
the similarity measure depends on the number of edges and on the comparison between
the orientation and slope of edges in the two spatial graphs  the algorithm is robust with
respect to scale and translation variants in the sense that it assigns the highest similarity to
an image that is a scale or translation variant of the query image  an extended algorithm
includes also rotational variants of the original images 
more recent papers on the topic include those by gudivada        and by el kwae
and kabuka         which basically propose extensions of the strings approach for efficient
retrieval of subsets of icons  gudivada        defines r strings  a logical representation of
an image  such representation also provides a geometry based approach to iconic indexing
based on spatial relationships between the iconic objects in an image individuated by their
centroid coordinates  translation  rotation and scale variant images and the variants generated by an arbitrary composition of these three geometric transformations are considered 
the approach does not deal with object shapes  nor with other basic image features  and
considers only the sequence of the names of the objects  the concatenation of the objects is
based on the euclidean distance of the domain objects in the image starting from a reference
point  the similarity between a database and a query image is obtained through a spatial
similarity algorithm that measures the degree of similarity between a query and a database
image by comparing the similarity between their r strings  the algorithm recognizes rotation  scale and translation variants of the image and also subimages  as subsets of the
domain objects  a constraint limiting the practical use of this approach is the assumption
that an image can contain at most one instance of each icon or object 
el kwae and kabuka        propose a further extension of the spatial graph approach 
which includes both the topological and directional constraints  the topological extension of
the objects can be obviously useful in determining further differences between images that
might be considered similar by a directional algorithm that considers only the locations
of objects in term of their centroids  the similarity algorithm they propose extends the
graph matching one previously described by gudivada and raghavan         the similarity
between two images is based on three factors  the number of common objects  the directional
and topological spatial constraint between the objects  the similarity measure includes the
number of objects  the number of common objects and a function that determines the
topological difference between corresponding objects pairs in the query and in the database
image  the algorithm retains the properties of the original approach  including its invariance
to scaling  rotation and translation and is also able to recognize multiple rotation variants 
   

fidi sciascio  donini   mongiello

    logic based and structured approaches
with reference to previous work on vision in artificial intelligence  the use of structural
descriptions of objects for the recognition of their images can be dated back to minskys
frames  and some work by brooks         the idea is to associate parts of an object  and
generally of a scene  to the regions an image can be segmented into  the hierarchical
organization of knowledge to be used in the recognition of an object was first proposed by
marr         reiter and mackworth        proposed a formalism to reason about maps as
sketched diagrams  in their approach  the possible relative positions of lines are fixed and
highly qualitative  touching  intersecting  
structured descriptions of three dimensional images are already present in languages
for virtual reality like vrml  hartman   wernecke        or hierarchical object modeling  however  the semantics of such languages is operational  and no effort is made to
automatically classify objects with respect to the structure of their appearance 
meghini  sebastiani  and straccia        proposed a formalism integrating description
logics and image and text retrieval  while haarslev  lutz  and moeller        integrate
description logics with spatial reasoning  further extensions of the approach are described
by moeller  neumann  and wessel         both proposals build on the clean integration of
description logics and concrete domains of baader and hanschke         however  neither
of the formalisms can be used to build complex shapes by nesting more simple shapes 
moreover  the proposal by haarslev et al         is based on the logic of spatial relations
named rcc   which is enough for specifying meaningful relations in a map  but it is too
qualitative to specify the relative sizes and positions of regions in a complex shape 
also for hacid and rigotti        description logics and concrete domains are at the
basis of a logical framework for image databases aimed at reasoning on query containment 
unfortunately  the proposed formalism cannot consider geometric transformations neither
determine specific arrangements of shapes 
more similar to our approach is the proposal by ardizzone  chella  and gaglio        
where parts of a complex shape are described with a description logic  however  the composition of shapes does not consider their positions  hence reasoning cannot take positions
into account 
relative position of parts of a complex shape can be expressed in a constraint relational
calculus in the work by bertino and catania         however  reasoning about queries
 containment and emptiness  is not considered in this approach  aiello        proposes a
multi modal logic  which provides a formalism for expressing topological properties and for
defining a distance measure among patterns 
spatial relation between parts of medical tomographic images are considered by tagare 
vos  jaffe  and duncan         there  medical images are formed by the intersection of the
image plane and an object  as the image plane changes  different parts of the object are
considered  besides  a metric for arrangements is formulated by expressing arrangements
in terms of the voronoi diagram of the parts  the approach is limited to medical image
databases and does not provide geometrical constraints 
compositions of parts of an image are considered in the work by sanfeliu and fu
       for character recognition  however  in recognizing characters  line compositions
are closed  in the sense that one looks for the specified lines  and no more  instead in our
   

fistructured knowledge representation for image retrieval

framework  the shape f composed by three lines  is subsumed by the shape   something unacceptable in recognizing characters  apart from the different task  this approach
does not make use of an extensional semantics for composite shapes  hence no reasoning is
possible 
a logic based multimedia retrieval system was proposed by fuhr  govert  and rolleke
        the method  based on an object oriented logic  supports aggregated objects but it
is oriented towards a high level semantic indexing  which neglects low level features that
characterize images and parts of them 
in the field of computation theories of recognition  we mention two approaches that have
some resemblance to our own  biedermans structural decomposition and geometric constraints proposed by ullman  both described by edelmann         unfortunately  neither of
them appears suitable for realistic image retrieval  the structural decomposition approach
does not consider geometric constraints between shapes  while the approach based on geometric constraints does not consider the possibility of defining structural decomposition of
shapes  hence reasoning on them 
starting with the reasonable assumption that the recognition of an object in a scene
can be eased by previous knowledge on the context  in the work by pirri and finzi        
the recognition task  or the interpretation of an image  takes advantage of the information
a cognitive agent has about the environment  and by the representation of these data in a
high level formalism 

   syntax and semantics
in this section we present the formalism dealing with the definition of composite shape descriptions  their semantics  and some properties that distinguish our approach from previous
ones 
we remark that our formalism deals with image features  like shape  color  texture  but
is independent of the way features are extracted from actual images  for the interested
reader  the algorithms we used to compute image features in our implementation of the
formalism are presented in the appendix 
    syntax
our main syntactic objects are basic shapes  position of shapes  composite shape descriptions  and transformations  we also take into account the other features that typically
determine the visual appearance of an image  namely color and texture 
basic shapes are denoted with the letter b  and have an edge contour e b  characterizing
them  we assume that e b  is described as a single  closed  d curve in a space whose origin
coincides with the centroid of b  examples of basic shapes can be circle  rectangle  with
the contours e circle      e rectangle   
  but also any complete  rough contour
 e g   the one of a ship  is a basic shape  to make our language compositional  we
consider only the external contour of a region  for example  if a region is contained in
another  as in    the contour of the outer region is just the external rectangle 
the possible transformations are the simple ones that are present in any drawing tool 
rotation  around the centroid of the shape   scaling and translation  we globally denote a
   

fidi sciascio  donini   mongiello

figure    the graphical interface with a query by sketch 
rotation translation scaling transformation as    recall that transformations can be composed in sequences          n   and they form a mathematical group 
the basic building block of our syntax is a basic shape component hc  t    bi  which
represents a region with color c  texture t  and edge contour   e b    with   e b   we
denote the pointwise transformation  of the whole contour of b  for example   could
specify to place the contour e b  in the upper left corner of the image  scaled by     and
rotated    degrees clockwise 
composite shape descriptions are conjunctions of basic shape components  each one
with its own color and texture  denoted as
c   hc    t        b  i u    u hcn   tn   n   bn i
we do not expect end users of our system to actually define composite shapes with this
syntax  this is just the internal representation of a composite shape  the system can
maintain it while the user draws  with the help of a graphic tool  the complex shape by
dragging  rotating and scaling basic shapes chosen either from a palette  or from existing
images  see figure    
for example  the composite shape lighted candle could be defined as
lighted candle   hc    t        rectanglei u hc    t        circlei
   

fistructured knowledge representation for image retrieval

with       placing the circle as a flame on top of the candle  and textures and colors defined
accordingly to the intuition 
we remark that  to the best of our knowledge  the logic we present is the first one
combining shapes and explicit transformations in one language 
in a previous paper  di sciascio  donini    mongiello        we presented a formalism
including nested composite shapes  as it is done in hierarchical object modeling  foley et al  
      ch     however  nested composite shapes can always be flattened by composing their
transformations  hence in this paper we focus on two levels  basic shapes and compositions
of basic shapes  also  just to simplify the presentation of the semantics  in the following
section we do not present color and texture features  which we take into account from
section     on 
    semantics
we consider an extensional semantics  in which syntactic expressions are interpreted as
subsets of a domain  for our setting  the domain of interpretation is a set of images   and
shapes and components are interpreted as subsets of   hence  also an image database is
a domain of interpretation  and a complex shape c is a subset of such a domain  the
images to be retrieved from the database when c is viewed as a query 
this approach is quite different from previous logical approaches to image retrieval that
view the image database as a set of facts  or logical assertions  e g   the one based on
description logics by meghini et al          in that setting  image retrieval amounts to
logical inference  however  observe that usually a domain closure assumption  reiter 
      is made for image databases  there are no regions but the ones which can be seen in
the images themselves  this allows one to consider the problem of image retrieval as simple
model checking  check if a given structure satisfies a description   
formally  an interpretation is a pair  i     where  is a set of images  and i is a
mapping from shapes and components to subsets of   we identify each image i with the
set of regions  r           rn   it can be segmented into  excluding background  which we discuss
at the end of this section   each region r comes with its own edge contour e r   an image
i   belongs to the interpretation of a basic shape component h  bii if i contains a
region whose contour matches   e b    in formulae 
h  bii    i     r  i   e r      e b   

   

the above definition is only for exact recognition of shape components in images  due to
the presence of strict equality in the comparison of contours  but it can be extended to
approximate recognition as follows  recall that the characteristic function f s of a set s is a
function whose value is either   or    fs  x      if x  s  fs  x      otherwise  we consider
now the characteristic function of the set defined in formula      let i be an image  if i
belongs to h  bii   then the characteristic function computed on i has value    otherwise
it has value    to keep the number of symbols low  we use the expression h  bii also to
   obviously  a domain closure assumption on regions is not valid in artificial vision  dealing with twodimensional images of three dimensional shapes  and scenes   because solid shapes have surfaces that
will be hidden in their images  but this is outside the scope of our retrieval problem 

   

fidi sciascio  donini   mongiello

denote the characteristic function  with an argument  i  to distinguish it from the set  
i

h  bi  i   

 

  if r  i   e r      e b  
 
otherwise

now we reformulate this function in order to make it return a real number in the range       
 as usual in fuzzy logic  zadeh         let sim     be a similarity measure from pairs of
contours into the range        of real numbers  where   is perfect matching   we use sim    
instead of equality to compare edge contours  moreover  the existential quantification can
be replaced by a maximum over all possible regions in i  then  the characteristic function
for the approximate recognition in an image i of a basic component  is 
h  bii  i    max sim e r     e b    
ri

note that sim depends on translations  rotation and scaling  since we are looking for regions
in i whose contour matches e b   with reference to the position and size specified by   
the interpretation of basic shapes  instead  includes a translation rotation scaling invariant recognition  which is commonly used in single shape image retrieval  we define the
interpretation of a basic shape as
b i    i      r  i   e r      e b   
and its approximate counterpart as the function
b i  i    max max sim e r     e b    


ri

the maximization over all possible transformations max can be effectively computed by
using a similarity measure simss that is invariant with reference to translation rotationscaling  see section       similarity of color and texture will be added as a weighted sum
in section      in this way  a basic shape b can be used as a query to retrieve all images
from  which are in b i   therefore  our approach generalizes the more usual approaches
for single shape retrieval  such as blobworld  carson et al         
composite shape descriptions are interpreted as sets of images that contain all components of the composite shape  components can be anywhere in the image  as long as
they are in the described arrangement relative to each other  let c be a composite shape
description h    b  i u    u hn   bn i  in exact matching  the interpretation is the intersection
of the sets interpreting each component of the shape 
c i    i        i  ni   h   i    bi ii  

   

observe that we require all shape components of c to be transformed into image regions
using the same transformation    this preserves the arrangement of the shape components
relative to each other  given by each i  while allowing c i to include every image
containing a group of regions in the right arrangement  wholly displaced by   
to clarify this formula  consider figure    the shape c is composed by two basic shapes
b  and b    suitably arranged by the transformations   and     suppose now that 
contains the image i  then  i  c i because there exists the transformation    which
   

fistructured knowledge representation for image retrieval

figure    an example of application of formula     
globally brings c into i  that is      brings the rectangle b  into a rectangle recognized
in i  and     brings the circle b  into a circle recognized in i  both arranged according
to c  note that i could contain also other shapes  not included in c 
we can now formally define the recognition of a shape in an image 
definition    recognition  a shape description c is recognized in an image i if for
every interpretation  i    such that i    it is i  c i   an interpretation  i    satisfies
a composite shape description c if there exists an image i   such that c is recognized in
i  a composite shape description is satisfiable if there exists an interpretation satisfying it 
observe that shape descriptions could be unsatisfiable  if two components define overlapping
regions  no image can be segmented in a way that satisfies both components  of course  if
composite shape descriptions are built using a graphical tool  unsatisfiability can be easily
avoided  so we assume that descriptions are always satisfiable  anyway  unsatisfiable shape
descriptions could be easily detected  from their syntactic form  since unsatisfiability can
only arise because of overlapping regions  see proposition    
observe also that our set based semantics implies the intuitive interpretation of conjunction u  one could easily prove that u is commutative and idempotent 
for approximate matching  we modify definition      following the fuzzy interpretation
of u as minimum  and existential as maximum 
n

c i  i    max  min  h   i    bi ii  i   


i  

   

observe that our interpretation of composite shape descriptions strictly requires the presence of all components  in fact  the measure by which an image i belongs to the interpreta   

fidi sciascio  donini   mongiello

tion of a composite shape description c i is dominated by the least similar shape component
 the one with the minimum similarity   hence  if a basic shape component is very dissimilar
from every region in i  this brings near to    also the measure of c i  i   this is more strict
than  e g   gudivada   raghavans        or el kwae   kabukas        approaches  in
which a non appearing component can decrease the similarity value of c i  i   but i can be
still above a threshold 
although this requirement may seem a strict one  it captures the way details are used
to refine a query  the dominant shapes are used first  and  if the retrieved set is still too
large  the user adds details to restrict the results  in this refinement process  it should not
happen that other images that match only some new details  pop up enlarging the set of
results that the user was trying to restrict  we formalize this refinement process through
the following definition 
proposition    downward refinement  let c be a composite shape description  and
 
let d be a refinement of c  that is d   c u h     b   i  for every interpretation i  if shapes
are interpreted as in      then d i  c i   if shapes are interpreted as in      then for every
image i it holds d i  i   c i  i  
proof  for      the claim follows from the fact that d i considers an intersection of the same
components as the one of c i   plus the set h         b   ii   for      the claim analogously
follows from the fact that d i  i  computes a minimum over a superset of the values considered for c i  i  

the above property makes our language fully compositional  namely  let c be a composite shape description  we can consider the meaning of c  when used as a query  as
the set of images that can be potentially retrieved using c  at least  this will be the meaning perceived by an end user of a system  downward refinement ensures that the meaning
of c can be obtained by starting with one component  and then progressively adding other
components in any order  we remark that for other frameworks cited above  gudivada  
raghavan        el kwae   kabuka        this property does not hold  we illustrate the
problem in figure    starting with shape description c  we may retrieve  among many
others  the two images i    i    for which both c i  i    and c i  i    are above a threshold t 
while another image i  is not in the set because c i  i      t  in order to be more selective  we try adding details  and we obtain the shape description d  using d  we may still
retrieve i    and discard i    however  i  now partially matches the new details of d  if
downward refinement holds  d i  i     c i  i      t  and i  cannot pop up  in contrast 
if downward refinement does not hold  as in gudivada   raghavans approach  it can be
di  i      t   c i  i    because matched details in d raise the similarity sum weighted over
all components  in this case  the meaning of a sketch cannot be defined in terms of its
components 
downward refinement is a property linking syntax to semantics  thanks to the extensional semantics  it can be extended to an even more meaningful semantic relation  namely 
   not exactly    since every shape matches every other one with a very low similarity measure  similarity
is often computed as the inverse of a distance  similarity   would correspond to infinite distance 
nevertheless  the recognition algorithm can force the similarity to   when it is below a threshold 

   

fistructured knowledge representation for image retrieval

figure    downward refinement  the thin arrows denote non zero similarity in approximate
recognition  the thick arrow denotes a refinement 

   

fidi sciascio  donini   mongiello

figure    an example of subsumption hierarchy of shapes  thick arrows   and images in
which the shapes can be recognized  thin arrows  

subsumption  we borrow this definition from description logics  donini  lenzerini  nardi 
  schaerf         and its fuzzy extensions  yen        straccia        
definition    subsumption  a description c subsumes a description d if for every
interpretation i  d i  c i   if     is used  c subsumes d if for every interpretation i and
image i    it is d i  i   c i  i  
subsumption takes into account the fact that a description might contain a syntactic variant
of another  without both the user and the system explicitly knowing this fact  the notion
of subsumption extends downward refinement  it enables also a hierarchy of shape descriptions  in which a description d is below another c if d is subsumed by c  when c and
d are used as queries  the subsumption hierarchy makes easy to detect query containment 
containment can be used to speed up retrieval  all images retrieved using d as a query can
be immediately retrieved also when c is used as a query  without recomputing similarities 
while query containment is important in standard databases  ullman         it becomes
even more important in an image retrieval setting  since the recognition of specific features
in an image can be computationally demanding 
figure   illustrates an example of subsumption hierarchy of basic and composite shapes
 thick arrows denote a subsumption between shapes   and two images in which shapes can
be recognized  thin arrows  
although we did not consider a background  it could be added to our framework as a
special basic component hc  t    backgroundi with the property that a region b satisfies the
   

fistructured knowledge representation for image retrieval

background simply if their colors and textures match  with no check on the edge contours 
also  more than one background could be added  in that case background regions should
not overlap  and the matching of background regions should be considered after the regions
of all the basic shapes recognized are subtracted to the background regions 

   reasoning and retrieval
we envisage several reasoning services that can be carried out in a logic for image retrieval 
   shape recognition  given an image i and a shape description d  decide if d is recognized in i 
   image retrieval  given a database of images and a shape description d  retrieve all
images in which d can be recognized 
   image classification  given an image i and a collection of descriptions d             dn   find
which descriptions can be recognized in i  in practice  i is classified by finding the
most specific descriptions  with reference to subsumption  it satisfies  observe that
classification is a way of preprocessing recognition 
   description subsumption  and classification   given a  new  description d and a collection of descriptions d            dn   decide whether d subsumes  or is subsumed by 
each di   for i              n 
while services    are standard in an image retrieval system  services    are less obvious 
and we briefly discuss them below 
the process of image retrieval is quite expensive  and systems usually perform off line
processing of data  amortizing its cost over several queries to be answered on line  as an
example  all document retrieval systems for the web    both for images and text  use spiders
to crawl the web and extract some relevant features  e g   color distributions and textures
in images  keywords in texts   that are used to classify documents  then  the answering
process uses such classified  extracted features of documents  and not the original data 
our system can adapt this setting to composite shapes  too  in our system  a new
image inserted in the database is immediately segmented and classified in accordance with
the basic shapes that compose it  and the composite descriptions it satisfies  service     also
a query undergoes the same classification  with reference to the queries already answered
 service     the more basic shapes are present  the faster will the system answer new
queries based on these shapes 
more formally  given a query  shape description  d  if there exists a collection of descriptions d            dn and all images in the database were already classified with reference
to d            dn   then it may suffice to classify d with reference to d            dn to find  most
of  the images satisfying d  this is the usual way in which classification in description
logics  which amounts to a semantic indexing  can help query answering  nebel        
for example  to answer the query asking for images containing an arch  a system may
classify arch and find that it subsumes threeportalsgate  see figure     then  the system
   e g   altavista  qbic  netra  blobworld  but also yahoo  for textual documents  

   

fidi sciascio  donini   mongiello

can include in the answer all images in which ancient roman gates can be recognized 
without recomputing whether these images contain an arch or not 
the problem of computing subsumption between descriptions is reduced to recognition
in the next section  and then an algorithm for exact recognition is given  then  we extend
the algorithm to realistic approximate recognition  reconsidering color and texture 
    exact reasoning on images and descriptions
we start with a reformulation of      more suited for computational purposes 
theorem    recognition as mapping  let c   h    b  i u    u hn   bn i be a composite
shape description  and let i be an image  segmented into regions  r            rm    then c is
recognized in i iff there exists a transformation  and an injective mapping j               n  
            m  such that for i              n it is
e rj i        i  e bi    
proof  from      c is recognized in i iff
  i 

n
 

h   i    bi ii   which is equivalent to   

i  

n
 

i  h   i    bi ii  

i  

expanding h   i    bi ii with its definition     yields
  

n
 

r  i e r      i  e bi     

i  

and since regions in i are  r           rm   this is equivalent to
  

m
n  
 

e rj       i  e bi     

i   j  

making explicit the disjunction over j and conjunctions over i  we can arrange this conjunctive formula as a matrix 




 e r           e b           e rm          e b         


  
 
  
 
 
 
 
    
 e r        n  e bn          e rm       n  e bn       

   

now we note two properties in the above matrix of equalities 
   for a given transformation  at most one region among r           rm can be equal to each
component  this means that in each row  at most one disjunct can be true for a given
 
   for a given transformation  a region can match at most one component  this means
that in each column  at most one equality can be true for a given   
   

fistructured knowledge representation for image retrieval

we observe that these properties do not imply that regions have all different shapes  since
the equality of contours depends on any translation  rotation  and scaling  we use equality
to represent true overlap  and not just equal shape 
properties    imply that the above formula is true iff there is an injective function
mapping each component to one region it matches with  to ease the comparison with the
formulae above we use the same symbol j as a mapping j               n               m   hence 
formula     can be rewritten into the claim 
  j       n       m 

n
 

e rj i        i  e bi     

   

i  

hence  even if in the previous section the semantics of a composite shape was derived from
the semantics of its components  in computing whether an image contains a composite shape
one can focus on groups of regions  one group rj              rj n  for each possible mapping j 
observe that j injective implies m  n  as one would expect  the above proposition
leaves open which one between  or j must be chosen first  in fact  in what follows we
show that the optimal choice for exact recognition is to mix decisions about j and    when
approximate recognition will be considered  however  exchanging quantifiers is not harmless 
in fact  it can change the order in which approximations are made  we return to this
issue in the next section  when we discuss how one can devise algorithms for approximate
recognition 
subsumption in this simple logic for shape descriptions relies on the composition of
contours of basic shapes  intuitively  to actually decide if d is subsumed by c  we check
if the sketch associated with d  seen as an image  would be retrieved using c as a
query  from a logical perspective  the existentially quantified regions in the semantics of
shape descriptions     are skolemized with their prototypical contours  formal definitions
follow 
definition    prototypical image  let b be a basic shape  its prototypical image is
i b     e b    let c   h    b  i u    u hn   bn i be a composite shape description  its
prototypical image is i c        e b              n  e bn     
in practice  from a composite shape description one builds its prototypical image just applying the stated transformations to its components  and color texture fillings  if present  
recall that we envisage this prototypical image to be built directly by the user  with the
help of a drawing tool  with basic shapes and colors as palette items  the system will
just keep track of the transformations corresponding to the users actions  and use them in
building the  internal  shape descriptions stored with the previous syntax  the feature that
makes our proposal different from other query by sketch retrieval systems  is precisely that
our sketches have also a logical meaning  so  properties about description sketches can be
proved  containment between query sketches can be stated in a formal way  and algorithms
for containment checking can be proved correct with reference to the semantics 
prototypical images have some important properties  the first is that they satisfy  in
the sense of definition    the shape description they exemplify  as intuition would suggest 
   

fidi sciascio  donini   mongiello

proposition   for every composite shape description d  if d is satisfiable then the interpretation hi   i d  i satisfies d 
proof  from theorem    using an identical transformation  and the identity mapping for
j 

a shape description d is satisfiable if there are no overlapping regions in i d   since
this is obvious when d is specified by a drawing tool  we just give the following proposition
for sake of completeness 
proposition   a shape description d is satisfiable iff its prototypical image i d  contains
no overlapping regions 
we now turn to subsumption  observe that if b  and b  are basic shapes  either they
are equivalent  each one subsumes the other  or neither of the two subsumes the other  if we
adopt for the segmented regions an invariant representation   e g  fourier transforms of the
contour  deciding equivalence between basic shapes  or recognizing whether a basic shape
appears in an image  is just a call to an algorithm computing the similarity between shapes 
this is what usual image recognizers do  allowing for some tolerance in the matching
of the shapes  therefore  our framework extends the retrieval of shapes made of a single
component  for which effective systems are already available 
we now consider composite shape descriptions  and prove the main property of prototypical images  namely  the fact that subsumption between shape descriptions can be
decided by checking if the subsumer can be recognized in the sketch of the subsumee 
theorem   a composite shape description c subsumes a description d if and only if c
is recognized in the prototypical image i d  
proof  let c   h    b  i u    u hn   bn i  and let d   h    a  i u    u hm   am i  recall that
i d  is defined by i d        e a              m  e am      to ease the reading  we sketch the
idea of the proof in figure   
if  suppose c is recognized in i d   that is  i d   c i for every interpretation  i   
such that i d     then  from theorem   there exists a transformation  and a suitable
injective function j from             n  into             m  such that
e rj k        k  e bk   

for k              n

since i d  is the prototypical image of d  we can substitute each region with the basic
shape of d it comes from 
j k   e aj k         k  e bk   

for k              n

   

now suppose that d is recognized in an image j    s           sp    with j    we prove that
also c is recognized in j  in fact  if d is recognized in j then there exists a transformation
 and another injective mapping q from             m  into             p  selecting from j regions
 sq              sq m    such that
e sq h        h  e ah   
   

for h              m

   

fistructured knowledge representation for image retrieval

 prototypical image of  c


s

s

s
s s
 
s s
 
s s
 
s s
 
s s 

s s
    
s s 

 
s s
 
s

 

s


 



s






  







 



m











 


prototypical image i d 



image j
figure    a sketch of the if proof of theorem  
now composing q and j  that is  selecting the regions of j satisfying those components
of d which are used to recognize c  one obtains
e sq j k         j k   e aj k    

for k              n

   

then  substituting equals for equals from      one finally gets
e sq j k           k  e bk   

for k              n

which proves that c too is recognized in j  using    as transformation of its components 
and q j    as injective mapping from             n  into             p   since j is a generic image 
it follows that d i  c i   since  i    is generic too  c subsumes d 
only if  the reverse direction is easier  suppose c subsumes d  by definition  this
amounts to d i  c i for every collection of images i  for every i that contains i d   then
i d   d i for proposition    therefore  i d   c i   that is  c is recognized in i d  

this property allows us to compute subsumption as recognition  so we concentrate on
complex shape recognition  using theorem    our concern is how to decide whether there
exists a transformation  and a matching j having the properties stated in theorem   
it turns out that for exact recognition  a quadratic upper bound can be attained for the
possible transformations to try 

   

fidi sciascio  donini   mongiello

theorem   let c   h    b  i u    u hn   bn i be a composite shape description  and let i
be an image  segmented into regions  r           rm    then  there are at most m m     exact
matches between the n basic shapes and the m regions  moreover  each possible match can
be verified by checking the matching of n pairs of contours 
proof  a transformation  matching exactly basic components to regions is also an
exact match for their centroids  hence we concentrate on centroids  each correspondence
between a centroid of a basic component and a centroid of a region yields two constraints
for    now  is a rigid motion with scaling  hence it has four degrees of freedom  two
degrees for translations  one for rotation  and one for uniform scaling   hence  if an exact
match  exists between the centroids of the basic components and the centroids of some of
the regions  then  is completely determined by the transformation of any two centroids of
the basic shapes into two centroids of the regions 
fixing any pair of basic components b    b    let p    p  denote their centroids  also 
let rj      rj    be the regions that correspond to b    b    and let vj      vj      denote their
centroids  there is only one transformation  solving the point equations  each one mapping
a point into another 
 
     p       vj   
     p       vj   
hence  there are only m m     such transformations  for the second claim  once a 
matching the centroids is found  one checks that the edge contours of basic components
and regions coincide  i e   that      e b        e rj            e b        e rj       and for
k              n that   k  e bk    coincides with the contour of some region e rj k    
recalling formula     in the proof of theorem    this means that we can eliminate the
outer quantifier in     using a computed    and conclude that c is recognized in i iff 
j       n       m 

n
 

e rj i        i  e bi    

i  

observe that  to prune the above search  once a  has been found as above  one can
check for k              n that   k  centr bk     coincides with a centroid of some region rj  
before checking contours 
based on theorem    we can devise the following algorithm 
algorithm recognize  c i  
input a composite shape description c   h    b  i u    u hn   bn i  and
an image i  segmented into regions r           rm
output true if c is recognized in i  false otherwise
begin
    compute the centroids v           vm of r           rm
    compute the centroids p           pn of the components of c
    for i  h              m  with i   h do
compute the transformation  such that   p      vi and   p      vh  
   

fistructured knowledge representation for image retrieval

if for every k              n 
  k  e bk     coincides  for some j  with a region rj in i
then return true
endfor
return false
end
the correctness of recognize  c i  follows directly from theorems   and    regarding
the time complexity  step     requires to compute centroids of segmented regions  several
methods for computing centroids are well known in the literature  jahne  haubecker   
geibler         hence  we abstract from this detail  and assume there exists a function
f  nh   nv   that bounds the complexity of computing one centroid  where nh   nv are the
horizontal and vertical dimensions of i  number of pixels   we report in the appendix how
we compute centroids  and concentrate on the complexity in terms of n  m  and f  n h   nv   
theorem   let c   h    b  i u    u hn   bn i be a composite shape description  and let i be
an image with nh  nv pixels  segmented into regions  r           rm    moreover  let f  nh   nv  
be a function bounding the complexity of computing the centroid of one region  then c can
be recognized in i in time o m  f  nh   nv     n   m   n  nh  nv   
proof  from the assumptions  step     can be performed in time o mf  nh   nv     instead 
step     can be accomplished by extracting the n translation vectors from the transformations            n of the components of c  therefore  it requires o n  time  finally  the
innermost check in step      checking whether a transformed basic shape and a region
coincide  can be performed in o nh  nv    using a suitable marking of pixels in i with
the region they belong to  hence  we obtain the claim 

since subsumption between two shape descriptions c and d can be reduced to recognizing c in i d   the same upper bound holds for checking subsumption between composite
shape descriptions  with the simplification that also step     can be accomplished without
any further feature level image processing 
    approximate recognition
the algorithm proposed in the previous section assumes an exact recognition  since the
target of retrieval are real images  approximate recognition is needed  we start by reconsidering the proof of theorem    and in particular the matrix of equalities      using
the semantics for approximate recognition      the expanded formula for evaluating c i  i 
becomes now the following 

max min




 max sim e r          e b       



  
 
max sim e r       n  e bn     



        sim e rm         e b          

  
  
 
 
    

sim e rm      n  e bn     

 




now properties    stated for exact recognition can be reformulated as hypotheses about
sim  as follows 
   

fidi sciascio  donini   mongiello

   for a given transformation  we assume that at most one region among r            rm is
maximally similar to each component  this assumption can be justified by supposing
its negation  if there are two regions both maximally similar to a component  then
this maximal value should be a very low one  lowering the overall value because of the
external minimization  this means that in maximizing each row  we can assume that
the maximal value is given by one index among            m 
   for a given transformation  we assume that a region can yield a maximal similarity for
at most one component  again  the rationale of this assumption is that when a region
yields a maximal similarity with two components in two different rows  this value can
be only a low one  which propagates along the overall minimum  this means that in
minimizing the maxima from all rows  we can consider a different region in each row 
we remark that also in the approximate case these assumptions do not imply that regions
have all different shapes  since sim is a similarity measure which is   only for true overlap 
not just for equal shapes with different pose  the assumptions just state that sim should
be a function near to plain equality 
the above assumptions imply that we can focus on injective mappings from     n  into
    m  also for the approximate recognition  yielding the formula
max


n

min sim e rj i       i  e bi      

max

j     n     m  i  

the choices of  and j for the two maxima are independent  hence we can consider groups
of regions first 
max

n

j     n     m 

max min sim e rj i       i  e bi      


i  

   

differently from the exact recognition  the choice of an injective mapping j does not directly
lead to a transformation    since now  depends on how the similarity of transformed shapes
is computed  that is  the choice of  depends on sim 
in giving a definition of sim  we reconsider the other image features  color  texture  that
were skipped in the theoretical part to ease the presentation of semantics  this will introduce weighted sums in the similarity measure  where weights are set by the user according
to the importance of the features in the recognition 
let sim r  hc  t    bi  be a similarity measure that takes a region r  with its color c r 
and texture t r   and a component hc  t    bi into the range        of real numbers  where  
is perfect matching   we note that color and texture similarities do not depend on transformations  hence their introduction does not change assumptions    above  accordingly 
formula     becomes
max

j     n     m 

n

max min sim rj i    hc  t     i    bi i  


i  

    

this formula suggests that from all the groups of regions in an image that might resemble
the components  we should select the groups that present the higher similarity  in artificially
constructed examples in which all shapes in i and c resemble each other  this may generate
an exponential number of groups to be tested  however  we can assume that in realistic
   

fistructured knowledge representation for image retrieval

images the similarity between shapes is selective enough to yield only a very small number
of possible groups to try  we recall that in gudivadas approach  gudivada        an
even stricter assumption is made  namely  each basic component in c does not appear
twice  and each region in i matches at most one component in c  hence our approach
extends gudivadas one  also for this aspect  besides the fact that we consider shape 
scale  rotation  color and texture of each component 
in spite of the assumptions made  finding an algorithm for computing the best 
in formula      proved for us a difficult task  the problem is that there is a continuous
spectrum of  to be searched  and that the best  may not be unique  we observed that
when only single points are to be matched  instead of regions and components  our
problem simplifies to point pattern matching in computational geometry  however  even
recent results in that research area are not complete  and cannot be directly applied to
our problem  cardoze and schulman        solve the nearly exact point matching with
efficient randomized methods  but without scaling  they also observe that best match is
a more difficult problem than nearly exact match  also chew  goodrich  huttenlocher 
kedem  kleinberg  and kravets        propose a method for best match of shapes  but
they analyze only rigid motions without scaling 
therefore  we adopt some heuristics to evaluate the above formula  first of all  we
decompose sim r  hc  t    bi  as a sum of six weighted contributions 
three contributions are independent of the pose  color  texture and shape  the values of color and texture similarity are denoted by simcolor  c r   c  and simtexture  t r   t  
respectively  similarity of the shapes  rotation translation scale invariant  is denoted by
simshape  e r   e b    for each feature  and each pair  region  component  we compute a
similarity measure as explained in the appendix  then  we assign to all similarities of a
feature  say  color  the worst similarity in the group  this yields a pessimistic estimate
of formula       however  for such estimate the downward refinement property holds  see
next theorem    
the other three contributions depend on the pose  and try to evaluate how the pose
of each region in the selected group is similar to the pose specified by the corresponding
component in the sketch  in particular  simscale  e r     e b   represents how similar in scale
are the region and the transformed component  while simrotation  e r     e b   denotes how
e r  and   e b  are similarly  or not  rotated with reference to the arrangement of the
other components  finally  simspatial  e r     e b   denotes a measure of how coincident are
the centroids of the region and the transformed component 
in summary  we get the following form for the overall similarity between a region and a
component 
sim r  hc  t    bi    simspatial  e r     e b      
simshape  e r   e b      
simcolor  c r   c     
simrotation  e r     e b      
simscale  e r     e b      
simtexture  t r   t   
   

fidi sciascio  donini   mongiello

where coefficients            weight the relevance each feature has in the overall similarity
computation  obviously  we impose                      and all coefficients are greater
or equal to    the actual values given to these coefficients in the implemented system are
reported in table   in section   
because of the difficulties in computing the best    we do not compute a maximum over
all possible  s  instead  we evaluate whether there can be a rigid transformation with scaling
from    e b              n  e bn    into rj              rj n    through similarities simspatial   simscale  
and simrotation   there is a transformation iff all these similarities are    if not  the lower
the similarities are  the less rigid the transformation should be to match components and
regions  hence  instead of formula      we evaluate the following simpler formula 
max

n

min sim rj i    hc  t  i   bi i  

j     n     m  i  

    

interpreting pose similarities in a different way  we now describe in detail how we estimate
pose similarities 
let c   hc    t        b  i  u    u hcn   tn   n   bn i   and let j be an injective function from
    n  into     m   that matches components with regions  rj              rj n    respectively 
      spatial similarity
for a given component  say  component    we compute all angles under which the other
components are seen from    formally  let i h
c be the counter clockwise oriented angle with
vertex in the centroid of component    and formed by the lines linking this centroid with
the centroids of component i and h  there are n n       such angles 
then  we compute the correspondent angles for region rj      namely  angles j i j   j h 
d
with vertex in the centroid of rj      formed by the lines linking this centroid with the
centroids of regions rj i  and rj h  respectively  a pictorial representation of the angles is
given in figure   
then we let the difference spatial  e rj          e b     be the maximal absolute difference
between correspondent angles 
spatial  e rj          e b      

max

i h       n i  h

  
  i h
d
c  j i j   j h 

we compute an analogous measure for components          n  and then we select the maximum
of such differences 
n

spatial  j    max spatial  e rj i     i  e bi    
i  

    

where the argument j highlights the fact that this measure depends on the mapping
j  finally  we transform this maximal difference  for which perfect matching yields  
 into a minimal similarity  perfect matching yields    with the help of the function  described in the appendix  this minimal similarity is then assigned to every
simspatial  e rj i     i  e bi     for i              n 
intuitively  our estimate measures the difference in the arrangement of centroids between
the composite shape and the group of regions  if there exists a transformation bringing
components into regions exactly  every difference is    and so simspatial raises to   for every
   

fistructured knowledge representation for image retrieval

f 

    

f 

f 

   

f 

f 

f 

    

f 

    

f 

f 

    

f 

    

f 

f 

f 

f 

r 

r 

f 

r 

r 

r 

r 

    
    
    
    

r 
r 

    

r 

r 

r 

r 
r 

r 

   

r 

figure    representation of angles used for computing spatial similarity of component  
and region rj     

   

fidi sciascio  donini   mongiello

r 

f 

   u

   h
   h
   h
   h

f 

u

r 

h

   u

   u

f 

   u

r 
r 

f 
r 

f 

figure    representation of angles used for computing rotation similarity of component  
and region rj     

component  the more an arrangement is scattered with reference to the other arrangement 
the higher its maximum difference  the reason why we use the maximum of all differences
as similarity for each pair component region will be clear when we prove later that this
measure obeys downward refinement property 
      rotation similarity
for every basic shape one can imagine a unit vector with origin in its centroid and oriented
horizontally on the right  as seen on the palette   when the shape is used as a component
 say  component    also this vector is rotated according to     let  h denote such a
rotated vector  for i              n let  c  the counter clockwise oriented angle with vertex in
i h
the centroid of component    and formed by  h and the line linking the centroid of component

  with the centroid of component i 
for region rj      the analogous  u of  h can be constructed by finding the rotation phase
for which cross correlation attains a maximum value  see appendix   then  for i              n
let j i j    
u and the line
d u be the angles with vertex in the centroid of rj      and formed by  
linking the centroid of rj    with the centroid of rj i    figure   clarifies the angles we are
computing 
then we let the difference rotation  e rj          e b     be the maximal absolute difference
between correspondent angles 
rotation  e rj          e b       max    c   j i j    
d u   
i       n
i h

if there is more than one orientation of rj    for which cross correlation yields a maximum 
e g   a square has four such orientations  then we compute the above maximal difference
for all such orientations  and take the best difference  the minimal one  
   

fistructured knowledge representation for image retrieval

fi

mi

ri

mi

dj
dj
rj
fj

figure    sizes and distances for scale similarity computation of component   and region
rj     

we repeat the process for components   to n  and we select the maximum of such
differences 
n

rotation  j    max rotation  e rj i     i  e bi    
i  

    

finally  as for spatial similarity  we transform rotation  j  into a minimal similarity with
the help of   this minimal similarity is then assigned to every simrotation  e rj i     i  e bi    
for i              n 
observe that also these differences drop to   when there is a perfect match  hence the
similarity raises to    the more a region has to be rotated with reference to the other
regions to match a component  the higher the rotational differences  again  the fact that
we use the worst difference to compute all rotational similarities will be exploited in the
proof of downward refinement 
      scale similarity
we concentrate again on component   to ease the presentation  let m   be the size of
component    computed as the mean distance between its centroid and points on the contour 
moreover  for i              n  let d i be the distance between the centroid of component   and
the centroid of component i  in the image  let mj    be the size of region rj i    and let
dj   j i  be the distance between centroids of regions j    and j i   figure   pictures the
quantities we are computing 
we define the difference in scale between e rj      and    e b    as 
 
 

min mj     dj   j i    m   d i   

scale  e rj          e b       max   

i       n 
max mj     dj   j i    m   d i   
   

fidi sciascio  donini   mongiello

we repeat the process for components   to n  and we select the maximum of such differences 
n

scale  j    max scale  e rj i     i  e bi    
i  

    

finally  as for the other similarities  we transform scale  j  into a minimal similarity with
the help of   this minimal similarity is then assigned to every simscale  e rj i     i  e bi    
for i              n 
      discussion of pose similarities
using the same worst difference in evaluating pose similarities of all components may appear
a somewhat drastic choice  however  we were guided in this choice by the goal of preserving
the downward refinement property  even if we had to abandon the exact recognition of the
previous section 
theorem   let c be a composite shape description  and let d be a refinement of c  that
 
is  d   c uhc    t         b   i  for every image i  segmented into regions r           rm   if c i  i  and
di  i  are computed as in      using similarities defined above  then it holds d i  i   c i  i  
proof  every injective function j used to map components of c into i can be extended to
a function j   by letting j    n                   m  be a suitable region index not in the range
of j  since d i  i  is computed over such extended mappings  it is sufficient to show that
values computed in formula      do not increase with reference to the values computed for
c 
let j  be the mapping for which the maximum value c i  i  is reached  every extension
i
j   of j  leads to a minimum value minn  
i   in formula      which is lower than c  i   in fact 
all pose differences                   are computed as maximums over a strictly greater set
of values  hence the pose similarities have either the same value  or a lower one  regarding
color  texture  and shape similarities  adding another component can only worsen the values
for components of c  since we assign to all components the worst similarity in the group 
now consider another injective mapping j  that yields a non maximum value v    c i  i 
in formula       using the above argument about pose differences                   every
extension j   leads to a minimum value v    v    since v    c i  i   also every extension of
every mapping j different from j  yields a value which is less than c i  i   this completes
the proof 

   a prototype system
in order to substantiate our ideas we have developed a prototype system  written in c   
the system is a client server application working in a ms windows environment 
the client side avails of a graphical user interface that allows one to carry out all the
operations necessary to query the knowledge base  including a canvas for query by sketch
composition using basic shapes and a module for query by example using new or existing
images as queries  the client also allows a user to insert new shape descriptions and images
in the knowledge base  the client has the logical structure shown in figure    it is made
up of three main modules  sketch  communication and configuration 
   

fistructured knowledge representation for image retrieval

figure    architecture of the prototype system 

   

fidi sciascio  donini   mongiello

figure     the process of reclassification of images when a new description is inserted  a 
before insertion of description  no      b  after insertion 

the communication module manages the communication with the server side  using
a simple application level protocol  the configuration module allows one to modify the
parameters relative to the preview of images and shapes transferred from the server and
placed in a cache managed with a fcfs policy for efficient display  the sketch module
allows a user to trace basic shapes as palette items  and properly insert and modify them
by varying the scale and rotation factor  the available shapes may be basic ones such as
ellipse  circle  rectangle  polygons or obtained by composing the basic shapes or complex
shapes defined during previous sessions of the application and inserted in the knowledge
base  but also shapes extracted from segmented images 
the system keeps track of the transformations corresponding to the users actions  and
uses them in building the  internal  shape descriptions stored with the previously described
syntax  the color and texture of the drawn shapes can be set according to the user requirements  as the client interface provides a color palette and the possibility to open images in
jpeg format with texture content  the user can also load images from the local disk and
transmit them to the server to populate the knowledge base  finally  the user can define
new objects endowing them with a textual description and insert them into the knowledge
base 
the server side  which is also shown in figure    is composed by concurrent threads
that manage the server side graphical interface  the connections and communications with
the client applications and carry out the processing required by the client side  obviously 
   

fistructured knowledge representation for image retrieval

figure     a query and the retrieved set of images 

   

fidi sciascio  donini   mongiello

the server also carries out all tasks related to the insertion of images in the knowledge base 
including segmentation  feature extraction and region indexing  and allows one to properly
set the various parameters involved  to this end  the server has three main subcomponents 
   the image features extractor that contains an image segmentation module and a region
data extraction one 
   the image classifier that is composed by a classifier module and a module used in the
image reclassification 
   the database management system 
the feature extractor segments and processes images to extract relevant features from
each detected region  which characterize the images in the knowledge base  image segmentation is carried out with an algorithm that starts with the extraction of relevant edges and
then carries out a region growing procedure that basically merges smaller regions into larger
ones according to their similarity in terms of color and texture  detected regions obviously
have to comply with some minimal heuristics  each region has associated a description of
the relevant features 
the classifier manages a graph that is used to represent and hierarchically organizes
shape descriptions  basic shapes  and more complex ones obtained by combining such elementary shapes and or by applying transformations  rotation  scaling and translation  
the basic shapes have no parents  so they are at the top of the hierarchy  images  when
inserted in the knowledge base after the segmentation process  are linked to the descriptions
in the structure depending on the most specific descriptions that they are able to satisfy 
the classifier module is invoked when a new description d has to be inserted in the
system or a new query is posed  the classifier carries out a search process in the hierarchy
to find the exact position where the new description d  a simple or a complex one  has to be
inserted  the position is determined considering the descriptions that the new description
is subsumed by  once the position has been found  the image reclassifier compares d with
the images available in the database to determine those that satisfy it  all the images that
verify the recognition algorithm are tied to d  this stage only considers the images that
are tied to descriptions that are direct ancestors of d  as outlined in figure    
as usual in description logics  also the query process consists of a description insertion 
as both a query q and a new description d are treated as prototypical images  a query
q to the system is considered a new description d and added to the hierarchical data
structure  all images that are connected either to q or to descriptions below the query in
the hierarchical structure are returned as retrieved images 
the database management module simply keeps track of images and or pointers to
images 
using the system is a straightforward task  after logon a user can draw a sketch on
the canvas combining available basic shapes  and enrich the query with color and texture
content  after that the query can be posed to the server to obtain images ranked according
to their similarity  figure    shows a query by sketch with two circles and the retrieved
set  the system correctly retrieves pictures of cars in which the two circles are recognized
in the same relative positions of the sketch and represent the wheels  but also a snow man
with black buttons 
   

fistructured knowledge representation for image retrieval

figure     downward refinement  contd    a more detailed query  picturing a car  and the
retrieved set of images 

   

fidi sciascio  donini   mongiello

figure     a subsumption example  increasing the number of objects in the query leads to
a correct reduction in the retrieved set 
   

fistructured knowledge representation for image retrieval

the introduction of more details restricts the retrieved set  adding a chassis to the
previous sketch makes the query more precise  as well as the retrieval results  as it is shown
in figure     this example points out how we expect a user will use the system  he she will
start with a generic query with a few objects  if the number of images in the retrieved set is
still too large  he she will increase the number of details obtaining a downward refinement 
notice that the presence of regions objects not included in the query is obviously accepted but not the lack of a region that was explicitly introduced in the query  the idea
underlying this approach is that there is an enormous amount of available images  and at
the current stage of research and technology no system can always ensure a complete recognition  yet we believe that the focus should be on reducing false positives  accepting without
much concern a higher ratio of false negatives  this basically means increasing precision 
even at the cost of a possibly lower recall  in other words we believe it is preferable for a
user looking for an image containing a yellow car  e g   using the sketch in figure     that
he she receives as result of the query a limited subset of images containing almost for sure
a yellow car  than a large amount of images containing cars  but also several images with
no cars at all 
subsumption is another distinguishing feature of our system  figure    shows queries
composed of basic shapes that have been obtained by segmentation of an image picturing
aircrafts  i e   the aircraft is now a basic shape for the system  here  to better emphasize
the example  only shape and position contribute to the similarity value  the process of
subsumption is clearly highlighted  a query with just a single aircraft retrieves images with
one aircraft  but also with more than one aircraft  adding other aircrafts in the graphical
query correctly reduces the retrieved set  the example also points out that the system is
able to correctly deal with the presence of more than one instance of an object in images 
which is not possible in the approaches by gudivada and raghavan        and gudivada
        on the negative side it has to be noticed that the system did not recognize the
presence of a third aircraft  indeed a strange one  the b  spirit  in the second image of
figure    b   which was not segmented at all and considered part of the background 
the ability of the system to retrieve complex objects also in images with several other
different objects  that is with no main shapes  can be anyway seen in figure     here a
real image is directly submitted as query  notice that in this case the system has to carry
out the segmentation process on the fly  and detect the composing shapes 

   experiments and results
in order to assess the performance of the proposed approach and of the system implementing
it  we have carried out an extensive set of experiments on a test dataset of images  it is
well known that evaluating performances of an image retrieval system is difficult because
of lack of ground truth measures  to ease the possibility of a comparison  we adopted the
approach first proposed by gudivada and raghavan         the experimental framework is
hence largely based on the one proposed there  which relies on a comparison of the system
performances versus the judgement of human experts 
it should be noticed that in that work test images were iconic images  which were
classified only in terms of spatial relationships between icons  in our experiments images
   

fidi sciascio  donini   mongiello

figure     a query by example and retrieved images 

   

fistructured knowledge representation for image retrieval

figure     a sample of the images used in the experiments 

   

fidi sciascio  donini   mongiello

are real and classification has been carried out on all image features  including color  texture 
shape  scale  orientation and spatial relationships 
the test data set consists of a collection of    images  a sample of them is shown in
figure     while the complete set is available at url 
http   www ictserv poliba it disciascio jair images htm 
images have been acquired using a digital camera  combining    objects  either simple
objects  i e   a single shape  or composite ones  of variable size and color  all images had
size           pixels     bits pixel  it should be noticed that actually there were more
than    different objects  but we considered very similar variants of an object  e g   two
pens with a different color  as a single test object 
we selected from the test data set    images to be used as queries  the query set formed
two logical groupings 
the first one  namely queries   through    and queries        and     had as primary
objective testing the performance of the system using as query single objects composed by
various shapes  that is  assessing the ability of the system to detect and retrieve images
containing the same object  or objects similar to the query 
the query images in the second group  remaining images in the test data set  pictured
two or more objects and they were chosen to assess the ability of the system to detect and
retrieve images according to spatial relationships existing between the objects in the query 
obviously the difference between queries containing single objects composed by several
shapes  and queries containing two or more objects  is just a cognitive one  for our system
all queries are composite shapes  however  we observed that performances changed for the
two groupings 
we then separately asked five volunteers to classify in decreasing order  according to
their judgment  the    images based on their similarity to each image of the selected query
set  the volunteers had never used the system and they were only briefly instructed that
rank orderings had to be based on the degree of conformance of the database images with
the query images  they were allowed to group images when considered equivalent  and for
each query  to discard images that were judged wholly dissimilar from the query 
having obtained five classifications  which were not univocal  we created the final ranking
merging the previous similarity rankings according to a minimum ranking criterion  the
final ranking of each image with respect to a query was determined as the minimum one
among the five available 
as an example consider the classification of query nr    which is shown in table   
notice that images grouped together in the same cell have been given the same relevance 
here image   was ranked in third position by users      and    but as users   and   ranked
it in fourth position  it was finally ranked in position four  notice that for image    the
same criterion leads to its withdrawal from ranked images  this approach limits the weight
that images badly classified by single users have on the final ranking 
then we submitted the same set of    queries to the system  whose knowledge base was
loaded only with the    images of the test set 
the behavior of the system obviously depends on the configuration parameters  which
determine the relevance of the various features involved in the similarity computation  the
configuration parameters fed to the system were experimentally determined on a test bed of
   

fistructured knowledge representation for image retrieval

user
 
 
 
 
 
final

 st
 
 
 
 
 
 

 nd
      
      
      
      
      
      

ranking
 rd
            
         
         
            
            
         

 th
  
     
     
  
     
     

 th
  

  

table    users rankings for query nr  
parameter
fourier descriptors threshold
circular symmetry threshold
spatial similarity threshold
symmetry maxima threshold
spatial similarity weight 
spatial similarity sensitivity f x
spatial similarity sensitivity f y
shape similarity weight 
shape similarity sensitivity f x
shape similarity sensitivity f y
color similarity weight 
color similarity sensitivity f x
color similarity sensitivity f y
rotation similarity weight 
rotation similarity sensitivity f x
rotation similarity sensitivity f y
texture similarity weight 
texture similarity sensitivity f x
texture similarity sensitivity f y
scale similarity weight 
scale similarity sensitivity f x
scale similarity sensitivity f y
global similarity threshold

value
    
    
    
    
    
    
    
    
     
    
    
     
    
    
    
    
    
     
    
    
    
    
    

table    configuration parameters  grouped by feature type 

approximately     images before starting the test phase  they are shown in table    the
parameters reported here are described in the appendix  notice that  dealing with welldefined objects  we gave an higher relevance to shape and spatial features and a reduced
relevance to scale  rotation  color and texture 
the resulting classification gave us what was called a system provided ranking  we then
adopted the rnorm as quality measure of the retrieval effectiveness  rnorm has been first
introduced in the live project  bollmann  jochum  reiner  weissmann    zuse       
for the evaluation of textual information retrieval systems and it has been used in the
experiments of the above referenced paper by gudivada and raghavan  to make the paper
self contained we recall here how rnorm is defined 
let g be a finite set of images with a user defined preference relation  that is complete
and transitive  let usr be the rank ordering of g induced by the user preference relation 
also  let sys be a system provided ranking  the formulation of rnorm is 
rnorm  sys    

 
s   s
     
 
 
 
smax

where s   is the number of image pairs where a better image is ranked by the system
ahead of a worse one  s  is the number of pairs where a worse image is ranked ahead of a
 
better one and smax
is the maximum possible number of s     it should be noticed that the
calculation of s     s    and s max is based on the ranking of image pairs in sys relative to
the ranking of corresponding image pairs in usr  
   

fidi sciascio  donini   mongiello

query nr 
 
 
 
 
 
 
 
 
 
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
average rnorm

image nr 
 
 
 
 
 
 
 
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

rnorm
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

table    rnorm values   indicates single object queries 

rnorm values are in the range        a value of   corresponds to a system provided
ordering of the database images that is either identical to the one provided by the human
experts or has a higher degree of resolution  lower values correspond to a proportional
disagreement between the two 
table   shows results for each query and the final average rnorm        taking a closer
look at results  for the first group of queries  single compound objects  the average value
was rnorm        and rnorm       for the second grouping  various compound objects  
 the complete set of result for users ranking and system ranking is available in the online
appendix  
as a comparison  the average rnorm resulted      in the system presented by gudivada
and raghavan         where    iconic images were used both as queries and database
images  and similarity was computed only on spatial relationships between icons  we remark
here that our system works on real images and computes similarity on several image features 
and we believe that results prove the ability of the system to catch to a good extent the
users information need  and make refined distinctions between images when searching for
composite shapes  furthermore  our algorithm is able to correctly deal with the presence
of more than one instance of an object in images  which is not possible in other approaches
 gudivada         it is also noteworthy that  though the parameters setting has been the
object of several experiments  it cannot be considered optimal yet  and we believe that there
is room for further improvement in the system performance  as it is also pointed out in the
following paragraph 
obviously the system can fail when segmentation does not provide accurate enough
results  figure    shows results for query     which was the one with the worst r norm  
here the system not only did not retrieve all images users had considered relevant  but
   

fistructured knowledge representation for image retrieval

figure     query results for query     which had the lowest rnorm       
more important wrongly confused the sugar drop with a wrist watch  which resulted in a
false positive  as a matter of fact in various images the sweet drops resulted not properly
segmented  nevertheless  highly relevant images were successfully retrieved and the wrongly
retrieved one was slightly above the selection threshold 
another observation we made was that human users  when comparing a query with a
single object  were much more driven by the color than any other feature  including the
spatial positioning  this appeared in various queries and is again clearly visible using as
example results for query     here users selected in the highest relevance class only images
with the same color sugar drop  and gave a lower ranking to images  with sugar drops  with
closer spatial relationships but different colors  this observation may be significant in the
related field of object recognition 
a final comment  with reference to the system behavior in terms of retrieval time  we
did not carry out a systematic testing  as it depends on several variables  number of images
in the database  number of objects in the query  but more important depth in the hierarchy
  as the search time decreases as more basic shapes are available  limiting our analysis
to the database loaded with the    test images  the system required on average    secs to
answer a query  on a machine with celeron     mhz cpu and     mb ram running both
the client and the server 
   

fidi sciascio  donini   mongiello

   conclusion
we proposed a knowledge representation approach to image retrieval  we started from
the observation that current sketch based image retrieval systems lack of a compositional
query language  that is  they are not able to handle queries made by several shapes  where
the position  orientation and size of the shapes relative to each other is meaningful 
to recover this  we proposed a language to describe composite shapes  and gave an
extensional semantics to queries  in terms of sets of retrieved images  to cope with a
realistic setting from the beginning  we also generalized the semantics to fuzzy membership
of an image to a description  the composition of shapes is made possible by the explicit
use in our language of geometric transformations  translation rotation scale   which we
borrow form hierarchical object modeling in computer graphics  we believe that this
is a distinguishing feature of our approach  that significantly extends standard invariant
recognition of single shapes in image retrieval  the extensional semantics allows us to
properly define subsumption  i e   containment  between queries 
borrowing also from structured knowledge representation  and in particular from description logics  we stored shape descriptions in a subsumption hierarchy  the hierarchy
provides a semantic index to the images in a database  the logical semantics allowed us
to define other reasoning services  the recognition of a shape arrangement in an image  the
classification of an image with reference to a hierarchy of descriptions  and subsumption
between descriptions  these tasks are aside  but can speed up  the main one  which is image
retrieval 
we proved that subsumption in our simple logic can be reduced to recognition  and
gave a polynomial time algorithm to perform exact recognition  then  for a realistic application of our setting we extended the algorithm to approximate recognition  weighting
shape features  orientation  size  position   color and texture 
using our logical approach as a formal specification  we built a prototype system using
state of the art technology  and set up experiments both to assess the efficacy of our proposal  and to fine tune all parameters and weights that show up in approximate retrieval 
the results of our experiments  although not exhaustive  show that our approach can catch
to a good extent the users information need and make refined distinctions between images
when searching for composite shapes 
we believe that this proposal opens at least three directions for future research  first 
the language for describing composite shapes could be enriched either with other logicoriented connectives  e g   alternative components corresponding to an or in compositions  or to sequences of shape arrangements  to cope with objects with internal movements in video sequence retrieval  second  techniques from computational geometry could
be used to optimize the algorithms for approximate retrieval  while a study in the complexity of the recognition problem for composite shapes might prove the theoretical optimality
of the algorithms  finally  large scale experiments might prove useful in understanding the
relative importance attributed by end users to the various features of a composite shape 
acknowledgements
we wish to thank our former students g  gallo  m  benedetti and l  allegretti for their
useful comments and implementations  marco aiello for comments on an earlier draft 
   

fistructured knowledge representation for image retrieval

dino guaragnella for discussions on fourier transforms  and an anonymous referee for
constructive criticism that helped us improving the paper 
this research has been supported by the european union  pop regione puglia sottomisura        sfida     by the italian ministry of education  university and research
 miur  ex murst  projects cluster   subcluster monitoraggio ambiente e territorio  workpackage  sistema informativo per il collocamento dei prodotti ortofrutticoli
pugliesi and by italian national council for research  cnr   projects laico  demand 
and metodi di ragionamento automatico nella modellazione ed analisi di dominio 

appendix a 
in this appendix we briefly revise the methods we used for the extraction of image features 
we also describe the smoothing function  and the way we compute similarity for the image
features that were introduced in section     
a   extraction of image features
in order to deal with objects in an image  segmentation is required to obtain a partition
of the image  several segmentation algorithms have been proposed in the literature  our
approach does not depend on the particular segmentation algorithm adopted  it is anyway
obvious that the better the segmentation  the better our system will work  in our system
we used a simple algorithm that merges edge detection and region growing 
illustration of this technique is beyond the scope of this paper  we limit here to the
description of image features computation  which assume a successful segmentation  to


make the description self contained we start defining a generic color image as   i  x  y      
x  nh      y  nv    where nh   nv are the horizontal and vertical dimensions  respectively 


and i  x  y  is a three components tuple  r  g  b   we assume that the image i has been
partitioned in m regions  ri    i              m satisfying the following properties 
 i 

s

 ri    i                 m

  i                 m   ri is a nonempty and connected set
 ri  rj    iff i    j
 each region satisfies heuristic and physical requirements 
we characterize each region ri with the following attributes  shape  position  size  orientation  color and texture 
shape  given a connected region a point moving along its boundary generates a complex
function defined as  z t    x t    jy t   t              nb   with nb the number of boundary
sample points  following the approach proposed by rui  she  and huang        we define
the discrete fourier transform  dft  of z t  as 
z k   

nb
x

z t e

j  tk
n
b

t  

with k              nb  
   

  m  k ej k 

fidi sciascio  donini   mongiello

in order to address the spatial discretization problem we compute the fast fourier
transform fft  of the boundary z t   use the first   nc      fft coefficients to form a
dense  non uniform set of points of the boundary as 
zdense  t   

nc
x

z k e

j  tk
n
b

k nc

with t              ndense  
we then interpolate these samples to obtain uniformly spaced samples zunif  t   t  
           nunif   we compute again the fft of zunif  t  obtaining fourier coefficients zunif  k  
k   nc           nc   the shape feature of a region is hence characterized by a vector of  n c   
complex coefficients 
position and size  position is determined as the region centroid computed via moment
invariants  pratt         size is computed as the mean distance between region centroid
and points on the contour 
orientation  in order to quantify the orientation of each region r i we use the same
fourier representation  which stores the orientation information in the phase values  we
obviously deal also with special cases when the shape of a region has more than one symmetry  e g   a rectangle or a circle  rotational similarity between a reference shape b and
a given region ri can then be obtained finding maximum values via cross correlation 
c t   

 n
xc
 
 
zb  k zri  k   ej  nc kn with t              nc
 nc     k  

color  color information of each region ri is stored  after quantization in a     values
color space  as the mean rgb value within the region 
rri  

x

r p 

g ri  

x

g p 

b ri  

pri

pri

x

b p 

pri

texture  we extract texture information for each region ri with a method based on
the work by pok and liu         following this approach  we extract texture features
convolving the original grey level image i x  y  with a bank of gabor filters  having the
following impulse response 
h x  y   

 
 
 
 x  y
   
 ej  u x v y 

e
   

where  u  v   represents the filter location in the frequency domain   is the central frequency   is the scale factor  and  the orientation  defined as 
 

p

u    v  

   arctan u v

the processing allows to extract a    components feature vector  which characterizes
each textured region 
   

fistructured knowledge representation for image retrieval

a   functions for computing similarities
smoothing function   in all similarity measures  we use the function  x  f x  f y   the
role of this function is to change a distance x  in which   corresponds to perfect matching 
to a similarity measure  in which the value   corresponds to perfect matching   and to
smooth the changes of the quantity x  depending on two parameters f x  f y 
 x  f x  f y   


x

 f y       f y   cos   f x  

 fy    

arctan 

 xf x   f y 
 
f xf y



 

if    x   f x
if x   f x

where f x     and     f y     

the input data to the approximate recognition algorithm are a shape description d 
containing n components hck   tk   k   bk i and an image i segmented into m regions r           rm  
the algorithm provides a measure for the approximate recognition of d in i 
the first step of the algorithm in section     considers all the m regions the image is
segmented into and all the n components in the shape description d and finds  if any  all
the groups of n regions rj k  satisfying the higher shape similarity with the shape components
of d  to this purpose we compute shape similarity  based on the fourier representation
previously introduced  as vector of complex coefficients  such measure denoted with sim ss
is invariant with respect to rotation  scale and translation and is computed as the cosine
distance between the two vectors  the similarity gives a measure in the range       assuming
the higher similarity simss     for perfect matching 
given the vectors x and y of complex coefficients describing respectively the shape of
a region ri and the shape of a component bk   x    x            x nc   and y    y            y nc  
p nc

l   xl yl
simss  bk   ri     qp
p nc  
 nc  
l   xl 
l   yl

shape similarity  the quantity simshape measures the similarity between shapes in
the composite shape description and the regions in the segmented image 
n

simshape    max    simss  bk   rj k      f xshape   f yshape  
k  

color similarity  the quantity simcolor measures the similarity in terms of color
appearance between the regions and the corresponding shapes in the composite shape description  in the following formula  color  k  r denotes the difference in the red color
component between the k th component of d and the region rj k    and similarly for the
green and the blue color components 
color k   

q

 color  k  r      color  k  g      color  k  b  

then the function  takes the maximum of the differences to obtain a similarity 
n

simcolor    max color  k    f xcolor   f ycolor  
k  

   

fidi sciascio  donini   mongiello

texture similarity  finally  simtexture measures the similarity between the texture
features in the components of d and in the corresponding regions 
texture  k  denotes the sum of differences in the texture components between the k th
component of d and the region rj k  and dividing by the standard deviation of the elements 
n

simtexture    max texture  k   f xtexture   f ytexture  
k  

references
aiello  m          computing spatial similarity by games  in esposito  f   ed    proceedings of the eighth conference of the italian association for artificial intelligence
 ai ia     no       in lecture notes in artificial intelligence  pp         springerverlag 
ardizzone  e   chella  a     gaglio  s          hybrid computation and reasoning for
artificial vision  in cantoni  v   levialdi  s     roberto  v   eds    artificial vision 
pp          academic press 
baader  f     hanschke  p          a schema for integrating concrete domains into concept
languages  in proceedings of the twelfth international joint conference on artificial
intelligence  ijcai     pp          sydney 
bach  r   fuller  c   gupta  a   hampapur  a   horowitz  b   humphrey  r   jain  r  
  shu  c          the virage image search engine  an open framework for image
management  in storage and retrieval for image and video databases  vol        pp 
      spie 
bertino  e     catania  b          a constraint based approach to shape management in
multimedia databases  multimedia systems         
bollmann  p   jochum  f   reiner  u   weissmann  v     zuse  h          the liveproject retrieval experiments based on evaluation viewpoints  in proceedings of the
 th annual international acm sigir conference on research and developement in
information retrieval  sigir      pp          acm  new york 
brooks  r          symbolic reasoning among   d models and   d images  artificial
intelligence             
calvanese  d   lenzerini  m     nardi  d          description logics for conceptual data
modeling  in chomicki  j     saake  g   eds    logics for databases and information
systems  pp          kluwer academic publisher 
cardoze  d     schulman  l          pattern matching for spatial point sets  in proceedings of the thirtyninth annual symposium on the foundations of computer science
 focs     pp          palo alto  ca 
carson  c   thomas  m   belongie  s   hellerstein  j  m     malik  j          blobworld  a
system for region based image indexing and retrieval  in huijsmans  d     smeulders 
a   eds    lecture notes in computer science  vol        pp          springer verlag 
celentano  a     di sciascio  e          features integration and relevance feedback analysis
in image similarity evaluation  journal of electronic imaging                
   

fistructured knowledge representation for image retrieval

chandra  a     harel  d          computable queries for relational databases  journal of
computer and system sciences             
chang  s   shi  q     yan  c          iconic indexing by  d strings  ieee transactions
on pattern analysis and machine intelligence                
chew  l   goodrich  m   huttenlocher  d   kedem  k   kleinberg  j     kravets  d         
geometric pattern matching under euclidean motion  computational geometry    
       
cox  i   miller  m   minka  t     papathomas  t          the bayesian image retrieval
system  pichunter  ieee transactions on image processing              
di sciascio  e   donini  f  m     mongiello  m          a description logic for image
retrieval  in lamma  e     mello  p   eds    ai ia     advances in artificial intelligence  no       in lecture notes in artificial intelligence  pp        springer verlag 
di sciascio  e     mongiello  m          query by sketch and relevance feedback for contentbased image retrieval over the web  journal of visual languages and computing 
               
donini  f   lenzerini  m   nardi  d     schaerf  a          reasoning in description logics 
in brewka  g   ed    foundations of knowledge representation  pp          cslipublications 
edelmann  s          representation and recognition in vision  the mit press 
el kwae  e     kabuka  m          content based retrieval by spatial similarity in image
databases  acm transactions on information systems             
flickner  m   sawhney  h   niblak  w   ashley  j   huang  q   dom  b   gorkani  m   hafner 
j   lee  d   petkovic  d   steele  d     yanker  p          query by image and video
content  the qbic system  ieee computer               
foley  j   van dam  a   feiner  s     hughes  j          computer graphics  addison
wesley publ  co   reading  massachussetts 
fuhr  n   govert  n     rolleke  t          dolores  a system for logic based retrieval
of multimedia objects  in proceedings of the   st annual international acm sigir
conference on research and developement in information retrieval  sigir      pp 
        melbourne  australia 
gevers  t     smeulders  a          pictoseek  combining color and shape invariant features
for image retrieval  ieee transactions on image processing                
gudivada  v          r string  a geometry based representation for efficient and effective
retrieval of images by spatial similarity  ieee transactions on knowledge and data
engineering                 
gudivada  v     raghavan  j          design and evaluation of algorithms for image
retrieval by spatial similarity  acm transactions on information systems         
       
haarslev  v   lutz  c     moeller  r          foundations of spatioterminological reasoning with description logics  in proceedings of the sixth international conference on
principles of knowledge representation and reasoning  kr     pp         
   

fidi sciascio  donini   mongiello

hacid  m  s     rigotti  c          representing and reasoning on conceptual queries over
image databases  in proceedings of the twelfth international symposium on methodologies for intelligent systems  ismis     no       in lecture notes in artificial
intelligence  pp          warsaw  poland  springer verlag 
hartman  j     wernecke  j          the vrml     handbook  addison wesley 
hirata  k     kato  t          query by visual example  in pirotte  a   delobel  c    
gottlob  g   eds    advances in database technology  proc   rd int  conf  extending database technology  edbt  vol      of lecture notes in computer science  pp 
      springer verlag 
jacobs  c   finkelstein  a     salesin  d          fast multiresolution image querying  in
proceedings of the   nd annual conference on computer graphics and interactive
techniques  siggraph      pp         
jahne  b   haubecker  h     geibler  p          handbook of computer vision and applications  academic press 
ma  w     manjunath  b          netra  a toolbox for navigating large image database 
in proceedings of the ieee international conference on image processing  icip     
vol     pp          santa barbara 
marr  d          vision  w h  freeman and co   oxford 
meghini  c   sebastiani  f     straccia  u          a model of multimedia information
retrieval  journal of the acm                 
moeller  r   neumann  b     wessel  m          towards computer vision with description
logics  some recent progress  in proceedings of the ieee integration of speech and
image understanding  pp         
nebel  b          reasoning and revision in hybrid representation systems  no      in
lecture notes in artificial intelligence  springer verlag 
niblak  w   barder  r   equitz  w   flickner  m   glasman  e   petkovic  d   yanker  p  
  faloustos  c          the qbic project  querying images by content using color 
texture  and shape  in storage and retrieval for still image and video databases 
vol        pp          spie 
paquet  e     rioux  m          a content based search engine for vrml databases 
in proceedings of ieee international conference on computer vision and pattern
recognition  cvpr     pp          santa barbara  ca 
picard  r     kabir  t          finding similar patterns in large image databases  in
proceedings of the ieee international conference on acoustics speech and signal
processing  icassp      pp          minneapolis  mn 
pirri  f     finzi  a          an approach to perception in theory of actions  part    in
linkoping electronic articles in computer and information science  no      linkoping university electronic press 
pok  g     liu  j          texture classification by a two level hybrid scheme  in storage
and retrieval for image and video databases vii  vol        pp          spie 
   

fistructured knowledge representation for image retrieval

pratt  w          digital image processing  j  wiley   sons inc   englewood cliffs  nj 
reiter  r     mackworth  a          a logical framework for depiction and image interpretation  artificial intelligence                 
reiter  r          equality and domain closure in first order databases  journal of the
acm                 
rui  y   huang  t     mehrotra  s          content based image retrieval with relevance
feedback in mars  in proceedings of the ieee international conference on image
processing  icip      pp         
rui  y   she  a     huang  t          modified fourier descriptors for shape representation
  a practical approach  in proceedings of  st workshop on image databases and
multimedia search  amsterdam 
sanfeliu  a     fu  k          a distance measure between attributed relational graphs for
pattern recognition  ieee transactions on systems  man  and cybernetics         
       
smith  j     chang  s          visualseek  a fully automated content based image query
system  in proceedings of the fourth acm international conference on multimedia
 multimedia     pp       
straccia  u          reasoning within fuzzy description logics  journal of artificial intelligence research             
tagare  h   vos  f   jaffe  c     duncan  j          arrangement  a spatial relation between
parts for evaluating similarity of tomographic section  ieee transactions on pattern
analysis and machine intelligence                 
ullman  j  d          principles of database and knowledge base systems  vol     computer
science press  potomac  maryland 
woods  w  a     schmolze  j  g          the kl one family  in lehmann  f  w   ed   
semantic networks in artificial intelligence  pp          pergamon press  published
as a special issue of computers   mathematics with applications  volume     number
   
yen  j          generalizing term subsumption languages to fuzzy logic  in proceedings of
the twelfth international joint conference on artificial intelligence  ijcai     pp 
       
zadeh  l          fuzzy sets  information and control            

   

fi