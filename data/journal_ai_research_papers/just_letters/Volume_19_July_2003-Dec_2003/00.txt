journal of artificial intelligence research               

submitted        published     

research note
new polynomial classes for logic based abduction
bruno zanuttini

zanutti info unicaen fr

greyc  universite de caen  boulevard du marechal juin
      caen cedex  france

abstract
we address the problem of propositional logic based abduction  i e   the problem of
searching for a best explanation for a given propositional observation according to a given
propositional knowledge base  we give a general algorithm  based on the notion of projection  then we study restrictions over the representations of the knowledge base and of the
query  and find new polynomial classes of abduction problems 

   introduction
abduction consists in searching for a plausible explanation for a given observation  for
instance  if p    q then p is a plausible explanation for the observation q  more generally 
abduction is the process of searching for a set of facts  the explanation  here p  that 
conjointly with a given knowledge base  here p  q   imply a given query  q   this process
is also constrained by a set of hypotheses among which the explanations have to be chosen 
and by a preference criterion among them 
the problem of abduction proved its practical interest in many domains  for instance  it
has been used to formalize text interpretation  hobbs et al          system  coste marquis
  marquis        stumptner   wotawa        or medical diagnosis  bylander et al        
section     it is also closely related to configuration problems  amilhastre et al         
to the atms cms  reiter   de kleer         to default reasoning  selman   levesque 
      and even to induction  goebel        
we are interested here in the complexity of propositional logic based abduction  i e   we
assume both the knowledge base and the query are represented by propositional formulas 
even in this framework  many different formalizations have been proposed in the literature 
mainly differing about the definition of an hypothesis and that of a best explanation  eiter
  gottlob         we assume here that the hypotheses are the conjunctions of literals
formed upon a distinguished subset of the variables involved  and that a best explanation
is one no proper subconjunction of which is an explanation  subset minimality criterion  
our purpose is to exhibit new polynomial classes of abduction problems  we give a
general algorithm for finding a best explanation in the framework defined above  independently from the syntactic form of the formulas representing the knowledge base and the
query  then we explore the syntactic forms that allow a polynomial running time for this
algorithm  we find new polynomial classes of abduction problems  among which the one
restricting the knowledge base to be given as a horn dnf and the query as a positive cnf 
and the one restricting the knowledge base to be given as an affine formula and the query as
a disjunction of linear equations  our algorithm also unifies several previous such results 
c
    
ai access foundation and morgan kaufmann publishers  all rights reserved 

fibruno zanuttini

the note is organized as follows  we first recall the useful notions of propositional
logic  section     formalize the problem  section    and briefly survey previous work about
the complexity of abduction  section     then we give our algorithm  section    and
explore polynomial classes for it  section     finally  we discuss our results and perspectives
 section     for lack of space we cannot detail proofs  but a longer version of this work 
containing detailed proofs and examples  is available  zanuttini        

   preliminaries
we assume a countable number of propositional variables x    x        and the standard connectives             a literal is either a variable xi  positive literal  or its negation
xi  negative literal   a propositional formula is a well formed formula built on a finite
number of variables and on the connectives  v ar   denotes the set of variables that occur
in the propositional formula   a clause is a finite disjunction of literals  and a propositional formula is in conjunctive normal form  cnf  if it is written as a finite conjunction
of clauses  for instance      x   x      x   x   x    is in cnf  the dual notions
of clause and cnf are the notions of term  finite conjunction of literals  and disjunctive
normal form  dnf   finite disjunction of terms  
an assignment to a set of variables v is a set of literals m that contains exactly one
literal per variable in v   and a model of a propositional formula  is an assignment m
to v ar   that satisfies  in the usual way  where m assigns   to xi iff xi  m  we also
write m as a tuple  e g        for  x    x    x    x     we write m i  for the value assigned
to xi by m  and m   for the set of all the models of a propositional formula    is
said to be satisfiable if m        a formula  is said to imply a propositional formula  
 written         if m    m      more generally  we identify sets of models with boolean
functions  and use the notations m  negation   m  m   disjunction  and so on 
the notion of projection is very important for the rest of the paper  for m an assignment
to a set of variables v and a  v   write selecta  m  for the set of literals in m that are
formed upon a  e g   select x   x                 projecting a set of assignments onto a subset
a of its variables intuitively consists in replacing each assignment m with selecta  m   for
sake of simplicity however  we define the projection of a set of models m to be built upon
the same set of variables as m  this yields the following definition 
definition    projection  let v    x            xn   be a set of variables  m a set of assignments to v and a  v   the projection of m onto a is the set of assignments to v
m a    m   m   m  selecta  m      selecta  m   
for instance  let m                                  be a set of assignments to v  
 x    x    x    x     and let a    x    x     then it is easily seen that
m a                                                                               
since  selecta  m    m  m                 
remark that the projection of the set of models of a formula  onto a set of variables
a is the set of models of the most general consequence of  that is independent of all the
variables not in a  note also that the projection of m   onto a is the set of models of the
formula obtained from  by forgetting its variables not occurring in a  for more details
 

filogic based abduction

about variable forgetting and independence we refer the reader to the work by lang et
al   lang et al         
it is useful to note some straightforward properties of projection  let m  m  denote
two sets of assignments to the set of variables v   and let a  v   first  projection is
distributive over disjunction  i e    m  m    a   m a  m   a   now it is distributive over
conjunction when m does not depend on the variables m  depends on  i e   when there exist
a  a   v   a  a     with m a   m  m does not depend on v  a  and m   a    m   
 m  m    a   m a  m   a holds  note that this is not true in the general case  note finally
that in general  m  a is not the same as m a  

   our model of abduction
we now formalize our model  for sake of simplicity  we first define abduction problems and
then the notions of hypothesis and explanation 
definition    abduction problem  a triple         a  is called an abduction problem if  and  are satisfiable propositional formulas and a is a set of variables with
v ar    a  v ar     is called the knowledge base of    its query and a its set
of abducibles 
definition    hypothesis explanation  let         a  be an abduction problem  an
hypothesis for  is a set of literals formed upon a  seen as their conjunction   and an
hypothesis e for  is an explanation for  if   e is satisfiable and   e      if no
proper subconjunction of e is an explanation for   e is called a best explanation for  
note that this framework does not allow one to specify that a variable must occur unnegated
 resp  negated  in an explanation  we do not think this is a prohibiting restriction  since
abducibles are intuitively meant to represent the variables whose values can be  e g   modified  observed or repaired  and then no matter their sign in an explanation  but we note that
it is a restriction  and that a more general framework can be defined where the abducibles
are literals and the hypotheses  conjunctions of abducibles  marquis        
we are interested in the computational complexity of computing a best explanation for
a given abduction problem  or asserting there is none at all  following the usual model 
we establish complexities with respect to the size of the representations of  and  and to
the number of abducibles  for hardness results  the following associated decision problem is
usually considered  is there at least one explanation for   obviously  if this latter problem
is hard  then the function problem also is 

   previous work
the main general complexity results about propositional logic based abduction with subsetminimality preference were stated by eiter and gottlob         the authors show that
deciding whether a given abduction problem has a solution at all is a p   complete problem 
even if a  v ar     v ar   and  is in cnf  as stated as well by selman and levesque
        they also establish that this problem becomes only np complete when  is horn 
and even acyclic horn  note that when sat and deduction are polynomial with  the
problem is obviously in np 
 

fibruno zanuttini

in fact  very few classes of abduction problems are known to be polynomial for the
search for explanations  as far as we know  the only such classes are those defined by the
following restrictions  once again we refer the reader to the references for definitions  
  is in  cnf and  is in  dnf  marquis        section     
  is given as a monotone cnf and  as a clause  marquis        section     
  is given as a definite horn cnf and  as a conjunction of positive literals  selman
  levesque        eiter   gottlob       
  is given as an acyclic horn cnf with pseudo completion unit refutable and  is a
variable  eshghi       
  has bounded induced kernel width and  is given as a literal  del val       
  is represented by its set of characteristics models  with respect to a particular basis 
and  is a variable  khardon   roth         note that a set of characteristic models
is not a propositional formula  but that the result is however similar to the other ones
  is represented by the set of its models  or  equivalently  by a dnf with every variable
occurring in each term  and  is any propositional formula 
the first two classes are proved polynomial with a general method for solving abduction
problems with the notion of prime implicants  the last one is obvious since all the information
is explicitely given in the input  and the four others are exhibited with ad hoc algorithms 
let us also mention that amilhastre et al         study most of the related problems in
the more general framework of multivalued theories instead of propositional formulas  i e  
when the domain of the variables is not restricted to be         the authors mainly show 
as far as this note is concerned  that deciding whether there exists an explanation is still a
p   complete problem  amilhastre et al         table    
note that not all these results are stated in our exact framework in the papers cited
above  but that they all still hold in it  let us also mention that the problem of enumerating
all the best explanations for a given abduction problem is of great interest  eiter and makino
       provide a discussion and some first results about it  mainly in the case when the
knowledge base is horn 

   a general algorithm
we now give the principle of our algorithm  let us stress first that  as well as  e g   marquis
construction  marquis        section       its outline matches point by point the definition
of a best explanation  our ideas and marquis are anyway rather close 
we are first interested in the hypotheses in which every abducible x  a occurs  either
negated or unnegated   let us call them full hypotheses  note indeed that every explanation
e for an abduction problem is a subconjunction of a full explanation f   indeed  since e is
by definition such that   e is satisfiable and implies   it suffices to let f be selecta  m 
for a model m of   e    minimization of f will be discussed later on 
 

filogic based abduction

proposition   let         a  be an abduction problem  and f a full hypothesis of  
then f is an explanation for  if and only if there exists an assignment m to v ar   with
f   selecta  m  and m  m     m      a  
proof assume first f is an explanation for   then  i  there exists an assignment m to
v ar   with m      f   thus f   selecta  m  and m  m    and  ii    f      i e  
  f   is unsatisfiable  thus f 
   selecta  m    m  m       thus m 
   m      a  
thus m   m      a   conversely  if m  m     m      a let f   selecta  m  
then we have  i  since m  m      f is satisfiable  and  ii  since m 
   m      a  
 
 
there is no m  m     with selecta  m     f   thus   f   is unsatisfiable  thus
  f     

thus we have characterized the full explanations for a given abduction problem  now
minimizing such an explanation f is not a problem  since the following greedy procedure 
given by selman and levesque        reduces f into a best explanation for  
for every literal    f do
if   f          then f  f      endif 
endfor 
note that depending on the order in which the literals    f are considered the result may
be different  but that in all cases it will be a best explanation for  
finally  we can give our general algorithm for computing a best explanation for a given
abduction problem         a   its correctness follows directly from proposition   
   a propositional formula with m       m     m      a  
if   is unsatisfiable then return no explanation 
else
m  a model of    
f  selecta  m  
minimize f  
return f  
endif 

   polynomial classes
we now explore the new polynomial classes of abduction problems that our algorithm allows
to exhibit  throughout the section  n denotes the number of variables in v ar   
    affine formulas
a propositional formula is said to be affine  or in xor cnf    schaefer        kavvadias  
sideri        zanuttini        if it is written as a finite conjunction of linear equations over
the two element field  e g       x   x         x   x   x        as can be seen  equations
play the same role in affine formulas as clauses do in cnfs  roughly  affine formulas represent
conjunctions of parity or equivalence constraints  this class proves interesting for knowledge
representation  since on one hand it is tractable for most of the common reasoning tasks  and
 

fibruno zanuttini

on the other hand the affine approximations of a knowledge base can be made very small and
are efficiently learnable  zanuttini         we show that projecting an affine formula onto
a subset of its variables is quite easy too  enabling our algorithm to run in polynomial time 
the proof of the following lemma is easily obtained with gaussian elimination  curtis        
triangulate  with the variables in a put rightmost  and then keep only those equations
formed upon a  full details are given in the technical report version  zanuttini        
lemma   let  be an affine formula containing k equations  and a  v ar    then
an affine formula  with m      m    a and containing at most k equations can be
computed in time o k    v ar     
proposition   if  is represented by an affine formula containing k equations and  by
a disjunction of k   linear equations  and a is a subset of v ar    then searching for a best
explanation for         a  can be done in time o  k   k      k          a  k   k     n  
sketch of proof it is easily seen that an affine formula  containing k     k equations and
n variables  for    can be computed in time linear in the size of   this formula can be
projected onto a in time o  k   k      n   and we straightforwardly get a disjunction of at
most k   k   linear equations for  m      a   then we can use distributivity of  over 
for solving the satisfiability problem of the algorithm  recall that sat can be solved in time
o k   n  for an affine formula of k equations over n variables by the elimination method of
gauss  curtis         the remaining operations are straightforward 

note that variables  literals and clauses are special cases of disjunctions of linear equations 
    dnfs
though the class of dnf formulas has very good computational properties  abduction
remains a hard problem for it as a whole  even with additional restrictions  recall that the
tautology problem is the one of deciding whether a given dnf formula represents the
identically true function  and that this problem is conp complete 
proposition   deciding whether there is at least one explanation for a given abduction
problem      a  is np complete when  is given in dnf  even if  is a variable and
a       v ar   
sketch of proof membership in np is obvious  since deduction with dnfs is polynomial 
now it is easily seen that  is tautological if and only if the abduction problem   
 x   x  v ar    has no explanation  where x is a variable not occuring in   see the dnf
   x  as the implication   x      x  is in dnf  and we get the result 

however  when  is represented by a dnf projecting it onto a is easy  indeed  the properties of projection show that it suffices to cancel its literals that are not formed upon a 
consequently  if  is such a dnf containing k terms  then a dnf  with m      m    a
and containing at most k terms can be computed in time o k v ar     
thus we can show that some subclasses of the class of all dnfs allow polynomial
abduction  we state the first result quite generally  but note that its assumptions are
satisfied by natural classes of dnfs  e g   that of horn dnfs  i e   those dnfs with at
 

filogic based abduction

most one positive literal per term  similarly  that of horn renamable dnfs  i e   those
that can be turned into a horn dnf by replacing some variables with their negation  and
simplifying double negations  everywhere in the formula   dnfs  those dnfs with at most
two literals per term  we omit the proof of the following proposition  since it is essentially
the same as that of proposition    simply follow the execution of the algorithm  
proposition   let d be a class of dnfs that is stable under removal of occurrences of
literals and for which the tautology problem is polynomial  if  is restricted to belong
to d   is a clause and a is a subset of v ar    then searching for a best explanation for
        a  can be done in polynomial time 
thus we can establish that abduction is tractable if  among others   is in horn renamable
dnf  including the horn and reverse horn cases  or in  dnf  and  is a clause 
finally  let us point out that with a very similar proof we can obtain polynomiality
for some problems obtained by strengthening the restriction of proposition   over   but
weakening that over  
proposition   if  is represented by a horn  resp  reverse horn  dnf of k terms and
 by a positive  resp  negative  cnf of k   clauses  and a is a subset of v ar    then
searching for a best explanation for         a  can be done in time o  k    a  kk   n  
the same holds if  is represented by a positive  resp  negative  dnf of k terms and  by
a horn  resp  reverse horn  cnf of k   clauses 
once again note that variables  literals and terms are all special cases of  reverse  horn
cnfs  and that variables  positive  resp  negative  clauses and positive  resp  negative 
terms are all special cases of positive  resp  negative  cnfs 

   discussion and perspectives
the general algorithm presented in this note allows us to derive new polynomial restrictions
of abduction problems  even if this is not discussed here  for lack of space  it also allows to
unify some previously known such restrictions  such as  in  cnf and  in  dnf  or 
in monotone cnf and  given as a clause   the following list summarizes the main new
polynomial restrictions 
  given as an affine formula and  as a disjunction of linear equations  proposition   
  in horn renamable dnf and  given as a clause  proposition   
  in  dnf and  given as a clause  proposition   
  in horn  reverse horn  dnf and  in positive  negative  cnf  proposition   
  in negative  positive  dnf and  in reverse horn  horn  cnf  proposition    
moreover  even if there is no guarantee for efficiency in the general case the presentation of
our algorithm does not depend on the syntactic form of  or   and it uses only standard
operations on boolean functions  projection  conjunction  negation  
 

fibruno zanuttini

another interesting feature of this algorithm is that before minimization it computes
the explanations intentionnally  consequently  all the full explanations can be enumerated
with roughly the same delay as the models of the formula representing them       however 
of course  there is no guarantee that two of them would not be minimized into the same
best explanation  which prevents from concluding that our algorithm can enumerate all the
best explanations  trying to extend it into this direction would be an interesting problem 
for more details about enumeration we refer the reader to eiter and makinos work  eiter
  makino        
as identified by selman and levesque         central to the task is the notion of projection over a set of variables  and our algorithm isolates this subtask  however  our notion
of projection only concerns variables  and not literals  which prevents from imposing a sign
to the literals the hypotheses are formed upon  contrariwise to more general formalizations
proposed for abduction  as marquis  marquis         even if we think this is not a prohibiting restriction  it would be interesting to try to fix that weakness of our algorithm
while preserving its polynomial classes 
another problem of interest is the behaviour of our algorithm when  and  are not
only propositional formulas  but more generally multivalued theories  in which the domain
of variables is not restricted to be         e g   signed formulas  beckert et al          this
framework is used  for instance  for configuration problems by amilhastre et al          it
is easily seen that our algorithm is still correct in this framework  however  there is still left
to study in which cases its running time is polynomial 
finally  problems of great interest are those of deciding the relevance or the necessity of
an abducible  eiter   gottlob         an abducible x is said to be relevant to an abduction
problem  if there is at least one best explanation for  containing x or x  and necessary
to  if all the best explanations for  contain x or x  it is easily seen that x is necessary
for         a  if and only if          a  x   has no explanation  hence showing that
polynomial restrictions for the search for explanations are polynomial as well for deciding
the necessity of an hypothesis as soon as they are stable under the substitution of a  x 
for a  which is the case for all restrictions considered in this note  contrastingly  we do
not know of any such relation for relevance  and the study of this problem would also be of
great interest 

acknowledgments
the author wishes to thank the anonymous referees of this version and those of a previous
one  proc  jnpc    in french   as well as jean jacques hebrard  for very valuable and
constructive comments 

references
amilhastre  j   fargier  h     marquis  p          consistency restoration and explanations
in dynamic csps  application to configuration  artificial intelligence           
       
 

filogic based abduction

beckert  b   hahnle  r     manya  f          transformations between signed and classical clause logic  in proc    th international symposium on multiple valued logics
 ismvl     pp          ieee computer society press 
bylander  t   allemang  d   tanner  m     josephson  j          some results concerning
the computational complexity of abduction  in proc   st international conference on
principles of knowledge representation and reasoning  kr     pp        morgan
kaufmann 
coste marquis  s     marquis  p          characterizing consistency based diagnoses 
in proc   th international symposium on artificial intelligence and mathematics
 aimath    
curtis  c          linear algebra  an introductory approach  springer verlag 
del val  a          the complexity of restricted consequence finding and abduction  in
proc    th national conference on artificial intelligence  aaai     pp         
aaai press mit press 
eiter  t     gottlob  g          the complexity of logic based abduction  journal of the
acm              
eiter  t     makino  k          on computing all abductive explanations  in proc    th
national conference on artificial intelligence  aaai     pp        aaai press 
eshghi  k          a tractable class of abduction problems  in proc    th international
joint conference on artificial intelligence  ijcai     pp      morgan kaufmann 
goebel  r          abduction and its relation to constrained induction  in proc  ijcai  
workshop on abduction and induction in ai 
hobbs  j   stickel  m   appelt  d     martin  p          interpretation as abduction  artificial intelligence            
kavvadias  d     sideri  m          the inverse satisfiability problem  siam journal on
computing                 
khardon  r     roth  d          reasoning with models  artificial intelligence             
lang  j   liberatore  p     marquis  p          conditional independence in propositional
logic  artificial intelligence             
marquis  p          consequence finding algorithms  in handbook of defeasible reasoning
and uncertainty management systems  drums   vol     pp         kluwer academic 
reiter  r     de kleer  j          foundations of assumption based truth maintenance systems  preliminary report  in proc   th national conference on artificial intelligence
 aaai     pp          aaai press mit press 
schaefer  t          the complexity of satisfiability problems  in proc    th annual acm
symposium on theory of computing  stoc     pp          acm press 
selman  b     levesque  h          abductive and default reasoning  a computational core 
in proc   th national conference on artificial intelligence  aaai     pp         
aaai press 
 

fibruno zanuttini

stumptner  m     wotawa  f          diagnosing tree structured systems  artificial intelligence           
zanuttini  b          approximating propositional knowledge with affine formulas  in
proc    th european conference on artificial intelligence  ecai     pp         
ios press 
zanuttini  b          new polynomial classes for logic based abduction  tech  rep   universite de caen  france 

  

fi