journal of artificial intelligence research                  

submitted       published      

decentralized supply chain formation  a market protocol and
competitive equilibrium analysis
william e  walsh

wwalsh    us   ibm   com

ibm t  j  watson research center
   skyline drive
hawthorne  ny       usa

michael p  wellman

wellman   umich   edu

university of michigan ai laboratory
     beal avenue
ann arbor  mi            usa

abstract
supply chain formation is the process of determining the structure and terms of exchange relationships to enable a multilevel  multiagent production activity  we present a simple model of
supply chains  highlighting two characteristic features  hierarchical subtask decomposition  and
resource contention  to decentralize the formation process  we introduce a market price system
over the resources produced along the chain  in a competitive equilibrium for this system  agents
choose locally optimal allocations with respect to prices  and outcomes are optimal overall  to determine prices  we define a market protocol based on distributed  progressive auctions  and myopic 
non strategic agent bidding policies  in the presence of resource contention  this protocol produces
better solutions than the greedy protocols common in the artificial intelligence and multiagent systems literature  the protocol often converges to high value supply chains  and when competitive
equilibria exist  typically to approximate competitive equilibria  however  complementarities in
agent production technologies can cause the protocol to wastefully allocate inputs to agents that do
not produce their outputs  a subsequent decommitment phase recovers a significant fraction of the
lost surplus 

   introduction
electronic commerce technology can provide significant improvements in existing modes of commercial interaction  through increased speed  convenience  quality  and reduced costs  yet some
have proposed more radical visions of how business may be transformed  exponential increases
in communications bandwidth and computational ability have the potential to qualitatively decrease
the friction in business interactions  with this as a premise  malone and laubauchers treatise on the
emerging e lance economy        puts forth the view that  in the not too distant future  business
relationships will lose much of their current persistent character  indeed  malone and laubaucher
propose that large companies as we know them will cease to exist  and rather be dynamically formed
by electronically connected freelancers  e lancers  for the purpose of producing particular goods
and services  and then dissolved when projects are completed  others employ the evocative term
virtual corporation  davidow        to describe groups of agile organizations forming temporary
confederations for ad hoc purposes 
c
    
ai access foundation and morgan kaufmann publishers  all rights reserved 

fiwalsh   w ellman

whether or not one accepts the full extent of this vision of virtual corporations  several business
trends provide evidence that we are moving in this direction  software companies are time shifting
development between the u s  and india  and sun microsystems now allows freelance programmers to bid to fix customers software problems  borenstein   saloner         large  traditional
manufacturing companies  exemplified by major automotive manufacturers  increasingly outsource
the production of various components  ford and general motors  gm  have spun off parts manufacturing into separate companies  lucking reily   spulber         start ups and other small
companies form partnerships to compete with larger  more established companies  application
service providers supplant in house provision of standard operations  information  and technology
services 
we study this phenomenon in the guise of supply chains  a common form of coordinated commercial interaction  for our purposes  a supply chain is a network of production and exchange
relationships that spans multiple levels of production or task decomposition  whenever we have a
producer that buys inputs and sells outputs  we have a supply chain  although typically used to refer
to multi business structures in manufacturing industries  any service or contracting relationship that
spans multiple levels can be viewed as a supply chain 
supply chain formation is the process of determining the participants in the supply chain  who
will exchange what with whom  and the terms of the exchanges  traditionally  supply chains have
been formed and maintained over long periods of time by means of extensive human interactions 
but the acceleration of commercial decision making is creating a need for more advanced support 
companies ranging from auto makers to computer manufacturers are basing their business models
on rapid development  build to order  and customized products to satisfy ever changing consumer
demand  and fluctuations in resource costs and availability mean that companies must respond
rapidly to maintain production capabilities and profits  as these changes increasingly occur at
speeds  scales  and complexity unmanageable by humans  the need for automated supply chain
formation becomes acute 
because the agents are autonomous in an electronic commerce setting  we must generally assume that they have specialized knowledge about their own capabilities but limited knowledge about
other individuals and the large scale structure of the problem  because agents are self interested 
they will participate with the goal of maximizing their own benefit  additionally  we may have
cause to control the allocation of each resource individually if  for instance  global optimization is
infeasible or if no one entity has global allocative authority  for such environments where information  decision making  and control are inherently decentralized  we seek to engineer the process
of bottom up supply chain formation  this problem is complicated if the structure of resource
contention precludes the use of simple greedy allocation strategies 
we present a decentralized  asynchronous market protocol for supply chain formation under
conditions of resource scarcity  the protocol allows agents to negotiate the formation of supply
chains in a bottom up fashion  requiring only local knowledge and communication  in the market
protocol  agents decisions are coordinated by the price system  with the price for each resource
determined through an ascending auction 
the remainder of the paper describes our market protocol  and characterizes its behavior theoretically and empirically   we begin in section   with a formal definition of the supply chain
formation problem  and an illustrating application to the automotive industry  in section    we
   further details may be found in the first authors dissertation  walsh        

   

fid ecentralized s upply c hain f ormation

show how typical greedy top down approaches to supply chain formation can fail in the presence
of resource contention  we define a price system and analyze static properties of price equilibria in
section    in section    we introduce a price based market protocol for supply chain formation and
analyze its convergence properties  we present the results of an empirical study of the protocol in
section    in section    we discuss relevant results and issues in price based analysis and auction
theory  as well as some related work in supply chain formation  we conclude in section   and
suggest extensions and future work  throughout  we defer proofs to appendix a 

   the supply chain formation problem
agents in the supply chain are characterized in terms of their capabilities to perform tasks  and their
interests in having tasks accomplished  a central feature of our model of the problem is hierarchical
task decomposition  in order to perform a particular task  an agent may need to achieve some
subtasks  which may be delegated to other agents  these may in turn have subtasks that may be
delegated  forming a supply chain through a decomposition of task achievement  constraints on the
task assignment arise from resource contention  where agents require a common resource  e g   a
task achievement  or something tangible such as a piece of equipment  to accomplish their tasks 
tasks are performed on behalf of particular agents  if two agents need a task then it would have
to be performed twice to satisfy them both  in this way  tasks are the same as any other discrete  rival
resource  hence  we make no distinction in our model  and use the term good to refer to any task
or resource provided or needed by agents  the assumption that goods cannot be shared or reused
 i e   have limited available quantities  is necessary for much of our analysis  goods that can be
replicated at little or no marginal cost  such as software and information  provide many interesting
challenges to economic analysis  shapiro   varian         not addressed in this work 
    example  automotive supply chain formation
we illustrate our model of supply chain formation with an application to a stylized  hypothetical
example from the automotive industry  traditionally  automotive supply chains span many tiers 
formed and maintained over long periods of time through extensive human negotiations  some
automation is emerging  for example through covisint    a company formed by gm  ford  and
daimlerchrysler to mediate the negotiation and exchange of parts  as well as other supply chain
interactions  currently the focus in such efforts is on a particular exchange relationship within a
single level of production  we consider the broader problem of assembling combinations of relationships across multiple levels to form complete  feasible supply chains 
in the example presented in figure    ford and gm need to acquire contracts for transmissions
in order to produce particular models of cars  ford can produce the transmissions in its own factories or acquire them from an independent transmission producer  gm currently does not have the
capacity to produce the desired transmissions  and must outsource  the independent transmission
producer has capacity to provide transmissions to either ford or gm  but not both  ford and the
independent factory both require the services of a job shop for metal working tasks  but the job shop
does not have capacity to serve them simultaneously  contracts with the job shop and with the two
transmission factories are the scarce goods to be allocated 
   http   www covisint com

   

fiwalsh   w ellman

ford auto
assembly

ford
distribution

job shop

independent
transmission
factory

ford
transmission
factory

gm auto
assembly

gm
distribution

figure    an automotive supply chain formation problem 
the limited capacity of the job shop entails certain constraints on feasible supply chains  ford
cannot acquire transmissions from the independent factory  because the job shop cannot serve the
independent factory and ford simultaneously  additionally  ford and gm cannot simultaneously
be satisfied 
    problem specification
we provide a formal description of the supply chain formation problem in terms of bipartite graphs 
the two types of nodes represent goods and agents  respectively  a task dependency network is a
directed  acyclic graph   v  e   with vertices v   g  a  where 
g   the set of goods 
a   c    the set of agents 
c   the set of consumers 
   the set of producers 
and a set of edges e connecting agents with goods they can use or produce  there exists an edge
hg  ai from g  g to a  a when agent a can make use of one unit of g  and an edge ha  gi when
a can provide one unit of g  if an agent requires multiple units of a good as input  then we treat
each unit as a separate edge  distinguishing them by subscripts   edges without explicit subscripts
are interpreted as implicitly subscripted by     for instance  if agent a requires two units of g as
input  then its input edges are hg  ai  and hg  ai   
the various agent types are characterized by their position in the task dependency network 
each consumer  c  c  wishes to acquire one unit of one good from its set of consumable goods 
gc  g  where hg  ci  e iff g  gc  
a producer can produce a single unit of an output good conditional on acquiring some input
goods  with each producer    we associate 
   an input set  i  g  such that g  i iff there are edges hg  ik  e for one or more k  and
   

fid ecentralized s upply c hain f ormation

worked
metal

ford transmission
subcontractor

ford
cars

ford
distribution
       

ford
transmissions

   
job shop
   

ford auto
assembler
       

ford
transmission
factory
    

independent
transmission
factory
   
gm transmission
subcontractor
   

gm
trasmissions

gm auto
assembler
       

gm
cars

gm
distribution
       

figure    network auto  a task dependency network for the automotive supply chain depicted in
figure   

   a single output  g  g   i   such that h  g i  e 
a producers input goods are complementary in that the agent must acquire all of them in order
to produce its output  it cannot accomplish anything with only a partial set  alternate producers
with the same output indicate different ways that a good can be produced 
task dependency networks are constrained to be acyclic  that is  no agent produces goods that
could be used to assemble its inputs through any chain of production  although we might broadly
view all global commerce as one large cycle of production and consumption  in practice  negotiations tend to be clustered within more limited scopes of concern  often referred to as industries 
the resulting supply chains are typically acyclic 
figure   shows an example task dependency network for the automotive supply chain problem
of figure    here the goods are indicated by circles  and agents by boxes  producers with inputs
are represented by curved boxes  the numbers under agent boxes represent production costs and
consumption values  explained below  an arrow from an agent to a good indicates that the agent can
provide that good  and an arrow from a good to an agent indicates that the agent can make use of
the good  for instance  the producer labeled ford auto assembly requires worked metal and ford
transmissions in order to produce cars  since the transmissions produced by the ford transmission
factory can be used only by ford  we need to distinguish ford and gm transmissions as separate
goods  this in turn requires that we introduce ford and gm transmission subcontractor producers
to model the fact that the independent transmission factory can be used to produce either type 
an allocation is a subgraph  v     e       v  e   for a  a and g  g  an edge ha  gi  e   means
that agent a provides g  and hg  ai  e   means a acquires g  an allocations vertices are the agents
and goods incident on its edges 
   an agent is in an allocation graph iff it acquires or provides a good 
for a  a  we have a  v   iff hg  ai  e   or ha  gi  e    
   

fiwalsh   w ellman

worked
metal

ford transmission
subcontractor

ford
cars

ford
distribution
       

ford
transmissions

   
job shop
   

ford auto
assembler
       

ford
transmission
factory
    

independent
transmission
factory
   
gm transmission
subcontractor
   

gm
trasmissions

gm auto
assembler
       

gm
cars

gm
distribution
       

figure    a solution to network auto 
   a good is in an allocation graph iff it is acquired or provided 
for g  g  we have g  v   iff hg  ai  e   or ha  gi  e    
a producer  is active iff it provides its output  a producer is feasible iff it is inactive or
acquires all its inputs  consumers are always feasible 
good g is in material balance in  v     e     iff the number of edges in equals the number out 
fi
fi
fi fi
fi  a  k    ha  gik  e    fi   fi  a  k    hg  aik  e    fi  

an allocation is feasible iff all agents are feasible and all goods are in material balance  a
solution is a feasible allocation that forms a partial ordering of feasible production  culminating in
consumption  that is  some consumer acquires a good it desires 
there exists a hg  ci  e   such that c  c v    

a solution may involve multiple consumers  if consumer c is in a solution  v     e     then we say that
 v     e     is a solution for c 
figure   shows a solution allocation for the task dependency network of figure    shaded
agents and solid arrows are part of the solution  with unshaded agents and dashed arrows indicating
elements of the problem not part of the solution  note that the ford auto assembler wins an input 
but is inactive  however  recall that inactive producers are feasible  hence the solution properties
are met  we refer to the configuration of an inactive producer acquiring an input in an allocation as
a dead end 
each producer  has some production cost  for providing a unit of its output  the cost might
represent the value  could obtain from engaging in some other activity  i e   its opportunity cost  
or some direct cost incurred in producing its output  but not including input costs   since a producer
provides at most one unit of one good  the total production cost to   with output g  for allocation
e     is  if h  gi  e   and   otherwise 
we assume that a consumer has preferences over different possible goods  but wishes to obtain
only a single unit of one good  thus  a consumer c obtains value vc  g  for obtaining a single unit
   

fid ecentralized s upply c hain f ormation

of good g  and  for allocation e     obtains value vc   v     e       maxhg cie   vc  g   in depicting task
dependency networks  we display costs and values below the corresponding agent boxes 
definition    value of an allocation  the value of allocation  v     e     is 
value  v     e      

 vc   v    e          v    e     


cc

definition    efficient allocations  the set of efficient allocations contains all feasible allocations
 v    e    such that 
value  v    e      

max

 value  v     e         v     e     is feasible  

 v    e     v e 

task dependency networks describe the supply chain formation problem from a global perspective  in a decentralized approach to formation  we would generally not assume that an agent  or any
other entity  has perfect or complete knowledge of the entire network  we generally do assume that
all agents have perfect knowledge of their own costs  values  and goods of interest  when mediators
facilitate the negotiations for goods  as in protocols described below   each agent knows of relevant
mediators for its goods of interest  this knowledge includes all rules enforced by the mediators 
likewise  mediators know of the existence of all agents interested in their respective goods  beyond
that  a mediator knows only what the agents reveal through communication during negotiation  a
mediator does not know the agents true costs or valuations  nor is it aware of agents preferences
for goods outside of its direct scope of facilitation  we do not address in detail how agents and
mediators achieve mutual awareness  i e   how connections originate   but assume that it can be
accomplished via some unspecified search  notification  or broadcast protocol 

   resource contention
one natural candidate approach to supply chain formation is the contract net protocol  davis
  smith         the most widely studied algorithm for forming task performance relations among
distributed agents  c ontract net does indeed apply to our framework  as it employs local negotiation to achieve a hierarchical task decomposition  although definitive characterization is difficult
due to the many variants on contract net in the literature  baker        davis   smith       
dellarocas et al         sandholm         it is fair to say that  generally  request for quotes proceed top down from the root task  right to left from consumers  in our network terminology   and
contracting proceeds bottom up  left to right towards consumers   selecting at each level among
candidate bids received   variants of the protocol are primarily distinguished by the form of bids
and selection criteria employed   as a consequence  choices are made greedily  without reflecting
ramifications upstream in the evolving chain 
this approach can form satisficing supply chains when there are sufficient resources to support the greedy selection  however  the basic contract net protocol does not explicitly address
resource scarcity or contention among multiple agents  producers accept bids on inputs before it
can be established whether this might cause infeasibility further upstream  without lookahead or
backtracking  contract net might construct infeasible supply chains when there are limited resources 
for instance  a greedy protocol would not produce a solution for the network shown in figure   
here  if all producers bid according to a common function monotone in cost  the output bid of
   

fiwalsh   w ellman

a 
 

 

a 

 

a 
 
 

 
a 

 

 
a 

a 
 

 

cons
  

a 
 

 

 

figure    network greedy bad  a network for which greedy protocols can produce infeasible
allocations 

producer a  would be preferred to that of a   because a  can acquire its inputs cheaper  but since
a  must acquire the one available unit of good   to feasibly participate in a solution  a  cannot be a
part of the solution 
the issue of resource contention motivates our adoption of a market based approach  the key
idea is that prices can signal resource value and scarcity up and down the chain  enabling local
decision making while avoiding the pitfalls of greedy one pass selection or communication of global
structure information 

   price systems
a price system p assigns to each good g  a nonnegative number p g  as its price  prices are anonymous  i e   not agent dependent  and linear in the quantity of goods  intuitively  prices indicate the
relative value of the goods  and agents use the prices to guide their local decision making 
we assume agents have quasilinear utility functions  defined by money holdings plus the
value  or minus cost  associated with the allocation of goods  agents wish to maximize their surplus
with respect to prevailing prices 
definition    surplus  the surplus   a   v     e      p   of agent a with allocation  v     e     at prices
p  is given by 
 va   v     e       hg aie   p g   if a  c
 ha gie   p g   hg aie   p g      v     e       if a   
    price equilibrium
generally  an allocation  v     e     is a competitive equilibrium at prices p if  v     e     is feasible and
assigns to each agent an allocation that optimizes the agents surplus at p  for our model  this means
specifically 
   

fid ecentralized s upply c hain f ormation

 a producers optimal choice is to be either active and feasible  or to acquire no goods  hence 
a producer in the allocation obtains nonnegative surplus by being active  and a producer not
in the allocation would obtain nonpositive surplus by being active 
   v    



p g  

    v    



p g  



p g      



p g      

hg ie

h gie

h gie

hg ie

 because a consumer receives value for obtaining at most one good  a consumers optimal
choice is to obtain the good that gives it maximum nonnegative surplus  and to obtain no other
goods at a positive price  furthermore  a consumer not in the allocation  i e   not obtaining
any goods  would obtain nonpositive surplus from any good 
c  c v     hg  ci  e     g   arg max
vc  g     p g   
 
g g

 vc  g   p g    
 hg    ei  g     g  p g       
c  c  v     g  g 
vc  g   p g    
figure   shows an example of a competitive equilibrium for network greedy bad  the prices
are shown under their respective goods 
a 
 

 

a 

 

 

 

a 

 

 

 

a 

 

 

 

 

a 
 
 
 

a 
 

 

cons

  

  

a 
 

figure    a competitive equilibrium for network greedy bad 

a competitive equilibrium allocation is stable in the sense that no agent would want a different
allocation at the equilibrium prices  moreover  from equilibrium there is no way to reallocate the resources  including money transfers  so that some agent has greater surplus  without degrading some
other agents surplus  this absence of further gains from trade is referred to as pareto optimality 
given quasilinear utility  price equilibria have been shown to be efficient under fairly general conditions  bikhchandani   mamer        gul   stacchetti        ygge         this also holds for
the particular case of task dependency networks  as stated in corollary   
   

fiwalsh   w ellman

p     
  
a 
 
a 
 
a 
 
a 
 

 
p     
  
 
p     
  
 
p     
  

a 
 

  
  p     
    

p     
  
 

a 
 

 

cons
 

a 
 

 

figure    network greedy bad with costs and values that do not support competitive equilibrium 

    existence of competitive equilibrium
not all task dependency networks have competitive equilibria  consider again network greedybad but with vcons      as shown in figure    the allocation shown is the only efficient allocation 
hence any equilibrium must support it  recall that in equilibrium  active agents must obtain nonnegative surplus  and inactive producers must not be able to obtain positive surplus  the price inequalities under the goods follow from constraints on the surplus associated with agent activity  the lower
bounds on the prices of goods       and   ensure that producers a   a   and a   respectively receiv e
nonnegative surplus  the upper bound on   ensures that a  could not obtain positive surplus  the
lower bound on   ensures that a  would receive nonpositive surplus  propagating these bounds to
   we see that p        to give a  positive surplus  but also that p       to give cons nonnegative
surplus  since this is impossible  a competitive equilibrium cannot exist 
technically  non existence of equilibrium is due to complementarity of inputs for producers with
discrete quantity goods  in fact  complementarities are necessary to preclude competitive equilibrium in task dependency networks  a network has no input complementarities when all producers
have at most one input 
theorem   competitive equilibria exist for any network with no input complementarities 
we defer the proof of this and subsequent theorems to appendix a 
consider again figure    the multiple undirected paths between   and   give rise to the lower
bound on the price of good    it turns out that these undirected cycles are also necessary to preclude
competitive equilibrium 
a polytree is a graph in which there is at most one undirected path from any vertex to another 
recall that in task dependency networks  if a producer uses multiple units of a good  then each unit
is represented by a separate edge  it follows that an allocation is a polytree iff no more than one unit
of a good is used to produce another given good  or used in multiple ways to produce a good 
theorem   competitive equilibria exist for any polytree 
   

fid ecentralized s upply c hain f ormation

    approximate price equilibrium
we should generally expect that market protocols based on discrete price adjustments  such as the
samp sb protocol we describe in section    would overshoot exact equilibria by at least a small
amount  therefore  our analysis emphasizes approximate equilibrium concepts  demange et al  
      wellman et al       a   we introduce a particular type of approximation    competitive
equilibrium  defined in terms of parameters that bound the degree to which agents acquire suboptimal surplus  intuitively  b bounds the suboptimality of a consumers surplus  s bounds the
suboptimality of a producers surplus attributable to its output  and g bounds the suboptimality of
a producer s surplus attributable to input g  as described in section    these parameters also have
special interpretation in our market protocol as applied to task dependency networks 
denote as ha  p  the maximum surplus that agent a can obtain in  v  e   at prices p  subject to
feasibility  that is 
ha  p  
max  a   v     e      p 
 v    e     v e 

such that a is feasible at  v     e     
definition      competitive equilibrium  given the parameters 
 b   s    
  for all    and all g  g 
g

an allocation  v     e     is in   competitive equilibrium at prices p iff 
   for all a  a   a   v     e      p     
   for all c  c   c   v     e      p   hc  p   b  
   for all         v     e      p   h  p    hg ie g   s    and  is feasible at  v     e     
   all goods are in material balance 
consider network greedy bad with the same prices shown in figure   except that p        
this does not constitute an exact competitive equilibrium because a   though inactive  could make
a positive profit  however  if  a     a     a    s     then since ha   p       a  obeys condition  
and the allocation is a   competitive equilibrium at the specified prices 
theorem   if  v     e     is a   competitive equilibrium for  v  e  at some prices p  then  v     e     is
a feasible allocation with a nonnegative value that differs from the value of an efficient allocation
by at most   hg ie g   s      c b  
a   competitive equilibrium corresponds to the standard notion of competitive equilibrium
g
when b   s      and      for all  and g 
corollary    to theorem    a competitive equilibrium allocation is efficient 
as noted in section      this is consistent with previously established results 

   

fiwalsh   w ellman

    valid solutions
in the following sections we show that   competitive equilibria can be a useful concept for analyzing decentralized market protocols  however  such protocols do not always reach   competitive
equilibria for all networks  hence we also consider weaker constraints on prices  consistent with a
lesser degree of agent optimization in a solution allocation 
we say that a solution  v     e     is valid with respect to prices p if 
   each consumer in the solution pays no more than its value for a single good  that is  for all
c  c v     there exists a single hg  ci  e   such that
p g   vc  g  
and p g        for all g     g such that hg    ci  e    
   none of the active producers are unprofitable  for all    v   where h  g i  e   we have
    v     e      p      note that solution validity does not preclude an inactive producer from
being unprofitable  i e   it admits dead ends  
note that     effectively states that consumers do not obtain negative utility  which is weaker than
the competitive equilibrium conditions in that it does not require consumers to receive their optimal
allocation  similarly      does not require producers to optimize  as in competitive equilibrium  but
only requires nonnegative utility for active producers 
a 
 

 

a 

 

 

 

a 

 

 

 

a 

 

 

 

 

a 
 
 
 

a 
 

 

cons

  

  

a 
 

figure    a valid solution for network greedy bad 
figure   shows an example valid solution  with the same underlying costs and values as in
figure    because it allows dead ends  validity does not directly provide useful bounds on the
inefficiency of an allocation 

   samp sb protocol
the preceding section introduces some static properties of price configurations and allocations 
here we address the problem of how prices might be obtained  to compute prices and allocations 
we must elicit information bearing on the relative value of goods  through some systematic communication process  mechanisms that determine market based exchanges based on messages from
agents are called auctions  mcafee   mcmillan        
   

fid ecentralized s upply c hain f ormation

the agents bidding policies represent their strategies for interacting with the auctions  whereas
the auction mechanism may be designed by a central authority  bidding policies are generally determined by individual agents  to understand the implications of the auction design requires an
analysis of the market protocol that arises from the combination the auction mechanism and the
agent bidding policies 
the space of potential auctions is expansive  wurman et al          and definitive theoretical
results are currently known only for fairly limited classes of problems  bikhchandani   mamer 
      demange   gale        gul   stacchetti        klemperer        mcafee   mcmillan 
       complementarities with discrete goods  which can cause nonexistence of price equilibria 
also greatly complicate auction design and analysis of auctions  milgrom        
for our supply chain domain  we have investigated a particular protocol  called samp sb  simultaneous ascending  m   st price with simple bidding   as demonstrated below  samp sb
can produce good allocations which  in some cases  are consistent with competitive price equilibrium theory 
    auction mechanism
the samp sb mechanism comprises a set of auctions  one for each good  auctions run simultaneously  asynchronously  and independently  without direct coordination  agents interact with the
auctions by submitting bids for goods they wish to buy or sell  a bid is of the form    q  p           qn
pn     each pair  qi pi   indicates an offer to buy or sell the good  with qi indicating the quantity of the
offer and pi indicating the price  if qi      it is an offer to buy qi units of the good for no more than
pi per unit  and we refer to it as a buy offer  if qi      it is an offer to sell qi units for no less than
pi per unit  and we refer to it as a sell offer  because no agent both buys and sells the same good
in a task dependency network  a bid contains either all positive or all negative quantity offers  bids
possess what is sometimes called additive or semanticsthe offers are treated exactly as if they
came from separate bids  hence the auction can match any of the individual offers independently 
without loss of generality  we henceforth impose the restriction  qi       for all offers in all bids 
continuing to allow that agents may submit multiple offers in a bid 
when an auction receives a new bid  it sends each of its bidders a price quote specifying the
price that would result if the auction ended in the current bid state  price quotes are not issued
until all initial bids are received  but are subsequently issued immediately on receipt of new bids 
because some offers may be tied at the current price  this information alone is not sufficient for an
agent to tell whether it is winning an offer placed at that price  to clarify this ambiguity  the price
quote also reports to each bidder the quantity it would buy or sell in the current state  the same
prices are sent to all bidders  but the reported winning state is specific to the recipient  agents may
then choose to revise their bids in response to the notifications  if an agent does not wish to change
its bid  inaction leaves its previous bid standing in the auction  
we assume that communication is reliable but asynchronous   that is  all messages sent eventually reach their recipients  although we impose no bound on the delays  agents and auctions use
message ids to ensure that they handle messages in the appropriate order  note that even if all auctions and agents have deterministic behaviors  an overall run of samp sb may be nondeterministic
due to this asynchrony 
   technically  we adopt the model of asynchronous reliable message passing systems  fagin et al         

   

fiwalsh   w ellman

under asynchrony  it is helpful for the auction to send the id of the most recent bid received
from the agent with its price quote  an agent responds only to a price quote that reflects its most
recent bid sent  without this device  an agent can have difficulty establishing feasibility  as its
understanding of its input and output bid states may be based on nonuniformly delayed reports 
bidding continues until quiescence  a state where all messages have been received  no agent
chooses to revise its bids  and no auction changes its prices  ask prices  or allocation  at this point 
the auctions clear  each bidder is notified of the final prices and how many units it transacts in each
good  note that a quiescent system is not necessarily in a solution state or  approximate  equilibrium
state 
although detecting quiescence is straightforward in a centralized system  in a decentralized 
asynchronous system we need to perform the operation using only local message passing  in previous work  wellman   walsh         we described a protocol for detecting quiescence in general
distributed negotiations  based on a well known termination detection algorithm 
each auction runs according to  m   st price rules  satterthwaite   williams             
wurman et al          the  m   st price auction is a variant of the  second price  vickrey auction  vickrey         generalized to allow for the exchange of multiple units of a good  given a set
of offers including m units offered for sale  the  m   st price auction sets a price equal to the price
of the  m   st highest offer over all of the offers  the price can be said to separate the winners
from the losers  in that the winners include all sell offers strictly below the price and all buy offers
strictly above the price  some agents that offer at the  m   st price also win  in case of ties  offers
submitted earlier have precedence  winning buy and sell offers are matched one to one  and pay
 or get paid  the  m   st price 
when issuing price quotes  the auction reports both the price  i e   the current going price  or
 m   st price   p g  and the ask price   g  of the good g  the ask price specifies the amount above
which a buyer would have to offer in order to buy the good  given the current set of offers  the ask
price is determined by the price of the mth highest of all offers in the auction  hence  g   p g  
for instance  if we have buy bids         and   and sell bids         and    p g         g       
and if the auction is in quiescence  the buy bids    and    would match the sell bids    and    and
trade at p g       
because a producer has complementary inputs  ensuring feasibility is a challenging problem 
requiring careful design  the auctions run simultaneously  and each auction requires that the prices
of an agents successive buy offers increase by no less than some  generally small  positive number
b and the prices of successive sell offers increase by no less than s    an auction can enforce the
ascending rule by simply rejecting an agents offer if the price does not increase by b or s   by
constraining the direction of price changes  this design gives producers a more accurate indication of
the relative prices for inputs and outputs than if prices were allowed to fluctuate in both directions 
the ascending bid restriction ensures ascending auction prices  with one technicality  due to
asynchrony and immediate issuance of price quotes  if the initial bid from an agent arrives after a
higher bid  the price quote could decrease  this can be handled simply at the auction by issuing no
price quotes until some specified period of time after the auction opens  after the first price quote
is issued  the auction accepts new bids only from agents that had previously placed bids 
it is common in auction literature and practice to place an ascending restriction on buy offer
prices  it may seem counterintuitiveand is in fact atypicalto place the same restriction on
   these rules differ from those of a more typical simultaneous ascending auction  demange et al         milgrom 
       which specify that agents must submit offer prices that are at least an increment above the current price 

   

fid ecentralized s upply c hain f ormation

sell offer prices  however  such an ascending offer price restriction ensures that price quotes rise
monotonically as the auctions progress  section     shows how an ascendingoffer price restriction for both buy and sell offers serves a key role in establishing the relationships between system
quiescence and solution convergence of the system 
    bidding policies
although designers of negotiation mechanisms do not generally have control over the agents behaviors  any conclusions about the outcome of a mechanism must be based on some assumptions
about these behaviors  a typical assumption in economics is that agents are rational in some sense 
for example that they play policies that form a bayes nash equilibrium  however  as discussed in
section      the complexity of supply chain formation markets is beyond the current state of the art
in analyzing bayes nash equilibria with simultaneous ascending auctions  instead  our analysis assumes that the agents follow a simple  non strategic bidding policy  described in this section  other
variations may be reasonable  or perhaps better in some respects than the policies we describe 
rather than explore the range of possibilities  we chose in this work to investigate a particular set of
policies in depth  our chosen policies obey the ascending offer restriction enforced by the auction 
respect the locality of information in that they require no knowledge of other agents in the system 
and are myopic in that they use only information provided by the current price quotes  without
forecasting future prices 
recall that a consumer wishes to acquire a single good that maximizes its surplus at the given
prices  we assume that a consumer initially offers zero for each good of interest  so long as it is
winning a good  it does not change its offer  whenever it is not winning a good  it offers p g     b
for good g   arg maxgg  vc  g   p g   b   if vc  g    p g    b     otherwise it stops bidding 
a producers objective is much more complex  namely to maximize the difference between the
price it receives for its output and the total price it pays for its inputs  while remaining feasible  we
assume that a producer initially offers zero for each of its input goods  and gradually increases these
offers to ensure feasibility  it raises its offer price for an input good by b if and only if the price
quotes indicate that it is losing that good but winning its output 
we assume that producer  bids for its output good g in an effort to recover its production cost
and the perceived costs of its inputs  the producer places its first output offer only after receiving
the first price quotes for all its inputs  and subsequently updates its output offer whenever it receives
a new price quote on any input  for simplicity  consider the case in which  has one offer  each at
quantity one  for each input  if  is currently winning an input g  its perceived cost  p  g  of g is
simply p g   when  is not currently winning g with a particular offer  p  g    max  g   p g   
b    if  is the price of the previous offer made by  for g   then when its perceived costs increase 
 offers max    s   hg ie p  g   for its output g   if  has multiple offers for a good g  then
it assumes a separate perceived cost with respect to each offer  and bids for its output accordingly 
figure   shows how a producer would bid next as a function of the current prices and its current
offers  when b     and s    
note that throughout the negotiation  a producer places bids for its output goods before it has
received commitments on its input goods  producers counteract potential risk by continually updating their bids based on price changes and feasibility status  a producer reduces exposure to dead
ends by incrementing its offer prices on inputs by minimal amounts and only when necessary 
   

fiwalsh   w ellman

current offer price for a    
a
p a     
 a     

c
 

b
p b     
 b     

good

next offer
price

a
b
c

hold at  
 
 

current offer price for c    

current offer price for b    

figure    a producers next offers  according to samp sb  when b     and s     the dashed
arrow from good b indicates that the producer is currently losing b  the solid arrows
indicate that the producer is currently winning goods a and c 

    bidding with general preferences
the task dependency network model represents fairly simple production capabilities and consumer
utility  here we discuss some natural potential extensions of the bidding policies to a broader class
of capabilities and preferences 
a producer capable of variable unit production could bid exactly as if it were multiple identical
producers  such a producer would maintain separate offers in its bids for each unit  and update
the separate offers independently  similarly  a consumer with additive value for multiple goods  or
multiple units of a good  could bid for each unit of each good as if it were a separate consumer 
a producer with alternatives on some input  independent of other inputs  can switch its bidding
to the currently cheapest option  subtle issues can arise for a producer that has alternative input sets 
particularly when it is tentatively winning parts of the sets  one option would be to focus bidding on
the set with the lowest perceived cost  which may include a premium for goods not in the tentatively
winning set  alternatively  the producer could assume that it will definitely win its tentatively won
goods and effectively treat them as sunk costs  fractional accounting of sunk costs may also be
reasonable  similar considerations arise for extensions presenting complex consumption choices 
    properties of samp sb
in this section we describe a number of theoretical properties of samp sb  in section       we
describe properties relating to convergence to quiesence  in section       we present properties relating to efficiency and convergence to price equilibrium  and in section       we present properties
relating to solution convergence 
      c onvergence

to

q uiescence

the samp sb auctions and bidding policies guarantee that the system will always reach quiescence 
theorem   samp sb reaches quiescence after a finite number of bids have been placed 
however  convergence can take a long time 
observation   in an asynchronous environment  it is possible that a run of the protocol may require
a number of bids that is exponential in the network size  and not a function of the consumer value 
   

fid ecentralized s upply c hain f ormation

   

   

  a

 
 

   

start
 
 

  b

  a

 

 

   

 
   

   

  a

 
 

   

 
   

  b

 

 
   

 
consumer
 

  b

 

figure    network exponential  a network that may require an exponential number of bids to
reach quiescence 

figure   shows network exponential  which illustrates this observation  the agent named
start places a one time bid to sell one unit of good   for     since          and producers     and
    are initially losing their input bids  these agents each offer a price of   for their output goods 
producer     will receive the new price quotes for goods   a and   b asynchronously  hence may
update its bid for good   twice  offering a price of   the first time and a price of   the second
time  continuing with this process  we see that producer     updates its bid for good   up to eight
times  if we extend this network and maintain labeling consistent with figure    then producer n  
would place o  n   bids for good n  note however  that if bids and price quotes are propagated
synchronously  the exponential growth would not occur 
in the example above  most of the bids are actually superfluous in that they do not meaningfully
affect the outcome of the protocol  this appears often true of situations exhibiting the worst case
behavior described  to capture the distinction between relevant and irrelevant bidding  we introduce
the notion of quasi quiescence  a persistent state from which all subsequent bids effectively do not
matter for solution convergence  samp sb convergence to quasi quiescence requires a number of
meaningful bids that can be bounded by the size of the network and the value of the maximum
consumer value 
definition    quasi quiescent  a run of samp sb is in a quasi quiescent state when  for any consumer or active producer   all bids by  have been received and  would not change its bids in
response to any price quotes already received or transmitted by auctions 
clearly  the requirements of quasi quiescence are subset of the requirements for quiescence 
observation   a quiescent state is a quasi quiescent state 
theorem   if a run of samp sb reaches a quasi quiescent state  then it remains in a quasiquiescent state  furthermore  neither the allocation nor the prices p subsequently change 
this theorem means that  once quasi quiescence is reached  all subsequent bids effectively do
not matter in terms of equilibrium and solution convergence 
corollary    to theorem    the quiescent state of samp sb is a   equilibrium or valid solution
iff the first quasi quiescent state reached is a   equilibrium or valid solution  respectively 
the following theorem establishes a bound on the number of relevant bids necessary to reach
quasi quiescence 
   

fiwalsh   w ellman

theorem    samp sb reaches a quasi quiescent state after a number of bids bounded by a polynomial of the size of the network and the value of the maximum consumer value have been placed
by consumers and active producers 
our previously mentioned quiescence detection protocol  wellman   walsh        can also detect
quasi quiescence  and thus terminate negotiations when it is reached 
      e fficiency

and

c onvergence

to

p rice e quilibrium

we intentionally use b and s   to parametrize both samp sb and our concept of   competitive
equilibrium  with an interpretation of g in terms of prices and ask prices  we can specify necessary and sufficient conditions for which the result of samp sb corresponds to a   competitive
equilibrium 
theorem    the prices and allocation determined in quiescence by the samp sb protocol is a
  competitive equilibrium  with g   max  g   p g   b    iff no inactive producer buys any
positive price input 
from theorems   and     we can establish bounds on the inefficiency of a   competitive equilibrium  parametrized by g   max  g   p g   b   for each good  in some cases  the difference
between  g  and p g  may be quite high  however  we can actually establish a tighter bound 
theorem    if  v     e     is a   competitive equilibrium computed by samp sb  then  v     e     has
a nonnegative value that differs from the value of an efficient allocation by at most     hg  i 
e   b   s      c b  
note that the theorem replaces  from theorem   with b in the bound 
a network is a tree if it is a polytree with no more than one consumer 
g

theorem    the quiescent state of samp sb is a   competitive equilibrium for a tree 
we are unaware of other general network structures for which samp sb is guaranteed to converge to a   competitive equilibrium  however  theorem    implies that we can improve allocations if we modify samp sb to avoid dead ends  we say that a bidding policy is safe for a producer
if the producer cannot obtain a negative surplus in quiescence  it is clear that if a protocol is safe for
all producers  then it will converge to   competitive equilibrium 
in samp sb we have assumed that a producer updates buy and sell offers simultaneously in
response to price quotes  this policy is not safe  even for single input producers  because the
producer bids for its input based on the state of its standing offer for its output  rather than the offer
it is about to place  the producer would get negative surplus if it does not win its new output offer
but gets stuck winning its new input offer  however  a slight variant of the bidding policy  which we
call safe samp sb  is safe for any single input producer  with this protocol  a producer updates
its input bids only when it would not update  and it currently winning  its most recent output offer 
clearly  safe samp sb has the same static properties as samp sb  hence theorem    applies to
safe samp sb 
theorem    the quiescent state of safe samp sb is a   competitive equilibrium for a network
with no input complementarities 
   

fid ecentralized s upply c hain f ormation

safe samp sb is not guaranteed to be safe for producers with multiple inputs in arbitrary
networks  nor do we know of any safe producer bidding policy that ensures safety for producers in
any arbitrary network  other than degenerate policies such as not bidding  
safe samp sb may take longer to reach quiescence than regular samp sb  with safe samp sb 
a producer must always wait for notification of the results of pending output offers before increasing input offers  for a producer to win an output offer may require propagations of many messages
through various paths in the network before buyers of the output good would increase their buy offer
prices for that good  the resulting delay would be greater than the local delay in communicating
with the output good auction 
that non   competitive equilibrium runs of samp sb result in dead ends suggests a potential
source of significant efficiency loss  for example  figure   shows the result of a run of samp sb
on network greedy bad  this valid solution has a dead end at producer a   since producer a 
incurs its cost of    to provide good   to a   but does not contribute to any value in the system  this
dead end is pure waste from a global efficiency perspective  the allocation is undesirable directly
for producer a  because it is committed to pay    for an input it cannot use  with large networks or
costs  dead ends can result in significant efficiency losses and negative profits to individual agents 
we propose a contract decommitment protocol to remove dead ends after samp sb reaches
quiescence  according to the decommitment protocol  each inactive producer can decommit from
its contracts for its inputs for which it would pay a positive price  the protocol is applied recursively
to the producers that lose their outputs due to decommitment  when the decommitment process
terminates  agents exchange goods as specified by the remaining contracts  we refer to samp sb
with decommitment as samp sb d 
in figure    producer a  would decommit from its contract with a   clearly  theorem    implies
that no agent decommits iff samp sb produced a   competitive equilibrium  moreover  if we
remove from consideration all producers that decommit  the remaining agents are in   competitive
equilibrium 
decommitment has the benefit that  whereas some producers can lose money in the samp sb
protocol  no agent receives a negative surplus from participating in samp sb d  however  this
is achieved by making the auction allocations non binding  which is undesirable to the producers
who lose their output sales to decommitments  it also begs the question of how to enforce the
requirement that inactive producers be the only agents that decommit 
in addition to dead ends  efficiency can also be lost if samp sb fails to find a solution when
a positive value solution exists  or if samp sb forms a solution with value inferior to an efficient solution  dead ends are not necessarily mutually exclusive of these two cases   in section  
we describe an experimental analysis of the efficiency  the source of inefficiency  and equilibrium
attainment of samp sb in a set of networks 
      s olution c onvergence
recall that samp sb always converges to a valid solution  specifically a   competitive equilibrium  for networks with tree structures  and the safe variant converges for networks with no input
complementarities  the following theorem shows that  with sufficiently high consumer value  regular samp sb can always converge to a  possibly non equilibrium  valid solution for polytrees 

   

fiwalsh   w ellman

theorem    if  v  e  is a polytree with a solution that assigns good g to consumer c  then given
all other costs and values  there exists a value vc  g  such that samp sb is guaranteed to converge
to a valid solution  v     e     for c 
because dead ends may result  we cannot usefully bound the inefficiency of the solution reached by
samp sb in a polytree 
for general network structures  the prices of all sell offers for all consumers goods could rise
above their values  in which case the system will necessarily reach quasi quiescence in a nonsolution state  if  however  quasi quiescence is reached before the price of some consumers good
reaches its value for the good  we have a valid solution 
theorem    if samp sb reaches quasi quiescence with p g    vc  g  for some hg  ci  e  c  c 
then the systems state represents a valid solution 
the next theorem establishes conditions under which a valid solution state will immediately
lead to quasi quiescence 
theorem    if a run of samp sb in  v  e  is in a valid solution state such that 
 each consumer c is either winning an offer or p g    b   vc  g  for all hg  ci  e 
 all agents have correct beliefs about which goods they are currently winning 
 all bids from consumers and active producers have been received in response to the current
price quotes 
 and no sell offers are lost due to tie breaking 
then after the subsequent price quote from each auction  the system will be in a quasi quiescent
state with a valid solution 
although samp sb is not guaranteed to converge to a solution  the fact that the problem of finding a solution is np complete  walsh et al         should lead us to expect that there are problems
for which samp sb would converge to a solution only after an exponential number of meaningful
bids  since the number of meaningful bids is bounded by a polynomial of the maximum consumer
value  we should further expect that there exist networks for which samp sb can converge to a
solution only with a exponential consumer values  in practice we find that we can construct problems for which the consumer value must be exponential in order for samp sb to converge to a
solution  walsh et al          however  we have run many simulations for which the required value
is much more reasonable  walsh et al         
for some networks  costs  and values  samp sb cannot converge to a valid solution with some
values of b and s   no matter how high the consumer value  one example  the simplest we have
been able to construct  is network no converge  shown in figure     observe that a solution
must include agent a   but cannot include a   agent a  always offers a price of at least p        
for good    hence a  cannot win two units of good   for less than p         each  thus agent a  will
always offer a price of at least  p         for good    since agent a  will never offer a price more
than  p        a  for good    agent a  could only win good   if  a       but  for this to occur 
we must have b      a more thorough analysis  taking into account the dynamics of samp sb 
shows we must have b     and s     to obtain a valid solution in quiescence  and then only for
certain patterns of asynchrony 
   

fid ecentralized s upply c hain f ormation

a 
a 

 

 

 

a 

  

 

a 

 

 
a 
 

cons

a 

 

 

 

a 

a 

  

  

figure     network no converge  a network for which samp sb cannot converge to a solution
for certain values of b and s  

   empirical performance of samp sb
whereas our analytic results provide some insight into samp sb and its variants  they do not support a comprehensive characterization of performance  except for certain special case network structures  in order to gain further understanding of the effectiveness of samp sb and samp sb d  we
performed an empirical study based on protocol simulations on sample task dependency networks 
    setup
our investigation focuses on a small set of networks exhibiting a variety of structural properties 
simple  figure      unbalanced  figure      two cons  figure      bigger  figure      and
many cons  figure      we also also studied network greedy bad  figure    
a 

 

a 

 

c 
     

a 

 

a 

figure     network simple 
we ran experiments on multiple instances of each network  for each instance we randomly
chose producer costs uniformly from         but for each consumer in a network  we calculated
a fixed value so that  excluding all other consumers  there exists a positive surplus solution for
this consumer with     probability  we determined consumer values via simulation  assuming the
specified distributions of producer costs  we discarded all instances whose efficient solutions had
value zero  we set b   s       
to test the effect of competitive equilibrium existence on the performance of the protocols 
we generated instances of unbalanced  two cons  and greedy bad with costs that admit
competitive equilibrium and with costs that do not  because simple and many cons are polytrees 
   

fiwalsh   w ellman

 

a 

a 
 

a 

a 

 

a  
a 

 
 

a  
a 

 

a 

 

a 

 

a 

 

  

c 
    

a  

a  

a  
a  

  

figure     network unbalanced 

a 
a 

 

 

c 
    

a 
 

c 
    

a 

 
a 

figure     network two cons 

a 

 

a  

a 

a 

 

a 

 

a  

a  

a  
  
a  

a 

 

a 

 

a  

a 

 

a  

a 

 

a  

a  
  

 

a  

a  
a  
  
a  

a  

  
  

a  

a  
  

a  

a  

a  

a  
  

  
a 

 

a  

a  

a  

figure     network bigger 

   

c 
    

fid ecentralized s upply c hain f ormation

a 

 

a 

 

a 

 

a 

 

a 

 

a 

 

a  

  
a  

  

c 
    

a  

  

a  

a  

  
  

a 

 

    
a  

a 

 

a 

 

a  

  

a  

  

a  

  

c 

  

a  
a  

  
a  

  

c 
    

a  

  

figure     network many cons 
we know from theorem   that all instances thereof have competitive equilibria  we were not able
to generate no equilibrium instances of bigger with the given cost distributions 
to generate an instance with a desired type of cost structure  equilibrium or no equilibrium 
we repeatedly chose sets of producer costs randomly from the uniform distribution until the desired
property was met  in the experiments  we determined whether competitive equilibrium existed
given complete information about the network structure  values  and costsusing the following
procedure  recall that a competitive equilibrium is always efficient  corollary     hence  given
an optimal allocation  v    e     we attempt to solve the system of linear equations that characterize
a competitive equilibrium  as described in section      if a solution to the equations exists  the
resulting prices constitute a competitive equilibrium  otherwise no equilibrium exists  we used
cplex  a commercial mixed integer linear programming package  to find the efficient allocation
and to solve the corresponding equilibrium equations 
for each type of cost structure in each network  we tested     random instances  with the exception of simple  for which we tested      instances   for each instance and each protocol  we measured the efficiencythe fraction of the efficient valueattained by samp sb and samp sb d 
we also measured the percentage of available surplus  i e   percentage of the value of an optimal
solutions  obtained by the producers 
    results
we classify the efficiency of a run of the protocols in one of four ways  negative  zero  suboptimal
 but positive   and optimal efficiency  table   shows the distribution of the efficiency classes in our
experiments  note that samp sb d cannot produce negative efficiency  by construction 
   we tested more instances of simple as a part of a broader study  walsh et al         

   

fiwalsh   w ellman

network
simple
unbalanced  case 
 equilibrium exists
 no equilibrium exists
two cons  case 
 equilibrium exists
 no equilibrium exists
bigger
many cons
greedy bad  case 
 equilibrium exists
 no equilibrium exists

samp sb
  of instances
neg zero sub opt
   
   
        

samp sb d
  of instances
zero sub
opt
   
   
    

   
     

   
   

   
   

    
   

   
     

   
   

    
   

    
    
   
    

   
   
   
   

   
    
   
    

    
   
    
    

   
   
   
   

   
    
   
   

    
   
     
    

   
     

   
   

    
   

    
   

   
     

   
   

    
   

table    distribution of efficiency classes from samp sb and samp sb d  efficiency classes 
negative  neg   zero  suboptimal  sub   and optimal  opt  

recall  from section        that efficiency loss in samp sb can be attributable to any of three 
not necessarily exclusive  causes  dead ends  failure to form a solution when a positive valued
solution exists  and finding a suboptimal solution  we can infer the percentage of instances exhibiting dead end suboptimality in samp sb by examining the differences between samp sb d and
samp sb totaled over the negative  zero  and suboptimal columns in table    decommitment
does not affect the contribution of no solution and suboptimal solution losses  but helps reveal them
by eliminating dead end suboptimality  hence  we can infer the percentage of instances exhibiting no solution and suboptimal solution suboptimality in samp sb by examining the zero and
suboptimal columns of samp sb d  respectively 
table   shows the average efficiency attained by the protocols  factored by network and equilibrium existence  where relevant   we see  from the difference between the samp sb d and
samp sb columns  that dead ends are a significant source of inefficiency  additionally  existence
of competitive equilibrium has a significant effect on the performance of the protocols  in these networks  samp sb d produces nearly perfect efficiency when competitive equilibrium exists  recall
that all studied instances of simple  bigger  and many cons have equilibria   but is is much less
effective when equilibrium does not exist  in fact failing to find any solutions in the no equilibrium
cases of unbalanced and greedy bad 
to check whether these differences in performance are significant  we performed students ttests for each protocol  comparing the mean efficiencies of instances that admit competitive equilibrium with the means of those instances that do not admit competitive equilibrium  table   shows
the results  indicating the p values that the means of equilibrium and no equilibrium instances came
from the same underlying population  in typical analyses  the null hypothesis that the means are
equal is rejected if the p value is below       with this threshold  it seems we can safely reject the
hypothesis that the mean efficiencies of equilibrium and non equilibrium instances are the same for
   

fid ecentralized s upply c hain f ormation

network
simple
unbalanced
 equilibrium exists
 no equilibrium exists
two cons  case 
 equilibrium exists
 no equilibrium exists
bigger
many cons
greedy bad  case 
 equilibrium exists 
 no equilibrium exists 

samp sb
     

samp sb d
     

     
      

     
     

     
     
     
     

     
     
     
     

     
      

     
     

table    average efficiency in each network for the protocols 

network
unbalanced
two cons
greedy bad

samp sb

samp sb d

          
         
         

           
          
           

table    p values computed with the students t test  the t test compared the means efficiencies
of instances that admit competitive equilibrium and those that do not admit competitive
equilibrium 

   

fiwalsh   w ellman

networks unbalanced and greedy bad  inspection of the data further supports this conclusion  as samp sb d essentially always produces zero efficiency  but produces perfect efficiency in
many of the instances that do admit competitive equilibrium 
on the face of it  the high samp sb greedy bad p value suggests that we cannot safely
reject the hypothesis that the mean efficiencies differ between the equilibrium and no equilibrium
instances of the network  however  inspection of the data indicates that this high probability results from one outlying equilibrium instance with a large negative efficiency  indeed  the fact that
samp sb d always produces essentially optimal results in instances that admit competitive equilibrium  but predominantly produces suboptimal results in the instances without such equilibria 
suggests that it is unlikely that the equilibrium and no equilibrium means are the same for samp sb
in network greedy bad 
network
simple
unbalanced
 equilibrium exists
 no equilibrium exists
two cons  case 
 equilibrium exists
 no equilibrium exists
bigger
many cons
greedy bad  case 
 equilibrium exists
 no equilibrium exists

    competitive
equilibrium
   
  
 
  
 
  
  
  
 

table    percentage of instances in which samp sb attained   competitive equilibrium 
table   shows the percentage of instances for which samp sb attained   competitive equilibrium in each network  it is straightforward to determine whether   competitive equilibrium
is attained by observing whether there are any dead ends  theorem      again  we see a strong
connection with the existence of competitive equilibrium  one notable exception is many cons
 which always admits a competitive equilibrium   for which samp sb frequently produced dead
ends  we do see that   competitive equilibria form in a small percentage of the no equilibrium
two cons instances  although this is not a prevalent phenomenon with the b and s parameters
we chose 
table   shows the average efficiency  factored by   competitive equilibrium attainment
 samp sb and samp sb d produce the same results when   competitive equilibrium is attained   we must be careful in drawing conclusions from these statistics because  for any given
network case  there were relatively few or many   competitive equilibrium instances  table    
still  we note certain salient trends  the   competitive equilibrium runs produce near perfect efficiency  with smaller degrees of inefficiency than specified by the bounds in theorem     because
an allocation produced by samp sb is a   competitive equilibrium iff there are no dead ends  we
should expect that a significant portion of efficiency loss in non   competitive equilibrium pro   

fid ecentralized s upply c hain f ormation

network
simple
unbalanced
 equilibrium exists
 no equilibrium exists
two cons  case 
 equilibrium exists
 no equilibrium exists
bigger
many cons
greedy bad  case 
 equilibrium exists
 no equilibrium exists

  equilibrium
not found
samp sb samp sb d
n a
n a

  equilibrium
found
samp sb  samp sb d
     

     
     

     
     

     
n a

     
     
     
     

     
     
     
     

     
     
     
     

     
     

     
     

     
n a

table    average efficiency in each network for the protocols  factored by   competitive equilibrium attainment 

ducing runs of samp sb would be attributable to negative surplus incurred from dead ends  the
significant differences between the efficiency of samp sb d and samp sb shown in the non  competitive equilibrium column provides evidence for this hypothesis  indeed  it appears that
surplus lost to dead ends  as opposed to suboptimal solution attainment  is the dominant cause of
inefficiency when   competitive equilibrium is not attained  in all instances  improvement from
decommitment is greater than the difference between the efficiency of samp sb d and optimal
efficiency 
table   shows the average fraction of available surplus obtained by producers  respectively  in
each network  perhaps surprisingly  in some networks the producers can gain significant surplus
with the samp sb d protocol  even though they are bidding to obtain zero surplus  the reason
for this is that a producers output offer indicates the minimum amount it is willing to accept in
exchange for its output  but rising buy offers can cause the price to rise above the producers output
offer  this could happen in cases when it is necessary to block out certain agents to have a feasible
allocation in quiescence  note however  that the decommitment step is needed for the producers to
obtain high average surplus  without decommitment  the average producer surplus can be highly
negative  as shown in the samp sb column 

   related literature
in this section we discuss literature related to our present work  in section     we discuss related
literature on price based analysis and auction theory  and in section     we discuss related literature
on supply chain formation 
   

fiwalsh   w ellman

network
simple
unbalanced  case 
 equilibrium exists
 no equilibrium exists
two cons  case 
 equilibrium exists
 no equilibrium exists
bigger
many cons
greedy bad  case 
 equilibrium exists
 no equilibrium exists

samp sb
     

samp sb d
     

     
     

     
     

     
     
     
     

     
     
     
     

    
     

     
     

table    average fraction of available surplus obtained by producers in each network for the protocols 

    price based analysis and auction theory
we have shown some special cases for which competitive equilibria exist in task dependency networks  polytree and single input producer networks   that samp sb always finds   competitive
equilibrium in trees  and that a minor variant always finds   competitive equilibria in single inputproducer networks  a review of the results in price equilibrium and auction theory reveals that such
limited positive results are typical 
it is well known that given arbitrarily divisible goods and convex utility  cost  and production functions  competitive equilibrium prices exist  if additionally  the gross substitutes condition
 which is a generalization of no complementarities  is met  the classic tatonnement procedure finds
competitive equilibrium in a distributed manner  
when goods are discrete  competitive equilibria exist in exchange  non production  economies
if the gross substitutes conditions are met  bikhchandani   mamer        gul   stacchetti       
kelso   crawford         milgrom        showed that the existence of a single complementarity
can be sufficient to preclude equilibrium in exchange economies  bickhchandani and mamer       
also show existence under a variety of other conditions  which do not appear to have natural interpretations in task dependency networks  in exchange economies  the gross substitutes condition
also ensures convergence to  approximately  competitive equilibria with simultaneous ascending
auctions  demange et al         gul   stacchetti        
that distributed price based auction protocols can leave agents with undesired goods when their
preferences are complementary  e g   dead ends in a task dependency network   is a widely recognized problem  an alternative approach is to use a combinatorial auction  which mediates negotiation at a single location  performing global matching of combinations of goods based on indivisible
bids  this general approach has received much attention in the ai community as of late  motivated
   the reader may consult a standard microeconomic textbook  mas colell et al         for details on these results 

   

fid ecentralized s upply c hain f ormation

in part by techniques for quickly performing the necessary global optimization  andersson et al  
      leyton brown et al         sandholm   suri        
currently  some results on combinatorial equilibria and auctions have been established for onesided  i e   buyer only  bidding  bikhchandani and ostroy        and wurman and wellman        
using different combinatorial frameworks  provide positive results on equilibrium existence  and
properties thereof  wurman and wellman describe a combinatorial auction for their framework 
parkes and ungar        describe a combinatorial auction that is guaranteed to converge to an
efficient allocation if agents follow myopic best response strategies  by adding an extend andadjust phase  these authors are able to obtain this allocation in ex post nash equilibrium  parkes
  ungar         ausubel and milgrom        present a proxy auction mechanism that obtains
efficient allocations with straightforward bidding in equilibrium when goods are substitutes 
in the present work we consider only simple  local  myopic bidding policies  these policies
are non strategic  in that agents do not reason about their effect on the negotiations in an attempt
to extract greater surplus  the assumption of non strategic behavior is plausible when there are a
large number of agents  in networks with many agents bidding for individual goods  many parallel
branches  or many agents in sequence  the potential contribution of any one agent to the value of a
solution is relatively small and there is little to gain by strategic behavior 
our experiments have shown that  even when producers bid to obtain zero surplus with the specified policy  they can obtain positive surplus in some networks  nevertheless  in smaller networks 
the potential for strategic improvement is more pronounced  and our non strategic assumption becomes less plausible  a widely studied concept used for analyzing strategic behavior is bayes nash
equilibrium   informally  a set of strategies constitutes a bayes nash equilibrium if no single agent
has an incentive to deviate from its strategy  given that all other agents play their bayes nash equilibrium strategies  mcafee and mcmillan        and klemperer        survey the state of knowledge of strategic analysis of auctions in exchange economies  milgrom        provides insights
on some of the fundamental challenges to understanding the agent behavior with complementary
preferences  however  definitive results are known only for quite restrictive market structures  and
do not encompass two sided markets with complementarities  never mind the multi level characteristic of negotiation in task dependency networks  the problem of even specifying the information
structure of the extensive form game of simultaneous ascending  m   st price auctions in task dependency networks  prerequisite to computing bayes nash equilibria  is well beyond the current
state of the art in game theoretic analysis 
as auction theory currently fails to provide satisfactory guidance for understanding strategic
behavior in even moderately complicated domains  some have used tournaments as a framework
for developing and evaluating candidate agent strategies  the santa fe double auction tournament  rust et al         provided some unexpected insights into effective strategies in continuous
double auctions  and the recent tac series of trading agent competitions  wellman et al       b 
      encouraged the development of sophisticated agent strategies  greenwald        stone  
greenwald        for a complex market game 
the vickrey clarke groves mechanism  clarke        groves        vickrey         also
called the generalized vickrey auction  gva   mackie mason   varian         is a direct revelation approach  where agents report their valuations on allocations  and the auction computes a
lump sum payment  for the gva  the solution is the optimal allocation based on the reports  and
   for a foundational reference  chapter   of fudenberg and tiroles game theory text        provides a formal treatment of the strategic issues in auction mechanism design and analysis 

   

fiwalsh   w ellman

the payment function is such that it is a dominant strategy for agents to report their true utility 
because of this incentive compatibility and perfect efficiency  the gva may seem ideal from an
economic perspective  although the computation can be intractable   however  the gva is not budget balancedwhen both buyers and sellers bid  the gva can pay out more money than it takes
in  unfortunately this is unavoidable  as it is impossible to simultaneously ensure efficiency  budget
balance  and individual rationality  no agent achieves negative surplus   myerson   satterthwaite 
       recently  babaioff et al   babaioff   nisan        babaioff   walsh        described
distributed auction mechanisms  based on mcafees trade reduction auction         that obtain incentive compatibility and budget balance in linear supply chains  at the expense of perfect efficiency 
recent work by parkes  kalagnanam  and eso        explores methods to minimize the deviation
from efficiency while maintaining budget balance in two sided gva like mechanisms 
    supply chain formation
supply chain managementthe problem of accurately forecasting and planning production and deliveries to meet demand and minimize inventoryis an active field of study in operations research 
the problem of management differs from supply chain formation in that the exchange partners in
the supply chain are pre established  and it is assumed that information can be gathered from all
agents to effectively optimize global production across the supply chain  in contrast  in this work
we approached the problem of automating the process of determining supply chain participants dynamically  under the assumption that information and decision making is decentralized  readers
interested in supply chain management may refer to kjenstad        for an extensive review 
relatively less effort has been explicitly devoted to the problem we cast as supply chain formation  despite the rhetorical appeals to decentralized and dynamic relation building commonplace in
the popular literature  nevertheless  as we point out in section    some venerable ai methodsin
particular the widely known contract net protocolcan in principle be applied to supply chain
formation  as discussed in section    the standard contract net does not have mechanisms to
resolve nontrivial resource contention  precluding a systematic comparison with samp sb on general network structures  we can  however  compare the protocols on network structures for which
a resource contention mechanism is not necessary for contract net  it is clear that if agents
bid their true costs  then contract net with greedy allocation will converge to optimal allocations for trees  the same holds for tree structures relaxed to allow multiple unit input bids  as we
have shown  samp sb is guaranteed to converge to approximately efficient allocations for trees 
however  it can be shown that it may not converge to good solutions if multiple unit input bids are
allowed  in the latter case  competitive equilibrium may not exist  and and we have observed that
equilibrium non existence can substantially hurt efficiency in samp sb allocations  in contrast 
producers may receive different prices for the same good with contract net  this discriminatory pricing mechanism makes contract net robust in the presence of complementarities  for
this class of network structures 
sandholm        examines a specialization of contract net for a generalization of task oriented domains  tods   rosenschein   zlotkin         agents begin with an initial allocation of
tasks and negotiate task exchanges until there are no mutually beneficial trades  sandholms model
allows local constraints on task achievement in that an agent can perform only certain combinations of tasks  however  there is no dependency structurean agent does not rely on other agents
task achievement in order to accomplish its own tasks  thus  every locally feasible trade results in
   

fid ecentralized s upply c hain f ormation

a globally feasible allocation  and can be executed immediately and independently of other trades 
we cannot generally apply an incremental trading protocol to our task allocation model with subtask
dependencies  a local exchange may require reallocation throughout the entire network to maintain
production feasibility 
andersson and sandholm        find that decommitment protocols increase the quality of the
resulting allocations in variants of tods  with incremental trading  decommitment gives agents the
opportunity to engage in other more cost effective contracts  andersson and sandholm also consider decommitment penalties to provide friction in reallocation and to compensate agents whose
contracts are broken  we expect that such penalties would be an appropriate extension to the
samp sb d protocol 
veeramani et al   veeramani et al         joshi et al         consider issues arising from simultaneous negotiation of multiple subtasking issues at various levels of a supply chain  in their
asynchronous model  agents may have the opportunity to finalize a contract while other negotiations
are still pending  this uncertainty induces a complex decision problem for agents that do not wish
to overextend their commitments 
hunsberger and grosz        study the problem of assigning task performance roles to agents
in the sharedplans collaborative planning framework  the model is based on recipes  which describe the precedence constraints on the execution time across the various sub tasks that constitute
a complex task  contention for shared resources is not modeled explicitly in the recipe  but individual agents may have additional cost  timing  or other constraints  potentially arising from their
individual resource limitations  hunsberger and grosz use a combinatorial auction to assign tasks to
agents  given the constraints  to produce a high valued shared plan  they find that limiting task assignment to certain combinations in roles can effect a tradeoff between computational and allocative
efficiency 
in other work  walsh et al         walsh         we have studied strategic behavior of agents
bidding in a particular one shot combinatorial auction within the task dependency network model 
we empirically compared the performance of samp sb  samp sb d  and the combinatorial auction  with strategic bidding   the combinatorial auction eliminates the problem of dead ends by allocating inputs and outputs to producers on an all or nothing basis  this advantage notwithstanding 
combinatorial auctions may not always be an appropriate mechanism  since finding any feasible
supply chain solution is np hard  walsh et al          sufficiently large problems will be intractable 
even for advanced optimization procedures  even when the computation is tractable  social factors
may limit the authority of any one entity to compute allocations over the entire supply chain 

   extensions and future work
the task dependency network model we propose provides a basis for beginning to understand the
automation of supply chain formation  we have discussed some ways to extend the bidding policies in our market protocol to accommodate more general production capabilities and consumer
preferences  with these extensions we can model capabilities and preferences on multi attribute
goods  e g   goods with multiple features such as quality and delivery time  in addition to price and
quantity  by simply representing each configuration as a distinct good in the network  however  it
is clear that this can explode the number of goods with just a few attributes  to effectively handle
greater numbers of attributes would require multiattribute auctions  bichler         where multiple
inseparable features of an exchange are negotiated simultaneously 
   

fiwalsh   w ellman

in more realistic scenarios  producers may also have to solve complex internal scheduling  planning  forecasting  or other complex problems in order to evaluate their costs and feasible options 
these types of extensions would increase the fidelity of the model  but would have implications
for agent bidding policies and computation and convergence speed in market protocols  despite
the best efforts of agents to forecast and plan  agents cannot predict with certainty their operation
within a formed supply chain  sophisticated agents would employ probabilistic reasoning techniques in evaluating their options during negotiation  when unexpected events do occur that impair
the operation of a formed supply chain  agents would need protocols for repairing or reforming the
supply chain 

we assumed a simple set of non strategic  myopic bidding policies for the simultaneous ascending auction  because agents must coordinate input and output bids in a dynamic auction mechanism 
understanding strategic bidding behavior is a challenging and unsolved  albeit important problem for
future work  it seems likely that significant developments in game theoretic methodology would be
necessary to analytically solve  or even realistically specify  the extensive form games of incomplete
information corresponding to asynchronous iterative auctions  in the meantime  to make progress in
understanding the performance of auctions  we should consider alternate approaches to developing
good bidding policies  tournaments have proven to be effective ways to both encourage smart
people to design smart trading policies and to evaluate their relative qualities  rust et al        
wellman et al       b   axelrod        used an evolutionary approach to evaluate populations of
strategies  with fixed types  for the iterated prisoners dilemma  a major challenge in applying an
evolutionary approach to the supply chain formation problem is to develop a sufficiently rich  yet
reasonably searchable set of agent bidding policies 

we suggested decommitment as a solution to the problem of dead ends in samp sb  and a
strategic analysis of the protocol would have to take this phase into account  because producers
could not lose money when decommitment is allowed  we should expect that producers would be
more willing to participate  and would also be more aggressive in their bidding  allowing decommitment begs the question of how to enforce that producers decommit only when they are in dead
ends  and also does not address the fact that unilateral decisions for decommitment can potentially
break the  possibly desirable  contracts of many other downstream producers  to reduce aggressive
bidding and mitigate the potential problems  we could charge penalties to producers who initiate
decommitment  andersson   sandholm         perhaps paid to the producers whose output contracts get decommitted  this would reduce spurious decommitments while still allowing an out for
producers stuck in costly dead ends 

finally  we note that the market configuration studied hereseparate auctions for each good
represents just one possible partition of the scope of negotiations on the supply chain  at the other
extreme  production activity could be mediated by one combinatorial auction mechanism covering
the entire supply chain  walsh et al          this avoids some coordination pitfalls of the separate
auction approach  but imposes other disadvantages associated with imposing a mechanism with
global scope  intermediate configurations  involving multiple auctions for clusters of highly related
goods  represent a promising alternative for further investigation 
   

fid ecentralized s upply c hain f ormation

acknowledgments
this paper includes material previously presented at the sixteenth international joint conference
on artificial intelligence  ijcai      walsh   wellman         this work was supported in part
by nsf grant iis         

appendix a  proofs
this appendix provides proofs of our theorems  for convenience  we restate the theorems before
the proofs 
in our proofs  it is sometimes useful to index the position of a producer in a network  the clevel of a producer with output g is the maximum distance from it to any consumer  formally stated
as follows  one if no producer  but some consumer  has g as input  and k     if the maximum level
of any producer with input g is k  the s level of a producer is defined similarly  but with respect
to the distance to any producer with no input  and with a basis of zero for producers that have no
inputs themselves  both the c level and s level are well defined  by acyclicity 
a   proof of theorem  
let  v  e  be a network with no input complementarities  that is all producers have at most one
input  and let  v    e    be the optimal allocation for  v  e   for convenience  we partition producers
 into sets     the producers with a single input  and     the producers with no inputs 
procedure no input complementarities equilibrium constructs prices that support a
competitive equilibrium for  v    e    
no input complementarities equilibrium 
   initialize all prices to zero 
   perform any of the following until no price changes are made 
 a  if for some c  c  v    we have vc  g    p g   where hg  ci  e   e   
p g   vc  g  
 b  if for some c  c v    we have vc  g     p g      vc  g   p g     
where hg  ci  e  and hg    ci  e   e   
p g     vc  g      vc  g   p g   
 c  if for some     v    we have p g        where h  g i  e   
p g      
 d  if for some     v    we have p g     p g    
where h  g i  e  and hg  i  e   
p g    p g      
 e  if for some      v    we have p g     p g      
where h  g i  e   e  and hg  i  e   e   
p g   p g      
in network  v  e   with no input complementarities  at prices p  a closed  reverse surplus sequence is a directly connected sequence of agents and goods such that every agent would be better
off by reversing its allocation  formally  it is a sequence  n            nk   of vertices ni  v   such that 
   

fiwalsh   w ellman

   hni   ni   i  e or hni     ni i  e for all i where    i  k    
   nk  g 
   n    c  v        v    
 a  if n   c   v    then hn    n  i  e   e  and n  would obtain nonnegative surplus at p
from obtaining n    if     k     then n  would obtain strictly positive surplus at p from
obtaining n   
 b  if n      v    then hn    n  i  e  and n  would obtain nonpositive surplus at p from
being active  if k      then n  would obtain strictly negative surplus at p from being
active 
   for i     if ni  a then ni      c v    
 a  if ni     v    then hni    ni i  e    hni   ni   i  e    and ni would obtain nonpositive
surplus at p from being active  if i   k     then ni would obtain strictly negative surplus
at p by being active 
 b  if ni      v    then hni     ni i  e    hni   ni  i  e    and ni would obtain nonnegative
surplus at p from being active  if i   k     then ni would obtain strictly positive surplus
at p by being active 
 c  if ni  c v    then hni    ni i  e    hni     ni  e  e    and ni would obtain no less surplus
from ni   than from ni  at p  if i   k     then ni would obtain strictly better surplus
from ni   than from ni   
an open reverse surplus sequence is the same as a closed  reverse surplus sequence except
that  instead of condition    we have n   g and n       c  v    as with condition    clearly
any closed  reverse surplus sequence of length greater than two contains an open  reverse surplus
sequence 
lemma    procedure no input complementarities equilibrium does not reach a state such
that there is an open  reverse surplus sequence k    n            nk   constituting a cycle with n    nk
and k    
proof  assume  contrary to which we wish to prove  that there is such a cycle k at prices p 
moreover  let the cycle be the smallest  in that it contains no other such cycle 
we show how to create an alternate  feasible solution  v     e     with a higher value than  v    e    
giving us a contradiction  initialize  v     e        v    e     for all n j   where    j   k  if hn j   n j   i 
e    remove the edge from e     and if the edge is in e   e    add the edge to e     also  add and remove
vertices as necessary to be consistent with the added and removed edges 
each producer in  v     e     is feasible because it was feasible in  v    e    and if it has an input 
either both its input and output are added  both are removed  or neither is changed  consider a good
n j  g  with     j   k  since j         it must be that agents n j  and n j   are in     c v    
by inspecting conditions   a   b  of the definition of a closed  reverse surplus sequence  which
also apply to an open reverse surplus sequence   we see that edges incident on n j are added or
removed in such a way that n j is in material balance  similarly  considering agents nk    n    and
   

fid ecentralized s upply c hain f ormation

good n    nk   we have material balance for good n    nk   since goods are in material balance and
producers are feasible   v     e     is feasible 
the surpluses of agents not in k are unaffected by the transformation  by definition of an open 
reverse surplus sequence  every agent in k obtains no lower surplus at p after the transformation 
and agent nk  obtains strictly higher surplus at p  because the value of a feasible allocation is the
sum of agent surpluses at any particular prices  lemma      we must then have value  v     e       
value  v    e      but this contradicts the optimality of  v    e     so the assumption that k exists
must be false   
lemma    if the price of good nk increases in procedure no input complementarities
equilibrium  then there there exists a finite closed  reverse surplus sequence  n            nk   at prices
p just before the price increase 
proof 
we show how to construct the desired closed  reverse surplus sequence  referring to the
conditions in the definition  and to the steps in procedure no input complementarities
equilibrium  the price increase of nk occurred in one of steps   a   e   triggered by agent
nk    since the step was triggered  nk  would obtain strictly better surplus by reversing its allocation at p  as specified in the conditions   a     b   or   a   c   if the price of nk was increased in step   a  or   c   then we have the desired closed  reverse surplus sequence  with
nk    c  v         v    and k         otherwise  the price or nk was increased in step   b  
  d   or   e   with nk       c v    and k         in this case  we let nk  be the good that also
matched the condition of the step 
if the price of nk  increased  then procedure no input complementarities equilibrium
ensures that we can find an agent nk  matching one of the conditions   a     b   or   a   c   if  on
the other hand  p nk         then because producers have positive costs and consumers have positive
values  we can also find such an agent nk    if we find an agent that corresponds to condition   a 
or   b   then k        and we are done  otherwise  we can find a good nk    as we did nk    and
continue in the same manner 
clearly  this process constructs an open  reverse surplus sequence  now  we must show that this
process of selecting vertices eventually selects an element n    c  v         v     since  v  e 
is finite  and since by lemma    there can be no cycles in any open  reverse surplus sequence  we
must eventually find a n    c  v        v    to give us a closed  reverse surplus sequence   
lemma    procedure no input complementarities equilibrium terminates 
proof  assume  contrary to which we wish to prove  that the procedure does not terminate and that
the price of good g increases an infinite number of times  consider a cycle k    n    g          nk   g 
of vertices ni  v   k    such that 
   hni   ni   i  e or hni     ni i  e for all i              k     
   for all i              k      ni    g 
   for all i              k   if ni  g  the price increase of good ni occurred in one of the steps   b  
  d   or   e  in the procedure  and agent ni  and good ni  also matched the condition in that
step  furthermore  the price increase of ni    triggered by agent ni  and good ni    caused
the need for the price increase of good ni  
   

fiwalsh   w ellman

because the price of g increases an infinite number of times  such a cycle must exist 
let p be prices such that p n    is as it was when n  and agent n  triggered the price increase of
n    and for all ni  g and     i   k  p ni   is as it was just after the it was increased  as triggered by
agent ni  and good ni    the price of all other goods is an arbitrary nonnegative number 
by the way we constructed p  and by the way prices are increased in the procedure  k must
be an open  reverse surplus sequence  but by lemma     such a k cannot exist  therefore  the
procedure terminates   
theorem   competitive equilibria exist for any network with no input complementarities 
proof  we show that procedure no input complementarities equilibrium terminates at
prices p with every agent obtaining its maximum surplus according to  v    e      since  v    e   
is efficient  it is also feasible  giving us a competitive equilibrium at prices p 
by lemma     the procedure terminates  clearly  when the procedure terminates  agents in
       v      c   v    optimize according to  v    e     it remains to show the same for  c 
v         v     assume  contrary to which we wish to prove  that some a   c v         v   
does not optimize according to  v    e    
consider the case where a   c  v    and hg  ai  e    since the algorithm guarantees that a
does not prefer any other good g  to g at prices p  it must be that p g    vc  g   let p  be the
prices immediately before the price of g rose above vc  g  and p   be the prices immediately after 
by lemma     there is a closed  reverse surplus sequence  n            nk   g  at prices p    at p     the
conditions of the closed  reverse surplus sequence hold  except that the surplus condition in   a  
  b   or   c  that applies to nk  becomes non strict  however  a obtains a strictly negative surplus
at p     denote a as nk    
we can create an alternate  feasible solution  v     e     as in the proof of lemma    by adding
edges hni   ni   i that are in e   e    and removing such edges that are in e    for all i              k  
the surpluses of agents not in k are unaffected by the transformation  every agent in  a            nk   
obtains no lower surplus at p   after the transformation  agent a   nk obtains zero surplus after
the transformation  which is higher than the negative surplus it had before  because the value of a
feasible allocation is the sum of agent surpluses at any particular prices  lemma      we must have
value  v     e        value  v    e      but this contradicts the optimality of  v    e     so it must be that
p g   vc  g  and a is obtaining its maximum surplus at p in  v    e    
if  on the other hand  a      v     and ha  gi  e  it must be that a   p g   we can use the
same line of proof as the case of c  v  to show that  v    e    has a suboptimal value  providing a
contradiction  thus a must optimize according to  v    e    at p 
thus we have shown that the algorithm terminates with all agents optimizing according to
 v    e    at p  thus p supports a competitive equilibrium for allocation  v    e      
a   proof of theorem  
given a polytree  v  e  and an efficient allocation  v    e     we present procedure polytree
equilibrium that constructs lower bounds p  g  and upper bounds p  g  on the prices of all
goods g  and in turn uses these bounds to construct prices p for all goods  then we prove that the
resulting prices are in fact competitive equilibrium prices that support  v    e    
   

fid ecentralized s upply c hain f ormation

observe that  for the purposes of competitive equilibrium pricing  we can treat a consumer c
that wishes to obtain one good from the set gc as a consumer that desires a single good gc with
value vc  gc     vc   maxggc vc  g   along with additional producers  for each g  gc we create a
producer  with output gc   input g  and with    vc  vc  g   thus  without loss of generality  we
consider only consumers with preferences for single goods  we denote as gc the good that consumer
c desires and denote as vc the value c has for gc  
we refer to all n   v such that either hn  n  i  e or hn    ni  e as the neighbors of a vertex
n  v   we use  to refer to a null vertex that is not a neighbor of any other vertex 
polytree equilibrium 
   for each g  g  p  g     and p  g    
   for each connected subgraph  v   e    v  e   select a g  g  v arbitrarily 
perform set bounds g    
p g   p  g  
set bounds recursively visits the vertices  updating the price bounds in postorder  i e   as the
recursion unwinds  and setting prices to either the lower or upper bounds  because  v  e  is a
polytree  the procedure sets the price for each good exactly once 
in set bounds n  r   if n  a  then r  g and the procedure either updates p  r  or p  r 
after the bounds for all neighbors of n  other than r  have been fixed  if it updates p  r   it does so
in such a way that if n 
  v  then n  if active  would get a nonpositive surplus for any p r   p  r  
given the bounds on the other neighbors of n  and if n  v  then n  if active  would get a nonnegative surplus for any p r   p  r   given the bounds on the other neighbors of n  since p  r  only
increases  steps      b   and   c    this property is maintained  similarly  if set bounds n  r 
updates p  r   it does so in such a way that if n 
  v  then n  if active  would get a nonpositive
surplus for any p r   p  r   given the bounds on the other neighbors of n  and if n  v  then
n  if active  would get a nonnegative surplus for any p r   p  r   given the bounds on the other
neighbors of n  since p  r  only decreases  steps      c   and   b    this property is maintained 
set bounds n  r  
   for each neighbor z of n such that z    r  perform set bounds z  n  
   if n  c  v   
p  r   max vn   p  r   
   else if n  c v   
p  r   min vn   p  r   
   else if n    v  then 
 a  for each neighbor g of n such that g    r
if g is an input of n
p g   p  g  
else g is the output of n 
p g   p  g  
   

fiwalsh   w ellman

 b  if r is an input of n 
and with the output  gn   of n
p  r   max p  r   p  gn    hg nie  g  r p  g   n   
 c  else r is the output of n 
p  r   min p  r   hg nie p  g    n   
   else if n   v  then 
 a  for each neighbor g of n such that g    r 
if g is an input of n 
p g   p  g  
if g is the output of n 
p g   p  g  
 b  if r is an input of n 
and with the output  gn   of n  
p  r   min p  r   p  gn    hg nie  g  r p  g   n   
 c  else r is the output of n 
p  r   max p  r   hg nie p  g    n  

lemma    procedure polytree equilibrium computes price bounds such that p  g   p  g 
for all goods g  g 
proof  assume  contrary to which we wish to prove  that at some state there is some g  g such that
p  g    p  g   assume further that g is the first such good visited 
we say that agent a constrained p  g  if set bounds a  g  was the last to change p  g  
similarly  we say that agent a constrained p  g  if set bounds a  g  was the last to change
p  g  
recall from lemma    that the value of any feasible allocation is equal to the sum of the agent
surpluses at any particular prices  we show how to transform  v    e    to an alternate feasible
allocation  v     e     and compute alternate prices p to show that the sum of surpluses in  v     e     is
greater than in  v    e    
first  initialize  v     e        v    e    and for each good g  g initialize p g       next  set p g   
p  g   then we recursively change prices and the allocation for a portion of the subtree rooted
at g  perform lower bound a  g  for the agent a that constrained p  g  and perform upper
bound a  g  for the agent that constrained p  g  
throughout the transformation  we perform lower bound a  g  iff we visit g and agent a
constrained p  g   similarly  we perform upper bound a  g  iff we visit g and agent a constrained p  g   the following describes these portions of the transformation 
lower bound a  g  
   if a    v    it must be that g is an input of a  because a constrained p  g   
for each neighbor g     g of a 
   

fid ecentralized s upply c hain f ormation

 a  if g  is an input of a 
p g     p  g    
perform upper bound a    g    for the agent a  that constrained p  g    
 b  else  g  is an output of a  
p g     p  g    
perform lower bound a    g    for the agent a  that constrained p  g    
   else if a   v    it must be that g is an output of a  because a constrained p  g   
for each input g  of a 
p g     p  g    
perform lower bound a    g    for the agent a  that constrained p  g    
   if a  v   
remove a and all incident edges from  v     e     
   else if a  v  v   
add a and all incident edges to  v     e     
upper bound a  g  
   if a    v    it must be that g is an output of a  because a constrained p  g   
for each input g  of a 
p g     p  g    
perform upper bound a    g    on the agent a  that constrained p  g    
   if a   v    it must be that g is an input of a  because a constrained p  g   
for each neighbor g     g of a 
 a  if g  is an input of a 
p g     p  g    
perform lower bound a    g    for the agent a  that constrained p  g    
 b  else  g  is an output of a  
p g     p  g    
perform upper bound a    g    for the agent a  that constrained p  g    
   if a  v   
remove a and all incident edges from  v     e     
   else if a  v  v   
add a and all incident edges to  v     e     
observe that  because  v  e  is a polytree  a vertex can be visited at most once by either upper
bound or lower bound 
now we show that  v     e     is feasible  consumers are always feasible  producers are feasible
because we add or remove all incident edges when we add or remove a producer  respectively  we
now prove that every g  g is in material balance in  v     e     
   

fiwalsh   w ellman

consider good g for which p  g    p  g   lower bound a  g  is performed only if agent
a constrained p  g   which occurred in      b   or   c  of set bounds a  g   therefore lower
bound a  g  either adds hg  ai  e   e  or else removes ha  gi  e    upper bound a  g  is
performed only if a constrained p  g   which occurred in      c   or   b  of set bounds a  g  
therefore upper bound a  g  either adds ha  gi  e   e  or else removes hg  ai  e    for any
possible combination  material balance is maintained for g 
now consider any other good g    g  if g is visited by lower bound a  g   then p g  was set
to p  g  in one of the following ways  immediately prior 
   p g  was set to p  g  by   b  of lower bound a  g   for some other agent a    v  and
other good g  in this case  g is an output of a so ha  gi  e   e  was added to  v     e     in   of
lower bound a  g  
   p g  was set to p  g  by   of lower bound a  g   for some other agent a    v  and
other good g  in this case g is an input of a so hg  ai  e  was removed from  v     e     in   of
lower bound a  g  
   p g  was set to p  g  by   a  of upper bound a  g   for some other agent a   v  and
other good g  in this case case g is an input of a so hg  ai  e  was removed from  v     e     in
  of upper bound a  g  
one of the following operations occurred in lower bound a  g  
   if a constrained p  g  in   or   b  of set bounds a  g   then hg  ai  e   e  is added to
 v     e     in   of lower bound a  g  
   if agent a constrained p  g  in   c  of set bounds a  g   then ha  gi  e  is removed from
 v     e     in   of lower bound a  g  
for any possible combination of additions or removals of edges incident on g prior to  and in lower
bound a  g   material balance is maintained for g  we can show a similar result if g is visited by
upper bound a  g   hence we have established feasibility of  v     e     
now we show that for any agent a  a   a   v     e      p    a   v    e     p   and there is some
agent a   a such that  a     v     e      p     a     v    e     p  
for any agent a not visited in the construction of  v     e       a   v     e      p     a   v    e     p  
because a has the same allocation as in  v    e    
consider a  visited by upper bound a    g   because a  was thus visited  a  constrained

p  g   upper bound a    g  sets the prices of all other neighbor goods g    g to the prices used
to compute p  g  in set bounds a    g   the prices of these neighboring goods were computed
such that if a   v    a  would get negative surplus at any price for g above p  g  and if a   v  v 
it would get a positive surplus for at any price for g above p  g   but  in the alternate prices we
computed  p g    p  g   and we assume p  g    p  g   since a  is in v   if and only if it is not in
v    we have  a     v     e      p     a     v    e     p  
now consider any other a  a  a    a    visited in the construction of  v     e      if a is visited
by upper bound a  g   then p g    p  g  and a must have constrained p  g   if a  c  then
set bounds a  g  set p  g  such that va  p  g       if a    upper bound a  g  sets the
prices of the other goods neighboring a to the prices used to compute p  g  in set bounds a  g  
these neighboring prices are such that if a were active and feasible  it would get zero surplus when
   

fid ecentralized s upply c hain f ormation

p g    p  p   thus  a   v     e      p     a   v    e     p   if  on the other hand  a is visited by lower
bound  then p g    p  g  and a must have constrained p  g   by a similar argument we used with
upper bound  a gets a zero surplus when p g    p  g   again  this gives  a   v     e      p   
 a   v    e     p  
we have shown that for any agent a  a   a   v     e      p    a   v    e     p   and there is
some agent a   a such that  a     v     e      p     a     v    e     p   but then value  v     e       
value  v    e      which is a contradiction  hence  the initial assumption that p  g    p  g  must
be false  but then p  g   p  g  for all goods g 
 

theorem   competitive equilibria exist for any polytree 
proof  we show that agents optimize according to  v    e    at the prices p computed by procedure polytree equilibrium  since  v    e    is feasible by definition  the resulting prices and
allocation constitute a competitive equilibrium for  v  e  
because the construction of p  g  ensures that it never decreases  step   of set bounds ensures that every consumer c  c  v  optimizes if p gc    p  gc    because p  gc    p c   p  gc  
 by construction of p and by lemma      c then optimizes according to  v    e     by a similar argument  every c  c v  optimizes according to  v    e    
consider a producer      v    visited by set bounds   g   if good g is an input of  
then   a  of set bounds   g  sets the price of every other neighbor good g     g of  to the price
bounds used to compute p  g  in step   b  of set bounds   g   moreover  p  g  is set to the
smallest price such that  could get a maximum surplus of zero  given the specified bounds of the
other neighbor goods  since p  g  could only increase subsequently  since p  g   p g   p g 
 by the construction of p and by lemma      and since the price of each good is set only once
 because  v  e  is a polytree   cannot get a positive surplus at the prices set by set bounds  
g   by a similar argument  if g is an output of   then in step   c  p  g  is set to the largest price
such that  would get at a maximum surplus of zero  given the prices set on the neighbor goods 
since again  p  g   p g   p  g   p  g  only increases subsequently  and the price of each good
is set only once  it must be that  can get at most zero surplus  thus  optimizes according to
 v    e     symmetrically  we can see that every    v  optimizes according to  v    e    
we have shown that all agents optimize according to  v    e    at p  hence we have shown that a
competitive equilibrium exists for polytree  v  e    

a   proof of theorem  
lemma    the value of a feasible allocation  v     e      at any prices p  can be expressed as 

value  v     e       

  a   v    e     p  

aa

   

   

fiwalsh   w ellman

proof  equation     expands to 
value  v     e       



vc   v     e      

 







p g 



p g      v   e     

hg cie  

cc



p g  

h gie  

 
 

hg ie  

 

 

since all goods are in material balance in a feasible allocation  all the price terms cancel out  we
are left with

 vc   v    e       s   v     e     


cc

which is the original formula for the value of a solution  definition      
theorem   if  v     e     is a   competitive equilibrium for  v  e  at some prices p  then  v     e     is
a feasible allocation with a nonnegative value that differs from the value of an efficient allocation
by at most   hg ie g   s      c b  
proof  we refer to the four conditions for a   competitive equilibrium  definition     let  v    e   
be an efficient allocation for  v  e  
conditions     and     imply that  v     e     is feasible  recall the formula for the value of a
feasible allocation from equation      since  v     e     and  v    e    are both feasible  we can express
their values as
value  v     e       

  a   v     e     p  

   

  a   v    e    p  

   

aa

value  v    e      

aa

for all c  c  by condition       c   v     e      p   hc  p   b   because no allocation is any
better for an agent than its optimal allocation   c   v    e     p   hc  p   thus 
 c   v    e     p    c   v     e      p   b  

   

for all     by condition          v     e      p   h  p    hg ie g   s    because no
allocation is any better for an agent than its optimal allocation      v    e     p   h  p   thus 
    v    e     p       v     e      p  



g   s  

   

hg ie

equations        together imply that value  v    e      value  v     e         hg ie   
s      c b   condition     implies that each sum term in equation     is nonnegative  hence
value  v     e          as noted   v     e     is feasible 
 
g

   

fid ecentralized s upply c hain f ormation

a   proof of theorem  
in proving the theorem  we refer to the c level and s level of producers in a network  as defined in
the beginning of section a 
a task dependency network  v  e  is characterized by the following parameters 
   the maximum c level of any producer in the network 
   the maximum number of input goods for any producer 
 r  the maximum consumer value  maxhg cie cc vc  g  
lemma    in a run of samp sb for network  v  e   no agent places a buy offer above r    b  
proof  consumers never offer above their valuation  which is bounded by r  we prove by induction
on the producer c level that no producer at c level k places a buy offer above r    kb  
suppose that a producer  at c level one places an offer to buy an input g at price    r    b  
since it always increments buy offers by b   this means at some previous time it submitted a buy
offer for g at price r   b      r    b   at that time  it must have been losing g  else it would not
be bidding  but then the ask quote of g must have been greater than r  and  then offered greater
than r for its output  since only a consumer will offer to buy for the output of a producer at c level
one   must lose its output  because offers are nondecreasing  this situation is permanent  and hence
 never again raises an input offer  contrary to our supposition  thus a c level one producer will
never place a buy offer above r    b  
for the inductive step  we assume that no producer at any c level i  where i   k  places a buy
offer above r    ib   thus  no producer at c level k can win its output offer for more than r  
  k    b   applying reasoning analogous to the base case  c level one   we see that no producer
at c level k places a buy offer above r    kb   because k   for all producers  the lemma follows
immediately   
lemma    no agent places more than  r    b   b    buy offers 
proof  since consumers offer at most r and increase offers by at least b   they place offers at
most r b times  a producer initially places at most  buy offers for its inputs  according to
lemma    and the producer bidding policy  a producer subsequently offers no higher than r    b
in increments of b for each of a maximum of  inputs   
theorem   samp sb reaches quiescence after a finite number of bids have been placed 
proof  by lemma     a finite number of buy offers are placed  we need show only that producers place a finite number of sell  output  offers to establish that a finite number of total bids are
placed 
a producer will change its output offer only if     the price of an input changes     the ask
price of an input changes  or    it loses an an offer for a good that it was previously winning 
an unchanged input offer can switch between winning and losing at most once without the price
changing  similarly  an unchanged input offer can switch winning state at most once without the ask
price changing  hence  it is sufficient to show that the price and ask price of each of a producers
   

fiwalsh   w ellman

input goods change at most a finite number of times  we prove by induction on the producer s level
that the price and ask quotes of an input good to a producer at s level k changes a finite number of
times 
only a producer with no input places an output offer for a input good g to a producer at s level
one  and producers with no input place only one offer each  hence  the price or ask price of g
change only in response to a change in a buy offer for g  but by lemma     the number of buy offer
changes for g is finite 
now assume that all producers at all s levels less than k place a finite number of output offers 
for a good g which is an input for a producer  at s level k  the number of output offer changes is
finite  again the number of input offers for g must be finite  since the number of input and output
offers for g is finite   places a finite number of output offers   
a   proof of theorem  
in proving the theorem  we refer to the c level of producers in a network  as defined in the beginning
of section a  for reference  quasi quiescence is described in definition   
lemma    if a run of samp sb is in a quasi quiescent state during the time interval  t  t     then no
inactive producer changes an offer for an input good in the time interval  t  t        where  is the
smallest period of time an agent requires to update a bid in response to a price quote 
proof  by definition of quasi quiescence  during the interval  t  t      no consumer or active producer
changes any offer  thus  a simple induction on the c level of the inactive producers shows that any
producer that is inactive at time t would not win its output during  t t      hence inactive producers
remain inactive during this interval  but a producer that is inactive during  t  t     would not change
its input offer during  t  t         
lemma    if a run of samp sb is in a quasi quiescent during the time interval  t  t      then it is
quasi quiescent during the time interval  t  t        where  is the smallest period of time an agent
requires to update a bid in response to a price quote 
proof  assume  contrary to that we wish to prove  that a run of samp sb is quasi quiescent during
 t  t     but not during time  t    t        let a be a consumer or active producer that will change an offer
in  t     t       
if a is a consumer  then a would only change an offer if it lost some offer it was previously
winning in quasi quiescence  if a is a producer  it must be feasible  otherwise it would change its
input offer  because it is active  violating quasi quiescence  since a is feasible  it would change an
offer only if it loses an input it was previously winning  or the price of one of its inputs increases 
in any of these cases  a either loses a buy offer it was previously winning  or the price of one of
its buy offers increased  for one of these to occur  it must be that at time t      t t      some agent
either    changed its own winning output offer or    changed its input offer  but the definition of
quasi quiescence precludes     and lemma    and the definition of quasi quiescence preclude    
this gives us a contradiction  proving the lemma   
lemma    if a run of samp sb is in a quasi quiescent state at time t  then it is quasi quiescent at
all times t     t 
   

fid ecentralized s upply c hain f ormation

proof  by lemma    we can conclude that we have quasi quiescence in the interval  t  t      then
further extend that interval by   and so on indefinitely   
lemma    if a run of samp sb is in a quasi quiescent at time t  then a producer that is inactive
at time t is inactive at time t     and a producer that is active at time t is also inactive at time t    
where  is the smallest period of time an agent requires to update a bid in response to a price quote 
furthermore  p g  does not change for any good g at time t   
proof  since an agent cannot lower its offers  the only way for an inactive producer  to become
active is for some other agent to raise its buy offer  by lemma    and the definition of quasiquiescence  only inactive producers will change any offers after t  and by lemma    no inactive
producer will change its input offers  but then  remains inactive 
since offers do not decrease  an active producer  can become inactive only by increasing its
offer for its output  but  will do this only if the prices on its inputs increase  since we have a
quasi quiescent state  this can happen only if an inactive producer   changes its offer for its output
g  but since   is inactive  a change to its offer for g can cause only  g  to change  since active
producers are feasible  otherwise they would want to change their bids  violating quasi quiescence  
 is not losing a buy offer for g at time t  therefore   does not respond to changes in  g   hence
does not change its output offer and will remain active   
theorem   if a run of samp sb reaches a quasi quiescent state  then it remains in a quasiquiescent state  furthermore  neither the allocation nor the prices p subsequently change 
proof  the theorem follows directly from lemmas    and      
a   proof of theorem   
in proving the theorem  we refer to the c level of producers in a network  as defined in the beginning
of section a 
a given run of samp sb in network  v  e  is characterized by the following parameters 
   the maximum c level of any producer in the network 
   the maximum number of input goods for any producer 
 r  the maximum consumer value  maxhg cie cc vc  g  
theorem    samp sb reaches a quasi quiescent state after a number of bids bounded by a polynomial of the size of the network and the value of the maximum consumer value have been placed
by consumers and active producers 
proof  samp sb is guaranteed to reach a quasi quiescent state  theorem   and observation    
by lemma     the number of buy offers is bounded by a polynomial in the value of r  hence we
need only be concerned with the number of sell offers placed  since the prices of buy offers increase
by at least b   a producers perceived cost for any good must rise by at least b   so will increase its
   

fiwalsh   w ellman

sell offer by no less than b   also  a producer will increase its sell offer by no less than s   as required by the auction  hence  lemma    implies that an active producer will become permanently
inactive after it places at most  r    b    max b   s    output offers   
a   proof of theorem   
in proving the theorem  we refer to the conditions for a   competitive equilibrium  definition    
lemma    when samp sb reaches quiescence in network  v  e  then each consumer obeys the
  competitive equilibrium conditions  conditions     and      
proof  since each consumer maintains at most a single winning offer for a good that gives it nonnegative surplus  it obeys condition     
let the final prices and allocation be p and  v     e      respectively  assume  contrary to condition      that  c   v     e      p    hc  p   b for some consumer c  let g be a surplus maximizing
good for c at p 
if c does not buy a good  then p g     b   vc  g    otherwise it would have placed and won an
offer for g   and  c   v     e      p       noting also that hc  p    vc  g    p g    algebraic manipulation gives us  c   v     e      p    hc  p   b   which is a contradiction 
thus  c buys one good g  such that
vc  g     p g      vc  g    p g    b  

   

let p g   and p g    be the prices for g and g  when c placed its final offer for g    since c offers
p g      b for g    and since c won this offer at p g     we have
p g      b  p g    

   

p g    p g   

   

since prices do not decrease  we have

substituting equations     and     into the left and right sides  respectively  of equation     gives us
vc  g       p g      b     vc  g      p g     b   
but the consumer bidding policy specifies that c would have bid for g   rather than g  at prices p 
which is a contradiction  thus each consumer obeys condition       
lemma    if samp sb reaches quiescence in network  v  e  such that no inactive producer buys
a positive price input  then each producer obeys the   competitive equilibrium conditions  cong
ditions     and       with    max  g   p g   b   
proof  the bidding policy ensures that each producer  sells its output g only at a nonnegative
surplus  and the lemma conditions directly imply that  has zero surplus if it does not sell   thus
 obeys condition     
the producer bidding policy guarantees that  is feasible in quiescence 
   

fid ecentralized s upply c hain f ormation

let the final prices be p and allocation be  v     e      if h  p    hg ie    s in quiescence 
then h  p    p g    hg ie p g    hg ie g   s   thus p g     hg ie p g    hg ie g  
s   the producer bidding policy ensures that  offers no more than hg ie p g    hg ie g   s
for g   so it must be winning g at a profit  thus     v     e      p    h  p  and condition     holds 
if instead h  p   hg ie g   s   then since     v     e      p      condition     holds   
g

theorem    the prices and allocation determined in quiescence by the samp sb protocol is a
  competitive equilibrium  with g   max  g   p g   b    iff no inactive producer buys any
positive price input 
proof  case only if  condition     of   competitive equilibrium  definition    fails if an inactive producer buys any positive price input 
case if  lemmas    and    show that the consumers and producers  respectively  obey the  competitive equilibrium conditions  conditions          the  m   st price auction rules ensure
condition      all conditions of   competitive equilibrium are met   
a   proof of theorem   
in proving the theorem  we refer to the conditions for a   competitive equilibrium  definition    
lemma    if  g   p g    b for any good g in a quiescent state of samp sb for network  v  e  
then no agent wins an offer for g 
proof  assume  contrary to which we wish to prove  that  g   p g    b and some agent is
winning an offer for g  in quiescence of samp sb  either a buy offer or a sell offer sets  g  
case    an agent sets  g  with a buy offer  according to the samp sb bidding policies  an
agent will increase a buy offer only if it is losing that offer  an agent will win any offer for g at a
price above p g   a producer increases its buy offer in increments of b and a consumer offers at
most p g    b   in either case  an agent will place a buy offer no higher than p g    b for g  but
then  g   p g    b   which is a contradiction 
case    an agent sets  g  with a sell offer  as with case    there are no buy offers higher than
p g    b   hence every buy offer is strictly below  g   recall that  if there are m sell offers  the
mth highest offer determines  g   then since there are no buy offers at or above  g   it must be
that all sell offers are at or above  g   but then all sell offers are strictly above all buy offers and
no agent wins an offer for g  which is a contradiction 
since each case gives us a contradiction  it must be the case that no agent wins an offer for g
when  g   p g    b    
lemma    if  v     e     is in   competitive equilibrium at prices p  in quiescence of samp sb for
network  v  e   then there exist prices p  such that  v     e     is also in   competitive equilibrium at
p    with g   b for all producers  and goods g 
proof  we specify p  as follows  if  g    p g    b   then p   g     g   otherwise p   g    p g  
we will show that all the conditions of   competitive equilibrium hold with g   b   because we
are considering the same allocation  the goods are still in material balance so condition   still holds
at p   
   

fiwalsh   w ellman

consider an agent a such that p   g    p g  for all adjacent goods g  clearly  ha  p      ha  p 
and  a   v     e      p       a   v     e      p   we then have  a   v     e      p        condition     and the
surplus bound is met for consumers  condition    since these hold at p  if a is a producer  then
for any input g   g   p g   b since p   g    p g   hence  we have the following bound on
its perceived cost for g  pa  g   p g    b   as a result  the producer bidding policies imply that
 a   v     e      p   h  p    hg ie b   s    therefore  a   v     e      p     h  p      hg aie ga  
 

s   and and the producer surplus bound  condition    holds with ga for all inputs g   
now consider an agent a adjacent to a good g with p   g     g   by lemma     a does not win
an offer for g  so  a   v     e      p       a   v     e      p   implying  a   v     e      p        condition    
if a is a consumer  since p   g   p g   and since a does not win g  we have ha  p      ha  p   so the
surplus bound is met for consumers  condition    
if a is a producer  then since it did not win g  it must not have won any good  according to
the   competitive equilibrium conditions and theorem      implying  a   v     e      p         the
producer bidding policy specifies that a offered a price at most    a   hg   aie max  g     p g    
b     s for its output ga   since a did not win ga   it must be that  ga      but by the way
p  is constructed  p   ga     ga   and p   g      b  max  g     p g      b    giving us p   ga   
 ga      a   hg   aie  p   g      b     s   if a would optimize at p  by being active  we have
ha  p      p   ga    a  hg   aie p   g     hg   aie b   s   but since  a   v     e      p        it follows
that  a   v     e      p     ha  p      hg   aie b   s    if  on the other hand  a would optimize at p  by
being inactive at   a   v     e      p      ha  p     in either case  the surplus bound is met for producers
 
 condition    with ga   b for all inputs g     
theorem    if  v     e     is a   competitive equilibrium computed by samp sb then  v     e     has
a nonnegative value that differs from the value of an efficient allocation by at most     hg  i 
e   b   s      c b  
proof  by lemma     there is a   competitive equilibrium for  v     e     with    b for all prog
ducers  and goods g  with b substituted for  in the equation from theorem    we have proved
the present theorem   
g

a   proof of theorem   
in proving the theorem  we refer to the s level of producers in a network  as defined in the beginning
of section a 
theorem    the quiescent state of samp sb is a   competitive equilibrium for a tree 
proof  we prove  by induction on the s level of producers  that no producer changes its initial
output offer  since buy offers never decrease  it follows that  if a producer is winning its output  it
will not lose its output at any successive state of the run of the protocol  since a producer bids for
its inputs only when winning its output  no inactive producer will buy any positive price output and
the present theorem follows from theorem    
basis case  the bidding policy specifies that a producer at s level zero never changes its initial
output offer 
   

fid ecentralized s upply c hain f ormation

inductive case  assume that no producer at s level less than k changes its initial output offer to
show that a producer  at s level k never changes its initial output offer  consider input good g with
m sell offers and the lowest sell offer   since the network is a tree   is the only agent that places
buy offers for g  producer  initially offers zero for g  and so long as it offers less than  it loses
its offer  and p  g     g   while this holds   g   defined as the mth highest price  is the lowest
sell offer  hence p  g      as soon as  offers  or greater for g it will win its offer  and then
p  g    p g   when this holds  p g   defined as the m    st highest price  is the lowest sell offer 
hence p  g      we conclude that p  g  never changes for any input g  hence  never changes its
initial output offer 
we have proven that no producer changes its initial output offer  and by the argument above  the
theorem is proven   
a    proof of theorem   
theorem    the quiescent state of safe samp sb is a   competitive equilibrium for a network
with no input complementarities 
proof  we will show that that no inactive producer buys its input at a positive price in quiescence of
safe samp sb  since the properties of safe samp sb in quiescence are the same as in samp sb 
the present theorem then follows from theorem     assume  to the contrary  that  in quiescence 
producer  wins its input g at a positive price but loses its offer for output g  
let  be the price of the final offer by  for g  p g      be the final price of g  and p  g  be the
final perceived cost of g to   since  wins g in quiescence  p  g    p g   let   be the price of the
second to last offer from   immediately before  places offer   let p   g  be the perceived price
of g to  and p   g  be the price component from the price quote for g  according to the bidding
policy         b   since  offers  only if it loses g with offer     it must be that    p   g   hence
  p   g    b   furthermore  since  loses with offer     we have p   g   p   g    b   because we
assume that  wins g in quiescence  it must be that p g     hence p g   p   g    b   it follows
that  since p  g    p g  and p   g   p   g    b   we have p  g   p   g  
according to the safe samp sb bidding policies   offers  for g only if it is first winning g
with offer price p   g   since p  g   p   g    its offer for g is the same in quiescence as when it
had placed  for g  but since no offers from any agent decrease   must continue to win its final offer
for g   contradicting the assumption that  loses g in quiescence  thus   does not win its input
at a positive price if it is inactive  and the quiescent state of safe samp sb is a   competitive
equilibrium   
a    proof of theorem   
in proving the theorem  we refer to the c level and s level of producers in a network  as defined in
the beginning of section a 
theorem    if  v  e  is a polytree with a solution that assigns good g to consumer c  then given all
other costs and values  there exists a value vc  g  such that samp sb is guaranteed to converge to
a valid solution  v     e     for c 

   

fiwalsh   w ellman


proof  for convenience  denote max v      maxc  c  hg   c  i  hg ci vc   g    as   we show that
the theorem holds for 
vc  g          b   s           b  
we need to show that samp sb cannot reach a state in which p g    vc  g b and c is not winning
g  because then c would stop bidding for g and the desired solution would not form 
first  observe that for any consumer c  and any good g  such that hg    ai  
  hg  ci  c  will not offer
 
above  for g   by construction 
now  consider a producer  such that there is no directed path from  to g through the output
of   we show  by induction on the c level of producers  that no such producer offers higher than
   b d   where d is the c level of   for one of its inputs  for the basis case  such a producer  at
c level one cannot win an output offer above   by the definition of     increases its input offers in
increments of b   so to offer        b   on any input g    it must first offer   where         b
for that input   will only offer   if it is losing  but winning its output offer  but if  is losing
  we must have p g       so  must be offering more than  for its output  but then it cannot be
winning its output  hence would not offer   for g  thus  at c level one does not offer more than
   b for any input  establishing the base case  now  assume that the property holds for every such
producer at c level less than k to show that it holds for producer  at c level k  given the inductive
assumption  it must be that  cannot win its output for more than    b  k      by an argument
similar to the basis case   does not offer above    b k for its input  proving the inductive case 
since d      then no such producer offers higher than    b    for its input 
for any producer    v     denote as i the maximum number of producers  other than   in
the subgraph of  v  e   rooted at   now we show by induction on the s level  that a producer  on
a directed path to g offers no more than     b       d     s  d     i   s for its output  where
d is the s level of   for the basis case  consider such a producer  at s level one  offering to buy
some g    no consumer offers above  for g    because  v  e  is a polytree  any other producer  
that offers to buy g  is not on a directed path to g  hence offers at most    b    to buy g    any
producer that offers to sell g  must have no inputs  hence offers no more than  for g    hence  
can successfully buy g  with a offer no higher than    b           thus will offer no higher than
this amount for g    since the the number of inputs to  is equal to i   it will offer no more than
    b          i   s for its output  and the basis case is proven  now  assume that the property
holds for every such producer at s level less than k to prove that it holds for producer  offering to
buy some g  at s level k  by the inductive assumption  no producer  offers to sell g  for more than
    b       k       s  k     i   s   as in the basis case  no consumer offers more than  for
g  and any producer other than  will offer no more than    b    to buy g    hence   will offer at
most     b       k       s  k     i   s   b to buy g    and for its output will offer at most
 



h g  ipe   hg   ie

 

    b       k       s  k     i   s   b   s 
    b       k    s k     i   s  

proving the inductive case  since i     and d      then no such producer offers higher than
     b      s              s        b   s           vc  g   b  
we have shown that no agent a    c places a buy offer as high as vc  g   b for g and no producer
on a directed path to g places a sell offer as high as vc  g   b for g  hence c is the only agent that
   

fid ecentralized s upply c hain f ormation

could possibly offer as high as vc  g   b for g  but c will offer this high  if necessary  to win g 
and will win g if it offers vc  g   b or higher  it follows that c will win g at a price below vc  g  in
quiescence  by observation   and theorem     the state must be a valid solution   
a    proof of theorem   
theorem    if samp sb reaches quasi quiescence with p g    vc  g  for some hg  ci  e  c  c 
then the systems state represents a valid solution 
proof  because the definition of quasi quiescence requires that active producers do not change
their bids  they must be feasible  all other agents are feasible by definition  the price of an active
producers output good must be no less than the total price of its input goods  otherwise it would
increase its output offer  violating quasi quiescence 
because p g    vc  g   consumer c must have won its offer for g  a consumer bids in such a way
that it wins only one unit of one good  and consumers do not change their bids in quasi quiescence 
finally  the auction guarantees that there is a one to one mapping between successful buy offers
and successful sell offers for any good  ensuring material balance 
thus  each of the constraints for a valid solution is satisfied   
a    proof of theorem   
theorem    if a run of samp sb in  v  e  is in a valid solution state such that 
 each consumer c is either winning an offer or p g    b   vc  g  for all hg  ci  e 
 all agents have correct beliefs about which goods they are currently winning 
 all bids from consumers and active producers have been received in response to the current
price quotes 
 and no sell offers are lost due to tie breaking 
then after the subsequent price quote from each auction  the system will be in a quasi quiescent
state with a valid solution 
proof  let the current prices be p  the consumer bidding policy dictates that the consumers do
not change their offers under the specified conditions  because we have a valid solution  each producer is feasible and thus will not raise any of its buy offers for inputs  therefore  no agent changes
any buy offers 
an active producer  is feasible in a valid solution  since  is winning all of its inputs  it only
raises its offer for output g if p g  changes for once of its inputs g  and will place an offer for its
output a price no higher than the sum of its input good prices  by the definition of a valid solution 
if  is active  then the current price of its output good is no less than sum of the current prices of its
inputs  but since  won its offer for g   it must have offered no higher than p g   for g   because
the previous offer price by  for g is no higher than p g    and because the sum of the current
prices of its inputs are no higher than p g    will offer no higher than p g   for g  
   

fiwalsh   w ellman

we have established that no agent changes any buy offers  and no currently active producer
places a sell offer above p g  for any good g  we show this implies that  at the next price quotes with
prices p    we have p   g    p g   assume the contrary  since offers do not decrease  p   g    p g  
since no buy offer and no winning sell offer changed  the price increase is due an updated losing
sell offer at price   such that    p   g   but if the agent was losing with a previous offer price
of     it must be that   was at least as high as the  m     st highest offer  thus   being higher 
must be strictly higher than the  m     st highest offer  hence cannot raise the price of g  hence
p   g    p g  
since prices do not change  the temporal precedence tie breaking ensures that the set of winning
buy offers does not change  additionally  since no winning seller offers above p g  and no sell
offers are currently lost to tie breaking  the set of winning sell offers does not change  since prices
and allocations do not change  no consumer or active producer will change its bids  furthermore 
because the system is in a valid solution state based on the current price quotes  it must be in a valid
solution state based on the next price quotes   
we note that temporal precedence tie breaking itself  without the requirement that no tied sell
offers are lost  is not sufficient to ensure that the allocation to sellers does not change  if some tied
sell offers are lost  it is possible that an active producer could increase its next sell offer price up
to the price of its output good  if this occurs  then that producer would lose the tie breaking of its
output at the next quote  and the system would not be in quasi quiescence 

references
andersson  a   tenhunen  m     ygge  f          integer programming for combinatorial auction
winner determination  in fourth international conference on multi agent systems  pp    
   
andersson  m  r     sandholm  t  w          leveled commitment contracting among myopic
individually rational agents  in third international conference on multi agent systems  pp 
     
ausubel  l  m     milgrom  p  r          ascending auctions with package bidding  frontiers of
theoretical economics       
axelrod  r          the evolution of strategies in the iterated prisoners dilemma  in davis  l 
 ed    genetic algorithms and simulated annealing  chap     pp        morgan kaufmann 
babaioff  m     nisan  n          concurrent auctions across the supply chain  in third acm
conference on electronic commerce  pp      
babaioff  m     walsh  w  e          incentive compatible  budget balanced  yet highly efficient
auctions for supply chain formation  in fourth acm conference on electronic commerce 
pp       
baker  a  d          metaphor or reality  a case study where agents bid with actual costs to
schedule a factory  in clearwater  clearwater        
bichler  m          the future of e markets  multidimensional market mechanisms  cambridge
university press 
bikhchandani  s     mamer  j  w          competitive equilibrium in an exchange economy with
indivisibilities  journal of economic theory             
   

fid ecentralized s upply c hain f ormation

bikhchandani  s     ostroy  j  m          the package assignment model  journal of economic
theory              
borenstein  s     saloner  g          economics and electronic commerce  journal of economic
perspectives             
clarke  e  h          multipart pricing of public goods  public choice           
clearwater  s   ed            market based control  a paradigm for distributed resource allocation  world scientific 
davidow  w  h          the virtual corporation  structuring and revitalizing the corporation for
the   st century  harpercollins publishers 
davis  r     smith  r  g          negotiation as a metaphor for distributed problem solving 
artificial intelligence            
dellarocas  c   klein  m     rodriguez aguilar  j  a          an exception handling architecture
for open electronic marketplaces of contract net software agents  in second acm conference
on electronic commerce  pp         
demange  g     gale  d          the strategy structure of two sided matching markets  econometrica                
demange  g   gale  d     sotomayor  m          multi item auctions  journal of political economy                
fagin  r   halpern  j  y   moses  y     vardi  m  y          reasoning about knowledge  mit
press 
friedman  d     rust  j   eds            the double auction market  institutions  theories  and
evidence  addison wesley 
fudenberg  d     tirole  j          game theory  the mit press 
greenwald  a          the      trading agent competition  an overview of agent strategies  ai
magazine              
groves  t          incentives in teams  econometrica                
gul  f     stacchetti  e          english and double auctions with differentiated commodities 
journal of economic theory           
gul  f     stacchetti  e          walrasian equilibrium with gross substitutes  journal of economic
theory            
hunsberger  l     grosz  b  j          a combinatorial auction for collaborative planning  in
fourth international conference on multiagent systems  pp         
joshi  p   oke  m   sharma  v     veeramani  d          issues in dynamic and highly distributed
configuration of supply webs  in first iac workshop on internet based negotiation technologies 
kelso  a  s     crawford  v  p          job matching  coalition formation  and gross substitutes 
econometrica                  
kjenstad  d          coordinated supply chain scheduling  ph d  thesis  norwegian university of
science and technology 
   

fiwalsh   w ellman

klemperer  p          auction theory  a guide to the literature  journal of economic surveys        
       
leyton brown  k   pearson  m     shoham  y          towards a universal test suite for combinatorial auction algorithrms  in second acm conference on electronic commerce  pp       
lucking reily  d     spulber  d  f          business to business electronic commerce  journal of
economic perspectives              
mackie mason  j  k     varian  h  r          generalized vickrey auctions  tech  rep   dept  of
economics  univ  of michigan 
malone  t  w     laubacher  r  j          the dawn of the e lance economy  harvard business
review         
mas colell  a   whinston  m  d     green  j  r          microeconomic theory  oxford university
press  new york 
mcafee  r  p          a dominant strategy double auction  journal of economic theory     
       
mcafee  r  p     mcmillan  j          auctions and bidding  journal of economic literature     
       
milgrom  p          putting auction theory to work  the simultaneous ascending auction  the
journal of political economy                 
myerson  r  b     satterthwaite  m  a          efficient mechanisms for bilateral trading  journal
of economic theory             
parkes  d  c   kalagnanam  j     eso  m          achieving budget balance with vickrey based
payment schemes in exchanges  in seventeenth international joint conference on artificial
intelligence  pp           
parkes  d  c     ungar  l  h          iterative combinatorial auctions  theory and practice  in
seventeenth national conference on artificial intelligence  pp       
parkes  d  c     ungar  l  h          an ascending price generalized vickrey auction  in stanford
institute for theoretical economics summer workshop on the economics of the internet 
rosenschein  j  s     zlotkin  g          rules of encounter  mit press 
rust  j   miller  j  h     palmer  r          characterizing effective trading strategies  insights from
a computerized double auction tournament  journal of economic dynamics and control     
     
sandholm  t     suri  s          improved algorithms for optimal winner determination in combinatorial auctions and generalizations  in seventeenth national conference on artificial
intelligence  pp       
sandholm  t  w          an implementation of the contract net protocol based on marginal
cost calculations  in eleventh national conference on artificial intelligence  pp         
satterthwaite  m  a     williams  s  r          bilateral trade with the sealed bid k double auction 
existence and efficiency  journal of economic theory             
satterthwaite  m  a     williams  s  r          the bayesian theory of the k double auction  in
friedman    rust  friedman   rust         chap     pp        
   

fid ecentralized s upply c hain f ormation

shapiro  c     varian  h  r          information rules  harvard business school press 
stone  p     greenwald  a          the first international trading agent competition  autonomous
bidding agents  journal of electronic commerce research  to appear 
veeramani  d   joshi  p     sharma  v          critical research issues in agent based manufacturing
supply webs  in agents    workshop on agents for electronic commerce and managing the
internet enabled supply chain 
vickrey  w          counterspeculation  auctions  and competitive sealed tenders  journal of finance          
walsh  w  e          market protocols for decentralized supply chain formation  ph d  thesis 
university of michigan 
walsh  w  e     wellman  m  p          efficiency and equilibrium in task allocation economies
with hierarchical dependencies  in sixteenth international joint conference on artificial intelligence  pp         
walsh  w  e   wellman  m  p     ygge  f          combinatorial auctions for supply chain formation  in second acm conference on electronic commerce  pp         
walsh  w  e   yokoo  m   hirayama  k     wellman  m  p          on market inspired approaches
to propositional satisfiability  artificial intelligence              
wellman  m  p   greenwald  a   stone  p     wurman  p  r          the      trading agent competition  electronic markets             
wellman  m  p     walsh  w  e          distributed quiescence detection in multiagent negotiation 
in fourth international conference on multi agent systems  pp         
wellman  m  p   walsh  w  e   wurman  p  r     mackie mason  j  k       a   auction protocols
for decentralized scheduling  games and economic behavior                  
wellman  m  p   wurman  p  r   omalley  k   bangera  r   lin  s  d   reeves  d     walsh  w  e 
     b   designing the market game for a trading agent competition  ieee internet computing             
wurman  p  r   walsh  w  e     wellman  m  p          flexible double auctions for electronic
commerce  theory and implementation  decision support systems           
wurman  p  r     wellman  m  p          akba  a progressive  anonymous price combinatorial
auction  in second acm conference on electronic commerce  pp       
wurman  p  r   wellman  m  p     walsh  w  e          a parametrization of the auction design
space  games and economic behavior                  
ygge  f          market oriented programming and its application to power load management 
ph d  thesis  lund university 

   

fi