divergence critic
bundy  a   van harmelen  f   horn  c     smaill  a          oyster clam system 
stickel  m   ed      th international conference automated deduction  pp      
     springer verlag  lecture notes artificial intelligence no      
dershowitz  n     pinchover  e          inductive synthesis equational programs 
proceedings  th national conference ai  pp           american association
artificial intelligence 
hermann  m          crossed term rewriting systems  crin report    r      centre de
recherche en informatique de nancy 
ireland  a          use planning critics mechanizing inductive proof  proceedings lpar     lecture notes artificial intelligence      springer verlag 
available research report      dept ai  edinburgh university 
ireland  a     bundy  a          using failure guide inductive proof  tech  rep   dept 
artificial intelligence  university edinburgh  available edinburgh dai
research paper     
kirchner  h          schematization infinite sets rewrite rules  application
divergence completion processes  proceedings rta     pp          
protzen  m          disproving conjectures  kapur  d   ed      th conference
automated deduction  pp           springer verlag  lecture notes computer
science no      
thomas  m     jantke  k          inductive inference solving divergence knuthbendix completion  proceedings international workshop aii     pp          
thomas  m     watson  p          solving divergence knuth bendix completion
enriching signatures  theoretical computer science               
walsh  t          divergence critic  bundy  a   ed      th conference automated
deduction  pp         springer verlag  lecture notes artificial intelligence no 
    
walsh  t   nunes  a     bundy  a          use proof plans sum series  kapur 
d   ed      th conference automated deduction  pp           springer verlag 
lecture notes computer science no       available edinburgh dai
research paper     
yoshida  t   bundy  a   green  i   walsh  t     basin  d          coloured rippling 
extension theorem proving heuristic  cohn  a   ed    proceedings ecai    
pp         john wiley  available edinburgh dai research paper     

   

fiwalsh
way  types divergence could perhaps recognized
divergence critic  research needed identify divergence patterns  isolate
causes propose ways fixing them  research may take advantage close
links divergence patterns particular types generalization  instance 
may possible identify specific divergence patterns need generalize common
subterms theorem proved 

acknowledgements

research supported human capital mobility postdoctoral fellowship 
wish thank  adel bouhoula michael rusinowitch invaluable assistance
spike  pierre lescanne inviting visit nancy research
performed  david basin  alan bundy  miki hermann  andrew ireland  michael
rusinowitch comments questions  reviewers comments suggestions  members eureca protheo groups inria  members
dream group edinburgh mrg groups trento genova 

references

aubin  r          mechanizing structural induction  ph d  thesis  university edinburgh 
basin  d     walsh  t          difference matching  kapur  d   ed      th conference
automated deduction  pp           springer verlag  lecture notes computer
science no       available edinburgh dai research paper     
basin  d     walsh  t          difference unification  proceedings   th ijcai 
international joint conference artificial intelligence  available technical
report mpi i         max planck institute fur informatik 
basin  d     walsh  t          termination orderings rippling  bundy  a   ed      th
conference automated deduction  pp           springer verlag  lecture notes
artificial intelligence no      
bouhoula  a   kounalis  e     rusinowitch  m          spike  theorem prover 
proceedings lpar     lecture notes artificial intelligence      springer verlag 
bouhoula  a     rusinowitch  m       a   implicit induction conditional theories  journal automated reasoning                  
bouhoula  a     rusinowitch  m       b   spike user manual   inria lorraine
crin      rue du jardin botanique  villers les nancy  france  available
ftp   ftp loria fr pub loria protheo softwares spike  
boyer  r     moore  j          computational logic  academic press  acm monograph
series 
bundy  a   stevens  a   van harmelen  f   ireland  a     smaill  a          rippling 
heuristic guiding inductive proofs  artificial intelligence              
available edinburgh dai research paper no      
   

fia divergence critic
rev qrev x  nil     x
rev qrev x  cons y  nil       cons y  x 
rev qrev x  cons z  cons y  nil        cons z  cons y  x  
  
 

annotated sequence unique maximal difference match  annotations suggest
need wave rule 
rev qrev x  cons y  nil       cons y  rev qrev x  nil     

rule allows proof go without divergence  comparison  specific
generalization seems unable identify rule  specific generalization
left hand side sequence gives term rev qrev x  z    or  ignoring first term
sequence  rev qrev x  cons y  z      specific generalization cannot  however 
identify useful pattern  rev qrev x  cons y  nil    
nqthm contains simple test divergence based subsumption  instance 
example    last section  nqthm unable simplify following subgoal
step case proof 
 equal  rot  length x   append x  list z   
 cons z  rot  length x  x    

note lemma speculated divergence critic  nqthm generalizes  length
x  subgoal giving false conjecture 
 equal  rot  append x  list z   
 cons z  rot x    

several attempts induction generalization  nqthm realizes proof
diverging since subgoal subsumed parent  proof therefore loop 
nqthm gives up  attempt made analyse failed proof attempt identify
started go wrong  addition  subsumption weak test divergence  much
weaker tests based difference matching generalization  subsumption test
recognizes divergence small number failed examples last section 

    conclusions

described divergence critic  computer program attempts identify diverging proof attempts propose lemmas generalizations overcome
divergence  divergence critic proved successful  enables system spike
prove many theorems definitions alone  divergence critic s success
largely attributed power rippling heuristic  heuristic originally
developed proofs using explicit induction since found several applications 
difference matching used identify accumulating term structure causing divergence  lemmas generalizations proposed ripple term structure
   

fiwalsh
divergence critic described works implicit  and explicit  induction setting 
second  divergence critic automatically invoked must identify proof
failing  third  divergence critic less specialized  last two differences ect
fact critics clam usually associated failure particular precondition
heuristic  divergence pattern can  comparison  arise many different
reasons  need generalize variables apart  generalize common subterms  add
lemma  etc  fourth  divergence critic must use difference matching annotate terms 
clam  terms usually already appropriately annotated  finally  divergence critic
less tightly coupled theorem prover s inference rules heuristics  critic
therefore exploit strengths prover without needing reason complex
rules heuristics used  instance  divergence critic diculty identifying
divergence complex situations nested mutual inductions  critic benefits
powerful simplification rules used spike 
divergence studied quite extensively completion procedures  two
main novelties critic described use difference matching identify
divergence  use rippling speculation lemmas overcome divergence 
dershowitz pinchover  comparison  use specific generalization identify divergence patterns critical pairs produced completion  dershowitz   pinchover        
kirchner uses generalization modulo equivalence relation recognise divergence
patterns  kirchner         meta rules synthesized describe infinite families
rules common structure  thomas jantke use generalization inductive
inference recognize divergence patterns replace infinite sequences critical pairs
finite number generalizations  thomas   jantke         thomas watson use
generalization replace infinite set rules finite complete set enriched
signature  thomas   watson        
generalization modulo equivalence enables complex divergence patters identified  however  general undecidable  specific generalization  comparison 
limited  cannot recognize divergence patterns give nested wave fronts like 

s  s x    x   
addition  specific generalization cannot identify term structure wave holes 
example  consider divergence sequence equations produced spike attempts
prove example    section   
rev qrev x  nil     x
rev qrev x  cons y  nil      cons y  x 
rev qrev x  cons z  cons y  nil       cons z  cons y  x  
  
 

divergence analysis identifies term structure accumulating within accumulator argument
qrev  
   

fia divergence critic
unfortunately heuristics instantiating right hand side speculated lemmas
strong enough suggest rule 

x    y   z        x   z  
rule  spike finds proof commutativity multiplication without diculty 
diculties speculating rule arise wave front stuck similar
position sides equality  clues therefore suggest ripple
top term tree 
example     divergence critic proposes lemma one needed  spike
able find proof theorem definitions alone using    inductions  three
inductions equations 
  x   x
s      x   s x 
s s       x   s s x  
sequence equations satisfies divergence critic s preconditions  critic therefore
proposes wave rules moving accumulating successor functions first argument
position    although proposed lemmas necessary  either give much shorter
simpler proof needing   inductions 
example    lemma speculated example     divergence analysis spike s
attempt prove theorem identifies term structure accumulating second  alias
accumulator  argument qrev   first two lemmas proposed removing term
structure use subsumed recursive definition qrev   third
lemma fails prevent divergence  lemma simplifies two element lists second
argument position qrev   however  divergence still occur prover cannot simplify
lists occur second argument position qrev contain   elements 
divergence overcome introduce derived function appending onto end
list  used simplify terms list arbitrary size occurs
second argument position qrev   example  simplify rule 

qrev x      app qrev x  nil    
unfortunately  append occur specification theorem dicult
find heuristic would speculate rule 

   related work

critics monitoring construction proofs first proposed ireland clam
prover  ireland         framework  failure one proof methods automatically
invokes critic  various critics explicit induction developed speculate
missing lemmas  perform generalizations  look suitable case splits  etc  rippling plays
central role clam s proof methods  many heuristics similar described
 ireland   bundy         are  however  several significant differences  first 
   

fiwalsh

theorem
  
s x  y y  x y 
  
x y y x
   x  y  z  v w      w  x  y  z v   

lemmas speculated
time s
 
n a
s x  y x s y 
   
s x  y s x y 
    
s x  y x s y 
   qrev qrev x  y   z  y   qrev qrev x     z 
qrev y x   z     qrev x   y z 
   
qrev qrev x y   z  w  qrev qrev y   x z  w 
qrev qrev x y    z   w  z  qrev qrev x  y   w 

table    divergence critic s failures 
diverges  generating following sequence equations 
s y     x    x y     s y     y    x y  
s s y      x    x    x y      s x     s y     x    x y  
s s s y       x    x    x    x y       s x     s s y      x    x    x y    
  
 
divergence analysis left hand sides equations suggests need rule
form 

s y      x   z     f  y   z  
unfortunately heuristics lemma speculation suciently strong suggest
suitable instantiation f  for example  z   s x   z     lemma rather complex
result two overlapping divergence patterns  annotations considered
separately  suggest rules 

s x       s x    
   x   z     x    y   z  
two rules  spike finds proof without diculty 
example    commutativity multiplication  divergence critic identifies
divergence pattern proposes transverse wave rule 

s x       x   s y  
however  spike unable prove commutativity multiplication addition
rule  proof attempt somewhat simpler contains diverging sequence
equations 
x    y    x    x y         x    x    x y   
x    y    x    x    x y           x    x    x    x y    

x    y    x    x    x    x y            x    x    x    x    x y     
  
 

   

fia divergence critic
speculate non theorems  research optimal strength generalization
heuristics would valuable 
example    disappointment  lemma proposed fixes divergence
dicult proved automatically  even assistance divergence critic 
see example    end section details  example    discussed
detail related work section   demonstrates superiority difference
matching generalization techniques divergence analysis  examples       require
little discussion  finally  examples       demonstrate critic cope
divergence moderately complex theories containing conditional equations 
results pleasing  using divergence critic     theorems listed  with
exception     proved definitions alone  provide indication
diculty theorems  nqthm system  boyer   moore        
perhaps best known explicit induction theorem prover  unable prove
half theorems definitions alone  precise  nqthm failed               
                                                       course  addition
simple lemmas  nqthm able prove theorems  indeed  many cases  nqthm
needs lemmas proposed divergence critic required spike 
suggests divergence critic especially tied particular prover used
even implicit induction setting 
test hypothesis  presented output diverging proof attempt nqthm
critic  chose commutativity multiplication perhaps simplest
theorem causes nqthm diverge  critic proposed lemma 
 equal  times  add  x    plus  times x    

times plus primitives nqthm s logic recursively defined first
arguments  exactly lemma needed nqthm prove commutativity
multiplication  nqthm fails many examples similar reasons spike 
divergence analysis identifies appropriate lemma  supports suggestion
divergence critic likely useful wide variety provers 
divergence critic several limitations  recognizing divergence is  general 
undecidable since reduces halting problem  divergence critic therefore
sometimes fail identify diverging proof attempt  addition  critic sometimes
identify  divergence  pattern proof attempt diverging  even divergence correctly identified  critic sometimes fail speculate appropriate
lemma  finally  critic speculates wave rules  whilst many theories contain large
number wave rules  often useful fixing divergence  types
lemma needed 
table   lists four theorems divergence critic fails  problems
representative different ways critic fail  two main cause
failure overlapping divergence patterns  inability heuristics speculate
appropriate right hand side lemma  times speculate lemmas
find proof theorem 
example    commuted version recursive definition multiplication  
defined recursively second argument position   spike s attempt prove theorem
   

fiwalsh
examples      optimal rules fixing divergence  nevertheless  either proposed rules fix divergence proved without diculty
spike  example   similar example   
examples       require little comment  example     proposed lemma
dicult proved automatically  however  divergence critic able identify
cause diculty propose lemma allows proof go  example
     example     speculated lemma optimal  simpler lemma speculated
example    would adequate prove theorem without divergence  speculated
lemma optimal divergence critic attempts ripple accumulating
term structure two functors  len rot top term tree  however 
sucient problem ripple one functor  rot 
examples       straightforward require discussion  example    
critic identifies two separate divergence patterns  overcome divergence  first lemma
plus one second third therefore needed  first divergence pattern
occurs sequence subgoals 

len rev x         len x 
len  app rev x   cons y  nil       s     len x  
len  app app rev x   cons y  nil    cons z  nil       s s     len x   
  
 

term structure accumulating second argument append  term structure
removed first rule 

len  app x  cons y  nil       s len x   
second divergence pattern occurs sequence subgoals 

s x    len y    s x   len y  
s s x     len y    s s x   len y   
s s s x      len y    s s s x   len y    
  
 

term structure accumulating first argument    removed one
second third rules 

s x       s x    
s x       x   s y  
examples       reasonably straightforward  lemma speculated example
   special case associativity append  powerful generalization heuristics
could speculated associativity append  however  heuristics would
   

fia divergence critic
causes divergence current release  speculated lemmas do  however  simplify
proof  example   used text illustrate generalization heuristics  second
lemma example   perhaps little surprising 

len app x   cons w  cons z           s len app x  cons w        
although complex first lemma  nearly good fixing divergence 
example    lemma proposed 

even  s s x          even x    
optimal  is  simplest possible lemma fixes divergence  fix
divergence  merely need one rules  s x       s x     s x       x  
s y    either ripple successor functions accumulating first argument
position    divergence critic attempts construct lemma ripple two successor
functions across first second argument positions    unfortunately 
critic fails find appropriate instantiation right hand side lemma 
critic instead proposes rule move two successor functions top term
wave front peter out  example   similar example   
examples      demonstrate critic cope divergence theories involving mutual recursion  example    spike attempts prove induction equations 

evenm x   x 
oddm s x    x 
evenm  s s x     x 
oddm s s s x      x 
evenm  s s s s x       x 

 
 
 
 
 
  
 

true
true
true
true
true

critic identifies two inter linking divergence patterns 

evenm  x   x    true
evenm   s s x     x    true
evenm   s s s s x       x    true

oddm s x    x    true
oddm  s s s x      x    true
oddm  s s s s s x        x    true

  
 

  
 

critic therefore proposes rules ripple accumulating term structure
top term peters out 

evenm  s s x          evenm  x    
oddm  s s x          oddm x    
   

fiwalsh

 

theorem
s x  x s x x 

lemmas speculated
time s
s x  y s x y 
   
s x  y x s y 
 
dbl x  x x  
s x  y s x y 
   
dbl       dbl s x   s s dbl x   
s x  y x s y 
 
len x   y  len y   x 
len x    z   y   s len x   y  
   
len x    z   y   len  w   x    y 
 
len x   y  len x  len y 
s x  y s x y 
   
s x  y x s y 
 
len x   x  dbl len x  
len x    z   y   s len x   y  
    
len x    w   z   y   s len x    w   y   
 
even x x 
even s s x   y  even x y 
   
 
odd s x  x 
odd s s x   y  odd x y 
    
 
evenm  x x 
evenm  s s x   y  evenm  x y 
    
oddm  s s x   y  oddm  x y 
 
oddm  s x  x 
evenm  s s x   y  evenm  x y 
    
oddm  s s x   y  oddm  x y 
  
evenm  x    half x  half x  x
s x  y s x y 
   
s x  y x s y 
  
half x x  x
s s x   y x s s y  
    
half s s x   y  half x y 
  
half s x  x  x
s s x   y x s s y  
    
half s s x   y  half x y 
  
rot len x  x  x
rot len x  x    y   y  rot len x  x 
   
  
len rot len x  x   len x 
len rot x z    y    s len rot x z   
   
  
rot len x  x    y   y   rot len x  x 
 x    y    z x    y   z 
    
rot len x   x    y    z  y   rot len x  x   z 
  
len rev x   len x 
len x    y   s len x  
   
  
rev rev x   x
rev x    y   y  rev x 
   
  
rev rev x     y   y   x
rev x    y   y  rev x 
    
  
rev rev x     y   y   rev rev x  
rev x    y   y  rev x 
    
  
len rev x   y   len x  len y 
len x    y   s len x  
    
s x  y s x y 
s x  y x s y 
  
len qrev x      len x 
len qrev x z   y   s len qrev x y   
   
  
qrev x y  rev x   
 x    y    z x    y   z 
   
  
len qrev x y   len x  len y 
s x  y s x y 
    
s x  y x s y 
  
qrev qrev x         x
qrev qrev x  y   z  y   qrev qrev x     z 
   
  
rev qrev x      x
rev qrev x  y    y   rev qrev x     
   
  
qrev rev x      x
qrev x    y  z  y  qrev x z 
   
  
nth i nth j x   nth j nth i x  
nth s i  nth j y   x   nth i nth j x  
   
   nth i nth j nth k x    nth k nth j nth i x   
nth s i  nth j y   x   nth i nth j x  
   
  
len isort x   len x 
len insert y x   s len x  
   
  
sorted isort x  
sorted insert y x   sorted x 
   
sorted insert y insert z x    sorted x 

table    lemmas speculated divergence critic 
notes     written infix cons    infix append     nil   x  cons x nil  
addition  even defined s s x   recursion  evenm mutual recursion oddm  
rot n  l  rotates list l n elements 
   

fia divergence critic
critic successful identifying divergence proposing appropriate lemmas
generalizations significant number theorems  divergence analysis quick
examples  divergence pattern recognized usually less second 
time spent looking generalizations refuting over generalizations
conjecture disprover  usually takes       seconds  additional heuristics
preventing over generalization ecient implementation conjecture
disprover would speed critic considerably 

   results

table   lists    theorems cause spike diverge lemmas speculated
divergence critic analysing diverging proof attempts  problems provide
representative sample type theorems cause divergence
identified appropriate lemma generalization speculated  many problems
come clam library corpus  part table appeared  walsh        
times divergence critic speculate lemmas average   
runs sun   running quintus       
spike s proof attempt diverges example given definitions alone 
   cases  critic quickly able suggest lemma overcomes divergence 
multiple lemmas proposed  with exception     one
sucient fix divergence  every case  except        lemmas proposed
suciently simple proved automatically without introducing fresh divergence 
majority cases  lemmas proposed optimal  is  simplest possible
lemmas fix divergence  cases lemma optimal  usually
slightly complex simplest lemma fixes divergence  many
examples  lemmas conjectured divergence analysis quickly
rejected conjecture disprover  example  example     divergence analysis
petering heuristic suggest rule 
   len  app x  cons y  nil       len x     
however  refuted exhaustive normalization using ground terms x  
case  cancellation heuristic identifies required lemma 
len  app x  cons y  nil       s len x     
examples deserve additional comment  example    divergence critic
identifies successor functions accumulating first argument position   
critic speculates lemma moving successor functions either top
term  so immediate cancellation occur  onto second argument position
 so simplification recursive definition   occur   first lemma
speculated fact generalization theorem proved  example   simple
program verification problem taken dershowitz pinchover         forward
direction theorem discussed introduction  similar divergence occurs
example   and  generalization  lemmas speculated 
example   caused divergence beta version spike available summer
      proof rules spike since strengthened example longer
   

fiwalsh

  compiling file  home dream  tw work spike diverge data double x x
  data double x x compiled module user        sec       bytes
     speculate 
equations input 
double x   x  x 
s x  x   s x   x 
s s x  x    s s x    x 
s s s x  x     s s s x     x 
lemmas speculated 
s x   x  s x  x  
s x   x   s x  x   
s x    x  s x   x  
s x    x    s x   x    
s x   x  x  s x  
s x   x   x  s x   
s x    x  x   s x  
s x    x    x   s x    
deleting lemmas subsumed 
s x   x   s x  x   
s x   x   x  s x   
merging remaining lemmas 
s x   x   s x  x   
s x   x   x  s x   
yes
    

figure    example output divergence critic 
figure   gives divergence critic s output problem discussed introduction 
either proposed lemmas used rewrite rule adequate fix divergence 
addition  proposed lemmas suciently simple proved automatically without
introducing fresh divergence  first lemma rewrite rule moving accumulating
successor functions first argument position   top term tree 
second lemma transverse wave rule discussed section   moving accumulating
successor functions first argument position   second argument position 
   

fia divergence critic

preconditions 
   sequence equations si   ti
prover attempts prove induction  i             
   exists  non trivial  g  h j  
maximal difference match sj   g uj   acc 
sj     g  h  uj     acc  
postconditions 
   critic proposes rule form 

g  h  u     acc    g u   f  acc   
   f instantiated fertilization simplification
heuristics 
   lemma generalized using  augmented  primary terms equality heuristics 
   generalized lemmas filtered type checker
conjecture disprover 
   several lemmas suggested  critic deletes
subsumed 
figure    speculation transverse wave rules 
annotations  could speculate hybrid wave rules ripple part wave front
across part term tree  however  rules appear rare  addition 
hybrid wave rules often decomposed pair wave rules  one
moves wave fronts term tree  another moves wave fronts
across 

   implementation

divergence critic described previous sections implemented prolog 
system consists     lines code defining approximate     different prolog predicates  recently cut version incorporated directly within spike
system written caml light  bouhoula   rusinowitch      b   output
spike parsed generate input critic  input consists of  equations
prover attempts prove induction  sort information  for type checker
difference matcher   recursive argument positions  for constructing primary terms  
rewrite rules defining theory  used conjecture disprover  
   

fiwalsh
rule allows proof go without divergence 
speculated transverse wave rules generalized using extended primary terms
heuristic described section    divergence critic generalizes transverse wave
rules means equality heuristic  heuristic attempts cancel equal outermost
functors possible  example  consider theorem 

 x     x   y    x  
addition defined recursively second argument position subtraction
defined rewrite rules 

x      x
  x    
s x    s y    x   y 
spike s attempt prove theorem diverges generating  amongst others  goals 

 x       x  
 s x        x   s y  
 s s x         x   s s y   
  
 
divergence analysis identifies accumulating term structure within equations 
 x       x  
  s x        x   s y 
  s s x         x   s s y   
  
 
unique maximal difference match  annotations suggest need
transverse rule 
  s x         x    x   s y       x 
equality heuristic deletes equal outermost function  z   z   x   gives
general lemma 
s x       x   s y    
speculated lemmas filtered type checker ensure erasure
well typed  speculated lemmas filtered conjecture disprover guard
over generalization 
actions critic summarized figure    specification preconditions
postconditions uses second order variables limited manner  implementation merely requires second order matching first order difference matching 
preconditions postconditions easily generalised include multiple nested
   

fia divergence critic
qrev a  b    app rev a   b 
qrev a  cons c  b      app  app rev a   cons c  nil     b 
qrev a  cons c  cons d  b       app  app app rev a   cons c  nil    cons d  nil     b 
  
 

unique maximal difference match  rather move accumulating term
structure right hand side equations top term  much simpler
move accumulating term structure first onto second argument
outermost append  critic therefore proposes transverse wave rule  preserves
skeleton moves difference onto different argument position  example 
rule form 

app  app rev a   cons c  nil     b    app rev a   f  b    
moving difference onto another argument position  difference may change syntactically  right hand side lemma therefore partially determined 
instantiate f   critic uses two heuristics  fertilization simplification 
fertilization heuristic uses matching find instantiation f enables
immediate fertilization  case  matching universally quantified variable b
induction hypothesis suggests 

app  app rev a   cons c  nil     b    app rev a   cons c  b    
finally critic generalizes lemma using extended primary term heuristic
 i e   augmenting recursive positions wave hole positions   gives rule 

app  app a  cons c  nil     b    app a  cons c  b    
exactly rule needed spike complete proof  addition  simple
enough proved without divergence  true ungeneralized rule 
heuristic used instantiate right hand side speculated lemma
simplification heuristic  heuristic uses regular matching find instantiation
f enable wave front simplified using one recursive definitions 
consider dbl theorem introduction  divergence analysis identifies successor functions accumulating first argument position    accumulating term
structure either moved top term tree alternatively onto second
argument position   using transverse wave rule form 

s x       x   f  y    
right hand side transverse wave rule instantiated simplification heuristic 
wave front right hand side simplified rewrite rule recursively
defining   f instantiated z   s z    is  rule 

s x       x   s y    
   

fiwalsh
f   s y g cover set natural numbers  two rules merged give 
sorted  insert y  x      sorted x  

   transverse wave rules
lemmas speculated far moved accumulating term structure directly top
term removed cancellation petering out  alternative way
removing accumulating term structure move onto another argument position where 
either removed matching  sink   universally quantified variable
induction hypothesis  moved upwards rewriting recursive
definitions  annotated rewrite rules preserve skeleton move wave fronts
across argument positions called transverse wave rules  bundy et al         
theorems involving functions accumulators provide rich source examples
rewrite rules prevent divergence 
consider  example  theorem correctness tail recursive list reversal 

 a  b   qrev a  b    app rev a   b 
b universally quantified  rev naive list reversal using append 
qrev tail recursive list reversal building reversed list second argument position 
functions defined rewrite rules 
rev nil 
rev cons h  t  
qrev nil  r 
qrev cons h  t   r 

 
 
 
 

nil
app rev t   cons h  nil  
r
qrev t  cons h  r   

spike s attempt prove theorem diverges generating following sequence equa 

tions prover attempts show induction 

qrev a  b    app rev a   b 
qrev a  cons c  b     app app rev a   cons c  nil    b 
qrev a  cons c  cons d  b      app app app rev a   cons c  nil    cons d  nil    b 
  
 

difference matching identifies term structure accumulating within equations
causing divergence 
   

fia divergence critic
s      len b    s len b  
s s       len b    s s len b   

  
 
difference matching identifies term structure causing divergence 
    len b    len b 
s      len b    s len b  

s s       len b    s s len b   

  
 
unique maximal difference match  annotations suggest need
wave rule 
s      len b    s     len b    
set candidate terms generalization constructed computing intersection
primary terms two sides rule  case  primary terms left
hand side set fs      len b   len b   bg  primary terms right hand
side set fs     len b        len b   len b   bg  intersection primary terms
thus set flen b   bg  critic picks members intersection generalize new
variables  picking b justs gives equivalent lemma renaming variables  picking
len b  gives generalization 
s        s     y   
reason considering primary terms recursive definitions typically
provide wave rules removing term structure accumulates positions 
addition primary terms  divergence critic therefore considers positions
wave holes  but wave fronts  skeleton lemma speculated 
motivation extension speculated lemma allow accumulating term
structure moved wave hole positions  positions therefore candidates generalization  positions wave fronts included since want
speculate lemma move term structure positions 
instance  wave hole first argument   last example 
  included intersection set candidate terms generalization  picking  
generalize gives 
s x      s x   y   
speculated lemma general possible  rule allows proof go
without divergence 
critic heuristic merging speculated lemmas  instance 
theorem sorted isort x    critic speculates several rules including 
sorted  insert    x      sorted x 
sorted  insert s y   x      sorted x 
   

fiwalsh

   critic proposes rule form 

g  h  u       f  g u   
   f instantiated cancellation petering
heuristics 
   lemmas filtered type checker conjecture disprover 
   several lemmas suggested  critic deletes
subsumed 
figure    postconditions divergence critic

   generalization

major cause divergence need generalize  lemmas proposed
critic fix divergence  attempting prove lemmas cause
fresh divergence  addition  several speculated lemmas sometimes replaced
single generalization  generalized lemmas lead shorter  elegant
natural proofs  critic therefore attempts generalize lemma speculated  using
conjecture disprover guard over generalization 
main heuristic used generalization extension primary term heuristic
 aubin         primary terms terms encountered term explored
root leaves ignoring non recursive argument positions functions 
notion recursive argument position used critic defined bouhoula
rusinowitch      a  used spike performing inductions 
consider  example  theorem 

 a  b   len a    len b    len app a  b  
  defined recursively second argument  len app defined
means rewrite rules 
len nil 
len cons h  t  
app nil  t 
app cons h  t   r 

 
 
 
 

 
s len t  

cons h  app t  r   

problem taken clam library corpus  bundy et al          spike s attempt
prove theorem diverges  one sequences equations generated is 
    len b    len b 
   

fia divergence critic
spike s diverging attempt prove theorem generates equations 

nth s i   nth j  x     nth s j    nth i  x  
nth s s i    nth j  cons y  x      nth s j    nth i  x  
nth s s s i     nth j  cons z  cons y  x       nth s j    nth i  x  
  
 

divergence analysis identifies term structure accumulating two different places 

nth s i   nth j  x     nth s j    nth i  x  
nth  s s i     nth j  cons y  x       nth s j    nth i  x  
nth  s s s i      nth j  cons z  cons y  x        nth s j    nth i  x  
  
 

unique maximal difference match  divergence pattern suggests need
rewrite rule form 

nth  s i     nth j  cons y  x        f  nth i  nth j  x      
petering heuristic instantiates f identity function z   z giving rule 

nth  s i     nth j  cons y  x       nth i  nth j  x    
rule allows proof go without divergence 
since erasure wave rule must properly typed  sort information used
prune inappropriate instantiations f   speculated lemmas therefore filtered
type checker  speculated lemmas filtered conjecture disprover 
con uent set rewrite rules exists ground terms  exhaustive normalization
representative set ground instances equations used filter nontheorems  alternatively  prover could used filter non theorems  unlike
many induction theorem provers  spike refute conjectures since inference
rules refutationally complete conditional theories axioms ground
convergent defined functions completely defined free constructors  bouhoula  
rusinowitch      a   techniques disproving conjectures described protzen
       
critic s lemma speculation summarized figure    using variable
names preconditions   specification uses second order variables
limited manner  first order difference matching merely required construct lemmas 
preconditions  specification postconditions easily extended
deal multiple nested wave fronts  as nth i  nth j  l     nth j  nth i  l  
example   since rules proposed critic move wave fronts top term 
usually introduce fresh divergence rare cases cancellation fertilization
fails  unlikely since cancellation petering heuristics attempt ensure
precisely cancellation fertilization take place 
   

fiwalsh
divergence pattern suggests f instantiated z   s z  enable immediate cancellation  thus  required  cancellation heuristic suggests rule 
s x       s x      
heuristic used instantiate right hand side speculated lemmas
petering out  moving differences top term  may disappear
altogether  consider  example  theorem 
 l   sorted isort l     true
isort insertion sort sorted true iff list sorted order  defined
conditional rewrite rules 
sorted nil    true
sorted cons x  nil     true
x     sorted cons x  cons y  z       sorted cons y  z   
isort nil    nil
isort cons x       insert x  isort y   
insert x  z    inserts element x list z order  x  
defined rewrite rules 
    x   true
s x         false
s x     s y     x  
insert x  nil    cons x  nil 
x     insert x  cons y  z      cons x  cons y  z   
  x       insert x  cons y  z      cons y  insert x  z   
divergence analysis spike s attempt prove theorem suggests need
rule form 
sorted  insert y  x      f  sorted x   
petering heuristic instantiates f identity function z   z  gives rule 
sorted  insert y  x      sorted x  
rule allows proof go without divergence 
complex example  consider theorem 
 i  j  l   nth i  nth j  l     nth j  nth i  l  
nth defined rewrite rules 
nth    l    l
nth n  nil    nil
nth s n    cons h       nth n    
   

fia divergence critic
nested annotations  allows critic recognise multiple sources divergence
equation  techniques identify accumulating term structure specific
generalization  dershowitz   pinchover        cannot cope divergence patterns
give rise nested annotations  see section   details  
specification preconditions left length sequence undefined 
sequence length    critic preemptive  is  propose lemma
another induction attempted divergence begins  short sequence risks
identifying divergence none exists  hand using long sequence expensive test allows prover waste time diverging proof attempts  empirically 
good compromise appears look sequences length    cheap
test reliable  identify accumulating term structure  appears sucient
use ground difference matching alpha conversion variable names  exists
fast polynomial algorithm perform difference matching based upon ground
difference matching algorithm using dynamic programming  basin   walsh         since
skeleton must well typed  along erasure   algorithm extended use
sort information prune potential difference matches 

   lemma speculation
one way removing accumulating nested term structure propose wave rule
moves difference top term leaving skeleton unchanged  hope
either cancel wave fronts side equality
disappear process moved  dbl theorem  generalization
 which discussed next section  divergence pattern suggests rule form 

s x       f  x    
f second order variable need instantiate  instantiating f ultimately dicult synthesis problem hope heuristics work
time  two heuristics used divergence critic instantiate f
cancellation petering out 
cancellation heuristic uses difference matching identify term structure accumulating opposite side sequence would allow cancellation occur  failing
that  cancellation heuristic looks suitable term structure cancel new
sequence  the original sequence usually divergence pattern step case  whilst
new sequence usually divergence pattern base case   dbl example  successor
functions accumulate top left hand side diverging equations 

s x   x    s x    x
s s x   x     s s x     x
s s s x   x      s s s x      x
  
 

   

fiwalsh
critic attempts find accumulating nested term structure
sequence causing divergence  case  successor functions accumulating
first argument    identify accumulating term structure  critic uses
difference matching  difference matching successive equations gives annotated sequence 

s x   x    s x    x
s s x   x     s s x     x
s s s x   x      s s s x      x
  
 

unique maximal difference match 
critic tries speculate lemma used rewrite rule move
accumulating nested term structure way  case  critic speculates
rule moving successor function first argument    is  rule 

s x       s x      
rule  spike able prove dbl theorem without divergence  addition 
rule suciently simple proved without assistance  heuristics used
critic perform lemma speculation described detail next two
sections 
divergence analysis performed critic summarised figure    analysing
   sequence equations si   ti
prover attempts prove induction  i             
   exists  non trivial  g  h j  
maximal difference match sj   g uj    sj     
g  h  uj     
figure    preconditions divergence critic
divergence  consider equations prover attempts prove induction  includes equation induction proof succeeds often
suggest useful patterns   non trivial  wish exclude z   z  identity substitution  h thus accumulating nested term structure appears causing
divergence  dbl example  h z   s z   g z   z   x  u  s x   although
g h second order variables  second order nature divergence analysis
limited  indeed  implementation critic merely requires first order difference
matching polynomial  simplicity  preconditions ignore orientation
equations  addition  preconditions easily generalised include multiple
   

fia divergence critic
rippling several desirable properties  highly goal directed  manipulating
differences induction hypothesis induction conclusion 
annotations restrict application rewrite rules  rippling involves little
search  difference matching rippling proved useful domains outside explicit
induction  example  used sum series  walsh  nunes    bundy       
prove limit theorems  yoshida  bundy  green  walsh    basin         rest
paper  show difference matching rippling useful identifying
correcting divergence prover neither uses explicit rules induction uses
annotations control rewriting 

   divergence analysis

initial problem recognizing proof diverging  various properties rewrite
rules identified cause divergence like  example  forwards backwards
crossed systems  hermann         however  properties fail capture diverging
rewrite systems since problem is  general  undecidable  divergence critic instead
studies proof attempt looking patterns divergence  attempt made analyse
rewrite rules structures give rise divergence  advantage
approach critic need know details rewrite rules applied 
type induction performed  control structure used prover  critic
thus recognise divergence patterns arising complex mutual multiple inductions
little diculty divergence patterns arising simple straightforward
inductions  disadvantage approach critic identify  divergence 
pattern none exists  fortunately  cases appear rare  even
occur  critic usually suggests lemma generalization gives shorter
elegant proof  see section   example  
illustrate ideas behind critic s divergence analysis  consider theorem
introduction 
 n   dbl n    n   n 
divergence critic first partitions sequence equations prover attempts
prove induction  necessary since several diverging sequences may interleaved
prover s output  several heuristics used reduce number partitions
considered  useful heuristic parentage sequence partitioned
equation derived previous one  is  equations lie
single branch proof tree  particular  base case step case induction
partitioned different sequences  heuristics used include 
function constant symbols occur one equation occur next equation
partition  weights equations partition form simple arithmetic
progression  case  single open branch proof tree 
s x   x    s x    x
s s x   x     s s x     x
s s s x   x      s s s x      x
  
 
   

fiwalsh
annotated term r  difference matching unitary  is  two terms
one difference match  example  s s x   s  s x    difference matches
s s x   s x   number difference matches reduced compute
maximal difference match wave fronts high possible term tree 
formal definition well founded ordering annotated terms given
basin walsh        
aim rippling rewrite annotated induction conclusion skeleton 
induction hypothesis  preserved differences  wave fronts moved
harmless places  for example  top term   rewriting succeeds 
able appeal induction hypothesis  rewrite annotated induction
conclusion  use following annotated rewrite rules  wave rules 

dbl  s x       s s dbl x    
x   s y     s x    
s x       s x    

   
   
   

first two annotated rewrite rules derived recursive definitions dbl
  whilst second derived lemma proposed end introduction 
annotated rewrite rules preserves skeleton term rewritten 
moves wave fronts higher term tree  wave rules guarantee this  wave rule
annotated rewrite rule identical skeleton left right hand sides
moves wave fronts well founded direction like  instance  top term tree
 basin   walsh        
rippling left hand side annotated induction conclusion using     yields 

s s dbl x      s x    s x   
rippling right hand side     gives 

s s dbl x      s  s x    x   
finally rippling     right hand side yields 

s s dbl x      s s x   x    
wave fronts top term  successfully rippled sides
equality  appeal induction hypothesis left hand side giving 

s s x   x     s s x   x    
simple identity proof complete  note complete proof 
needed rewrite lemma       aim divergence critic described
paper propose lemmas 
   

fia divergence critic
section    describe difference matching rippling  two key ideas heart
divergence critic  outline difference matching identifies accumulating
term structure causing divergence  section     section      show
lemmas speculated  ripple  term structure way  section   
describe heuristics used generalizing lemmas  finally  implementation
results described sections     

   difference matching rippling

rippling powerful heuristic developed edinburgh proving theorems involving
explicit induction  bundy  stevens  van harmelen  ireland    smaill        implemented clam theorem prover  bundy  van harmelen  horn    smaill        
step case inductive proof  induction conclusion typically differs induction
hypothesis addition constructors destructors  rippling uses annotations
mark differences applies annotated rewrite rules remove them 
simple example  consider theorem discussed introduction 
step case  induction hypothesis is 

dbl x    x   x
induction conclusion is 

dbl s x     s x    s x  
 difference match  induction conclusion induction hypothesis  basin
  walsh         obtain following annotated induction conclusion 

dbl  s x      s x    s x   
annotation consists wave front  box wave hole  underlined term  wavefronts always one functor thick  basin   walsh         is  every wave front
one immediate subterm annotated wave hole  make presentation simpler 
display adjacent wave fronts merged  thus  s s x   syntactic sugar
annotated term  s  s x      wave fronts include arrows indicate
whether moving towards top term tree towards leaves 
extension can  however  safely ignored here 
skeleton annotated term formed deleting everything appears
wave front wave hole  erasure annotated terms formed
deleting annotations terms contain  case  skeleton
annotated induction conclusion identical induction hypothesis  erasure
annotated induction conclusion unannotated induction conclusion  difference
matching guarantees this  is  difference matching induction conclusion
induction hypothesis annotates induction conclusion skeleton matches
induction hypothesis 
formally  r difference match substitution iff  skeleton r    
erase r    skeleton r  erase r  build skeleton erasure
   

fiwalsh
alpha convert variable names necessary  rewriting induction conclusion
recursive definitions dbl   gives 

s s dbl x      s s x    x  
outermost successor functions either side equality cancelled 

s dbl x     s x    x 
prover fertilizes induction hypothesis left hand side 

s x   x    s x    x 
equation cannot simplified another induction performed  unfortunately 
generates diverging sequence subgoals 

s x   x 
s s x   x  
s s s x   x   
s s s s x   x    
s s s s s x   x     

 
 
 
 
 
  
 

s x    x
s s x     x
s s s x      x
s s s s x       x
s s s s s x        x

problem prover repeatedly tries induction x unable simplify
successor functions introduces first argument position    proof
go without divergence rewrite rule 

s x       s x     
rule  ripples  accumulating successor functions first argument position   
rewrite rule derived lemma 

 x    s x      s x   y  
commuted version recursive definition addition is  coincidently 
generalization first subgoal  lemma proved without divergence
induction variable  occurs second argument position   
paper describe simple  divergence critic   computer program attempts
automate process  divergence critic identifies proof attempt diverging
means  difference matching  procedure  critic proposes lemmas
generalizations hopefully allow proof go without divergence  although
critic designed work prover spike  work induction
provers  walsh         spike rewrite based theorem prover first order conditional
theories  contains powerful rules case analysis  simplification implicit induction
using notion test set  unfortunately  case inductive theorem
provers  attempts prove many theorems diverge without appropriate generalization
addition suitable lemma 
   

fijournal artificial intelligence research                 

submitted       published     

divergence critic inductive proof
toby itc it

toby walsh

irst  location pante di povo
i      trento  italy

abstract

inductive theorem provers often diverge  paper describes simple critic  computer program monitors construction inductive proofs attempting identify
diverging proof attempts  divergence recognized means  difference matching 
procedure  critic proposes lemmas generalizations  ripple  differences away proof go without divergence  critic enables
theorem prover spike prove many theorems completely automatically definitions alone 

   introduction

two key problems inductive theorem proving proposing lemmas generalizations 
prover s divergence often suggests user appropriate lemma generalization
enable proof go without divergence  simple example  consider
theorem 

 n   dbl n    n   n 
part simple program verification problem  dershowitz   pinchover        
addition doubling defined recursively means rewrite rules 

x     x
x   s y     s x    
dbl       
dbl s x      s s dbl x    
s x   represents successor x  that is  x       adopted prolog
convention writing meta variables x upper case 

theorem prover spike  bouhoula  kounalis    rusinowitch        fails prove
theorem  proof attempt begins simple one step induction x  base
case trivial  step case  induction hypothesis is 
dbl x    x   x
induction conclusion is 

dbl s x     s x    s x  
ease presentation  variables paper are  here  sometimes renamed
introduced spike  effect results prover divergence critic

c      ai access foundation morgan kaufmann publishers  rights reserved 


