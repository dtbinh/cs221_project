a divergence critic
bundy  a   van harmelen  f   horn  c     smaill  a          the oyster clam system  in
stickel  m   ed      th international conference on automated deduction  pp      
     springer verlag  lecture notes in artificial intelligence no      
dershowitz  n     pinchover  e          inductive synthesis of equational programs  in
proceedings of the  th national conference on ai  pp           american association
for artificial intelligence 
hermann  m          crossed term rewriting systems  crin report    r      centre de
recherche en informatique de nancy 
ireland  a          the use of planning critics in mechanizing inductive proof  in proceedings of lpar     lecture notes in artificial intelligence      springer verlag  also
available as research report      dept of ai  edinburgh university 
ireland  a     bundy  a          using failure to guide inductive proof  tech  rep   dept 
of artificial intelligence  university of edinburgh  available from edinburgh as dai
research paper     
kirchner  h          schematization of infinite sets of rewrite rules  application to the
divergence of completion processes  in proceedings of rta     pp          
protzen  m          disproving conjectures  in kapur  d   ed      th conference on
automated deduction  pp           springer verlag  lecture notes in computer
science no      
thomas  m     jantke  k          inductive inference for solving divergence in knuthbendix completion  in proceedings of international workshop aii     pp          
thomas  m     watson  p          solving divergence in knuth bendix completion by
enriching signatures  theoretical computer science               
walsh  t          a divergence critic  in bundy  a   ed      th conference on automated
deduction  pp         springer verlag  lecture notes in artificial intelligence no 
    
walsh  t   nunes  a     bundy  a          the use of proof plans to sum series  in kapur 
d   ed      th conference on automated deduction  pp           springer verlag 
lecture notes in computer science no       also available from edinburgh as dai
research paper     
yoshida  t   bundy  a   green  i   walsh  t     basin  d          coloured rippling  the
extension of a theorem proving heuristic  in cohn  a   ed    proceedings of ecai    
pp         john wiley  also available from edinburgh as dai research paper     

   

fiwalsh
of the way  there are other types of divergence which could perhaps be recognized by the
divergence critic  further research is needed to identify such divergence patterns  isolate
their causes and propose ways of fixing them  this research may take advantage of the close
links between divergence patterns and particular types of generalization  for instance  it
may be possible to identify specific divergence patterns with the need to generalize common
subterms in the theorem being proved 

acknowledgements

this research was supported by a human capital and mobility postdoctoral fellowship 
i wish to thank  adel bouhoula and michael rusinowitch for their invaluable assistance
with spike  pierre lescanne for inviting me to visit nancy where most of this research
was performed  david basin  alan bundy  miki hermann  andrew ireland  and michael
rusinowitch for their comments and questions  the reviewers for their comments and suggestions  the members of the eureca and protheo groups at inria  and the members of
the dream group at edinburgh and the mrg groups in trento and genova 

references

aubin  r          mechanizing structural induction  ph d  thesis  university of edinburgh 
basin  d     walsh  t          difference matching  in kapur  d   ed      th conference
on automated deduction  pp           springer verlag  lecture notes in computer
science no       also available from edinburgh as dai research paper     
basin  d     walsh  t          difference unification  in proceedings of the   th ijcai 
international joint conference on artificial intelligence  also available as technical
report mpi i         max planck institute fur informatik 
basin  d     walsh  t          termination orderings for rippling  in bundy  a   ed      th
conference on automated deduction  pp           springer verlag  lecture notes in
artificial intelligence no      
bouhoula  a   kounalis  e     rusinowitch  m          spike  a theorem prover  in
proceedings of lpar     lecture notes in artificial intelligence      springer verlag 
bouhoula  a     rusinowitch  m       a   implicit induction in conditional theories  journal of automated reasoning                  
bouhoula  a     rusinowitch  m       b   spike user manual   inria lorraine and
crin      rue du jardin botanique  villers les nancy  france  available from
ftp   ftp loria fr pub loria protheo softwares spike  
boyer  r     moore  j          a computational logic  academic press  acm monograph
series 
bundy  a   stevens  a   van harmelen  f   ireland  a     smaill  a          rippling 
a heuristic for guiding inductive proofs  artificial intelligence               also
available from edinburgh as dai research paper no      
   

fia divergence critic
rev qrev x  nil     x
rev qrev x  cons y  nil       cons y  x 
rev qrev x  cons z  cons y  nil        cons z  cons y  x  
  
 

this annotated sequence is the unique maximal difference match  these annotations suggest
the need for the wave rule 
rev qrev x  cons y  nil       cons y  rev qrev x  nil     

this rule allows the proof to go through without divergence  by comparison  most specific
generalization seems to be unable to identify this rule  the most specific generalization of
the left hand side of this sequence gives the term rev qrev x  z    or  ignoring the first term
in the sequence  rev qrev x  cons y  z      most specific generalization cannot  however 
identify the more useful pattern  rev qrev x  cons y  nil    
nqthm contains a simple test for divergence based on subsumption  for instance  on
example    of the last section  nqthm is unable to simplify the following subgoal in the
step case of the proof 
 equal  rot  length x   append x  list z   
 cons z  rot  length x  x    

note that this is the lemma speculated by the divergence critic  nqthm generalizes  length
x  in this subgoal giving the false conjecture 
 equal  rot y  append x  list z   
 cons z  rot y x    

after several more attempts at induction and generalization  nqthm realizes the proof is
diverging since a subgoal is subsumed by its parent  as the proof is therefore about to loop 
nqthm gives up  no attempt is made to analyse the failed proof attempt to identify where
it started to go wrong  in addition  subsumption is a very weak test for divergence  much
weaker than tests based on difference matching or generalization  this subsumption test
recognizes divergence on just a small number of the failed examples in the last section 

    conclusions

i have described a divergence critic  a computer program which attempts to identify diverging proof attempts and to propose lemmas and generalizations which overcome the
divergence  the divergence critic has proved very successful  it enables the system spike
to prove many theorems from the definitions alone  the divergence critic s success can
be largely attributed to the power of the rippling heuristic  this heuristic was originally
developed for proofs using explicit induction but has since found several other applications 
difference matching is used to identify accumulating term structure which is causing divergence  lemmas and generalizations are then proposed to ripple this term structure out
   

fiwalsh
divergence critic described here works in an implicit  and not an explicit  induction setting 
second  the divergence critic is not automatically invoked but must identify when the proof
is failing  third  the divergence critic is less specialized  these last two differences reect the
fact that critics in clam are usually associated with the failure of a particular precondition
to a heuristic  the same divergence pattern can  by comparison  arise for many different
reasons  the need to generalize variables apart  to generalize common subterms  to add a
lemma  etc  fourth  the divergence critic must use difference matching to annotate terms  in
clam  terms are usually already appropriately annotated  finally  the divergence critic is
less tightly coupled to the the theorem prover s inference rules or heuristics  the critic can
therefore exploit the strengths of the prover without needing to reason about the complex
rules or heuristics being used  for instance  the divergence critic has no diculty identifying
divergence in complex situations like nested or mutual inductions  the critic also benefits
from the powerful simplification rules used by spike 
divergence has been studied quite extensively in completion procedures  two of the
main novelties of the critic described here are the use of difference matching to identify
divergence  and the use of rippling in the speculation of lemmas to overcome divergence 
dershowitz and pinchover  by comparison  use most specific generalization to identify divergence patterns in the critical pairs produced by completion  dershowitz   pinchover        
kirchner uses generalization modulo an equivalence relation to recognise such divergence
patterns  kirchner         meta rules are then synthesized to describe infinite families of
rules with some common structure  thomas and jantke use generalization and inductive
inference to recognize divergence patterns and to replace infinite sequences of critical pairs
by a finite number of generalizations  thomas   jantke         thomas and watson use
generalization to replace an infinite set of rules by a finite complete set with an enriched
signature  thomas   watson        
generalization modulo an equivalence enables complex divergence patters to be identified  however  it is in general undecidable  most specific generalization  by comparison  is
more limited  it cannot recognize divergence patterns which give nested wave fronts like 

s  s x    x   
in addition  most specific generalization cannot identify term structure in wave holes  for
example  consider the divergence sequence of equations produced when spike attempts to
prove example    from section   
rev qrev x  nil     x
rev qrev x  cons y  nil      cons y  x 
rev qrev x  cons z  cons y  nil       cons z  cons y  x  
  
 

divergence analysis identifies term structure accumulating within the accumulator argument
of qrev  
   

fia divergence critic
unfortunately the heuristics for instantiating the right hand side of speculated lemmas are
not strong enough to suggest the rule 

x    y   z     y    x   z  
with this rule  spike finds a proof of the commutativity of multiplication without diculty 
the diculties in speculating this rule arise because the wave front is stuck in a similar
position on both sides of the equality  there are few clues therefore to suggest how to ripple
it up to the top of the term tree 
in example     the divergence critic proposes a lemma where one is not needed  spike
is able to find a proof of this theorem from the definitions alone using    inductions  three
of these inductions are on the equations 
  x   x
s      x   s x 
s s       x   s s x  
this sequence of equations satisfies the divergence critic s preconditions  the critic therefore
proposes wave rules for moving accumulating successor functions off the first argument
position of    although the proposed lemmas are not necessary  either give a much shorter
and simpler proof needing just   inductions 
example    is the lemma speculated in example     divergence analysis of spike s
attempt to prove this theorem identifies term structure accumulating on the second  alias
accumulator  argument of qrev   the first two lemmas proposed for removing this term
structure are of no use as they are subsumed by the recursive definition of qrev   the third
lemma also fails to prevent divergence  this lemma simplifies two element lists in the second
argument position of qrev   however  divergence will still occur as the prover cannot simplify
lists that occur in the second argument position of qrev which contain   or more elements 
divergence can be overcome if we introduce a derived function for appending onto the end
of a list  this can be used to simplify terms in which a list of arbitrary size occurs on the
second argument position of qrev   for example  we can simplify with the rule 

qrev x  y     app qrev x  nil   y  
unfortunately  append does not occur in the specification of the theorem so it is dicult to
find a heuristic that would speculate such a rule 

   related work

critics for monitoring the construction of proofs were first proposed by ireland for the clam
prover  ireland         in this framework  failure of one of the proof methods automatically
invokes a critic  various critics for explicit induction have been developed that speculate
missing lemmas  perform generalizations  look for suitable case splits  etc  as rippling plays
a central role in clam s proof methods  many of the heuristics are similar to those described
here  ireland   bundy         there are  however  several significant differences  first  the
   

fiwalsh
no
theorem
  
s x   y y  x  y 
  
x  y y  x
   x  y  z  v w      w  x  y  z v   

lemmas speculated
time s
 
n a
s x  y x s y 
   
s x  y s x y 
    
s x  y x s y 
   qrev qrev x  y   z  y   qrev qrev x     z 
qrev y x   z     qrev x   y z 
   
qrev qrev x y   z  w  qrev qrev y   x z  w 
qrev qrev x y    z   w  z  qrev qrev x  y   w 

table    some of the divergence critic s failures 
diverges  generating the following sequence of equations 
s y     x    x  y     s y     y    x  y  
s s y      x    x    x  y      s x     s y     x    x  y  
s s s y       x    x    x    x  y       s x     s s y      x    x    x  y    
  
 
divergence analysis of the left hand sides of these equations suggests the need for a rule of
the form 

s y      x   z     f  y   z  
unfortunately the heuristics for lemma speculation are not suciently strong to suggest
a suitable instantiation for f  for example  z   s x   z     this lemma is rather complex
and is the result of two overlapping divergence patterns  if the annotations are considered
separately  they suggest the rules 

s x     y   s x   y  
y    x   z     x    y   z  
with these two rules  spike finds a proof without diculty 
example    is the commutativity of multiplication  the divergence critic identifies a
divergence pattern and proposes the transverse wave rule 

s x     y   x   s y  
however  spike is unable to prove the commutativity of multiplication with the addition of
this rule  the proof attempt is now somewhat simpler and contains the diverging sequence
of equations 
x    y    x    x  y      y    x    x    x  y   
x    y    x    x    x  y        y    x    x    x    x  y    

x    y    x    x    x    x  y         y    x    x    x    x    x  y     
  
 

   

fia divergence critic
speculate more non theorems  further research into the optimal strength of generalization
heuristics would be valuable 
example    is the only disappointment  the lemma proposed fixes divergence but is
too dicult to be proved automatically  even with the assistance of the divergence critic 
see example    at the end of this section for more details  example    is discussed in
more detail in the related work in section   as it demonstrates the superiority of difference
matching over generalization techniques for divergence analysis  examples    to    require
little discussion  finally  examples    and    demonstrate that the critic can cope with
divergence in moderately complex theories containing conditional equations 
the results are very pleasing  using the divergence critic  the    theorems listed  with
the exception of     can all be proved from the definitions alone  to provide an indication
of the diculty of these theorems  the nqthm system  boyer   moore         which is
perhaps the best known explicit induction theorem prover  was unable to prove more than
half these theorems from the definitions alone  to be precise  nqthm failed on               
                                                   and     of course  with the addition of some
simple lemmas  nqthm is able to prove all these theorems  indeed  in many cases  nqthm
needs the same lemmas as those proposed by the divergence critic and required by spike 
this suggests that the divergence critic is not especially tied to the particular prover used
nor even to the implicit induction setting 
to test this hypothesis  i presented the output of a diverging proof attempt from nqthm
to the critic  i chose the commutativity of multiplication as this is perhaps the simplest
theorem which causes nqthm to diverge  the critic proposed the lemma 
 equal  times y  add  x    plus y  times y x    

where times and plus are primitives of nqthm s logic recursively defined on their first
arguments  this is exactly the lemma needed by nqthm to prove the commutativity of
multiplication  nqthm fails on many of the other examples for similar reasons to spike 
and divergence analysis identifies an appropriate lemma  this supports the suggestion that
the divergence critic is likely to be useful for a wide variety of provers 
the divergence critic has several limitations  recognizing divergence is  in general 
undecidable since it reduces to the halting problem  the divergence critic will therefore
sometimes fail to identify a diverging proof attempt  in addition  the critic will sometimes
identify a  divergence  pattern when the proof attempt is not diverging  even when divergence is correctly identified  the critic will sometimes fail to speculate an appropriate
lemma  finally  the critic only speculates wave rules  whilst many theories contain a large
number of wave rules  and these are often very useful for fixing divergence  other types of
lemma can be needed 
table   lists four theorems on which the divergence critic fails  these problems are
representative of the different ways in which the critic can fail  the two main cause of
failure are overlapping divergence patterns  and the inability of the heuristics to speculate
an appropriate right hand side for a lemma  again times are those to speculate lemmas
and not to find a proof of the theorem 
example    is a commuted version of the recursive definition of multiplication   is
defined recursively on its second argument position   spike s attempt to prove this theorem
   

fiwalsh
just as in examples   and    these are not the optimal rules for fixing divergence  nevertheless  either of the proposed rules fix divergence and both can be proved without diculty
by spike  example   is very similar to example   
examples    to    require little comment  in example     the proposed lemma is too
dicult to be proved automatically  however  the divergence critic is able to identify the
cause of this diculty and propose a lemma which allows the proof to go through  example
     in example     the speculated lemma is not optimal  the simpler lemma speculated in
example    would be adequate to prove this theorem without divergence  the speculated
lemma is not optimal because the divergence critic attempts to ripple the accumulating
term structure over two functors  len and rot to the top of the term tree  however  it is
sucient on this problem to ripple it up over just one functor  rot 
examples    to    are straightforward and do not require discussion  in example     the
critic identifies two separate divergence patterns  to overcome divergence  the first lemma
plus one or other of the second and third are therefore needed  the first divergence pattern
occurs in the sequence of subgoals 

len rev x         len x 
len  app rev x   cons y  nil       s     len x  
len  app app rev x   cons y  nil    cons z  nil       s s     len x   
  
 

term structure is accumulating on the second argument of append  such term structure is
removed by the first rule 

len  app x  cons y  nil       s len x   
the second divergence pattern occurs in the sequence of subgoals 

s x    len y    s x   len y  
s s x     len y    s s x   len y   
s s s x      len y    s s s x   len y    
  
 

term structure is accumulating on the first argument of    this is removed by one or other
of the second and third rules 

s x     y   s x   y  
s x     y   x   s y  
examples    and    are reasonably straightforward  the lemma speculated in example
   is a special case of the associativity of append  more powerful generalization heuristics
could have speculated the associativity of append  however  such heuristics would also
   

fia divergence critic
causes divergence in the current release  the speculated lemmas do  however  simplify the
proof  example   was used in the text to illustrate the generalization heuristics  the second
lemma in example   is perhaps a little surprising 

len app x   cons w  cons z  y          s len app x  cons w  y       
although it is more complex than the first lemma  it is nearly as good at fixing divergence 
in example    the lemma proposed 

even  s s x      y     even x   y  
is not optimal  that is  it is not the simplest possible lemma that fixes divergence  to fix
divergence  we merely need one of the rules  s x     y   s x   y   or s x     y   x  
s y    either of these will ripple the successor functions accumulating on the first argument
position of    the divergence critic attempts to construct a lemma to ripple two successor
functions across from the first to the second argument positions of    unfortunately  the
critic fails to find an appropriate instantiation for the right hand side of such a lemma  the
critic instead proposes a rule to move the two successor functions up to the top of the term
where the wave front can peter out  example   is very similar to example   
examples   to    demonstrate that the critic can cope with divergence in theories involving mutual recursion  in example    spike attempts to prove by induction the equations 

evenm x   x 
oddm s x    x 
evenm  s s x     x 
oddm s s s x      x 
evenm  s s s s x       x 

 
 
 
 
 
  
 

true
true
true
true
true

the critic identifies two inter linking divergence patterns 

evenm  x   x    true
evenm   s s x     x    true
evenm   s s s s x       x    true

oddm s x    x    true
oddm  s s s x      x    true
oddm  s s s s s x        x    true

  
 

  
 

the critic therefore proposes rules which ripple this accumulating term structure up to the
top of the term where it peters out 

evenm  s s x      y     evenm  x   y  
oddm  s s x      y     oddm x   y  
   

fiwalsh
no
 

theorem
s x  x s x x 

lemmas speculated
time s
s x  y s x y 
   
s x  y x s y 
 
dbl x  x x  
s x  y s x y 
   
dbl       dbl s x   s s dbl x   
s x  y x s y 
 
len x   y  len y   x 
len x    z   y   s len x   y  
   
len x    z   y   len  w   x    y 
 
len x   y  len x  len y 
s x  y s x y 
   
s x  y x s y 
 
len x   x  dbl len x  
len x    z   y   s len x   y  
    
len x    w   z   y   s len x    w   y   
 
even x x 
even s s x   y  even x y 
   
 
odd s x  x 
odd s s x   y  odd x y 
    
 
evenm  x x 
evenm  s s x   y  evenm  x y 
    
oddm  s s x   y  oddm  x y 
 
oddm  s x  x 
evenm  s s x   y  evenm  x y 
    
oddm  s s x   y  oddm  x y 
  
evenm  x    half x  half x  x
s x  y s x y 
   
s x  y x s y 
  
half x x  x
s s x   y x s s y  
    
half s s x   y  half x y 
  
half s x  x  x
s s x   y x s s y  
    
half s s x   y  half x y 
  
rot len x  x  x
rot len x  x    y   y  rot len x  x 
   
  
len rot len x  x   len x 
len rot x z    y    s len rot x z   
   
  
rot len x  x    y   y   rot len x  x 
 x    y    z x    y   z 
    
rot len x   x    y    z  y   rot len x  x   z 
  
len rev x   len x 
len x    y   s len x  
   
  
rev rev x   x
rev x    y   y  rev x 
   
  
rev rev x     y   y   x
rev x    y   y  rev x 
    
  
rev rev x     y   y   rev rev x  
rev x    y   y  rev x 
    
  
len rev x   y   len x  len y 
len x    y   s len x  
    
s x  y s x y 
s x  y x s y 
  
len qrev x      len x 
len qrev x z   y   s len qrev x y   
   
  
qrev x y  rev x    y
 x    y    z x    y   z 
   
  
len qrev x y   len x  len y 
s x  y s x y 
    
s x  y x s y 
  
qrev qrev x         x
qrev qrev x  y   z  y   qrev qrev x     z 
   
  
rev qrev x      x
rev qrev x  y    y   rev qrev x     
   
  
qrev rev x      x
qrev x    y  z  y  qrev x z 
   
  
nth i nth j x   nth j nth i x  
nth s i  nth j y   x   nth i nth j x  
   
   nth i nth j nth k x    nth k nth j nth i x   
nth s i  nth j y   x   nth i nth j x  
   
  
len isort x   len x 
len insert y x   s len x  
   
  
sorted isort x  
sorted insert y x   sorted x 
   
sorted insert y insert z x    sorted x 

table    some lemmas speculated by the divergence critic 
notes     is written for infix cons    for infix append     for nil  and  x  for cons x nil   in
addition  even is defined by a s s x   recursion  evenm by a mutual recursion with oddm  
and rot n  l  rotates a list l by n elements 
   

fia divergence critic
the critic is successful at identifying divergence and proposing appropriate lemmas and
generalizations for a significant number of theorems  divergence analysis is very quick on
most examples  the divergence pattern is recognized usually in less than a second  most
of the time is spent looking for generalizations and refuting over generalizations with the
conjecture disprover  this usually takes between   and     seconds  additional heuristics
for preventing over generalization and a more ecient implementation of the conjecture
disprover would speed up the critic considerably 

   results

table   lists    theorems that cause spike to diverge and the lemmas speculated by the
divergence critic after analysing the diverging proof attempts  these problems provide a
representative sample of the type of theorems for which the cause of divergence can be
identified and an appropriate lemma or generalization speculated  many of these problems
come from the clam library corpus  part of this table has appeared before  walsh        
times are for the divergence critic to speculate the lemmas and are for the average of   
runs on a sun   running quintus       
spike s proof attempt diverges on each example when given the definitions alone  in
each of the    cases  the critic is quickly able to suggest a lemma which overcomes divergence 
when multiple lemmas are proposed  with the exception of     any one on its own is
sucient to fix divergence  in every case  except    and     the lemmas proposed are
suciently simple to be proved automatically without introducing fresh divergence  in the
majority of cases  the lemmas proposed are optimal  that is  they are the simplest possible
lemmas which fix divergence  in the cases when the lemma is not optimal  they are usually
only slightly more complex than the simplest lemma which fixes divergence  in many of the
examples  other lemmas are conjectured by the divergence analysis but these are quickly
rejected by the conjecture disprover  for example  in example     divergence analysis and
the petering out heuristic suggest the rule 
   len  app x  cons y  nil       len x     
however  this is refuted by exhaustive normalization using any ground terms for x and y  
in this case  the cancellation heuristic identifies the required lemma 
len  app x  cons y  nil       s len x     
some of the examples deserve additional comment  in example    the divergence critic
identifies that successor functions are accumulating on the first argument position of   
the critic speculates a lemma for moving these successor functions either to the top of the
term  so that immediate cancellation can occur  or onto to the second argument position
 so that simplification with the recursive definition of   can occur   the first lemma
speculated is in fact a generalization of the theorem being proved  example   is a simple
program verification problem taken from dershowitz and pinchover         the forward
direction of this theorem was discussed in the introduction  similar divergence occurs as in
example   and  after generalization  the same lemmas are speculated 
example   caused divergence in the beta version of spike available in the summer of
      the proof rules in spike have since been strengthened and this example no longer
   

fiwalsh

  compiling file  home dream  tw work spike diverge data double x x
  data double x x compiled in module user        sec       bytes
     speculate 
equations input 
double x   x  x 
s x  x   s x   x 
s s x  x    s s x    x 
s s s x  x     s s s x     x 
lemmas speculated 
s x   x  s x  x  
s x   x   s x  x   
s x    x  s x   x  
s x    x    s x   x    
s x   x  x  s x  
s x   x   x  s x   
s x    x  x   s x  
s x    x    x   s x    
deleting lemmas subsumed 
s x   x   s x  x   
s x   x   x  s x   
merging remaining lemmas 
s x   x   s x  x   
s x   x   x  s x   
yes
    

figure    example output of the divergence critic 
figure   gives the divergence critic s output on the problem discussed in the introduction 
either of the proposed lemmas when used as a rewrite rule is adequate to fix divergence  in
addition  the proposed lemmas are suciently simple to be proved automatically without
introducing fresh divergence  the first lemma is a rewrite rule for moving accumulating
successor functions from the first argument position of   to the top of the term tree  the
second lemma is a transverse wave rule discussed in section   for moving accumulating
successor functions from the first argument position of   to the second argument position 
   

fia divergence critic

preconditions 
   there is a sequence of equations si   ti which the
prover attempts to prove by induction  i             
   there exists  non trivial  g  h such that for each j  
the maximal difference match has sj   g uj   acc  and
sj     g  h  uj     acc  
postconditions 
   the critic proposes a rule of the form 

g  h  u     acc    g u   f  acc   
   f is instantiated by the fertilization or simplification
heuristics 
   the lemma is generalized using the  augmented  primary terms and equality heuristics 
   generalized lemmas are filtered through a type checker
and a conjecture disprover 
   if several lemmas are suggested  the critic deletes any
that are subsumed 
figure    speculation of transverse wave rules 
annotations  we could also speculate hybrid wave rules which ripple part of the wave front
across and part of it up the term tree  however  such rules appear to be rare  in addition 
such hybrid wave rules can often be decomposed into a pair of wave rules  one of which
moves some of the wave fronts up the term tree  and another which moves the wave fronts
across 

   implementation

the divergence critic described in the previous sections has been implemented in prolog 
the system consists of     lines of code defining approximate     different prolog predicates  more recently a cut down version has been incorporated directly within the spike
system which is written in caml light  bouhoula   rusinowitch      b   the output
of spike is parsed to generate input to the critic  the input consists of  the equations
which the prover attempts to prove by induction  sort information  for the type checker
and difference matcher   the recursive argument positions  for constructing primary terms  
and the rewrite rules defining the theory  used by the conjecture disprover  
   

fiwalsh
this rule allows the proof to go through without divergence 
speculated transverse wave rules are generalized using the extended primary terms
heuristic described in section    the divergence critic also generalizes transverse wave
rules by means of an equality heuristic  this heuristic attempts to cancel equal outermost
functors where possible  for example  consider the theorem 

 x  y    x   y    x   y
where addition is defined recursively on its second argument position and subtraction is
defined by the rewrite rules 

x      x
  x    
s x    s y    x   y 
spike s attempt to prove this theorem diverges generating  amongst others  the goals 

 x   y     x   y
 s x    y     x   s y  
 s s x     y     x   s s y   
  
 
divergence analysis identifies accumulating term structure within these equations 
 x   y     x   y
  s x    y     x   s y 
  s s x     y     x   s s y   
  
 
this is the unique maximal difference match  these annotations suggest the need for the
transverse rule 
  s x     y     x    x   s y       x 
the equality heuristic deletes the equal outermost function  z   z   x   this gives the more
general lemma 
s x     y   x   s y    
all speculated lemmas are filtered through a type checker to ensure that their erasure
is well typed  speculated lemmas are also filtered through a conjecture disprover to guard
against over generalization 
the actions of the critic are summarized in figure    the specification of preconditions
and postconditions again uses second order variables but in a limited manner  the implementation merely requires second order matching and first order difference matching  the
preconditions and postconditions can be easily generalised to include multiple and nested
   

fia divergence critic
qrev a  b    app rev a   b 
qrev a  cons c  b      app  app rev a   cons c  nil     b 
qrev a  cons c  cons d  b       app  app app rev a   cons c  nil    cons d  nil     b 
  
 

this is the unique maximal difference match  rather than move the accumulating term
structure on the right hand side of the equations to the top of the term  it is much simpler
to move the accumulating term structure from the first onto the second argument of the
outermost append  the critic therefore proposes a transverse wave rule  which preserves
the skeleton but moves the difference onto a different argument position  in this example 
this is a rule of the form 

app  app rev a   cons c  nil     b    app rev a   f  b    
in moving the difference onto another argument position  the difference may change syntactically  the right hand side of the lemma is therefore only partially determined  to
instantiate f   the critic uses two heuristics  fertilization and simplification 
the fertilization heuristic uses matching to find an instantiation for f which enables
immediate fertilization  in this case  matching against the universally quantified variable b
in the induction hypothesis suggests 

app  app rev a   cons c  nil     b    app rev a   cons c  b    
finally the critic generalizes the lemma using the same extended primary term heuristic as
before  i e   augmenting recursive positions with wave hole positions   this gives the rule 

app  app a  cons c  nil     b    app a  cons c  b    
this is exactly the rule needed by spike to complete the proof  in addition  it is simple
enough to be proved by itself without divergence  this is not true of the ungeneralized rule 
the other heuristic used to instantiate the right hand side of the speculated lemma is
the simplification heuristic  the heuristic uses regular matching to find an instantiation for
f which will enable the wave front to be simplified using one of the recursive definitions 
consider again the dbl theorem from the introduction  divergence analysis identifies successor functions accumulating on the first argument position of    this accumulating term
structure can either be moved to the top of the term tree or alternatively onto the second
argument position of   using a transverse wave rule of the form 

s x     y   x   f  y    
the right hand side of this transverse wave rule is instantiated by the simplification heuristic 
the wave front on the right hand side can be simplified by the rewrite rule recursively
defining   if f is instantiated by z   s z    that is  if we have the rule 

s x     y   x   s y    
   

fiwalsh
as f   s y g is a cover set for the natural numbers  these two rules can be merged to give 
sorted  insert y  x      sorted x  

   transverse wave rules
the lemmas speculated so far have moved accumulating term structure directly to the top
of the term where it is removed by cancellation or petering out  an alternative way of
removing accumulating term structure is to move it onto another argument position where 
either it can be removed by matching with a  sink   a universally quantified variable in
the induction hypothesis  or it can be moved upwards by rewriting with the recursive
definitions  annotated rewrite rules which preserve the skeleton and move wave fronts
across to other argument positions are called transverse wave rules  bundy et al         
theorems involving functions with accumulators provide a rich source of examples where
such rewrite rules prevent divergence 
consider  for example  a theorem about the correctness of tail recursive list reversal 

 a  b   qrev a  b    app rev a   b 
where both a and b are universally quantified  rev is naive list reversal using append  and
qrev is tail recursive list reversal building the reversed list on the second argument position 
these functions are defined by the rewrite rules 
rev nil 
rev cons h  t  
qrev nil  r 
qrev cons h  t   r 

 
 
 
 

nil
app rev t   cons h  nil  
r
qrev t  cons h  r   

spike s attempt to prove this theorem diverges generating the following sequence of equa 

tions which the prover attempts to show by induction 

qrev a  b    app rev a   b 
qrev a  cons c  b     app app rev a   cons c  nil    b 
qrev a  cons c  cons d  b      app app app rev a   cons c  nil    cons d  nil    b 
  
 

difference matching identifies the term structure accumulating within these equations that
is causing divergence 
   

fia divergence critic
s      len b    s len b  
s s       len b    s s len b   

  
 
difference matching identifies the term structure causing divergence 
    len b    len b 
s      len b    s len b  

s s       len b    s s len b   

  
 
this is the unique maximal difference match  these annotations suggest the need for the
wave rule 
s      len b    s     len b    
a set of candidate terms for generalization is constructed by computing the intersection of
the primary terms of the two sides of this rule  in this case  the primary terms of the left
hand side are the set fs      len b   len b   bg  and the primary terms of the right hand
side are the set fs     len b        len b   len b   bg  the intersection of the primary terms
is thus the set flen b   bg  the critic picks members of the intersection to generalize to new
variables  picking b justs gives an equivalent lemma up to renaming of variables  picking
len b  gives the generalization 
s      y   s     y   
the reason for considering just primary terms is that the recursive definitions typically
provide wave rules for removing term structure which accumulates at these positions  in
addition to primary terms  the divergence critic therefore also considers the positions of
the wave holes  but not wave fronts  in the skeleton of the lemma being speculated  the
motivation for this extension is that the speculated lemma will allow accumulating term
structure to be moved from the wave hole positions  such positions are therefore also candidates for generalization  positions of the wave fronts are not included since we want to
speculate a lemma that will move the term structure at such positions 
for instance  because of the wave hole on the first argument of   in the last example 
  is also included in the intersection set of candidate terms for generalization  picking   to
generalize gives 
s x    y   s x   y   
the speculated lemma is now as general as is possible  this rule allows the proof to go
through without divergence 
the critic also has a heuristic for merging speculated lemmas  for instance  with the
theorem sorted isort x    the critic speculates several rules including 
sorted  insert    x      sorted x 
sorted  insert s y   x      sorted x 
   

fiwalsh

   the critic proposes a rule of the form 

g  h  u       f  g u   
   f is instantiated by the cancellation or petering out
heuristics 
   lemmas are filtered through a type checker and a conjecture disprover 
   if several lemmas are suggested  the critic deletes any
that are subsumed 
figure    postconditions to the divergence critic

   generalization

a major cause of divergence is the need to generalize  most of the lemmas proposed
by the critic fix divergence  but attempting to prove the lemmas themselves can cause
fresh divergence  in addition  several speculated lemmas can sometimes be replaced by
a single generalization  generalized lemmas also can lead to shorter  more elegant and
natural proofs  the critic therefore attempts to generalize the lemma speculated  using the
conjecture disprover to guard against over generalization 
the main heuristic used for generalization is an extension of the primary term heuristic
 aubin         the primary terms are those terms encountered as a term is explored from
the root to the leaves ignoring non recursive argument positions to functions  the same
notion of recursive argument position is used by the critic as defined by bouhoula and
rusinowitch      a  and as used by spike for performing inductions 
consider  for example  the theorem 

 a  b   len a    len b    len app a  b  
where   is again defined recursively on its second argument  and len and app are defined
by means of the rewrite rules 
len nil 
len cons h  t  
app nil  t 
app cons h  t   r 

 
 
 
 

 
s len t  
t
cons h  app t  r   

this problem is taken from the clam library corpus  bundy et al          spike s attempt
to prove this theorem diverges  one of the sequences of equations generated is 
    len b    len b 
   

fia divergence critic
spike s diverging attempt to prove this theorem generates the equations 

nth s i   nth j  x     nth s j    nth i  x  
nth s s i    nth j  cons y  x      nth s j    nth i  x  
nth s s s i     nth j  cons z  cons y  x       nth s j    nth i  x  
  
 

divergence analysis identifies term structure accumulating in two different places 

nth s i   nth j  x     nth s j    nth i  x  
nth  s s i     nth j  cons y  x       nth s j    nth i  x  
nth  s s s i      nth j  cons z  cons y  x        nth s j    nth i  x  
  
 

this is the unique maximal difference match  this divergence pattern suggests the need for
a rewrite rule of the form 

nth  s i     nth j  cons y  x        f  nth i  nth j  x      
the petering out heuristic instantiates f to the identity function z   z giving the rule 

nth  s i     nth j  cons y  x       nth i  nth j  x    
this rule allows the proof to go through without divergence 
since the erasure of the wave rule must be properly typed  sort information can be used
to prune inappropriate instantiations for f   all speculated lemmas are therefore filtered
through a type checker  speculated lemmas are also filtered through a conjecture disprover 
when a conuent set of rewrite rules exists for ground terms  exhaustive normalization
of some representative set of ground instances of the equations is used to filter out nontheorems  alternatively  the prover itself could be used to filter out non theorems  unlike
many other induction theorem provers  spike can refute conjectures since its inference
rules are refutationally complete for conditional theories in which the axioms are ground
convergent and defined functions are completely defined over free constructors  bouhoula  
rusinowitch      a   other techniques for disproving conjectures are described by protzen
       
the critic s lemma speculation is summarized in figure    using the same variable
names as the preconditions   this specification again uses second order variables in a
limited manner  first order difference matching is merely required to construct lemmas 
as with the preconditions  the specification of the postconditions can be easily extended
to deal with multiple and nested wave fronts  as in the nth i  nth j  l     nth j  nth i  l  
example   since the rules proposed by the critic move the wave fronts to top of the term 
they usually only introduce fresh divergence in the rare cases that cancellation or fertilization
fails  this is unlikely since the cancellation and petering out heuristics attempt to ensure
precisely that cancellation or fertilization can take place 
   

fiwalsh
this divergence pattern suggests that f should be instantiated to z   s z  to enable immediate cancellation  thus  as required  the cancellation heuristic suggests the rule 
s x     y   s x   y    
the other heuristic used to instantiate the right hand side of speculated lemmas is
petering out  in moving the differences up to the top of the term  they may disappear
altogether  consider  for example  the theorem 
 l   sorted isort l     true
where isort is insertion sort and sorted is true iff a list is sorted into order  these are defined
by the conditional rewrite rules 
sorted nil    true
sorted cons x  nil     true
x   y   sorted cons x  cons y  z       sorted cons y  z   
isort nil    nil
isort cons x  y      insert x  isort y   
where insert x  z    which inserts the element x into the list z in order  and x   y are
defined by the rewrite rules 
    x   true
s x         false
s x     s y     x   y
insert x  nil    cons x  nil 
x   y   insert x  cons y  z      cons x  cons y  z   
  x   y     insert x  cons y  z      cons y  insert x  z   
divergence analysis of spike s attempt to prove this theorem suggests the need for a
rule of the form 
sorted  insert y  x      f  sorted x   
the petering out heuristic instantiates f to the identity function z   z  this gives the rule 
sorted  insert y  x      sorted x  
this rule allows the proof to go through without divergence 
as a more complex example  consider the theorem 
 i  j  l   nth i  nth j  l     nth j  nth i  l  
where nth is defined by the rewrite rules 
nth    l    l
nth n  nil    nil
nth s n    cons h  t      nth n  t   
   

fia divergence critic
nested annotations  this allows the critic to recognise multiple sources of divergence in the
same equation  techniques which identify accumulating term structure by most specific
generalization  dershowitz   pinchover        cannot cope with divergence patterns that
give rise to nested annotations  see section   for more details  
the specification of the preconditions has left the length of sequence undefined  if the
sequence is of length    then the critic is preemptive  that is  it will propose a lemma just
before another induction is attempted and divergence begins  such a short sequence risks
identifying divergence when none exists  on the other hand using a long sequence is expensive to test and allows the prover to waste time on diverging proof attempts  empirically 
a good compromise appears to be to look for sequences of length    this is both cheap
to test and reliable  to identify accumulating term structure  it appears to be sucient
to use ground difference matching with alpha conversion of variable names  there exists
a fast polynomial algorithm to perform such difference matching based upon the ground
difference matching algorithm using dynamic programming  basin   walsh         since
the skeleton must be well typed  along with the erasure   the algorithm is extended to use
sort information to prune potential difference matches 

   lemma speculation
one way of removing the accumulating and nested term structure is to propose a wave rule
which moves this difference to the top of the term leaving the skeleton unchanged  we hope
either that it will then cancel against wave fronts on the other side of the equality or that
it will disappear in the process of being moved  for the dbl theorem  after generalization
 which is discussed in the next section  the divergence pattern suggests a rule of the form 

s x     y   f  x   y  
where f is a second order variable which we need to instantiate  instantiating f is ultimately a dicult synthesis problem so we can only hope to have heuristics that will work
some of the time  two of the heuristics used by the divergence critic to instantiate f are
cancellation and petering out 
the cancellation heuristic uses difference matching to identify term structure accumulating on the opposite side of the sequence which would allow cancellation to occur  failing
that  the cancellation heuristic looks for suitable term structure to cancel against in a new
sequence  the original sequence is usually a divergence pattern of a step case  whilst the
new sequence is usually a divergence pattern of a base case   in the dbl example  successor
functions accumulate at the top of the left hand side of the diverging equations 

s x   x    s x    x
s s x   x     s s x     x
s s s x   x      s s s x      x
  
 

   

fiwalsh
the critic then attempts to find the accumulating and nested term structure in each
sequence which is causing divergence  in this case  successor functions are accumulating
on the first argument of    to identify this accumulating term structure  the critic uses
difference matching  difference matching successive equations gives the annotated sequence 

s x   x    s x    x
s s x   x     s s x     x
s s s x   x      s s s x      x
  
 

this is the unique maximal difference match 
the critic then tries to speculate a lemma which can be used as a rewrite rule to move
the accumulating and nested term structure out of the way  in this case  the critic speculates
a rule for moving a successor function off the first argument of    that is  the rule 

s x     y   s x   y    
with this rule  spike is able to prove the dbl theorem without divergence  in addition  this
rule is suciently simple that it can be proved without assistance  the heuristics used by
the critic to perform this lemma speculation are described in more detail in the next two
sections 
the divergence analysis performed by the critic is summarised in figure    in analysing
   there is a sequence of equations si   ti which the
prover attempts to prove by induction  i             
   there exists  non trivial  g  h such that for each j   the
maximal difference match has sj   g uj    and sj     
g  h  uj     
figure    preconditions to the divergence critic
the divergence  we consider all the equations which the prover attempts to prove by induction  this includes those equation where the induction proof succeeds as these can often
suggest useful patterns  by  non trivial  i wish to exclude z   z  the identity substitution  h is thus the accumulating and nested term structure that appears to be causing
divergence  for the dbl example  h is z   s z   g is z   z   x  and u  is s x   although
g and h are second order variables  the second order nature of the divergence analysis
is limited  indeed  the implementation of the critic merely requires first order difference
matching which is polynomial  for simplicity  the preconditions ignore the orientation of
equations  in addition  the preconditions can be easily generalised to include multiple and
   

fia divergence critic
rippling has several desirable properties  it is highly goal directed  manipulating just
the differences between the induction hypothesis and the induction conclusion  as the
annotations restrict the application of the rewrite rules  rippling also involves little or no
search  difference matching and rippling have proved useful in domains outside of explicit
induction  for example  they have been used to sum series  walsh  nunes    bundy       
and to prove limit theorems  yoshida  bundy  green  walsh    basin         in the rest
of the paper  i show that difference matching and rippling are also useful in identifying
and correcting divergence in a prover that neither uses explicit rules of induction nor uses
annotations to control rewriting 

   divergence analysis

the initial problem is recognizing when the proof is diverging  various properties of rewrite
rules have been identified which cause divergence like  for example  forwards and backwards
crossed systems  hermann         however  these properties fail to capture all diverging
rewrite systems since the problem is  in general  undecidable  the divergence critic instead
studies the proof attempt looking for patterns of divergence  no attempt is made to analyse
the rewrite rules themselves for structures which give rise to divergence  the advantage of
this approach is that the critic need not know the details of the rewrite rules applied  nor the
type of induction being performed  nor the control structure used by the prover  the critic
can thus recognise divergence patterns arising from complex mutual or multiple inductions
with little more diculty than divergence patterns arising from simple straightforward
inductions  the disadvantage of this approach is that the critic can identify a  divergence 
pattern when none exists  fortunately  such cases appear to be rare  and even when they
occur  the critic usually suggests a lemma or generalization which gives a shorter and more
elegant proof  see section   for an example  
to illustrate the ideas behind the critic s divergence analysis  consider again the theorem
from the introduction 
 n   dbl n    n   n 
the divergence critic first partitions the sequence of equations which the prover attempts to
prove by induction  this is necessary since several diverging sequences may be interleaved
in the prover s output  several heuristics can be used to reduce the number of partitions
considered  the most useful heuristic is parentage in which the sequence is partitioned
so that each equation is derived from the previous one  that is  the equations lie on a
single branch of the proof tree  in particular  the base case and step case of an induction
are partitioned into different sequences  other heuristics which can be used include  the
function and constant symbols which occur in one equation occur in the next equation
in the partition  and the weights of the equations in a partition form a simple arithmetic
progression  in this case  there is just a single open branch in the proof tree 
s x   x    s x    x
s s x   x     s s x     x
s s s x   x      s s s x      x
  
 
   

fiwalsh
annotated term r  difference matching is not unitary  that is  two terms can have more
than one difference match  for example  both s s x   and s  s x    are difference matches
of s s x   with s x   the number of difference matches can be reduced if we compute just
the maximal difference match in which wave fronts are as high as possible in the term tree 
a formal definition of such a well founded ordering on annotated terms has been given by
basin and walsh        
the aim of rippling is to rewrite the annotated induction conclusion so that the skeleton 
the induction hypothesis  is preserved and the differences  the wave fronts are moved to
harmless places  for example  to the top of the term   if this rewriting succeeds  we will
then be able to appeal to the induction hypothesis  to rewrite the annotated induction
conclusion  we use the following annotated rewrite rules  or wave rules 

dbl  s x       s s dbl x    
x   s y     s x   y  
s x     y   s x   y  

   
   
   

the first two of these annotated rewrite rules are derived from the recursive definitions of dbl
and   whilst the second is derived from the lemma proposed at the end of the introduction 
each of these annotated rewrite rules preserves the skeleton of the term being rewritten 
and moves the wave fronts higher up the term tree  wave rules guarantee this  a wave rule
is an annotated rewrite rule with an identical skeleton on left and right hand sides that
moves wave fronts in a well founded direction like  for instance  to the top of the term tree
 basin   walsh        
rippling on the left hand side of the annotated induction conclusion using     yields 

s s dbl x      s x    s x   
then rippling on the right hand side with     gives 

s s dbl x      s  s x    x   
finally rippling with     on the right hand side yields 

s s dbl x      s s x   x    
as the wave fronts are at the top of each term  we have successfully rippled both sides of
the equality  we can now appeal to the induction hypothesis on the left hand side giving 

s s x   x     s s x   x    
this is a simple identity and the proof is complete  note that to complete the proof  we
needed to rewrite with a lemma       the aim of the divergence critic described in this
paper is to propose such lemmas 
   

fia divergence critic
in section    i describe difference matching and rippling  the two key ideas at the heart
of the divergence critic  i then outline how difference matching identifies the accumulating
term structure which is causing divergence  section     in section   and    i show how
lemmas are speculated which  ripple  this term structure out of the way  in section   
i describe the heuristics used in generalizing these lemmas  finally  implementation and
results are described in sections   and   

   difference matching and rippling

rippling is a powerful heuristic developed at edinburgh for proving theorems involving
explicit induction  bundy  stevens  van harmelen  ireland    smaill        and is implemented in the clam theorem prover  bundy  van harmelen  horn    smaill         in the
step case of an inductive proof  the induction conclusion typically differs from the induction
hypothesis by the addition of some constructors or destructors  rippling uses annotations
to mark these differences and applies annotated rewrite rules to remove them 
as a simple example  consider again the theorem discussed in the introduction  in the
step case  the induction hypothesis is 

dbl x    x   x
and the induction conclusion is 

dbl s x     s x    s x  
if we  difference match  the induction conclusion against the induction hypothesis  basin
  walsh         we obtain the following annotated induction conclusion 

dbl  s x      s x    s x   
an annotation consists of a wave front  a box with a wave hole  an underlined term  wavefronts are always one functor thick  basin   walsh         that is  every wave front has
one immediate subterm that is annotated with a wave hole  to make presentation simpler 
we display adjacent wave fronts merged  thus  s s x   is just syntactic sugar for the
annotated term  s  s x      wave fronts can also include up and down arrows to indicate
whether they are moving towards the top of the term tree or down towards the leaves  this
extension can  however  be safely ignored here 
the skeleton of an annotated term is formed by deleting everything that appears in
the wave front but not in the wave hole  the erasure of an annotated terms is formed by
deleting the annotations but not the terms they contain  in this case  the skeleton of the
annotated induction conclusion is identical to the induction hypothesis  and the erasure
of the annotated induction conclusion is the unannotated induction conclusion  difference
matching guarantees this  that is  difference matching the induction conclusion with the
induction hypothesis annotates the induction conclusion so that its skeleton matches the
induction hypothesis 
formally  r is a difference match of s with t with substitution  iff   skeleton r     t
and erase r    s where skeleton r  and erase r  build the skeleton and erasure of the
   

fiwalsh
both alpha convert variable names where necessary  rewriting the induction conclusion
with the recursive definitions of dbl and   gives 

s s dbl x      s s x    x  
the outermost successor functions on either side of the equality are now cancelled 

s dbl x     s x    x 
the prover then fertilizes with the induction hypothesis on the left hand side 

s x   x    s x    x 
this equation cannot be simplified further so another induction is performed  unfortunately 
this generates the diverging sequence of subgoals 

s x   x 
s s x   x  
s s s x   x   
s s s s x   x    
s s s s s x   x     

 
 
 
 
 
  
 

s x    x
s s x     x
s s s x      x
s s s s x       x
s s s s s x        x

the problem is that the prover repeatedly tries an induction on x but is unable to simplify
the successor functions that this introduces on the first argument position of    the proof
will go through without divergence if we have the rewrite rule 

s x     y   s x   y   
this rule  ripples  accumulating successor functions off the first argument position of   
this rewrite rule is derived from the lemma 

 x  y   s x    y   s x   y  
this is the commuted version of the recursive definition of addition and is  coincidently  a
generalization of the first subgoal  this lemma can be proved without divergence as the
induction variable  y occurs just in the second argument position of   
in this paper i describe a simple  divergence critic   a computer program which attempts
to automate this process  the divergence critic identifies when a proof attempt is diverging
by means of a  difference matching  procedure  the critic then proposes lemmas and
generalizations which hopefully allow the proof to go through without divergence  although
the critic is designed to work with the prover spike  it should also work with other induction
provers  walsh         spike is a rewrite based theorem prover for first order conditional
theories  it contains powerful rules for case analysis  simplification and implicit induction
using the notion of a test set  unfortunately  as is the case with other inductive theorem
provers  its attempts to prove many theorems diverge without an appropriate generalization
or the addition of a suitable lemma 
   

fijournal of artificial intelligence research                 

submitted       published     

a divergence critic for inductive proof
toby itc it

toby walsh

irst  location pante di povo
i      trento  italy

abstract

inductive theorem provers often diverge  this paper describes a simple critic  a computer program which monitors the construction of inductive proofs attempting to identify
diverging proof attempts  divergence is recognized by means of a  difference matching 
procedure  the critic then proposes lemmas and generalizations which  ripple  these differences away so that the proof can go through without divergence  the critic enables the
theorem prover spike to prove many theorems completely automatically from the definitions alone 

   introduction

two key problems in inductive theorem proving are proposing lemmas and generalizations 
a prover s divergence often suggests to the user an appropriate lemma or generalization
that will enable the proof to go through without divergence  as a simple example  consider
the theorem 

 n   dbl n    n   n 
this is part of a simple program verification problem  dershowitz   pinchover        
addition and doubling are defined recursively by means of the rewrite rules 

x     x
x   s y     s x   y  
dbl       
dbl s x      s s dbl x    
where s x   represents the successor of x  that is  x       i have adopted the prolog
convention of writing meta variables like x and y in upper case 

the theorem prover spike  bouhoula  kounalis    rusinowitch        fails to prove
this theorem  the proof attempt begins with a simple one step induction on x  the base
case is trivial  in the step case  the induction hypothesis is 
dbl x    x   x
and the induction conclusion is 

dbl s x     s x    s x  
to ease presentation  variables in this paper are  as here  sometimes renamed from those
introduced by spike  this has no effect on the results as the prover and divergence critic

c      ai access foundation and morgan kaufmann publishers  all rights reserved 

fi