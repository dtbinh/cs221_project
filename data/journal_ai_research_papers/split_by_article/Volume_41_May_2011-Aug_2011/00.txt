Journal of Artificial Intelligence Research 41 (2011) 1-24

Submitted 10/2010; published 05/2011

Properties of Bethe Free Energies and Message Passing
in Gaussian Models
Botond Cseke
Tom Heskes

b.cseke@science.ru.nl
t.heskes@science.ru.nl

Institute for Computing and Information Sciences
Faculty of Science, Radboud University Nijmegen
Heyendaalseweg 135, 6525 AJ, The Netherlands

Abstract
We address the problem of computing approximate marginals in Gaussian probabilistic
models by using mean field and fractional Bethe approximations. We define the Gaussian fractional Bethe free energy in terms of the moment parameters of the approximate
marginals, derive a lower and an upper bound on the fractional Bethe free energy and
establish a necessary condition for the lower bound to be bounded from below. It turns out
that the condition is identical to the pairwise normalizability condition, which is known to
be a sufficient condition for the convergence of the message passing algorithm. We show
that stable fixed points of the Gaussian message passing algorithm are local minima of
the Gaussian Bethe free energy. By a counterexample, we disprove the conjecture stating
that the unboundedness of the free energy implies the divergence of the message passing
algorithm.

1. Introduction
One of the major tasks of probabilistic inference is calculating marginal posterior probabilities of a set of variables given some observations. In case of Gaussian models, the
computational complexity of computing marginals might scale cubically with the number of
variables, while for models with discrete variables it often leads to intractable computations.
Computations can be made faster or tractable by using approximate inference methods like
the mean field approximation (e.g., Jaakkola, 2000) and the Bethe-type approximation (e.g.,
Yedidia, Freeman, & Weiss, 2000). These methods were developed for discrete probabilistic
graphical models, but they are applicable to Gaussian models as well. However, there are
important differences in their behavior for the discrete and Gaussian cases. For example,
while in discrete models the error function of the Bethe approximationcalled Bethe free
energyis bounded from below (Heskes, 2004; Watanabe & Fukumizu, 2009), in Gaussian
models this might not always the case (Welling & Teh, 2001).
An understanding of properties of the Bethe free energy of Gaussian models might
also be help to understand the properties of the energy function in conditional Gaussian
models. Conditional Gaussian or hybrid graphical models, such as switching Kalman filters
(Zoeter & Heskes, 2005), combine both discrete and Gaussian variables. Approximate
inference in these models can be carried out by expectation propagation (e.g., Minka, 2004,
2005) which can be viewed as a generalization of the Bethe approximation, where the
marginal consistency constraints on the approximate marginals are replaced by expectation
constraints (Heskes, Opper, Wiegerinck, Winther, & Zoeter, 2005). In order to understand
c
2011
AI Access Foundation. All rights reserved.

fiCseke & Heskes

the properties of the Bethe free energy of hybrid models, a good understanding of the two
special cases of discrete and Gaussian models is needed. While the properties of the Bethe
free energy of discrete models have been studied extensively in the last decade and are well
understood (Yedidia et al., 2000; Heskes, 2003; Wainwright, Jaakkola, & Willsky, 2003;
Watanabe & Fukumizu, 2009), the properties of the Gaussian Bethe free energy have been
studied much less.
The message passing algorithm is a well established method for finding the stationary
points of the Bethe free energy (Yedidia et al., 2000; Heskes, 2003). It works by locally
updating the approximate marginals and has been successfully applied in both discrete (e.g.,
Murphy, Weiss, & Jordan, 1999; Wainwright et al., 2003) and Gaussian models (e.g., Weiss
& Freeman, 2001; Rusmevichientong & Roy, 2001; Malioutov, Johnson, & Willsky, 2006;
Johnson, Bickson, & Dolev, 2009; Nishiyama & Watanabe, 2009; Bickson, 2009). Gaussian
message passing is the simplest case of a free-energy based message passing algorithm on
models with continuous variables, therefore, it is important to understand its behavior.
Gaussian message passing has many practical applications like in distributed averaging
(Moallemi & Roy, 2006), peer-to-peer rating, linear detection, SVM regression (Bickson,
2009) and more generally in problems that involve solving large sparse linear systems or
approximating the marginal variances of large sparse Gaussian systems typically encountered in distributed computing settings. For further applications the reader is referred to
the work of Bickson (2009) and references therein.
Finding sufficient conditions for the convergence of message passing in Gaussian models
has been successfully addressed by many authors. Using the computation tree approach,
Weiss and Freeman (2001) proved that message passing converges whenever the precision
matrixinverse covarianceof the probability distribution is diagonally dominant1 . With
the help of an analogy between message passing and walksum analysis, (Malioutov et al.,
2006) derived the stronger condition of pairwise normalizability2 . A different approach was
taken by Welling and Teh (2001), who directly minimized the Bethe free energy with regard
to the parameters of approximate marginals, conjecturing that Gaussian message passing
converges if and only if the free energy is bounded from below. Their experiments showed
that message passing and direct minimization either converge to the same solution or both
fail to converge. We adopt a similar approach, that is, instead of analyzing the properties
of the Gaussian message passing algorithm using approaches like in Weiss and Freeman or
Malioutov et al., we choose to study the properties of the Gaussian Bethe free energy and
its stationary points. This will help us to draw conclusions about the existence of local
minima, the possible stable fixed points to which message passing can converge.
This paper is structured as follows. In Section 2 we introduce Gaussian Markov random
fields and the message passing algorithm. In Section 3 we define the Gaussian fractional
Bethe free energies parameterized by the moment parameters of the approximate marginals
and derive boundedness conditions for them. These two sections are based on the authors
earlier work (Cseke & Heskes, 2008). In Section 4 we analyze the stability properties of the
Gaussian message passing algorithm and, using a similar line of argument as Watanabe and
P
1. The matrix A is diagonally dominant if |Aii | > j6=i |Aij | for all i.
2. Following the work of Malioutov et al. (2006), we call a Gaussian distribution pairwise normalizable
if it
Q
can be factorized into a product of normalizable pair factors, that is, p(x1 , . . . , xn ) = ij ij (xi , xj )
such that all ij s are normalizable.

2

fiBethe Free Energies and Message Passing in Gaussian Models

Fukumizu (2009), we show that its stable fixed points are indeed local minima of the Bethe
free energy. We conclude the paper with a few experiments in Sections 5 and 6 supporting
our results and their implications.

2. Approximating Marginals in Gaussian Models
The probability density of a Gaussian random vector x  Rn is defined in terms of canonical
parameters h and Q as


1 T
T
p(x)  exp h x  x Qx ,
(1)
2
where Q is s positive definite matrix. The expectation m and the covariance V of x is
then given by m = Q1 h and V = Q1 respectively. In many real world applications the
matrix Q is sparse with and it typically has low density, that is, the number of non-zero
elements in Q scales with the number of variables n.
This probability density can also be defined in terms of an undirected probabilistic
graphical model commonly known as Gaussian Markov random field (GMRF). Since the
interactions between the variables in p are pairwise, we can associate the variables xi to the
nodes v  V = {1, . . . , n} of an undirected graph G = (V, E), where the edges e  E  V V
of the graph stand for the non-zero off-diagonal elements of Q. We use i  j as a proxy for
(i, j)  E. By using the notation introduced above, the density p in (1) can be written as
the product
Y
p(x) 
ij (xi , xj )
(2)
ij

of Gaussian functions ij (xi , xj ) (also called potentials) associated with the edges e = (i, j)
of the graph. If h and Q are given then we can define the potentials as
j
j
i
i
ij (xi , xj ) = exp {ij
hi xi + ij
hj xj  ij
Qii x2i /2  ij
Qjj x2j /2  Qij xi xj } ,

P
P
j
i
where
ij ij = 1 and
ji ij = 1 are partitioning h and Q into the corresponding
factors. In practice, however, the factors ij might be given by the problem at hand and
i and  j computed by summing their parameters and computing the
h and Q as well as ij
ij
partitioning respectively. Without loss of generality, we can and we will use Qii = 1, since
the results in the paper can be easily re-formulated for general Qs by a rescaling of the
variables (e.g., Malioutov et al., 2006).
The numerical calculation of all marginals, can be done by solving the linear system
m = Q1 h and performing a sparse Cholesky factorization LLT = Q followed by solving the Takahashi equations (Takahashi, Fagan, & Chin, 1973). An alternative option to
calculate the marginal means and to approximate marginal variances is to run the Gaussian message passing algorithm in the probabilistic graphical model associated with the
representation in (2). The Gaussian message passing algorithm is the Gaussian variant
of message passing algorithm (Pearl, 1988), which is a dynamical programming algorithm
introduced to compute marginal densities in discrete probabilistic models with pairwise interactions and tree-structured graphs G. However, it turned out that by running it in loops
on graphs with cycles, it yields good approximations of the marginal distributions (Murphy
et al., 1999). Weiss and Freeman (2001) showed that when the Gaussian message passing
3

fiCseke & Heskes

Figure 1: An illustration of the incoming and outgoing messages at adjacent nodes i and j.

algorithm is converging, it computes the exact mean parameters m, thus it can also be
used for solving linear systems (e.g., Bickson, 2009). Message passing works by updating
and passing directed messages along the edges of the graph G, which, in case the algorithm
converges, are then used to compute (approximate) marginal probability distributions. The
Gaussian and the discrete algorithms have the same functional form with the exception of
the summation (discrete case) and integration operators (Gaussian case). Each message
ij (xi ) is updated according to
Z
Y
new
ij (xi ) = dxj ij (xi , xj )
jk (xj ) ,
(3)
kj\i

where i = {j : j  i} denotes the index set of variables connected to xi in G. At each step
the current approximations qij (xi ,j ) of p(xi , xj ) can be computed according to
qij (xi , xj )  ij (xi , xj )

Y
li\j

il (xi )

Y

jk (xj ) .

(4)

kj\i

The update steps in (9) have to be iterated until convergence. The corresponding qij (xi , xj )s
yield the final approximation of the p(xi , xj )s. It is common to use damping, that is,
1 new (x ) with   (0, 1]. In practice, this helps to
to replace new
ij (xi ) by ij (xi )
ij i
dampen the possible periodic paths of (3), but it keeps the properties of the fixed points
unchanged. Figure 1 illustrates the incoming and outgoing messages at the nodes associated
with variables xi and xj . A quite significant difference between the discrete and Gaussian
the message passing is the replacement of the sum operator with the integral operator.
While finite sums always exist, the integral in (3) can become infinite. This problem can
be remedied technically by a canonical parameterization (see Section 4) which keeps the
algorithm running, but it can lead to non-normalizable approximate marginals qij , and thus
a (possible) break-down of the algorithm.
Message passing was introduced by Pearl (1988) as a heuristic algorithm (in discrete
models), however, Yedidia et al. (2000) showed that it can also be viewed as an algorithm for
4

fiBethe Free Energies and Message Passing in Gaussian Models

finding the stationary points of the so-called Bethe free energy, an error function measuring
the difference between p and a specific family of distributions to be detailed in the next
section. It has been shown by Heskes (2003) and later in a different way by Watanabe and
Fukumizu (2009) that stable fixed points of the (loopy) message passing algorithm are local
minima of the corresponding Bethe free energy. In this paper we show that this holds for
Gaussian models as well.
Our interest in the properties of the Gaussian Bethe free energy and the corresponding Gaussian message passing algorithm is motivated mainly by their implications in more
general models and inference algorithms like non-Gaussian models and expectation propagation, respectively. For this reason, we will not compare the speed of the method and the
accuracy of the approximation with the above mentioned exact linear algebraic methods.
As mentioned in the introduction, the approach we take is similar to that of Welling and
Teh (2001), that is, we study the properties of the Gaussian Bethe free energy, parameterized
in terms of the moment parameters of the approximate marginals. In the following we
introduce the mean field and the Bethe approximation in Gaussian models. Readers familiar
with this subject can continue with Section 3.
2.1 The Gaussian Bethe Free Energy
A popular method to approximate marginals is approximating p with a distribution q having
a form that makes marginals easy to identify, for example, it factorizes or it has a treelike form. The most common quantity to measure the difference between two probability
distributions is the Kullback-Leibler divergence D [q || p]. It is often used to characterize the
quality of the approximation and formulate the computation of approximate marginals as
the optimization problem


Z
q(x)

q (x) = argmin dx q(x) log
.
(5)
p(x)
qF
Here, F is the set of distributions with the above mentioned form. Since it is not symmetric,
the Kullback-Leibler divergence is not a distance, but D [q || p]  0 for any proper q and p,
D [q || p] = 0 if and only if p = q, and it is convex both in q and p.
A family F of densities possessing a form that
Q makes marginals easy to identify is the
family of distributions that factorize as q(x) = k qk (xk ). In other words, in problem (5) we
approximate p with a distribution that has independent variables. An approximation q of
thisQtype is called mean field approximation (e.g., Jaakkola, 2000). Defining FMF ({qk }) =
D [ qk || p] and writing out the right hand side of (5) in detail, one gets
Z
FMF ({qk }) = 

dx

Y

qk (xk ) log p(x) +

k

XZ

dxk qk (xk ) log qk (xk ).

k

Using the parameterization qk (xk ) = N (xk |mk , vk ), m = (m1 , . . . , mn )T and v = (v1 , . . . , vn )T ,
this reduces to
1
1X
1X
FMF (m, v) = hT m + mT Qm +
Qkk vk 
log(vk ) + CMF ,
2
2
2
k

5

k

fiCseke & Heskes

Q
where CMF is an irrelevant constant. Although D [ k qk || p] might not be convex in
(q1 , . . . , qn ), one can easily check that FMF is convex in its variables m and v and its
minimum is obtained for m = Q1 h and vk = 1/Qkk . Since

1
 1 

1
Q kk = Qkk  QTk,\k Q\k,\k
Q\k,k
,
one can easily see that the mean field approximation underestimates variances. The mean
field approximation computes a solution in which the means are exact, but the variances are
computed as if there were no interactions between the variables, namely, as if the matrix
Q were diagonal, thus giving poor estimates of the variances.
In order to improve the estimates for variances, one has to choose approximating distributions q that are able to capture dependencies between the variables in p. It can be
verified that any distribution in which the dependencies form a tree graph can be written
in the form
Y p(xi , xj ) Y
p(x) =
p(xk ),
p(xi )p(xj )
ij

k

where i and j run through the edges (i, j) of the tree and k through the nodes 1, . . . , n.
Although in most cases the undirected graph generated by the non-zero elements in Q is
not a tree, based on the tree intuition one can construct q from one and two variable
marginals as
Y qij (xi , xj ) Y
q(x) 
qk (xk )
(6)
qi (xi )qj (xj )
ij

k

andR constrain the functions qij and qk to be marginally
consistent and normalize to 1, that
R
is, dxj qij (xi , xj ) = qi (xi ) for any i  j and dxk qk (xk ) = 1 for any k. An approximation
of the form (6) together with the constraints on qij s and qk s is called a Bethe approximation.
Let us denote the family of such functions by FB . By choosing qij (xi , xj ) = qi (xi )qj (xj ) one
can easily check that FMF  FB , thus FB is non-empty. Assuming that the approximate
marginals are correct and q normalizes to 1 and then substituting (6) into (5), we get an
approximation of the KullbackLeibler divergence in (5) called the Bethe free energy.
Due to the factorization of p, we can write the Bethe free energy as
XZ
FB ({qij , qk }) = 
dxi,j qij (xi,j ) log ij (xi,j )
(7)
ij

+

XZ
ij



 XZ
qij (xi,j )
dxi,j qij (xi,j ) log
+
dxk qk (xk ) log qk (xk ).
qi (xi )qj (xj )
k

One can also define the free energy through the Bethe approximation
Z
XZ
dx q (x) log q (x) 
dxi,j q (xi,j ) log q (xi,j )
ij

+

X
k

6

Z
(1  nk )

dxk q (xk ) log q (xk )

fiBethe Free Energies and Message Passing in Gaussian Models

of the entropy (e.g., Yedidia et al., 2000) and substitute the marginals with functions qij and
qRk that normalize to one and are connected through the marginal consistency constraints
dxj qij (xi , xj ) = qi (xi ).
From the stationary conditions of the Lagrangian corresponding to the fractional Bethe
free energy (7) and the marginal consistency and normalization constraints, one can derive
the same iterative algorithm as in (3) for the corresponding Lagrange multipliers of the
consistency constraints (Yedidia et al., 2000). Similarly, approximate marginals can then
be computed according to (4). It can be shown that there is a one-to-one correspondence
between the stationary points of the Bethe free energy (7) and the fixed points of the
message passing algorithm (3). Later, in Section 4 we will link the stable fixed points of (3)
to the local minima of (7).
2.2 Fractional Free Energies and the Message Passing Algorithm
As mentioned in the introduction, in case of Gaussian models the message passing algorithm
does not always converge. The reason for this appears to be that the approximate marginals
may get indefinite or negative definite covariance matrices. Welling and Teh (2001) pointed
out that this can be due to the unboundedness of the Bethe free energy.
Since FMF is convex and bounded and the Bethe free energy might be unbounded, it
seems plausible to analyze the fractional Bethe free energy
XZ
F ({qij , qk }) = 
dxi,j qij (xi,j ) log ij (xi,j )
(8)
ij


 XZ
X 1 Z
qij (xi,j )
+
dxi,j qij (xi,j ) log
+
dxk qk (xk ) log qk (xk ).
ij
qi (xi )qj (xj )
ij

k

introduced by Wiegerinck and Heskes (2003). Here,  denotes the set of positive reals {ij }.
They showed that the fractional Bethe free energy interpolates between the mean field
and the Bethe approximation. That is, for ij = 1 we get the Bethe free energy, while in the
case when all ij s tend to 0, the mutual information between variables xi and xj is highly
penalized, therefore, (8) enforces solutions close to the mean field solution. They also showed
that the fractional message passing algorithm derived from (8) can be interpreted as Pearls
message passing algorithm with the difference that instead of computing local marginals
like in Pearls algorithmone computes local ij marginals.3 The local ij marginals
correspond to true local marginals when ij = 1 and to local mean field approximations
when ij = 0. The resulting algorithm is called the fractional message passing algorithm
and the message updates are defined as
Z
Y

new
(x
)
=
dxj ij (xi , xj )
jk (xj ) ji (xj )1 ,
(9)
ij i
kj\i

while the approximate marginals are computed according to
Y
Y
qij (xi , xj )  ij (xi , xj )
il (xi ) ij (xi )1
jk (xj ) ji (xj )1 .
li\j

(10)

kj\i



Q
3. We define the marginals of a distribution p as argmin{qk } D p k qk , where D is the divergence
k
R

R
R
D [p || q] = dxp(x) q(x)1 +  dxp(x) + (1  ) dxq(x) /(1  ) (e.g., Minka, 2005).

7

fiCseke & Heskes

Power expectation propagation by Minka (2004) is an approximate inference method
that uses local approximations with divergences. In case of Gaussian models power
expectation propagationwith a fully factorized approximating distributionleads to the
same message passing algorithm as the one derived from (8) and the appropriate constraints.
Starting from the idea of creating an upper bound on the log partition function when p and
q are exponential distributions, Wainwright et al. (2003) derived a form of (8) where the
ij s are chosen such that this bound is convex in {qij , qk }.
Message passing works well in practice, however, there are other ways to find the local
minima of the fractional free energies like the direct minimization w.r.t. some parameterization of the approximate marginals qij and qk (Welling & Teh, 2001). The latter method is
slower but more likely to converge. In the following we analyze the Bethe free energy when
expressed in terms of the moment parameters of the approximate marginals qij . Later in
Section 4 we analyze the stability conditions of the fractional message passing algorithm
and by expressing these conditions in term of the moment parameters of the approximate
marginals, we show that stable fixed points of the fractional Gaussian message passing are
local minima of the fractional Bethe free energy.

3. Bounds on the Gaussian Bethe Free Energy
In this section we analyze the parametric form of (8). We show that the fractional Gaussian Bethe free energy is a non-increasing function of . By letting all ij tend to infinity, we obtain a lower bound for the free energies. It turns out that the condition for
the lower bound to be bounded from below is the same as the pairwise normalizability
condition in the work of Malioutov et al. (2006).
As mentioned in Section 2, without loss of generality, we can work with a unit diagonal Q. We define R to be a matrix with zeros on its diagonal and Q = I + R,
where I is the identity matrix. |R| will be the matrix formed by the absolute values
of Rs elements. We use the moment parameterization qij (xi,j ) = N (xi,j |mij , Vij ) and
i , v ; v , v j ], with v = v .
qk (xk ) = N (xk |mk , vk ), where mij = (miij , mjij )T and Vij = [vij
ij
ji ij
ij
ji
i = mi and v  v i = v k for all i  j and i  k, we embed the
By using mi  m
i
ij
ik
ik
R ij
R
marginalization ( dxj qij (xi , xj ) = qi (xi ) for all i  j) and normalization ( dxj qj (xj ) = 1)
constraints into the parameterization. With a slight abuse of notation the matrix formed
by diagonal elements vk and off-diagonal elements vij is denoted by V (we can take vij = 0
for all i  j), the vector of means by m = (m1 , . . . , mn )T and the vector of variances by
v = (v1 , . . . , vn )T . Substituting qij and qk into (8) one gets
1
1
F (m, V ) =  hT m + mT Qm + tr(QT V )
2
2 !
2
X
v
1
1
1X
ij

log 1 

log (vk ) + C,
2
ij
vi vj
2
ij

(11)

k

where C is an irrelevant constant. Note that the variables m and V are independent, hence
the minimizations of F (m, V ) with regard to m and V can be carried out independently.
8

fiBethe Free Energies and Message Passing in Gaussian Models

Property 1. F (m, V ) is convex and bounded in (m, {vij }i6=j ) and at any stationary point
we have
m = Q1 h
vij



p
1 + (2ij Rij )2 vi vj  1
= sign(Rij )
.
2ij |Rij |

(12)

Proof: Q is positive definite by definition, therefore, the quadratic term in m is convex
and bounded. The variables m and V are independent and the minimum with regard
to m is achieved at m = Q1 h. One can check that the second order derivative of
F (m, V ) with regard to vij is non-negative and the first order derivative has only one
2  v v . Since the variables v are independent, one can conclude
solution when vi vj  vij
i j
ij
that F (m, V ) is convex in vij . From the independence of m and V , it follows that F is
convex in (m, {vij }i6=j ).

2 , thus the
Since the Vij s are constrained to be covariance matrices, we have vi vj > vij
first logarithmic term in (11) is negative. As a consequence,

F1 (m, V )  F2 (m, V )

for any

0 < 1  2 ,

where 1  2 is taken element by element. This observation leads to the following
property.
Property 2. With ij = , F is a non-increasing function of .
 into F we define the constrained function
Using Property 1 and substituting vij

1
1X
Fc (m, v) = hT m + mT Qm +
vk
2
2
k
q

1X 1
1 + (2ij Rij )2 vi vj  1

2

ij ij
!
p
1 + (2ij Rij )2 vi vj  1
1 X 1

log 2
2
ij
(2ij Rij )2 vi vj
n(i,j)

1X

log(vk ) + C c ,
2

(13)

k

where C c is an irrelevant constant. From Property 2, it follows that when choosing ij = ,
the function in (13) is a non-increasing function of . It then makes sense to take   
and verify whether we can get a lower bound for (13).
Lemma 1. For any v > 0, 0  1  1 and 2  1 the following inequalities hold.


FMF (m, v)  Fc1 (m, v)  FB m, {vij
}, v


FB m, {vij
}, v  Fc2 (m, v) . . .

1 T
. . .  FMF (m, v) 
v |R| v
2
Moreover, they are tight, that is,


lim F m, {vij
()}, v = FMF (m, v)
0

9

fiCseke & Heskes

and



1 T

v |R| v.
lim F m, {vij
()}, v = FMF (m, v) 
2
Proof: Since the Bethe free energy is the specific case of the fractional Bethe free energy for
 ()}, v) follow from Property 2. Now, we show that
 = 1, the inequalities on FB (m, {vij
the upper and lower bounds are tight. The function (1 + x2 )1/2  1 behaves as 12 x2 in the
neighborhood of 0, therefore,


v  2 ()
log 1  ijvi vj
 2 ()
vij
1

lim
lim vij
() = 0
and
lim
=
= 0,
0
0

vi vj 0 


showing that FMF (m, v) is a tight upper bound.
As  tends to infinity, we have
p
1 + (2Rij )2 vi vj  1
 
= |Rij | vi vj
lim

2
and
1
log
lim
 

!
p
1 + (2Rij )2 vi vj  1
= 0,
(2Rij )2 vi vj

yielding a tight lower bound


1 T

v |R| v.
lim F m, {vij
()}, v = FMF (m, v) 

2



Let max (|R|) be the largest eigenvalue of |R|. Analyzing the boundedness of the lower
bound, we arrive at the following theorem.
Theorem 1. For the fractional Bethe free energy in (11) corresponding to a connected
Gaussian model, the following statements hold
(1) if max (|R|) < 1, then F is bounded from below for all  > 0,
(2) if max (|R|) > 1, then F is unbounded from below for all  > 0,
P P 1
(3) if max (|R|) = 1, then F is bounded from below if and only if
ij  2n.
i ij

Proof: Since in F there is no interaction between the parameters m and V and the term
depending on m is bounded from below due to the positive definiteness of Q, we can simply
neglect this term when analyzing the boundedness of F . Let us write out in detail the
lower bound of the fractional Bethe free energies in the form

1 T
v |R| v =
2

1 T
1
1 T 1
m Q m  hT m +
v (I  |R|) v  1T log(v) + const.
2
2
2

FMF (m, v) 

(14)

Statement (1): The condition max (|R|) < 1 implies that I  |R| is positive definite. Now,
10

fiBethe Free Energies and Message Passing in Gaussian Models

 T
 T




log(x)  x  1, thus 12 v (I  |R|) v  1T log( v)  21 v (I  |R|) v  1T v + n.
The latter is bounded from below and so it follows that (14) is bounded from below as
well. According to Lemma 1, the boundedness of (14) implies that all fractional Bethe free
energies are bounded from below.
Statement (2): We assumed that the Gaussian network is connected and undirected. According to the Perron-Frobenius theory of non-negative matrices (e.g., Horn & Johnson,
2005), |R| has a simple maximal eigenvalue max (|R|) and all elements of the eigenvector umax corresponding to it are positive. Let us take the fractional Bethe free energy

and analyze its behavior when v = tumax and t  . For large values of t we have
(1 + (2ij Rij )2 (uimax ujmax )2 t4 )1/2 ' 2ij |Rij |uimax ujmax t2 , therefore, the sum of the second
and third term in (13) simplifies to (1  max (|R|))t2 and this term dominates over the
logarithmic ones as t  . As a result, the limit is independent of the choice of ij and it
tends to  whenever max (|R|) > 1.
Statement (3): If max (|R|) = 1, then the only direction in which the quadratic term will

not dominate is v = tumax . Therefore, we have to analyze the P
behavior of the loga1
rithmic terms in (13) when t  . For large ts these behave as ( ij ij
 2n) log(t).
c
For this reason, the boundedness of F and thus of F depends on the condition in
statement (3).

It was shown by Malioutov et al. (2006) that the condition max (|R|) < 1 is an equivalent
condition to pairwise normalizability. Therefore, pairwise normalizability is not only a
sufficient condition for the message passing algorithm to converge, but it is also a necessary
condition for the fractional Gaussian Bethe free energies to be bounded. Using Lemma 1, we
can show that for a suitably chosen  > 0 there always exists an  such that the constrained
fractional free energy Fc possesses a local minimum for any 0 <  <  (Property A2 in
Section A of the Appendix).
Example In the case of models with an adjacency matrix (non-zero entries of R) corresponding to a Kregular graph4 and equal interaction weights Rij = r, the maximal eigenvalue of |R| is max (|R|) = Kr and the eigenvector corresponding to this eigenvalue is 1.
(We define 1 as the vector that has all its elements equal to 1.) The model is symmetric
and by verifying the stationary point conditions, it turns out that for some choice of r and
 there exists a local minimum, which also lies in the direction 1. One can show that when
the model is not pairwise normalizable (Kr > 1), the critical r below
p which the fractional
Bethe free energy possesses this local minimum is rc (K, ) = 1/2 (K  ) and for any
valid r the critical  below which
p the fractional Bethe free energies possesses this local
minimum is c (K, r) = 21 K(1  1  1/(Kr)2 ). These results are illustrated in Figure 2.
(Note that for 2regular graphs, all valid models are pairwise normalizable and possess a
unique global minimum.)

For Kregular graphs, the convexity of the fractional Bethe free energy in terms of
{qij , qk } requires   K, a much stronger condition than   c (K, r). Thus, if we choose
 sufficiently large such that the Bethe free energy is guaranteed to have a unique global
minimum, this minimum is unbounded.

4. A Kregular graph is a graph in which all nodes are connected to K other nodes.

11

fiCseke & Heskes

$

!"

$

)

!"

+0")12&3,)*.&456
+)D)1"7+834.59
+0!:;
+< VTUWff.fi
+0+

#

%&'(&)*+&&)&,&+-.&/

%&'(&)*+&&)&,&+-.&/

#

!"

834.5



!"

"

!"



!"

)

_0")12&3,)*.&456
_)D)7"8"!9!"":
_0!)1%&'(&6
_0_;

!"

_)0)')14<=&+)><?,56


!"

"

!"

)





!"



!"

"

!"
m

!

!"

!"



)



!"

!"



!"

"

!"
m

!

!"



!"

Figure 2: Visualizing critical parameters for a symmetric K-regular Gaussian model with Rij = r.
Plots
in the left panel correspond to the constrained fractional Bethe free energies Fc for

v = 1 for an 8 node 4regular Gaussian model with r=0.27 (Kr > 1) and varying
.

Plots in the right panel correspond to the constrained Bethe free energies F1c for v = 1
in an 8 node 4regular Gaussian model with varying r. Here, rvalid is the supremum of
rs for which the model is valid, that is, Q is positive definite.

This example disproves the conjecture by Welling and Teh (2001), that is, even when
the Bethe free energy is not bounded from below, it can possess a finite local minimum to
which the message passing and the minimization algorithms can converge.

4. The Message Passing Algorithm in Gaussian Models
In this section, we turn our attention towards the properties of the message passing algorithm in Gaussian models. Following a similar line of argument as Watanabe and Fukumizu
(2009) we show that stable fixed points of the message passing algorithm correspond to local
minima of the Bethe free energy. We use the moment parameterization introduced in the
previous sections. The way we proceed is the following: (1) we make a linear expansion of
message passing iteration at a fixed point, (2) we express the linear expansion in terms of
moment parameters corresponding to the fixed point and finally (3) we connect the properties of the latter with the properties of the Hessian of the Bethe free energy by using the
matrix determinant lemma.
The form of the equation (9) implies that the messages ij (xi ) are univariate Gaussian
functions, thus we can express them in terms of two scalar (canonical) parameters ij and
ij such that log ij (xi ) = ij x2i /2 + ij xi + ijj , where the ij s are irrelevant constants.
When expressed in terms of ij and ij , the damped message passing algorithm (9) translates
12

fiBethe Free Energies and Message Passing in Gaussian Models

to
j
hj +
ij


new
ij

=

(1  )ij +

P

jk + (1  )ji



  i
kj\i

P
ij hi  Rij

j

ij
+
jk + (1  )ji

(15)

kj\i



new
ij

=

1 
X
  i

j
2 
 2 Rij
ij
+
jk + (1  )ji  
(1  )ij + ij



kj\i

(16)
i ,  j , h and R are parameters of  as in Section 2.1, with R = Q and the
where ij
i
ij
ij
ij
ij
ij
assumption that Qii = 1. The approximate marginals qij in (10) might not be normalizable,
but the message passing iteration in (15) and (16) stays well defined unless there is a zero
in the denominator on the rhs. This rarely happens in practice. However, it is more
common that message passing converges while there are some intermediate steps at which
the approximate marginals qij are not normalizable. This can often be remedied by choosing
an appropriate damping parameter .
The iteration (16) for the ij s is independent of ij s and the iteration (15) for the ij s
is linear in ij . It is interesting to see that when h = 0 neither the constrained Bethe
free energy (13) nor the message passing algorithm (16) depend on the sign of Rij . These
are only relevant to compute the meanswhen h 6= 0and the signs of the correlations
in (12). As a result, the marginal variances computed by either minimizing the Bethe free
energy or by running the message passing algorithm can only depend on |R|, similarly to
the constrained fractional free energy Fc .

4.1 Stability of the Gaussian Message Passing Algorithm
In the following we analyze the stability of the message passing iteration at its fixed points,
that is, at the stationary points of the Lagrangian corresponding to the constrained minimization of the Gaussian Bethe free energy. We reiterate that we use G = (V, E) to denote
the graph corresponding to Q, namely, V = {1, . . . , n} and E = {(i, j) : Qij 6= 0}. The vector   R|E| , corresponding to a set of messages {ij }ij , is composed by the concatenation
of ij s such that ij is followed by ji and the (ij, ji) blocks follow a lexicographic order w.r.t.
ij and i < j. The vector  consists of the variables ij and follows a similar structure as .
j
We define r, h,   R|E| as rij = rji = Rij , hij = hj and ij = ij
. We also define the
|E|  |E| matrix

1 if j = k

1   if kl = ji
Mij,kl () 

0 otherwise
which encodes the weighted edge adjacency corresponding to G and . The number of nonzero elements in M(), scales roughly with nnzeros (Q)2 /n, where nnzeros (Q) denotes
the number of non-zeros in Q. Since the parallel message update given Equations (15) and
(16) can be rewritten in terms of two matrix-vector multiplications and element by element
operations on vectors, the computational complexity of an update also scales as roughly
with nnzeros (Q)2 /n.
13

fiCseke & Heskes

With this notation, the local linearization of the update equations (15) and (16) can be
written as
 ( new , new )
(, ) = (1  )I . . .
 (, )






 h+M()
1
diag r +M() M() diag r (+M())2 M()

,


+ 
1

0
diag 2 r 2 (+M())
M()
2

(17)

where all operations on vectors are element by element. The stability of a fixed point
(  ,  ) depends on the union of the spectra of

J (  ,  )  1 diag r( + M() )1 M()
and

J (  ,  )  1 diag 2 r 2 ( + M() )2 M().
It is important to point out that the stability properties depend only on  and R and are
independent of   and h.
Our goal is to connect the stability properties of the message passing algorithm to the
properties of the Bethe free energy. Therefore, we express the stability properties in terms
of the moment parameters of approximate marginals. For any  that leads to normalizable approximate marginals qij (xi , xj ), we can use (10) to identify the local covariance
parameters Vij defined in Section 3, but now without enforcing the marginal matching
i = v i . The correspondence is given by
constraints vij
ik
"

i
vij
vij

vij
j
vij


=

#1

1

=

"

j
vij
vij

i vj  v2
vij
ij
ij
P
i +
il + (1  )ij
ij

vij
i
vij

#
(18)
Rij

li\j
j
ij

Rij

+

P

jk + (1  )ji



.

kj\i
i , v j and r
The approximate local covariances vij are fully determined by vij
ij and have
ij
the form as in (12). This leaves us with |E| moment parameters to be computed by the
i , v = v j and y (v) =
message passing algorithm. Let v  R|E| be defined as vij = vij
ji
ij
ij
i v j  v 2 ), where v
vij /(vij
ij
ij is computed according to (12). It can be checked that the
ij
mapping between y and v is continuous and bijective. This implies that the canonical to
moment parameter transformation in (18) can be written as y(v) =  + M(). Since
M() is singular only when  = K and the graph G is K-regularsee Property A1 in
Section A of the Appendix for detailsfor the rest of the cases, there is a continuous,
bijective mapping between the moment parameters v and the canonical parameters  that
lead to normalizable approximate marginals.
i = v i  v  for any
At any fixed point (  ,  ) we have moment matching, that is, vij
i
ik
k, j  i, therefore we can express the stability properties in terms of moment parameters

14

fiBethe Free Energies and Message Passing in Gaussian Models

v  = (vi , . . . , vn ). Using p
(18) and defining the diagonal matrix D  R|E||E| with the
diagonal elements Dij,ij = vi , we get

, v)
v
(,
v
ij
i
j 
= 1 diag  q
M()


vi vj


DJ ( (v  ))D 1

(19)

and
2





D J ( (v ))D

2

=

1

diag

vij (, vi , vj )2
vi vj

!
M().

(20)


Let (A) denote
the spectrum of the matrix A. Since we have  DJ D 1 =  (J ) and

 D 2 J D 2 =  (J ), it is sufficient to analyze the spectral properties of the right hand
sides in equations (19) and (20).
The message passing algorithm is asymptotically stable at  (v  ) if and only if
max { (J ( (v  ))) ,  (J ( (v  )))} < 1,

(21)

where () denotes the spectral radius. It is interesting to see that although the functional
forms of the free energies and the message passing algorithms are different in the Gaussian
and discrete case, the stability conditions have similar forms. This will allow us to use
some of the results of Watanabe and Fukumizu (2009). In the next section, we show the
implications of this condition for the properties of the Hessian of the free energy.
4.2 Stable Fixed Points and Local Minima
The Hessian H[F ] of the Bethe free energy (11) depends only on the moment parameters
vi , vj and vij . Note that now, the vij s are unconstrained parameters. It is an (|E|/2 + 2n)
(|E|/2 + 2n) matrix and it has the form


Q


 0
H[F ](V ) = 

0

diag
h 2

0 2

 F
 2 vij
iT

 h

 F
vij vi ij,i

0 i

 2 F
vij vi ij,i

h

i

 2 F
vi vj i,j




,


where we use V to denote the collection of parameters vi , i = 1, . . . , n and vij , i  j.
Since the block corresponding to the partial differentials w.r.t. vij is diagonal with positive
elements, the Hessian is positive definite at V if the Schur complement corresponding to
15

fiCseke & Heskes

the partial differentials w.r.t. vi s is positive definite at V . The latter is given by
X   2 F 2  F 1
 2 F
v

Hii [F ](V ) =
vi vi
vij vi
vij
ij


1 1 
1 X c4ij 
=
1
+
,
4
2 vi2

1

c
ij
ij

1
2
2
 F
 F  2 F  2 F
v
Hij [F ](V ) =

vi vj
vij vi vij vj  2 vij
1 1 1 c2ij
= 
,
2 vi vj  1  c4ij

where we use the notation cij = vij / vi vj .
Now, we would like to connect the condition in (21) to the positive definiteness of the
matrix H v [F ](V ). In the following we show that stable fixed points  (v  ) of the Gaussian
message passing algorithm, satisfying (21), correspond to local minima of the Gaussian free
energy F at v  and vij (, vi , vj ).
According to Watanabe and Fukumizu (2009), for any arbitrary vector w  R|E| one
has

Y
det I|E|  1 diag (w) M() = det In + 1 A(w)
(1  wij wji ),
(22)
ij

where
Aii (w) =

X
ij

wij wji
1  wij wji

and

Aij (w) = 

wij
.
1  wij wji

(23)

The proof is an application of the matrix determinant lemma and a reproduction of it can
be found in Section A of the Appendix. Equation (22) expresses the determinant of an
|E||E| matrix as the determinant of an nn matrix.

Let c  R|E| with cij (V ) = vij / vi vj . By substituting w = c(V )2 in (23), we find that


det I  1 diag c(V )2 M() = f (V ) det (H[F ](V )) ,
(24)
where f (V ) is a positive function defined as
f (V ) = 2n |E| |Q|1

Y
k

vk2


2
2
Y vi vj  vij
ij

2
vi vj + vij

2
vij
1
vi vj

!
.

for all V corresponding to normalizable approximate marginals. Now, adapting the theorem
of Watanabe and Fukumizu (2009)
 we have
 the following theorem.
Theorem If  1 diag c(V )2 M()  C \ R1 then the Hessian of the (Gaussian)
Bethe free energy H[F ] is positive definite at
 V. 
1
2
Proof: The assumption
   diag c(V ) M()  C \ R1 implies that we have
det I  1 diag(c(V )2 M()) > 0. By choosing Vij (t) = tvij with t  [0, 1], we find
2
that c(V(t))2 = t2 c(V )2 , therefore, det I  1 diag(c(V (t) )M()) > 0 for any t  [0, 1].
16

fiBethe Free Energies and Message Passing in Gaussian Models

This implies that det (H[F ](V (t))) > 0 for any t  [0, 1]. Since H[F ](V (0)) = I > 0
and the eigenvalues of H[F ](V (t)) change continuously w.r.t. t  [0, 1], it results that
H[F ](V (1)) > 0 for any V , thus satisfying the condition of the theorem.

 
 
The fixed point (  ,  ) is stable if and
 only if max{(J ( (v ))), (J ( (v )))} < 1.
1

2
This implies   diag(c(V ) )M()  C \ R1 and leads to the following property.

Property 3. Stable fixed points (  ,  ) of the damped Gaussian message passing algorithm (16) are local minima of the Gaussian Bethe free energy Fc in (13) at v  ( ).
The above shows that the boundedness of F or the existence of local minima in case
of an unbounded F plays a significant role in the convergence of Gaussian message passing. We illustrate this in Section 5. If the fractional message passing algorithm converges
then it converges to a set of messages that corresponds to a local minimum of the fractional free energy. This also implies that the mean parameters of the local approximate
marginals are exact (see Property 1. in Section 3). Note that the observations in Section 3
and Property A2 in the Appendix together with Property 3 imply that there is always a
range of  values for which the fractional free energy possesses a local minimum to which
the fractional message passing can converge.
4.3 The Damping and the Fractional Parameters
The local stability condition in (21) is independent of the damping parameter . Therefore,
it does not alter the local stability properties, it only makes the iteration slower and numerically more stable, that is, it can dampen the possible periodic trajectories of the message
passing algorithm.
The fractional parameter  characterizes the inference process and as we have seen in the
example in the previous sections, by choosing smaller s we can create local minima. In the
particular case when h = 0, there is a somewhat similar property for the message passing
updates as well. Let   R|E| be the set of messages  that lead to normalizable approximate
marginals. The set  is characterized by the model parameters |R|,  and . We reiterate
i and v j and there is a continuous bijective
that the elements of v are the local variances vij
ij
|E|

mapping between    and v  R+ given by y(v) =  + M(), unless  = K and G is
K-regular. This allows us to study q
the stability properties in terms of moment parameters
i , v j )/
v(). Let c(v, ) = [vij (, vij
ij

i v j ] be the vector of local correlations. By using
vij
ij ij

Gershgorins theorem (Horn & Johnson, 2005) and c(v, )2  c(v, ), we find that for any
eigenvalue  of 1 diag(c(v, ))M() or 1 diag(c(v, ))2 M() we have


||  max 1 c(v, ) [(nj  1) + |1  |] .
i,j

When h = 0, there are no updates in , the rhs of the above equation depends on
1 c(v, )2 (see Equations (17) and (20)) and we have lim 1 c(v, )2 = 0, thus, small
0

 values can help to achieve convergence. However, when h 6= 0 the term 1 c(v, ) is
dominating and the effects of decreasing  towards zero can be ambiguous.
17

fiCseke & Heskes

5. Experiments
We implemented both direct minimization and fractional message passing and analyzed
their behavior for different values of max (|R|). For reasons of simplicity, we set all ij s
equal. The results on an small scale model are summarized in Figure 3. Note that there
is a good correspondence between the behavior of the fractional Bethe free energies in the
direction of the eigenvalue corresponding to max (|R|) and the convergence of the Newton
method. The Newton method was started from different initial points. We experienced
that when max (|R|) > 1 and setting the initial value to v0 = t2 u2max , the algorithm
did not converge for high values of t. This can be explained by the top plots in Figure 3:
for high values of t, the initial point might not be in the convergence region of the local
minimum. For the fractional message passing algorithm we used two types of initialization:
i =
(1) when max (|R|) < 1 we set ij such that they are all normalizable by setting ij
i = 1/n ,
|Rij |ujmax /max uimax (Malioutov et al., 2006), (2) when max (|R|)  1, we used ij
i
that is, a symmetric partitioning of the diagonal elements. We set the initial messages such
that all approximate marginals are normalizable in the first step of the iteration.
We experienced a behavior similar to that described by Welling and Teh (2001) for
standard message passing, namely, fractional message passing and direct minimization either
both converge or both fail to converge. Our experiments in combination with Theorem 1
show that when max (|R|) > 1, standard message passing at best converges to a local
minimum of the Bethe free energy. If standard message passing fails to converge, one
can decrease  and search for a stationary pointpreferably a local minimumof the
corresponding fractional free energy.
It can be seen from the results in the right panels of Figure 2, that when the model is no
longer pairwise normalizable, the local minimum and not the unbounded global minimum
can be viewed the natural continuation of the (bounded) global minimum for pairwise
normalizable models. This explains why the quality of the approximation at the local
minimum for models that are not pairwise normalizable is still comparable to that at the
global minimum for models that are pairwise normalizable.

6. Conclusions
 T

As we have seen, FMF and FMF  21 v |R| v provide tight upper and lower bounds for
the Gaussian fractional Bethe free energies. It turns out that pairwise normalizability is
not only a sufficient condition for the message passing algorithm to converge, but it is also
a necessary condition for the Gaussian fractional Bethe free energies to be bounded from
below.
If the model is pairwise normalizable, then the lower bound is bounded, and both direct
minimization and message passing are converging. In our experiments both converged to
the same minimum. This suggests that in the pairwise normalizable case, fractional Bethe
free energies possess a unique global minimum.
If the model is not pairwise normalizable, then none of the fractional Bethe free energies
are bounded from below. However, there is always a range of  values for which the
fractional free energy possesses a local minimum to which both direct minimization and
fractional message passing can converge. Thus, by decreasing  towards zero, one gets
18

fiBethe Free Energies and Message Passing in Gaussian Models

&

!"

&

(

!"

)*+,(-.*/0
_(D(1"2"!3!""4
5*'6*(7_8!9
:;<*=(>;?,0

%

!"

%

!"

#

#

!"

!"

"

"

!"

!"



!"

(





"

!"

!"

!

#

!"
'

!"

$

!"

!"

Function value after convergence

Function value after convergence

6
5
4
3
2
1
0

"

!"

!

!"
'

#

$

!"

!"

2

0

10

10


7
6
5
4
3
2
1
0
1

2

10

Error in variances after convergence

Newton method
Message passing
1

10

0

10

1

10



8

7

1

(

!"

8

Error in variances after convergence

(

)*+,(-.*/0
_(D(1"2"!3!""4
5*'6*(7_8!9
:;<*=(>;?,0

2

10

0

10

0

10

10


2

Newton method
Message passing
1

10

0

10

1

2

10

0

10


10

2

10

2

10

10


2

Figure 3: The top panels show the constrained
 fractional Bethe free energies of an Gaussian model

with 8 variables in the direction v = tumax , where umax is the eigenvector corresponding to max (|R|) for max (|R|) = 0.9 (top-left) and max (|R|) = 1.1 (top-right). The
thick lines are the functions FMF (dashed), FB (dashed dotted) and the lower bound
 T

FMF  12 v |R| v (continuous). The thin lines are the constrained -fractional free
energies Fc for   [102 , 102 ]. Center panels show the final function values after the
convergence of the Newton method. The bottom panels 
show the ||  ||2 error in approximation for the single node standard deviations  = v. Missing values indicate
non-convergence.
19

fiCseke & Heskes

closer to the mean field energy and a finite local minimum will appear (Property A2 in
the Appendix). We experienced that for a suitable range of s,s and initial values the
fractional Gaussian message passing can be made to converge.
As mentioned in Section 2.1, ij s correspond to using local ij divergences when applying power expectation propagation with a fully factorized approximating distribution.
Seeger (2008) reports that when expectation propagation does not converge, applying power
expectation propagation with  < 1 helps to achieve convergence. In the case of the problem
addressed in this paper this behavior can be explained by the observation that small s
make a finite local minima more likely to occur and thus prevents the covariance matrices
from becoming indefinite or even non positive definite. Although the most common reason
for using  < 1 in EP is numerical robustness, it also implies finding the saddle point of the
-fractional EP free energy. It might be interesting to investigate whether it is the same
reason why convergence is more likely as in the case of Gaussian fractional message passing.
Wainwright et al. (2003) propose to convexify the Bethe free energy for discrete models
by choosing ij s sufficiently large such that the fractional Bethe free energy has a unique
global minimum. This strategy appears to fail for Gaussian models. Convexification makes
the possibly useful finite local minima disappear, leaving just the unbounded global minimum. In the case of the more general hybrid models, the use of the convexification is still
unclear.
The example in Section 3 disproves the conjecture in the work of Welling and Teh (2001):
even when the Bethe free energy is not bounded from below, it can possess a finite local
minimum to which the message passing and the minimization algorithms can converge.
We have shown that stable fixed points of the Gaussian fractional message passing
algorithms are local minima of the fractional Bethe free energy. Although the existence
of a local minimum does not guarantee the convergence of the message passing algorithm,
in practice we experienced that the existence of a local minimum implies convergence.
Based on these results, we hypothesize that when pairwise normalizability does not hold,
the Gaussian Bethe free energy and the Gaussian message passing algorithm ( = 1) can
have two types of behavior:
(1) the Gaussian Bethe free energy possesses a unique finite local minimum to which
optimization methods can converge by starting from, say, the mean field solution
vi = 1/Qii ; the Gaussian message passing has a corresponding unique stable fixed
point, to which it can converge with suitable starting point and sufficient damping,
(2) no finite local minimum exists, and thus, both the optimization and the message
passing algorithm diverge.
By using the fractional free energy and the fractional message passing and by varying ,
one can switch between these behaviors. Computing the critical c (|R|) for a general |R|
remains an open question. We believe that the properties of the free energies in K-regular
symmetric models (Section 3), where the critical values can be easily computed, give a good
insight into the properties of the free energies for general Gaussian models.
20

fiBethe Free Energies and Message Passing in Gaussian Models

Acknowledgments
We would like to thank Jason K. Johnson for sharing his ideas about the properties of the
message passing algorithm in K-regular models. We would also like to thank the anonymous
reviewers for their valuable comments on earlier versions of the manuscript. The research
reported in this paper was supported by VICI grant 639.023.604 from the Netherlands
Organization for Scientific Research (NWO).

Appendix A. Properties and Proofs
Lemma A1. (Watanabe & Fukumizu, 2009) For any graph G = (V, E), edge adjacency
matrix M() (defined in Section 4.1), and arbitrary vector w  R|E| , one has

Y
det I|E|  1 diag (w) M() = det I|V | + 1 A(w)
(1  wij wji ),
ij

where
Aii (w) =

X
ij

wij wji
1  wij wji

Aij (w) = 

and

wij
.
1  wij wji

Proof: We reproduce the proof in a somewhat simplified form. Let us define Uij, = eTj ,
Vij, = eTi where ek is the k th unit vector of Rn and S with


 
Sij,ij Sij,ji
0 1
,
=
Sji,ij Sji,ji
1 0
then we have M() = U V T  S. Let us define W  R|E||E| a diagonal matrix with
wij,ij = wij . Using the matrix determinant lemma this reads as

det I  1 W U V T  S

= det I + W S  1 W U V T



= det I  1 W U V T (I + W S)1 det (I + W S)


= det I  1 V T (I + W S)1 W U det (I + W S).
The (ij, ji) block of (I + W S)1 W is


1
1
wij
wij
1
0
1  wji wji wji

0
wji


=

1
1  wji wji



wij
wji wij

wij wji
wji



and thus, we can define A  V T (I + W S)1 W U such that
X wij wji
wij
Ai,i =
and Ai,j = 
.
1  wij wji
1  wij wji
ij

This completes the proof of the matrix determinant lemma (22) in Section 4.2.

21



fiCseke & Heskes

Property A1. The matrix M() = U V T  S is singular only for K-regular graphs
with  = K.
P
Proof: Let x  R|E| and y =PM()x. Then yij = kj xjk  xji . Let us fix j, then
yij = 0 for any i means that kj xjk = xji for any i. This can only hold if the graph is
K-regular,  = K and all xij s are equal or xij = 0 for all pair indices ij.

Property A2. For a suitably chosen  > 0, there exists an  such that the constrained
fractional free energy Fc possesses a local minimum for all 0 <  <  .

Proof: Let us define vM
F = argminv FM F (v) and


UM
F = {v : FM F (v)  FM F (vM F ) + 2} .

The form of FM F implies that we can always choose  such that UM
F is a proper subset of the
n

n
positive quadrant in R , in other words, UM F  R+ . Then due to the properties of FM F
(continuous and convex, with a unique finite global minimum attained at a finite value), the





domain UM
F is closed, bounded, convex and vM F  UM F \ UM F , that is, vM F is in the

n
c

interior of UM F . Since FM F and F (v) are continuous on R+ , the set UM F is closed and
bounded and lim Fc (v) = FM F (v) (pointwise convergence) for all v  Rn+ , it follows that Fc
0


c
converges uniformly on UM
F as   0. This, together with the monotonicity of F w.r.t. ,
implies that there exists  such that FM F (vM F )   < Fc (vM F ) < FM F (vM F ) for all 0 <
 . Let us fix . It is known that, since U 
 <  and all v  UM
F
M F is closed and bounded and
 ) + 2 for all

c
c
F is continuous, F attains its extrema on UM F . Since FM F (v) = FM F (vM
F
 )+
c

c

v  UM F and F (v) > FM F (v)   for all v  UM F it follows that F (v) > FM F (vM
F


c

 ).
for all v  UM F . We have chosen  such that FM F (vM F )   < F (vM F ) < FM F (vM
F
The latter two conditions imply that one of the extrema has to be a local minimum in the
 .
interior of UM

F

References
Bickson, D. (2009). Gaussian Belief Propagation: Theory and Application. Ph.D. thesis,
The Hebrew University of Jerusalem.
Cseke, B., & Heskes, T. (2008). Bounds on the Bethe free energy for Gaussian networks.
In McAllester, D. A., & Myllymaki, P. (Eds.), UAI 2008, Proceedings of the 24th
Conference in Uncertainty in Artificial Intelligence, pp. 97104. AUAI Press.
Heskes, T. (2003). Stable fixed points of loopy belief propagation are minima of the Bethe
free energy. In Becker, S., Thrun, S., & Obermayer, K. (Eds.), Advances in Neural
Information Processing Systems 15, pp. 359366, Cambridge, MA. The MIT Press.
Heskes, T., Opper, M., Wiegerinck, W., Winther, O., & Zoeter, O. (2005). Approximate
inference techniques with expectation constraints. Journal of Statistical Mechanics:
Theory and Experiment, 2005, P11015.
Heskes, T. (2004). On the uniqueness of loopy belief propagation fixed points. Neural
Computation, 16, 23792413.
Horn, R. A., & Johnson, C. (2005). Matrix Analysis. Cambridge University Press, Cambridge, UK.
22

fiBethe Free Energies and Message Passing in Gaussian Models

Jaakkola, T. (2000). Tutorial on variational approximation methods. In Opper, M., & Saad,
D. (Eds.), Advanced mean field methods: theory and practice, pp. 129160, Cambridge,
MA. The MIT Press.
Johnson, J. K., Bickson, D., & Dolev, D. (2009). Fixing convergence of Gaussian belief
propagation. CoRR, abs/0901.4192.
Malioutov, D., Johnson, J., & Willsky, A. (2006). Walk-sums and belief propagation in
Gaussian graphical models. Journal of Machine Learning Research, 7, 20312064.
Minka, T. P. (2004). Power EP. Tech. rep., Microsoft Research Ltd., Cambridge, UK,
MSR-TR-2004-149.
Minka, T. P. (2005). Divergence measures and message passing. Tech. rep. MSR-TR-2005173, Microsoft Research Ltd., Cambridge, UK.
Moallemi, C., & Roy, B. V. (2006). Consensus propagation. In Weiss, Y., Scholkopf, B., &
Platt, J. (Eds.), Advances in Neural Information Processing Systems 18, pp. 899906.
MIT Press, Cambridge, MA.
Murphy, K., Weiss, Y., & Jordan, M. I. (1999). Loopy belief propagation for approximate
inference: An empirical study. In Proceedings of the Fifteenth Conference on Uncertainty in Artificial Intelligence, Vol. 9, pp. 467475, San Francisco, USA. Morgan
Kaufman.
Nishiyama, Y., & Watanabe, S. (2009). Accuracy of loopy belief propagation in Gaussian
models. Neural Networks, 22 (4), 385  394.
Pearl, J. (1988). Probabilistic Reasoning in Intelligent Systems: Networks of Plausible Inference. Morgan Kaufman Publishers, San Mateo, CA.
Rusmevichientong, P., & Roy, B. V. (2001). An analysis of belief propagation on the turbo
decoding graph with Gaussian densities. IEEE Transactions on Information Theory,
47, 745765.
Seeger, M. W. (2008). Bayesian inference and optimal design for the sparse linear model.
Journal of Machine Learning Research, 9, 759813.
Takahashi, K., Fagan, J., & Chin, M.-S. (1973). Formation of a sparse impedance matrix
and its application to short circuit study. In Proceedings of the 8th PICA Conference.
Wainwright, M., Jaakkola, T., & Willsky, A. (2003). Tree-reweighted belief propagation
algorithms and approximate ML estimation via pseudo-moment matching. In Bishop,
C., & Frey, B. (Eds.), Proceedings of the Ninth International Workshop on Artificial
Intelligence and Statistics. Society for Artificial Intelligence and Statistics.
Watanabe, Y., & Fukumizu, K. (2009). Graph zeta function in the Bethe free energy and
loopy belief propagation. In Bengio, Y., Schuurmans, D., Lafferty, J., Williams, C.
K. I., & Culotta, A. (Eds.), Advances in Neural Information Processing Systems 22,
pp. 20172025. The MIT Press.
Weiss, Y., & Freeman, W. T. (2001). Correctness of belief propagation in Gaussian graphical
models of arbitrary topology. Neural Computation, 13 (10), 21732200.
23

fiCseke & Heskes

Welling, M., & Teh, Y. W. (2001). Belief optimization for binary networks: a stable alternative to loopy belief propagation. In Breese, J. S., & Koller, D. (Eds.), Proceedings
of the 17th Conference in Uncertainty in Artificial Intelligence, pp. 554561. Morgan
Kaufmann Publishers.
Wiegerinck, W., & Heskes, T. (2003). Fractional belief propagation. In Becker, S., Thrun,
S., & Obermayer, K. (Eds.), Advances in Neural Information Processing Systems 15,
pp. 438445, Cambridge, MA. The MIT Press.
Yedidia, J. S., Freeman, W. T., & Weiss, Y. (2000). Generalized belief propagation. In
Advances in Neural Information Processing Systems 12, pp. 689695, Cambridge, MA.
The MIT Press.
Zoeter, O., & Heskes, T. (2005). Change point problems in linear dynamical systems.
Journal of Machine Learning Research, 6, 19992026.

24

fi