Journal Artificial Intelligence Research 11 (1999) 361-390

Submitted 6/99; published 11/99

Complexity Reasoning Spatial Congruence
Matteo Cristani

Dipartimento Scientifico e Tecnologico,
Universita di Verona,
Ca Vignal 2, strada Le Grazie, I-37134 Verona

cristani@sci.univr.it

Abstract

recent literature Artificial Intelligence, intensive research effort
spent, various algebras qualitative relations used representation temporal
spatial knowledge, problem classifying computational complexity reasoning
problems subsets algebras. main purpose researches describe
restricted set maximal tractable subalgebras, ideally exhaustive fashion
respect hosting algebras.
paper introduce novel algebra reasoning Spatial Congruence, show
satisfiability problem spatial algebra MC-4 NP-complete, present
complete classification tractability algebra, based individuation three
maximal tractable subclasses, one containing basic relations. three algebras
formed 14, 10 9 relations 16 form full algebra.

1. Introduction
Qualitative spatial reasoning received increasing amount interest recent
literature. main reason this, already observed Jonsson Drakengren (1997),
probably spatial reasoning proved applicable real-world problems,
Geographical Information Systems (Egenhofer, 1991; Grigni, Papadias, & Papadimitriou,
1995), Molecular Biology (Cui, 1994).
specific stress qualitative reasoning space, observed Zimmermann
(1995), justified fact qualitative spatial relations treated eciently
quantitative counterparts, seem closer model relations
humans adopt spatial reasoning.
Even though qualitative spatial reasoning extended literature, spite
relatively short history, certain aspects discipline neglected. particular,
exhaustive computational perspective developed qualitative morphological
reasoning space. term morphological reasoning intended suggest reasoning
internal structure objects. case spatial reasoning includes
reasoning size, shape internal topology spatial regions.
purpose present work analyse complexity reasoning relations
congruence, either actual partial, spatial regions, using spatial algebra
MC-4 preliminarly analysed Cristani (1997).
algebra MC-4 Constraint Algebra (Ladkin & Maddux, 1994) qualitative
reasoning morphological relation congruence. Two spatial regions,
models documented literature, considered equivalent share
interior boundaries, namely spatial region. particular,
c 1999 AI Access Foundation Morgan Kaufmann Publishers. rights reserved.

fiCristani

relation EQ, defined Randell, Cui Cohn (1989), analogously Egenhofer
Franzosa (1991), becomes identity unique name assumption. Geometry
topology, conversely, allow kinds equivalence relations. relations weaker
identity, namely equivalence classes induce larger singletons.
simplest weakening define congruence relation. Even though,
relation studied (Borgo, Guarino, & Masolo, 1996, 1997; Cristani, 1997; Mutinelli,
1998), complexity reasoning subalgebras yet deeply investigated.
reason introduce new relation, provide algebraic structure host
relations based (in particular relations compare regions, which, even
congruent, overlapped roto-translating one interior
other), that, many cases, knowledge represent systems necessarily
includes internal structures. Consider following example.

Example 1
GIS dedicated representation geographical data industrial sites.
system, structure factories described means various attributes,
including size shape. One users wants query system opportunity
moving factory, works, present site new one. new site
prefabricated facilities already exist, problem consists deciding preserve
topological layout factory minimise costs buying new engines, substitute
cannot fit new facilities.
order reason problems system made able represent
qualitative relations old new site parts, establishing, particular whether
spatial regions occupied engines \congruent", even \congruent part"
ones chosen hosting new factory's site.
Clearly cannot use topological information, since spatial region presently occupied
engine surely disjoint region engine going occupy new
site, information insucient deciding whether new site able host
engine itself.
Though metric information involved final decision moving factory,
qualitative reasoning used initial design phase.
Figure 1 give pictorial representation one possible situation which, make
decisions, need represent spatial information topological.


algebra MC-4 used represent four basic relations built
equivalence relation congruence: consider roto-translation region x
respect region y, four possible situations arise.
least one roto-translation x coincides y. two regions
congruent.
least one roto-translation x coincides proper part y.
region x congruent proper part y.
362

fiThe Complexity Reasoning Spatial Congruence

Figure 1: pictorial representation relations analysed GIS moving
factory old new site. Note production lines new
facility may suitable hosting certain engines.

least one roto-translation coincides proper part x.
region x proper part congruent y.
None above. region x cannot perfectly overlapped.
would stress three main aspects relations.
1. relations established two spatial regions position space.
specific need regions close, particular topological relation, provided relation compatible; congruence relations
purely morphological.
2. equality two regions implies congruence. relation proper part excludes
morphological relations \congruent part". case
morphological side. region congruent part another region, even
disjoint, happen congruence, already stated point
1.
3. Even two regions size, may case regions
congruent. holds partial congruence, possible region
smaller another one cannot overlapped.
practical relevance algebra proved exhibiting many examples,
especially coming GIS. paper deal problem reasoning
congruence two-dimensional space domain. kind congruence assume
weakest one: roto-translability. Three-dimensional congruence type.
\natural" notion three-dimensional congruence isometry, much general
roto-translability. example left right hands congruent (under simplified
assumption shape size), cannot roto-translated
one. concentrate two-dimensional reasoning may
363

fiCristani

analysed terms roto-translation topological relations. analysis isometries
left work.
paper organised follows. Section 2 describes related work
developed area. Section 3 presents spatial algebra MC-4, Section 4 discusses
classification tractability found algebra. Finally, Section 5,
conclusions given.

2. Previous Work
perspective individuating primitives describe space, significant effort
lately spent, direction defining binary relations spatial regions,
may used model space qualitative terms. Moreover, natural, AI
community, use Constraint Processing reasoning binary relations.
specific attention Constraint Processing emerged Spatial Database community,
community Geographical Information Science well.
Two apparently independently developed models, shown essentially
equivalent, exist Artificial Intelligence (Randell & Cohn, 1989; Randell, Cui, &
Cohn, 1992) Spatial Database literatures (Egenhofer & Herring, 1990; Egenhofer &
Franzosa, 1991; Franzosa & Egenhofer, 1992). Artificial Intelligence model, (Randell &
Cohn, 1989; Randell et al., 1992) known RCC, acronym stands Region
Connection Calculus.
RCC model centered primitive \connection" originally suggested
Clarke (1981). Gotts (1994) Gotts, Gooday Cohn (1996) obtained
connection primitive. original framework (Randell & Cohn, 1989;
Randell et al., 1992) model formulated two versions, called RCC-5
RCC-8. RCC-5 model model cannot distinguish interior
boundary spatial region (so external connection may tangency
overlapping, example), RCC-8 model distinction possible.
Bennett (1994, 1995), used propositional logic represent RCC reasoning problems.
observed that, given propositional logic, interpreting truth values formula
spatial region, language RCC-5 sucient express satisfaction problem
semantical level. fact, however, due spatial interpretation,
non-spatial interpretation RCC-5 relations still sucient represent
truth condition semantical level found: set theory. Therefore, applied
result Cook (1971) NP-completeness classical propositional logic restricted
model RCC-5, proving deciding consistency Constraint Satisfaction Problem
(CSP) RCC-5 NP-complete problem too.
complete model RCC-8, instead, analysed terms pure set theory,
distinction boundary-connection interior-connection possible.
distinction means minimal interpretation RCC-8 still provides
correct complete representation truth conditions semantical level requires topology.
Statman (1979) proved intuitionistic logic along interpretations set theory forces
topology models sound theory. Bennett proved, thus, RCC-8 used
define truth conditions formulas intuitionistic propositional logic. Statman
(1979) proved intuitionistic propositional logic PSPACE-complete. However, since
364

fiThe Complexity Reasoning Spatial Congruence

need complete truth verification procedure, procedure constraint
processing, Bennett could reduce result, proving RCC-8 NP-complete.
results, even general negative practical purposes, encouraged
researches direction restricted models, way least certain
cases may process finite set RCC constraints polynomial fashion deterministic
machines. particular, Nebel (1995) showed reasoning basic relations
RCC-5 RCC-8 tractable problems. Renz Nebel (1999) improved results
above, showing exists maximal tractable subclass RCC-5, denoted
Hb5, formed 28 relations 32, includes basic relations, maximal
tractable subclass RCC-8, denoted Hb8 , formed 148 relations 256 including
basic relations. maximal tractable subclass A, subset constraint algebra,
problems defined tractable, problems defined proper supersets
not. results obtained similar fashion work Nebel
Burckert (1995) temporal reasoning. result Renz Nebel anyway incomplete,
since simply proved exists one maximal tractable subclass,
classify every maximal tractable subclasses RCC-5. Jonsson Drakengren (1997)
showed exist four maximal tractable subclasses RCC-5, one including
basic relations. result obtained similar fashion (Drakengren & Jonsson, 1997;
Jonsson, Drakengren, & Backstrom, 1999). complete analysis RCC-8 maximal
tractable subclasses including basic relations provided Renz (1999).
result analogous MC-4 Jonsson Drakengren result RCC-5.
MC-4 algebra, describe paper, structured way Algebra
Partially Ordered Time (PO-time algebra), studied Anger, Mitra Rodriguez.
would stress two main aspects here:
MC-4 algebra PO-time algebra algebraic structure:
discussion paper stands different interpretation PO-time algebra, even
different spatial interpretation provided Anger, Mitra Rodriguez
papers.
computational results present applied PO-time algebra
well, extend previous findings obtained Anger, Mitra Rodriguez.
particular Anger, Mitra Rodriguez (1998, 1999), proved path-consistency
insucient ensure consistency relations algebra, exists
tractable subalgebra treated O(n3 ) algorithm.
Anger, Mitra Rodriguez (1999), showed deciding consistency PO-time
network NP-complete problem reducing analogous decision problem
RCC-5.
important observations needed, respect results Anger, Mitra
Rodriguez:
results complexity PO-time algebra applied MC-4,
show MC-4 network consistent exhibit consistent scenario vertices network substituted spatial regions.
Therefore, even show correspondence PO-time algebra too,
NP-completeness result independent. Moreover, method used prove
365

fiCristani

intractability MC-4 independent well, main difference way
used exhibit problematic algebraic structure. proof derived
simple way solve problems whenever possible polynomial time.

discovery tractable subalgebras indicate M99 , M81 M72

present paper, deserves acknowledgement priority Anger, Mitra Rodriguez. However, Anger, Mitra Rodriguez classified one algebra,
tractable, maximal, since contained M99 . Moreover, algorithms
found M99 M81 substantially different one Anger, Mitra
Rodriguez present ecient, O(n2 ) instead O(n3 ). Therefore
two algorithmic solutions considered independent results well.

classification presented complete, since classify maximal tractable
subalgebras MC-4, result may applied temporal reasoning
well, since obtained means algorithms completely independent
interpretation give relations (either spatial temporal).

introduction morphological relations spatial reasoning novel too,

study spatial congruence deserves, opinion, deep investigations henceforth.
fact two algebras spatial temporal reasoning present substantial similarities novelty. RCC model corresponds subalgebras Interval
Calculus, stated Bennett (1994). Anger, Mitra Rodriguez stated
property PO-time algebra respect RCC-5, interpretation completely different own, equality PO-time interpreted EQ
RCC-5, interpret congruence.

Thus, even though similar algebraic structure partially investigated before,
present paper presents substantial methodological differences obtained results
independent extensions ones obtained Anger, Mitra Rodriguez.
remainder paper, result attributed Anger, Mitra
Rodriguez note text.

3. Spatial Algebra MC-4
section present spatial algebra MC-4, previously presented
Cristani (1997) largely analysed Mutinelli (1998).
MC-4 Binary Constraint Algebra (henceforth indicated Constraint Algebra).
Constraint Algebra Constraint Domain Algebra Base, formed
mutually exclusive relations among elements Constraint Domain, whose union
form universal relation. converse basic relation basic relation too,
composition basic relations union basic relations. Constraint
establishment one possible unions basic relations two variables
vary domain. constraint satisfied assignment one pair values
domain variables, pair values one relations constraint
itself. Given finite set constraints two variables, problem deciding
whether exists assignment variables constraints
366

fiThe Complexity Reasoning Spatial Congruence



x

x CG


x

x CGPP


x

x CNO

Figure 2: pictorial representation basic relations MC-4
CG
CGPP

CG
CG
CGPP

CGPP
CGPP
CGPP

CGPP,1
CGPP,1

CGPP,1

CGPP,1

>

CGPP,1

CNO

CNO

CGPP
CNO

CGPP,1
CNO




>

CNO
CNO
CGPP
CNO
CGPP,1
CNO

>

Table 1: composition table MC-4. symbol > represents universal relation
fCG; CGPP; CGPP,1 ; CNOg.
simultaneously satisfied referred Constraint Satisfaction Problem, henceforth
indicated CSP.
MC-4 algebra formed unions four basic relations,
established two-dimensional spatial regions, morphological point view,
respect equivalence relation congruence.
congruence relation variously interpreted geometry. interpretation
restrictive one: two regions congruent iff rigidly roto-translated
other.
region x, interpretation, may congruent (x CG y) region y, congruent
part (x CGPP y) cannot perfectly overlapped (x CNO y). relation
congruent part may inverted part congruent (y CGPP,1 x iff
x CGPP y).
Figure 2 pictorial representation three basic relations CG, CGPP CNO
given. Table 1 present composition table MC-4 showing basic relations
compose other.
367

fiCristani

x DR
x

x PO


x



-1

x PP

x PP

x EQ

x

x

x

Figure 3: pictorial representation relations RCC-5.
CSP represented Network Constraints. network constraints
labelled graph G = hV ; ; Ei, V finite set vertices, E binary relation
V whose elements called edges, labelling function maps vertex
G variable, edge relation Constraint Algebra given domain
D. Given network constraints G , problem deciding consistency G
problem establishing whether possible instantiate vertex label (the variables)
elements D, way relations represented G labels
edges simultaneously satisfied. CSP represented network G often referred to,
algebra A, A-SAT(G ). sake simplicity refer CSP represented
network G MC-4 MSAT(G ).
main result MC-4 algebra, respect MSAT, unfortunately negative
computational account. general, deciding consistency hard solve networks
constraints variables representing spatial regions, stated Theorem 2.
result already proved Cristani (1997).
Anger, Mitra Rodriguez (1998), showed path-consistency cannot applied
successfully Algebra Partially Ordered Time, isomorphic MC-4
syntactic level. insucient prove CSP algebra NP-complete.
showed (Anger et al., 1999) PO-time algebra NP-complete. proof lies
translation, shown analogous, identical,
translation
introduced here, syntactical level, completely different semantical
one. However, proof insucient show arrange spatial solutions,
since map defined purely syntactical. already observed Lemon (1996),
representation space means relation algebra pure, obtain
satisfiable networks realizable space. proof, instead, applied
spatial interpretations. applied nonlinear time temporal interpretations
well, since syntactic level shown sucient space, nonlinear time
interpreted space (Anger et al., 1999).
getting proof negative result need describe relevant
correspondences MC-4 algebra RCC-5 model, used proof
Theorem 2. well known RCC-5 algebra Constraint Algebra 5 basic relations:
EQ , DR , PO , PP , PP,1 . five relations correspond pictorial representation
Figure 3.
two spatial regions one relations MC-4, certain relations
RCC-5 established them. Conversely, certain relations RCC-5
established certain corresponding relations MC-4 are. correspondence, however,
one-to-one. Consider, instance, region x region y, x DR y,
368

fiThe Complexity Reasoning Spatial Congruence

Rel. MC-4 Rel. RCC-5
CG
CGPP
CGPP,1
CNO

fEQ; DR; POg
fPP; DR; POg
fPP,1; DR; POg
fDR; POg

Table 2: basic relations MC-4 counterparts RCC-5. meaning
Table relation MC-4 established, one relations
RCC-5 second column established well.

Rel. RCC-5 Rel. MC-4
EQ
PP
PP,1
PO
DR

CG
CGPP
CGPP,1
fCG; CGPP; CGPP,1; CNOg
fCG; CGPP; CGPP,1; CNOg

Table 3: basic relations RCC-5 counterparts MC-4.
RCC-5, namely x disjoint y. Then, relation MC-4 established
x y. However, x PP y, namely x proper part y, CGPP relation
established x y. hand, two regions congruent,
relations DR , PO EQ exist x y.
Table 3 set correspondences MC-4 basic relations RCC-5,
Table 2 set correspondences RCC-5 MC-4.
correspondences Tables suciently strict, use proving MSAT(MC-4) NP-complete problem direct polynomial reduction.
consider CSP MC-4, corresponding RCC-5 CSP intractable, since
relations obtained Table 2 define intractable subset RCC-5, means
complete classification established Jonsson Drakengren (1997). Therefore,
MSAT(MC-4) reducible RSAT(RCC-5) (the RSAT symbol represents satisfiability RCC models) corresponding relation mapping Table 2.
Conversely, establish, means Tables, among possible
regions satisfying relation CG, exists least one pair regions
EQ, CGPP established, exists one pair PP relation, finally
CNO established, two regions PO relation. summary
correspondence reported Table 4.
correspondence obtained definition basic relations. Two regions
b congruent iff roto-translate way (a) EQ b
conversely 0 0 (b) EQ a. Analogously congruent part b iff
369

fiCristani

Rel. MC-4 Rel. RCC-5
CG
CGPP
CGPP,1
CNO

EQ
PP
PP,1
PO

Table 4: basic relations MC-4 counterparts RCC-5 special mapping
.
roto-translate (a) PP b. Finally two regions CNO relation iff
PO relation disjoint.
correspondence Table 4 called
, Network Constraints G MC-4
translated RCC-5 denoted
(G ). networks labelled edges
basic relations MC-4 henceforth called scenarios MC-4.
Consider consistent scenario MC-4. Applying composition tables MC-4
RCC-5, clearly derive scenario RCC-5
(S ) consistent, scenario
MC-4 so. consequence reasoning next lemma.

Lemma 1 scenario MC-4 consistent,
(G ) consistent.
Ladkin Maddux (1994) proved network constraints consistent iff
consistent scenario. Therefore, immediate consequence Lemma 1 network
constraints G MC-4 consistent,
(G ) consistent. able prove
first theorem.

Theorem 1 MSAT(MC-4) NP-hard.
Proof

observation existence consistent scenarios Constraint Algebra due
Mackworth Freuder (1985), obtain polynomial reduction RSAT(RCC-5)
MSAT(MC-4).
suces note solve MSAT solve RCC-5 problems obtained

translation well. Now, problems mapped MC-4 RCC-5 means

trivially inverted
,1 , since
trivially one-to-one. means
problem set relations obtained RCC-5
corresponds problem MC-4,
vice versa.
set relations RCC-5 translated
contains fPP; PP,1 g PO . Nebel
Renz (1999), proved set relations RCC-5 containing two relations
intractable. Therefore set
(MC , 4) intractable.
proves able solve problem MC-4 solve problem
subset RCC-5 intractable. Therefore MSAT(MC-4) NP-hard.


370

fiThe Complexity Reasoning Spatial Congruence

Mackworth Freuder (1985) proved backtracking applied CSPs.
backtracking algorithm usually implemented linear non-deterministic technique,
therefore polynomial algorithm non-deterministic machines.
backtracking technique applicable MC-4 well, perform polynomial solution MSAT nondeterministic machines. shows MSAT NP,
allows us claim:

Theorem 2 MSAT(MC-4) NP-complete.
negative result deep investigation needed define tractable subclasses set 16 relations allow us perform polynomial analysis least
subset networks constraints definable MC-4.
paper give definition three maximal tractable subclasses MC4, exhibiting therefore complete classification tractability algebra. three
maximal tractable subclasses already studied Anger, Mitra Rodriguez
(1999). obtain maximality algebras, exhibited O(n3 ) algorithms.
three main differences respect paper:
1. number classes individuated lower theirs, found four
maximal tractable subclasses. failed note one four subalgebras
subset another one. Table 10 subalgebra M88 corresponds fourth
algebra Anger, Mitra Rodriguez. subalgebra tractable, maximal.
2. algorithms exhibit O(n2 ) Anger, Mitra Rodriguez exhibited
O(n3 ) algorithm one three maximal subsets.
3. classification complete. Thus subset MC-4 subset one
three maximal tractable subalgebras individuated intractable. Anger, Mitra
Rodriguez find result, since analyse subalgebras
PO-time algebra, MC-4.

4. Maximal Tractable Subclasses MC-4

Given subset constraint algebra A, indicate Sb set formed
relations written expressions algebra involving elements
operations composition, intersection converse relations. set
often called transitive closure respect operations above. refer
closure . set coincides closure called subalgebra.
previous section recall result NP-completeness MC-4. first
important observation complexity subalgebras that, subalgebra B
contain empty relation, network constraints B cannot entail strict
contradiction: consistent. far, problem necessarily polynomially solvable,
O(1). stated next lemma.

Lemma 2 Given algebra A, subalgebra B contain empty relation,
SAT(B) polynomial.

371

fiCristani

main consequence Lemma 2 limit analysis
subalgebras MC-4 subalgebras contain empty relation.
Moreover, since network constraints represents relations implicit way,
edge network labelled interpret representing universal
relation. Therefore, universal relation member subalgebras
interested in. call algebras contain empty universal
relations expressive algebras.
102 expressive subalgebras, denominate Mi varies 0
101. Tables 5, 6, 7, 8, 10, 9 Appendix A, 102 expressive subalgebras MC-4
listed.

Lemma 3 Given subset MC-4, expressive subalgebra iff one
subalgebras Mi 0 101 .

Proof

Consider subset MC-4. test closure LISP program computes
closure composition, intersection converse subset MC-4, test
presence empty universal relation obvious membership test. LISP
procedure TRANSITIVE-CLOSURE listed Online Appendix 1, accompanies
article. test succeeds subalgebras Mi 0 101 fails
216 , 102 = 65434 subsets MC-4. claim therefore proved.


following technical lemma shows 102 subalgebras individuated
NP-hard. 20 subalgebras 102 intractable Lemma
4. algebras presented Table 5 Appendix A. proof Lemma 5 trivial
consequence proof Theorem 2.

Lemma 4 Given subalgebra MC-4, contains relations CNO fCGPP;
CGPP,1 g MSAT(A) NP-hard.
next three subsections show three maximal tractable subclasses MC-4
found, intractable algebras 20 listed Table 5 Appendix A.

4.1 CG -complete Subalgebra M72

5 tractable, Jonsson Drakengren (1997) observed
proving class R28
subalgebra RCC-5 containing relations including EQ tractable.
result applies MC-4 respect relation CG, relations CNO,
fCGPP; CGPP,1g, fCG; CNOg, fCG; CGPP; CGPP,1g.
relevant cases CG , CNO fCGPP; CGPP,1 g , since two
cases included two former three. algebra formed relations
contain CG relation ? tractable, obtain inconsistency
iff explicitly edge labelled ? network. Deciding consistency
therefore O(n2 ) problem.

372

fiThe Complexity Reasoning Spatial Congruence

ALGORITHM M72-CONSISTENCY
constraint network M72

INPUT:

OUTPUT:

1.

2.

Yes solution formed spatial regions R2 , not.



edge , hx; yi
label hx; ?

return inconsistency

Loop

Return consistency
Figure 4: Algorithm M72-consistency.

M72 = f?, CG, fCG; CGPPg, fCG; CGPP,1g, fCG; CNOg, fCG; CGPP; CGPP,1g,
fCG; CGPP; CNOg, fCG; CGPP,1; CNOg, >g.
Since contradiction derives relation M72 except ?, Algorithm M72 -consistency
(see Figure 4) solves consistency checking problem network constraints M72 .
Thus claim following theorem:

Theorem 3 Algorithm M72 -consistency correctly decides consistency network
constraints M72 O(n2 ) time n number vertices .
immediate consequence Theorem 3 following theorem:

Theorem 4 MSAT(M72 ) polynomial.
subalgebras included M72 Table 6 Appendix A.
13 subalgebras Table 6 subalgebras theoretically
obtained based method incorporated Algorithm M72 -consistency. algorithm applied subalgebras formed relations containing symmetrical
relation MC-4 empty relation. prove polynomiality
subalgebras relations containing CNO, containing fCGPP; CGPP,1 g, subalgebras exist. subalgebra formed relations containing CNO empty relation
M78 , subalgebra formed relations containing fCGPP; CGPP,1 g M31 .
Table 7 Table 8 Appendix subalgebras M78 M31 shown.
next subsection introduce maximal tractable subclass includes M78 ,
subsection 4.3 introduce algebra containing M31 , proof tractability subalgebras Tables 7 8 derived tables well. Conversely,
subalgebra M72 neither subalgebra M99 subalgebra M81 , Theorem 3
independent result.
373

fiCristani

4.2 Maximal Tractable Subclass M99

look maximal tractable subalgebra containing basic relations. best
candidate, based Table 5, M99 , algebra formed 13
relations polynomial, show NP-hard reducing
intractable problem RCC-5.
M99 = f?, CG, CGPP, CGPP,1, CNO, fCG; CGPPg, fCG; CGPP,1g, fCG; CNOg,
fCGPP; CNOg, fCGPP,1 ; CNOg, fCG; CGPP; CNOg, fCG; CGPP,1; CNOg, >g.
Fortunately, prove tractability M99 , maximal based fact
algebras containing basic relations either intractable Table 5 subsets
M99 .
Consider subset M99 ,
G99 = ffCG; CGPPg, fCG; CNOg, fCGPP; CGPP,1; CNOgg.
following claim holds.

Lemma 5 Gd99 = M99 .
Proof

following expressions represent valid implementations relations M99 using
elements G99 operators composition, intersection converse.
t.1.

?

= fCG; CGPPg

t.2.

CG

fCG; CNOg
fCGPP; CGPP,1; CNOg
= fCG; CGPPg fCG; CGPPg ^



t.3.

CGPP

= fCG; CGPPg fCGPP; CGPP,1 ; CNOg

t.4.

CGPP,1

= fCG; CGPPg ^ fCGPP; CGPP,1 ; CNOg

t.5.

CNO

= fCG; CNOg fCGPP; CGPP,1 ; CNOg

t.6.

>

= fCG; CGPPg
fCGPP; CGPP,1 ; CNOg

t.7.

fCG; CGPP,1g

= fCG; CGPPg ^

t.8.

fCGPP; CNOg

= (fCG; CGPPg

t.9.

fCGPP,1; CNOg

t.10. fCG; CGPP; CNOg


fCG; CNOg )
fCGPP; CGPP,1; CNOg
= (fCG; CGPPg ^
fCG; CNOg )
fCGPP; CGPP,1; CNOg
= fCG; CGPPg
fCG; CNOg

t.11. fCG; CGPP,1 ; CNOg

= fCG; CGPPg ^
fCG; CNOg
374

fiThe Complexity Reasoning Spatial Congruence


network constraints M99 , implemented means Lemma 5 denoted henceforth 99 (T ).
derive contradiction network constraints iff network derives two
relations R1 R2 , one pair vertices R1 \ R2 = ?. ways
contradiction derived networks labelled relations M99 , based
intersections relations (except empty relation obviously generates contradiction itself) are:
a)
b)
c)
d)
e)
f)
g)
h)
i)
l)
m)
n)

CG
CG
CG
CG
CGPP
CGPP
CGPP
CGPP
CGPP
CGPP
CNO
fCG; CGPPg














CGPP
CNO
fCGPP; CNOg
fCGPP; CGPP,1; CNOg
CGPP,1
CNO
fCG; CGPP,1g
fCG; CNOg
fCGPP,1 ; CNOg
fCG; CGPP,1; CNOg
fCG; CGPPg
fCGPP,1 ; CNOg

simply obtained considering pairs relations M99 whose intersection
empty.
G99 contradictions only:
fCG; CGPPg fCG; CGPPg ^ fCGPP; CGPP,1; CNOg
fCG; CGPPg fCG; CNOg fCGPP; CGPP,1 ; CNOg .
Henceforth represent relation fCG; CGPPg -, relation fCG; CNOg ./
relation fCGPP; CGPP,1 ; CNOg 6. Since path labels corresponds representation - pair vertices path,
./ = -, possible expressions contradictions G99 (-n
-,n) 6 (-n

-,(n,k)
./
-,k ) 6. Hence, cycle (-n
-,n) called --cycle, cycle
(-n
-,(n,k)
./
-,k ) called quasi --cycle. graph representation
two different contradictory situations G99 showed Figure 5. --cycle quasi
--cycle, M99 force elements involved cycle relation CG .
show contradictions represented G99 contradictions
obtained implementation suggested Lemma 5. important,
may perform consistency checking simply checking cycles. result
stated next lemma.

Lemma 6 Given network constraints M99 , inconsistent iff 99(T ) contains
either --cycle quasi --cycle, two vertices one cycle connected edge
labelled 6.
375

fiCristani

Proof (Sketch)

Case case, contradictions a) n), table above, generate one
two situations claim.
example, contradiction a) CG CGPP , generates
(fCG; CGPPg
fCG; CGPPg ^ ) (fCG; CGPPg fCGPP; CGPP,1 ; CNOg )
--cycle two vertices connected edge labelled 6, stated
claim. cases behave way easily checked
reader.
Conversely, contradiction derives one possible implicit ways representing relations M99 , implementation produces one cases claim.
particular that, M99 , CGn = CG , CGPPn = CGPP , (CGPP,1 )n = CGPP,1 ,
fCG; CGPPgn = fCG; CGPPg fCG; CGPP,1 gn = fCG; CGPP,1g idempotent relations. cases implicitness obtained considering
14 14 = 196 pairs relations M99 , composing intersecting them. implicit cases
arising thus listed below.
i.1.

CG

= fCG; CGPPgn fCG; CGPP,1 gn

i.2.

CG

= fCG; CGPPgn fCG; CNOg

i.3.

CGPP

= fCG; CGPPgn fCGPP; CNOg

i.4.

CNO

= fCG; CNOg fCGPP; CNOg

i.5.

CNO

= fCGPP; CNOg fCGPP,1 ; CNOg

i.6.

CNO

= fCGPP; CNOg fCG; CGPP,1 ; CNOg

i.7.

fCG; CNOg

= fCG; CGPP; CNOg

i.8.

fCGPP; CNOg

= CGPPn
CNO

i.9.

fCGPP; CNOg

= CGPPn
fCG; CNOg

fCG; CGPP,1; CNOg



i.10. fCGPP; CNOg

= CGPPn
fCG; CGPP; CNOg

i.11. fCGPP; CNOg

= fCG; CGPPgn
CNO

i.12. fCGPP; CNOg

= fCG; CGPP; CNOg

fCGPP; CGPP,1; CNOg
i.13. fCG; CGPP; CNOg = fCG; CGPPgn
fCG; CNOg



Readers may directly express G99 relations along corresponding
376

fiThe Complexity Reasoning Spatial Congruence

Figure 5: Contradictions G99 : fg indicates ? R, S, respectively fCG; CGPPg,
fCG; CNOg fCGPP; CGPP,1; CNOg.
relation producing contradiction M99 immediately verify existence -cycles quasi --cycle one pair vertices connected edge labelled 6
generated graphs.
example express CG implicit relation i.1. table (formed
relations G99 ), CGPP implicit relation i.3. fCGPP; CNOg 99 t.8.,
consider contradiction CG CGPP obtain quasi --cycle two vertices
connected edge labelled 6. Similarly derive cases.



exhibit algorithm looks --cycles quasi --cycles,
checks pairs cycle connected edge labelled 6.
Figure 7 algorithm able solve Consistency Checking Problem networks
constraints labelled relations M99 presented. Based Lemma 6 prove
following theorem.
Theorem 5 Algorithm M99-CONSISTENCY correctly decides consistency network constraints M99 O(n2 ) steps n number vertices .

Proof

Lemma 6 ensure correctness Algorithm M99-CONSISTENCY. complexity algorithm derived fact computation strongly
377

fiCristani

Figure 6: Contradictions M99 : R, S, respectively indicate fCG; CGPPg,
fCG; CNOg fCGPP; CGPP,1; CNOg. Letters a) n) refer
table page 375.
378

fiThe Complexity Reasoning Spatial Congruence

ALGORITHM M99-CONSISTENCY
constraint network M99

INPUT:

OUTPUT:

1.
2.
3.
4.
2.

Yes solution formed spatial regions R2 , not.

Translate generator set Lemma 5
Look cycles labelled - one ./
Check whether edges two vertices one cycle labelled 6
otherwise return no.
Substitute vertices cycle one vertex.
cycles go Step 2., otherwise return yes.
Figure 7: Algorithm M99-consistency

connected components O(e) problem e number edges network.
99 implementation adds, worst case, O(e0 ) edges, e0 number
edges , therefore number edges 99 (T ) O(2 e0 ), O(n2 ).



immediate consequence Theorem 5 following theorem:

Theorem 6 MSAT(M99 ) polynomial.
subalgebras MC-4 included M99 Table 10 Appendix A.

4.3 Maximal Tractable Subclass M81

problem deciding consistency network constraints MC-4 tractable,
means Tables 6, 7, 8 10 85 subalgebras. remainder formed 17
subalgebras, either tractable intractable. set
M81 = f ?, CG, CGPP, CGPP,1, fCG; CGPPg, fCG; CGPP,1g, fCGPP; CGPP,1g,
fCG; CGPP; CGPP,1g, fCGPP; CGPP,1 ; CNOg, >g
contains subalgebras, M81 tractable algebras well.
analogy schema previous section look small generator set
M81 . G81 = ffCG; CGPPg, fCG; CGPP; CGPP,1 g, fCGPP; CGPP,1 ; CNOgg.
following lemma states properties M81 respect G81 .
Lemma 7 Gd81 = M81 .

Proof

following expressions represent valid implementations relations M81 using
elements G81 operators composition, intersection converse.
379

fiCristani

r.1. ?

= fCG; CGPPg fCG; CGPPg

r.2. CG

= fCG; CGPPg fCG; CGPPg ^

r.3. CGPP

= fCG; CGPPg fCGPP; CGPP,1 ; CNOg

r.4. CGPP,1

= fCG; CGPPg ^ fCGPP; CGPP,1 ; CNOg

r.5. fCG; CGPP,1 g

= fCG; CGPPg ^

fCGPP; CGPP,1 ; CNOg

r.6. fCGPP; CGPP,1 g = fCG; CGPP; CGPP,1 g

fCGPP; CGPP,1 ; CNOg

^



= fCG; CGPPg
fCGPP; CGPP,1 ; CNOg

r.7. >


implementation relations M81 described Lemma 7 denoted 81 .
contradictions M81 next table.
a)
b)
c)
d)
e)

CG
CG
CG
CGPP
CGPP







CGPP
fCGPP; CGPP,1g
fCGPP; CGPP,1; CNOg
CGPP,1
fCG; CGPP,1g

possible contradiction G81

fCG; CGPPg fCG; CGPPg ^ fCGPP; CGPP,1; CNOg
corresponds --cycle two vertices connected edge labelled 6.
Lemma 8 Given network constraints M81 , inconsistent iff 81(T ) contains
--cycle two vertices one cycle connected edge labelled 6.
Proof (Sketch)

Case case, contradictions a) e), table above, generate one
two cases claimed here.
example, contradiction CG fCGPP; CGPP,1 g , implemented
(fCG; CGPPg fCG; CGPPg ^ ) (fCG; CGPP; CGPP,1 g
fCGPP; CGPP,1; CNOg )
--cycle two vertices connected edge labelled 6, stated
claim. cases behave way easily checked
reader.
possible ways representing implicit relations provided schema
81 . Therefore claim proved.
380

fiThe Complexity Reasoning Spatial Congruence

Figure 8: Contradictions M81 .
R, S, respectively indicate fCG; CGPPg,
,
1
fCG; CGPP; CGPP g, fCGPP; CGPP,1; CNOg. Letters a) e) refer
table page 380.

ALGORITHM M81-CONSISTENCY
constraint network M81

INPUT:

OUTPUT:

1.
2.
3.
4.
2.

Yes solution formed spatial regions R2 , not.

Translate generator set Lemma 7
Look cycles labelled Check whether edges two vertices one cycle labelled 6
otherwise return no.
Substitute vertices cycle one vertex.
cycles go Step 2., otherwise return yes.
Figure 9: Algorithm M81-consistency
381

fiCristani


Figure 9 algorithm presented solves problem consistency checking
subalgebra M81 . show, particular, following claim.

Theorem 7 Algorithm M81-CONSISTENCY correctly decides consistency network constraints M81 O(n2 ) steps n number vertices .
Proof

Lemma 8 ensure correctness Algorithm M81-CONSISTENCY. complexity algorithm derived fact computation strongly
connected components O(e) problem e number edges network.
81 implementation adds, worst case, O(e0 ) edges, e0 number
edges , therefore number edges 81 (T ) O(2 e0 ), clearly O(n2 ).


immediate consequence Theorem 3 following

Theorem 8 MSAT(M81 ) polynomial.
subalgebras included M81 Table 9 Appendix A.

5. Conclusions

presented classification tractability complete spatial algebra MC-4.
classification states exist three maximal tractable subalgebras M72 , M99
M81 include 92 102 expressive subalgebras MC-4.
interest complete classifications tractability, already observed Jonsson
Drakengren (1997), determined need definition boundary
tractable intractable problems. Nebl (1999) suggested knowledge
boundary used either preprocessing step way structure backtracking
search algebras.
provision complete classification one step researching constraint
algebras. next step individuation useful heuristics give improvements
performances various techniques. currently exploiting use techniques
association techniques based classification presented paper obtain
ecient reasoning algorithms used practice. Preliminary results pathconsistency encouraging, cannot yet guarantee percentage improvement,
since algebra MC-4 simply structured networks randomly chosen
hard obtain case inconsistency detectable path-consistency.

Acknowledgements

would thank Elena Mutinelli developed Laurea Thesis (Mutinelli, 1998)
theme complexity reasoning congruence first discussed preliminary
382

fiThe Complexity Reasoning Spatial Congruence

results used developing classification paper. work
relevant reaching results.
would thank Bernhard Nebel important observations made
student mine, Alessandro Fin, improved work. thanks go Jochen
Renz discussions early stages work.
would thank anonymous referees Journal Artificial Intelligence
Research careful comments suggestions allowed make
presentation simpler systematical. proofs paper
rewritten thanks suggestions.
Finally would thank Tony Cohn reading near final version. comments
useful enhancing scientific literary quality paper.
work developed context National Project, MURST ex 40%
\Metodologie e tecnologie per la gestione di dati e processi su reti internet ed intranet"
(Methods technologies data process management internet intranet)
directed L. Tanca.

383

fiCristani

Appendix A. Tables 102 subalgebras MC-4

section present subalgebras MC-4 organized separated tables depending
characteristics. particular Table 5 shows subalgebras intractable
Lemma 4, Table 6 tractable Theorem 3, Tables 7, 8
Algorithm used Theorem 3 applied (which including CNO
fCGPP; CGPP,1g ). Table 10 subalgebras included M99 displyed,
Table 9 present subalgebras included M81 .
Rel.

Alg.

M30
M43
M44
M46
M54
M56
M67
M77
M83
M84
M85
M89
M90
M92
M93
M95
M97
M98
M100
M101



CG
CGPP
CGPP,1
CNO



























































































































































































































Table 5: subalgebras MC-4 containing relations CNO fCGPP; CGPP,1 g

384

fiThe Complexity Reasoning Spatial Congruence



Rel. CG

Alg.

M0
M1
M3
M5
M9
M12
M18
M22
M25
M34
M38
M63
M72

CGPP
CGPP,1
CNO















M2
M6
M10
M15
M24
M28
M37
M39
M47
M58
M64
M78





































CGPP
CGPP,1
CNO








































































Table 6: subalgebras MC-4 contained M72 .

Rel. CG

Alg.








































Table 7: subalgebras MC-4 contained M78 contained M72 .
385

fiCristani



Rel. CG

Alg.

CGPP
CGPP,1
CNO






















Table 8: subalgebras MC-4 contained M31 contained M72 M78 .
M4
M13
M16
M31

Rel. CG

Alg.

M11
M20
M21
M23
M29
M32
M33
M35
M42
M45
M55
M59
M60
M66
M70
M74
M81

CGPP
CGPP,1
CNO





























































































































Table 9: subalgebras MC-4 contained M81 contained M99 M72
M78 M31 .

386

fiThe Complexity Reasoning Spatial Congruence



Rel. CG

Alg.

CGPP
CGPP,1
CNO




































































































































Table 10: subalgebras MC-4 contained M99 contained M72 M78
M31 .
M7
M8
M14
M17
M19
M26
M27
M36
M40
M41
M48
M50
M51
M52
M57
M61
M62
M65
M68
M69
M71
M73
M75
M76
M79
M80
M82
M86
M87
M88
M91
M94
M96
M99








































387

fiCristani

References
Anger, F., Mitra, D., & Rodriguez, R. (1998). Temporal Constraint Networks Nonlinear
Time. Workshop Notes Spatial Temporal Reasoning ECAI98 Brighton,
UK.
Anger, F., Mitra, D., & Rodriguez, R. (1999). Satisfiability Nonlinear Time: Algorithms
Complexity. Proceedings Florida Artificial Intelligence Research Society
conference Orlando (USA).
Bennett, B. (1994). Spatial reasoning propositional logic. Doyle, J., Sandewall, E.,
& Torasso, P. (Eds.), Proceedings 4th International Conference Principles
Knowledge Representation Reasoning (KR-94), pp. 165{176. Morgan Kaufmann,
San Francisco, CA, USA.
Bennett, B. (1995). Carving Space: Existential Axioms Formal Theory Spatial
Regions. Proceedings IJCAI 95 Workshop Spatial Temporal Reasoning
Montreal.
Borgo, S., Guarino, N., & Masolo, C. (1996). Pointless Theory Space Based
Strong Connection Congruence. Aiello, L. C., & Doyle, J. (Eds.), Proceedings
6th International Conference Principles Knowledge Representation
Reasoning (KR-96). Morgan Kaufmann, San Francisco, CA, USA.
Borgo, S., Guarino, N., & Masolo, C. (1997). Ontological Theory Physical Objects.
Ironi, L. (Ed.), Proceedings Eleventh International Workshop Qualitative
Reasoning (QR 1997), pp. 223{231 Cortona, Italy.
Clarke, B. L. (1981). Calculus Individuals Based \Connection". Notre Dame
Journal Formal Logic, 22, 204{218.
Cook, S. A. (1971). complexity theorem-proving procedures. Proceedings
3rd Symposium Theory Computation, pp. 151{158.
Cristani, M. (1997). Morphological Spatial Reasoning: Preliminary Report. Tech. rep.
08/97, LADSEB-CNR Padova (Italy).
Cui, Z. (1994). Using interval logic order assembly. Proceedings Second International Conference Intelligent Systems Molecular Biology, pp. 103{111. AAAI
Press.
Drakengren, T., & Jonsson, P. (1997). Twenty-one large tractable subclasses Allen's
algebra. Artificial Intelligence, 93 (1-2), 297{319.
Egenhofer, M. J. (1991). Reasoning binary topological relations. Gunther, O., &
Schek, H. J. (Eds.), Advances Spatial Databases-Second Symposium SSD '91, No.
525 Lecture Notes Computer Science, pp. 143{160. Springer-Verlag, New York,
NY, USA.
388

fiThe Complexity Reasoning Spatial Congruence

Egenhofer, M. J., & Franzosa, R. (1991). Point-Set Topological Spatial Relations. International Journal Geographical Information Systems, 5 (2), 161{174.
Egenhofer, M. J., & Herring, J. (1990). Mathematical Framework Definition
Topological Relationships. Fourth International Symposium Spatial Data
Handling, pp. 803{813 Zurich, Switzerland.
Franzosa, R., & Egenhofer, M. J. (1992). Topological Spatial Relations Based Components Dimensions Set Intersections. SPIE's OE/Technology '92-Vision
Geometry Boston, ,USA.
Gotts, N. M. (1994). Far \C"? defining \Doughnut" Using Connection
Alone. Doyle, J., Sandewall, E., & Torasso, P. (Eds.), Proceedings 4th
International Conference Principles f Knowledge Representation Reasoning
(KR-94), pp. 246{257. Morgan Kaufmann, San Francisco, CA, USA.
Gotts, N. M., Gooday, J. M., & Cohn, A. G. (1996). Connection Based Approach
Commonsense Topological Description Reasoning. Monist: International
Journal General Philosofical Inquiry, 79 (1).
Grigni, M., Papadias, D., & Papadimitriou, C. (1995). Topological Inference. Mellis, C.
(Ed.), Proceeding 14th International Joint Conference Artificial Intelligence
(IJCAI-95), pp. 901{906 Montreal, PQ, Canada. Morgan Kaufmann.
Jonsson, P., & Drakengren, T. (1997). Complete Classification Tractability Spatial Theory RCC-5. Journal Artificial Intelligence Research, 6, 211{221. Research
Note.
Jonsson, P., Drakengren, T., & Backstrom, C. (1999). Computational complexity relating
time points intervals. Artificial Intelligence, 109 (1-2), 273{295.
Ladkin, P., & Maddux, R. (1994). Binary Constraint Problems. Journal ACM,
41 (3), 435{469.
Lemon, O. J. (1996). Semantical Foundations Spatial Logics. Aiello, L. C., & Doyle, J.
(Eds.), Proceedings 6th International Conference Principles f Knowledge
Representation Reasoning (KR-96). Morgan Kaufmann, San Francisco, CA, USA.
Mackworth, A., & Freuder, C. (1985). complexity polynomial network consistency algorithms constraint satisfation problems. Artificial Intelligence, 25 (1),
65{74.
Mutinelli, E. (1998). Sviluppo ed Analisi di Algoritmi per il Ragionamento Spaziale Qualitativo con Reti di Vincoli. Laurea thesis, Universita di Verona. Italian.
Nebel, B. (1995). Computational properties qualitative spatial reasoning: First results.
Advances artificial intelligence (KI-95), pp. 233{244 Bielefeld, Germany. SpringerVerlag, New York, NY, USA.
389

fiCristani

Nebel, B. (1999). Observations complexity reasoning constraint algebras.
Personal communication A. Fin M. Cristani.
Nebel, B., & Burckert, H. J. (1995). Reasoning temporal relations: maximal
tractable subclass Allen's interval algebra. Journal ACM, 42 (1), 43{66.
Randell, D. A., & Cohn, A. G. (1989). Modelling topological metrical properties
physical processes. Brachman, R. J., Levesque, H. J., & Reiter, R. (Eds.),
Proceedings 1st International Conference Knowledge Representation
Reasoning (KR-89), pp. 55{66 Toronto, ON, Canada. Morgan Kaufmann.
Randell, D. A., Cui, Z., & Cohn, A. G. (1992). spatial logic based regions
connection. Swartout, B., & Nebel, B. (Eds.), Proceedings 3rd International
Conference Principles Knowledge Representation Reasoning (KR-92), pp.
165{176 Cambridge, MA, USA. Morgan Kaufmann.
Renz, J. (1999). Maximal Tractable Fragments Region Connection Calculus:
Complete Analysis. Proccedings 17th International Conference Artificial
Intelligence (IJCAI 99).
Renz, J., & Nebel, B. (1999). complexity qualitative spatial reasoning: maximal
tractable fragment Region Connection Calculus. Artificial Intelligence, 108 (12), 69{123.
Statman, R. (1979). Intuitionistic logic polynomial-space complete. Theoretical Computer
Science, 9 (1), 67{72.
Zimmermann, K. (1995). Measuring without Measures: -Calculus. Proceedings
International Conference Spatial Information, pp. 59{67.

390


