journal artificial intelligence

submitted published

variational inference procedure allowing internal
structure overlapping clusters deterministic
constraints
dan geiger

dang cs technion ac il

computer science dept technion
haifa israel

christopher meek

meek microsoft com

microsoft microsoft corporation
redmond wa usa

ydo wexler

ywex cs technion ac il

computer science dept technion
haifa israel

abstract
develop novel called vip structured variational approximate
inference extends known allow efficient multiple potential
updates overlapping clusters overcomes difficulties imposed deterministic
constraints convergence proven applicability demonstrated
genetic linkage analysis

introduction
probabilistic graphical elegant framework represent joint probability distributions compact manner independence relationships random variables
nodes graph represented absence arcs model
intuitively appealing presentation naturally enables design efficient generalpurpose computing marginal probabilities called inference
general inference np hard cooper dagum luby
although many cases model small precisely small
treewidth exact inference feasible others time
space complexity makes use infeasible cases fast yet
accurate approximations desired
focus variational powerful tool efficient approximate inference
offers guarantees form lower bound marginal probabilities
family approaches aims minimize kl divergence distribution q
target distribution p finding best distribution q family distributions
inference feasible particular joint distribution p x set
discrete variables x goal compute marginal probability p
x assume exact computation feasible idea replace
p distribution q used compute lower bound p
c

ai access foundation rights reserved

figeiger meek wexler

let h x jensens inequality get following bound
log p log

x
h

q h

p h x
p h

q h log
q h p h
q h
q h
h

denotes kl divergence two probability distributions quantity q p often called free energy p q possibly un normalized
distributions variational techniques aim choose distribution q lower
bound high possible equivalently kl divergence q h
p h minimized
variational approaches mean field generalized mean field structured
mean field differ respect family approximating distributions
used structural mean field subsuming remaining approaches
special cases several authors guided work saul jordan
ghahramani jordan wiegerinck bishop winn
contributions threefold first develop extension
wiegerinck call vip allows set potentials
approximating distribution q updated simultaneously even clusters q overlap vip n fold faster wiegerincks n n grid
yields two orders magnitude improvement large graphs genetic linkage
analysis model large pedigrees note simultaneous updates first presented
phylogenic trees jojic et al second prove convergence vip previous variational methods via novel proof method properties kl divergence
third extend vip allow deterministic constraints model demonstrate
applicability extension genetic linkage analysis

background
background section primarily weigerinck
turn builds pioneering works papers saul jordan ghahramani
jordan review provides exposition material
denote distributions p x q x related un normalized distributions
p x p x q x q x let
x finite set variables x instantiation
q
variables let p x zp di di projection instantiation
x variables di x non negative function commonly called
potential constant zp normalizes product potentials subsets di ii
allowed overlap often suppress arguments potential distribution
instead di p instead p x
goal distribution q minimizes q
kl divergence q p
constrain q form q x z q j j cj zq normalizing
constant c cj possibly overlapping subsets x call clusters finding optimum q however difficult modest common goal
devising iterative converging iteration kl divergence
approximating distribution q p decreases unless q stationary point
throughout define q w u w u instantiations u u q u
consequently terms equality q w u q u q w u well defined even


fia variational inference procedure

p
q u moreover convention maintains properties
w u q w u



q w z u q w z u q z u w u z z u w z u note
q x log q x whenever q x thus kl divergence
q p

x

q x log

x

q x
p x

finite p x q x instance x
starting point developed wiegerinck finds
distribution q follows iterates clusters cj instantiations cj
update potentials j cj ej cj via following update equation

j cj

x

x

q ck cj log k ck

k gkj ck cj

x

x

q di cj log di



fij di cj

gkj fij two indicator functions defined via gkj q ck cj q ck
every instance cj cj otherwise fij q di cj q di every instance
cj cj otherwise wiegerinck proved convergence stationary point lagrangians throughout call iterative procedure wiegerincks

wiegerincks relies step compute conditional
probabilities q ck cj q di cj un normalized distribution q represented
set potentials j cj accomplished inference
bucket elimination sum product described dechter

q
kschischang frey loeliger important note q x j j cj
computation conditionals affected multiplying j constant

wiegerincks generalizes mean field mf generalized
mean field gmf xing jordan russell mean field special case wiegerincks cj contains single
variable similarly generalized mean field special case cj
disjoint subsets variables cj disjoint clusters formula j eq
simplifies gmf equations follows first term drops
j cj

x

x

q di cj log di



fij di cj

term q di cj made explicit cj disjoint clusters bishop winn
particular set di cj partitions dik di cj ck q
k j
k j note dik di ck notation q di cj k q dki
q dki whenever dik factorization simplifies formula j
follows
x
x x
j cj
q
q dji log di

fij di

dij



figeiger meek wexler

simplification achieved automatically bucket elimination computing
j iterated sums eq fact buckets formed bucket elimination
cj disjoint
eq requires repeated computation quantities q ck cj q di cj repetition significant could many indices k q ck cj q ck
many indices q di cj q di computations share many subcomputations therefore reasonable add data structure facilitate efficient
implementation function calls particular possible save computations
sets c cj form junction tree
set clusters c cj forms junction tree iff exists set trees jt one node called cj cluster variables cj every two nodes ci
cj jt connected path jt node ck path
ci cj ck holds set trees mean undirected graph necessarily
connected cycles note definition allows junction tree disconnected graph

q
q c cj form junction tree q x decomposable form
q x j j cj e e se j marginals subsets cj x
e marginals intersections se ci cj one two neighboring clusters
junction tree jensen
wiegerinck enhanced basic maintains
consistent
junction
p
p
tree jt distribution q x consistency means cj ck j ck cj k
every two clusters consistent junction tree potential j cj proportional
q cj update potential may yield inconsistent junction
tree however consistency maintained applying distributeevidence j jensen
update potential procedure distributeevidence j accepts
input consistent junction tree cluster marginal j cj updates
potential every neighboring cluster ck cj via
cj ck

j cj

cj ck

j cj

p
k ck

k ck p



neighboring cluster recursively propagates update applying eq
neighbors except one update came output procedure
consistent junction tree clusters j possibly un normalized
marginal probability q cj conditional probability q x cj remains
unchanged jensen pp
wiegerincks enhanced uses junction tree iteratively updates
potential cluster node junction tree potentials clusters
separators however since junction tree may consistent update
applies procedure distributeevidence j junction tree
update note description omits normalization step wiegerinck
needed convergence
time consuming computation variational computing conditional probabilities form q ck cj q di cj distinguish among conditional probabilities follows



fia variational inference procedure

definition conditional probability q cj subsumed q set target variables subset cluster ck q e cj ck
wiegerincks enhanced substantial computational benefits conditional probabilities subsumed cases needed quantities eq q di cj
q ck cj obtained mere lookup junction tree one call
distributeevidence made update
weigerincks basic enhanced assume structure j namely
hold tables j explicit entry every instantiation cj since
computations q ck cj q di cj grow exponentially size di ck
become infeasible large cliques clusters simplification additional
structure j suggested wiegerinck section form

j cj

nj


jl cjl



l

sets cjl l nj possibly overlapping subsets cj cjl
projection instantiation cj variables cjl structure sufficient
hold tables subsets cjl considerably smaller note j
entry instantiation cj nj j cj j cj weigerinck uses
structure potentials j following assumptions
definition selfq
compatibility distribution q clusters cj subsets cjl

form q x zq j j cj clusters factor according eq self compatible
every cj ck set indices njk l q ck cj q ck cjl non empty
regardless values potentials j cj arbitrary instantiation cj
cjl projection cj cjl
definition compatibility
wrt p distribution q clusters cj subsets cjl
q
form q x z q j j cj clusters factor according eq compatible
q
wrt distribution p sets di form p x z p di every di cj
set indices mij l q di cj q di cjl non empty cj arbitrary
instantiation cj cjl projection cj cjl
note self compatibility compatibility wrt p depend form q
particular realization potentials j
assumptions weigerinck states considerable simplifications deduced provides examples statement
note bishop winn jojic et al use
stronger assumption clusters cj approximating distribution q disjoint
q ck cj q ck assumption implies q ck cj q ck cjl
q di cj q di cjl every index l relaxed requiring equalities
hold single index l possibly multiple indices


figeiger meek wexler

multiple potential update overlapping clusters
section develop called vip uses additional structure
potentials offered eq speed computations particular rather updatnj
ing potential jl separately offer way update set potentials jl l
simultaneously saving considerable computations furthermore simultaneous update
enhanced junction tree despite fact sets cjl need form
junction tree cj form junction tree
uses definitions self compatibility compatibility wrt p defined
earlier following definition indices
definition let indicator function gjk l equal single fixed index l njk
indices njk q ck cj q ck equal otherwise let
indicator function fij l equal single fixed index l mij indices
mij q di cj q di equal otherwise
vip given figure convergence proved section proof
requires q self compatible compatible wrt p addition satisfy p x
q x note q p distributions q satisfy last
assumption
main improvement efficient update potentials potentials j factorize smaller potentials jl according eq vip
updates jl instead updating whole potential j done weigerincks
update potentials jl done vip equivalent updating j according
eq irrelevant constant require compute update equation
instance cluster cj proposed change considerably speeds previous

gets input target distribution p sets di form p x
q
di approximating distribution q clusters cj self compatible
zp
compatible wrt p satisfies
condition p x q x distribution q
q
form q x z q j j cj potential every cluster cj factors according
qnj
jl cjl clusters form consistent junction tree
j cj l
iterates clusters updating potential every instantiation subsets
cjl according eq apply update equation quantities q di cjl computed
via variable propagation jensen pp junction tree quantities
subsumed obtained mere lookup junction tree updating
potentials subsets cjl cluster cj procedure distributeevidence applied
make junction tree consistent respect j since clusters cj form
junction tree via subsets cjl eq replaced eq convergence
vip outputs approximating distribution q revised potentials
example target distribution p n n grid pairwise potentials see figure
approximating family defined single row set columns grid
augmented edges middle vertex see figure b c row
grid ci n columns notation xi j denote
vertex row column j grid cluster c associated n subsets


fia variational inference procedure

vip q p
q
q
input two probability distributions p x z p di q x z q j j cj
qnj
initial potentials j cj l
jl cjl form consistent junction tree q
self compatible compatible wrt p satisfies p x q x
output
revised set potentials jl cj defining probability distribution q via q x
q

c
j l jl jl q stationary point q p
iterate clusters cj convergence
step
l nj
every instantiation cjl cjl apply following update equation
jl cjl

x

x

x

q ck cjl log k ck

k gjk l ck cjl

x

q di cjl log di

fij l di cjl

jl cjl ejl cjl
note q di cjl computed via variable propagation jensen pp junction
tree jt however quantities subsumed obtained mere lookup
jt
step make jt consistent respect j

distributeevidence jt j

distributeevidence jt j
input junction tree jt nodes ck potentials k ck
node cj revised potential j
output consistent junction tree

qnk

l kl ckl

starting

initialization source j updated j
updated
first element updated updated updated
neighboring nodes ck c jt k source
p
qn
c
c
l l cl
km ckm km ckm p k qn
c ck
l l cl
single subset ck c ck ckm
source k
updated updated k
figure vip




figeiger meek wexler



b

c

figure grid p distribution b c approximating distributions q
c l x l x l column cluster cj associated n subsets cjl
cjl xl j xl j n subsets l cjl x j x j l n
cjl xln j x j additional n subsets l
choice induces self compatible approximating distribution q every column cluster
cj independent another cluster given subset contains x j cj
addition row cluster c independent every column cluster cj given c j
induced distribution compatible wrt p vertical edge dv xi j xi j
p distribution q satisfies q dv ck q dv ck column cluster ck
k j q dv c q dv c j addition horizontal edge dh xi j xi j
p distribution q satisfies q dh c q dh c j q dh ck q dh ck k
j j finally edge dh k j j approximating distribution satisfies
q dh ck q dh ckl ckl xi k x k due additional n edges added
column cluster
wiegerincks enhanced vip substantial computational
benefits conditional probabilities q di cjl subsumed cases needed
quantities q di cjl q ck cjl obtained mere lookup junction tree
step one call distributeevidence made step
demonstrated next paragraph computational efficiency vip achieved
even quantities q di cjl subsumed factor subsumed probabilities
disjoint clusters one special case quantities q di cjl factor
subsumed probabilities q dki cjl dik di ck obtainable lookup
junction tree
consider example compare computational cost vip versus wiegerincks
basic enhanced assume wiegerincks basic eq uses
distribution q given figure c clusters cj sets di therefore
junction tree used conditionals computed cluster cj
edge boundary grid four possible values edge
cluster cj clearly additional clusters introduced shown example figure b
computational cost grows junction tree done wiegerincks enhanced subsumed conditional probabilities computed separately
wiegerincks basic computed single call distributeevidence
computation covers subsets figure c conditionals sub

fia variational inference procedure



b

c

figure target distribution p grid pairwise potentials two different
partitions grid clusters shown figures b c contain
subsets

sumed q di cj horizontal edges di contained single cluster namely
edges c factor two subsumed probabilities one computed
single call described earlier requires second call distributeevidence
example let di x x horizontal edge p overlap cj
q x x c j q x c j x q x c j two conditionals subsumed second
call distributeevidence needed obtain q x c j x yields calls distributeevidence however example one call distributeevidence sufficient
compute conditionals two adjacent horizontal edges yielding need
calls therefore since calls distributeevidence since
cost junction tree typically twice cost computing conditional
probabilities without junction tree yields fold speedup wiegerincks
enhanced versus wiegerincks basic edges boundary
speedup factor less size grid grows smaller fraction edges
boundary thus speedup approaches fold speedup
significant speedup obtained vip clusters cj subsets
described figure b note additional subsets needed meet compatibility assumption vip vip makes one call distributeevidence
per cluster cj non subsumed conditional rather every edge cluster cj
since vip uses n clusters cj speedup compared wiegerincks enhanced
approaches n n n grid grows n speedup confirmed
experiments section figure
another potential benefit vip possibility alternating different
choices clusters contain identical subsets cjl simple example grid
figure two choices illustrated figures b c two sets clusters update potentials j differently therefore yield better approximations
distance q p reduced every alternation general iterate
set choices clusters execute vip one choice initial potentials
potentials jl found earlier choice clusters practical benefit option
added flexibility remains tested application


figeiger meek wexler

proof convergence
develop several lemmas culminate proof convergence vip
lemma states two un normalized probability distributions p x q x
kl divergence minimized q x proportional p x lemma rewrites
kl divergence q p terms potentials p
q p quantity j cj
according lemma differs j cj l jl cjl constant finally
theorem asserts kl divergence q p decreases iteration
vip unless q stationary point proof exploits form
q p provided lemma replaces term j cj terms jl cjl used
update equation vip final observation uses lemma closes proof
showing potentials updated vip kl divergence
minimized wrt j
first lemma provides variant well known property kl recall
every two probability distributions q x p x kl divergence q x p x
equality holds q x p x cover thomas theorem
similar holds un normalized probability distributions
lemma let q x p x non negative functions
let
q x
q x p x
p min
q

x

p

x p x

zp

q x zq

zq positive constant q x

zq
zp p x

proof observe
p x
q x p x zq q x
zq zp zq log

zq
zp

implies cited normalized distributions minimum
p x
obtained q x
zq zp yielding desired claim
next lemma rewrites kl divergence optimizing update equation
cluster cj becomes readily available
lemma let p x
tions


zp

q

di

q p

x
cj

q x

q cj log


zq

q

j

j cj two probability distribu

j cj
log zp log zq
j cj



j cj ej cj
j cj

x x

q ck cj log k ck

x x


k ck cj



di cj

q di cj log di



fia variational inference procedure

proof recall
q p

x

q x log

x

q x
h q eq log p x
p x



h q denotes entropy q x eq denotes expectation respect q
entropy term written
x x
h q
q cj q x cj log q cj log q x cj
cj x cj



p

cj

q cj log q cj

p

cj

q cj

p

x cj

q x cj log q x cj

variation well known form h q derived splitting
summation
p
x summation cj x cj fact q cj x cj q x cj
q cj holds every distribution split sum x cj q cj use
q
x
k k ck
zq

log k ck log q cj log zq
log q x cj log
q cj
k

thus
x

q x cj log q x cj

x cj

p p

p
q ck cj q x ck cj log k ck x cj q x cj log q cj log zq
p
q ck cj x ck cj q x ck cj q ck cj term rewritten
x
h q
q cj log q cj
k

x cj

cj



p

cj q cj

hp

k j

p

ck cj q ck cj log k ck log

j cj
q cj



log zq

note q cj bracketed term multiplied zero due equality
log product zero

second term eq similarly written
xx
x
eq log p x
q cj
q x cj log di log zp




x

q cj

cj

x x


cj



x cj

q di cj log di log zp

di cj

hence eq rewritten
x
q p
q cj log q cj
cj




x
cj

q cj


x x

q ck cj log k ck

x x


k ck cj



di cj

q di cj log di

figeiger meek wexler



x
cj

q cj log

q cj
log zp log zq
j cj

denoting bracketed term j cj letting j cj ej cj get
q p

x
cj

q cj log

j cj
log zp log zq
j cj



p
next lemma shows j cj defined eq j cj l jl cjl used
update potentials q vip differ additive constant depend
cj argued theorem fact difference constant enables vip
use latter form efficient representation
q
q
q
lemma let p x z p di q x z q j j cj j cj l jl cjl
two probability distributions q self compatible compatible wrt p let
x
x
x
x
jl cjl
q ck cjl log k ck
q di cjl log di
k gjk l ck cjl

fij l di cjl

difference j cj defined eq j cj
depend cj

p

l

jl cjl constant

p
proof first argue term form ck cj q ck cj log k ck term
p
form di cj q di cj log di eq depends cj appears exactly
single subset cjl eq argue every term eq appears
eq
since q self compatible follows every cluster ck depends cj
function gkj l equalspone single subset cjl namely q ck cj q ck cjl
case expression
ck cj q ck cjl log k ck appears eq similarly since q
compatible wrt p follows every set di depends cj function fij l
equals
one single subset cjl namely q di cj q di cjl case expression
p
di cj q di cjl log di appears second term eq
remains every term eq appears eq since q selfcompatible implied ck cj cjl thus summing ck cj equivalent
summing ck cjl therefore every k gjk l first term
eq appears eq similarly since q compatible wrt p implied
di cj cjl thus summing di cj equivalent summing di cjl
therefore every fij l second term eq appears eq


theorem convergence vip let initial approximating distribution q selfcompatible compatible wrt given distribution p assume p x
q x revised distribution q retains properties iteration
vip kl divergence q p decreases unless q stationary
point


fia variational inference procedure

q
proof let q x z q jl jl cjl jl cjl ejl cjl need


start
q iteration vip function q defined revised potentials

j cj l jl cjl probability distribution listed properties
closer p kl divergence q start previous iteration
first q maintains properties listed theorem throughout
updates done vip properties self compatibility compatibility wrt p
derived form q thus affected updates done vip
property
p x q x consider instance x p x since
q
p x zp di exists potential p di di
q
projection x set di since q x q x z q jl jl cjl exists
subset cjl q cjl cjl projection x cjl vip

convention
updates jl cjl log di q di cjl di c
jl

yielding q x claimed
additional zeroes introduced q whenever p x
q x hence normalizing constant zq therefore revised q
probability distribution instances cjl q cjl terms q ck cjl log ck
q di cjl log di finite long p x q x implies jl cjl
updated positive value thus additional zeroes introduced q
given form q


x
q cj
k ck j cj

zq
x cj k j

denote bracketed coefficient j cj bj cj note constant
sense depend quantity j optimized
use eq rewrite kl divergence justified eq lemma


j cj bj cj
x
q p
j cj bj cj log
log zp log zq

zq
j cj bj cj
cj

due lemma distance q p
j cj
p changes constant replacing

c


j
j
j cj e
j cj l jl cjl computed via eq vip note
j cj depend cj function q x conditional
distribution x cj given cj via q ck cj hence lemma states minimum
q p wrt j achieved j cj proportional j cj potential j
held implicitly partial potentials jl step vip updates j cj via
eq proportional j cj setting potential jl cjl proportional
jl cjl proportionality constant matter j multiplied
arbitrary constraining constant zq multiplied influences cancel
eq simplicity uses therefore j cj ej cj
vip implicitly computes j cj according formula hence decreases q p
iteration improving j cj holding cluster potentials fixed since
kl divergence lower bounded zero vip converges



figeiger meek wexler

properties q required theorem self compatibility compatibility wrt
p derived form q satisfied setting clusters cj appropriately
addition condition p x q x trivially satisfied strictly positive
distributions p
note difference j cj defined eq j cj defined eq
constant depend cj consequently convergence proof applies
wiegerincks special case vip every cluster
cj single subset cj cj

handling deterministic potentials
distribution p strictly positive property p x q x
must hold convergence proof vip apply section provide sufficient
condition q retain property
definition instantiation w w feasible wrt distribution p p w w
otherwise instantiation infeasible
q
definition constraining set wrt distribution p x z p di sets di
minimal set variables di infeasible instantiation
q
definition distribution q x z q j j cj clusters cj containable wrt
q
distribution p x z p di every constraining set p exists least
one cluster cj cj
q
q
theorem let p x z p di q x z q j j cj two distributions
q
j cj l jl cjl q containable compatible wrt p strictly positive vip iterates clusters cj revised distribution q satisfies
p x q x
proof definition constraining set every infeasible instantiation x
exists infeasible instantiation constraining set projection x
vip updates q x instantiations since q containable
wrt p exists cluster cj contains furthermore since di di
set p since q compatible wrt p exists subset cjl contains
every instantiation cjl projection cjl expression jl cjl updated
according q
eq vip true q di cjl log di

since q x zq j l jl cjl update implies q x
whenever first two compatibility conditions theorem hold follows vip
converges containable distributions note since every iteration vip decreases
kl divergence following iterations change q greater zero instantiation
infeasible wrt p leads infinite distance however containability
implies stronger property stated next theorem



fia variational inference procedure

q
q
theorem let p x z p di q x z q j j cj two distributions
q
j cj l jl cjl q containable wrt p p x q x
vip iterates clusters cj revised distribution q satisfies q x
p x
proof consider instantiation x p x
eq vip upq
dates q x positive value since q x z q j l jl cjl sufficient
revised potential jl cjl positive subset cjl instance cjl
projection x cjl instances cjl value jl cjl set eq
finite value since di every instance di projection x set di
k ck implies q ck cjl therefore jl cjl ejl cjl q x
consequence theorem q x iff p x conditions weaker
containability may sufficient ensure requirement needed convergence however
containability easily satisfiable applications variational techniques explicated
next section

genetic linkage analysis via variational
genetic linkage analysis takes input family pedigree individuals
affected genetic disease affection status members pedigree marker readings
across genome mode inheritance output likelihood data function location disease gene given pedigree locations yielding maximum
close maximum likelihood singled suspect regions scrutiny
exact computation likelihood often complex approximations needed
vip developed facilitate likelihood computations particular vip allows overlapping clusters minimizes loss valuable
information importantly handle deterministic constraints common section describe standard probabilistic model
genetic linkage several approximate distributions use applying vip
genetic linkage model demonstrate vip real world data set large pedigree
individuals
standard probabilistic model genetic linkage pedigree contains several variables person location conditional probability tables
variable xm given set variables called parents xm denoted xm
distribution p x represents joint distribution variables pedigree
written multiple indices one set indices persons one loci j
another type variable follows
p x

yy
j


p xi
j xj



ps ms pg mg f

yy
zp
j



ps ms pg mg f






j xj xj



figeiger meek wexler

five possible types variables paternal selector ps maternal selector ms
paternal genotype pg maternal genotype mg phenotype f thus set dji
equals xji xji
denote variables different types ps ms pg mg f individual

locus j sji p sji gi p
fji respectively notation possible potentials
j gj
p

p

b p
b

p
p


p gi p
j gj gj sj gj gj gj sj sj sj sj sj

fji gi p
j gj b father mother pedigree respectively
p
p

ms

exemplifying sets dji pg gi p
sji sj
dji f
j sj gj gj dj

fji gi p
j gj father individual pedigree note first
two types potentials possibly last one deterministic potentials equal
zero instantiations
directed
q acyclic graph along probability distribution r factors according
r z r zi zi called bayesian network bayesian network defined
eq describes parents offspring interaction simple genetic analysis
two siblings parents across loci given figure dashed boxes
contain variables describe variables single location example
assume phenotype variable depends genotype single locus
reflected fact edges single locus point phenotype variable
full semantics variables details regarding conditional probability
tables found fishelson geiger details needed

use several choices cluster bayesian network p x q selfcompatible compatible wrt p addition since potentials p constrained
e g pg
j choose clusters q containable wrt p according theorem
choice ensures q satisfies conditions necessary convergence vip
particular p x q x
consider partition network slots containing set consecutive loci
simple case every slot single locus subsets cji contains
variables related one individual genotypes parents slot set


cji gj sji cj cji denotes union parents
illustration setting pedigree two siblings parents three
loci given figure setting self compatibility trivially satisfied
clusters cj q disjoint q containable wrt p since sets dji ps dji ms
potentials constrained span across single locus remains
compatibility q wrt p satisfied sets dji contained single subset

cji trivial q dji cj q dji cji otherwise equals ps ms without
p
p
p
p
loss generality q sj
sji p cj q sj
cj q sj
cji q sj
sji p cji
complex setup similar example add cluster cj
cuts across loci selector variables individual r shown figure


subset cji set cji gjs sji sjr clusters cj cji j j
r
addition set cj l cj l subsets cj l sl l
single
chosen individual r verify q still satisfies conditions theorem selfcompatibility maintained since q cj cj q cj cj j q cj cj q cj cjr



fia variational inference procedure

figure bayesian network representation pedigree two siblings parents
loci model circles squares diamond shapes represent genotype
phenotype selector variables respectively

q ck cj q ck cjr every two clusters cj ck j k j sets dji
ms ps contained cluster cj thus maintain independence given
subset ms ps sets dji connect two adjacent loci independent cj
given cj j independent clusters cj given subset cji maintaining
compatibility q wrt p finally q containable wrt p since clusters previous
option remain
immediate extensions clustering schemes allow every slot contain several
consecutive loci set possibly one individual r cut across loci
maintain compatibility q wrt p latter extension subsets cjr set
r
cjr gj sjr r denotes union individuals r parents
describe experiments performed large pedigree individuals
spanning across locations studied narkis et al locate area
contains gene causes fatal neurological disorder lccs type first
proximity disease gene markers tested two point analysis
model selection method two loci considered simultaneously one
disease locus method loci yield likelihood maxima suggest
probable locations disease locus two point analysis abovementioned pedigree
took several days exact inference software superlink v designed genetic
linkage analysis


figeiger meek wexler

figure schematic division pedigree clusters locus cluster
cluster c variables every individual separate ellipse
number individual written two clusters marked areas
c c

log likelihood probabilities obtained vip abovementioned extended
clustering scheme clusters across loci cluster cutting across
loci shown figure figure shows clearly exact approximate loglikelihood curves similar shape almost identical extremum points
major difference absolute value
next tested vip three point analysis pedigree
two markers considered simultaneously along one disease locus note
exact inference task specified pedigree hard single pc taking several
weeks since exact location disease gene known high probability
wished test whether lower bounds found vip indicate location
considered two nearby markers number seven differ
location speculated disease gene first two disease locus positioned
left marker distances centi morgan cm remaining five
positioned right marker distances cm cm difference
locations location disease gene cm right marker
run three times model random initial potentials taking
account maximum value obtained test plotted figure
versus approximation found sampling software simwalk introduced sobel
papp lange designed approximate pedigree analysis shown
probabilities found vip higher location disease gene
true probabilities found simwalk however note vip


fia variational inference procedure

ln likelihood

figure pedigree partitioned clusters locus cluster additional cluster c striped area contains variables one individuals














exact

locus

vip clusters across loci
vip disjoint clusters

figure approximations log likelihood two point analysis vip

much slower simwalk taking several hours run addition


figeiger meek wexler

note ln likelihood probabilities figures b drawn different
scales due markedly different output two methods








ln likelihood

ln likelihood





























location relative marker













location relative marker

vip

b simwalk

figure approximations log likelihood three point analysis
compared convergence times vip wiegerincks size
genetic linkage analysis original network performed test
includes variables represents pedigree individuals four loci create
sized subsets original pedigree increasing number individuals
considered addition fair comparison clusters wiegerincks
chosen subset subsets used vip since number iterations
convergence vary significantly two report ratio
iteration times tests theoretical speedup predicted section vip
wiegerincks figure illustrates ratio time update iteration
two evident ratio increases linearly size
ratios indicated averaged runs iterations every size
finally examine convergence vip figure six representatives
original two point analysis runs described earlier different network
halted change lower bound smaller
iterations although runs converge rate seems obey
certain pattern convergence first iterations significant improvements
lower bound followed slow convergence local maximum another
moderate improvement better maximum point

discussion
present efficient called vip structured variational approximate inference extends known handle overlapping
clusters overcome difficulties imposed deterministic constraints
n n grid vip n fold faster wiegerincks


fia variational inference procedure




ratio iteration times






























number individuals

figure speedup vip wiegerincks




ln likelihood
































iteration

figure convergence vip runs two point analysis
junction tree used addition prove convergence vip previous
variational methods via novel proof method properties kl divergence
finally vip tested bayesian networks model genetic linkage analysis graphs resemble grid notoriously difficult
approximate due numerous deterministic constraints linear
improvement speed vip versus wiegerincks approximation


figeiger meek wexler

follows shape real likelihood probabilities nevertheless figure shows variational methods wiegerincks vip still appropriate produce
accurate approximation likelihood genetic linkage analysis

acknowledgments
extension originally appeared th workshop
artificial intelligence statistics geiger meek thank heckerman n
jojic v jojic helpful discussions thank two anonymous reviewers
correcting several errors appeared early version well improving
presentation part work done first author visitor microsoft
work supported israeli science foundation israeli science
ministry

references
bishop c winn j structured variational distributions vibes artificial
intelligence statistics society artificial intelligence statistics
cooper g probabilistic inference belief networks np hard artificial
intelligence
cover thomas j elements information theory wiley
dagum p luby approximating probabilistic inference bayesian belief
networks np hard artificial intelligence
dechter r bucket elimination unifying framework reasoning artificial
intelligence
fishelson geiger exact genetic linkage computations general pedigrees
bioinformatics
geiger meek c structured variational inference procedures realizations proceedings tenth international workshop artificial intelligence
statistics barbados society artificial intelligence statistics
ghahramani z jordan factorial hidden markov machine learning
jensen f v introduction bayesian networks springer
jojic v jojic n meek c geiger siepel haussler heckerman
efficient approximations learning phylogenetic hmm data
bioinformatics
kschischang f r frey b j loeliger h factor graphs sum product
ieee transactions information theory


fia variational inference procedure

narkis g landau manor e elbedour k tzemach fishelson geiger
ofir r carmi r birk homozygosity mapping lethal congenital
contractural syndrome type lccs cm interval chromosome q
american journal medical genetics
saul l jordan exploiting tractable substructures intractable networks
advances neural information processing systems nips mit press
sobel e papp j lange k detection integration genotyping errors
statistical genetics american journal human genetics
wiegerinck w variational approximations mean field theory junction tree uncertainty artificial intelligence pp morgan
kaufmann
xing e p jordan russell generalized mean field
variational inference exponential families uncertainty artificial intelligence
pp morgan kaufmann
xing e p jordan russell graph partition strategies generalized
mean field inference uncertainty artificial intelligence pp morgan
kaufmann




