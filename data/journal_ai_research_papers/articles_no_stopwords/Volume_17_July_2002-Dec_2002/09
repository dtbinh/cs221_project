Journal Artificial Intelligence Research 17 (2002) 309-332

Submitted 06/02; published 10/02

Analysis Phase Transition NK Landscapes
Yong Gao
Joseph Culberson

ygao@cs.ualberta.ca
joe@cs.ualberta.ca

Department Computing Science
University Alberta
Edmonton, Alberta, Canada, T6G 2H1

Abstract
paper, analyze decision version NK landscape model
perspective threshold phenomena phase transitions two random distributions,
uniform probability model fixed ratio model. uniform probability
model, prove phase transition easy sense polynomial
algorithm solve random instance problem probability asymptotic
1 problem size tends infinity. fixed ratio model, establish several
upper bounds solubility threshold, prove random instances parameters
upper bounds solved polynomially. This, together empirical
study random instances generated phase transition region, suggests
phase transition fixed ratio model easy.

1. Introduction
NK landscape fitness landscape model devised Kauffman (1989). appealing
property NK landscape ruggedness landscape tuned
changing parameters. years, NK landscape model
studied perspectives statistics computational complexity (Weinberger, 1996;
Wright, Thompson, & Zhang, 2000). study genetic algorithms, NK landscape
models used prototype benchmark analysis performance
different genetic operators effects different encoding methods algorithms
performance (Altenberg, 1997; Hordijk, 1997; Jones, 1995).
field combinatorial search optimization, one interesting discoveries
threshold phenomena phase transitions. Roughly speaking, phase transition
combinatorial search refers phenomenon probability random instance
problem solution drops abruptly 1 0 order parameter
random model crosses critical value called threshold. Closely related phase
transition solubility hardness solving problems. strong empirical evidence theoretical arguments showing hardest instances problems
usually occur around threshold instances generated parameters far away
threshold relatively easy. Since seminal work Cheeseman et al. (Cheeseman, Kanefsky, & Taylor, 1991), many NP-complete combinatorial search problems
shown phase transition associated easy-hard-easy pattern (Cook
& Mitchell, 1997; Culberson & Gent, 2001; Freeman, 1996; Gent, MacIntyre, Prosser, &

c
2002
AI Access Foundation Morgan Kaufmann Publishers. rights reserved.

fiGao & Culberson

Walsh, 1998; Kirkpatrick & Selman, 1994; Mitchell, Selman, & Levesque, 1992; Vandegriend
& Culberson, 1998).
paper, analyze NK landscape model perspective threshold
phenomena phase transitions. establish two random models decision problem
NK landscapes study threshold phenomena associated hardness
phase transitions two models.
rest paper organized follows. Section 2, introduce NK fitness
landscape probabilistic models, uniform probability model fixed ratio
model. Section 3 Section 4, threshold phenomena phase transitions
NK landscapes analyzed. uniform probability model, prove phase
transition uniform probability model easy sense polynomial
algorithm solve random instance problem probability asymptotic
1 problem size tends infinity. fixed ratio model, establish two upper
bounds solubility threshold, prove random instances parameters
upper bounds solved polynomially. This, together empirical study
random instances generated phase transition region, suggests
phase transition fixed ratio model easy. Section 5, report
experimental results typical hardness fixed ratio model. Section 6, conclude
investigation discuss implications results.

2. NK Landscapes Probabilistic Models
NK landscape f (x) =

n
P

(xi , (xi )), real-valued function defined binary strings

i=1

fixed length, n > 0 positive integer x = (x1 , , xn ) {0, 1}n . sum
n local fitness functions , 1 n. local fitness function (xi , (xi )) depends
main variable xi neighborhood (xi ) Pk ({x1 , , xn }\{xi }) Pk (X)
denotes set subsets size k X. important parameters NK
landscape number variables n, size neighborhood k = |(xi )|.
NK landscape, neighborhood (xi ) chosen two ways: random
neighborhood, k variables randomly chosen set {x1 , , xn }\{xi },
adjacent neighborhood, k variables indices nearest (modulo n)
chosen. example, even integer k, k variables (xi ) defined
x((n+i k ) mod n) , , x((n+i+ k ) mod n) . variables neighborhood deter2
2
mined, local fitness function determined fitness lookup table specifies
function value 2k+1 possible assignments variables xi (xi ).
Throughout paper, consider NK landscapes random neighborhoods.
simplify discussion, assume local fitness functions take binary
values. Given NK landscape f , corresponding decision problem stated follows:
maximum f (x) equal n? NK landscape decision problem insoluble
solution it.
proved NK landscape model NP complete k 2 (e.g.,
Weinberger, 1996; Wright et al., 2000). proofs based reduction SAT
decision problem NK landscapes. study typical hardness NK landscape
decision problems framework thresholds phase transitions, introduce two

310

fiPhase Transition NK Landscapes

random models. models defined below, neighborhood set (xi )
variable xi selected randomly choosing without replacement k = |(xi )| variables
x\{xi }.
Definition 2.1. Uniform Probability Model N (n, k, p): model, fitness value
local fitness function (xi , (xi )) determined follows: assignment
Dom(fi ) = {0, 1}k+1 , let (y) = 0 probability p (y) = 1
probability 1 p, done possible assignment local fitness
function independently.
Definition 2.2. Fixed Ratio Model N (n, k, z): model, parameter z takes
values [0, 2k+1 ]. z integer, specify local fitness function (xi , (xi ))
randomly choosing without replacement z tuples possible assignments = (y1 , , yz )
Dom(fi ) = {0, 1}k+1 , defining local fitness function follows:

0, ;
(y) =
1, else.
non-integer z = (1 )[z] + [z + 1] [z] integer part z, choose
randomly without replacement [(1 )n] local fitness functions determine fitness
values according N (n, k, [z]). rest local fitness functions determined according N (n, k, [z] + 1).
theory random graphs, two related random models G(n, p)
n(n1)
possible edges included graph independently probability
2
p, G(n, m) exactly edges chosen randomly without replacement
set n(n1)
possible edges. well known monotone graph
2
properties, results proved G(n, p) (or G(n, m)) hold asymptotically G(n, N p)

(correspondingly, G(n, N
)) N = n(n1)
. However, cannot expect similar
2
relations exist two random models NK landscapes defined unless
parameter k tends infinity. result, asymptotic behaviors two NK landscape
models significantly different fixed k.
conclude section establishing relation decision problem NK
landscapes SAT problem. decision problem NK landscape
f (x) =

n
X

(xi , (xi )),

i=1

maximum f (x) equal greater n?, reduced (k+1)-SAT problem
follows:
z
V
(1) local fitness function (xi , (xi )), construct conjunction Ci =
Cij
j=1

clauses exactly k + 1 variable-distinct literals set variables {xi , (xi )},
z number zero values takes Cij assignment
yj {0, 1}k+1 falsifies Cij , (yj ) = 0.
n
V
(2) (k+1)-SAT conjunction =
Ci .
i=1

311

fiGao & Culberson

x
0
0
0
0
1
1
1
1


0
0
1
1
0
0
1
1

z
0
1
0
1
0
1
0
1


0
1
1
0
1
0
0
1

Clauses
xyz

x z
x z
x z

Table 1: local fitness function equivalent 3-clauses.

Table 1 shows example fitness assignment local fitness function = (x, y, z)
associated equivalent 3-SAT clauses. easy see assignment
variables x, y, z, (s) = 1 assignment satisfies formula
x z, x z, x z, x z.

3. Analysis Uniform Probability Model
uniform probability model N (n, k, p), parameter p determines many zero
values local fitness function take. interested solubility hardness
NK landscape decision problem change parameter p increases 0 1.
turns fixed p > 0, decision problem asymptotically trivially insoluble.
quite similar phenomena random models constraint satisfaction
problem observed Achlioptas et al. (1997).
gain insight problem, consider case p = p(n)
function problem size n lim p(n) = 0. analysis shows solubility
n

problem depends fast p(n) decreases:
(1)
1

lim p(n)n 2k+1 = +,

(3.1)

n

problem still asymptotically trivially insoluble probability asymptotic 1, least one local fitness function always fitness value 0;
(2) hand p(n) decreases fast enough, i.e.,
1

lim p(n)n 2k+1 < +,

(3.2)

n

problem decomposed set independent sub-problems. either case
problem solved polynomial time. case (3.1) difficult prove,
prove case (3.2), need make use following concepts results.
Definition 3.1. connection graph NK landscape instance f (x) =

n
P
i=1

graph G = G(V, E) satisfying
312

(xi , (xi ))

fiPhase Transition NK Landscapes

(1) vertex v V corresponds local fitness function;
(2)There edge vi , vj corresponding local fitness functions
, fj share variables, i.e., neighborhoods (xi ) (xj ) xi xj non-empty
intersection, least one zero value.
Definition 3.2. Let f (x) =

n
P

(xi , (xi )) NK landscape instance con-

i=1

nection graph G = G(V, E). Let G1 , , Gl connected components G. Since
vertices G correspond local fitness functions, regard Gi set local fitness
functions. 1 l, let Ui x = (x1 , , xn ) set variables appear
definition local fitness functions Gi .
easy see (U1 , Ul ) excluding independent vertices forms disjoint partition
(a subset of) variables x = (x1 , , xn ), local fitness functions Gi
depend variables Ui . Furthermore, NK decision problem soluble
1 l, assignment si {0, 1}|Ui | variables Ui
local fitness function g Gi , g(s) = 1.
Theorem 3.1 summarizes result uniform probability model.
1

Theorem 3.1. p(n) lim p(n)n 2k+1 exists, k fixed,there polynon

mial time algorithm successfully solves random instance N (n, k, p) probability
asymptotic 1 n tends infinity.
1

1

Proof: consider two cases: lim p(n)n 2k+1 = + lim p(n)n 2k+1 < +.
n

(1) case lim p(n)n
n

1
2k+1

n

= +.

Let Ai event (y) = 0 possible assignment {0, 1}k+1 let
n

A=
Ai event least one Ai occurs.
i=1

lim P r{A} = 1 lim P r{

n

n

n
\

Aci }

i=1

= 1 lim (1 p(n)2
n

k+1

)n .

1

shown k fixed lim p(n)n 2k+1 = +, lim P r{A} = 1. follows
n
n
probability asymptotic one, least one local fitness function
takes values 0 possible assignments. therefore show case,
NK decision problem insoluble checking local fitness functions one one.
takes linear time.
1
(2) case lim p(n)n 2k+1 < +.
n
Consider algorithm first finds connected components Gi , 1 l
connection graph G NK model, uses brute force find assignment
si {0, 1}|Ui | variables Ui local fitness function g Gi ,
g(s) = 1. time complexity algorithm O(n2 + n 2M(n,k,p) ) M(n, k, p) =
max(|Ui |, 1 l) maximum size subsets (Ui , 1 l) associated
313

fiGao & Culberson

connected components connection graph. prove theorem, need show
1
M(n, k, p) O(log n). following, show lim p(n)n 2k+1 < +,
n

lim P r{M(n, k, p) 2k + 2} = 1
n

Consider connection graph G = G(V, E) NK model. random graph
edge two nodes two corresponding local fitness functions
share variables local fitness functions take least one zero fitness
value. However, definition edge probabilities independent. vx E
know fx least one zero probability xw E greater
edge x.
deal resort following proof construction. Let Cm = {v1 , . . . , vm }
subset V size m. Let ordering (permutation) v1 . . . vm . say
Cm variable connected respect ordering , denoted C(Cm , ),
i, 2 either
1. j < f(j) f(i) share variable;
2. j, 1 j variable xj one k random variables .
Lemma induced subgraph G[Cm ] connected exists least one ordering
v1 . . . vm C(Cm , ).
proof, consider ordering vertices depth first search connected
subgraph. case, connections case 1.
expected number permutations C(Cm , )
Ec = E[|{ : C(Cm , )}|] = m!Pr{C(Cm , )}
observe
expected number connected induced graphs vertices
n
less pm
0 Ec , p0 probability takes least one value zero.
show value goes zero limit 2k + 2. Finally, since connected
subgraph vertices must one < m, follows largest
connected component size 2k + 1.
randomly generated permutation Cm , let Ci set first vertices
permutation. 2 define Pi probability f(i) shares least one
variable f(j) j < given C(Ci1 , /1, , 1). Let P1 = 1. (A one
vertex subgraph always connected.)
> 1 Pi = Pr{j < i, f(i) f(j) share variables, given C(Ci1 , )
one k random variables f(i) {x1 . . . xm } {xi }}.
Pr{C(Cm , )} =




Pi .

i=2

Finally, > 1 note Ci1 (i 1)k distinct variables. Ci1
connected number variables may less this. Thus,
nk(i1)m
k

n1
k

Pi 1
314

.

fiPhase Transition NK Landscapes

combinatorial part reduces
(n k(i 1) m) . . . (n k(i 1) k + 1)
(n 1) . . . (n k)


n ki + 1 k

.
n1
So, Pr{C(Cm , )}






1

i=2

n ki + 1
n1

k !

!m1
km + 2 k

1 1
n1
m1 !
1

, m, k fixed.
n



Noting pm


n 2k +1 , see expected number connected subgraphs
0
size bounded

m1 !

1
n
2k +1
p0
Ec n n

n
goes zero = 2k +2. follows M(n, k, p) less 2k +2 probability
asymptotic 1. completes proof.

4. Analysis Fixed Ratio Model
discussed previous section, uniform probability model N (n, k, p)
NK landscapes asymptotically trivial. Part cause asymptotic triviality lies
fact parameter p decrease quickly n, asymptotically
least one local fitness function takes value 0 possible
assignments, making whole decision problem insoluble. section, study
fixed ratio model N (n, k, z). model, require local fitness function
fixed number zero values trivially insoluble situation uniform probability
model avoided. note idea used study flawless
CSP (Gent et al., 1998).
Recall fixed ratio model, choose neighborhood structure local
fitness way uniform probability model N (n, k, p). determine
fitness value local fitness function , randomly without replacement select exactly
z tuples {s1 , , sz } {0, 1}k+1 , let (sj ) = 0 1 j z (s) = 1
every {0, 1}k+1 .
fixed ratio model, interested probability instance
N (n, k, z) soluble changes parameter z increases 0 2k+1 . easy
n
P
see property exists assignment x f (x) =
(xi , (xi )) = n
i=1

315

fiGao & Culberson

monotone parameter z number tuples local fitness function takes
zero. Actually, following Lemma property solubility probability
fixed ratio model:
Lemma 4.1. fixed ratio model, z1 > z2 ,
P r{N (n, k, z1 )is soluble} P r{N (n, k, z2 )is soluble}.
Furthermore,

P r{N (n, k, z)is soluble} =

1, z 1;
0, z = 2k+1 .

Based Lemma parallel study threshold phenomena
random combinatorial structures 3-Coloring random graphs random
3-SAT, suggest following conjecture:
Conjecture 4.1. exists threshold zc

1, z < zc ;
lim P r{N (n, k, z)is soluble} =
n
0, z > zc .
Conjectures starting point study phase transition many
random combinatorial structures 3-coloring random graphs random SAT,
existence thresholds still open question (Achlioptas, 1999; Cook &
Mitchell, 1997). However, bounding thresholds important topic
study phase transition (Achlioptas, 1999, 2001; Dubois, 2001; Franco & Gelder, 1998;
Franco & Paul, 1983; Frieze & Suen, 1996; Kirousis, P.Kranakis, D.Krizanc, & Y.Stamation,
1994). section, establish two upper bounds threshold parameter
zc , theoretically prove random instances generated parameter z
upper bounds solved probability asymptotic 1 polynomial (even
linear) algorithms.
Characterizing sharpness thresholds great interest study
phase transition. proving every monotone graph property threshold
behavior (Friedgut & Kalai, 1996), Friedgut (1999) established necessary sufficient
condition monotone graph property sharp threshold, used
prove sharpness thresholds 3-colorability 3-SAT problems (Friedgut, 1999;
Achlioptas, 1999). fixed ratio model discussed paper, suspect
exhibit coarse threshold behavior, would leave detailed investigation
problem future research direction.
4.1 Upper Bound z = 3.0
derivation upper bound based concept conflicting pair local
fitness functions. say two local fitness functions fj conflict

1. fj share least one variable x;
316

fiPhase Transition NK Landscapes

2. assignment {0, 1}n , (s)fj (s) = 0.
obvious instance NK decision problem insoluble exists pair
conflicting local fitness functions.
Based second moment method theory probability (Alon & Spencer,
1992), prove following upper bound result. takes linear time check
pair conflicting local fitness functions, see fixed ratio model
N (n, 2, z) linearly solvable z > 3.0.
Theorem 4.1. Define event conflicting pair local fitness
functions N (n, 2, z). fixed ratio model N (n, 2, z) z = 3.0 + ,
lim P r{A} = 1
n

thus problem insoluble probability asymptotic 1.
Proof: Without loss generality, may write f 4 zeroes fitness
value assignment 1 n, 3 zeroes n + 1 n. Let Iij indicator
function event fj conflicts other, i.e.,

1, fj conflicts other;
Iij =
0, else.
P
Iij . claim lim P r{S = 0} = 0.
=
1i,jn

n

Chebyschevs inequality,
P r{S = 0} P r{|S E(S)| E(S)}
V ar(S)

.
(E(S)2 )

(4.3)

Since 1 n, exactly 4 zeros fitness value assignment, know
two local fitness function , fj , 1 i, j n, conflict
exactly one common variable x one following true: (1)fi (s) =
0(or 1), fj (s) = 1(or 0) assignments x = 1(respectively x = 0);
(2)fi (s) = 1(or 0), fj (s) = 0(or 1) assignments x = 1(respectively x =
0);
Since probability two local fitness functions share least one variable equal



n2 n4
1

2
2
n1 n1 ,
2
2




P r{Iij = 1} =

1

1
= ( ),
n

!

n2 n4
2
2
n1 n1
2
2

2

1

8

!2

4

> 0, 1 i, j n,

317

(4.4)

fiGao & Culberson

hence,
X

E(S) =

X

E(Iij ) =

1i,jn

P r{Iij = 1} (n).

1i,jn

P

consider variance S. Since =

Iij ,

1i,jn

P
V ar(S) =

P

V ar(Iij ) + 2

i,j

[E{Iij Ilm } E{Iij }E{Ilm }]

(i,j)6=(l,m)

.

(E(S))2

Let

P
A1 =



P

2
A2 =

V ar(Iij )

i,j

(E(S))2

[E{Iij Ilm } E{Iij }E{Ilm }]

(i,j)6=(l,m)

(E(S))2

.

easy see lim A1 = 0. prove lim A2 = 0, consider two cases:
n
n
Case 1: 6= j 6= 6= l. case, two random variables Iij Ilm actually
independent. follows E{Iij Ilm } E{Iij }E{Ilm } = 0.
Case 2: (i, j) 6= (l, m), one common, say j = l. case,
2 !
1
E{Iij Ilm } E{Iij }E{Ilm } = P r{Iij = 1}P r{Ijm = 1|Iij = 1}
n

2 !
1
1
=
P r{Ijm = 1|Iij = 1}
n
n
Given fj conflict other, conditional probability fj fm
conflict still ( n1 ).
3 pairs
SincePthere Cn
ij
jm satisfying condition Case 2, know

[E{Iij Ilm } E{Iij }E{Ilm }] (n). therefore, lim A2 = 0. follows
n

(i,j)6=(l,m)



V ar(S)
= 0.
n (E(S)2 )

lim P r{S = 0} lim

n

Since event {S > 0} implies exists conflicting pair local fitness functions,
theorem follows.
4.2 2-SAT Sub-problems N (n, 2, z) Tighter Upper Bound
subsection, establish tighter upper bound z > 2.837 threshold fixed
ratio model N (n, 2, z) showing asymptotically N (n, 2, z) contains unsatisfiable
2-SAT sub-problem probability 1 value z greater 2.873.
gives us polynomial time algorithm determines N (n, 2, z) insoluble
probability asymptotic 1 z > 2.837.
318

fiPhase Transition NK Landscapes

Recall Section 2 instance N (n, 2, z) equivalent 3-SAT instance.
idea show probability asymptotic 1, instance N (n, 2, z)
contain set specially structured 3-clauses, called t-3-module (Definition 10.3, Franco
& Gelder, 1998):
= {M1 , . . . , M3p+2 }, = 3p + 2,

M1 = (u1 u2 z1 , u1 u2 z1 );

Mp1 = (up1 zp1 , up1 zp1 );
Mp = (up u0 zp , u0 zp );
Mp+1 = (up+1 up+2 zp+1 , up+1 up+2 zp+1 );

M3p1 = (u3p1 u3p z3p1 , u3p1 u3p z3p1 );
M3p = (u3p u0 z3p , u3p u0 z3p )
M3p+1 = (u0 u1 z3p+1 , u0 u1 z3p+1 );
M3p+2 = (u0 up+1 z3p+2 , u0 up+1 z3p+2 );
u1 , , u3p+1 , z1 , , z3p+1 binary variables. Notice t-3-module reduced 2-SAT problem containing two contradictory cycles hence unsatisfiable.
result proved two steps. first step, shown z > 2.837
average number t-3-modules contained N (n, 2, z) tends infinity n increases.
second step, use result established Alon Spencer (1992) second
moment method prove z > 2.837 probability N (n, 2, z) contains least
one t-3-module tends 1.
Let us start first step show average number t-3-modules contained
N (n, 2, z) tends infinity n increases.
Definition 4.1. Given t-3-module NK landscape instance f =

n
P

, k = 2,

i=1

sequence local fitness functions
g = (g1 , , gt ) (f1 , , fn )
said possible match(PM) 1 t, main variable gm one
three variables occur 3-module Mm . subsequence (h1 , , hl ) possible
match g legal 1 < j l, hm 6= hj .
Lemma 4.2. Let f (x) =

n
P

(xi , (xi )) instance N (n, 2, z) t-3-

i=1


module. number possible matches
t-3-module 3 . Further,

number legal possible matches ( 3+2 5 )t .

319

fiGao & Culberson

Proof: 1 t, exactly 3 possible choices gm :
fi1 (xi1 , (xi1 )), fi2 (xi2 , (xi2 )), fi3 (xi3 , (xi3 )),
xi1 , xi2 , xi3 correspond three variables occur 3-module Mm .
Therefore, 3t possible matches t-3-module.
prove second conclusion, divide t-3-module 3 parts = (M1 , M2 , M3 ),
M1 = (Mm , 1 p), M2 = (Mm , p + 1 3p 1), M3 =
(M3p , M3p+1 , M3p+2 ). Letting L1 , L2 , L3 number legal possible matches
M1 , M2 , M3 respectively. Since literals M1 variable-distinct literals
M2 , number legal possible matches, L, t-3-module satisfies
L1 L2 L 27L1 L2 .
estimate order L1 . end, consider probability space (, P ),
set sequences (g1 , , gp ) local fitness functions possibly match M1
P uniform probability distribution. Then, number legal possible matches

L1 = || P r{a random sample legal}
(4.5)
Let g = (g1 , , gp ) random sample xgm denote main variable
local fitness function gm ,
1
P r{xgm = |um |} = P r{xgm = |um+1 |} = P r{xgm = |zm |} = ,
3
|u| denotes variable corresponding literal u.
Let Bm , 0 < p event first local fitness functions g1 , , gm
possible match g = (g1 , , gp ) mutually distinct. Since M1 consecutive
3-modules share variables,
Bm = {(g1 , , gm ) : gi 6= gi+1 , 1 1}.
Let bm = P r{gm 6= gm1 | Bm1 }, 2, b1 = 1. Notice B1 = . Then,
P r{g = (g1 , , gp )is legal} = P r{Bp }
= P r{g1 6= g2 , g2 6= g3 , , gp1 6= gp }
= P r{B1 }P r{g2 6= g1 | B1 } P r{g3 6= g2 | B2 } P r{gp 6= gp1 | Bp1 }

(4.6)

= b1 b2 bp
Recalling xgm denotes main variable local fitness function gm ,
bp = P r{gp1 6= gp , xgp1 = |up | | Bp1 } + P r{gp1 6= gp , xgp1 6= |up | | Bp1 }
= P r{gp1 6= gp | Bp1 , xgp1 = |up |} P r{xgp1 = |up | | Bp1 } +
P r{gp1 6= gp | Bp1 , xgp1 6= |up |} P r{xgp1 6= |up | | Bp1 }
2
ap + (1 ap )
=
3
1
= 1 ap ,
3
320

(4.7)

fiPhase Transition NK Landscapes

ap = P r{xgp1 = |up | | Bp1 }. ap ,
P r{Bp1 , xgp1 = |up |}
P r{Bp1 }
1
=
(P r{Bp1 , xgp1 = |up |, xgp2 = |up1 |}
P r{Bp1 }

ap =

+ P r{Bp1 , xgp1 = |up |, xgp2 6= |up1 |})
(4.8)
1
=
(P r{xgp1 = |up | | Bp1 , xgp2 = |up1 |} P r{Bp1 , xgp2 = |up1 |}
P r{Bp1 }
+ P r{xgp1 = |up | | Bp1 , xgp2 6= |up1 |} P r{Bp1 , xgp2 6= |up1 |})


1
1
1
=
P r{Bp1 , xgp2 = |up1 |} + P r{Bp1 , xgp2 6= |up1 |}
P r{Bp1 } 2
3
last equation formula given Bp1 xgp2 = |up1 |
(or xgp2 6= |up1 |), two (three, respectively) choices selecting local fitness
function gp1 . Consider two terms P r{Bp1 , xgp2 = |up1 |} P r{Bp1 , xgp2 6=
|up1 |} (4.8),
P r{Bp1 , xgp2 = |up1 |}
= P r{gp2 6= gp1 | Bp2 , xgp2 = |up1 |} P r{Bp2 , xgp2 = |up1 |}
2
= Pr{xgp2 = |up1 | | Bp2 } P r{Bp2 }
3
2
= ap1 P r{Bp2 }
3

(4.9)


P r{Bp1 , xgp2 6= |up1 |}
= P r{gp2 6= gp1 | Bp2 , xgp2 6= |up1 |} P r{Bp2 , xgp2 6= |up1 |}
= P r{xgp2 6= |up1 | | Bp2 } P r{Bp2 }

(4.10)

= (1 ap1 ) P r{Bp2 }
plugging (4.9) (4.10) (4.8), get


P r{Bp2 } 1
1
1
ap =
ap1 + (1 ap1 ) =
.
P r{Bp1 } 3
3
3bp1
This, together (4.7), gives us
bp = 1

1
.
9bp1

(4.11)

difficult show sequence {bp } decreasing lower bounded 0.
Letting lim bp = b taking limit sides, get
p

b=1
321

1
,
9b

(4.12)

fiGao & Culberson

thus, b =
thus,


3 5
6 .

case, b =


3+ 5
6

b 1 bp

since b1 = 1. follows bp b =

prove expected number legal possible matches L1 M1

3+ 5
6



!p
3+ 5
.
6

(4.5), know number legal possible matches greater
!p
!p
3
+
5
3
+
5
3p
=
.
6
2

let p = bp


3+ 5
6



(4.13)
p
3+ 5
,
2

= bp b. (4.11) (4.12),
p = bp b =

means series

p
P

bp1 b
dp1 , 0 < < 1,
9bbp1

convergent. follows

m=1

(1 +

p
1
) (1 +
)
b
b

converges finite positive constant c. Therefore,
b1 bp = (b + 1 ) (b + p )


p
1
= bp 1 +
1 +
b
b
!p
3+ 5
c
6

(4.14)

sufficient large p constant c.
show number legal possible matches L2 M2
Similarly,
2p+2
3+ 5

. Recalling number legal possible matches L t-3-module
2
satisfies L1 L2 L 27L1 L2 , second conclusion follows.
following Lemma calculates probability matching local fitness function
implies matched 3-module.
Lemma 4.3. Given 3-module x w, x w, local fitness function g
main variable xg g one three Boolean variables |x|, |y|, |w|, let z =
2 + , 0 1 parameter fixed ratio model N (n, 2, z). probability
g contains 3-module
!

1
1
6

p0 =
(1 ) +
(4.15)
n1
28
56
2

322

fiPhase Transition NK Landscapes

Proof: Since xg already one variables 3-module, probability
1
two variables 3-module n1
.
( 2 )
Now, assume variables local fitness function g
variables 3-module. definition fixed ratio model, g two zeros
fitness value assignment probability (1 ), three zeros fitness
assignment probability . Note local fitness function g implies 3-module
x w, x w
g(x, y, w) = 0

g(x, y, w) = 0.

definition fixed ratio model, happens probability
1
6


8 (1 ) + 8
2

3

Lemma follows.
preparation, prove average number t-3-modules
contained N (n, 2, z) tends infinity.
Theorem 4.2. Let number t-3-modules contained N (n, 2, z) =
(ln2 n). Then, z = 2 + > 2.837,
lim E{At } = .

n

(4.16)



Proof: Lemma 4.2, ( 3+2 5 )t legal possible matches fixed
t-3-module. Lemma 4.3, know possible legal match g = {g1 , , gt }
implies t-3-module probability pt0 . proof Theorem 10.1 (Franco &
Gelder, 1998),
2t2 nt1 (n + 1)t
(4.17)

n!
1
6
possible t-3-modules, nt1 = (nt+1)!
. Let r = 28
(1 ) + 56
, write p0 =
1
r.
(n1
2 )
E{At } =

=

=

=
=

!t

3+ 5
p0 2t2 nt1 (n + 1)t
2
!t
1
3+ 5
r 2t2 nt1 (n + 1)t

n1
2
2
!t
!t
n
2 n (n + 1)t
1
3+ 5
2

r

n1
n
2
4(n + 1)
2
2
!t


3+ 5
4 n (n + 1)t
n
1
r
4(n + 1)
2
(n(n 1))t
n2
2

1

(2(3 + 5)r)t (1
),
4n
n
323

(4.18)

fiGao & Culberson

fourth equation (4.18) due fact positive integer n q
2
q < n2 , nq eq /2n nq nq . follows lim E{At } =
n

2(3 +



5)r > 1.

(4.19)

Solving inequality (4.19) gives us > 0.837, is, z = 2 + > 2.837. proves
Theorem 4.2.
Based Chebychevs inequality, prove N (n, 2, z) contains t-3-modules
probability 1, need show variance , number contained t-3-modules,
o(E{At }). purpose, follow Franco Gelders approach (Lemma 4.1, Franco
& Gelder, 1998) apply second moment method (Alon & Spencer, 1992):
Lemma 4.4. (Alon & Spencer, 1992, Ch. 4.3 Cor 3.5) Given random structure(e.g.,
random CNF formula), let W set substructures consideration, A(w)
set substructures sharing clauses w W . Let Iw = 1 w random
structure 0 otherwise.
(1) elementsP
W symmetric;
(2) = E{
Iw } ;
wW
P
(3)
P r(w | w) = o(), w W ,
wA(w)

n , probability random structure contains substructure tends
1.
use Lemma study 2-SAT sub-problem NK landscapes, view
random structure random instance N (n, 2, z), W set
t-3-modules symmetric definitions(Sections 5 10, Franco & Gelder,
1998).
Theorem 4.3. z = 2 + > 2.837, N (n, 2, z) asymptotically insoluble
probability 1.
Proof:
Let number t-3-modules implied N (n, 2, z) = O(ln2 n).
Theorem 4.2 shows lim E{At } = . Lemma 4.4, enough show
n
w W ,
X
P r(w | w) = o(E{At }),
(4.20)
wA(w)

P r(w | w) conditional probability N (n, 2, z) implies t-3-module w
given implies w, A(w) set t-3-modules sharing clauses w.
Suppose w shares Q, 1 Q 2t clauses w, Q clauses
distributed among q 3-modules. Further, let q1 number 3-modules whose two
clauses shared q2 = q q1 number 3-modules one clause
shared.
Let T1 3-module w shares exactly one clause 3-module T2 w.
claim conditional probability T1 implied N (n, 2, z) given w
implied N (n, 2, z),
1
1
+ O( ).
(4.21)
6
n
324

fiPhase Transition NK Landscapes

Without loss generality, assume T2 = {xyu, xy u} T1 = {xyu, xy u}.
Since w implied N (n, 2, z), local fitness function g = g(|x|, |y|, |u|) implies
T2 . conditional probability T1 implied, less equal P1 + P2
P1 conditional probability g implies clause x u given g implies
T2 , P2 conditional probability clause x u implied local
fitness functions. definition N (n, 2, z), P1 = 61 . Since local fitness
function implies x u variables g = g(|x|, |y|, |u|),
P2 = O( n1 ). claim proved. follows that, sufficiently large n,
!tq

q 2
3+ 5
1
q1
P r{w | w} c
p0
1

(4.22)
2
6
p0 defined Lemma 4.3 c fixed constant.
Let AQ,q,q2 (w) set t-3-modules share Q clauses w Q
clauses distributed q different 3-modules. before, q1 number 3-modules
whose two clauses shared q2 = q q1 number 3-modules
one clause shared. claim
|AQ,q,q2 (w)| = |A2q,q,0 (w)|6q2 .

(4.23)

A2q,q,0 (w) set t-3-modules share 2q clauses q 3-modules
w. Let = {M1 , , Mt } t-3-module clauses Mi , 1 q
shared w. Let = {M1 , , Mt } t-3-module clauses
Mi , 1 q1 shared 3-modules Mi , q1 + 1 q1 + q2 one
clause shared. Since q2 3-modules, 6 ways choose non-shared
clauses, 6q2 t-3-modules AQ,q,q2 (w) correspond one t-3-module
A2q,q,0 . claims follow. formula (55) (56) (Franco & Gelder, 1998)
(4.23), follows
(
O(t) tq 2(tq) q2
2 n
6
, q p + 1,
n2
|AQ,q,q2 (w)| < O(1)
(4.24)
tq
2(tq)
q
2
n
6
, q > p + 1.
n 2

6
1
1
Let r = 28
(1 ) + 56
, write p0 = n1
r. Then,
( 2 )
|AQ,q,q2 (w)|P r{w | w}


O(t) tq 2(tq) q2 3 + 5 tq 1 q2
2 2 n
6 (
p0 ) ( )
n
2
6
!tq
O(t)
1
3+ 5
2 2tq n2(tq)
r

n1 tq
n
2

(4.25)

2


O(t) 1
(2(3 + 5)r))tq
n 4n

O(t)

E{At }(2(3 + 5)r))q , q p + 3
n




|AQ,q,q2 (w)|P r{w | w} O(1)E{At }(2(3 +
325



5)r))q , q > p + 3.

(4.26)

fiGao & Culberson

Therefore,
X
X
P r(w | w) =
|AQ,q,q2 (w)|P r{w | w}
Q,q,q2

wA(w)

=


X


X
X X
X X O(t)


q
E{At }(2(3 + 5)r)) +
O(1)E{At }(2(3 + 5)r))q .
n
q
q

Q=1 qp+3

Q=1 q>p+3

2

2

(4.27)
Since 2(3 +



5)r) > 1 z > 2.837,
X
wA(w)

P r(w | w)

O(t4 )
E{At } + t3 E{At }(4r)(p+3)
n

(4.28)

= o(E{At }).
completes proof Theorem 4.3.

5. Experiments
study threshold phenomena NK landscapes started experimental
investigation. Many theoretical results previous section motivated
observations made experiments. section, describe approach
methods used experimental study, report results observations
made.
experiments, instance NK landscape decision problem converted
equivalent 3-SAT problem, 3-SAT problem solved using Robertos relsatan
enhanced version famous Davis-Putnam algorithm SAT problems implemented
C ++ . source code relsat found http://www.cs.ubc.ca/ hoos/SATLIB/.
experiments, generated random instances NK landscape decision problem random model N (n, 2, z). result, equivalent SAT problem
random NK landscape instance 3-SAT problem n variables (on average) zn
clauses. definition, parameter z 0 8. z 1, 3-SAT instance
solved easily setting literals correspond main variables
local fitness function true. z increases, get clauses 3-SAT
problem becomes constrained. aims experiments threefold:(1)Investigating exists threshold phenomenon random NK landscape
model; (2) Locating threshold parameter z; (3)Determining
hard instances around threshold.
5.1 Experiments Fixed Ratio Model
part experiments, generate 100 random instances N (n, 2, z)
parameters n = 29 216 z = 2.71, 2.72, , 3.00. instances
converted 3-SAT instances solved relsat. Figure 1 shows fraction insoluble
instances function parameter z. seen exists threshold
phenomenon threshold around 2.83. shows upper bound z = 2.837
tight.
326

fiPhase Transition NK Landscapes

1

0.9

0.8

0.7

n=512
n=1024
n=2048
n=4096
n=8192
n=16384
n=32768
n=65536
z=2.84

0.6

0.5

0.4

0.3

0.2

0.1

0
2.7

2.75

2.8

2.85

2.9

2.95

3

Figure 1: Fractions insoluble instances(Y-axis) function z (X-axis).

Figure 2, plot square root average search cost function
parameter n. figure indicates average search O(n2 ) parameter
z. observed 99 percent insoluble instances solved
quickly preprocessing stage relsat. indicates must small
structures make instances insoluble. detailed experimental results
found Gaos thesis (Gao, 2001).
5.2 Experiments 2-SAT sub-Problem
part experiments motivated theoretical analyses Section 4.2.
idea explained follows. Let
f (x) =

n
X

(xi , (xi ))

i=1

instance decision problem NK landscape
^
^
= C1 C2 Cn
equivalent 3-SAT problem Ci set 3-clauses equivalent local fitness
function . i, set 2-clauses Di (possibly empty) implied Ci .
example, Ci three 3-clauses ((x, y, z), (x, y, z), (x, y, z)), set 2-clauses Di
would ((x, z), (x, y)). conjunction Di , denoted , 2-SAT problem.
obvious original 3-SAT problem satisfiable 2-SAT sub-problem
satisfiable. experiment, generate instances NK landscape N (n, 2, z), convert
327

fiGao & Culberson

35
z=2.71
z=2.80
z=2.84
z=2.86
z=2.90

30

25

20

15

10

5

0

0

1

2

3

4

5

6

7
4

x 10

Figure 2: Square root average search cost (Y-axis, seconds) function n
(X-axis).

1

0.9

0.8

0.7

n=512
n=1024
n=2048
n=4096
n=8192
n=16384
n=32768
n=65536
z=2.84

0.6

0.5

0.4

0.3

0.2

0.1

0
2.7

2.75

2.8

2.85

2.9

2.95

3

Figure 3: Fractions insoluble instances(Y-axis) function z (X-axis) 2-SAT
sub-problems.

equivalent 3-SAT problems, extract 2-SAT sub-problems. 2-SAT

328

fiPhase Transition NK Landscapes

40
z=2.71
z=2.80
z=2.84
z=2.86
z=2.90

35

30

25

20

15

10

5

0

0

1

2

3

4

5

6

7
4

x 10

Figure 4: Square root average search cost (Y-axis, seconds) function n
(X-axis) 2-SAT sub-problems.

problems solved relsat solver. 2-SAT problem unsatisfiable,
original NK landscape instance insoluble.
experimental settings experiment original
problem. results shown Figures 3-4, parallel Figures 1-2 results
original 3-SAT problems Section 5.1. see patterns insoluble fractions
search cost similar found original 3-SAT problems.
soluble-insoluble phase transition occurring around 2.83, fraction unsatisfiable
instances lower fraction original 3-SAT problems.
observed average search cost 2-SAT sub-problems remains
original 3-SAT problems. tells us difficulty solving
soluble instance NK landscape almost solving 2-SAT problem,
hence easy. Therefore, average NK landscape N (n, 2, z) easy parameters
threshold almost instances soluble.

6. Implications Conclusions
One questions arises work implications design analysis genetic algorithms. NK landscapes initially conceived simplified models
evolutionary landscapes could tuned respect ruggedness epistatic
interactions (Kauffman, 1989). study genetic algorithms, NK landscape models
used prototype benchmark analysis performance different genetic operators effects different encoding methods algorithms

329

fiGao & Culberson

performance (Altenberg, 1997; Hordijk, 1997; Jones, 1995). Kauffman (1993) points
parameters primarily affect number ruggedness measures n k.
Nevertheless, fact k 2 discrete NK landscape NP-complete (Wright
et al., 2000) neighbors arbitrarily chosen could construed implying
random landscapes fixed k practice hard.
results paper serve cautionary note may
case. analyses show fixed k uniform probability model trivially solvable
problem size tends infinity. fixed ratio model, derived two upper
bounds threshold solubility phase transition, proved problem
control parameter upper bounds solved polynomial time
probability asymptotic 1 due existence easy sub-problems 2-SAT.
series experiments conducted investigate hardness problem
control parameters around threshold. experiments,
observed problem easy around threshold.
proofs hold decision version problem component functions discrete {0, 1}. proofs obtained noticing clustering
functions, clauses, selected subsets variables implies overall problem
decomposable independent subproblems, problem contains small substructures identify solution. subproblems components connection
graph defined Section 3 2-SAT sub-problems studied Section 4.2. currently unclear us extent analysis extended optimization version
NK model, would study problem future.
response question implications GAs? suggest following
speculative line enquiry. discrete model use, soluble instances readily
solved standard algorithmic approach based recognizing components
connection graph. (This surprise us pointed
Heckendorn, Rana, Whitley (1999) Even relatively old algorithms DavisPutnam deterministic exact orders magnitude faster GAs.) 1
similar connectivity developed real valued distributions, example capping
minimum value allow sub-function take. speculate
clustering imposed fixed values k would generate localized structures real
values applied considering optimization instead decision, perhaps
fuzzy boundaries. fact, observation flip side limited epistasis. Genetic
algorithms, variants probabilistic model-building algorithms (Larranaga
& Lozano, 2001), designed mimic natural evolution, supposed take advantage
situation. So, extent NK landscapes accurate reflection
features exploited evolutionary algorithms, pose following question. possible
identify fuzzy components exist, design algorithm
exploits landscape features evolutionary algorithms do, far
efficiently, done uniform discrete decision problem?
landscapes designed intent studying limited interactions,
results seen confirmation indeed limited epistasis leads easier problems. another domain, traditional research search optimization,
1. thanks anonymous referee pointing us work Heckendorn, et al. (Heckendorn
et al., 1999)

330

fiPhase Transition NK Landscapes

need test bed problems real world connections tunable
respect difficulty. NK landscapes might domain generating 3-SAT
instances. disappointing restricted k instances generated easy
high probability.

Acknowledgments
research supported part Natural Sciences Engineering Research Council
Grant No. OGP8053. thank anonymous reviewers comments.

References
Achlioptas, D. (1999). Threshold Phenomena Random Graph Colouring Satisfiability. Ph.D. thesis, Department Computer Science, University Toronto, Toronton,
Canada.
Achlioptas, D. (2001). survey lower bounds random 3-sat via differential equations.
Theoretical Computer Science, 265, 159185.
Achlioptas, D., Kirousis, L., Kranakis, E., Krizanc, D., & Molloy, M. (1997). Random
constraint satisfaction: accurate picture. Proceedings CP97, pp. 107
120. Springer.
Alon, N., & Spencer, J. (1992). Probabilistic Method. Wiley, New York.
Altenberg, L. (1997). Nk fitness landscapes. Back, T., Fogel, D., & Michalewicz, Z.
(Eds.), Handbook Evolutionary Computation. Oxford University Press, New York.
Cheeseman, P., Kanefsky, B., & Taylor, W. (1991). really hard problems are.
Proceedings 12th International Joint Conference Artificial Intelligence, pp.
331337. Morgan Kaufmann.
Cook, S., & Mitchell, D. (1997). Finding hard instances satisfiability problem:
survey. Du, Gu, & Pardalos (Eds.), Satisfiability Problem: Theory Applications,
Vol. 35 DIMACS Series Discrete Mathematics Theoretical Computer Science.
American Mathematical Society.
Culberson, J., & Gent, I. (2001). Frozen development graph coloring. Theoretical Computer Science, 265 (1-2), 227264.
Dubois, O. (2001). Upper bounds satisfiability threshold. Theoretical Computer
Science, 265 (1-2), 187197.
Franco, J., & Gelder, A. (1998). perspective certain polynomial time solvable classes
satisfiability. Discrete Applied Mathematics, appear.
Franco, J., & Paul, M. (1983). Probabilistic analysis davis-putnam procedure
solving satisfiability. Discrete Applied Mathematics, 5, 7787.
Freeman, J. (1996). Hard random 3-sat problems davis-putman procedure. Artificial
Intelligence, 81, 183198.

331

fiGao & Culberson

Friedgut, E. (1999). Sharp thresholds graph properties k-sat problem. J. Amer.
Math. Soc., 10171054.
Friedgut, E., & Kalai, G. (1996). Every monotone graph property sharp threshold.
Proc. Amer. Math. Soc., 29933002.
Frieze, A., & Suen, S. (1996). Analysis two simple heuristics random instance
k-sat. J. Algorithm, 20 (2), 312355.
Gao, Y. (2001). Threshold phenomena NK landscapes. Masters thesis, Department
Computing Science, University Alberta, Edmonton, Alberta, Canada.
Gent, I., MacIntyre, I., Prosser, P.and Smith, B., & Walsh, T. (1998). Random constraint
satisfaction: Flaws structure. Tech. rep. APES-08-1998, APES Research Group.
Heckendorn, R., Rana, S., & Whitley, D. (1999). Polynomial time summary statistics
generalization maxsat. GECCO99: Proceedings Genetic Evolutinary
Computation Conference, pp. 281288. Morgan Kaufmann.
Hordijk, W. (1997). measure landscapes. Evolutionary Computation, 4 (4), 335360.
Jones, T. (1995). Evolutionary Algorithms, Fitness Landscapes Search. Ph.D. thesis,
University New Mexico, Albuquerque, NM.
Kauffman, S. (1989). Adaptation rugged fitness landscapes. Stein, D. (Ed.), Lectures
Sciences Complexity, Santa Fe Institute Studies Sciences Complexity,
pp. 527618. Addison Wesley.
Kauffman, S. (1993). Origins Order: Self-organization Selection Evolution.
Oxford University Press, Inc.
Kirkpatrick, S., & Selman, B. (1994). Critical behavior satisfiability random
boolean expressions. Science, 264, 12971301.
Kirousis, L., P.Kranakis, D.Krizanc, & Y.Stamation (1994). Approximating unsatisfiability threshold random formulas. Random Structures Algorithms, 12 (3),
253269.
Larranaga, P., & Lozano, J. (2001). Estimation Distribution Algorithms: New Tool
Evolutinary Computation. Kluwer Academic Publishers, New York.
Mitchell, D., Selman, B., & Levesque, H. (1992). Hard easy distributions sat problems.
Proceedings 10th Natl. Conf Artificial Intelligence, pp. 459465. AAAI
Press.
Vandegriend, B., & Culberson, J. (1998). Gn,m phase transition hard
Hamiltonian Cycle problem. Journal Artificial Intelligence Research, 9, 219245.
Weinberger, E. D. (1996). Np completeness kauffmans NK model, tunable rugged
fitness landscape. Tech. rep. 96-02-003, Santa Fe Institute, Santa Fe.
Wright, A. H., Thompson, R. K., & Zhang, J. (2000). computational complexity NK
fitness functions. IEEE Transactions Evolutionary Computation, 4 (4), 373379.

332


