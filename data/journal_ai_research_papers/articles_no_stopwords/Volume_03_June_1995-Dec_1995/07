journal artificial intelligence

submitted published

statistical feature combination
evaluation game positions
michael buro

nec institute
independence way
princeton nj u

mic nj nec com

abstract

article describes application three well known statistical methods field
game tree search large number classified othello positions feature weights
evaluation functions game phase independent meaning estimated means
logistic regression fisher linear discriminant quadratic discriminant function
normally distributed features thereafter playing strengths compared means
tournaments resulting versions world class othello program
application logistic regression used first time context game
playing leads better approaches

introduction

programs playing games chess draughts othello use evaluation functions estimate
players winning chances positions leaves game trees values
propagated root according negamax principle order choose move
root position leads highest score normally evaluation functions combine
features measure properties position correlated winning chance
material chess mobility othello popular quickly computable linear feature
combinations early days game programming feature weights chosen
intuitively improved manual hill climbing process programmer patience
gave technique laborious samuel first describe method
automatic improvement evaluation function parameters since many approaches
investigated two main strategies distinguished

move adaptation evaluation function parameters tuned maximize frequency
searches yield moves occur lists moves belonging training
positions idea get program mimic experts moves

value adaptation given set labelled example positions parameters determined

evaluation function fits specific model instance evaluation functions
constructed way predict final game

move adaptation proposed instance marsland v meulen
mysliwietz linear feature combination two degrees freedom multiplied positive constant constant added without changing move
decision evaluation function depends game phase positions different
phases compared example within framework selective extensions opening
book play constants must chosen suitably evaluation functions optimized
c ai access foundation morgan kaufmann publishers rights reserved

fiburo

move adaptation moment global interpretation solution
obvious schaeffer et al presented ad hoc game specific
respect value adaptation promising evaluations different
phases comparable example position labels phase independent meaning
mitchell labelled othello positions occurring game final game
form disc differential tried approximate values linear
combination features since regression used determine weights
possible investigate features statistical relevance another statistical
value adaptation used lee mahajan example positions classified
win loss side move assuming features multivariate normal
quadratic discriminant function used predict winning probability technique
ensures desired comparability applies games without win degrees e
know wins draws losses
besides classical approaches heavily rely given feature sets recent
years artificial neural networks anns trained evaluating game positions
instance moriarty miikkulainen used genetic evolve topology
weights anns order learn othello concepts means tournaments
fixed programs discovering concept mobility best ply ann player
able win games ply brute force program used evaluation
function without mobility features important contribution field
tesauro temporal difference learning sutton updating
weights anns learned evaluate backgammon positions master level means
self play tesauro conjectured stochastic nature backgammon responsible
success though several researchers obtained encouraging preliminary
applying tesauro learning procedure deterministic games work yet
led strong tournament programs tactical games awari draughts othello
chess allow deep searches powerful quickly computable evaluation
functions known might due tactics games knowledgeable
slower evaluation functions necessarily accurate relatively simple
faster evaluation functions conjunction deeper searches
follows three well known statistical namely quadratic discrimination function normally distributed features fisher linear discriminant logistic
regression described evaluation game positions context value
adaptation thereafter shown example positions parameter estimation
generated finally playing strengths three versions world class othello program
logistello equipped resulting evaluation functions compared order
determine strongest tournament player turns quadratic feature combinations necessarily lead stronger programs linear combinations logistic
regression gives best application

statistical feature combination

formal basis statistical feature combination position evaluation stated
follows
since appearance october twelve international tournaments played



fistatistical feature combination


set positions evaluate

fl wg classifies positions loss win player move
assuming optimal play sides draws handled manner
outlined section
x x
ir features
evaluation position
x x x conditional winning probability
n

n

v p

w j x x x p w j x
n

n classified example positions
available
n

x x x


n







following subsections express p w j x function linear quadratic feature combinations brie introduced way sucient practical
purposes good introductions theoretical details given instance duda
hart hand agresti mccullagh nelder fisher
classical method logistic regression used model p w j x first time
quadratic discriminant function used lee mahajan however without
considering fisher discriminant first

discriminant functions normally distributed features
bayes rule gives

j w p w
p x j pw x p w p x j w p p x w
p x j l p l


pp xxj jwl pp lw
p x j c features conditional density function p c priori probability
class c fl wg case priori probablities equal features
multivariate normally distributed within class e
p w j x

p x j c j j exp
n

c



n

x x
c

c

c

mean vector covariance matrix c fw lg follows

p w j x

exp f x
f following quadratic discriminant function
c

f x



c

n



x w l x l l w w x


log jw j log jl j
w
w
l
l
w
l




fiburo










































































































































l

x

w

figure conditional densities winning probability
covariance matrices equal expression simplified linear function
f x w l fx l w g
interestingly function solution finding linear transformation
maximizes ratio squared sample mean distance sum within class
sample variances transformation therefore good separator properties even
features normally distributed called fisher linear discriminant figure
illustrates relation conditional densities winning probability
maximum likelihood ml parameter estimates
xx

c

ji j
c

ji j

c



x

c

c





c



x x


c



c



j c g covariance matrices equal
x x
ji j ji j
x x
w
l fl wg c
c





c





c



c



logistic regression

logistic regression conditional winning probability p w j x depends linear
combination x x assumed order able model constant offsets
simple p w j x xfi parameter column vector unusable
xfi cannot guaranteed generally requirement fulfilled means
link function g ir according g p w j x xfi figure shows typical
nonlinear relation winning probability one feature since probability
usually monotone increasing function features g satisfy lim g x
lim g x link function g logit log
properties g logit since g x f exp x g follows

p w j x
exp xfi


x

x



fistatistical feature combination

hence winning probability shape discriminant analysis logistic
regression require features multivariate normal even use
discrete features possible
parameter vector estimated ml unfortunately
case necessary solve system nonlinear equations follows known
solving brie described cf agresti mccullagh nelder
order ensure convergence iterative given necessary
slightly
variable
p generalize model observed value random











f



g

mean


f


exp

x


g

stochastically independent definition includes old model n f g
likelihood function l probability density measures likely
see realization stochastically independent random variables true
parameter vector order maximize l suces consider log l


n



j

j

j











log l log


n


xx




n

j





ni yi


n



yx


ij






j



x
n



x
n


h







log n log



log exp

n







x
n

j





x
ij

j








function twice differentiable strictly concave rare border cases
unique maximum location n cf wedderburn
iteratively found newton raphson method follows


x x x z
















n n matrix x built x



diag n exp















n







n



j


n


z log


n



x


ij



j







x












p w j x












































































x

figure typical shape winning probability






fiburo

starting n ml estimate may usually computed high
accuracy within steps since method quadratically convergent relatively robust
respect choice starting vector unfortunately
n estimates might converge original model approximated
instance setting n depending whether position
question lost
















generation classification example positions
value adaptation requires labelled example positions arise first
nontrivial games endgame positions classified correctly
drawn lost opening midgame positions optimal play reach due
lack game knowledge time constraints furthermore example positions
contain significant feature variance since otherwise discrimination possible hence
problematic use high level games might first idea since good
players programs know relevant features try maximize game
therefore features tend constant time statistical methods would
assign small weights final diculty estimating parameters accurately
different game phases requires many positions
pragmatic solution indicated figure period
two years othello games played early versions logistello
urd anovic program rev feature variance ensured examining openings
igor
length seven led mostly unbalanced starting positions since early program
versions used minutes thinking time games though well
played time error free cases even big mistakes occurred
example one side fell corner losing trap caused lack look ahead
without errors reasonable weight estimation principal features corner
possession othello possible explained following lee mahajan
positions classified final game problematic
classification reliability decreases endgame opening phase due player
mistakes reduce effect early outcome searches performed solving othello
positions moves game end furthermore time time game database
searched obvious errors program versions longer searches correct
games since process many lines play repeated misclassification
rate reduced propagating game leaves root
game tree built games according negamax principle
way classification position depends examined successors
therefore reliable
proposed classification method relatively fast allows us label many positions
reasonable time average positions minutes addition
game file obtained via anonymous ftp
ftp uni paderborn de unix othello misc database zip
brief description programs given help internet othello server
telnet faust uni paderborn de
implications compared losing material nothing chess



fistatistical feature combination










































































database consisting
ca games

l
w
l
w

w x
w
x l xd x
w
x xw x



































































































game tree















million
classified positions

figure classification process
ensuring accurate parameter estimation even different game phases indicated
small parameter confidence intervals method enabled us develop pattern
features othello estimating winning probability conditioned upon occurrence
sub configurations edge diagonal instances board

parameter estimation playing strength comparison

although example positions labelled drawn decided
use parameter estimation since positions give exact information
feature balancing natural way handle drawn positions within statistical evaluation
framework considered define winning probability case
extension logistic regression parameters easily determined setting n
case draw alternatively doubling lost positions incorporating drawn
positions lost leads estimate log likelihood
functions equal constant factor latter technique used fitting

previous experiments showed parameters depend game phase
disc count adequate measure othello example positions grouped according number discs board adjacent groups used parameter
estimation order smooth data ensure almost equal numbers lost
positions
success othello program bill described lee mahajan shows
othello table features quite effective instance important edge
structure quickly evaluated adding four pre computed edge evaluations
stored table features used logistello table fall
two groups first group pattern instances including horizontal vertical
diagonal lines board evaluated second group two mobility measures
computed
parameter estimation three described tournaments players quad uses quadratic discriminant function normally distributed features




details given buro postscript file thesis obtained via anonymous ftp



fiburo

pairing
log quad
fisher quad
log fisher
log fisher
log quad
fisher quad
log quad

time per game

winning
minutes
win draw loss percentage
























table tournament
fisher log played order determine best tournament player starting
nearly even opening positions discs e move logistello opening book game return game colours reversed played

opening midgame phase program versions performed usual iterative deepening negascout searches reinefeld selective corner quiescence search extension
endgame positions empty squares solved win draw loss searches
pattern learning tournaments facility think opponent time turned order speed tournaments run parallel
seven sun sparc workstations
applying conservative statistical test seen listed table
stating winning percentage greater statistically significant level
first two clear advantage linear combinations normal tournament
conditions minutes per player per game furthermore since log outperforms fisher
features would seem even approximately normally distributed lies
advantage logistic regression even discrete features castling status chess
parity othello used
tournaments played time weaker players fisher
quad order determine time factors lead equal playing strength
shown table fisher reaches log strength given time
quad needs time compete log logistello optimized
implementation search speed quadratic combination still
slower linear combination thus giving quad time
balances total number nodes searched game even
timing log stronger quad fisher still compete
quadratic combination slower linear combination
better discrimination properties indeed look estimated covariance matrices
log ply evaluation positions lies range corresponds winning
probabilities range nearly even starting positions used compare
programs similar playing strength since clear positions colour determines winner
winning percentage would even one player stronger starting positions six
led game pairs balanced score



fistatistical feature combination

class revealed almost equal therefore better evaluation quality
fisher linear discriminant could expected

discussion

three statistical approaches modelling evaluation functions game
phase independent meaning presented compared empirically world
class othello program quadratic feature combinations necessarily lead stronger
programs linear combinations since evaluation speed drop significantly
course effect depends number features used evaluation speed
features used takes long time evaluate playing strength
differences cannot explained different speeds case evaluation times
almost equal case quadratic combinations covariance matrices
compared almost equal quadratic terms omitted
fisher linear discriminant used therefore motivations lee mahajan
need refinement since existing feature correlation necessarily justify use
nonlinear combinations generally possibly accurate nonlinear feature combinations
anns compared simpler faster approaches practice since
use guarantee greater playing strength
besides linear regression discriminant analysis logistic regression proven
suitable tool construction evaluation functions global interpretation
drawback parameter estimation system nonlinear equations solved
compensated higher quality evaluation function comparison
approaches since application parameters determined
current tournament version logistello uses feature weights estimated
means logistic regression profits comparability evaluations different
game phases ensured use value adaptation possible
perform selective searches values different game phases compared
moreover values opening compared even late midgame values order
promising move alternatives program opening book buro
sense value comparability cornerstone logistello strength

acknowledgements
wish thank wife karen competently answering many statistical questions
urd anovic many fruitful discussions led
thank colleague igor
considerable improvements othello programs furthermore grateful colin
springer richard e korf anonymous referees useful suggestions earlier
versions helped improve presentation contents

references

agresti categorical data analysis wiley
buro techniken fur die bewertung von spielsituationen anhand von beispielen
ph thesis university paderborn germany
ftp uni paderborn de unix othello ps files mics dis ps gz



fiburo

buro l apprentissage des ouvertures chez logistello magazine de la federation
francaise othello fforum
duda r hart p pattern classification scene analysis wiley
hand j discrimination classification wiley
lee k f mahajan pattern classification evaluation function
learning artificial intelligence
lee k f mahajan development world class othello program artificial
intelligence
marsland evaluation function factors icca journal
mccullagh p nelder j generalized linear chapman hall
van den meulen weight assesment evaluation functions f beal
editor advances computer chess elsevier science publishers
mitchell h features evaluate positions experts novices othello
games master thesis northwestern university evanston illinois u
moriarty miikkulainen r evolving complex othello strategies marker
genetic encoding neural networks tech rep ai department
computer sciences university texas austin
mysliwietz p konstruktion und optimierung von bewertungsfunktionen beim
schach ph thesis university paderborn germany
reinefeld improvement scout tree search icca journal

samuel l studies machine learning game checkers ibm
journal development
samuel l studies machine learning game checkers ii
ibm journal development
schaeffer j culberson j treloar n knight b lu p szafron world
championship caliber checkers program artificial intelligence
sutton r learning predict methods temporal differences machine
learning
tesauro g practical issues temporal difference learning machine learning

tesauro g td gammon self teaching backgammon program achieves
master level play neural computation
tesauro g temporal difference learning td gammon communications
acm
wedderburn r w existence uniqueness maximum likelihood
estimates certain generalized linear biometrika



